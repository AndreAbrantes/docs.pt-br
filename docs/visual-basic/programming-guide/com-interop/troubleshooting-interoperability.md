---
title: Solucionando problemas de interoperabilidade (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
ms.openlocfilehash: af28ba1a167415a59b8e2a4db860497122a5c2c9
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64624807"
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="1a202-102">Solucionando problemas de interoperabilidade (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1a202-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="1a202-103">Quando você interoperar entre o código gerenciado do e COM o [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], você pode encontrar um ou mais dos seguintes problemas comuns.</span><span class="sxs-lookup"><span data-stu-id="1a202-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], you may encounter one or more of the following common issues.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor1"></a> <span data-ttu-id="1a202-104">Marshaling de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="1a202-104">Interop Marshaling</span></span>  
 <span data-ttu-id="1a202-105">Às vezes, você talvez precise usar tipos de dados que não são parte do [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1a202-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="1a202-106">Assemblies de interoperabilidade lidar com a maioria do trabalho para objetos COM, mas talvez você precise controlar os tipos de dados que são usados quando os objetos gerenciados são expostos COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="1a202-107">Por exemplo, as estruturas em bibliotecas de classe devem especificar o `BStr` tipo em cadeias de caracteres enviados para objetos COM criados pelo Visual Basic 6.0 e versões anteriores não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="1a202-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="1a202-108">Nesses casos, você pode usar o <xref:System.Runtime.InteropServices.MarshalAsAttribute> atributo para fazer com que tipos gerenciados deve ser exposta como tipos não gerenciados.</span><span class="sxs-lookup"><span data-stu-id="1a202-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor2"></a> <span data-ttu-id="1a202-109">Exportando cadeias de caracteres de comprimento fixo para código não gerenciado</span><span class="sxs-lookup"><span data-stu-id="1a202-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="1a202-110">No Visual Basic 6.0 e versões anteriores, as cadeias de caracteres são exportadas para objetos COM como sequências de bytes sem um caractere de terminação nula.</span><span class="sxs-lookup"><span data-stu-id="1a202-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="1a202-111">Para compatibilidade com outras linguagens, o Visual Basic .NET inclui um caractere de terminação ao exportar as cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="1a202-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="1a202-112">A melhor maneira de resolver essa incompatibilidade é exportar cadeias de caracteres que não têm o caractere de encerramento como matrizes de `Byte` ou `Char`.</span><span class="sxs-lookup"><span data-stu-id="1a202-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor3"></a> <span data-ttu-id="1a202-113">Exportação de hierarquias de herança</span><span class="sxs-lookup"><span data-stu-id="1a202-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="1a202-114">Classe hierarquias Nivelar out quando exposto como objetos COM gerenciada.</span><span class="sxs-lookup"><span data-stu-id="1a202-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="1a202-115">Por exemplo, se você define uma classe base com um membro e, em seguida, herda a classe base em uma classe derivada que é exposta como um objeto COM, os clientes que usam a classe derivada no objeto COM não será capazes de usar os membros herdados.</span><span class="sxs-lookup"><span data-stu-id="1a202-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="1a202-116">Membros da classe base podem ser acessados de objetos COM apenas como instâncias de uma classe base e, em seguida, somente se a classe base também é criada como um objeto COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="1a202-117">Métodos Sobrecarregados</span><span class="sxs-lookup"><span data-stu-id="1a202-117">Overloaded Methods</span></span>  
 <span data-ttu-id="1a202-118">Embora você possa criar métodos sobrecarregados com o Visual Basic, eles não são suportados pelo COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="1a202-119">Quando uma classe que contém os métodos sobrecarregados é exposta como um objeto COM, os novos nomes de método são gerados para os métodos sobrecarregados.</span><span class="sxs-lookup"><span data-stu-id="1a202-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="1a202-120">Por exemplo, considere uma classe que tem duas sobrecargas do `Synch` método.</span><span class="sxs-lookup"><span data-stu-id="1a202-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="1a202-121">Quando a classe é exposta como um objeto COM, os novos nomes de método gerado pode ser `Synch` e `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="1a202-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="1a202-122">A renomeação pode causar problemas de duas para os consumidores do objeto COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1. <span data-ttu-id="1a202-123">Os clientes não podem esperar que os nomes de método gerado.</span><span class="sxs-lookup"><span data-stu-id="1a202-123">Clients might not expect the generated method names.</span></span>  
  
2. <span data-ttu-id="1a202-124">Os nomes de método gerado na classe exposta como um objeto COM podem mudar quando novas sobrecargas são adicionadas à classe ou sua classe base.</span><span class="sxs-lookup"><span data-stu-id="1a202-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="1a202-125">Isso pode causar problemas de controle de versão.</span><span class="sxs-lookup"><span data-stu-id="1a202-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="1a202-126">Para resolver os dois problemas, dê a cada método um nome exclusivo, em vez de usar a sobrecarga, quando você desenvolve os objetos que serão expostos como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor4"></a> <span data-ttu-id="1a202-127">Uso de objetos COM por meio de Assemblies de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="1a202-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="1a202-128">Você usar assemblies de interoperabilidade, quase como se eles são substituições de código gerenciado para os objetos COM que eles representam.</span><span class="sxs-lookup"><span data-stu-id="1a202-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="1a202-129">No entanto, como elas são wrappers e objetos não reais de objetos, há algumas diferenças entre usar assemblies de interoperabilidade e assemblies padrão.</span><span class="sxs-lookup"><span data-stu-id="1a202-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="1a202-130">Essas áreas de diferença incluem a exposição das classes e tipos de dados para parâmetros e valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="1a202-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor5"></a> <span data-ttu-id="1a202-131">Classes expostas como ambas as Interfaces e Classes</span><span class="sxs-lookup"><span data-stu-id="1a202-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="1a202-132">Diferentemente das classes em assemblies padrão, as classes COM são expostas em assemblies de interoperabilidade como uma interface e uma classe que representa a classe COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="1a202-133">Nome da interface é idêntica da classe COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="1a202-134">O nome da classe interoperabilidade é o mesmo da classe COM original, mas com a palavra "Class" acrescentado.</span><span class="sxs-lookup"><span data-stu-id="1a202-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="1a202-135">Por exemplo, suponha que você tenha um projeto com uma referência a um assembly de interoperabilidade para um objeto COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="1a202-136">Se o nome da classe COM `MyComClass`, IntelliSense e o Pesquisador de objetos mostram uma interface denominada `MyComClass` e uma classe chamada `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="1a202-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor6"></a> <span data-ttu-id="1a202-137">Criação de instâncias de uma classe do .NET Framework</span><span class="sxs-lookup"><span data-stu-id="1a202-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="1a202-138">Em geral, você cria uma instância de um [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] classe usando o `New` instrução com um nome de classe.</span><span class="sxs-lookup"><span data-stu-id="1a202-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="1a202-139">Ter uma classe COM representado por um assembly de interoperabilidade é o único caso em que você pode usar o `New` instrução com uma interface.</span><span class="sxs-lookup"><span data-stu-id="1a202-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="1a202-140">A menos que você estiver usando a classe COM um `Inherits` instrução, você pode usar a interface exatamente como faria com uma classe.</span><span class="sxs-lookup"><span data-stu-id="1a202-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="1a202-141">O código a seguir demonstra como criar um `Command` objeto em um projeto que tem uma referência para o objeto de objetos de dados do Microsoft ActiveX 2.8 biblioteca COM:</span><span class="sxs-lookup"><span data-stu-id="1a202-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#20)]  
  
 <span data-ttu-id="1a202-142">No entanto, se você estiver usando a classe COM como a base para uma classe derivada, você deve usar a classe de interoperabilidade que representa a classe COM, como no código a seguir:</span><span class="sxs-lookup"><span data-stu-id="1a202-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#21)]  
  
> [!NOTE]
>  <span data-ttu-id="1a202-143">Assemblies de interoperabilidade implicitamente implementam interfaces que representam classes COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="1a202-144">Você não deve tentar usar o `Implements` resultará instrução para implementar essas interfaces ou um erro.</span><span class="sxs-lookup"><span data-stu-id="1a202-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor7"></a> <span data-ttu-id="1a202-145">Tipos de dados para parâmetros e valores de retorno</span><span class="sxs-lookup"><span data-stu-id="1a202-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="1a202-146">Ao contrário de membros de assemblies padrão, os membros do assembly de interoperabilidade podem ter tipos de dados que são diferentes daqueles usados na declaração do objeto original.</span><span class="sxs-lookup"><span data-stu-id="1a202-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="1a202-147">Embora os assemblies de interoperabilidade se convertem implicitamente tipos COM compatível tipos common language runtime, você deve prestar atenção aos tipos de dados que são usados por ambos os lados para evitar erros de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="1a202-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="1a202-148">Por exemplo, em objetos COM criados no Visual Basic 6.0 e versões anteriores, os valores do tipo `Integer` supor que o [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] tipo equivalente, `Short`.</span><span class="sxs-lookup"><span data-stu-id="1a202-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="1a202-149">É recomendável que você use o Pesquisador de objetos para examinar as características de membros importados antes de você usá-los.</span><span class="sxs-lookup"><span data-stu-id="1a202-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor8"></a> <span data-ttu-id="1a202-150">Métodos de COM de nível de módulo</span><span class="sxs-lookup"><span data-stu-id="1a202-150">Module level COM methods</span></span>  
 <span data-ttu-id="1a202-151">A maioria dos objetos COM são usadas, criando uma instância de uma classe de COM usando o `New` palavra-chave e, em seguida, chamar métodos do objeto.</span><span class="sxs-lookup"><span data-stu-id="1a202-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="1a202-152">Uma exceção a essa regra envolve a objetos COM que contêm `AppObj` ou `GlobalMultiUse` classes COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="1a202-153">Essas classes são semelhantes a métodos de nível de módulo em classes do Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="1a202-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="1a202-154">Visual Basic 6.0 e versões anteriores implicitamente criar instâncias desses objetos para você na primeira vez que você chame um dos seus métodos.</span><span class="sxs-lookup"><span data-stu-id="1a202-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="1a202-155">Por exemplo, no Visual Basic 6.0 você pode adicionar uma referência ao objeto de biblioteca do Microsoft DAO 3.6 e chame o `DBEngine` método sem primeiro criar uma instância:</span><span class="sxs-lookup"><span data-stu-id="1a202-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="1a202-156">Visual Basic .NET exige que você sempre criar instâncias de objetos COM antes de poder usar seus métodos.</span><span class="sxs-lookup"><span data-stu-id="1a202-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="1a202-157">Para usar esses métodos no Visual Basic, declare uma variável de classe desejada e use a nova palavra-chave para atribuir o objeto para a variável de objeto.</span><span class="sxs-lookup"><span data-stu-id="1a202-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="1a202-158">O `Shared` palavra-chave pode ser usado quando você deseja garantir que apenas uma instância da classe é criada.</span><span class="sxs-lookup"><span data-stu-id="1a202-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#23)]  
  
## <a name="vbconinteroperabilitymarshalinganchor9"></a> <span data-ttu-id="1a202-159">Erros sem tratamento em manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="1a202-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="1a202-160">Um problema de interoperabilidade comum envolve erros em manipuladores de eventos que tratam os eventos gerados por objetos COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="1a202-161">Esses erros são ignorados, a menos que especificamente procurar erros usando `On Error` ou `Try...Catch...Finally` instruções.</span><span class="sxs-lookup"><span data-stu-id="1a202-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="1a202-162">Por exemplo, o exemplo a seguir é de um projeto do Visual Basic .NET que tem uma referência para o objeto de objetos de dados do Microsoft ActiveX 2.8 biblioteca COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#24)]  
  
 <span data-ttu-id="1a202-163">Este exemplo gera um erro, conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="1a202-163">This example raises an error as expected.</span></span> <span data-ttu-id="1a202-164">No entanto, se você tentar o mesmo exemplo sem o `Try...Catch...Finally` bloco, o erro será ignorado como se você usou o `OnError Resume Next` instrução.</span><span class="sxs-lookup"><span data-stu-id="1a202-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="1a202-165">A divisão por zero silenciosamente falhará sem tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="1a202-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="1a202-166">Como esses erros nunca geram uma exceção sem tratamento de erros, é importante que você usa alguma forma de tratamento de exceções em manipuladores de eventos que tratam os eventos dos objetos COM.</span><span class="sxs-lookup"><span data-stu-id="1a202-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="1a202-167">Noções básicas sobre erros de interoperabilidade COM</span><span class="sxs-lookup"><span data-stu-id="1a202-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="1a202-168">Sem tratamento de erros, chamadas de interoperabilidade geralmente geram erros que forneçam pouca informação.</span><span class="sxs-lookup"><span data-stu-id="1a202-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="1a202-169">Sempre que possível, use o tratamento estruturado para fornecer mais informações sobre problemas quando eles ocorrerem.</span><span class="sxs-lookup"><span data-stu-id="1a202-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="1a202-170">Isso pode ser especialmente útil ao depurar aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1a202-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="1a202-171">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1a202-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#25)]  
  
 <span data-ttu-id="1a202-172">Você pode encontrar informações como a descrição do erro, HRESULT e a fonte de erros COM examinando o conteúdo do objeto de exceção.</span><span class="sxs-lookup"><span data-stu-id="1a202-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor10"></a> <span data-ttu-id="1a202-173">Problemas de controle ActiveX</span><span class="sxs-lookup"><span data-stu-id="1a202-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="1a202-174">A maioria dos controles ActiveX que funcionam com o Visual Basic 6.0 funcionam com o Visual Basic .NET sem problemas.</span><span class="sxs-lookup"><span data-stu-id="1a202-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="1a202-175">As principais exceções são controles de contêiner ou controles que contêm visualmente outros controles.</span><span class="sxs-lookup"><span data-stu-id="1a202-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="1a202-176">Alguns exemplos de controles mais antigos que não funcionam corretamente com o Visual Studio são da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="1a202-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
- <span data-ttu-id="1a202-177">Controle quadro do Microsoft Forms 2.0</span><span class="sxs-lookup"><span data-stu-id="1a202-177">Microsoft Forms 2.0 Frame control</span></span>  
  
- <span data-ttu-id="1a202-178">Controle de cima para baixo, também conhecido como o controle de rotação</span><span class="sxs-lookup"><span data-stu-id="1a202-178">Up-Down control, also known as the spin control</span></span>  
  
- <span data-ttu-id="1a202-179">Controle de guia Sheridan</span><span class="sxs-lookup"><span data-stu-id="1a202-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="1a202-180">Há apenas algumas soluções alternativas para problemas de controle ActiveX sem suporte.</span><span class="sxs-lookup"><span data-stu-id="1a202-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="1a202-181">Você pode migrar os controles existentes para o Visual Studio se você possui o código-fonte original.</span><span class="sxs-lookup"><span data-stu-id="1a202-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="1a202-182">Caso contrário, você pode verificar com fornecedores de software para atualizado. Compatível com .NET versões dos controles para substituir sem suporte a controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="1a202-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor11"></a> <span data-ttu-id="1a202-183">Passando propriedades de somente leitura de controles ByRef</span><span class="sxs-lookup"><span data-stu-id="1a202-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="1a202-184">Visual Basic .NET gera erros COM, como "CTL_E_SETNOTSUPPORTED de 0x800A017F de erro", às vezes, quando você passa `ReadOnly` propriedades de alguns controles ActiveX mais antigos como `ByRef` parâmetros para outros procedimentos.</span><span class="sxs-lookup"><span data-stu-id="1a202-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="1a202-185">Chamadas de procedimento semelhante do Visual Basic 6.0 gerará um erro e os parâmetros são tratados como se você os passados por valor.</span><span class="sxs-lookup"><span data-stu-id="1a202-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="1a202-186">A mensagem de erro do Visual Basic .NET indica que você está tentando alterar uma propriedade que não tem uma propriedade `Set` procedimento.</span><span class="sxs-lookup"><span data-stu-id="1a202-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="1a202-187">Se você tiver acesso ao procedimento sendo chamado, você pode evitar esse erro, usando o `ByVal` palavra-chave para declarar parâmetros que aceitam `ReadOnly` propriedades.</span><span class="sxs-lookup"><span data-stu-id="1a202-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="1a202-188">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1a202-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#26)]  
  
 <span data-ttu-id="1a202-189">Se você não tiver acesso ao código-fonte para o procedimento sendo chamado, você pode forçar a propriedade a ser passado por valor, adicionando um conjunto extra de parênteses em torno do procedimento de chamada.</span><span class="sxs-lookup"><span data-stu-id="1a202-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="1a202-190">Por exemplo, em um projeto que tem uma referência para o objeto de objetos de dados do Microsoft ActiveX 2.8 biblioteca COM, você pode usar:</span><span class="sxs-lookup"><span data-stu-id="1a202-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#27)]  
  
## <a name="vbconinteroperabilitymarshalinganchor12"></a> <span data-ttu-id="1a202-191">Implantando Assemblies que expõem a interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="1a202-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="1a202-192">Implantando assemblies que expõem interfaces COM apresenta alguns desafios únicos.</span><span class="sxs-lookup"><span data-stu-id="1a202-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="1a202-193">Por exemplo, um problema potencial ocorre quando o mesmo assembly COM referência a aplicativos separados.</span><span class="sxs-lookup"><span data-stu-id="1a202-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="1a202-194">Essa situação é comum quando uma nova versão de um assembly é instalada e o outro aplicativo ainda está usando a versão antiga do assembly.</span><span class="sxs-lookup"><span data-stu-id="1a202-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="1a202-195">Se você desinstalar um assembly que compartilha uma DLL, você pode, inadvertidamente, torna indisponível para os outros assemblies.</span><span class="sxs-lookup"><span data-stu-id="1a202-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="1a202-196">Para evitar esse problema, você deve instalar assemblies compartilhados para Cache de Assembly Global (GAC) e usar um MergeModule para o componente.</span><span class="sxs-lookup"><span data-stu-id="1a202-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="1a202-197">Se você não pode instalar o aplicativo no GAC, ele deve ser instalado para Pastaarqscomuns em um subdiretório específico de versão.</span><span class="sxs-lookup"><span data-stu-id="1a202-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="1a202-198">Assemblies que não são compartilhados devem estar localizados, lado a lado no diretório com o aplicativo de chamada.</span><span class="sxs-lookup"><span data-stu-id="1a202-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1a202-199">Consulte também</span><span class="sxs-lookup"><span data-stu-id="1a202-199">See also</span></span>

- <xref:System.Runtime.InteropServices.MarshalAsAttribute>
- [<span data-ttu-id="1a202-200">Interoperabilidade COM</span><span class="sxs-lookup"><span data-stu-id="1a202-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="1a202-201">Tlbimp.exe (Importador de Biblioteca de Tipos)</span><span class="sxs-lookup"><span data-stu-id="1a202-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="1a202-202">Tlbexp.exe (Exportador de Biblioteca de Tipos)</span><span class="sxs-lookup"><span data-stu-id="1a202-202">Tlbexp.exe (Type Library Exporter)</span></span>](../../../framework/tools/tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="1a202-203">Passo a passo: implementação de herança com objetos COM</span><span class="sxs-lookup"><span data-stu-id="1a202-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)
- [<span data-ttu-id="1a202-204">Instrução Inherits</span><span class="sxs-lookup"><span data-stu-id="1a202-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)
- [<span data-ttu-id="1a202-205">Cache de assembly global</span><span class="sxs-lookup"><span data-stu-id="1a202-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
