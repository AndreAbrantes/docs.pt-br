---
title: 'Passo a passo: Chamando APIs do Windows (Visual Basic) | Documentos do Microsoft'
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- DLLs, calling
- Windows API, walkthroughs
- platform invoke, walkthroughs
- API calls, walkthroughs [Visual Basic]
- Windows API, calling
- walkthroughs [Visual Basic], API calls
- DllImport attribute, calling Windows API
- Declare statement, declaring DLL functions
ms.assetid: 9280ca96-7a93-47a3-8d01-6d01be0657cb
caps.latest.revision: 20
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: ae1ef60e6e27658c872689f5bfe2779493d42e7a
ms.contentlocale: pt-br
ms.lasthandoff: 04/12/2017

---
# <a name="walkthrough-calling-windows-apis-visual-basic"></a><span data-ttu-id="94d9b-102">Instruções passo a passo: chamando APIs do Windows (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="94d9b-102">Walkthrough: Calling Windows APIs (Visual Basic)</span></span>
<span data-ttu-id="94d9b-103">APIs do Windows são bibliotecas de vínculo dinâmico (DLLs) que fazem parte do sistema operacional Windows.</span><span class="sxs-lookup"><span data-stu-id="94d9b-103">Windows APIs are dynamic-link libraries (DLLs) that are part of the Windows operating system.</span></span> <span data-ttu-id="94d9b-104">Você pode usá-los para executar tarefas quando é difícil escrever procedimentos equivalentes de sua preferência.</span><span class="sxs-lookup"><span data-stu-id="94d9b-104">You use them to perform tasks when it is difficult to write equivalent procedures of your own.</span></span> <span data-ttu-id="94d9b-105">Por exemplo, o Windows fornece uma função chamada `FlashWindowEx` que permite que você crie a barra de título para um aplicativo alternativo entre tonalidades claras e escuras.</span><span class="sxs-lookup"><span data-stu-id="94d9b-105">For example, Windows provides a function named `FlashWindowEx` that lets you make the title bar for an application alternate between light and dark shades.</span></span>  
  
 <span data-ttu-id="94d9b-106">A vantagem de usar APIs do Windows em seu código é que elas podem economizar tempo de desenvolvimento porque eles contêm dezenas de funções úteis que já estão gravadas e esperando para ser usado.</span><span class="sxs-lookup"><span data-stu-id="94d9b-106">The advantage of using Windows APIs in your code is that they can save development time because they contain dozens of useful functions that are already written and waiting to be used.</span></span> <span data-ttu-id="94d9b-107">A desvantagem é que APIs do Windows pode ser difícil trabalhar com e implacável quando as coisas dão errado.</span><span class="sxs-lookup"><span data-stu-id="94d9b-107">The disadvantage is that Windows APIs can be difficult to work with and unforgiving when things go wrong.</span></span>  
  
 <span data-ttu-id="94d9b-108">APIs do Windows representam uma categoria especial de interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="94d9b-108">Windows APIs represent a special category of interoperability.</span></span> <span data-ttu-id="94d9b-109">APIs do Windows não usar código gerenciado, não têm interno bibliotecas de tipos e usar tipos de dados que são diferentes daqueles usados com o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="94d9b-109">Windows APIs do not use managed code, do not have built-in type libraries, and use data types that are different than those used with Visual Studio.</span></span> <span data-ttu-id="94d9b-110">Devido a essas diferenças, e como APIs do Windows não são objetos COM, interoperabilidade com APIs do Windows e o [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] é realizada usando a plataforma invoke, ou PInvoke.</span><span class="sxs-lookup"><span data-stu-id="94d9b-110">Because of these differences, and because Windows APIs are not COM objects, interoperability with Windows APIs and the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] is performed using platform invoke, or PInvoke.</span></span> <span data-ttu-id="94d9b-111">Invocação de plataforma é um serviço que permite que código gerenciado para chamar funções não gerenciadas implementadas em DLLs.</span><span class="sxs-lookup"><span data-stu-id="94d9b-111">Platform invoke is a service that enables managed code to call unmanaged functions implemented in DLLs.</span></span> <span data-ttu-id="94d9b-112">Para obter mais informações, consulte [consumindo funções de DLL não gerenciada](http://msdn.microsoft.com/library/eca7606e-ebfb-4f47-b8d9-289903fdc045).</span><span class="sxs-lookup"><span data-stu-id="94d9b-112">For more information, see [Consuming Unmanaged DLL Functions](http://msdn.microsoft.com/library/eca7606e-ebfb-4f47-b8d9-289903fdc045).</span></span> <span data-ttu-id="94d9b-113">Você pode usar PInvoke em [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] usando o `Declare` instrução ou aplicar o `DllImport` atributo a um procedimento vazio.</span><span class="sxs-lookup"><span data-stu-id="94d9b-113">You can use PInvoke in [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] by using either the `Declare` statement or applying the `DllImport` attribute to an empty procedure.</span></span>  
  
 <span data-ttu-id="94d9b-114">Chamadas de API do Windows foram uma parte importante da [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] de programação no passado, mas raramente são necessárias com [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)].</span><span class="sxs-lookup"><span data-stu-id="94d9b-114">Windows API calls were an important part of [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] programming in the past, but are seldom necessary with [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)].</span></span> <span data-ttu-id="94d9b-115">Sempre que possível, você deve usar código gerenciado do [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] para executar tarefas, em vez de chamadas de API do Windows.</span><span class="sxs-lookup"><span data-stu-id="94d9b-115">Whenever possible, you should use managed code from the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] to perform tasks, instead of Windows API calls.</span></span> <span data-ttu-id="94d9b-116">Este passo a passo fornece informações sobre as situações nas quais o uso APIs do Windows é necessária.</span><span class="sxs-lookup"><span data-stu-id="94d9b-116">This walkthrough provides information for those situations in which using Windows APIs is necessary.</span></span>  
  
[!INCLUDE[note_settings_general](../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
## <a name="api-calls-using-declare"></a><span data-ttu-id="94d9b-117">Chamadas de API usando Declare</span><span class="sxs-lookup"><span data-stu-id="94d9b-117">API Calls Using Declare</span></span>  
 <span data-ttu-id="94d9b-118">É a maneira mais comum de chamar APIs do Windows usando o `Declare` instrução.</span><span class="sxs-lookup"><span data-stu-id="94d9b-118">The most common way to call Windows APIs is by using the `Declare` statement.</span></span>  
  
#### <a name="to-declare-a-dll-procedure"></a><span data-ttu-id="94d9b-119">Para declarar um procedimento DLL</span><span class="sxs-lookup"><span data-stu-id="94d9b-119">To declare a DLL procedure</span></span>  
  
1.  <span data-ttu-id="94d9b-120">Determine o nome da função que você deseja chamar, mais seus argumentos, tipos de argumento e retornar o valor, bem como o nome e o local da DLL que contém.</span><span class="sxs-lookup"><span data-stu-id="94d9b-120">Determine the name of the function you want to call, plus its arguments, argument types, and return value, as well as the name and location of the DLL that contains it.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="94d9b-121">Para obter informações completas sobre as APIs do Windows, consulte a documentação do SDK do Win32 na API do Windows Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="94d9b-121">For complete information about the Windows APIs, see the Win32 SDK documentation in the Platform SDK Windows API.</span></span> <span data-ttu-id="94d9b-122">Para obter mais informações sobre as constantes que usam APIs do Windows, examine os arquivos de cabeçalho, como Windows. h incluído no SDK da plataforma.</span><span class="sxs-lookup"><span data-stu-id="94d9b-122">For more information about the constants that Windows APIs use, examine the header files such as Windows.h included with the Platform SDK.</span></span>  
  
2.  <span data-ttu-id="94d9b-123">Abra um novo projeto de aplicativo do Windows clicando em **novo** no **arquivo** menu e, em seguida, clicando em **projeto**.</span><span class="sxs-lookup"><span data-stu-id="94d9b-123">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="94d9b-124">A caixa de diálogo **Novo Projeto** é exibida.</span><span class="sxs-lookup"><span data-stu-id="94d9b-124">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="94d9b-125">Selecione **Windows Application** da lista de [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] modelos de projeto.</span><span class="sxs-lookup"><span data-stu-id="94d9b-125">Select **Windows Application** from the list of [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] project templates.</span></span> <span data-ttu-id="94d9b-126">O novo projeto é exibido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-126">The new project is displayed.</span></span>  
  
4.  <span data-ttu-id="94d9b-127">Adicione o seguinte `Declare` função para a classe ou módulo no qual você deseja usar a DLL:</span><span class="sxs-lookup"><span data-stu-id="94d9b-127">Add the following `Declare` function either to the class or module in which you want to use the DLL:</span></span>  
  
     <span data-ttu-id="94d9b-128">[!code-vb[VbVbalrInterop n º&9;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-128">[!code-vb[VbVbalrInterop#9](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_1.vb)]</span></span>  
  
### <a name="parts-of-the-declare-statement"></a><span data-ttu-id="94d9b-129">Partes da instrução Declare</span><span class="sxs-lookup"><span data-stu-id="94d9b-129">Parts of the Declare Statement</span></span>  
 <span data-ttu-id="94d9b-130">O `Declare` instrução inclui os seguintes elementos.</span><span class="sxs-lookup"><span data-stu-id="94d9b-130">The `Declare` statement includes the following elements.</span></span>  
  
#### <a name="auto-modifier"></a><span data-ttu-id="94d9b-131">Modificador auto</span><span class="sxs-lookup"><span data-stu-id="94d9b-131">Auto modifier</span></span>  
 <span data-ttu-id="94d9b-132">O `Auto` modificador instrui o runtime a converter a cadeia de caracteres com base no nome do método de acordo com regras de tempo de execução de linguagem comum (ou alias se especificado).</span><span class="sxs-lookup"><span data-stu-id="94d9b-132">The `Auto` modifier instructs the runtime to convert the string based on the method name according to common language runtime rules (or alias name if specified).</span></span>  
  
#### <a name="lib-and-alias-keywords"></a><span data-ttu-id="94d9b-133">Palavras-chave lib e Alias</span><span class="sxs-lookup"><span data-stu-id="94d9b-133">Lib and Alias keywords</span></span>  
 <span data-ttu-id="94d9b-134">O nome após o `Function` palavra-chave é o nome que seu programa usa para acessar a função importada.</span><span class="sxs-lookup"><span data-stu-id="94d9b-134">The name following the `Function` keyword is the name your program uses to access the imported function.</span></span> <span data-ttu-id="94d9b-135">Pode ser o mesmo que o nome real da função que você está chamando, ou você pode usar qualquer nome válido de procedimento e, em seguida, utilize o `Alias` palavra-chave para especificar o nome real da função que você está chamando.</span><span class="sxs-lookup"><span data-stu-id="94d9b-135">It can be the same as the real name of the function you are calling, or you can use any valid procedure name and then employ the `Alias` keyword to specify the real name of the function you are calling.</span></span>  
  
 <span data-ttu-id="94d9b-136">Especifique o `Lib` palavra-chave, seguido do nome e local da DLL que contém a função que você está chamando.</span><span class="sxs-lookup"><span data-stu-id="94d9b-136">Specify the `Lib` keyword, followed by the name and location of the DLL that contains the function you are calling.</span></span> <span data-ttu-id="94d9b-137">Você não precisa especificar o caminho para arquivos localizados nos diretórios do sistema Windows.</span><span class="sxs-lookup"><span data-stu-id="94d9b-137">You do not need to specify the path for files located in the Windows system directories.</span></span>  
  
 <span data-ttu-id="94d9b-138">Use o `Alias` palavra-chave se o nome da função que você está chamando não é válido [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] nome do procedimento ou está em conflito com o nome de outros itens em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="94d9b-138">Use the `Alias` keyword if the name of the function you are calling is not a valid [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] procedure name, or conflicts with the name of other items in your application.</span></span> <span data-ttu-id="94d9b-139">`Alias`indica o nome da função que está sendo chamado.</span><span class="sxs-lookup"><span data-stu-id="94d9b-139">`Alias` indicates the true name of the function being called.</span></span>  
  
#### <a name="argument-and-data-type-declarations"></a><span data-ttu-id="94d9b-140">Argumento e declarações de tipo de dados</span><span class="sxs-lookup"><span data-stu-id="94d9b-140">Argument and Data Type Declarations</span></span>  
 <span data-ttu-id="94d9b-141">Declare os argumentos e seus tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="94d9b-141">Declare the arguments and their data types.</span></span> <span data-ttu-id="94d9b-142">Esta parte pode ser desafiadora porque os tipos de dados que o Windows usa não correspondem aos tipos de dados do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="94d9b-142">This part can be challenging because the data types that Windows uses do not correspond to Visual Studio data types.</span></span> [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]<span data-ttu-id="94d9b-143">faz muito do trabalho ao converter argumentos para tipos de dados compatíveis, um processo chamado *empacotamento*.</span><span class="sxs-lookup"><span data-stu-id="94d9b-143"> does a lot of the work for you by converting arguments to compatible data types, a process called *marshaling*.</span></span> <span data-ttu-id="94d9b-144">Você pode controlar explicitamente como argumentos são empacotados usando o <xref:System.Runtime.InteropServices.MarshalAsAttribute>atributo definido no <xref:System.Runtime.InteropServices>namespace.</xref:System.Runtime.InteropServices> </xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="94d9b-144">You can explicitly control how arguments are marshaled by using the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute defined in the <xref:System.Runtime.InteropServices> namespace.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="94d9b-145">Versões anteriores do [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] permitido declarar parâmetros `As Any`, que significa que os dados de qualquer dado tipo pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="94d9b-145">Previous versions of [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] allowed you to declare parameters `As Any`, meaning that data of any data type could be used.</span></span> [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]<span data-ttu-id="94d9b-146">requer que você use um tipo de dados específico para todas as `Declare` instruções.</span><span class="sxs-lookup"><span data-stu-id="94d9b-146"> requires that you use a specific data type for all `Declare` statements.</span></span>  
  
#### <a name="windows-api-constants"></a><span data-ttu-id="94d9b-147">Constantes de API do Windows</span><span class="sxs-lookup"><span data-stu-id="94d9b-147">Windows API Constants</span></span>  
 <span data-ttu-id="94d9b-148">Alguns argumentos são combinações de constantes.</span><span class="sxs-lookup"><span data-stu-id="94d9b-148">Some arguments are combinations of constants.</span></span> <span data-ttu-id="94d9b-149">Por exemplo, o `MessageBox` API mostrado neste passo a passo aceita um argumento integer chamado `Typ` que controla como a caixa de mensagem é exibida.</span><span class="sxs-lookup"><span data-stu-id="94d9b-149">For example, the `MessageBox` API shown in this walkthrough accepts an integer argument called `Typ` that controls how the message box is displayed.</span></span> <span data-ttu-id="94d9b-150">Você pode determinar o valor numérico de constantes examinando o `#define` instruções no arquivo WinUser. H.</span><span class="sxs-lookup"><span data-stu-id="94d9b-150">You can determine the numeric value of these constants by examining the `#define` statements in the file WinUser.h.</span></span> <span data-ttu-id="94d9b-151">Os valores numéricos geralmente são mostrados em hexadecimal, portanto você pode usar uma calculadora para adicioná-los e converter em decimal.</span><span class="sxs-lookup"><span data-stu-id="94d9b-151">The numeric values are generally shown in hexadecimal, so you may want to use a calculator to add them and convert to decimal.</span></span> <span data-ttu-id="94d9b-152">Por exemplo, se você desejar combinar as constantes para o estilo de exclamação `MB_ICONEXCLAMATION` 0x00000030 e Sim/não estilo `MB_YESNO` 0x00000004, você pode adicionar os números e obter um resultado de 0x00000034, ou 52 decimal.</span><span class="sxs-lookup"><span data-stu-id="94d9b-152">For example, if you want to combine the constants for the exclamation style `MB_ICONEXCLAMATION` 0x00000030 and the Yes/No style `MB_YESNO` 0x00000004, you can add the numbers and get a result of 0x00000034, or 52 decimal.</span></span> <span data-ttu-id="94d9b-153">Embora você possa usar diretamente o resultado decimal, é melhor declarar esses valores como constantes em seu aplicativo e combiná-los usando o `Or` operador.</span><span class="sxs-lookup"><span data-stu-id="94d9b-153">Although you can use the decimal result directly, it is better to declare these values as constants in your application and combine them using the `Or` operator.</span></span>  
  
###### <a name="to-declare-constants-for-windows-api-calls"></a><span data-ttu-id="94d9b-154">Para declarar constantes para chamadas de API do Windows</span><span class="sxs-lookup"><span data-stu-id="94d9b-154">To declare constants for Windows API calls</span></span>  
  
1.  <span data-ttu-id="94d9b-155">Consulte a documentação para a função do Windows que você está chamando.</span><span class="sxs-lookup"><span data-stu-id="94d9b-155">Consult the documentation for the Windows function you are calling.</span></span> <span data-ttu-id="94d9b-156">Determine o nome de constantes que são usadas e o nome do arquivo. h que contém os valores numéricos para constantes.</span><span class="sxs-lookup"><span data-stu-id="94d9b-156">Determine the name of the constants it uses and the name of the .h file that contains the numeric values for these constants.</span></span>  
  
2.  <span data-ttu-id="94d9b-157">Use um editor de texto, como o bloco de notas, para exibir o conteúdo do arquivo de cabeçalho (. h) e localizar os valores associados às constantes que você está usando.</span><span class="sxs-lookup"><span data-stu-id="94d9b-157">Use a text editor, such as Notepad, to view the contents of the header (.h) file, and find the values associated with the constants you are using.</span></span> <span data-ttu-id="94d9b-158">Por exemplo, o `MessageBox` API usa a constante `MB_ICONQUESTION` para mostrar um ponto de interrogação na caixa de mensagem.</span><span class="sxs-lookup"><span data-stu-id="94d9b-158">For example, the `MessageBox` API uses the constant `MB_ICONQUESTION` to show a question mark in the message box.</span></span> <span data-ttu-id="94d9b-159">A definição de `MB_ICONQUESTION` está na WinUser. H e aparece da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="94d9b-159">The definition for `MB_ICONQUESTION` is in WinUser.h and appears as follows:</span></span>  
  
     `#define MB_ICONQUESTION             0x00000020L`  
  
3.  <span data-ttu-id="94d9b-160">Adicionar equivalente `Const` instruções à sua classe ou módulo para tornar essas constantes disponíveis para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="94d9b-160">Add equivalent `Const` statements to your class or module to make these constants available to your application.</span></span> <span data-ttu-id="94d9b-161">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="94d9b-161">For example:</span></span>  
  
     <span data-ttu-id="94d9b-162">[!code-vb[VbVbalrInterop n º&11;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-162">[!code-vb[VbVbalrInterop#11](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_2.vb)]</span></span>  
  
###### <a name="to-call-the-dll-procedure"></a><span data-ttu-id="94d9b-163">Para chamar o procedimento DLL</span><span class="sxs-lookup"><span data-stu-id="94d9b-163">To call the DLL procedure</span></span>  
  
1.  <span data-ttu-id="94d9b-164">Adicione um botão chamado `Button1` para a inicialização do formulário para o seu projeto e, em seguida, clique duas vezes nele para exibir seu código.</span><span class="sxs-lookup"><span data-stu-id="94d9b-164">Add a button named `Button1` to the startup form for your project, and then double-click it to view its code.</span></span> <span data-ttu-id="94d9b-165">O manipulador de eventos para o botão é exibido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-165">The event handler for the button is displayed.</span></span>  
  
2.  <span data-ttu-id="94d9b-166">Adicione código para o `Click` manipulador de eventos para o botão é adicionado, para chamar o procedimento e forneça os argumentos apropriados:</span><span class="sxs-lookup"><span data-stu-id="94d9b-166">Add code to the `Click` event handler for the button you added, to call the procedure and provide the appropriate arguments:</span></span>  
  
     <span data-ttu-id="94d9b-167">[!code-vb[VbVbalrInterop&#12;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-167">[!code-vb[VbVbalrInterop#12](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_3.vb)]</span></span>  
  
3.  <span data-ttu-id="94d9b-168">Execute o projeto pressionando F5.</span><span class="sxs-lookup"><span data-stu-id="94d9b-168">Run the project by pressing F5.</span></span> <span data-ttu-id="94d9b-169">A caixa de mensagem é exibida com as **Sim** e **não** botões de resposta.</span><span class="sxs-lookup"><span data-stu-id="94d9b-169">The message box is displayed with both **Yes** and **No** response buttons.</span></span> <span data-ttu-id="94d9b-170">Clique em qualquer um.</span><span class="sxs-lookup"><span data-stu-id="94d9b-170">Click either one.</span></span>  
  
#### <a name="data-marshaling"></a><span data-ttu-id="94d9b-171">Marshaling de dados</span><span class="sxs-lookup"><span data-stu-id="94d9b-171">Data Marshaling</span></span>  
 [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]<span data-ttu-id="94d9b-172">automaticamente converte os tipos de dados de parâmetros e valores de retorno para chamadas de API do Windows, mas você podem usar o `MarshalAs` atributo para especificar os tipos de dados não gerenciados que esperam uma API explicitamente.</span><span class="sxs-lookup"><span data-stu-id="94d9b-172"> automatically converts the data types of parameters and return values for Windows API calls, but you can use the `MarshalAs` attribute to explicitly specify unmanaged data types that an API expects.</span></span> <span data-ttu-id="94d9b-173">Para obter mais informações sobre empacotamento de interoperabilidade, consulte [Interop Marshaling](http://msdn.microsoft.com/library/115f7a2f-d422-4605-ab36-13a8dd28142a).</span><span class="sxs-lookup"><span data-stu-id="94d9b-173">For more information about interop marshaling, see [Interop Marshaling](http://msdn.microsoft.com/library/115f7a2f-d422-4605-ab36-13a8dd28142a).</span></span>  
  
###### <a name="to-use-declare-and-marshalas-in-an-api-call"></a><span data-ttu-id="94d9b-174">Para usar Declare e MarshalAs em uma chamada de API</span><span class="sxs-lookup"><span data-stu-id="94d9b-174">To use Declare and MarshalAs in an API call</span></span>  
  
1.  <span data-ttu-id="94d9b-175">Determinar o nome da função que você deseja chamar, mais seus argumentos, tipos de dados, e o valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="94d9b-175">Determine the name of the function you want to call, plus its arguments, data types, and return value.</span></span>  
  
2.  <span data-ttu-id="94d9b-176">Para simplificar o acesso para o `MarshalAs` de atributo, adicione um `Imports` à parte superior do código para a classe ou módulo, como no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="94d9b-176">To simplify access to the `MarshalAs` attribute, add an `Imports` statement to the top of the code for the class or module, as in the following example:</span></span>  
  
     <span data-ttu-id="94d9b-177">[!code-vb[VbVbalrInterop&13;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-177">[!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]</span></span>  
  
3.  <span data-ttu-id="94d9b-178">Adicione um protótipo de função para a função importada para a classe ou módulo que você está usando e aplica o `MarshalAs` atributo aos parâmetros ou valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="94d9b-178">Add a function prototype for the imported function to the class or module you are using, and apply the `MarshalAs` attribute to the parameters or return value.</span></span> <span data-ttu-id="94d9b-179">No exemplo a seguir, uma chamada de API que espera que o tipo `void*` é empacotada como `AsAny`:</span><span class="sxs-lookup"><span data-stu-id="94d9b-179">In the following example, an API call that expects the type `void*` is marshaled as `AsAny`:</span></span>  
  
     <span data-ttu-id="94d9b-180">[!code-vb[VbVbalrInterop&#14;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-180">[!code-vb[VbVbalrInterop#14](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_5.vb)]</span></span>  
  
## <a name="api-calls-using-dllimport"></a><span data-ttu-id="94d9b-181">Chamadas de API usando DllImport</span><span class="sxs-lookup"><span data-stu-id="94d9b-181">API Calls Using DllImport</span></span>  
 <span data-ttu-id="94d9b-182">O `DllImport` atributo fornece uma segunda maneira para chamar funções em DLLs sem bibliotecas de tipos.</span><span class="sxs-lookup"><span data-stu-id="94d9b-182">The `DllImport` attribute provides a second way to call functions in DLLs without type libraries.</span></span> <span data-ttu-id="94d9b-183">`DllImport`é aproximadamente equivalente a usar um `Declare` instrução mas oferece mais controle sobre como as funções são chamadas.</span><span class="sxs-lookup"><span data-stu-id="94d9b-183">`DllImport` is roughly equivalent to using a `Declare` statement but provides more control over how functions are called.</span></span>  
  
 <span data-ttu-id="94d9b-184">Você pode usar `DllImport` com a API do Windows a maioria das chamadas, desde a chamada se refira a um compartilhado (às vezes chamado de *estático*) método.</span><span class="sxs-lookup"><span data-stu-id="94d9b-184">You can use `DllImport` with most Windows API calls as long as the call refers to a shared (sometimes called *static*) method.</span></span> <span data-ttu-id="94d9b-185">Você não pode usar os métodos que requerem uma instância de uma classe.</span><span class="sxs-lookup"><span data-stu-id="94d9b-185">You cannot use methods that require an instance of a class.</span></span> <span data-ttu-id="94d9b-186">Ao contrário de `Declare` instruções, `DllImport` chamadas não é possível usar o `MarshalAs` atributo.</span><span class="sxs-lookup"><span data-stu-id="94d9b-186">Unlike `Declare` statements, `DllImport` calls cannot use the `MarshalAs` attribute.</span></span>  
  
#### <a name="to-call-a-windows-api-using-the-dllimport-attribute"></a><span data-ttu-id="94d9b-187">Para chamar uma API do Windows usando o atributo DllImport</span><span class="sxs-lookup"><span data-stu-id="94d9b-187">To call a Windows API using the DllImport attribute</span></span>  
  
1.  <span data-ttu-id="94d9b-188">Abra um novo projeto de aplicativo do Windows clicando em **novo** no **arquivo** menu e, em seguida, clicando em **projeto**.</span><span class="sxs-lookup"><span data-stu-id="94d9b-188">Open a new Windows Application project by clicking **New** on the **File** menu, and then clicking **Project**.</span></span> <span data-ttu-id="94d9b-189">A caixa de diálogo **Novo Projeto** é exibida.</span><span class="sxs-lookup"><span data-stu-id="94d9b-189">The **New Project** dialog box appears.</span></span>  
  
2.  <span data-ttu-id="94d9b-190">Selecione **Windows Application** da lista de [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] modelos de projeto.</span><span class="sxs-lookup"><span data-stu-id="94d9b-190">Select **Windows Application** from the list of [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] project templates.</span></span> <span data-ttu-id="94d9b-191">O novo projeto é exibido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-191">The new project is displayed.</span></span>  
  
3.  <span data-ttu-id="94d9b-192">Adicione um botão chamado `Button2` para o formulário de inicialização.</span><span class="sxs-lookup"><span data-stu-id="94d9b-192">Add a button named `Button2` to the startup form.</span></span>  
  
4.  <span data-ttu-id="94d9b-193">Clique duas vezes em `Button2` para abrir o modo de exibição de código para o formulário.</span><span class="sxs-lookup"><span data-stu-id="94d9b-193">Double-click `Button2` to open the code view for the form.</span></span>  
  
5.  <span data-ttu-id="94d9b-194">Para simplificar o acesso ao `DllImport`, adicione um `Imports` à parte superior do código para a classe de formulário de inicialização:</span><span class="sxs-lookup"><span data-stu-id="94d9b-194">To simplify access to `DllImport`, add an `Imports` statement to the top of the code for the startup form class:</span></span>  
  
     <span data-ttu-id="94d9b-195">[!code-vb[VbVbalrInterop&13;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-195">[!code-vb[VbVbalrInterop#13](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_4.vb)]</span></span>  
  
6.  <span data-ttu-id="94d9b-196">Declarar uma função vazia que precede o `End Class` instrução para o formulário e nomeie a função `MoveFile`.</span><span class="sxs-lookup"><span data-stu-id="94d9b-196">Declare an empty function preceding the `End Class` statement for the form, and name the function `MoveFile`.</span></span>  
  
7.  <span data-ttu-id="94d9b-197">Aplicar o `Public` e `Shared` modificadores à função de declaração e definir parâmetros para `MoveFile` com base nos argumentos que função API do Windows usa:</span><span class="sxs-lookup"><span data-stu-id="94d9b-197">Apply the `Public` and `Shared` modifiers to the function declaration and set parameters for `MoveFile` based on the arguments the Windows API function uses:</span></span>  
  
     <span data-ttu-id="94d9b-198">[!code-vb[VbVbalrInterop n º&16;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-198">[!code-vb[VbVbalrInterop#16](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_6.vb)]</span></span>  
  
     <span data-ttu-id="94d9b-199">Sua função pode ter qualquer nome válido de procedimento; o `DllImport` atributo especifica o nome na DLL.</span><span class="sxs-lookup"><span data-stu-id="94d9b-199">Your function can have any valid procedure name; the `DllImport` attribute specifies the name in the DLL.</span></span> <span data-ttu-id="94d9b-200">Ele também trata interoperabilidade de empacotamento para os parâmetros e a API usa tipos de valores de retorno, assim você pode escolher os tipos de dados do Visual Studio que são semelhantes aos dados.</span><span class="sxs-lookup"><span data-stu-id="94d9b-200">It also handles interoperability marshaling for the parameters and return values, so you can choose Visual Studio data types that are similar to the data types the API uses.</span></span>  
  
8.  <span data-ttu-id="94d9b-201">Aplicar o `DllImport` atributo à função vazia.</span><span class="sxs-lookup"><span data-stu-id="94d9b-201">Apply the `DllImport` attribute to the empty function.</span></span> <span data-ttu-id="94d9b-202">O primeiro parâmetro é o nome e o local da DLL que contém a função que você está chamando.</span><span class="sxs-lookup"><span data-stu-id="94d9b-202">The first parameter is the name and location of the DLL containing the function you are calling.</span></span> <span data-ttu-id="94d9b-203">Você não precisa especificar o caminho para arquivos localizados nos diretórios do sistema Windows.</span><span class="sxs-lookup"><span data-stu-id="94d9b-203">You do not need to specify the path for files located in the Windows system directories.</span></span> <span data-ttu-id="94d9b-204">O segundo parâmetro é um argumento nomeado que especifica o nome da função da API do Windows.</span><span class="sxs-lookup"><span data-stu-id="94d9b-204">The second parameter is a named argument that specifies the name of the function in the Windows API.</span></span> <span data-ttu-id="94d9b-205">Neste exemplo, o `DllImport` atributo força chamadas para `MoveFile` sejam encaminhados para `MoveFileW` em KERNEL32. DLL.</span><span class="sxs-lookup"><span data-stu-id="94d9b-205">In this example, the `DllImport` attribute forces calls to `MoveFile` to be forwarded to `MoveFileW` in KERNEL32.DLL.</span></span> <span data-ttu-id="94d9b-206">O `MoveFileW` método copia um arquivo do caminho de `src` para o caminho `dst`.</span><span class="sxs-lookup"><span data-stu-id="94d9b-206">The `MoveFileW` method copies a file from the path `src` to the path `dst`.</span></span>  
  
     <span data-ttu-id="94d9b-207">[!code-vb[17 VbVbalrInterop](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-207">[!code-vb[VbVbalrInterop#17](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_7.vb)]</span></span>  
  
9. <span data-ttu-id="94d9b-208">Adicione código para o `Button2_Click` manipulador de eventos para chamar a função:</span><span class="sxs-lookup"><span data-stu-id="94d9b-208">Add code to the `Button2_Click` event handler to call the function:</span></span>  
  
     <span data-ttu-id="94d9b-209">[!code-vb[VbVbalrInterop n º&18;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_8.vb)]</span><span class="sxs-lookup"><span data-stu-id="94d9b-209">[!code-vb[VbVbalrInterop#18](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/walkthrough-calling-windows-apis_8.vb)]</span></span>  
  
10. <span data-ttu-id="94d9b-210">Crie um arquivo chamado Test. txt e coloque-na pasta C:\Tmp em seu disco rígido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-210">Create a file named Test.txt and place it in the C:\Tmp directory on your hard drive.</span></span> <span data-ttu-id="94d9b-211">Crie a pasta Tmp, se necessário.</span><span class="sxs-lookup"><span data-stu-id="94d9b-211">Create the Tmp directory if necessary.</span></span>  
  
11. <span data-ttu-id="94d9b-212">Pressione F5 para iniciar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="94d9b-212">Press F5 to start the application.</span></span> <span data-ttu-id="94d9b-213">O formulário principal é exibido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-213">The main form appears.</span></span>  
  
12. <span data-ttu-id="94d9b-214">Clique em **Button2**.</span><span class="sxs-lookup"><span data-stu-id="94d9b-214">Click **Button2**.</span></span> <span data-ttu-id="94d9b-215">A mensagem "o arquivo foi movido com êxito" será exibida se o arquivo pode ser movido.</span><span class="sxs-lookup"><span data-stu-id="94d9b-215">The message "The file was moved successfully" is displayed if the file can be moved.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="94d9b-216">Consulte também</span><span class="sxs-lookup"><span data-stu-id="94d9b-216">See Also</span></span>  
 <span data-ttu-id="94d9b-217"><xref:System.Runtime.InteropServices.DllImportAttribute></xref:System.Runtime.InteropServices.DllImportAttribute></span><span class="sxs-lookup"><span data-stu-id="94d9b-217"><xref:System.Runtime.InteropServices.DllImportAttribute></span></span>   
 <span data-ttu-id="94d9b-218"><xref:System.Runtime.InteropServices.MarshalAsAttribute></xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="94d9b-218"><xref:System.Runtime.InteropServices.MarshalAsAttribute></span></span>   
<span data-ttu-id="94d9b-219"> [Instrução Declare](../../../visual-basic/language-reference/statements/declare-statement.md) </span><span class="sxs-lookup"><span data-stu-id="94d9b-219"> [Declare Statement](../../../visual-basic/language-reference/statements/declare-statement.md) </span></span>  
<span data-ttu-id="94d9b-220"> [Automático](../../../visual-basic/language-reference/modifiers/auto.md) </span><span class="sxs-lookup"><span data-stu-id="94d9b-220"> [Auto](../../../visual-basic/language-reference/modifiers/auto.md) </span></span>  
<span data-ttu-id="94d9b-221"> [Alias](../../../visual-basic/language-reference/statements/alias-clause.md) </span><span class="sxs-lookup"><span data-stu-id="94d9b-221"> [Alias](../../../visual-basic/language-reference/statements/alias-clause.md) </span></span>  
<span data-ttu-id="94d9b-222"> [Interoperabilidade COM](../../../visual-basic/programming-guide/com-interop/index.md) </span><span class="sxs-lookup"><span data-stu-id="94d9b-222"> [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md) </span></span>  
<span data-ttu-id="94d9b-223"> [Criando protótipos em código gerenciado](http://msdn.microsoft.com/library/ecdcf25d-cae3-4f07-a2b6-8397ac6dc42d) </span><span class="sxs-lookup"><span data-stu-id="94d9b-223"> [Creating Prototypes in Managed Code](http://msdn.microsoft.com/library/ecdcf25d-cae3-4f07-a2b6-8397ac6dc42d) </span></span>  
<span data-ttu-id="94d9b-224"> [Empacotamento de um delegado como um método de retorno de chamada](http://msdn.microsoft.com/library/6ddd7866-9804-4571-84de-83f5cc017a5a)</span><span class="sxs-lookup"><span data-stu-id="94d9b-224"> [Marshaling a Delegate as a Callback Method](http://msdn.microsoft.com/library/6ddd7866-9804-4571-84de-83f5cc017a5a)</span></span>
