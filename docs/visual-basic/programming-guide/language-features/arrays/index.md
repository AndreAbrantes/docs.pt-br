---
title: Matrizes no Visual Basic
ms.date: 12/06/2017
f1_keywords:
  - vb.Array
helpviewer_keywords:
  - 'arrays [Visual Basic]'
  - 'Visual Basic, arrays'
ms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e
---

# <a name="arrays-in-visual-basic"></a><span data-ttu-id="c1240-102">Matrizes no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c1240-102">Arrays in Visual Basic</span></span>

<span data-ttu-id="c1240-103">Uma matriz é um conjunto de valores, que são chamados *elementos*, que são logicamente relacionados uns aos outros.</span><span class="sxs-lookup"><span data-stu-id="c1240-103">An array is a set of values, which are termed *elements*, that are logically related to each other.</span></span> <span data-ttu-id="c1240-104">Por exemplo, uma matriz pode consistir no número de alunos em cada nível em uma escola primária; cada elemento da matriz é o número de alunos em uma única nota.</span><span class="sxs-lookup"><span data-stu-id="c1240-104">For example, an array may consist of the number of students in each grade in a grammar school; each element of the array is the number of students in a single grade.</span></span> <span data-ttu-id="c1240-105">Da mesma forma, uma matriz pode consistir em curso de um aluno para uma classe; cada elemento da matriz é uma única nota.</span><span class="sxs-lookup"><span data-stu-id="c1240-105">Similarly, an array may consist of a student's grades for a class; each element of the array is a single grade.</span></span>

<span data-ttu-id="c1240-106">É possíveis variáveis individuais para armazenar cada um dos nossos itens de dados.</span><span class="sxs-lookup"><span data-stu-id="c1240-106">It is possible individual variables to store each of our data items.</span></span> <span data-ttu-id="c1240-107">Por exemplo, se o nosso aplicativo analisa as notas de alunos, podemos usar uma variável separada para cada nota do aluno, tais como `englishGrade1`, `englishGrade2`, etc. Essa abordagem tem três principais limitações:</span><span class="sxs-lookup"><span data-stu-id="c1240-107">For example, if our application analyzes student grades, we can use a separate variable for each student's grade, such as `englishGrade1`, `englishGrade2`, etc. This approach has three major limitations:</span></span>

- <span data-ttu-id="c1240-108">Precisamos saber em tempo de design exatamente quantas notas que temos de lidar com.</span><span class="sxs-lookup"><span data-stu-id="c1240-108">We have to know at design time exactly how many grades we have to handle.</span></span>
- <span data-ttu-id="c1240-109">Tratamento de grandes números de notas rapidamente se torna complicado.</span><span class="sxs-lookup"><span data-stu-id="c1240-109">Handling large numbers of grades quickly becomes unwieldy.</span></span> <span data-ttu-id="c1240-110">Isso torna um aplicativo muito mais probabilidade de ter sérios erros.</span><span class="sxs-lookup"><span data-stu-id="c1240-110">This in turn makes an application much more likely to have serious bugs.</span></span>
- <span data-ttu-id="c1240-111">É difícil de manter.</span><span class="sxs-lookup"><span data-stu-id="c1240-111">It is difficult to maintain.</span></span> <span data-ttu-id="c1240-112">Cada nível novo que adicionamos requer que o aplicativo ser modificado, recompilado e reimplantado.</span><span class="sxs-lookup"><span data-stu-id="c1240-112">Each new grade that we add requires that the application be modified, recompiled, and redeployed.</span></span>

<span data-ttu-id="c1240-113">Usando uma matriz, você pode consultar esses valores relacionados com o mesmo nome e usar um número que é chamado de um *índice* ou *subscrito* para identificar um elemento individual com base em sua posição na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-113">By using an array, you can refer to these related values by the same name, and use a number that’s called an *index* or *subscript* to identify an individual element based on its position in the array.</span></span> <span data-ttu-id="c1240-114">Os índices de uma matriz variam de 0 a menos que o número total de elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-114">The indexes of an array range from 0 to one less than the total number of elements in the array.</span></span> <span data-ttu-id="c1240-115">Quando você usa a sintaxe do Visual Basic para definir o tamanho de uma matriz, você pode especificar o índice mais alto, não o número total de elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-115">When you use Visual Basic syntax to define the size of an array, you specify its highest index, not the total number of elements in the array.</span></span> <span data-ttu-id="c1240-116">Você pode trabalhar com a matriz como uma unidade e a capacidade de iterar seus elementos libera você da necessidade de saber exatamente quantos elementos ela contém no tempo de design.</span><span class="sxs-lookup"><span data-stu-id="c1240-116">You can work with the array as a unit, and the ability to iterate its elements frees you from needing to know exactly how many elements it contains at design time.</span></span>

<span data-ttu-id="c1240-117">Alguns exemplos rápidos antes da explicação:</span><span class="sxs-lookup"><span data-stu-id="c1240-117">Some quick examples before explanation:</span></span>

```vb
' Declare a single-dimension array of 5 numbers.
Dim numbers(4) As Integer

'Declare a single-dimension array and set its 4 values.
Dim numbers = New Integer() {1, 2, 4, 8}

' Change the size of an existing array to 16 elements and retain the current values.
ReDim Preserve numbers(15)

' Redefine the size of an existing array and reset the values.
ReDim numbers(15)

' Declare a 6 x 6 multidimensional array.
Dim matrix(5, 5) As Double

' Declare a 4 x 3 multidimensional array and set array element values.
Dim matrix = New Integer(3, 2) {{1, 2, 3}, {2, 3, 4}, {3, 4, 5}, {4, 5, 6}}

' Declare a jagged array
Dim sales()() As Double = New Double(11)() {}
```

## <a name="array-elements-in-a-simple-array"></a><span data-ttu-id="c1240-118">Elementos da matriz em uma matriz simples</span><span class="sxs-lookup"><span data-stu-id="c1240-118">Array elements in a simple array</span></span>

<span data-ttu-id="c1240-119">Vamos criar uma matriz chamada `students` para armazenar o número de alunos em cada nível em uma escola primária.</span><span class="sxs-lookup"><span data-stu-id="c1240-119">Let's create an array named `students` to store the number of students in each grade in a grammar school.</span></span> <span data-ttu-id="c1240-120">Os índices dos elementos variam de 0 a 6.</span><span class="sxs-lookup"><span data-stu-id="c1240-120">The indexes of the elements range from 0 through 6.</span></span> <span data-ttu-id="c1240-121">Usar essa matriz é mais simples do que declarar sete variáveis.</span><span class="sxs-lookup"><span data-stu-id="c1240-121">Using this array is simpler than declaring seven variables.</span></span>

<span data-ttu-id="c1240-122">A ilustração a seguir mostra o `students` matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-122">The following illustration shows the `students` array.</span></span> <span data-ttu-id="c1240-123">Para cada elemento da matriz:</span><span class="sxs-lookup"><span data-stu-id="c1240-123">For each element of the array:</span></span>

- <span data-ttu-id="c1240-124">O índice do elemento representa a classificação (o índice 0 representa o jardim de infância).</span><span class="sxs-lookup"><span data-stu-id="c1240-124">The index of the element represents the grade (index 0 represents kindergarten).</span></span>

- <span data-ttu-id="c1240-125">O valor contido no elemento representa o número de alunos nessa série.</span><span class="sxs-lookup"><span data-stu-id="c1240-125">The value that’s contained in the element represents the number of students in that grade.</span></span>

![Diagrama que mostra uma matriz de números de alunos](./media/index/students-array-elements.gif)

<span data-ttu-id="c1240-127">O exemplo a seguir contém o código do Visual Basic que cria e usa a matriz:</span><span class="sxs-lookup"><span data-stu-id="c1240-127">The following example contains the Visual Basic code that creates and uses the array:</span></span>

[!code-vb[simple-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/simple-array.vb)]

<span data-ttu-id="c1240-128">O exemplo faz três coisas:</span><span class="sxs-lookup"><span data-stu-id="c1240-128">The example does three things:</span></span>

- <span data-ttu-id="c1240-129">Ele declara um `students` matriz com sete elementos.</span><span class="sxs-lookup"><span data-stu-id="c1240-129">It declares a `students` array with seven elements.</span></span> <span data-ttu-id="c1240-130">O número `6` na matriz de declaração indica o último índice na matriz; ele é um menor do que o número de elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-130">The number `6` in the array declaration indicates the last index in the array; it is one less than the number of elements in the array.</span></span>
- <span data-ttu-id="c1240-131">Ele atribui valores a cada elemento da matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-131">It assigns values to each element in the array.</span></span> <span data-ttu-id="c1240-132">Elementos da matriz são acessados usando o nome da matriz e incluindo o índice do elemento individual entre parênteses.</span><span class="sxs-lookup"><span data-stu-id="c1240-132">Array elements are accessed by using the array name and including the index of the individual element in parentheses.</span></span>
- <span data-ttu-id="c1240-133">Ele lista cada valor da matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-133">It lists each value of the array.</span></span> <span data-ttu-id="c1240-134">O exemplo usa uma [ `For` ](../../../language-reference/statements/for-next-statement.md) instrução para acessar cada elemento da matriz por seu número de índice.</span><span class="sxs-lookup"><span data-stu-id="c1240-134">The example uses a [`For`](../../../language-reference/statements/for-next-statement.md) statement to access each element of the array by its index number.</span></span>

<span data-ttu-id="c1240-135">O `students` matriz no exemplo anterior é uma matriz unidimensional, porque ele usa um índice.</span><span class="sxs-lookup"><span data-stu-id="c1240-135">The `students` array in the preceding example is a one-dimensional array because it uses one index.</span></span> <span data-ttu-id="c1240-136">Uma matriz que usa mais de um índice ou subscrito é chamada *multidimensional*.</span><span class="sxs-lookup"><span data-stu-id="c1240-136">An array that uses more than one index or subscript is called *multidimensional*.</span></span> <span data-ttu-id="c1240-137">Para obter mais informações, consulte o restante deste artigo e [dimensões de matriz no Visual Basic](../../language-features/arrays/array-dimensions.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-137">For more information, see the rest of this article and [Array Dimensions in Visual Basic](../../language-features/arrays/array-dimensions.md).</span></span>

## <a name="creating-an-array"></a><span data-ttu-id="c1240-138">Criando uma matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-138">Creating an array</span></span>

<span data-ttu-id="c1240-139">Você pode definir o tamanho de uma matriz de várias maneiras:</span><span class="sxs-lookup"><span data-stu-id="c1240-139">You can define the size of an array in several ways:</span></span>

- <span data-ttu-id="c1240-140">Você pode especificar o tamanho quando a matriz é declarada:</span><span class="sxs-lookup"><span data-stu-id="c1240-140">You can specify the size when the array is declared:</span></span>

  [!code-vb[creating1](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#1)]

- <span data-ttu-id="c1240-141">Você pode usar um `New` cláusula para fornecer o tamanho de uma matriz quando ele é criado:</span><span class="sxs-lookup"><span data-stu-id="c1240-141">You can use a `New` clause to supply the size of an array when it’s created:</span></span>

  [!code-vb[creating2](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#2)]

<span data-ttu-id="c1240-142">Se você tiver uma matriz existente, você poderá redefinir o tamanho usando o [ `ReDim` ](../../../language-reference/statements/redim-statement.md) instrução.</span><span class="sxs-lookup"><span data-stu-id="c1240-142">If you have an existing array, you can redefine its size by using the [`ReDim`](../../../language-reference/statements/redim-statement.md) statement.</span></span> <span data-ttu-id="c1240-143">Você pode especificar que o `ReDim` instrução manter os valores que estão na matriz, ou você pode especificar que ele crie uma matriz vazia.</span><span class="sxs-lookup"><span data-stu-id="c1240-143">You can specify that the `ReDim` statement keep the values that are in the array, or you can specify that it create an empty array.</span></span> <span data-ttu-id="c1240-144">O exemplo a seguir mostra os diferentes usos da instrução `ReDim` para modificar o tamanho de uma matriz existente.</span><span class="sxs-lookup"><span data-stu-id="c1240-144">The following example shows different uses of the `ReDim` statement to modify the size of an existing array.</span></span>

[!code-vb[redimensioning](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#3)]

<span data-ttu-id="c1240-145">Para obter mais informações, consulte o [instrução ReDim](../../../language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-145">For more information, see the [ReDim Statement](../../../language-reference/statements/redim-statement.md).</span></span>

## <a name="storing-values-in-an-array"></a><span data-ttu-id="c1240-146">Armazenando valores em uma matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-146">Storing values in an array</span></span>

<span data-ttu-id="c1240-147">Você pode acessar cada local em uma matriz usando um índice do tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="c1240-147">You can access each location in an array by using an index of type `Integer`.</span></span> <span data-ttu-id="c1240-148">Você pode armazenar e recuperar valores em uma matriz, fazendo referência a cada local de matriz usando seu índice entre parênteses.</span><span class="sxs-lookup"><span data-stu-id="c1240-148">You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses.</span></span> <span data-ttu-id="c1240-149">Índices de matrizes multidimensionais são separados por vírgulas (,).</span><span class="sxs-lookup"><span data-stu-id="c1240-149">Indexes for multidimensional arrays are separated by commas (,).</span></span> <span data-ttu-id="c1240-150">Você precisa de um índice para cada dimensão de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-150">You need one index for each array dimension.</span></span>

<span data-ttu-id="c1240-151">O exemplo a seguir mostra algumas declarações que armazenam e recuperam valores em matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-151">The following example shows some statements that store and retrieve values in arrays.</span></span>

[!code-vb[store-and-retrieve](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/store-and-retrieve.vb)]

## <a name="populating-an-array-with-array-literals"></a><span data-ttu-id="c1240-152">Preenchendo uma matriz com literais de matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-152">Populating an array with array literals</span></span>

<span data-ttu-id="c1240-153">Usando um literal de matriz, você pode preencher uma matriz com um conjunto inicial de valores ao mesmo tempo que você criá-lo.</span><span class="sxs-lookup"><span data-stu-id="c1240-153">By using an array literal, you can populate an array with an initial set of values at the same time that you create it.</span></span> <span data-ttu-id="c1240-154">Um literal de matriz consiste em uma lista de valores separados por vírgulas que são colocados entre chaves (`{}`).</span><span class="sxs-lookup"><span data-stu-id="c1240-154">An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`).</span></span>

<span data-ttu-id="c1240-155">Ao criar uma matriz usando um literal de matriz, você pode fornecer o tipo de matriz ou usar inferência de tipos para determinar o tipo de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-155">When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type.</span></span> <span data-ttu-id="c1240-156">O exemplo a seguir mostra as duas opções.</span><span class="sxs-lookup"><span data-stu-id="c1240-156">The following example shows both options.</span></span>

[!code-vb[create-with-literals](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#4)]

<span data-ttu-id="c1240-157">Quando você usa a inferência de tipo, o tipo da matriz é determinado pelo *tipo dominante* na lista de valores literais.</span><span class="sxs-lookup"><span data-stu-id="c1240-157">When you use type inference, the type of the array is determined by the *dominant type* in the list of literal values.</span></span> <span data-ttu-id="c1240-158">O tipo dominante é o tipo ao qual todos os outros tipos na matriz podem ampliar.</span><span class="sxs-lookup"><span data-stu-id="c1240-158">The dominant type is the type to which all other types in the array can widen.</span></span> <span data-ttu-id="c1240-159">Se esse tipo exclusivo não puder ser determinado, o tipo dominante será o tipo exclusivo ao qual todos os outros tipos na matriz poderão restringir.</span><span class="sxs-lookup"><span data-stu-id="c1240-159">If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow.</span></span> <span data-ttu-id="c1240-160">Se nenhum desses tipos exclusivos puder ser determinado, o tipo dominante será `Object`.</span><span class="sxs-lookup"><span data-stu-id="c1240-160">If neither of these unique types can be determined, the dominant type is `Object`.</span></span> <span data-ttu-id="c1240-161">Por exemplo, se a lista de valores que é fornecida para o literal de matriz contiver os valores do tipo `Integer`, `Long` e `Double`, a matriz resultante será do tipo `Double`.</span><span class="sxs-lookup"><span data-stu-id="c1240-161">For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`.</span></span> <span data-ttu-id="c1240-162">Porque `Integer` e `Long` são ampliados apenas para `Double`, `Double` é o tipo dominante.</span><span class="sxs-lookup"><span data-stu-id="c1240-162">Because `Integer` and `Long` widen only to `Double`, `Double` is the dominant type.</span></span> <span data-ttu-id="c1240-163">Para obter mais informações, consulte [Ampliando e restringindo conversões](../../language-features/data-types/widening-and-narrowing-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-163">For more information, see [Widening and Narrowing Conversions](../../language-features/data-types/widening-and-narrowing-conversions.md).</span></span>

> [!NOTE]
> <span data-ttu-id="c1240-164">Você pode usar inferência de tipo apenas para matrizes que são definidas como variáveis locais em um membro de tipo.</span><span class="sxs-lookup"><span data-stu-id="c1240-164">You can use type inference only for arrays that are defined as local variables in a type member.</span></span> <span data-ttu-id="c1240-165">Se uma definição de tipo explícito estiver ausente, matrizes definidas com literais de matriz no nível de classe são do tipo `Object[]`.</span><span class="sxs-lookup"><span data-stu-id="c1240-165">If an explicit type definition is absent, arrays defined with array literals at the class level are of type `Object[]`.</span></span> <span data-ttu-id="c1240-166">Para obter mais informações, consulte [inferência de tipo Local](../variables/local-type-inference.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-166">For more information, see [Local type inference](../variables/local-type-inference.md).</span></span>

<span data-ttu-id="c1240-167">Observe que o exemplo anterior define `values` como uma matriz do tipo `Double` mesmo que os literais de matriz são do tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="c1240-167">Note that the previous example defines `values` as an array of type `Double` even though all the array literals are of type `Integer`.</span></span> <span data-ttu-id="c1240-168">Você pode criar essa matriz porque os valores no literal de matriz podem ser ampliados com `Double` valores.</span><span class="sxs-lookup"><span data-stu-id="c1240-168">You can create this array because the values in the array literal can widen to `Double` values.</span></span>

<span data-ttu-id="c1240-169">Você também pode criar e preencher uma matriz multidimensional usando *aninhados literais de matriz*.</span><span class="sxs-lookup"><span data-stu-id="c1240-169">You can also create and populate a multidimensional array by using *nested array literals*.</span></span> <span data-ttu-id="c1240-170">Literais de matriz aninhados devem ter um número de dimensões que é consistente com a matriz resultante.</span><span class="sxs-lookup"><span data-stu-id="c1240-170">Nested array literals must have a number of dimensions that’s consistent with the resulting array.</span></span> <span data-ttu-id="c1240-171">O exemplo a seguir cria uma matriz bidimensional de inteiros usando literais de matriz aninhados.</span><span class="sxs-lookup"><span data-stu-id="c1240-171">The following example creates a two-dimensional array of integers by using nested array literals.</span></span>

[!code-vb[nested-array-literals](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#5)]

<span data-ttu-id="c1240-172">Ao usar literais de matriz aninhados para criar e preencher uma matriz, ocorrerá um erro se o número de elementos em literais de matriz aninhados não corresponde.</span><span class="sxs-lookup"><span data-stu-id="c1240-172">When using nested array literals to create and populate an array, an error occurs if the number of elements in the nested array literals don't match.</span></span> <span data-ttu-id="c1240-173">Também ocorrerá um erro se você declarar explicitamente a variável de matriz para ter um número diferente de dimensões que os literais de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-173">An error also occurs if you explicitly declare the array variable to have a different number of dimensions than the array literals.</span></span>

<span data-ttu-id="c1240-174">Assim como para matrizes unidimensionais, você pode contar com inferência de tipo ao criar uma matriz multidimensional usando literais de matriz aninhados.</span><span class="sxs-lookup"><span data-stu-id="c1240-174">Just as you can for one-dimensional arrays, you can rely on type inference when creating a multidimensional array with nested array literals.</span></span> <span data-ttu-id="c1240-175">O tipo inferido é o tipo dominante para todos os valores em todos os literais de matriz para o nível de aninhamento de todos os.</span><span class="sxs-lookup"><span data-stu-id="c1240-175">The inferred type is the dominant type for all the values in all the array literals for all nesting level.</span></span> <span data-ttu-id="c1240-176">O exemplo a seguir cria uma matriz bidimensional de tipo `Double[,]` dos valores que são do tipo `Integer` e `Double`.</span><span class="sxs-lookup"><span data-stu-id="c1240-176">The following example creates a two-dimensional array of type `Double[,]` from values that are of type `Integer` and `Double`.</span></span>

[!code-vb[nested-type-inference](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/create-array.vb#6)]

<span data-ttu-id="c1240-177">Para obter exemplos adicionais, consulte [como: Inicializar uma variável de matriz no Visual Basic](../../language-features/arrays/how-to-initialize-an-array-variable.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-177">For additional examples, see [How to: Initialize an Array Variable in Visual Basic](../../language-features/arrays/how-to-initialize-an-array-variable.md).</span></span>

## <a name="iterating-through-an-array"></a><span data-ttu-id="c1240-178">Iterando por uma matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-178">Iterating through an array</span></span>

<span data-ttu-id="c1240-179">Quando você itera através de uma matriz, pode acessar cada elemento na matriz do índice menor para o mais alto ou da maior para o mais baixo.</span><span class="sxs-lookup"><span data-stu-id="c1240-179">When you iterate through an array, you access each element in the array from the lowest index to the highest or from the highest to the lowest.</span></span> <span data-ttu-id="c1240-180">Em geral, use o [para... Próxima instrução](../../../language-reference/statements/for-next-statement.md) ou o [para cada um... Próxima instrução](../../../language-reference/statements/for-each-next-statement.md) para iterar por meio dos elementos de uma matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-180">Typically, use either the [For...Next Statement](../../../language-reference/statements/for-next-statement.md) or the [For Each...Next Statement](../../../language-reference/statements/for-each-next-statement.md) to iterate through the elements of an array.</span></span> <span data-ttu-id="c1240-181">Quando você não souber os limites superiores da matriz, você pode chamar o <xref:System.Array.GetUpperBound%2A?displayProperty=nameWithType> método para obter o valor mais alto do índice.</span><span class="sxs-lookup"><span data-stu-id="c1240-181">When you don't know the upper bounds of the array, you can call the <xref:System.Array.GetUpperBound%2A?displayProperty=nameWithType> method to get the highest value of the index.</span></span> <span data-ttu-id="c1240-182">Embora o menor valor de índice é quase sempre é 0, você pode chamar o <xref:System.Array.GetLowerBound%2A?displayProperty=nameWithType> método para obter o valor mais baixo do índice.</span><span class="sxs-lookup"><span data-stu-id="c1240-182">Although lowest index value is almost always 0, you can call the <xref:System.Array.GetLowerBound%2A?displayProperty=nameWithType> method to get the lowest value of the index.</span></span>

<span data-ttu-id="c1240-183">O exemplo a seguir itera por meio de uma matriz unidimensional usando o [ `For...Next` ](../../../language-reference/statements/for-next-statement.md) instrução.</span><span class="sxs-lookup"><span data-stu-id="c1240-183">The following example iterates through a one-dimensional array by using the [`For...Next`](../../../language-reference/statements/for-next-statement.md) statement.</span></span>

[!code-vb[iterate-one-dimensional-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate1d.vb)]

<span data-ttu-id="c1240-184">O exemplo a seguir itera por meio de uma matriz multidimensional usando um [ `For...Next` ](../../../language-reference/statements/for-next-statement.md) instrução.</span><span class="sxs-lookup"><span data-stu-id="c1240-184">The following example iterates through a multidimensional array by using a [`For...Next`](../../../language-reference/statements/for-next-statement.md) statement.</span></span> <span data-ttu-id="c1240-185">O método <xref:System.Array.GetUpperBound%2A> tem um parâmetro que especifica a dimensão.</span><span class="sxs-lookup"><span data-stu-id="c1240-185">The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension.</span></span> <span data-ttu-id="c1240-186">`GetUpperBound(0)` Retorna o maior índice da primeira dimensão, e `GetUpperBound(1)` retorna o índice mais alto da segunda dimensão.</span><span class="sxs-lookup"><span data-stu-id="c1240-186">`GetUpperBound(0)` returns the highest index of the first dimension, and `GetUpperBound(1)` returns the highest index of the second dimension.</span></span>

[!code-vb[iterate-two-dimensional-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate2d.vb)]

<span data-ttu-id="c1240-187">O exemplo a seguir usa um [para cada um... Próxima instrução](../../../language-reference/statements/for-each-next-statement.md)para iterar por meio de uma matriz unidimensional e uma matriz bidimensional.</span><span class="sxs-lookup"><span data-stu-id="c1240-187">The following example uses a [For Each...Next Statement](../../../language-reference/statements/for-each-next-statement.md)to iterate through a one-dimensional array and a two-dimensional array.</span></span>

[!code-vb[iterate-for-each-next](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/iterate-for-each-next.vb)]

## <a name="array-size"></a><span data-ttu-id="c1240-188">Tamanho da matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-188">Array size</span></span>

<span data-ttu-id="c1240-189">O tamanho de uma matriz é o produto dos comprimentos de todas as suas dimensões.</span><span class="sxs-lookup"><span data-stu-id="c1240-189">The size of an array is the product of the lengths of all its dimensions.</span></span> <span data-ttu-id="c1240-190">Ele representa o número total de elementos contidos no momento na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-190">It represents the total number of elements currently contained in the array.</span></span>  <span data-ttu-id="c1240-191">Por exemplo, o exemplo a seguir declara uma matriz dimensional de 2 com quatro elementos em cada dimensão.</span><span class="sxs-lookup"><span data-stu-id="c1240-191">For example, the following example declares a 2-dimensional array with four elements in each dimension.</span></span> <span data-ttu-id="c1240-192">Como mostra a saída do exemplo, o tamanho da matriz é 16 (ou (3 + 1) \* (3 + 1).</span><span class="sxs-lookup"><span data-stu-id="c1240-192">As the output from the example shows, the array's size is 16 (or (3 + 1) \* (3 + 1).</span></span>

[!code-vb[array-size](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-size.vb)]

> [!NOTE]
> <span data-ttu-id="c1240-193">Esta discussão sobre o tamanho da matriz não se aplicam a matrizes denteadas.</span><span class="sxs-lookup"><span data-stu-id="c1240-193">This discussion of array size does not apply to jagged arrays.</span></span> <span data-ttu-id="c1240-194">Para obter informações sobre matrizes denteadas e determinar o tamanho de uma matriz denteada, consulte o [matrizes denteadas](#jagged-arrays) seção.</span><span class="sxs-lookup"><span data-stu-id="c1240-194">For information on jagged arrays and determining the size of a jagged array, see the [Jagged arrays](#jagged-arrays) section.</span></span>

<span data-ttu-id="c1240-195">Você pode encontrar o tamanho de uma matriz usando a propriedade <xref:System.Array.Length%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1240-195">You can find the size of an array by using the <xref:System.Array.Length%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="c1240-196">Você pode encontrar o tamanho de cada dimensão de uma matriz multidimensional usando o <xref:System.Array.GetLength%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-196">You can find the length of each dimension of a multidimensional array by using the <xref:System.Array.GetLength%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="c1240-197">Você pode redimensionar uma variável de matriz atribuindo um novo objeto de matriz a ela ou usando o [ `ReDim` instrução](../../../language-reference/statements/redim-statement.md) instrução.</span><span class="sxs-lookup"><span data-stu-id="c1240-197">You can resize an array variable by assigning a new array object to it or by using the [`ReDim` Statement](../../../language-reference/statements/redim-statement.md) statement.</span></span> <span data-ttu-id="c1240-198">O exemplo a seguir usa o `ReDim` instrução para alterar uma matriz de elementos de 100 para uma matriz de elementos de 51.</span><span class="sxs-lookup"><span data-stu-id="c1240-198">The following example uses the `ReDim` statement to change a 100-element array to a 51-element array.</span></span>

[!code-vb[resize-an-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-size2.vb)]

<span data-ttu-id="c1240-199">Há várias coisas para ter em mente ao lidar com o tamanho de uma matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-199">There are several things to keep in mind when dealing with the size of an array.</span></span>

|||
|---|---|
|<span data-ttu-id="c1240-200">Tamanho da dimensão</span><span class="sxs-lookup"><span data-stu-id="c1240-200">Dimension Length</span></span>|<span data-ttu-id="c1240-201">O índice de cada dimensão é baseado em 0, o que significa que ele varia de 0 para o limite superior.</span><span class="sxs-lookup"><span data-stu-id="c1240-201">The index of each dimension is 0-based, which means it ranges from 0 to its upper bound.</span></span> <span data-ttu-id="c1240-202">Portanto, o comprimento de uma determinada dimensão é maior do que o limite superior declarado da dimensão.</span><span class="sxs-lookup"><span data-stu-id="c1240-202">Therefore, the length of a given dimension is one greater than the declared upper bound of that dimension.</span></span>|
|<span data-ttu-id="c1240-203">Limites de comprimento</span><span class="sxs-lookup"><span data-stu-id="c1240-203">Length Limits</span></span>|<span data-ttu-id="c1240-204">O comprimento de cada dimensão de uma matriz é limitado ao valor máximo do `Integer` tipo de dados, que é <xref:System.Int32.MaxValue?displayProperty=nameWithType> ou (2 ^ 31) - 1.</span><span class="sxs-lookup"><span data-stu-id="c1240-204">The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is <xref:System.Int32.MaxValue?displayProperty=nameWithType> or (2 ^ 31) - 1.</span></span> <span data-ttu-id="c1240-205">No entanto, o tamanho total de uma matriz também é limitado pela memória disponível no sistema.</span><span class="sxs-lookup"><span data-stu-id="c1240-205">However, the total size of an array is also limited by the memory available on your system.</span></span> <span data-ttu-id="c1240-206">Se você tentar inicializar uma matriz que excede a quantidade de memória disponível, o tempo de execução gera uma <xref:System.OutOfMemoryException>.</span><span class="sxs-lookup"><span data-stu-id="c1240-206">If you attempt to initialize an array that exceeds the amount of available memory, the runtime throws an <xref:System.OutOfMemoryException>.</span></span>|
|<span data-ttu-id="c1240-207">Tamanho e tamanho do elemento</span><span class="sxs-lookup"><span data-stu-id="c1240-207">Size and Element Size</span></span>|<span data-ttu-id="c1240-208">Um tamanho de matriz é independente do tipo de dados de seus elementos.</span><span class="sxs-lookup"><span data-stu-id="c1240-208">An array's size is independent of the data type of its elements.</span></span> <span data-ttu-id="c1240-209">O tamanho sempre representa o número total de elementos, não o número de bytes que eles consomem na memória.</span><span class="sxs-lookup"><span data-stu-id="c1240-209">The size always represents the total number of elements, not the number of bytes that they consume in memory.</span></span>|
|<span data-ttu-id="c1240-210">Consumo de memória</span><span class="sxs-lookup"><span data-stu-id="c1240-210">Memory Consumption</span></span>|<span data-ttu-id="c1240-211">Não é seguro fazer suposições sobre como uma matriz é armazenada na memória.</span><span class="sxs-lookup"><span data-stu-id="c1240-211">It is not safe to make any assumptions regarding how an array is stored in memory.</span></span> <span data-ttu-id="c1240-212">O armazenamento varia em plataformas de larguras de dados diferentes, então a mesma matriz pode consumir mais memória em um sistema de 64 bits que em um sistema de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="c1240-212">Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system.</span></span> <span data-ttu-id="c1240-213">Dependendo da configuração do sistema ao inicializar uma matriz, o CLR (Common Language Runtime) pode atribuir armazenamento para elementos do pacote o mais próximo possível, ou alinhá-los em limites naturais de hardware.</span><span class="sxs-lookup"><span data-stu-id="c1240-213">Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries.</span></span> <span data-ttu-id="c1240-214">Além disso, uma matriz de armazenamento requer sobrecarga de armazenamento para suas informações de controle, e essa sobrecarga aumenta com cada nova dimensão.</span><span class="sxs-lookup"><span data-stu-id="c1240-214">Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.</span></span>|

## <a name="the-array-type"></a><span data-ttu-id="c1240-215">O tipo de matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-215">The array type</span></span>

<span data-ttu-id="c1240-216">Cada matriz tem um tipo de dados, que é diferente do tipo de dados de seus elementos.</span><span class="sxs-lookup"><span data-stu-id="c1240-216">Every array has a data type, which differs from the data type of its elements.</span></span> <span data-ttu-id="c1240-217">Não há nenhum tipo de dados único para todas as matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-217">There is no single data type for all arrays.</span></span> <span data-ttu-id="c1240-218">Em vez disso, o tipo de dados de uma matriz é determinado pelo número de dimensões, ou *classificação*, da matriz e o tipo de dados dos elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-218">Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array.</span></span> <span data-ttu-id="c1240-219">Duas variáveis de matriz são dos mesmos dados somente quando elas têm a mesma classificação de tipo e seus elementos têm os mesmos tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="c1240-219">Two array variables are of the same data type only when they have the same rank and their elements have the same data type.</span></span> <span data-ttu-id="c1240-220">Os comprimentos das dimensões de uma matriz não influenciam o tipo de dados de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-220">The lengths of the dimensions of an array do not influence the array data type.</span></span>

<span data-ttu-id="c1240-221">Cada matriz herda da classe <xref:System.Array?displayProperty=nameWithType> e você pode declarar uma variável para ser do tipo `Array`, mas não pode criar uma matriz do tipo `Array`.</span><span class="sxs-lookup"><span data-stu-id="c1240-221">Every array inherits from the <xref:System.Array?displayProperty=nameWithType> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`.</span></span> <span data-ttu-id="c1240-222">Por exemplo, embora o código a seguir declara a `arr` variável seja do tipo `Array` e chama o <xref:System.Array.CreateInstance%2A?displayProperty=nameWithType> prova de método para criar uma instância de matriz, o tipo de matriz a ser Object [].</span><span class="sxs-lookup"><span data-stu-id="c1240-222">For example, although the following code declares the `arr` variable to be of type `Array` and calls the <xref:System.Array.CreateInstance%2A?displayProperty=nameWithType> method to instantiate the array, the array's type proves to be Object[].</span></span>

[!code-vb[array-class](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-class.vb)]

<span data-ttu-id="c1240-223">Além disso, a [instrução ReDim](../../../language-reference/statements/redim-statement.md) não pode operar em uma variável declarada como tipo `Array`.</span><span class="sxs-lookup"><span data-stu-id="c1240-223">Also, the [ReDim Statement](../../../language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`.</span></span> <span data-ttu-id="c1240-224">Por esses motivos e à segurança de tipo, é aconselhável declarar cada matriz como um tipo específico.</span><span class="sxs-lookup"><span data-stu-id="c1240-224">For these reasons, and for type safety, it is advisable to declare every array as a specific type.</span></span>

<span data-ttu-id="c1240-225">Você pode descobrir o tipo de dados de uma matriz ou seus elementos de várias maneiras.</span><span class="sxs-lookup"><span data-stu-id="c1240-225">You can find out the data type of either an array or its elements in several ways.</span></span>

- <span data-ttu-id="c1240-226">Você pode chamar o <xref:System.Object.GetType%2A> método na variável para obter um <xref:System.Type> objeto que representa o tipo de tempo de execução da variável.</span><span class="sxs-lookup"><span data-stu-id="c1240-226">You can call the <xref:System.Object.GetType%2A> method on the variable to get a <xref:System.Type> object that represents the run-time type of the variable.</span></span> <span data-ttu-id="c1240-227">O objeto <xref:System.Type> mantém informações abrangentes em suas propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="c1240-227">The <xref:System.Type> object holds extensive information in its properties and methods.</span></span>
- <span data-ttu-id="c1240-228">Você pode passar a variável para o <xref:Microsoft.VisualBasic.Information.TypeName%2A> função para obter um `String` com o nome do tipo de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="c1240-228">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to get a `String` with the name of run-time type.</span></span>

<span data-ttu-id="c1240-229">O exemplo a seguir chama a ambos os `GetType` método e o `TypeName` função para determinar o tipo de uma matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-229">The following example calls the both the `GetType` method and the `TypeName` function to determine the type of an array.</span></span> <span data-ttu-id="c1240-230">O tipo de matriz é `Byte(,)`.</span><span class="sxs-lookup"><span data-stu-id="c1240-230">The array type is `Byte(,)`.</span></span> <span data-ttu-id="c1240-231">Observe que o <xref:System.Type.BaseType%2A?displayProperty=nameWithType> propriedade também indica que o tipo base da matriz de bytes é a <xref:System.Array> classe.</span><span class="sxs-lookup"><span data-stu-id="c1240-231">Note that the <xref:System.Type.BaseType%2A?displayProperty=nameWithType> property also indicates that the base type of the byte array is the <xref:System.Array> class.</span></span>

[!code-vb[array-type](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/array-type.vb)]

## <a name="arrays-as-return-values-and-parameters"></a><span data-ttu-id="c1240-232">Matrizes como valores de retorno e parâmetros</span><span class="sxs-lookup"><span data-stu-id="c1240-232">Arrays as return values and parameters</span></span>

<span data-ttu-id="c1240-233">Para retornar uma matriz de um procedimento `Function`, especifique o tipo de dados de matriz e o número de dimensões como o tipo de retorno de [instrução de função](../../../language-reference/statements/function-statement.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-233">To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../language-reference/statements/function-statement.md).</span></span> <span data-ttu-id="c1240-234">Dentro da função, declare uma variável da matriz local com o mesmo tipo de dados e número de dimensões.</span><span class="sxs-lookup"><span data-stu-id="c1240-234">Within the function, declare a local array variable with same data type and number of dimensions.</span></span> <span data-ttu-id="c1240-235">Na [instrução Return](../../../language-reference/statements/return-statement.md), inclua a variável da matriz local sem parênteses.</span><span class="sxs-lookup"><span data-stu-id="c1240-235">In the [Return Statement](../../../language-reference/statements/return-statement.md), include the local array variable without parentheses.</span></span>

<span data-ttu-id="c1240-236">Para especificar uma matriz como um parâmetro para um procedimento `Sub` ou `Function`, defina o parâmetro como uma matriz com um tipo de dados especificado e o número de dimensões.</span><span class="sxs-lookup"><span data-stu-id="c1240-236">To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions.</span></span> <span data-ttu-id="c1240-237">A chamada ao procedimento, pode passe uma variável de matriz com o mesmo tipo de dados e o número de dimensões.</span><span class="sxs-lookup"><span data-stu-id="c1240-237">In the call to the procedure, pass an array variable with the same data type and number of dimensions.</span></span>

<span data-ttu-id="c1240-238">No exemplo a seguir, o `GetNumbers` função retorna um `Integer()`, uma matriz unidimensional do tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="c1240-238">In the following example, the `GetNumbers` function returns an `Integer()`, a one-dimensional array of type `Integer`.</span></span> <span data-ttu-id="c1240-239">O procedimento `ShowNumbers` aceita um argumento `Integer()`.</span><span class="sxs-lookup"><span data-stu-id="c1240-239">The `ShowNumbers` procedure accepts an `Integer()` argument.</span></span>

[!code-vb[return-value-and-params](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/return-values-and-params.vb)]

<span data-ttu-id="c1240-240">No exemplo a seguir, o `GetNumbersMultiDim` função retorna um `Integer(,)`, uma matriz bidimensional de tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="c1240-240">In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`, a two-dimensional array of type `Integer`.</span></span>  <span data-ttu-id="c1240-241">O procedimento `ShowNumbersMultiDim` aceita um argumento `Integer(,)`.</span><span class="sxs-lookup"><span data-stu-id="c1240-241">The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument.</span></span>

[!code-vb[multidimensional-return-value](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/return-values-and-params-2d.vb)]

## <a name="jagged-arrays"></a><span data-ttu-id="c1240-242">Matrizes denteadas</span><span class="sxs-lookup"><span data-stu-id="c1240-242">Jagged arrays</span></span>

<span data-ttu-id="c1240-243">Às vezes, a estrutura de dados em seu aplicativo é bidimensional, mas não retangular.</span><span class="sxs-lookup"><span data-stu-id="c1240-243">Sometimes the data structure in your application is two-dimensional but not rectangular.</span></span> <span data-ttu-id="c1240-244">Por exemplo, você pode usar uma matriz para armazenar dados sobre a temperatura máxima de cada dia do mês.</span><span class="sxs-lookup"><span data-stu-id="c1240-244">For example, you might use an array to store data about the high temperature of each day of the month.</span></span> <span data-ttu-id="c1240-245">A primeira dimensão da matriz representa o mês, mas a segunda dimensão representa o número de dias e o número de dias em um mês não é uniforme.</span><span class="sxs-lookup"><span data-stu-id="c1240-245">The first dimension of the array represents the month, but the second dimension represents the number of days, and the number of days in a month is not uniform.</span></span> <span data-ttu-id="c1240-246">Um *matriz denteada*, que também é chamado um *matriz de matrizes*, foi projetado para esses cenários.</span><span class="sxs-lookup"><span data-stu-id="c1240-246">A *jagged array*, which is also called an *array of arrays*, is designed for such scenarios.</span></span> <span data-ttu-id="c1240-247">Uma matriz denteada é uma matriz cujos elementos também são matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-247">A jagged array is an array whose elements are also arrays.</span></span> <span data-ttu-id="c1240-248">Uma matriz denteada e cada elemento em uma matriz denteada podem ter uma ou mais dimensões.</span><span class="sxs-lookup"><span data-stu-id="c1240-248">A jagged array and each element in a jagged array can have one or more dimensions.</span></span>

<span data-ttu-id="c1240-249">O exemplo a seguir usa uma matriz de meses, cada elemento é uma matriz de dias.</span><span class="sxs-lookup"><span data-stu-id="c1240-249">The following example uses an array of months, each element of which is an array of days.</span></span> <span data-ttu-id="c1240-250">O exemplo usa uma matriz denteada como diferentes meses têm diferentes números de dias.</span><span class="sxs-lookup"><span data-stu-id="c1240-250">The example uses a jagged array because different months have different numbers of days.</span></span>  <span data-ttu-id="c1240-251">O exemplo mostra como criar uma matriz denteada, atribuir valores a ele e recuperar e exibir seus valores.</span><span class="sxs-lookup"><span data-stu-id="c1240-251">The example shows how to create a jagged array, assign values to it, and retrieve and display its values.</span></span>

[!code-vb[jagged-arrays](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged.vb)]

<span data-ttu-id="c1240-252">O exemplo anterior atribui valores para a matriz denteada em uma base de elemento por elemento usando um `For...Next` loop.</span><span class="sxs-lookup"><span data-stu-id="c1240-252">The previous example assigns values to the jagged array on an element-by-element basis by using a `For...Next` loop.</span></span> <span data-ttu-id="c1240-253">Você também pode atribuir valores aos elementos de uma matriz denteada usando literais de matriz aninhados.</span><span class="sxs-lookup"><span data-stu-id="c1240-253">You can also assign values to the elements of a jagged array by using nested array literals.</span></span> <span data-ttu-id="c1240-254">No entanto, a tentativa de usar aninhados literais de matriz (por exemplo, `Dim valuesjagged = {{1, 2}, {2, 3, 4}}`) gera o erro do compilador [BC30568](../../../,,/../misc/bc30568.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-254">However, the attempt to use nested array literals (for example, `Dim valuesjagged = {{1, 2}, {2, 3, 4}}`) generates compiler error [BC30568](../../../,,/../misc/bc30568.md).</span></span> <span data-ttu-id="c1240-255">Para corrigir o erro, coloque os literais de matriz interna entre parênteses.</span><span class="sxs-lookup"><span data-stu-id="c1240-255">To correct the error, enclose the inner array literals in parentheses.</span></span> <span data-ttu-id="c1240-256">Os parênteses forçam a expressão literal de matriz a ser avaliada e os valores resultantes são usados com a matriz externa literal, como mostra o exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="c1240-256">The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following example shows.</span></span>

[!code-vb[jagged-array-initialization](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged-assign.vb)]

<span data-ttu-id="c1240-257">Uma matriz denteada é uma matriz unidimensional cujos elementos contêm matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-257">A jagged array is a one-dimensional array whose elements contain arrays.</span></span> <span data-ttu-id="c1240-258">Portanto, o <xref:System.Array.Length%2A?displayProperty=nameWithType> propriedade e o `Array.GetLength(0)` método retorna o número de elementos na matriz unidimensional, e `Array.GetLength(1)` lança um <xref:System.IndexOutOfRangeException> como uma matriz denteada não é multidimensional.</span><span class="sxs-lookup"><span data-stu-id="c1240-258">Therefore, the <xref:System.Array.Length%2A?displayProperty=nameWithType> property and the `Array.GetLength(0)` method return the number of elements in the one-dimensional array, and `Array.GetLength(1)` throws an <xref:System.IndexOutOfRangeException> because a jagged array is not multidimensional.</span></span> <span data-ttu-id="c1240-259">Determinar o número de elementos em cada submatriz ao recuperar o valor de cada submatriz <xref:System.Array.Length%2A?displayProperty=nameWithType> propriedade.</span><span class="sxs-lookup"><span data-stu-id="c1240-259">You determine the number of elements in each subarray by retrieving the value of each subarray's <xref:System.Array.Length%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="c1240-260">O exemplo a seguir ilustra como determinar o número de elementos em uma matriz denteada.</span><span class="sxs-lookup"><span data-stu-id="c1240-260">The following example illustrates how to determine the number of elements in a jagged array.</span></span>

[!code-vb[jagged-array-size](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/jagged-length.vb)]

## <a name="zero-length-arrays"></a><span data-ttu-id="c1240-261">Matrizes de comprimento zero</span><span class="sxs-lookup"><span data-stu-id="c1240-261">Zero-length arrays</span></span>

<span data-ttu-id="c1240-262">Visual Basic faz distinção entre uma matriz não inicializada (uma matriz cujo valor é `Nothing`) e uma *matriz de comprimento zero* ou uma matriz vazia (uma matriz que não tem nenhum elemento.) Uma matriz não inicializada é aquele que não foi dimensionada ou tinham todos os valores atribuídos a ele.</span><span class="sxs-lookup"><span data-stu-id="c1240-262">Visual Basic differentiates between a uninitialized array (an array whose value is `Nothing`) and a *zero-length array* or empty array (an array that has no elements.) An uninitialized array is one that has not been dimensioned or had any values assigned to it.</span></span> <span data-ttu-id="c1240-263">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="c1240-263">For example:</span></span>

```vb
Dim arr() As String
```

<span data-ttu-id="c1240-264">Uma matriz de comprimento zero é declarada com uma dimensão de -1.</span><span class="sxs-lookup"><span data-stu-id="c1240-264">A zero-length array is declared with a dimension of -1.</span></span> <span data-ttu-id="c1240-265">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="c1240-265">For example:</span></span>

```vb
Dim arrZ(-1) As String
```

<span data-ttu-id="c1240-266">Talvez seja necessário criar uma matriz de tamanho igual a zero nas seguintes circunstâncias:</span><span class="sxs-lookup"><span data-stu-id="c1240-266">You might need to create a zero-length array under the following circumstances:</span></span>

- <span data-ttu-id="c1240-267">Sem arriscar uma <xref:System.NullReferenceException> exceção, seu código precisa acessar membros do <xref:System.Array> classe, como <xref:System.Array.Length%2A> ou <xref:System.Array.Rank%2A>, ou chamar uma função do Visual Basic, como <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1240-267">Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a Visual Basic function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span></span>

- <span data-ttu-id="c1240-268">Para manter seu código simples por não ter que verificar `Nothing` como um caso especial.</span><span class="sxs-lookup"><span data-stu-id="c1240-268">You want to keep your code simple by not having to check for `Nothing` as a special case.</span></span>

- <span data-ttu-id="c1240-269">Seu código interage com uma API (interface de programação do aplicativo) que exige que você passe uma matriz de tamanho igual a zero para um ou mais procedimentos ou retorna uma matriz de tamanho igual a zero de um ou mais procedimentos.</span><span class="sxs-lookup"><span data-stu-id="c1240-269">Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.</span></span>

## <a name="splitting-an-array"></a><span data-ttu-id="c1240-270">Divisão de uma matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-270">Splitting an array</span></span>

<span data-ttu-id="c1240-271">Em alguns casos, você precisa dividir uma única matriz em várias matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-271">In some cases, you may need to split a single array into multiple arrays.</span></span> <span data-ttu-id="c1240-272">Isso envolve identificar o ponto ou pontos em que a matriz deve ser dividida e spitting, em seguida, a matriz em duas ou mais matrizes separadas.</span><span class="sxs-lookup"><span data-stu-id="c1240-272">This involves identifying the point or points at which the array is to be split, and then spitting the array into two or more separate arrays.</span></span>

> [!NOTE]
> <span data-ttu-id="c1240-273">Esta seção discute a dividir uma única cadeia de caracteres em uma matriz de cadeia de caracteres com base em um delimitador.</span><span class="sxs-lookup"><span data-stu-id="c1240-273">This section does not discuss splitting a single string into a string array based on some delimiter.</span></span> <span data-ttu-id="c1240-274">Para obter informações sobre como dividir uma cadeia de caracteres, consulte o <xref:System.String.Split%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-274">For information on splitting a string, see the <xref:System.String.Split%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="c1240-275">Os critérios mais comuns para a divisão de uma matriz são:</span><span class="sxs-lookup"><span data-stu-id="c1240-275">The most common criteria for splitting an array are:</span></span>

- <span data-ttu-id="c1240-276">O número de elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-276">The number of elements in the array.</span></span> <span data-ttu-id="c1240-277">Por exemplo, você talvez queira dividir uma matriz de mais de um número especificado de elementos em um número de aproximadamente partes iguais.</span><span class="sxs-lookup"><span data-stu-id="c1240-277">For example, you might want to split an array of more than a specified number of elements into a number of approximately equal parts.</span></span> <span data-ttu-id="c1240-278">Para essa finalidade, você pode usar o valor retornado por qualquer um de <xref:System.Array.Length%2A?displayProperty=nameWithType> ou <xref:System.Array.GetLength%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-278">For this purpose, you can use the value returned by either the <xref:System.Array.Length%2A?displayProperty=nameWithType> or <xref:System.Array.GetLength%2A?displayProperty=nameWithType> method.</span></span>

- <span data-ttu-id="c1240-279">O valor de um elemento, que serve como um delimitador que indica onde a matriz deve ser dividida.</span><span class="sxs-lookup"><span data-stu-id="c1240-279">The value of an element, which serves as a delimiter that indicates where the array should be split.</span></span> <span data-ttu-id="c1240-280">Você pode procurar por um valor específico chamando o <xref:System.Array.FindIndex%2A?displayProperty=nameWithType> e <xref:System.Array.FindLastIndex%2A?displayProperty=nameWithType> métodos.</span><span class="sxs-lookup"><span data-stu-id="c1240-280">You can search for a specific value by calling the <xref:System.Array.FindIndex%2A?displayProperty=nameWithType> and <xref:System.Array.FindLastIndex%2A?displayProperty=nameWithType> methods.</span></span>

<span data-ttu-id="c1240-281">Depois de determinar o índice ou índices em que a matriz deve ser dividida, em seguida, você pode criar as matrizes individuais chamando o <xref:System.Array.Copy%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-281">Once you've determined the index or indexes at which the array should be split, you can then create the individual arrays by calling the <xref:System.Array.Copy%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="c1240-282">O exemplo a seguir divide uma matriz em duas matrizes de aproximadamente igual tamanho.</span><span class="sxs-lookup"><span data-stu-id="c1240-282">The following example splits an array into two arrays of approximately equal size.</span></span> <span data-ttu-id="c1240-283">(Se o número total de elementos da matriz for ímpar, a primeira matriz tem um elemento a mais que o segundo).</span><span class="sxs-lookup"><span data-stu-id="c1240-283">(If the total number of array elements is odd, the first array has one more element than the second.)</span></span>

[!code-vb[splitting-an-array-by-length](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/split1.vb)]

<span data-ttu-id="c1240-284">O exemplo a seguir divide uma matriz de cadeia de caracteres em duas matrizes com base na presença de um elemento cujo valor é "zzz", que serve como o delimitador de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-284">The following example splits a string array into two arrays based on the presence of an element whose value is "zzz", which serves as the array delimiter.</span></span> <span data-ttu-id="c1240-285">As novas matrizes não incluem o elemento que contém o delimitador.</span><span class="sxs-lookup"><span data-stu-id="c1240-285">The new arrays do not include the element that contains the delimiter.</span></span>

[!code-vb[splitting-an-array-by-delimiter](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/split2.vb)]

## <a name="joining-arrays"></a><span data-ttu-id="c1240-286">Ingressar em matrizes</span><span class="sxs-lookup"><span data-stu-id="c1240-286">Joining arrays</span></span>

<span data-ttu-id="c1240-287">Você também pode combinar várias matrizes em uma única matriz maior.</span><span class="sxs-lookup"><span data-stu-id="c1240-287">You can also combine a number of arrays into a single larger array.</span></span> <span data-ttu-id="c1240-288">Para fazer isso, você também usar o <xref:System.Array.Copy%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-288">To do this, you also use the <xref:System.Array.Copy%2A?displayProperty=nameWithType> method.</span></span>

> [!NOTE]
> <span data-ttu-id="c1240-289">Esta seção discute a ingressar em uma matriz de cadeia de caracteres em uma única cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="c1240-289">This section does not discuss joining a string array into a single string.</span></span> <span data-ttu-id="c1240-290">Para obter informações sobre como ingressar em uma matriz de cadeia de caracteres, consulte o <xref:System.String.Join%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="c1240-290">For information on joining a string array, see the <xref:System.String.Join%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="c1240-291">Antes de copiar os elementos de cada matriz para a nova matriz, primeiro você deve assegurar que você inicializou a matriz para que ele seja grande o suficiente para acomodar a nova matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-291">Before copying the elements of each array into the new array, you must first ensure that you have initialized the array so that it is large enough to accommodate the new array.</span></span> <span data-ttu-id="c1240-292">Você pode fazer isso de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="c1240-292">You can do this in one of two ways:</span></span>

- <span data-ttu-id="c1240-293">Use o [ `ReDim Preserve` ](../../../language-reference/statements/redim-statement.md) instrução expandir dinamicamente a matriz antes de adicionar novos elementos a ele.</span><span class="sxs-lookup"><span data-stu-id="c1240-293">Use the [`ReDim Preserve`](../../../language-reference/statements/redim-statement.md) statement to dynamically expand the array before adding new elements to it.</span></span> <span data-ttu-id="c1240-294">Essa é a técnica mais fácil, mas isso pode resultar em degradação de desempenho e consumo excessivo de memória quando você estiver copiando matrizes grandes.</span><span class="sxs-lookup"><span data-stu-id="c1240-294">This is the easiest technique, but it can result in performance degradation and excessive memory consumption when you are copying large arrays.</span></span>
- <span data-ttu-id="c1240-295">Calcular o número total de elementos necessários para a nova matriz grande, em seguida, adicionar os elementos de cada matriz de origem a ele.</span><span class="sxs-lookup"><span data-stu-id="c1240-295">Calculate the total number of elements needed for the new large array, then add the elements of each source array to it.</span></span>

<span data-ttu-id="c1240-296">O exemplo a seguir usa a segunda abordagem para adicionar quatro matrizes com dez elementos a uma única matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-296">The following example uses the second approach to add four arrays with ten elements each to a single array.</span></span>

[!code-vb[joining-an-array](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/join.vb)]

<span data-ttu-id="c1240-297">Como nesse caso, as matrizes de origem são todos pequenas, podemos também dinamicamente pode expandir a matriz como podemos adicionar os elementos de cada nova matriz a ela.</span><span class="sxs-lookup"><span data-stu-id="c1240-297">Since in this case the source arrays are all small, we can also dynamically expand the array as we add the elements of each new array to it.</span></span> <span data-ttu-id="c1240-298">O exemplo a seguir faz isso.</span><span class="sxs-lookup"><span data-stu-id="c1240-298">The following example does that.</span></span>

[!code-vb[joining-an-array-dynamically](~/samples/snippets/visualbasic/programming-guide/language-features/arrays/join2.vb)]

## <a name="collections-as-an-alternative-to-arrays"></a><span data-ttu-id="c1240-299">Coleções como uma alternativa para matrizes</span><span class="sxs-lookup"><span data-stu-id="c1240-299">Collections as an alternative to arrays</span></span>

<span data-ttu-id="c1240-300">As matrizes são mais úteis para criar e trabalhar com um número fixo de objetos fortemente tipados.</span><span class="sxs-lookup"><span data-stu-id="c1240-300">Arrays are most useful for creating and working with a fixed number of strongly typed objects.</span></span> <span data-ttu-id="c1240-301">As coleções fornecem uma maneira mais flexível de trabalhar com grupos de objetos.</span><span class="sxs-lookup"><span data-stu-id="c1240-301">Collections provide a more flexible way to work with groups of objects.</span></span> <span data-ttu-id="c1240-302">Ao contrário das matrizes, que exige que você altere explicitamente o tamanho de uma matriz com o [ `ReDim` instrução](../../../language-reference/statements/redim-statement.md), coleções de crescer e reduzir dinamicamente conforme as necessidades de uma alteração no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c1240-302">Unlike arrays, which require that you explicitly change the size of an array with the [`ReDim` Statement](../../../language-reference/statements/redim-statement.md), collections grow and shrink dynamically as the needs of an application change.</span></span>

<span data-ttu-id="c1240-303">Quando você usa `ReDim` para redimensionar uma matriz, o Visual Basic cria uma nova matriz e libera o anterior.</span><span class="sxs-lookup"><span data-stu-id="c1240-303">When you use `ReDim` to redimension an array, Visual Basic creates a new array and releases the previous one.</span></span> <span data-ttu-id="c1240-304">Isso leva o tempo da execução.</span><span class="sxs-lookup"><span data-stu-id="c1240-304">This takes execution time.</span></span> <span data-ttu-id="c1240-305">Portanto, se o número de itens que você está trabalhando com forem alterados com frequência, ou você não pode prever o número máximo de itens que você precisa, você geralmente obterá melhor desempenho usando uma coleção.</span><span class="sxs-lookup"><span data-stu-id="c1240-305">Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you'll usually obtain better performance by using a collection.</span></span>

<span data-ttu-id="c1240-306">Para algumas coleções, você pode atribuir uma chave para qualquer objeto que colocar na coleção para que você possa recuperar rapidamente o objeto, usando a chave.</span><span class="sxs-lookup"><span data-stu-id="c1240-306">For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.</span></span>

<span data-ttu-id="c1240-307">Se a coleção contiver elementos de apenas um tipo de dados, você poderá usar uma das classes no namespace <xref:System.Collections.Generic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1240-307">If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="c1240-308">Uma coleção genérica impõe segurança de tipos para que nenhum outro tipo de dados possa ser adicionado a ela.</span><span class="sxs-lookup"><span data-stu-id="c1240-308">A generic collection enforces type safety so that no other data type can be added to it.</span></span>

<span data-ttu-id="c1240-309">Para obter mais informações sobre coleções, consulte [Coleções](../../concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="c1240-309">For more information about collections, see [Collections](../../concepts/collections.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c1240-310">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c1240-310">Related topics</span></span>

|<span data-ttu-id="c1240-311">Termo</span><span class="sxs-lookup"><span data-stu-id="c1240-311">Term</span></span>|<span data-ttu-id="c1240-312">Definição</span><span class="sxs-lookup"><span data-stu-id="c1240-312">Definition</span></span>|
|----------|----------------|
|[<span data-ttu-id="c1240-313">Dimensões de matriz no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c1240-313">Array Dimensions in Visual Basic</span></span>](../../language-features/arrays/array-dimensions.md)|<span data-ttu-id="c1240-314">Explica a classificação e as dimensões em matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-314">Explains rank and dimensions in arrays.</span></span>|
|[<span data-ttu-id="c1240-315">Como: Inicializar uma variável de matriz no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c1240-315">How to: Initialize an Array Variable in Visual Basic</span></span>](../../language-features/arrays/how-to-initialize-an-array-variable.md)|<span data-ttu-id="c1240-316">Descreve como preencher matrizes com valores iniciais.</span><span class="sxs-lookup"><span data-stu-id="c1240-316">Describes how to populate arrays with initial values.</span></span>|
|[<span data-ttu-id="c1240-317">Como: Classificar uma matriz no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c1240-317">How to: Sort An Array in Visual Basic</span></span>](../../language-features/arrays/how-to-sort-an-array.md)|<span data-ttu-id="c1240-318">Mostra como classificar os elementos de uma matriz em ordem alfabética.</span><span class="sxs-lookup"><span data-stu-id="c1240-318">Shows how to sort the elements of an array alphabetically.</span></span>|
|[<span data-ttu-id="c1240-319">Como: Atribuir uma matriz a outra matriz</span><span class="sxs-lookup"><span data-stu-id="c1240-319">How to: Assign One Array to Another Array</span></span>](../../language-features/arrays/how-to-assign-one-array-to-another-array.md)|<span data-ttu-id="c1240-320">Descreve as regras e as etapas para atribuir uma matriz a outra variável de matriz.</span><span class="sxs-lookup"><span data-stu-id="c1240-320">Describes the rules and steps for assigning an array to another array variable.</span></span>|
|[<span data-ttu-id="c1240-321">Solução de problemas de matrizes</span><span class="sxs-lookup"><span data-stu-id="c1240-321">Troubleshooting Arrays</span></span>](../../language-features/arrays/troubleshooting-arrays.md)|<span data-ttu-id="c1240-322">Aborda alguns problemas comuns que surgem ao trabalhar com matrizes.</span><span class="sxs-lookup"><span data-stu-id="c1240-322">Discusses some common problems that arise when working with arrays.</span></span>|

## <a name="see-also"></a><span data-ttu-id="c1240-323">Consulte também</span><span class="sxs-lookup"><span data-stu-id="c1240-323">See also</span></span>

- <xref:System.Array?displayProperty=nameWithType>
- [<span data-ttu-id="c1240-324">Instrução Dim</span><span class="sxs-lookup"><span data-stu-id="c1240-324">Dim Statement</span></span>](../../../language-reference/statements/dim-statement.md)
- [<span data-ttu-id="c1240-325">Instrução ReDim</span><span class="sxs-lookup"><span data-stu-id="c1240-325">ReDim Statement</span></span>](../../../language-reference/statements/redim-statement.md)
