---
title: Estruturas e classes
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: e7ca5b9d55611eafad88517e71f9807fe2aa4416
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/23/2020
ms.locfileid: "91086212"
---
# <a name="structures-and-classes-visual-basic"></a><span data-ttu-id="27b4b-102">Estruturas e classes (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="27b4b-102">Structures and Classes (Visual Basic)</span></span>

<span data-ttu-id="27b4b-103">Visual Basic unifica a sintaxe para estruturas e classes, com o resultado de que ambas as entidades dão suporte à maioria dos mesmos recursos.</span><span class="sxs-lookup"><span data-stu-id="27b4b-103">Visual Basic unifies the syntax for structures and classes, with the result that both entities support most of the same features.</span></span> <span data-ttu-id="27b4b-104">No entanto, também há diferenças importantes entre estruturas e classes.</span><span class="sxs-lookup"><span data-stu-id="27b4b-104">However, there are also important differences between structures and classes.</span></span>  
  
 <span data-ttu-id="27b4b-105">Classes têm a vantagem de ser tipos de referência — passar uma referência é mais eficiente do que passar uma variável de estrutura com todos os seus dados.</span><span class="sxs-lookup"><span data-stu-id="27b4b-105">Classes have the advantage of being reference types — passing a reference is more efficient than passing a structure variable with all its data.</span></span> <span data-ttu-id="27b4b-106">Por outro lado, as estruturas não exigem a alocação de memória no heap global.</span><span class="sxs-lookup"><span data-stu-id="27b4b-106">On the other hand, structures do not require allocation of memory on the global heap.</span></span>  
  
 <span data-ttu-id="27b4b-107">Como não é possível herdar de uma estrutura, as estruturas devem ser usadas somente para objetos que não precisam ser estendidos.</span><span class="sxs-lookup"><span data-stu-id="27b4b-107">Because you cannot inherit from a structure, structures should be used only for objects that do not need to be extended.</span></span> <span data-ttu-id="27b4b-108">Use estruturas quando o objeto que você deseja criar tiver um tamanho de instância pequeno e leve em conta as características de desempenho de classes versus estruturas.</span><span class="sxs-lookup"><span data-stu-id="27b4b-108">Use structures when the object you wish to create has a small instance size, and take into account the performance characteristics of classes versus structures.</span></span>  
  
## <a name="similarities"></a><span data-ttu-id="27b4b-109">Semelhanças</span><span class="sxs-lookup"><span data-stu-id="27b4b-109">Similarities</span></span>  

 <span data-ttu-id="27b4b-110">Estruturas e classes são semelhantes nos seguintes aspectos:</span><span class="sxs-lookup"><span data-stu-id="27b4b-110">Structures and classes are similar in the following respects:</span></span>  
  
- <span data-ttu-id="27b4b-111">Ambos são tipos de *contêineres* , o que significa que eles contêm outros tipos como membros.</span><span class="sxs-lookup"><span data-stu-id="27b4b-111">Both are *container* types, meaning that they contain other types as members.</span></span>  
  
- <span data-ttu-id="27b4b-112">Ambos têm Membros, que podem incluir construtores, métodos, propriedades, campos, constantes, enumerações, eventos e manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="27b4b-112">Both have members, which can include constructors, methods, properties, fields, constants, enumerations, events, and event handlers.</span></span> <span data-ttu-id="27b4b-113">No entanto, não confunda esses membros com os *elementos* declarados de uma estrutura.</span><span class="sxs-lookup"><span data-stu-id="27b4b-113">However, do not confuse these members with the declared *elements* of a structure.</span></span>  
  
- <span data-ttu-id="27b4b-114">Os membros de ambos podem ter níveis de acesso individualizados.</span><span class="sxs-lookup"><span data-stu-id="27b4b-114">Members of both can have individualized access levels.</span></span> <span data-ttu-id="27b4b-115">Por exemplo, um membro pode ser declarado `Public` e outro `Private` .</span><span class="sxs-lookup"><span data-stu-id="27b4b-115">For example, one member can be declared `Public` and another `Private`.</span></span>  
  
- <span data-ttu-id="27b4b-116">Ambos podem implementar interfaces.</span><span class="sxs-lookup"><span data-stu-id="27b4b-116">Both can implement interfaces.</span></span>  
  
- <span data-ttu-id="27b4b-117">Ambos podem ter construtores compartilhados, com ou sem parâmetros.</span><span class="sxs-lookup"><span data-stu-id="27b4b-117">Both can have shared constructors, with or without parameters.</span></span>  
  
- <span data-ttu-id="27b4b-118">Ambos podem expor uma *propriedade padrão*, desde que a propriedade aceite pelo menos um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="27b4b-118">Both can expose a *default property*, provided that property takes at least one parameter.</span></span>  
  
- <span data-ttu-id="27b4b-119">Ambos podem declarar e gerar eventos, e ambos podem declarar delegados.</span><span class="sxs-lookup"><span data-stu-id="27b4b-119">Both can declare and raise events, and both can declare delegates.</span></span>  
  
## <a name="differences"></a><span data-ttu-id="27b4b-120">Diferenças</span><span class="sxs-lookup"><span data-stu-id="27b4b-120">Differences</span></span>  

 <span data-ttu-id="27b4b-121">Estruturas e classes diferem nas seguintes particularidades:</span><span class="sxs-lookup"><span data-stu-id="27b4b-121">Structures and classes differ in the following particulars:</span></span>  
  
- <span data-ttu-id="27b4b-122">Estruturas são *tipos de valor*; classes são *tipos de referência*.</span><span class="sxs-lookup"><span data-stu-id="27b4b-122">Structures are *value types*; classes are *reference types*.</span></span> <span data-ttu-id="27b4b-123">Uma variável de um tipo de estrutura contém os dados da estrutura, em vez de conter uma referência aos dados como um tipo de classe.</span><span class="sxs-lookup"><span data-stu-id="27b4b-123">A variable of a structure type contains the structure's data, rather than containing a reference to the data as a class type does.</span></span>  
  
- <span data-ttu-id="27b4b-124">Estruturas usam alocação de pilha; as classes usam alocação de heap.</span><span class="sxs-lookup"><span data-stu-id="27b4b-124">Structures use stack allocation; classes use heap allocation.</span></span>  
  
- <span data-ttu-id="27b4b-125">Todos os elementos de estrutura são `Public` por padrão; variáveis de classe e constantes são `Private` por padrão, enquanto outros membros de classe são `Public` por padrão.</span><span class="sxs-lookup"><span data-stu-id="27b4b-125">All structure elements are `Public` by default; class variables and constants are `Private` by default, while other class members are `Public` by default.</span></span> <span data-ttu-id="27b4b-126">Esse comportamento para membros de classe fornece compatibilidade com o sistema Visual Basic 6,0 de padrões.</span><span class="sxs-lookup"><span data-stu-id="27b4b-126">This behavior for class members provides compatibility with the Visual Basic 6.0 system of defaults.</span></span>  
  
- <span data-ttu-id="27b4b-127">Uma estrutura deve ter pelo menos uma variável não compartilhada ou um elemento de evento não compartilhado e não-personalizado; uma classe pode estar completamente vazia.</span><span class="sxs-lookup"><span data-stu-id="27b4b-127">A structure must have at least one nonshared variable or nonshared, noncustom event element; a class can be completely empty.</span></span>  
  
- <span data-ttu-id="27b4b-128">Elementos de estrutura não podem ser declarados como `Protected` ; membros de classe podem.</span><span class="sxs-lookup"><span data-stu-id="27b4b-128">Structure elements cannot be declared as `Protected`; class members can.</span></span>  
  
- <span data-ttu-id="27b4b-129">Um procedimento de estrutura pode manipular eventos somente se for um [Shared](../../../language-reference/modifiers/shared.md) `Sub` procedimento compartilhado e apenas por meio da [instrução AddHandler](../../../language-reference/statements/addhandler-statement.md); qualquer procedimento de classe pode manipular eventos, usando a palavra-chave [Handles](../../../language-reference/statements/handles-clause.md) ou a `AddHandler` instrução.</span><span class="sxs-lookup"><span data-stu-id="27b4b-129">A structure procedure can handle events only if it is a [Shared](../../../language-reference/modifiers/shared.md)`Sub` procedure, and only by means of the [AddHandler Statement](../../../language-reference/statements/addhandler-statement.md); any class procedure can handle events, using either the [Handles](../../../language-reference/statements/handles-clause.md) keyword or the `AddHandler` statement.</span></span> <span data-ttu-id="27b4b-130">Para obter mais informações, consulte [Eventos](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="27b4b-130">For more information, see [Events](../events/index.md).</span></span>  
  
- <span data-ttu-id="27b4b-131">Declarações de variável de estrutura não podem especificar inicializadores ou tamanhos iniciais para matrizes; declarações de variável de classe podem.</span><span class="sxs-lookup"><span data-stu-id="27b4b-131">Structure variable declarations cannot specify initializers or initial sizes for arrays; class variable declarations can.</span></span>  
  
- <span data-ttu-id="27b4b-132">As estruturas herdam implicitamente da <xref:System.ValueType?displayProperty=nameWithType> classe e não podem herdar de nenhum outro tipo; as classes podem herdar de qualquer classe ou classes diferentes de <xref:System.ValueType?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="27b4b-132">Structures implicitly inherit from the <xref:System.ValueType?displayProperty=nameWithType> class and cannot inherit from any other type; classes can inherit from any class or classes other than <xref:System.ValueType?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="27b4b-133">Estruturas não são herdáveis; as classes são.</span><span class="sxs-lookup"><span data-stu-id="27b4b-133">Structures are not inheritable; classes are.</span></span>  
  
- <span data-ttu-id="27b4b-134">As estruturas nunca são encerradas, portanto, o Common Language Runtime (CLR) nunca chama o <xref:System.Object.Finalize%2A> método em qualquer estrutura; as classes são encerradas pelo GC (coletor de lixo), que chama <xref:System.Object.Finalize%2A> uma classe quando detecta que não há nenhuma referência ativa restante.</span><span class="sxs-lookup"><span data-stu-id="27b4b-134">Structures are never terminated, so the common language runtime (CLR) never calls the <xref:System.Object.Finalize%2A> method on any structure; classes are terminated by the garbage collector (GC), which calls <xref:System.Object.Finalize%2A> on a class when it detects there are no active references remaining.</span></span>  
  
- <span data-ttu-id="27b4b-135">Uma estrutura não requer um construtor; uma classe faz.</span><span class="sxs-lookup"><span data-stu-id="27b4b-135">A structure does not require a constructor; a class does.</span></span>  
  
- <span data-ttu-id="27b4b-136">Estruturas só podem ter construtores não compartilhados se eles usam parâmetros; as classes podem tê-las com ou sem parâmetros.</span><span class="sxs-lookup"><span data-stu-id="27b4b-136">Structures can have nonshared constructors only if they take parameters; classes can have them with or without parameters.</span></span>  
  
 <span data-ttu-id="27b4b-137">Cada estrutura tem um construtor público implícito sem parâmetros.</span><span class="sxs-lookup"><span data-stu-id="27b4b-137">Every structure has an implicit public constructor without parameters.</span></span> <span data-ttu-id="27b4b-138">Esse construtor inicializa todos os elementos de dados da estrutura para seus valores padrão.</span><span class="sxs-lookup"><span data-stu-id="27b4b-138">This constructor initializes all the structure's data elements to their default values.</span></span> <span data-ttu-id="27b4b-139">Você não pode redefinir esse comportamento.</span><span class="sxs-lookup"><span data-stu-id="27b4b-139">You cannot redefine this behavior.</span></span>  
  
## <a name="instances-and-variables"></a><span data-ttu-id="27b4b-140">Instâncias e variáveis</span><span class="sxs-lookup"><span data-stu-id="27b4b-140">Instances and Variables</span></span>  

 <span data-ttu-id="27b4b-141">Como estruturas são tipos de valor, cada variável de estrutura é permanentemente associada a uma instância de estrutura individual.</span><span class="sxs-lookup"><span data-stu-id="27b4b-141">Because structures are value types, each structure variable is permanently bound to an individual structure instance.</span></span> <span data-ttu-id="27b4b-142">Mas classes são tipos de referência, e uma variável de objeto pode se referir a várias instâncias de classe em momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="27b4b-142">But classes are reference types, and an object variable can refer to various class instances at different times.</span></span> <span data-ttu-id="27b4b-143">Essa distinção afeta o uso de estruturas e classes das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="27b4b-143">This distinction affects your usage of structures and classes in the following ways:</span></span>  
  
- <span data-ttu-id="27b4b-144">**Initialization.**</span><span class="sxs-lookup"><span data-stu-id="27b4b-144">**Initialization.**</span></span> <span data-ttu-id="27b4b-145">Uma variável de estrutura inclui implicitamente uma inicialização dos elementos usando o construtor sem parâmetros da estrutura.</span><span class="sxs-lookup"><span data-stu-id="27b4b-145">A structure variable implicitly includes an initialization of the elements using the structure's parameterless constructor.</span></span> <span data-ttu-id="27b4b-146">Portanto, `Dim s As struct1` é equivalente a `Dim s As struct1 = New struct1()` .</span><span class="sxs-lookup"><span data-stu-id="27b4b-146">Therefore, `Dim s As struct1` is equivalent to `Dim s As struct1 = New struct1()`.</span></span>  
  
- <span data-ttu-id="27b4b-147">**Atribuindo variáveis.**</span><span class="sxs-lookup"><span data-stu-id="27b4b-147">**Assigning Variables.**</span></span> <span data-ttu-id="27b4b-148">Quando você atribui uma variável de estrutura a outra ou passa uma instância de estrutura para um argumento de procedimento, os valores atuais de todos os elementos variáveis são copiados para a nova estrutura.</span><span class="sxs-lookup"><span data-stu-id="27b4b-148">When you assign one structure variable to another, or pass a structure instance to a procedure argument, the current values of all the variable elements are copied to the new structure.</span></span> <span data-ttu-id="27b4b-149">Quando você atribui uma variável de objeto a outra ou passa uma variável de objeto para um procedimento, somente o ponteiro de referência é copiado.</span><span class="sxs-lookup"><span data-stu-id="27b4b-149">When you assign one object variable to another, or pass an object variable to a procedure, only the reference pointer is copied.</span></span>  
  
- <span data-ttu-id="27b4b-150">**Atribuindo nada.**</span><span class="sxs-lookup"><span data-stu-id="27b4b-150">**Assigning Nothing.**</span></span> <span data-ttu-id="27b4b-151">Você pode atribuir o valor [Nothing](../../../language-reference/nothing.md) a uma variável de estrutura, mas a instância continua a ser associada à variável.</span><span class="sxs-lookup"><span data-stu-id="27b4b-151">You can assign the value [Nothing](../../../language-reference/nothing.md) to a structure variable, but the instance continues to be associated with the variable.</span></span> <span data-ttu-id="27b4b-152">Você ainda pode chamar seus métodos e acessar seus elementos de dados, embora elementos variáveis sejam reinicializados pela atribuição.</span><span class="sxs-lookup"><span data-stu-id="27b4b-152">You can still call its methods and access its data elements, although variable elements are reinitialized by the assignment.</span></span>  
  
     <span data-ttu-id="27b4b-153">Por outro lado, se você definir uma variável de objeto como `Nothing` , você a dissocia de qualquer instância de classe e não poderá acessar nenhum membro por meio da variável até que você atribua outra instância a ela.</span><span class="sxs-lookup"><span data-stu-id="27b4b-153">In contrast, if you set an object variable to `Nothing`, you dissociate it from any class instance, and you cannot access any members through the variable until you assign another instance to it.</span></span>  
  
- <span data-ttu-id="27b4b-154">**Várias instâncias.**</span><span class="sxs-lookup"><span data-stu-id="27b4b-154">**Multiple Instances.**</span></span> <span data-ttu-id="27b4b-155">Uma variável de objeto pode ter diferentes instâncias de classe atribuídas a ela em momentos diferentes, e várias variáveis de objeto podem se referir à mesma instância de classe ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="27b4b-155">An object variable can have different class instances assigned to it at different times, and several object variables can refer to the same class instance at the same time.</span></span> <span data-ttu-id="27b4b-156">As alterações feitas nos valores dos membros da classe afetam esses membros quando acessados por meio de outra variável que aponta para a mesma instância.</span><span class="sxs-lookup"><span data-stu-id="27b4b-156">Changes you make to the values of class members affect those members when accessed through another variable pointing to the same instance.</span></span>  
  
     <span data-ttu-id="27b4b-157">Os elementos de estrutura, no entanto, são isolados em sua própria instância.</span><span class="sxs-lookup"><span data-stu-id="27b4b-157">Structure elements, however, are isolated within their own instance.</span></span> <span data-ttu-id="27b4b-158">As alterações em seus valores não são refletidas em nenhuma outra variável de estrutura, mesmo em outras instâncias da mesma `Structure` declaração.</span><span class="sxs-lookup"><span data-stu-id="27b4b-158">Changes to their values are not reflected in any other structure variables, even in other instances of the same `Structure` declaration.</span></span>  
  
- <span data-ttu-id="27b4b-159">**Igualmente.**</span><span class="sxs-lookup"><span data-stu-id="27b4b-159">**Equality.**</span></span> <span data-ttu-id="27b4b-160">O teste de igualdade de duas estruturas deve ser executado com um teste de elemento por elemento.</span><span class="sxs-lookup"><span data-stu-id="27b4b-160">Equality testing of two structures must be performed with an element-by-element test.</span></span> <span data-ttu-id="27b4b-161">Duas variáveis de objeto podem ser comparadas usando o <xref:System.Object.Equals%2A> método.</span><span class="sxs-lookup"><span data-stu-id="27b4b-161">Two object variables can be compared using the <xref:System.Object.Equals%2A> method.</span></span> <span data-ttu-id="27b4b-162"><xref:System.Object.Equals%2A> indica se as duas variáveis apontam para a mesma instância.</span><span class="sxs-lookup"><span data-stu-id="27b4b-162"><xref:System.Object.Equals%2A> indicates whether the two variables point to the same instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="27b4b-163">Confira também</span><span class="sxs-lookup"><span data-stu-id="27b4b-163">See also</span></span>

- [<span data-ttu-id="27b4b-164">Data Types</span><span class="sxs-lookup"><span data-stu-id="27b4b-164">Data Types</span></span>](index.md)
- [<span data-ttu-id="27b4b-165">Tipos de dados compostos</span><span class="sxs-lookup"><span data-stu-id="27b4b-165">Composite Data Types</span></span>](composite-data-types.md)
- [<span data-ttu-id="27b4b-166">Tipos de valor e referência</span><span class="sxs-lookup"><span data-stu-id="27b4b-166">Value Types and Reference Types</span></span>](value-types-and-reference-types.md)
- [<span data-ttu-id="27b4b-167">Estruturas</span><span class="sxs-lookup"><span data-stu-id="27b4b-167">Structures</span></span>](structures.md)
- [<span data-ttu-id="27b4b-168">Solução de problemas de tipos de dados</span><span class="sxs-lookup"><span data-stu-id="27b4b-168">Troubleshooting Data Types</span></span>](troubleshooting-data-types.md)
- [<span data-ttu-id="27b4b-169">Estruturas e outros elementos de programação</span><span class="sxs-lookup"><span data-stu-id="27b4b-169">Structures and Other Programming Elements</span></span>](structures-and-other-programming-elements.md)
- [<span data-ttu-id="27b4b-170">Objetos e classes</span><span class="sxs-lookup"><span data-stu-id="27b4b-170">Objects and Classes</span></span>](../objects-and-classes/index.md)
