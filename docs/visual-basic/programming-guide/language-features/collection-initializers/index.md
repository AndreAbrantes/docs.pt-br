---
title: Inicializadores de coleção (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.CollectionInitializer
helpviewer_keywords:
- collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
ms.openlocfilehash: e844a673f1a60d5a151a6ae612d4af7a6712eef4
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43508338"
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="591ba-102">Inicializadores de coleção (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="591ba-102">Collection Initializers (Visual Basic)</span></span>
<span data-ttu-id="591ba-103">Os *inicializadores de coleção* fornecem uma sintaxe abreviada que permite criar uma coleção e preenchê-la com um conjunto inicial de valores.</span><span class="sxs-lookup"><span data-stu-id="591ba-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="591ba-104">Os inicializadores de coleção são úteis quando você está criando uma coleção de um conjunto de valores conhecidos, por exemplo, uma lista de opções de menu ou de categorias, um conjunto inicial de valores numéricos, uma lista estática de cadeias de caracteres, como nomes de mês ou de dias, ou localizações geográficas, como uma lista de estados usada para validação.</span><span class="sxs-lookup"><span data-stu-id="591ba-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>  
  
 <span data-ttu-id="591ba-105">Para obter mais informações sobre coleções, consulte [Coleções](https://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span><span class="sxs-lookup"><span data-stu-id="591ba-105">For more information about collections, see [Collections](https://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span></span>  
  
 <span data-ttu-id="591ba-106">Você identificará um inicializador de coleção usando a palavra-chave `From` seguida por chaves (`{}`).</span><span class="sxs-lookup"><span data-stu-id="591ba-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="591ba-107">Isso é semelhante à sintaxe de literal de matriz descrita em [Matrizes](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="591ba-107">This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span> <span data-ttu-id="591ba-108">Os exemplos a seguir mostram várias maneiras de usar inicializadores de coleção para criar coleções.</span><span class="sxs-lookup"><span data-stu-id="591ba-108">The following examples show various ways to use collection initializers to create collections.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]  
  
> [!NOTE]
>  <span data-ttu-id="591ba-109">O C# também fornece inicializadores de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-109">C# also provides collection initializers.</span></span> <span data-ttu-id="591ba-110">Os inicializadores de coleção C# fornecem a mesma funcionalidade que a dos inicializadores de coleção do Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="591ba-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="591ba-111">Para obter mais informações sobre os inicializadores de coleção do C#, consulte [Inicializadores de objeto e de coleção](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="591ba-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="591ba-112">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="591ba-112">Syntax</span></span>  
 <span data-ttu-id="591ba-113">Um inicializador de coleção consiste em uma lista de valores separados por vírgula colocados entre chaves (`{}`), precedidos pela palavra-chave `From`, conforme mostrado no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="591ba-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]  
  
 <span data-ttu-id="591ba-114">Ao criar uma coleção, como uma <xref:System.Collections.Generic.List%601> ou uma <xref:System.Collections.Generic.Dictionary%602>, você deverá fornecer o tipo de coleção antes do inicializador de coleção, conforme mostrado no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="591ba-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]  
  
> [!NOTE]
>  <span data-ttu-id="591ba-115">Você não pode combinar um inicializador de coleção com um inicializador de objeto para inicializar o mesmo objeto de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="591ba-116">Você pode usar os inicializadores de objeto para inicializar objetos em um inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-116">You can use object initializers to initialize objects in a collection initializer.</span></span>  
  
## <a name="creating-a-collection-by-using-a-collection-intializer"></a><span data-ttu-id="591ba-117">Criando uma coleção usando um inicializador de coleção</span><span class="sxs-lookup"><span data-stu-id="591ba-117">Creating a Collection by Using a Collection Intializer</span></span>  
 <span data-ttu-id="591ba-118">Ao criar uma coleção usando um inicializador de coleção, todo valor fornecido no inicializador de coleção será passado ao método `Add` apropriado da coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="591ba-119">Por exemplo, se você criar uma <xref:System.Collections.Generic.List%601> usando um inicializador de coleção, todo valor de cadeia de caracteres no inicializador de coleção será passado ao método <xref:System.Collections.Generic.List%601.Add%2A>.</span><span class="sxs-lookup"><span data-stu-id="591ba-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="591ba-120">Se desejar criar uma coleção usando um inicializador de coleção, o tipo especificado deverá ser um tipo de coleção válido.</span><span class="sxs-lookup"><span data-stu-id="591ba-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="591ba-121">Os exemplos de tipos de coleção válidos incluem as classes que implementam a interface <xref:System.Collections.Generic.IEnumerable%601> ou que herdam a classe <xref:System.Collections.CollectionBase>.</span><span class="sxs-lookup"><span data-stu-id="591ba-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="591ba-122">O tipo especificado também deve expor um método `Add` que atenda aos seguintes critérios.</span><span class="sxs-lookup"><span data-stu-id="591ba-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>  
  
-   <span data-ttu-id="591ba-123">O método `Add` deve estar disponível no escopo em que o inicializador de coleção está sendo chamado.</span><span class="sxs-lookup"><span data-stu-id="591ba-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="591ba-124">Se você estiver usando o inicializador de coleção em um cenário no qual os métodos não públicos da coleção possam ser acessados, o método `Add` não precisará ser público.</span><span class="sxs-lookup"><span data-stu-id="591ba-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>  
  
-   <span data-ttu-id="591ba-125">O método `Add` deve ser um membro de instância ou um membro `Shared` da classe da coleção ou um método de extensão.</span><span class="sxs-lookup"><span data-stu-id="591ba-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>  
  
-   <span data-ttu-id="591ba-126">Um método `Add` que possa ser correspondido deve existir, com base nas regras de resolução de sobrecarga, para os tipos fornecidos no inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>  
  
 <span data-ttu-id="591ba-127">Por exemplo, o exemplo de código a seguir mostra como criar uma coleção `List(Of Customer)` usando um inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="591ba-128">Quando o código for executado, todo objeto `Customer` será passado ao método `Add(Customer)` da lista genérica.</span><span class="sxs-lookup"><span data-stu-id="591ba-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]  
  
 <span data-ttu-id="591ba-129">O exemplo de código a seguir mostra o código equivalente que não usa um inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]  
  
 <span data-ttu-id="591ba-130">Se a coleção tiver um método `Add` com parâmetros correspondentes ao construtor do objeto `Customer`, você poderá aninhar os valores de parâmetro do método `Add` nos inicializadores de coleção, conforme será discutido na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="591ba-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="591ba-131">Se a coleção não tiver um método `Add`, você poderá criar um como um método de extensão.</span><span class="sxs-lookup"><span data-stu-id="591ba-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="591ba-132">Para obter um exemplo de como criar um método `Add` como um método de extensão para uma coleção, consulte [Como criar um método de extensão Add usado por um inicializador de coleção](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="591ba-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="591ba-133">Para obter um exemplo de como criar uma coleção personalizada que pode ser usada com um inicializador de coleção, consulte [Como criar uma coleção usada por um inicializador de coleção](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="591ba-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>  
  
## <a name="nesting-collection-initializers"></a><span data-ttu-id="591ba-134">Aninhando inicializadores de coleção</span><span class="sxs-lookup"><span data-stu-id="591ba-134">Nesting Collection Initializers</span></span>  
 <span data-ttu-id="591ba-135">Você pode aninhar valores em um inicializador de coleção para identificar uma sobrecarga específica de um método `Add` para a coleção que está sendo criada.</span><span class="sxs-lookup"><span data-stu-id="591ba-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="591ba-136">Os valores passados ao método `Add` devem ser separados por vírgula e colocados entre chaves (`{}`), como você faria em uma literal de matriz ou em um inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>  
  
 <span data-ttu-id="591ba-137">Ao criar uma coleção usando valores aninhados, todo elemento da lista de valores aninhados é passado como um argumento ao método `Add` correspondente aos tipos de elemento.</span><span class="sxs-lookup"><span data-stu-id="591ba-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="591ba-138">Por exemplo, o exemplo de código a seguir cria um <xref:System.Collections.Generic.Dictionary%602> em que as chaves são do tipo `Integer` e os valores, do tipo `String`.</span><span class="sxs-lookup"><span data-stu-id="591ba-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="591ba-139">Cada uma das listas de valores aninhados corresponde ao método <xref:System.Collections.Generic.Dictionary%602.Add%2A> do `Dictionary`.</span><span class="sxs-lookup"><span data-stu-id="591ba-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]  
  
 <span data-ttu-id="591ba-140">O exemplo de código anterior é equivalente ao seguinte código.</span><span class="sxs-lookup"><span data-stu-id="591ba-140">The previous code example is equivalent to the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]  
  
 <span data-ttu-id="591ba-141">Somente as listas de valores aninhados do primeiro nível de aninhamento são enviadas ao método `Add` do tipo de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="591ba-142">Níveis de aninhamento mais profundos são tratados como literais de matriz e as listas de valores aninhados não correspondem ao método `Add` de nenhuma coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="591ba-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="591ba-143">Related Topics</span></span>  
  
|<span data-ttu-id="591ba-144">Título</span><span class="sxs-lookup"><span data-stu-id="591ba-144">Title</span></span>|<span data-ttu-id="591ba-145">Descrição</span><span class="sxs-lookup"><span data-stu-id="591ba-145">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="591ba-146">Como criar um método para adicionar extensão usado por um inicializador de coleção</span><span class="sxs-lookup"><span data-stu-id="591ba-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="591ba-147">Mostra como criar um método de extensão chamado `Add`, que pode ser usado para preencher uma coleção com valores de um inicializador de coleção.</span><span class="sxs-lookup"><span data-stu-id="591ba-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|  
|[<span data-ttu-id="591ba-148">Como criar uma coleção usada por um inicializador de coleção</span><span class="sxs-lookup"><span data-stu-id="591ba-148">How to: Create a Collection Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="591ba-149">Mostra como habilitar o uso de um inicializador de coleção, incluindo um método `Add` em uma classe de coleção que implementa `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="591ba-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="591ba-150">Consulte também</span><span class="sxs-lookup"><span data-stu-id="591ba-150">See Also</span></span>  
 [<span data-ttu-id="591ba-151">Coleções</span><span class="sxs-lookup"><span data-stu-id="591ba-151">Collections</span></span>](https://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)  
 [<span data-ttu-id="591ba-152">Matrizes</span><span class="sxs-lookup"><span data-stu-id="591ba-152">Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/index.md)  
 [<span data-ttu-id="591ba-153">Inicializadores de objeto: tipos nomeados e anônimos</span><span class="sxs-lookup"><span data-stu-id="591ba-153">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="591ba-154">Operador New</span><span class="sxs-lookup"><span data-stu-id="591ba-154">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)  
 [<span data-ttu-id="591ba-155">Propriedades Autoimplementadas</span><span class="sxs-lookup"><span data-stu-id="591ba-155">Auto-Implemented Properties</span></span>](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)  
 [<span data-ttu-id="591ba-156">Como inicializar uma variável de matriz no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="591ba-156">How to: Initialize an Array Variable in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)  
 [<span data-ttu-id="591ba-157">Inferência de Tipo de Variável Local</span><span class="sxs-lookup"><span data-stu-id="591ba-157">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="591ba-158">Tipos Anônimos</span><span class="sxs-lookup"><span data-stu-id="591ba-158">Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)  
 [<span data-ttu-id="591ba-159">Introdução ao LINQ no Visual Basic</span><span class="sxs-lookup"><span data-stu-id="591ba-159">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="591ba-160">Como criar uma lista de itens</span><span class="sxs-lookup"><span data-stu-id="591ba-160">How to: Create a List of Items</span></span>](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)
