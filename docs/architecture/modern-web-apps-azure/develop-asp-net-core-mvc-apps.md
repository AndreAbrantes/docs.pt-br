---
title: Desenvolvendo aplicativos ASP.NET Core MVC
description: Projetar aplicativos Web modernos com o ASP.NET Core e o Azure | desenvolvendo aplicativos ASP.NET Core MVC
author: ardalis
ms.author: wiwagn
ms.date: 12/04/2019
ms.openlocfilehash: be674f3292238b1983064408184777d379cf52a7
ms.sourcegitcommit: 5280b2aef60a1ed99002dba44e4b9e7f6c830604
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/03/2020
ms.locfileid: "84307001"
---
# <a name="develop-aspnet-core-mvc-apps"></a><span data-ttu-id="fa0b4-103">Desenvolver aplicativos ASP.NET Core MVC</span><span class="sxs-lookup"><span data-stu-id="fa0b4-103">Develop ASP.NET Core MVC apps</span></span>

> <span data-ttu-id="fa0b4-104">"Não é importante acertar na primeira vez.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-104">"It's not important to get it right the first time.</span></span> <span data-ttu-id="fa0b4-105">É extremamente importante acertar na última vez."</span><span class="sxs-lookup"><span data-stu-id="fa0b4-105">It's vitally important to get it right the last time."</span></span>  
> <span data-ttu-id="fa0b4-106">_– Andrew Hunt e David Thomas_</span><span class="sxs-lookup"><span data-stu-id="fa0b4-106">_- Andrew Hunt and David Thomas_</span></span>

<span data-ttu-id="fa0b4-107">O ASP.NET Core é uma estrutura multiplataforma de software livre para a criação de aplicativos Web modernos otimizados para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-107">ASP.NET Core is a cross-platform, open-source framework for building modern cloud-optimized web applications.</span></span> <span data-ttu-id="fa0b4-108">Os aplicativos ASP.NET Core são leves e modulares, com suporte interno para a injeção de dependência, o que aumenta a capacidade de teste e a facilidade de manutenção.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-108">ASP.NET Core apps are lightweight and modular, with built-in support for dependency injection, enabling greater testability and maintainability.</span></span> <span data-ttu-id="fa0b4-109">Combinado com o MVC, que é compatível com a criação de APIs Web modernas, além de aplicativos baseados em exibição, o ASP.NET Core é uma estrutura avançada para a criação de aplicativos Web empresariais.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-109">Combined with MVC, which supports building modern web APIs in addition to view-based apps, ASP.NET Core is a powerful framework with which to build enterprise web applications.</span></span>

## <a name="mvc-and-razor-pages"></a><span data-ttu-id="fa0b4-110">MVC e Razor Pages</span><span class="sxs-lookup"><span data-stu-id="fa0b4-110">MVC and Razor Pages</span></span>

<span data-ttu-id="fa0b4-111">O ASP.NET Core MVC oferece diversos recursos úteis para a criação de APIs e aplicativos baseados na Web.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-111">ASP.NET Core MVC offers many features that are useful for building web-based APIs and apps.</span></span> <span data-ttu-id="fa0b4-112">O termo MVC significa "Model-View-Controller", um padrão de interface do usuário que divide a responsabilidade de responder às solicitações do usuário em várias partes.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-112">The term MVC stands for "Model-View-Controller", a UI pattern that breaks up the responsibilities of responding to user requests into several parts.</span></span> <span data-ttu-id="fa0b4-113">Além de seguir esse padrão, você também pode implementar recursos em seus aplicativos ASP.NET Core, como as Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-113">In addition to following this pattern, you can also implement features in your ASP.NET Core apps as Razor Pages.</span></span> <span data-ttu-id="fa0b4-114">Os Razor Pages são incorporados ao ASP.NET Core MVC e usam os mesmos recursos para roteamento, associação de modelo, etc. No entanto, em vez de ter pastas e arquivos separados para controladores, exibições, etc. e usando roteamento baseado em atributo, os Razor Pages são colocados em uma única pasta ("/Pages"), roteiam-se com base em seu local relativo nessa pasta e lidam com as solicitações com manipuladores em vez de ações do controlador.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-114">Razor Pages are built into ASP.NET Core MVC, and use the same features for routing, model binding, etc. However, instead of having separate folders and files for Controllers, Views, etc. and using attribute-based routing, Razor Pages are placed in a single folder ("/Pages"), route based on their relative location in this folder, and handle requests with handlers instead of controller actions.</span></span>

<span data-ttu-id="fa0b4-115">Ao criar um aplicativo ASP.NET Core, você deve ter um plano em mente para o tipo de aplicativo que deseja.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-115">When you create a new ASP.NET Core App, you should have a plan in mind for the kind of app you want to build.</span></span> <span data-ttu-id="fa0b4-116">No Visual Studio, você poderá escolher entre vários modelos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-116">In Visual Studio, you'll choose from several templates.</span></span> <span data-ttu-id="fa0b4-117">Os três modelos de projeto mais comuns são a API Web, o aplicativo Web e aplicativo Web (Model-View-Controller).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-117">The three most common project templates are Web API, Web Application, and Web Application (Model-View-Controller).</span></span> <span data-ttu-id="fa0b4-118">Embora você só possa tomar essa decisão quando cria um projeto pela primeira vez, ela não é uma decisão irrevogável.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-118">Although you can only make this decision when you first create a project, it's not an irrevocable decision.</span></span> <span data-ttu-id="fa0b4-119">O projeto de API Web usa controladores Model-View-Controller padrão. Ele apenas não tem Exibições por padrão.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-119">The Web API project uses standard Model-View-Controller controllers – it just lacks Views by default.</span></span> <span data-ttu-id="fa0b4-120">Da mesma forma, o modelo de Aplicativo Web padrão usa Razor Pages e, portanto, também não tem uma pasta de Exibições.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-120">Likewise, the default Web Application template uses Razor Pages, and so also lacks a Views folder.</span></span> <span data-ttu-id="fa0b4-121">Você poderá adicionar uma pasta de Exibições a esses projetos mais tarde para permitir o comportamento com base na exibição.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-121">You can add a Views folder to these projects later to support view-based behavior.</span></span> <span data-ttu-id="fa0b4-122">Os projetos de API Web e Model-View-Controller não incluem uma pasta Pages por padrão, mas você poderá adicioná-la mais tarde para permitir o comportamento com base em Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-122">Web API and Model-View-Controller projects don't include a Pages folder by default, but you can add one later to support Razor Pages-based behavior.</span></span> <span data-ttu-id="fa0b4-123">Considere esses três modelos como suportes a três tipos diferentes de interação do usuário padrão: dados (API Web), baseado em página e baseado em exibição.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-123">You can think of these three templates as supporting three different kinds of default user interaction: data (web API), page-based, and view-based.</span></span> <span data-ttu-id="fa0b4-124">No entanto, você poderá combiná-los e usar um deles ou todos eles em um único projeto, se desejar.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-124">However, you can mix and match any or all of these within a single project if you wish.</span></span>

### <a name="why-razor-pages"></a><span data-ttu-id="fa0b4-125">Por que usar Razor Pages?</span><span class="sxs-lookup"><span data-stu-id="fa0b4-125">Why Razor Pages?</span></span>

<span data-ttu-id="fa0b4-126">As Razor Pages são a abordagem padrão para novos aplicativos Web no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-126">Razor Pages is the default approach for new web applications in Visual Studio.</span></span> <span data-ttu-id="fa0b4-127">Elas oferecem uma maneira mais simples de criar recursos de aplicativo baseados em página, como formulários que não são de SPA.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-127">Razor Pages offers a simpler way of building page-based application features, such as non-SPA forms.</span></span> <span data-ttu-id="fa0b4-128">Com controladores e exibições, era comum que os aplicativos tivessem controladores muito grandes que funcionavam com muitas dependências e modelos de exibição diferentes e retornavam várias exibições.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-128">Using controllers and views, it was common for applications to have very large controllers that worked with many different dependencies and view models and returned many different views.</span></span> <span data-ttu-id="fa0b4-129">Isso resultou em mais complexidade e, muitas vezes, resultou em controladores que não seguiram o princípio de responsabilidade única ou princípios abertos/fechados com eficiência.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-129">This resulted in more complexity and often resulted in controllers that didn't follow the Single Responsibility Principle or Open/Closed Principles effectively.</span></span> <span data-ttu-id="fa0b4-130">As Razor Pages resolvem esse problema encapsulando a lógica do lado do servidor para uma determinada "página" lógica em um aplicativo Web com sua marcação Razor.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-130">Razor Pages addresses this issue by encapsulating the server-side logic for a given logical "page" in a web application with its Razor markup.</span></span> <span data-ttu-id="fa0b4-131">Uma Razor Page sem nenhuma lógica do lado do servidor pode consistir simplesmente em um arquivo Razor (por exemplo, "Index.cshtml").</span><span class="sxs-lookup"><span data-stu-id="fa0b4-131">A Razor Page that has no server-side logic can simply consist of a Razor file (for instance, "Index.cshtml").</span></span> <span data-ttu-id="fa0b4-132">No entanto, a maioria das Razor Pages menos triviais têm uma classe de modelo de página associada, que, por convenção, tem o mesmo nome que o arquivo do Razor, com uma extensão ".cs" (por exemplo, "Index.cshtml.cs").</span><span class="sxs-lookup"><span data-stu-id="fa0b4-132">However, most non-trivial Razor Pages will have an associated page model class, which by convention is named the same as the Razor file with a ".cs" extension (for example, "Index.cshtml.cs").</span></span>

<span data-ttu-id="fa0b4-133">O modelo de página de uma página Razor combina as responsabilidades de um controlador MVC e um ViewModel.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-133">A Razor Page's page model combines the responsibilities of an MVC controller and a viewmodel.</span></span> <span data-ttu-id="fa0b4-134">Em vez de manipular as solicitações com métodos de ação do controlador, são executados manipuladores de modelo de página, como "OnGet()", renderizando suas próprias páginas associadas por padrão.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-134">Instead of handling requests with controller action methods, page model handlers like "OnGet()" are executed, rendering their associated page by default.</span></span> <span data-ttu-id="fa0b4-135">As Razor Pages simplificam o processo de criação de páginas individuais em um aplicativo ASP.NET Core, fornecendo ainda todos os recursos de arquiteturas ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-135">Razor Pages simplifies the process of building individual pages in an ASP.NET Core app, while still providing all the architectural features of ASP.NET Core MVC.</span></span> <span data-ttu-id="fa0b4-136">Elas são uma boa opção padrão para a nova funcionalidade baseada em página.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-136">They're a good default choice for new page-based functionality.</span></span>

### <a name="when-to-use-mvc"></a><span data-ttu-id="fa0b4-137">Quando usar o MVC</span><span class="sxs-lookup"><span data-stu-id="fa0b4-137">When to use MVC</span></span>

<span data-ttu-id="fa0b4-138">Se você estiver criando APIs da Web, o padrão MVC faz mais sentido do que tentar usar Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-138">If you're building web APIs, the MVC pattern makes more sense than trying to use Razor Pages.</span></span> <span data-ttu-id="fa0b4-139">Se o seu projeto apenas expor pontos de extremidade da API Web, você deve começar a usar o modelo de projeto de API Web.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-139">If your project will only expose web API endpoints, you should ideally start from the Web API project template.</span></span> <span data-ttu-id="fa0b4-140">Caso contrário, é fácil adicionar controladores e pontos de extremidade de API associados a qualquer aplicativo ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-140">Otherwise, it's easy to add controllers and associated API endpoints to any ASP.NET Core app.</span></span> <span data-ttu-id="fa0b4-141">Use a abordagem MVC baseada em exibição se estiver migrando um aplicativo existente do ASP.NET MVC 5 ou anterior para ASP.NET Core MVC e desejar fazer isso com a menor quantidade de esforço.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-141">Use the view-based MVC approach if you're migrating an existing application from ASP.NET MVC 5 or earlier to ASP.NET Core MVC and you want to do so with the least amount of effort.</span></span> <span data-ttu-id="fa0b4-142">Depois de fazer a migração inicial, você pode avaliar se faz sentido adotar Razor Pages para novos recursos ou até mesmo como uma migração de atacado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-142">Once you've made the initial migration, you can evaluate whether it makes sense to adopt Razor Pages for new features or even as a wholesale migration.</span></span>

<span data-ttu-id="fa0b4-143">Independentemente de você optar por criar seu aplicativo Web usando exibições Razor Pages ou MVC, seu aplicativo terá um desempenho semelhante e incluirá suporte para injeção de dependência, filtros, associação de modelo, validação e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-143">Whether you choose to build your web app using Razor Pages or MVC views, your app will have similar performance and will include support for dependency injection, filters, model binding, validation, and so on.</span></span>

## <a name="mapping-requests-to-responses"></a><span data-ttu-id="fa0b4-144">Mapeando solicitações para respostas</span><span class="sxs-lookup"><span data-stu-id="fa0b4-144">Mapping requests to responses</span></span>

<span data-ttu-id="fa0b4-145">Em sua essência, os aplicativos ASP.NET Core mapeiam as solicitações de entrada para as respostas de saída.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-145">At its heart, ASP.NET Core apps map incoming requests to outgoing responses.</span></span> <span data-ttu-id="fa0b4-146">Em um nível inferior, isso é feito com um middleware, e aplicativos ASP.NET Core e microsserviços simples podem ser compostos apenas por um middleware personalizado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-146">At a low level, this is done with middleware, and simple ASP.NET Core apps and microservices may be comprised solely of custom middleware.</span></span> <span data-ttu-id="fa0b4-147">Ao usar o ASP.NET Core MVC, você pode trabalhar em um nível um pouco superior, pensando em termos de _rotas_, _controladores_ e _ações_.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-147">When using ASP.NET Core MVC, you can work at a somewhat higher level, thinking in terms of _routes_, _controllers_, and _actions_.</span></span> <span data-ttu-id="fa0b4-148">Cada solicitação de entrada é comparada com a tabela de roteamento do aplicativo e se uma rota correspondente é encontrada, o método de ação associado (pertencente a um controlador) é chamado para manipular a solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-148">Each incoming request is compared with the application's routing table, and if a matching route is found, the associated action method (belonging to a controller) is called to handle the request.</span></span> <span data-ttu-id="fa0b4-149">Se nenhuma rota correspondente é encontrada, um manipulador de erro (nesse caso, retornando um resultado NotFound) é chamado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-149">If no matching route is found, an error handler (in this case, returning a NotFound result) is called.</span></span>

<span data-ttu-id="fa0b4-150">Os aplicativos ASP.NET Core MVC podem usar rotas convencionais, rotas de atributo ou ambas.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-150">ASP.NET Core MVC apps can use conventional routes, attribute routes, or both.</span></span> <span data-ttu-id="fa0b4-151">As rotas convencionais são definidas no código, especificando as _convenções_ de roteamento com uma sintaxe parecida com o exemplo abaixo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-151">Conventional routes are defined in code, specifying routing _conventions_ using syntax like in the example below:</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    endpoints.MapControllerRoute(name: "default", pattern: "{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="fa0b4-152">Nesse exemplo, uma rota chamada "default" foi adicionada à tabela de roteamento.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-152">In this example, a route named "default" has been added to the routing table.</span></span> <span data-ttu-id="fa0b4-153">Ele define um modelo de rota com espaços reservados para o _controlador_, a _ação_e a _ID_. Os espaços reservados de controlador e ação têm o padrão especificado ("início" e "índice", respectivamente) e o espaço reservado de ID é opcional (em virtude de um "?" aplicado a ele).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-153">It defines a route template with placeholders for _controller_, _action_, and _id_. The controller and action placeholders have default specified ("Home" and "Index", respectively), and the id placeholder is optional (by virtue of a "?" applied to it).</span></span> <span data-ttu-id="fa0b4-154">A convenção definida aqui indica que a primeira parte de uma solicitação deve corresponder ao nome do controlador, a segunda parte à ação, e, em seguida, se for necessário, uma terceira parte representará um parâmetro de ID.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-154">The convention defined here states that the first part of a request should correspond to the name of the controller, the second part to the action, and then if necessary a third part will represent an id parameter.</span></span> <span data-ttu-id="fa0b4-155">As rotas convencionais costumam ser definidas em um lugar para o aplicativo, como no método Configure na classe Startup.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-155">Conventional routes are typically defined in one place for the application, such as in the Configure method in the Startup class.</span></span>

<span data-ttu-id="fa0b4-156">As rotas de atributo são aplicadas aos controladores e às ações diretamente, em vez de serem especificadas globalmente.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-156">Attribute routes are applied to controllers and actions directly, rather than specified globally.</span></span> <span data-ttu-id="fa0b4-157">Isso oferece a vantagem de torná-las muito mais detectáveis quando você estiver procurando um método específico, mas significa que as informações de roteamento não são mantidas em um único lugar no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-157">This has the advantage of making them much more discoverable when you're looking at a particular method, but does mean that routing information is not kept in one place in the application.</span></span> <span data-ttu-id="fa0b4-158">Com as rotas de atributo, você pode especificar com facilidade várias rotas para determinada ação, além de combinar rotas entre controladores e ações.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-158">With attribute routes, you can easily specify multiple routes for a given action, as well as combine routes between controllers and actions.</span></span> <span data-ttu-id="fa0b4-159">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-159">For example:</span></span>

```csharp
[Route("Home")]
public class HomeController : Controller
{
    [Route("")] // Combines to define the route template "Home"
    [Route("Index")] // Combines to define route template "Home/Index"
    [Route("/")] // Does not combine, defines the route template ""
    public IActionResult Index() {}
}
```

<span data-ttu-id="fa0b4-160">As rotas podem ser especificadas no [HttpGet] e em atributos semelhantes, evitando a necessidade de adicionar atributos [Route] separados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-160">Routes can be specified on [HttpGet] and similar attributes, avoiding the need to add separate [Route] attributes.</span></span> <span data-ttu-id="fa0b4-161">As rotas de atributo também podem usar tokens para reduzir a necessidade de repetir os nomes do controlador ou da ação, conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-161">Attribute routes can also use tokens to reduce the need to repeat controller or action names, as shown below:</span></span>

```csharp
[Route("[controller]")]
public class ProductsController : Controller
{
    [Route("")] // Matches 'Products'
    [Route("Index")] // Matches 'Products/Index'
    public IActionResult Index() {}
}
```

<span data-ttu-id="fa0b4-162">Razor Pages não usa o roteamento de atributos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-162">Razor Pages doesn't use attribute routing.</span></span> <span data-ttu-id="fa0b4-163">Você pode especificar informações de modelo de rota adicionais para uma Razor Page como parte de sua diretiva `@page`:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-163">You can specify additional route template information for a Razor Page as part of its `@page` directive:</span></span>

```csharp
@page "{id:int}"
```

<span data-ttu-id="fa0b4-164">No exemplo anterior, a página em questão corresponderia a uma rota com um parâmetro `id` inteiro.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-164">In the previous example, the page in question would match a route with an integer `id` parameter.</span></span> <span data-ttu-id="fa0b4-165">Por exemplo, a página *Products.cshtml* localizada na raiz da `/Pages` teria esta rota:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-165">For example, the *Products.cshtml* page located in the root of `/Pages` would have this route:</span></span>

```csharp
"/Products/123"
```

<span data-ttu-id="fa0b4-166">Depois que for feita a correspondência de uma solicitação específica a uma rota, mas antes da chamada do método de ação, o ASP.NET Core MVC executará o [model binding](/aspnet/core/mvc/models/model-binding) e a [validação de modelos](/aspnet/core/mvc/models/validation) na solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-166">Once a given request has been matched to a route, but before the action method is called, ASP.NET Core MVC will perform [model binding](/aspnet/core/mvc/models/model-binding) and [model validation](/aspnet/core/mvc/models/validation) on the request.</span></span> <span data-ttu-id="fa0b4-167">O model binding é responsável por converter os dados HTTP de entrada nos tipos .NET especificados como parâmetros do método de ação a ser chamado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-167">Model binding is responsible for converting incoming HTTP data into the .NET types specified as parameters of the action method to be called.</span></span> <span data-ttu-id="fa0b4-168">Por exemplo, se o método de ação espera um `int id` parâmetro, a associação de modelo tentará fornecer esse parâmetro de um valor fornecido como parte da solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-168">For example, if the action method expects an `int id` parameter, model binding will attempt to provide this parameter from a value provided as part of the request.</span></span> <span data-ttu-id="fa0b4-169">Para fazer isso, o model binding procurará valores em um formulário publicado, valores na própria rota e valores de cadeia de caracteres de consulta.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-169">To do so, model binding looks for values in a posted form, values in the route itself, and query string values.</span></span> <span data-ttu-id="fa0b4-170">Supondo que um valor de ID seja encontrado, ele será convertido em um inteiro antes de ser passado para o método de ação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-170">Assuming an id value is found, it will be converted to an integer before being passed into the action method.</span></span>

<span data-ttu-id="fa0b4-171">Após a associação do modelo, mas antes da chamada do método de ação, ocorre a validação de modelos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-171">After binding the model but before calling the action method, model validation occurs.</span></span> <span data-ttu-id="fa0b4-172">A validação de modelos usa atributos opcionais no tipo de modelo e pode ajudar a garantir que o objeto de modelo fornecido está em conformidade com determinados requisitos de dados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-172">Model validation uses optional attributes on the model type, and can help ensure that the provided model object conforms to certain data requirements.</span></span> <span data-ttu-id="fa0b4-173">Determinados valores podem ser especificados como obrigatórios ou limitados a um determinado tamanho ou intervalo numérico, etc. Se os atributos de validação forem especificados, mas o modelo não estiver de acordo com seus requisitos, a Propriedade ModelState. IsValid será false e o conjunto de regras de validação com falha estará disponível para envio ao cliente que faz a solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-173">Certain values may be specified as required, or limited to a certain length or numeric range, etc. If validation attributes are specified but the model does not conform to their requirements, the property ModelState.IsValid will be false, and the set of failing validation rules will be available to send to the client making the request.</span></span>

<span data-ttu-id="fa0b4-174">Se você estiver usando a validação de modelos, sempre verifique se o modelo é válido antes de executar comandos de alteração do estado, para garantir que o aplicativo não seja corrompido por dados inválidos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-174">If you're using model validation, you should be sure to always check that the model is valid before performing any state-altering commands, to ensure your app is not corrupted by invalid data.</span></span> <span data-ttu-id="fa0b4-175">Você pode usar um [filtro](/aspnet/core/mvc/controllers/filters) para evitar a necessidade de adicionar um código para isso em cada ação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-175">You can use a [filter](/aspnet/core/mvc/controllers/filters) to avoid the need to add code for this in every action.</span></span> <span data-ttu-id="fa0b4-176">Os filtros do ASP.NET Core MVC oferecem uma maneira de interceptar grupos de solicitações, de modo que as políticas comuns e os interesses paralelos possam ser aplicados de forma direcionada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-176">ASP.NET Core MVC filters offer a way of intercepting groups of requests, so that common policies and cross-cutting concerns can be applied on a targeted basis.</span></span> <span data-ttu-id="fa0b4-177">Os filtros podem ser aplicados a ações individuais, a controladores inteiros ou globalmente a um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-177">Filters can be applied to individual actions, whole controllers, or globally for an application.</span></span>

<span data-ttu-id="fa0b4-178">Para APIs Web, o ASP.NET Core MVC é compatível com a [_negociação de conteúdo_](/aspnet/core/mvc/models/formatting), permitindo que as solicitações especifiquem como as respostas devem ser formatadas.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-178">For web APIs, ASP.NET Core MVC supports [_content negotiation_](/aspnet/core/mvc/models/formatting), allowing requests to specify how responses should be formatted.</span></span> <span data-ttu-id="fa0b4-179">Com base nos cabeçalhos fornecidos na solicitação, as ações que retornam dados formatarão a resposta em XML, JSON ou outro formato compatível.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-179">Based on headers provided in the request, actions returning data will format the response in XML, JSON, or another supported format.</span></span> <span data-ttu-id="fa0b4-180">Esse recurso permite que a mesma API seja usada por vários clientes com diferentes requisitos de formato de dados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-180">This feature enables the same API to be used by multiple clients with different data format requirements.</span></span>

<span data-ttu-id="fa0b4-181">Os projetos de API Web devem considerar o uso do atributo `[ApiController]`, que pode ser aplicado aos controladores individuais, a uma classe base de controlador ou ao assembly inteiro.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-181">Web API projects should consider using the `[ApiController]` attribute, which can be applied to individual controllers, to a base controller class, or to the entire assembly.</span></span> <span data-ttu-id="fa0b4-182">Esse atributo adiciona a verificação de validação automática de modelos, portanto, qualquer ação com um modelo inválido retornará um BadRequest com os detalhes dos erros de validação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-182">This attribute adds automatic model validation checking and any action with an invalid model will return a BadRequest with the details of the validation errors.</span></span> <span data-ttu-id="fa0b4-183">O atributo também requer que todas as ações tenham uma rota de atributos, em vez de uma rota convencional, e retorna informações de ProblemDetails mais detalhadas em resposta aos erros.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-183">The attribute also requires all actions have an attribute route, rather than using a conventional route, and returns more detailed ProblemDetails information in response to errors.</span></span>

> ### <a name="references--mapping-requests-to-responses"></a><span data-ttu-id="fa0b4-184">Referências – Mapeando solicitações para respostas</span><span class="sxs-lookup"><span data-stu-id="fa0b4-184">References – Mapping Requests to Responses</span></span>
>
> - <span data-ttu-id="fa0b4-185">**Roteamento para ações do controlador**
 > <https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span><span class="sxs-lookup"><span data-stu-id="fa0b4-185">**Routing to Controller Actions**
<https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span></span>
> - <span data-ttu-id="fa0b4-186">**Associação de modelo**
 > <https://docs.microsoft.com/aspnet/core/mvc/models/model-binding></span><span class="sxs-lookup"><span data-stu-id="fa0b4-186">**Model Binding**
<https://docs.microsoft.com/aspnet/core/mvc/models/model-binding></span></span>
> - <span data-ttu-id="fa0b4-187">**Validação do modelo**
 > <https://docs.microsoft.com/aspnet/core/mvc/models/validation></span><span class="sxs-lookup"><span data-stu-id="fa0b4-187">**Model Validation**
<https://docs.microsoft.com/aspnet/core/mvc/models/validation></span></span>
> - <span data-ttu-id="fa0b4-188">**Filter**
 > <https://docs.microsoft.com/aspnet/core/mvc/controllers/filters></span><span class="sxs-lookup"><span data-stu-id="fa0b4-188">**Filters**
<https://docs.microsoft.com/aspnet/core/mvc/controllers/filters></span></span>
> - <span data-ttu-id="fa0b4-189">**Atributo ApiController**
 > <https://docs.microsoft.com/aspnet/core/web-api/></span><span class="sxs-lookup"><span data-stu-id="fa0b4-189">**ApiController Attribute**
<https://docs.microsoft.com/aspnet/core/web-api/></span></span>

## <a name="working-with-dependencies"></a><span data-ttu-id="fa0b4-190">Trabalhando com dependências</span><span class="sxs-lookup"><span data-stu-id="fa0b4-190">Working with dependencies</span></span>

<span data-ttu-id="fa0b4-191">O ASP.NET Core tem suporte interno para uma técnica conhecida como [injeção de dependência](/aspnet/core/fundamentals/dependency-injection), além de fazer uso dela internamente.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-191">ASP.NET Core has built-in support for and internally makes use of a technique known as [dependency injection](/aspnet/core/fundamentals/dependency-injection).</span></span> <span data-ttu-id="fa0b4-192">A injeção de dependência é uma técnica que permite um acoplamento flexível entre diferentes partes de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-192">Dependency injection is a technique that enables loose coupling between different parts of an application.</span></span> <span data-ttu-id="fa0b4-193">Um acoplamento mais flexível é desejável porque facilita o isolamento de partes do aplicativo, permitindo o teste ou a substituição.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-193">Looser coupling is desirable because it makes it easier to isolate parts of the application, allowing for testing or replacement.</span></span> <span data-ttu-id="fa0b4-194">Ele também torna menos provável que uma alteração em uma parte do aplicativo tenha um impacto inesperado em outro lugar do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-194">It also makes it less likely that a change in one part of the application will have an unexpected impact somewhere else in the application.</span></span> <span data-ttu-id="fa0b4-195">A injeção de dependência baseia-se no princípio da inversão de dependência e costuma ser fundamental para alcançar o princípio do aberto/fechado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-195">Dependency injection is based on the dependency inversion principle, and is often key to achieving the open/closed principle.</span></span> <span data-ttu-id="fa0b4-196">Ao avaliar como o aplicativo funciona com suas dependências, tenha cuidado com o code smell [adesão estática](https://deviq.com/static-cling/) e lembre-se do aforismo "[new é associação](https://ardalis.com/new-is-glue)".</span><span class="sxs-lookup"><span data-stu-id="fa0b4-196">When evaluating how your application works with its dependencies, beware of the [static cling](https://deviq.com/static-cling/) code smell, and remember the aphorism "[new is glue](https://ardalis.com/new-is-glue)."</span></span>

<span data-ttu-id="fa0b4-197">A adesão estática ocorre quando as classes fazem chamadas a métodos estáticos ou acessam propriedades estáticas que têm efeitos colaterais ou dependências na infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-197">Static cling occurs when your classes make calls to static methods, or access static properties, which have side effects or dependencies on infrastructure.</span></span> <span data-ttu-id="fa0b4-198">Por exemplo, se você tiver um método que chama um método estático, que, por sua vez, grava em um banco de dados, o método terá um acoplamento rígido com o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-198">For example, if you have a method that calls a static method, which in turn writes to a database, your method is tightly coupled to the database.</span></span> <span data-ttu-id="fa0b4-199">Qualquer coisa que interrompa essa chamada de banco de dados interromperá o método.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-199">Anything that breaks that database call will break your method.</span></span> <span data-ttu-id="fa0b4-200">O teste desses métodos é notoriamente difícil, pois testes desse tipo exigem bibliotecas fictícias comerciais para simular as chamadas estáticas ou podem ser testados somente com um banco de dados de teste em vigor.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-200">Testing such methods is notoriously difficult, since such tests either require commercial mocking libraries to mock the static calls, or can only be tested with a test database in place.</span></span> <span data-ttu-id="fa0b4-201">As chamadas estáticas que não têm nenhuma dependência na infraestrutura, especialmente aquelas que estão completamente sem estado, têm a permissão de chamar e não têm nenhum impacto sobre o acoplamento ou a capacidade de teste (além do acoplamento do código com a própria chamada estática).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-201">Static calls that don't have any dependence on infrastructure, especially those that are completely stateless, are fine to call and have no impact on coupling or testability (beyond coupling code to the static call itself).</span></span>

<span data-ttu-id="fa0b4-202">Muitos desenvolvedores entendem os riscos da adesão estática e do estado global, mas ainda acoplarão rigidamente o código com implementações específicas por meio da criação de instância direta.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-202">Many developers understand the risks of static cling and global state, but will still tightly couple their code to specific implementations through direct instantiation.</span></span> <span data-ttu-id="fa0b4-203">A frase "new é associação" deve ser um lembrete desse acoplamento e não uma reprovação geral do uso da palavra-chave `new`.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-203">"New is glue" is meant to be a reminder of this coupling, and not a general condemnation of the use of the `new` keyword.</span></span> <span data-ttu-id="fa0b4-204">Assim como ocorre com chamadas de método estático, novas instâncias de tipos que não têm nenhuma dependência externa normalmente não acoplam rigidamente o código com detalhes de implementação nem dificultam mais o teste.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-204">Just as with static method calls, new instances of types that have no external dependencies typically do not tightly couple code to implementation details or make testing more difficult.</span></span> <span data-ttu-id="fa0b4-205">No entanto, sempre que for criada uma instância para uma classe, reserve um breve momento para considerar se faz sentido embutir essa instância específica em código em um local específico ou se é um melhor design solicitar essa instância como uma dependência.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-205">But each time a class is instantiated, take just a brief moment to consider whether it makes sense to hard-code that specific instance in that particular location, or if it would be a better design to request that instance as a dependency.</span></span>

### <a name="declare-your-dependencies"></a><span data-ttu-id="fa0b4-206">Declarar as dependências</span><span class="sxs-lookup"><span data-stu-id="fa0b4-206">Declare your dependencies</span></span>

<span data-ttu-id="fa0b4-207">O ASP.NET Core foi criado com a ideia de que os métodos e as classes devem declarar suas dependências, solicitando-as como argumentos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-207">ASP.NET Core is built around having methods and classes declare their dependencies, requesting them as arguments.</span></span> <span data-ttu-id="fa0b4-208">Os aplicativos ASP.NET normalmente são definidos em uma classe Startup, que por si só é configurada para dar suporte à injeção de dependência em vários pontos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-208">ASP.NET applications are typically set up in a Startup class, which itself is configured to support dependency injection at several points.</span></span> <span data-ttu-id="fa0b4-209">Se a classe Startup tem um construtor, ela pode solicitar dependências por meio do construtor, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-209">If your Startup class has a constructor, it can request dependencies through the constructor, like so:</span></span>

```csharp
public class Startup
{
    public Startup(IHostingEnvironment env)
    {
        var builder = new ConfigurationBuilder()
            .SetBasePath(env.ContentRootPath)
            .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
            .AddJsonFile($"appsettings.{env.EnvironmentName}.json", optional: true);
    }
}
```

<span data-ttu-id="fa0b4-210">A classe Startup é interessante, pois não há nenhum requisito de tipo explícito para ela.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-210">The Startup class is interesting in that there are no explicit type requirements for it.</span></span> <span data-ttu-id="fa0b4-211">Ela não herda de uma classe base Startup especial nem implementa nenhuma interface específica.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-211">It doesn't inherit from a special Startup base class, nor does it implement any particular interface.</span></span> <span data-ttu-id="fa0b4-212">Você pode atribuir um construtor a ela, ou não, e pode especificar quantos parâmetros no construtor desejar.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-212">You can give it a constructor, or not, and you can specify as many parameters on the constructor as you want.</span></span> <span data-ttu-id="fa0b4-213">Quando o host da Web que você configurou para o aplicativo for iniciado, ele chamará a classe Startup que você o instruiu a usar e usará a injeção de dependência para popular todas as dependências exigidas pela classe Startup.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-213">When the web host you've configured for your application starts, it will call the Startup class you've told it to use, and will use dependency injection to populate any dependencies the Startup class requires.</span></span> <span data-ttu-id="fa0b4-214">É claro que, se você solicitar parâmetros que não estiverem configurados no contêiner de serviços usado pelo ASP.NET Core, receberá uma exceção, mas desde que você continue usando as dependências reconhecidas pelo contêiner, poderá solicitar o que desejar.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-214">Of course, if you request parameters that aren't configured in the services container used by ASP.NET Core, you'll get an exception, but as long as you stick to dependencies the container knows about, you can request anything you want.</span></span>

<span data-ttu-id="fa0b4-215">A injeção de dependência baseia-se nos aplicativos ASP.NET Core desde o início, quando a instância de Startup é criada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-215">Dependency injection is built into your ASP.NET Core apps right from the start, when you create the Startup instance.</span></span> <span data-ttu-id="fa0b4-216">Ela não para na classe Startup.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-216">It doesn't stop there for the Startup class.</span></span> <span data-ttu-id="fa0b4-217">Você também pode solicitar dependências no método Configure:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-217">You can also request dependencies in the Configure method:</span></span>

```csharp
public void Configure(IApplicationBuilder app,
    IHostingEnvironment env,
    ILoggerFactory loggerFactory)
{

}
```

<span data-ttu-id="fa0b4-218">O método ConfigureServices é a exceção a esse comportamento; ele precisa ter apenas um parâmetro do tipo IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-218">The ConfigureServices method is the exception to this behavior; it must take just one parameter of type IServiceCollection.</span></span> <span data-ttu-id="fa0b4-219">Ele realmente não precisa dar suporte à injeção de dependência, pois, por um lado, é responsável por adicionar objetos ao contêiner de serviços e, por outro, tem acesso a todos os serviços atualmente configurados por meio do parâmetro IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-219">It doesn't really need to support dependency injection, since on the one hand it is responsible for adding objects to the services container, and on the other it has access to all currently configured services via the IServiceCollection parameter.</span></span> <span data-ttu-id="fa0b4-220">Portanto, você pode trabalhar com as dependências definidas na coleção de serviços do ASP.NET Core em todas as partes da classe Startup, solicitando o serviço necessário como um parâmetro ou trabalhando com a IServiceCollection em ConfigureServices.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-220">Thus, you can work with dependencies defined in the ASP.NET Core services collection in every part of the Startup class, either by requesting the needed service as a parameter or by working with the IServiceCollection in ConfigureServices.</span></span>

> [!NOTE]
> <span data-ttu-id="fa0b4-221">Se você precisar garantir que determinados serviços estejam disponíveis para sua classe de inicialização, você pode configurá-los usando um IWebHostBuilder e seu método configuraservices dentro da chamada CreateDefaultBuilder.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-221">If you need to ensure certain services are available to your Startup class, you can configure them using an IWebHostBuilder and its ConfigureServices method inside the CreateDefaultBuilder call.</span></span>

<span data-ttu-id="fa0b4-222">A classe Startup é um modelo de como você deve estruturar outras partes do aplicativo ASP.NET Core, de Controladores, Middleware, Filtros a seus próprios Serviços.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-222">The Startup class is a model for how you should structure other parts of your ASP.NET Core application, from Controllers to Middleware to Filters to your own Services.</span></span> <span data-ttu-id="fa0b4-223">Em cada caso, você deve seguir o [Princípio das Dependências Explícitas](https://deviq.com/explicit-dependencies-principle/), solicitando as dependências em vez de criá-las diretamente e aproveitando a injeção de dependência em todo o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-223">In each case, you should follow the [Explicit Dependencies Principle](https://deviq.com/explicit-dependencies-principle/), requesting your dependencies rather than directly creating them, and leveraging dependency injection throughout your application.</span></span> <span data-ttu-id="fa0b4-224">Tenha cuidado com o local em que você cria instâncias de implementações diretamente e como você as cria, especialmente serviços e objetos que trabalham com a infraestrutura ou que têm efeitos colaterais.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-224">Be careful of where and how you directly instantiate implementations, especially services and objects that work with infrastructure or have side effects.</span></span> <span data-ttu-id="fa0b4-225">Prefira trabalhar com as abstrações definidas no núcleo do aplicativo e passadas como argumentos para referências embutidas em código a tipos de implementação específicos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-225">Prefer working with abstractions defined in your application core and passed in as arguments to hardcoding references to specific implementation types.</span></span>

## <a name="structuring-the-application"></a><span data-ttu-id="fa0b4-226">Estruturando o aplicativo</span><span class="sxs-lookup"><span data-stu-id="fa0b4-226">Structuring the application</span></span>

<span data-ttu-id="fa0b4-227">Normalmente, os aplicativos monolíticos têm um único ponto de entrada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-227">Monolithic applications typically have a single entry point.</span></span> <span data-ttu-id="fa0b4-228">No caso de um aplicativo Web ASP.NET Core, o ponto de entrada será o projeto Web ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-228">In the case of an ASP.NET Core web application, the entry point will be the ASP.NET Core web project.</span></span> <span data-ttu-id="fa0b4-229">No entanto, isso não significa que a solução precise consistir em apenas um único projeto.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-229">However, that doesn't mean the solution should consist of just a single project.</span></span> <span data-ttu-id="fa0b4-230">É útil dividir o aplicativo em camadas diferentes para seguir a separação de interesses.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-230">It's useful to break up the application into different layers in order to follow separation of concerns.</span></span> <span data-ttu-id="fa0b4-231">Depois de dividido em camadas, é útil ir além de pastas para projetos separados, que podem ajudar a obter o melhor encapsulamento.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-231">Once broken up into layers, it's helpful to go beyond folders to separate projects, which can help achieve better encapsulation.</span></span> <span data-ttu-id="fa0b4-232">A melhor abordagem para atingir essas metas com um aplicativo ASP.NET Core é uma variação da Arquitetura Limpa abordada no capítulo 5.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-232">The best approach to achieve these goals with an ASP.NET Core application is a variation of the Clean Architecture discussed in chapter 5.</span></span> <span data-ttu-id="fa0b4-233">Seguindo essa abordagem, a solução do aplicativo incluirá bibliotecas separadas para a interface do usuário, a infraestrutura e a ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-233">Following this approach, the application's solution will comprise separate libraries for the UI, Infrastructure, and ApplicationCore.</span></span>

<span data-ttu-id="fa0b4-234">Além desses projetos, projetos de teste separados são incluídos também (o teste é abordado no capítulo 9).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-234">In addition to these projects, separate test projects are included as well (Testing is discussed in Chapter 9).</span></span>

<span data-ttu-id="fa0b4-235">O modelo de objeto do aplicativo e as interfaces devem ser colocados no projeto de ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-235">The application's object model and interfaces should be placed in the ApplicationCore project.</span></span> <span data-ttu-id="fa0b4-236">Esse projeto terá o menor número possível de dependências e os outros projetos na solução o referenciarão.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-236">This project will have as few dependencies as possible, and the other projects in the solution will reference it.</span></span> <span data-ttu-id="fa0b4-237">As entidades de negócios que precisam ser persistidas são definidas no projeto de ApplicationCore, assim como os serviços que não dependem diretamente da infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-237">Business entities that need to be persisted are defined in the ApplicationCore project, as are services that do not directly depend on infrastructure.</span></span>

<span data-ttu-id="fa0b4-238">Os detalhes de implementação, como a persistência é executada ou como as notificações podem ser enviadas a um usuário, são mantidos no projeto de Infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-238">Implementation details, such as how persistence is performed or how notifications might be sent to a user, are kept in the Infrastructure project.</span></span> <span data-ttu-id="fa0b4-239">Esse projeto referenciará pacotes específicos à implementação, como o Entity Framework Core, mas não deve expor os detalhes sobre essas implementações fora do projeto.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-239">This project will reference implementation-specific packages such as Entity Framework Core, but should not expose details about these implementations outside of the project.</span></span> <span data-ttu-id="fa0b4-240">Os repositórios e serviços de infraestrutura devem implementar interfaces que são definidas no projeto de ApplicationCore e suas implementações de persistência são responsáveis por recuperar e armazenar entidades definidas no ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-240">Infrastructure services and repositories should implement interfaces that are defined in the ApplicationCore project, and its persistence implementations are responsible for retrieving and storing entities defined in ApplicationCore.</span></span>

<span data-ttu-id="fa0b4-241">O projeto de interface do usuário do ASP.NET Core é responsável pelas preocupações no nível da interface do usuário, mas não deve incluir detalhes da lógica de negócios ou infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-241">The ASP.NET Core UI project is responsible for any UI level concerns, but should not include business logic or infrastructure details.</span></span> <span data-ttu-id="fa0b4-242">Na verdade, o ideal é que ele não tenha nem mesmo uma dependência no projeto de Infraestrutura, o que ajudará a garantir que nenhuma dependência entre os dois projetos seja introduzida acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-242">In fact, ideally it shouldn't even have a dependency on the Infrastructure project, which will help ensure no dependency between the two projects is introduced accidentally.</span></span> <span data-ttu-id="fa0b4-243">Isso pode ser feito usando um contêiner de DI de terceiros, como o Autofac, que permite que você defina regras de DI em classes de Módulo em cada projeto.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-243">This can be achieved using a third-party DI container like Autofac, which allows you to define DI rules in Module classes in each project.</span></span>

<span data-ttu-id="fa0b4-244">Outra abordagem para desacoplar o aplicativo dos detalhes de implementação é fazer com que o aplicativo chame microsserviços, talvez implantados em contêineres individuais do Docker.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-244">Another approach to decoupling the application from implementation details is to have the application call microservices, perhaps deployed in individual Docker containers.</span></span> <span data-ttu-id="fa0b4-245">Isso fornece uma separação de interesses e um desacoplamento ainda maiores do que a utilização da DI entre dois projetos, mas traz uma complexidade adicional.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-245">This provides even greater separation of concerns and decoupling than leveraging DI between two projects, but has additional complexity.</span></span>

### <a name="feature-organization"></a><span data-ttu-id="fa0b4-246">Organização do recurso</span><span class="sxs-lookup"><span data-stu-id="fa0b4-246">Feature organization</span></span>

<span data-ttu-id="fa0b4-247">Por padrão, os aplicativos ASP.NET Core organizam sua estrutura de pastas para incluir Controladores e Exibições e, frequentemente, ViewModels.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-247">By default, ASP.NET Core applications organize their folder structure to include Controllers and Views, and frequently ViewModels.</span></span> <span data-ttu-id="fa0b4-248">Em geral, o código do lado do cliente para dar suporte a essas estruturas do lado do servidor é armazenado separadamente na pasta wwwroot.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-248">Client-side code to support these server-side structures is typically stored separately in the wwwroot folder.</span></span> <span data-ttu-id="fa0b4-249">No entanto, os aplicativos grandes podem enfrentar problemas com essa organização, pois o trabalho em um recurso específico geralmente exige o salto entre essas pastas.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-249">However, large applications may encounter problems with this organization, since working on any given feature often requires jumping between these folders.</span></span> <span data-ttu-id="fa0b4-250">Isso fica cada vez mais difícil à medida que aumenta o número de arquivos e subpastas em cada pasta, resultando em uma grande quantidade de rolagem pelo Gerenciador de Soluções.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-250">This gets more and more difficult as the number of files and subfolders in each folder grows, resulting in a great deal of scrolling through Solution Explorer.</span></span> <span data-ttu-id="fa0b4-251">Uma solução para esse problema é organizar o código do aplicativo por _recurso_, em vez de por tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-251">One solution to this problem is to organize application code by _feature_ instead of by file type.</span></span> <span data-ttu-id="fa0b4-252">Esse estilo organizacional é normalmente chamado de pastas de recursos ou [fatias de recursos](https://docs.microsoft.com/archive/msdn-magazine/2016/september/asp-net-core-feature-slices-for-asp-net-core-mvc) (consulte também: [fatias verticais](https://deviq.com/vertical-slices/)).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-252">This organizational style is typically referred to as feature folders or [feature slices](https://docs.microsoft.com/archive/msdn-magazine/2016/september/asp-net-core-feature-slices-for-asp-net-core-mvc) (see also: [Vertical Slices](https://deviq.com/vertical-slices/)).</span></span>

<span data-ttu-id="fa0b4-253">O ASP.NET Core MVC é compatível com Áreas para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-253">ASP.NET Core MVC supports Areas for this purpose.</span></span> <span data-ttu-id="fa0b4-254">Usando áreas, você pode criar conjuntos separados de pastas de Controladores e Exibições (bem como os modelos associados) em cada pasta de Área.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-254">Using areas, you can create separate sets of Controllers and Views folders (as well as any associated models) in each Area folder.</span></span> <span data-ttu-id="fa0b4-255">A Figura 7-1 mostra uma estrutura de pastas de exemplo, usando Áreas.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-255">Figure 7-1 shows an example folder structure, using Areas.</span></span>

![Organização da área de exemplo](./media/image7-1.png)

<span data-ttu-id="fa0b4-257">**Figura 7-1**.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-257">**Figure 7-1**.</span></span> <span data-ttu-id="fa0b4-258">Organização da área de exemplo</span><span class="sxs-lookup"><span data-stu-id="fa0b4-258">Sample Area Organization</span></span>

<span data-ttu-id="fa0b4-259">Ao usar Áreas, você precisa usar atributos para decorar os controladores com o nome da área à qual eles pertencem:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-259">When using Areas, you must use attributes to decorate your controllers with the name of the area to which they belong:</span></span>

```csharp
[Area("Catalog")]
public class HomeController
{}
```

<span data-ttu-id="fa0b4-260">Você também precisa adicionar o suporte para área às rotas:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-260">You also need to add area support to your routes:</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    endpoints.MapControllerRoute(name: "areaRoute", pattern: "{area:exists}/{controller=Home}/{action=Index}/{id?}");
    endpoints.MapControllerRoute(name: "default", pattern: "{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="fa0b4-261">Além do suporte interno para Áreas, você também pode usar sua própria estrutura de pastas e convenções no lugar de atributos e rotas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-261">In addition to the built-in support for Areas, you can also use your own folder structure, and conventions in place of attributes and custom routes.</span></span> <span data-ttu-id="fa0b4-262">Isso permite que você tenha pastas de recurso que não incluíam pastas separadas para Exibições, Controladores, etc., mantendo a hierarquia mais simples e facilitando a visualização de todos os arquivos relacionados em um único local para cada recurso.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-262">This would allow you to have feature folders that didn't include separate folders for Views, Controllers, etc., keeping the hierarchy flatter and making it easier to see all related files in a single place for each feature.</span></span>

<span data-ttu-id="fa0b4-263">O ASP.NET Core usa tipos de convenção internos para controlar seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-263">ASP.NET Core uses built-in convention types to control its behavior.</span></span> <span data-ttu-id="fa0b4-264">Você pode modificar ou substituir essas convenções.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-264">You can modify or replace these conventions.</span></span> <span data-ttu-id="fa0b4-265">Por exemplo, você pode criar uma convenção que receberá automaticamente o nome de recurso para determinado controlador com base em seu namespace (que geralmente se correlaciona com a pasta na qual o controlador está localizado):</span><span class="sxs-lookup"><span data-stu-id="fa0b4-265">For example, you can create a convention that will automatically get the feature name for a given controller based on its namespace (which typically correlates to the folder in which the controller is located):</span></span>

```csharp
public class FeatureConvention : IControllerModelConvention
{
    public void Apply(ControllerModel controller)
    {
        controller.Properties.Add("feature",
        GetFeatureName(controller.ControllerType));
    }

    private string GetFeatureName(TypeInfo controllerType)
    {
        string[] tokens = controllerType.FullName.Split('.');
        if (!tokens.Any(t => t == "Features")) return "";
        string featureName = tokens
        .SkipWhile(t => !t.Equals("features",
        StringComparison.CurrentCultureIgnoreCase))
        .Skip(1)
        .Take(1)
        .FirstOrDefault();
        return featureName;
    }
}
```

<span data-ttu-id="fa0b4-266">Em seguida, especifique essa convenção como uma opção quando você adicionar suporte para o MVC ao seu aplicativo em ConfigureServices:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-266">You then specify this convention as an option when you add support for MVC to your application in ConfigureServices:</span></span>

```csharp
services.AddMvc(o => o.Conventions.Add(new FeatureConvention()));
```

<span data-ttu-id="fa0b4-267">O ASP.NET Core MVC também usa uma convenção para localizar exibições.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-267">ASP.NET Core MVC also uses a convention to locate views.</span></span> <span data-ttu-id="fa0b4-268">Você pode substituí-la por uma convenção personalizada, de modo que as exibições estejam localizadas nas pastas de recurso (usando o nome de recurso fornecido pela FeatureConvention, acima).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-268">You can override it with a custom convention so that views will be located in your feature folders (using the feature name provided by the FeatureConvention, above).</span></span> <span data-ttu-id="fa0b4-269">Você pode aprender mais sobre essa abordagem e baixar um exemplo funcional do artigo da MSDN Magazine, [fatias de recursos para ASP.NET Core MVC](https://docs.microsoft.com/archive/msdn-magazine/2016/september/asp-net-core-feature-slices-for-asp-net-core-mvc).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-269">You can learn more about this approach and download a working sample from the MSDN Magazine article, [Feature Slices for ASP.NET Core MVC](https://docs.microsoft.com/archive/msdn-magazine/2016/september/asp-net-core-feature-slices-for-asp-net-core-mvc).</span></span>

### <a name="cross-cutting-concerns"></a><span data-ttu-id="fa0b4-270">Interesses paralelos</span><span class="sxs-lookup"><span data-stu-id="fa0b4-270">Cross-cutting concerns</span></span>

<span data-ttu-id="fa0b4-271">Conforme os aplicativos crescem, fica cada vez mais importante excluir interesses paralelos para eliminar a duplicação e manter a consistência.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-271">As applications grow, it becomes increasingly important to factor out cross-cutting concerns to eliminate duplication and maintain consistency.</span></span> <span data-ttu-id="fa0b4-272">Alguns exemplos de interesses paralelos em aplicativos ASP.NET Core são autenticação, regras de validação de modelos, cache de saída e tratamento de erro, embora haja muitos outros.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-272">Some examples of cross-cutting concerns in ASP.NET Core applications are authentication, model validation rules, output caching, and error handling, though there are many others.</span></span> <span data-ttu-id="fa0b4-273">Os [filtros](/aspnet/core/mvc/controllers/filters) do ASP.NET Core MVC permitem executar o código antes ou depois de determinadas etapas do pipeline de processamento de solicitações.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-273">ASP.NET Core MVC [filters](/aspnet/core/mvc/controllers/filters) allow you to run code before or after certain steps in the request processing pipeline.</span></span> <span data-ttu-id="fa0b4-274">Por exemplo, um filtro pode ser executado antes e após o model binding, antes e após uma ação ou antes e após o resultado de uma ação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-274">For instance, a filter can run before and after model binding, before and after an action, or before and after an action's result.</span></span> <span data-ttu-id="fa0b4-275">Você também pode usar um filtro de autorização para controlar o acesso ao restante do pipeline.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-275">You can also use an authorization filter to control access to the rest of the pipeline.</span></span> <span data-ttu-id="fa0b4-276">A Figura 7-2 mostra como solicitar fluxos de execução por meio de filtros, caso eles estejam configurados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-276">Figures 7-2 shows how request execution flows through filters, if configured.</span></span>

![A solicitação é processada por meio de Filtros de autorização, Filtros de recurso, Model binding, Filtros de ação, Execução de ação e Conversão do resultado de ação, Filtros de exceção, Filtros de resultado e Execução de resultado.](./media/image7-2.png)

<span data-ttu-id="fa0b4-279">**Figura 7-2**.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-279">**Figure 7-2**.</span></span> <span data-ttu-id="fa0b4-280">Solicite a execução por meio de filtros e do pipeline de solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-280">Request execution through filters and request pipeline.</span></span>

<span data-ttu-id="fa0b4-281">Normalmente, os filtros são implementados como atributos, de modo que você possa aplicá-los aos controladores ou às ações (ou até mesmo globalmente).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-281">Filters are usually implemented as attributes, so you can apply them to controllers or actions (or even globally).</span></span> <span data-ttu-id="fa0b4-282">Quando adicionados dessa maneira, os filtros especificados no nível da ação substituem ou se baseiam nos filtros especificados no nível do controlador, que, por sua vez, substituem os filtros globais.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-282">When added in this fashion, filters specified at the action level override or build upon filters specified at the controller level, which themselves override global filters.</span></span> <span data-ttu-id="fa0b4-283">Por exemplo, o atributo \[Route\] pode ser usado para criar rotas entre controladores e ações.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-283">For example, the \[Route\] attribute can be used to build up routes between controllers and actions.</span></span> <span data-ttu-id="fa0b4-284">Da mesma forma, a autorização pode ser configurada no nível do controlador e, em seguida, substituída por ações individuais, como mostra o seguinte exemplo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-284">Likewise, authorization can be configured at the controller level, and then overridden by individual actions, as the following sample demonstrates:</span></span>

```csharp
[Authorize]
public class AccountController : Controller

{
    [AllowAnonymous] // overrides the Authorize attribute
    public async Task<IActionResult> Login() {}
    public async Task<IActionResult> ForgotPassword() {}
}
```

<span data-ttu-id="fa0b4-285">O primeiro método, Login, usa o filtro AllowAnonymous (atributo) para substituir o filtro Authorize definido no nível do controlador.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-285">The first method, Login, uses the AllowAnonymous filter (attribute) to override the Authorize filter set at the controller level.</span></span> <span data-ttu-id="fa0b4-286">A ação ForgotPassword (e qualquer outra ação na classe que não tem um atributo AllowAnonymous) exigirá uma solicitação autenticada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-286">The ForgotPassword action (and any other action in the class that doesn't have an AllowAnonymous attribute) will require an authenticated request.</span></span>

<span data-ttu-id="fa0b4-287">Os filtros podem ser usados para eliminar a duplicação na forma de tratamento de erro comum de políticas para APIs.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-287">Filters can be used to eliminate duplication in the form of common error handling policies for APIs.</span></span> <span data-ttu-id="fa0b4-288">Por exemplo, uma política de API típica é retornar uma resposta NotFound para solicitações que referenciam chaves que não existem e uma resposta BadRequest se há falha na validação de modelos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-288">For example, a typical API policy is to return a NotFound response to requests referencing keys that do not exist, and a BadRequest response if model validation fails.</span></span> <span data-ttu-id="fa0b4-289">O seguinte exemplo demonstra essas duas políticas em ação:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-289">The following example demonstrates these two policies in action:</span></span>

```csharp
[HttpPut("{id}")]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    if ((await _authorRepository.ListAsync()).All(a => a.Id != id))
    {
        return NotFound(id);
    }
    if (!ModelState.IsValid)
    {
        return BadRequest(ModelState);
    }
    author.Id = id;
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="fa0b4-290">Não permita que os métodos de ação fiquem desorganizados com um código condicional como este.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-290">Don't allow your action methods to become cluttered with conditional code like this.</span></span> <span data-ttu-id="fa0b4-291">Em vez disso, coloque as políticas em filtros que podem ser aplicados conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-291">Instead, pull the policies into filters that can be applied on an as-needed basis.</span></span> <span data-ttu-id="fa0b4-292">Neste exemplo, a verificação de validação do modelo, que deve ocorrer sempre que um comando é enviado para a API, pode ser substituído pelo seguinte atributo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-292">In this example, the model validation check, which should occur anytime a command is sent to the API, can be replaced by the following attribute:</span></span>

```csharp
public class ValidateModelAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext context)
    {
        if (!context.ModelState.IsValid)
        {
            context.Result = new BadRequestObjectResult(context.ModelState);
        }
    }
}
```

<span data-ttu-id="fa0b4-293">É possível adicionar o `ValidateModelAttribute` ao projeto como uma dependência do NuGet incluindo o pacote [Ardalis.ValidateModel](https://www.nuget.org/packages/Ardalis.ValidateModel).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-293">You can add the `ValidateModelAttribute` to your project as a NuGet dependency by including the [Ardalis.ValidateModel](https://www.nuget.org/packages/Ardalis.ValidateModel) package.</span></span> <span data-ttu-id="fa0b4-294">Para as APIs, você pode usar o atributo `ApiController` para impor esse comportamento sem precisar usar um filtro `ValidateModel` separado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-294">For APIs, you can use the `ApiController` attribute to enforce this behavior without the need for a separate `ValidateModel` filter.</span></span>

<span data-ttu-id="fa0b4-295">Da mesma forma, um filtro pode ser usado para verificar se um registro existe e retornar 404 antes que a ação seja executada, eliminando a necessidade de executar essas verificações na ação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-295">Likewise, a filter can be used to check if a record exists and return a 404 before the action is executed, eliminating the need to perform these checks in the action.</span></span> <span data-ttu-id="fa0b4-296">Depois de retirar as convenções comuns e organizar sua solução para separar a lógica de negócios e o código de infraestrutura da interface do usuário, os métodos de ação do MVC devem ser extremamente dinâmicos:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-296">Once you've pulled out common conventions and organized your solution to separate infrastructure code and business logic from your UI, your MVC action methods should be extremely thin:</span></span>

```csharp
[HttpPut("{id}")]
[ValidateAuthorExists]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="fa0b4-297">Você pode ler mais sobre como implementar filtros e baixar um exemplo funcional do artigo da MSDN Magazine, [ASP.NET Core os filtros do MVC do mundo real](https://docs.microsoft.com/archive/msdn-magazine/2016/august/asp-net-core-real-world-asp-net-core-mvc-filters).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-297">You can read more about implementing filters and download a working sample from the MSDN Magazine article, [Real-World ASP.NET Core MVC Filters](https://docs.microsoft.com/archive/msdn-magazine/2016/august/asp-net-core-real-world-asp-net-core-mvc-filters).</span></span>

> ### <a name="references--structuring-applications"></a><span data-ttu-id="fa0b4-298">Referências – estruturando aplicativos</span><span class="sxs-lookup"><span data-stu-id="fa0b4-298">References – Structuring applications</span></span>
>
> - <span data-ttu-id="fa0b4-299">**Áreas**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-299">**Areas**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/mvc/controllers/areas>
> - <span data-ttu-id="fa0b4-300">**MSDN Magazine – fatias de recurso do ASP.NET Core MVC**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-300">**MSDN Magazine – Feature Slices for ASP.NET Core MVC**</span></span>  
>   <https://docs.microsoft.com/archive/msdn-magazine/2016/september/asp-net-core-feature-slices-for-asp-net-core-mvc>
> - <span data-ttu-id="fa0b4-301">**Filtros**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-301">**Filters**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/mvc/controllers/filters>
> - <span data-ttu-id="fa0b4-302">**MSDN Magazine – filtros reais ASP.NET Core MVC**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-302">**MSDN Magazine – Real World ASP.NET Core MVC Filters**</span></span>  
>   <https://docs.microsoft.com/archive/msdn-magazine/2016/august/asp-net-core-real-world-asp-net-core-mvc-filters>

## <a name="security"></a><span data-ttu-id="fa0b4-303">Segurança</span><span class="sxs-lookup"><span data-stu-id="fa0b4-303">Security</span></span>

<span data-ttu-id="fa0b4-304">A proteção de aplicativos Web é um tópico extenso, com muitas considerações.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-304">Securing web applications is a large topic, with many considerations.</span></span> <span data-ttu-id="fa0b4-305">Em seu nível mais básico, a segurança envolve a garantia de que você sabe de quem determinada solicitação é proveniente e, em seguida, a garantia de que essa solicitação tem acesso somente aos recursos que deveria.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-305">At its most basic level, security involves ensuring you know who a given request is coming from, and then ensuring that the request only has access to resources it should.</span></span> <span data-ttu-id="fa0b4-306">Autenticação é o processo de comparar as credenciais fornecidas com uma solicitação com aquelas em um armazenamento de dados confiável, para verificar se a solicitação deve ser tratada como proveniente de uma entidade conhecida.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-306">Authentication is the process of comparing credentials provided with a request to those in a trusted data store, to see if the request should be treated as coming from a known entity.</span></span> <span data-ttu-id="fa0b4-307">Autorização é o processo de restringir o acesso a determinados recursos com base na identidade do usuário.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-307">Authorization is the process of restricting access to certain resources based on user identity.</span></span> <span data-ttu-id="fa0b4-308">Uma terceira preocupação de segurança é proteger as solicitações contra interceptação por terceiros, para o qual você deve, pelo menos, [garantir que o SSL é usado pelo aplicativo](/aspnet/core/security/enforcing-ssl).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-308">A third security concern is protecting requests from eavesdropping by third parties, for which you should at least [ensure that SSL is used by your application](/aspnet/core/security/enforcing-ssl).</span></span>

### <a name="authentication"></a><span data-ttu-id="fa0b4-309">Autenticação</span><span class="sxs-lookup"><span data-stu-id="fa0b4-309">Authentication</span></span>

<span data-ttu-id="fa0b4-310">O ASP.NET Core Identity é um sistema de associação que pode ser usado para dar suporte à funcionalidade de logon para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-310">ASP.NET Core Identity is a membership system you can use to support login functionality for your application.</span></span> <span data-ttu-id="fa0b4-311">Ele tem suporte para contas de usuário local, bem como suporte para provedores de logon externo de provedores como a conta da Microsoft, Twitter, Facebook, Google e muito mais.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-311">It has support for local user accounts as well as external login provider support from providers like Microsoft Account, Twitter, Facebook, Google, and more.</span></span> <span data-ttu-id="fa0b4-312">Além do ASP.NET Core Identity, o aplicativo pode usar a autenticação do Windows ou um provedor de identidade de terceiros, como o [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-312">In addition to ASP.NET Core Identity, your application can use windows authentication, or a third-party identity provider like [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span></span>

<span data-ttu-id="fa0b4-313">O ASP.NET Core Identity é incluído em novos modelos de projeto se a opção Contas de Usuário Individuais é marcada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-313">ASP.NET Core Identity is included in new project templates if the Individual User Accounts option is selected.</span></span> <span data-ttu-id="fa0b4-314">Esse modelo inclui suporte para registro, logon, logons externos, senhas esquecidas e funcionalidade adicional.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-314">This template includes support for registration, login, external logins, forgotten passwords, and additional functionality.</span></span>

![Selecionar contas de usuário individuais para ter a identidade pré-configurada](./media/image7-3.png)

<span data-ttu-id="fa0b4-316">**Figura 7-3**.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-316">**Figure 7-3**.</span></span> <span data-ttu-id="fa0b4-317">Selecione contas de usuário individuais para que a identidade seja pré-configurada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-317">Select Individual User Accounts to have Identity preconfigured.</span></span>

<span data-ttu-id="fa0b4-318">O suporte para identidade é configurado em Startup, em ConfigureServices e Configure:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-318">Identity support is configured in Startup, both in ConfigureServices and Configure:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    // Add framework services.
    services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));
    services.AddIdentity<ApplicationUser, IdentityRole>()
    .AddEntityFrameworkStores<ApplicationDbContext>()
    .AddDefaultTokenProviders();
    services.AddMvc();
}

public void Configure(IApplicationBuilder app)
{
    app.UseStaticFiles();
    app.UseIdentity();
    app.UseEndpoints(endpoints =>
    {
        endpoints.MapControllerRoute(name: "default", pattern: "{controller=Home}/{action=Index}/{id?}");
    });
}
```

<span data-ttu-id="fa0b4-319">É importante que UseIdentity apareça antes de UseMvc no método Configure.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-319">It's important that UseIdentity appear before UseMvc in the Configure method.</span></span> <span data-ttu-id="fa0b4-320">Ao configurar o Identity em ConfigureServices, você observará uma chamada a AddDefaultTokenProviders.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-320">When configuring Identity in ConfigureServices, you'll notice a call to AddDefaultTokenProviders.</span></span> <span data-ttu-id="fa0b4-321">Isso não tem nada a ver com tokens que podem ser usados para proteger comunicações da Web, mas refere-se a provedores que criam prompts que podem ser enviados aos usuários por SMS ou email para que eles confirmem sua identidade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-321">This has nothing to do with tokens that may be used to secure web communications, but instead refers to providers that create prompts that can be sent to users via SMS or email in order for them to confirm their identity.</span></span>

<span data-ttu-id="fa0b4-322">Saiba mais sobre como [configurar a autenticação de dois fatores](/aspnet/core/security/authentication/2fa) e [habilitar provedores de logon externo](/aspnet/core/security/authentication/social/) na documentação oficial do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-322">You can learn more about [configuring two-factor authentication](/aspnet/core/security/authentication/2fa) and [enabling external login providers](/aspnet/core/security/authentication/social/) from the official ASP.NET Core docs.</span></span>

### <a name="authorization"></a><span data-ttu-id="fa0b4-323">Autorização</span><span class="sxs-lookup"><span data-stu-id="fa0b4-323">Authorization</span></span>

<span data-ttu-id="fa0b4-324">A forma mais simples de autorização envolve a restrição do acesso a usuários anônimos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-324">The simplest form of authorization involves restricting access to anonymous users.</span></span> <span data-ttu-id="fa0b4-325">Para fazer isso, basta aplicar o atributo \[Authorize\] a determinados controladores ou ações.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-325">This can be achieved by simply applying the \[Authorize\] attribute to certain controllers or actions.</span></span> <span data-ttu-id="fa0b4-326">Se funções estiverem sendo usadas, o atributo poderá ser estendido ainda mais para restringir o acesso a usuários que pertencem a determinadas funções, conforme mostrado:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-326">If roles are being used, the attribute can be further extended to restrict access to users who belong to certain roles, as shown:</span></span>

```csharp
[Authorize(Roles = "HRManager,Finance")]
public class SalaryController : Controller
{

}
```

<span data-ttu-id="fa0b4-327">Nesse caso, os usuários que pertencem as funções HRManager ou Finance (ou ambas) terão acesso ao SalaryController.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-327">In this case, users belonging to either the HRManager or Finance roles (or both) would have access to the SalaryController.</span></span> <span data-ttu-id="fa0b4-328">Para exigir que um usuário pertença a várias funções (não apenas a uma de várias), aplique o atributo várias vezes, especificando uma função obrigatória por vez.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-328">To require that a user belong to multiple roles (not just one of several), you can apply the attribute multiple times, specifying a required role each time.</span></span>

<span data-ttu-id="fa0b4-329">A especificação de determinados conjuntos de funções como cadeias de caracteres em muitos controladores e ações diferentes pode levar à repetição indesejável.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-329">Specifying certain sets of roles as strings in many different controllers and actions can lead to undesirable repetition.</span></span> <span data-ttu-id="fa0b4-330">Você pode configurar políticas de autorização, que encapsulam regras de autorização e, em seguida, especificar a política, em vez de funções individuais ao aplicar o atributo \[Authorize\]:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-330">You can configure authorization policies, which encapsulate authorization rules, and then specify the policy instead of individual roles when applying the \[Authorize\] attribute:</span></span>

```csharp
[Authorize(Policy = "CanViewPrivateReport")]
public IActionResult ExecutiveSalaryReport()
{
    return View();
}
```

<span data-ttu-id="fa0b4-331">Usando políticas dessa forma, você pode separar os tipos de ações que estão sendo restringidos das funções ou regras específicas que se aplicam a eles.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-331">Using policies in this way, you can separate the kinds of actions being restricted from the specific roles or rules that apply to it.</span></span> <span data-ttu-id="fa0b4-332">Posteriormente, se você criar uma nova função que precisa ter acesso a determinados recursos, basta atualizar uma política, em vez de atualizar cada lista de funções em cada atributo \[Authorize\].</span><span class="sxs-lookup"><span data-stu-id="fa0b4-332">Later, if you create a new role that needs to have access to certain resources, you can just update a policy, rather than updating every list of roles on every \[Authorize\] attribute.</span></span>

#### <a name="claims"></a><span data-ttu-id="fa0b4-333">Declarações</span><span class="sxs-lookup"><span data-stu-id="fa0b4-333">Claims</span></span>

<span data-ttu-id="fa0b4-334">Declarações são pares de nome e valor que representam as propriedades de um usuário autenticado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-334">Claims are name value pairs that represent properties of an authenticated user.</span></span> <span data-ttu-id="fa0b4-335">Por exemplo, você pode armazenar o número de funcionário dos usuários como uma declaração.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-335">For example, you might store users' employee number as a claim.</span></span> <span data-ttu-id="fa0b4-336">Em seguida, as declarações podem ser usadas como parte de políticas de autorização.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-336">Claims can then be used as part of authorization policies.</span></span> <span data-ttu-id="fa0b4-337">Você pode criar uma política chamada "EmployeeOnly" que exige a existência de uma declaração chamada "EmployeeNumber", conforme mostrado neste exemplo:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-337">You could create a policy called "EmployeeOnly" that requires the existence of a claim called "EmployeeNumber", as shown in this example:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc();
    services.AddAuthorization(options =>
    {
        options.AddPolicy("EmployeeOnly", policy => policy.RequireClaim("EmployeeNumber"));
    });
}
```

<span data-ttu-id="fa0b4-338">Essa política pode então ser usada com o atributo \[Authorize\] para proteger qualquer controlador e/ou ação, conforme descrito acima.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-338">This policy could then be used with the \[Authorize\] attribute to protect any controller and/or action, as described above.</span></span>

#### <a name="securing-web-apis"></a><span data-ttu-id="fa0b4-339">Proteger APIs Web</span><span class="sxs-lookup"><span data-stu-id="fa0b4-339">Securing web APIs</span></span>

<span data-ttu-id="fa0b4-340">A maioria das APIs Web deve implementar um sistema de autenticação baseada em token.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-340">Most web APIs should implement a token-based authentication system.</span></span> <span data-ttu-id="fa0b4-341">A autenticação de token é sem estado e foi projetada para ser escalonável.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-341">Token authentication is stateless and designed to be scalable.</span></span> <span data-ttu-id="fa0b4-342">Em um sistema de autenticação baseada em token, o cliente deve primeiro ser autenticado no provedor de autenticação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-342">In a token-based authentication system, the client must first authenticate with the authentication provider.</span></span> <span data-ttu-id="fa0b4-343">Se ele for bem-sucedido, o cliente receberá um token, que é apenas uma cadeia de caracteres criptograficamente significativa.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-343">If successful, the client is issued a token, which is simply a cryptographically meaningful string of characters.</span></span> <span data-ttu-id="fa0b4-344">Em seguida, quando o cliente precisar emitir uma solicitação para uma API, ele adicionará esse token como um cabeçalho na solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-344">When the client then needs to issue a request to an API, it adds this token as a header on the request.</span></span> <span data-ttu-id="fa0b4-345">O servidor então validará o token encontrado no cabeçalho da solicitação antes de concluir a solicitação.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-345">The server then validates the token found in the request header before completing the request.</span></span> <span data-ttu-id="fa0b4-346">A Figura 7-4 demonstra esse processo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-346">Figure 7-4 demonstrates this process.</span></span>

![TokenAuth](./media/image7-4.png)

<span data-ttu-id="fa0b4-348">**Figura 7-4.**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-348">**Figure 7-4.**</span></span> <span data-ttu-id="fa0b4-349">Autenticação baseada em token para APIs Web.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-349">Token-based authentication for Web APIs.</span></span>

<span data-ttu-id="fa0b4-350">Você pode criar seu próprio serviço de autenticação, integrá-lo ao Azure AD e ao OAuth ou implementar um serviço usando uma ferramenta de código-fonte aberto como [IdentityServer](https://github.com/IdentityServer).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-350">You can create your own authentication service, integrate with Azure AD and OAuth, or implement a service using an open-source tool like [IdentityServer](https://github.com/IdentityServer).</span></span>

#### <a name="custom-security"></a><span data-ttu-id="fa0b4-351">Segurança personalizada</span><span class="sxs-lookup"><span data-stu-id="fa0b4-351">Custom Security</span></span>

<span data-ttu-id="fa0b4-352">Tenha um cuidado especial ao "distribuir sua própria" implementação de criptografia, associação de usuário ou sistema de geração de token.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-352">Be especially careful about "rolling your own" implementation of cryptography, user membership, or token generation system.</span></span> <span data-ttu-id="fa0b4-353">Há várias alternativas comerciais e de software livre disponíveis, que certamente terão uma segurança melhor do que uma implementação personalizada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-353">There are many commercial and open-source alternatives available, which will almost certainly have better security than a custom implementation.</span></span>

> ### <a name="references--security"></a><span data-ttu-id="fa0b4-354">Referências – Segurança</span><span class="sxs-lookup"><span data-stu-id="fa0b4-354">References – Security</span></span>
>
> - <span data-ttu-id="fa0b4-355">**Visão geral da documentação sobre segurança**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-355">**Security Docs Overview**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/security/>
> - <span data-ttu-id="fa0b4-356">**Impondo o SSL em um aplicativo ASP.NET Core**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-356">**Enforcing SSL in an ASP.NET Core App**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/security/enforcing-ssl>
> - <span data-ttu-id="fa0b4-357">**Introdução ao Identity**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-357">**Introduction to Identity**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/security/authentication/identity>
> - <span data-ttu-id="fa0b4-358">**Introdução à autorização**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-358">**Introduction to Authorization**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/security/authorization/introduction>
> - <span data-ttu-id="fa0b4-359">**Autenticação e autorização para aplicativos de API no Serviço de Aplicativo do Azure**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-359">**Authentication and Authorization for API Apps in Azure App Service**</span></span>  
>   <https://docs.microsoft.com/azure/app-service-api/app-service-api-authentication>
> - <span data-ttu-id="fa0b4-360">**Servidor de identidade**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-360">**Identity Server**</span></span>  
>   <https://github.com/IdentityServer>

## <a name="client-communication"></a><span data-ttu-id="fa0b4-361">Comunicação com o cliente</span><span class="sxs-lookup"><span data-stu-id="fa0b4-361">Client communication</span></span>

<span data-ttu-id="fa0b4-362">Além de fornecer páginas e responder a solicitações de dados por meio de APIs Web, os aplicativos ASP.NET Core podem se comunicar diretamente com os clientes conectados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-362">In addition to serving pages and responding to requests for data via web APIs, ASP.NET Core apps can communicate directly with connected clients.</span></span> <span data-ttu-id="fa0b4-363">Essa comunicação de saída pode usar uma variedade de tecnologias de transporte, sendo a mais comum o WebSockets.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-363">This outbound communication can use a variety of transport technologies, the most common being WebSockets.</span></span> <span data-ttu-id="fa0b4-364">O SignalR do ASP.NET Core é uma biblioteca que simplifica o acréscimo da funcionalidade de comunicação de servidor para cliente em tempo real aos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-364">ASP.NET Core SignalR is a library that makes it simple to add real-time server-to-client communication functionality to your applications.</span></span> <span data-ttu-id="fa0b4-365">O SignalR é compatível com uma variedade de tecnologias de transporte, incluindo o WebSockets, e abstrai muitos dos detalhes de implementação do desenvolvedor.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-365">SignalR supports a variety of transport technologies, including WebSockets, and abstracts away many of the implementation details from the developer.</span></span>

<span data-ttu-id="fa0b4-366">A comunicação do cliente em tempo real, seja ela por meio do WebSockets diretamente ou por outras técnicas, é útil em uma variedade de cenários de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-366">Real-time client communication, whether using WebSockets directly or other techniques, are useful in a variety of application scenarios.</span></span> <span data-ttu-id="fa0b4-367">Veja a seguir alguns exemplos:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-367">Some examples include:</span></span>

- <span data-ttu-id="fa0b4-368">Aplicativos de sala de chat ao vivo</span><span class="sxs-lookup"><span data-stu-id="fa0b4-368">Live chat room applications</span></span>

- <span data-ttu-id="fa0b4-369">Monitoramento de aplicativos</span><span class="sxs-lookup"><span data-stu-id="fa0b4-369">Monitoring applications</span></span>

- <span data-ttu-id="fa0b4-370">Atualizações de andamento do trabalho</span><span class="sxs-lookup"><span data-stu-id="fa0b4-370">Job progress updates</span></span>

- <span data-ttu-id="fa0b4-371">Notificações</span><span class="sxs-lookup"><span data-stu-id="fa0b4-371">Notifications</span></span>

- <span data-ttu-id="fa0b4-372">Aplicativos de formulários interativos</span><span class="sxs-lookup"><span data-stu-id="fa0b4-372">Interactive forms applications</span></span>

<span data-ttu-id="fa0b4-373">Ao desenvolver a comunicação do cliente nos aplicativos, normalmente, há dois componentes:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-373">When building client communication into your applications, there are typically two components:</span></span>

- <span data-ttu-id="fa0b4-374">Gerenciador de conexões do lado do servidor (Hub do SignalR, WebSocketManager, WebSocketHandler)</span><span class="sxs-lookup"><span data-stu-id="fa0b4-374">Server-side connection manager (SignalR Hub, WebSocketManager WebSocketHandler)</span></span>

- <span data-ttu-id="fa0b4-375">Biblioteca do lado do cliente</span><span class="sxs-lookup"><span data-stu-id="fa0b4-375">Client-side library</span></span>

<span data-ttu-id="fa0b4-376">Os clientes não estão limitados aos navegadores – aplicativos móveis, aplicativos de console e outros aplicativos nativos também podem se comunicar por meio do SignalR/WebSockets.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-376">Clients aren't limited to browsers – mobile apps, console apps, and other native apps can also communicate using SignalR/WebSockets.</span></span> <span data-ttu-id="fa0b4-377">O seguinte programa simples ecoa todo o conteúdo enviado a um aplicativo de chat para o console, como parte de um aplicativo de exemplo WebSocketManager:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-377">The following simple program echoes all content sent to a chat application to the console, as part of a WebSocketManager sample application:</span></span>

```csharp
public class Program
{
    private static Connection _connection;
    public static void Main(string[] args)
    {
        StartConnectionAsync();
        _connection.On("receiveMessage", (arguments) =>
        {
            Console.WriteLine($"{arguments[0]} said: {arguments[1]}");
        });
        Console.ReadLine();
        StopConnectionAsync();
    }

    public static async Task StartConnectionAsync()
    {
        _connection = new Connection();
        await _connection.StartConnectionAsync("ws://localhost:65110/chat");
    }

    public static async Task StopConnectionAsync()
    {
        await _connection.StopConnectionAsync();
    }
}
```

<span data-ttu-id="fa0b4-378">Considere maneiras pelas quais os aplicativos se comunicam diretamente com aplicativos cliente e considere se a comunicação em tempo real melhorará a experiência do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-378">Consider ways in which your applications communicate directly with client applications, and consider whether real-time communication would improve your app's user experience.</span></span>

> ### <a name="references--client-communication"></a><span data-ttu-id="fa0b4-379">Referências – Comunicação do cliente</span><span class="sxs-lookup"><span data-stu-id="fa0b4-379">References – Client Communication</span></span>
>
> - <span data-ttu-id="fa0b4-380">**ASP.NET Core SignalR**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-380">**ASP.NET Core SignalR**</span></span>  
>   <https://github.com/dotnet/aspnetcore/tree/master/src/SignalR>
> - <span data-ttu-id="fa0b4-381">**WebSocket Manager**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-381">**WebSocket Manager**</span></span>  
>   <https://github.com/radu-matei/websocket-manager>

## <a name="domain-driven-design--should-you-apply-it"></a><span data-ttu-id="fa0b4-382">Design controlado por domínio: você deve aplicá-lo?</span><span class="sxs-lookup"><span data-stu-id="fa0b4-382">Domain-driven design – Should you apply it?</span></span>

<span data-ttu-id="fa0b4-383">O DDD (Design Controlado por Domínio) é uma abordagem ágil para a criação de software que enfatiza o foco no _domínio de negócios_.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-383">Domain-Driven Design (DDD) is an agile approach to building software that emphasizes focusing on the _business domain_.</span></span> <span data-ttu-id="fa0b4-384">Ele coloca uma grande ênfase na comunicação e interação com especialistas no domínio de negócios que podem relatar para os desenvolvedores como funciona o sistema do mundo real.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-384">It places a heavy emphasis on communication and interaction with business domain expert(s) who can relate to the developers how the real-world system works.</span></span> <span data-ttu-id="fa0b4-385">Por exemplo, se você estiver criando um sistema que manipula mercados de ações, o especialista em domínio poderá ser um corretor de valores experiente.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-385">For example, if you're building a system that handles stock trades, your domain expert might be an experienced stock broker.</span></span> <span data-ttu-id="fa0b4-386">O DDD foi projetado para resolver problemas de negócios grandes e complexos e, geralmente, não é adequado para aplicativos menores e mais simples, pois o investimento no entendimento e na modelagem do domínio não vale a pena.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-386">DDD is designed to address large, complex business problems, and is often not appropriate for smaller, simpler applications, as the investment in understanding and modeling the domain is not worth it.</span></span>

<span data-ttu-id="fa0b4-387">Ao criar um software seguindo uma abordagem de DDD, sua equipe (incluindo stakeholders não técnicos e colaboradores) deve desenvolver uma _linguagem ubíqua_ para o espaço do problema.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-387">When building software following a DDD approach, your team (including non-technical stakeholders and contributors) should develop a _ubiquitous language_ for the problem space.</span></span> <span data-ttu-id="fa0b4-388">Ou seja, a mesma terminologia deve ser usada para o conceito do mundo real que está sendo modelado, o software equivalente e as estruturas que podem existir para persistir o conceito (por exemplo, tabelas de banco de dados).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-388">That is, the same terminology should be used for the real-world concept being modeled, the software equivalent, and any structures that might exist to persist the concept (for example, database tables).</span></span> <span data-ttu-id="fa0b4-389">Portanto, os conceitos descritos na linguagem ubíqua devem formar a base do _modelo de domínio_.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-389">Thus, the concepts described in the ubiquitous language should form the basis for your _domain model_.</span></span>

<span data-ttu-id="fa0b4-390">Seu modelo de domínio consiste em objetos que interagem entre si para representar o comportamento do sistema.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-390">Your domain model comprises objects that interact with one another to represent the behavior of the system.</span></span> <span data-ttu-id="fa0b4-391">Esses objetos podem se enquadrar nas seguintes categorias:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-391">These objects may fall into the following categories:</span></span>

- <span data-ttu-id="fa0b4-392">[Entidades](https://deviq.com/entity/), que representam objetos com um thread de identidade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-392">[Entities](https://deviq.com/entity/), which represent objects with a thread of identity.</span></span> <span data-ttu-id="fa0b4-393">As entidades costumam ser armazenadas na persistência com uma chave pela qual elas podem ser recuperadas posteriormente.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-393">Entities are typically stored in persistence with a key by which they can later be retrieved.</span></span>

- <span data-ttu-id="fa0b4-394">[Agregações](https://deviq.com/aggregate-pattern/), que representam grupos de objetos que devem ser persistidos como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-394">[Aggregates](https://deviq.com/aggregate-pattern/), which represent groups of objects that should be persisted as a unit.</span></span>

- <span data-ttu-id="fa0b4-395">[Objetos de valor](https://deviq.com/value-object/), que representam conceitos que podem ser comparados com base na soma de seus valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-395">[Value objects](https://deviq.com/value-object/), which represent concepts that can be compared on the basis of the sum of their property values.</span></span> <span data-ttu-id="fa0b4-396">Por exemplo, DateRange consiste em uma data de início e término.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-396">For example, DateRange consisting of a start and end date.</span></span>

- <span data-ttu-id="fa0b4-397">[Eventos de domínio](https://martinfowler.com/eaaDev/DomainEvent.html), que representam coisas que acontecem no sistema que são de interesse para outras partes do sistema.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-397">[Domain events](https://martinfowler.com/eaaDev/DomainEvent.html), which represent things happening within the system that are of interest to other parts of the system.</span></span>

<span data-ttu-id="fa0b4-398">Um modelo de domínio DDD deve encapsular um comportamento complexo dentro do modelo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-398">A DDD domain model should encapsulate complex behavior within the model.</span></span> <span data-ttu-id="fa0b4-399">As entidades, em particular, não devem ser apenas coleções de propriedades.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-399">Entities, in particular, should not merely be collections of properties.</span></span> <span data-ttu-id="fa0b4-400">Quando o modelo de domínio não tem um comportamento e representa apenas o estado do sistema, ele é chamado de [modelo anêmico](https://deviq.com/anemic-model/), o que é indesejável no DDD.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-400">When the domain model lacks behavior and merely represents the state of the system, it is said to be an [anemic model](https://deviq.com/anemic-model/), which is undesirable in DDD.</span></span>

<span data-ttu-id="fa0b4-401">Além desses tipos de modelo, o DDD normalmente emprega uma variedade de padrões:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-401">In addition to these model types, DDD typically employs a variety of patterns:</span></span>

- <span data-ttu-id="fa0b4-402">[Repositório](https://deviq.com/repository-pattern/), para abstrair os detalhes de persistência.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-402">[Repository](https://deviq.com/repository-pattern/), for abstracting persistence details.</span></span>

- <span data-ttu-id="fa0b4-403">[Alocador](https://en.wikipedia.org/wiki/Factory_method_pattern), para encapsular a criação de objetos complexos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-403">[Factory](https://en.wikipedia.org/wiki/Factory_method_pattern), for encapsulating complex object creation.</span></span>

- <span data-ttu-id="fa0b4-404">Eventos de domínio, para desacoplar um comportamento dependente do comportamento de gatilho.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-404">Domain events, for decoupling dependent behavior from triggering behavior.</span></span>

- <span data-ttu-id="fa0b4-405">[Serviços](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), para encapsular um comportamento complexo e/ou detalhes de implementação de infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-405">[Services](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), for encapsulating complex behavior and/or infrastructure implementation details.</span></span>

- <span data-ttu-id="fa0b4-406">[Comando](https://en.wikipedia.org/wiki/Command_pattern), para desacoplar a emissão de comandos e executar o comando em si.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-406">[Command](https://en.wikipedia.org/wiki/Command_pattern), for decoupling issuing commands and executing the command itself.</span></span>

- <span data-ttu-id="fa0b4-407">[Especificação](https://deviq.com/specification-pattern/), para encapsular os detalhes de consulta.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-407">[Specification](https://deviq.com/specification-pattern/), for encapsulating query details.</span></span>

<span data-ttu-id="fa0b4-408">O DDD também recomenda o uso da Arquitetura Limpa abordada anteriormente, permitindo o acoplamento flexível, o encapsulamento e um código que pode ser verificado com facilidade por meio de testes de unidade.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-408">DDD also recommends the use of the Clean Architecture discussed previously, allowing for loose coupling, encapsulation, and code that can easily be verified using unit tests.</span></span>

### <a name="when-should-you-apply-ddd"></a><span data-ttu-id="fa0b4-409">Quando você deve aplicar o DDD</span><span class="sxs-lookup"><span data-stu-id="fa0b4-409">When should you apply DDD</span></span>

<span data-ttu-id="fa0b4-410">O DDD é bem adequado para aplicativos grandes com complexidade significativa (não apenas técnica).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-410">DDD is well suited to large applications with significant business (not just technical) complexity.</span></span> <span data-ttu-id="fa0b4-411">O aplicativo deve exigir o conhecimento de especialistas no domínio.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-411">The application should require the knowledge of domain experts.</span></span> <span data-ttu-id="fa0b4-412">Deve haver um comportamento significativo no próprio modelo de domínio, que representa as regras de negócio e as interações, além de simplesmente armazenar e recuperar o estado atual de vários registros de armazenamentos de dados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-412">There should be significant behavior in the domain model itself, representing business rules and interactions beyond simply storing and retrieving the current state of various records from data stores.</span></span>

### <a name="when-shouldnt-you-apply-ddd"></a><span data-ttu-id="fa0b4-413">Quando você não deve aplicar o DDD</span><span class="sxs-lookup"><span data-stu-id="fa0b4-413">When shouldn't you apply DDD</span></span>

<span data-ttu-id="fa0b4-414">O DDD envolve investimentos em modelagem, arquitetura e comunicação que não podem ser garantidos para aplicativos menores ou aplicativos que são essencialmente apenas CRUD (criar/ler/atualizar/excluir).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-414">DDD involves investments in modeling, architecture, and communication that may not be warranted for smaller applications or applications that are essentially just CRUD (create/read/update/delete).</span></span> <span data-ttu-id="fa0b4-415">Caso você opte por abordar seu aplicativo seguindo o DDD, mas descubra que o domínio tem um modelo anêmico sem nenhum comportamento, talvez você precise repensar sua abordagem.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-415">If you choose to approach your application following DDD, but find that your domain has an anemic model with no behavior, you may need to rethink your approach.</span></span> <span data-ttu-id="fa0b4-416">O aplicativo pode não precisar do DDD ou você pode precisar de assistência na refatoração do aplicativo para encapsular a lógica de negócios no modelo de domínio, em vez de na interface do usuário ou no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-416">Either your application may not need DDD, or you may need assistance refactoring your application to encapsulate business logic in the domain model, rather than in your database or user interface.</span></span>

<span data-ttu-id="fa0b4-417">Uma abordagem híbrida é usar o DDD somente para as áreas transacionais ou mais complexas do aplicativo, mas não para as partes CRUD ou somente leitura mais simples do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-417">A hybrid approach would be to only use DDD for the transactional or more complex areas of the application, but not for simpler CRUD or read-only portions of the application.</span></span> <span data-ttu-id="fa0b4-418">Por exemplo, você não precisará das restrições de uma agregação se estiver consultando dados para exibir um relatório ou para visualizar dados de um Dashboard.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-418">For instance, you don't need the constraints of an Aggregate if you're querying data to display a report or to visualize data for a dashboard.</span></span> <span data-ttu-id="fa0b4-419">É perfeitamente aceitável ter um modelo de leitura mais simples e separado para esses requisitos.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-419">It's perfectly acceptable to have a separate, simpler read model for such requirements.</span></span>

> ### <a name="references--domain-driven-design"></a><span data-ttu-id="fa0b4-420">Referências – Design Controlado por Domínio</span><span class="sxs-lookup"><span data-stu-id="fa0b4-420">References – Domain-Driven Design</span></span>
>
> - <span data-ttu-id="fa0b4-421">**DDD simplificado (resposta do StackOverflow)**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-421">**DDD in Plain English (StackOverflow Answer)**</span></span>  
>   <https://stackoverflow.com/questions/1222392/can-someone-explain-domain-driven-design-ddd-in-plain-english-please/1222488#1222488>

## <a name="deployment"></a><span data-ttu-id="fa0b4-422">Implantação</span><span class="sxs-lookup"><span data-stu-id="fa0b4-422">Deployment</span></span>

<span data-ttu-id="fa0b4-423">Há algumas etapas envolvidas no processo de implantação do aplicativo ASP.NET Core, independentemente do local em que ele será hospedado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-423">There are a few steps involved in the process of deploying your ASP.NET Core application, regardless of where it will be hosted.</span></span> <span data-ttu-id="fa0b4-424">A primeira etapa é publicar o aplicativo, que pode ser feito usando o `dotnet publish` comando da CLI.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-424">The first step is to publish the application, which can be done using the `dotnet publish` CLI command.</span></span> <span data-ttu-id="fa0b4-425">Isso compilará o aplicativo e colocará todos os arquivos necessários para executar o aplicativo em uma pasta designada.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-425">This will compile the application and place all of the files needed to run the application into a designated folder.</span></span> <span data-ttu-id="fa0b4-426">Quando você faz a implantação por meio do Visual Studio, esta etapa é executada automaticamente para você.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-426">When you deploy from Visual Studio, this step is performed for you automatically.</span></span> <span data-ttu-id="fa0b4-427">A pasta de publicação contém arquivos .exe e .dll para o aplicativo e suas dependências.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-427">The publish folder contains .exe and .dll files for the application and its dependencies.</span></span> <span data-ttu-id="fa0b4-428">Um aplicativo autossuficiente também incluirá uma versão do runtime do .NET.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-428">A self-contained application will also include a version of the .NET runtime.</span></span> <span data-ttu-id="fa0b4-429">Os aplicativos ASP.NET Core também incluirão arquivos de configuração, ativos de cliente estático e exibições do MVC.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-429">ASP.NET Core applications will also include configuration files, static client assets, and MVC views.</span></span>

<span data-ttu-id="fa0b4-430">Os aplicativos ASP.NET Core são aplicativos de console que devem ser iniciados quando o servidor é inicializado e reiniciados quando há falhas no aplicativo (ou no servidor).</span><span class="sxs-lookup"><span data-stu-id="fa0b4-430">ASP.NET Core applications are console applications that must be started when the server boots and restarted if the application (or server) crashes.</span></span> <span data-ttu-id="fa0b4-431">Um gerenciador de processos pode ser usado para automatizar esse processo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-431">A process manager can be used to automate this process.</span></span> <span data-ttu-id="fa0b4-432">Os gerenciadores de processos mais comuns para o ASP.NET Core são o Nginx e o Apache no Linux e o IIS ou o Serviço Windows no Windows.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-432">The most common process managers for ASP.NET Core are Nginx and Apache on Linux and IIS or Windows Service on Windows.</span></span>

<span data-ttu-id="fa0b4-433">Além de um Gerenciador de processos, ASP.NET Core aplicativos podem usar um servidor proxy reverso.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-433">In addition to a process manager, ASP.NET Core applications may use a reverse proxy server.</span></span> <span data-ttu-id="fa0b4-434">Um servidor proxy reverso recebe solicitações HTTP da Internet e as encaminha para o Kestrel após algum tratamento preliminar.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-434">A reverse proxy server receives HTTP requests from the Internet and forwards them to Kestrel after some preliminary handling.</span></span> <span data-ttu-id="fa0b4-435">Os servidores proxy reverso fornecem uma camada de segurança para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-435">Reverse proxy servers provide a layer of security for the application.</span></span> <span data-ttu-id="fa0b4-436">O Kestrel também não dá suporte à hospedagem de vários aplicativos na mesma porta e, portanto, técnicas como cabeçalhos de host não podem ser usadas com ele para habilitar a hospedagem de vários aplicativos na mesma porta e endereço IP.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-436">Kestrel also doesn't support hosting multiple applications on the same port, so techniques like host headers cannot be used with it to enable hosting multiple applications on the same port and IP address.</span></span>

![Kestrel para a Internet](./media/image7-5.png)

<span data-ttu-id="fa0b4-438">**Figura 7-5**.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-438">**Figure 7-5**.</span></span> <span data-ttu-id="fa0b4-439">ASP.NET hospedado em Kestrel atrás de um servidor proxy reverso</span><span class="sxs-lookup"><span data-stu-id="fa0b4-439">ASP.NET hosted in Kestrel behind a reverse proxy server</span></span>

<span data-ttu-id="fa0b4-440">Outro cenário em que um proxy reverso pode ser útil é para proteger vários aplicativos usando SSL/HTTPS.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-440">Another scenario in which a reverse proxy can be helpful is to secure multiple applications using SSL/HTTPS.</span></span> <span data-ttu-id="fa0b4-441">Nesse caso, somente o proxy inverso precisa ter o SSL configurado.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-441">In this case, only the reverse proxy would need to have SSL configured.</span></span> <span data-ttu-id="fa0b4-442">A comunicação entre o servidor proxy reverso e o Kestrel pode ocorrer por HTTP, conforme mostrado na Figura 7-6.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-442">Communication between the reverse proxy server and Kestrel could take place over HTTP, as shown in Figure 7-6.</span></span>

![ASP.NET hospedado atrás de um servidor proxy reverso protegido por HTTPS](./media/image7-6.png)

<span data-ttu-id="fa0b4-444">**Figura 7-6**.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-444">**Figure 7-6**.</span></span> <span data-ttu-id="fa0b4-445">ASP.NET hospedado atrás de um servidor proxy reverso protegido por HTTPS</span><span class="sxs-lookup"><span data-stu-id="fa0b4-445">ASP.NET hosted behind an HTTPS-secured reverse proxy server</span></span>

<span data-ttu-id="fa0b4-446">Uma abordagem cada vez mais popular é hospedar o aplicativo ASP.NET Core em um contêiner do Docker, que pode ser então hospedado localmente ou implantado no Azure para a hospedagem baseada em nuvem.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-446">An increasingly popular approach is to host your ASP.NET Core application in a Docker container, which then can be hosted locally or deployed to Azure for cloud-based hosting.</span></span> <span data-ttu-id="fa0b4-447">O contêiner do Docker pode conter o código do aplicativo, em execução no Kestrel, e ser implantado atrás de um servidor proxy reverso, conforme mostrado acima.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-447">The Docker container could contain your application code, running on Kestrel, and would be deployed behind a reverse proxy server, as shown above.</span></span>

<span data-ttu-id="fa0b4-448">Caso esteja hospedando seu aplicativo no Azure, use o Gateway de Aplicativo do Microsoft Azure como uma solução de virtualização dedicada para fornecer vários serviços.</span><span class="sxs-lookup"><span data-stu-id="fa0b4-448">If you're hosting your application on Azure, you can use Microsoft Azure Application Gateway as a dedicated virtual appliance to provide several services.</span></span> <span data-ttu-id="fa0b4-449">Além de atuar como um proxy reverso para aplicativos individuais, o Gateway de Aplicativo também pode oferecer os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="fa0b4-449">In addition to acting as a reverse proxy for individual applications, Application Gateway can also offer the following features:</span></span>

- <span data-ttu-id="fa0b4-450">Balanceamento de carga HTTP</span><span class="sxs-lookup"><span data-stu-id="fa0b4-450">HTTP load balancing</span></span>

- <span data-ttu-id="fa0b4-451">Descarregamento SSL (SSL apenas para a Internet)</span><span class="sxs-lookup"><span data-stu-id="fa0b4-451">SSL offload (SSL only to Internet)</span></span>

- <span data-ttu-id="fa0b4-452">SSL de ponta a ponta</span><span class="sxs-lookup"><span data-stu-id="fa0b4-452">End to End SSL</span></span>

- <span data-ttu-id="fa0b4-453">Roteamento de vários sites (consolide até 20 sites em um único Gateway de Aplicativo)</span><span class="sxs-lookup"><span data-stu-id="fa0b4-453">Multi-site routing (consolidate up to 20 sites on a single Application Gateway)</span></span>

- <span data-ttu-id="fa0b4-454">Firewall do aplicativo Web</span><span class="sxs-lookup"><span data-stu-id="fa0b4-454">Web application firewall</span></span>

- <span data-ttu-id="fa0b4-455">Suporte do WebSockets</span><span class="sxs-lookup"><span data-stu-id="fa0b4-455">Websocket support</span></span>

- <span data-ttu-id="fa0b4-456">Diagnóstico avançado</span><span class="sxs-lookup"><span data-stu-id="fa0b4-456">Advanced diagnostics</span></span>

<span data-ttu-id="fa0b4-457">_Saiba mais sobre as opções de implantação do Azure no [capítulo 10](development-process-for-azure.md)._</span><span class="sxs-lookup"><span data-stu-id="fa0b4-457">_Learn more about Azure deployment options in [Chapter 10](development-process-for-azure.md)._</span></span>

> ### <a name="references--deployment"></a><span data-ttu-id="fa0b4-458">Referências – Implantação</span><span class="sxs-lookup"><span data-stu-id="fa0b4-458">References – Deployment</span></span>
>
> - <span data-ttu-id="fa0b4-459">**Visão geral de hospedagem e implantação**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-459">**Hosting and Deployment Overview**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/publishing/>
> - <span data-ttu-id="fa0b4-460">**Quando usar o Kestrel com um proxy reverso**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-460">**When to use Kestrel with a reverse proxy**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/fundamentals/servers/kestrel#when-to-use-kestrel-with-a-reverse-proxy>
> - <span data-ttu-id="fa0b4-461">**Hospedar aplicativos ASP.NET Core no Docker**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-461">**Host ASP.NET Core apps in Docker**</span></span>  
>   <https://docs.microsoft.com/aspnet/core/publishing/docker>
> - <span data-ttu-id="fa0b4-462">**Introdução ao Gateway de Aplicativo do Azure**</span><span class="sxs-lookup"><span data-stu-id="fa0b4-462">**Introducing Azure Application Gateway**</span></span>  
>   <https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction>

>[!div class="step-by-step"]
><span data-ttu-id="fa0b4-463">[Anterior](common-client-side-web-technologies.md) 
> [Avançar](work-with-data-in-asp-net-core-apps.md)</span><span class="sxs-lookup"><span data-stu-id="fa0b4-463">[Previous](common-client-side-web-technologies.md)
[Next](work-with-data-in-asp-net-core-apps.md)</span></span>
