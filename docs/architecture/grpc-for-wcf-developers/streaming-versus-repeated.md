---
title: serviços de streaming gRPC versus campos repetidos-gRPC para desenvolvedores do WCF
description: Comparando campos repetidos aos serviços de streaming como maneiras de passar coleções de dados com gRPC.
author: markrendle
ms.date: 09/02/2019
ms.openlocfilehash: e48fe4882139e029dbf5b52451a2e68cb4316677
ms.sourcegitcommit: 337bdc5a463875daf2cc6883e5a2da97d56f5000
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/24/2019
ms.locfileid: "72846080"
---
# <a name="grpc-streaming-services-versus-repeated-fields"></a><span data-ttu-id="dbed8-103">serviços de streaming gRPC versus campos repetidos</span><span class="sxs-lookup"><span data-stu-id="dbed8-103">gRPC streaming services versus repeated fields</span></span>

<span data-ttu-id="dbed8-104">os serviços gRPCs fornecem duas maneiras de retornar conjuntos de valores ou listas de objetos.</span><span class="sxs-lookup"><span data-stu-id="dbed8-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="dbed8-105">A especificação de mensagem buffers de protocolo usa a palavra-chave `repeated` para declarar listas ou matrizes de mensagens em outra mensagem.</span><span class="sxs-lookup"><span data-stu-id="dbed8-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="dbed8-106">A especificação de serviço gRPC usa a palavra-chave `stream` para declarar uma conexão persistente de longa execução sobre a qual várias mensagens são enviadas e pode ser processada individualmente.</span><span class="sxs-lookup"><span data-stu-id="dbed8-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection over which multiple messages are sent, and can be processed, individually.</span></span> <span data-ttu-id="dbed8-107">O recurso de `stream` também pode ser usado para dados temporais de longa execução, como notificações ou mensagens de log, mas este capítulo considerará seu uso para retornar um único conjunto.</span><span class="sxs-lookup"><span data-stu-id="dbed8-107">The `stream` feature can also be used for long-running temporal data such as notifications or log messages, but this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="dbed8-108">Que você deve usar depende de vários fatores, como o tamanho geral do conjunto de data, o tempo necessário para criar o conjunto de um cliente ou servidor de extremidade, e se o consumidor do conjunto de um pode começar a agir assim que o primeiro item estiver disponível ou precisa que o conjunto de dado completo faça algo útil.</span><span class="sxs-lookup"><span data-stu-id="dbed8-108">Which you should use depends on various factors, such as the overall size of the dataset, the time it took to create the dataset at either the client or server end, and whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="dbed8-109">Quando usar campos de `repeated`</span><span class="sxs-lookup"><span data-stu-id="dbed8-109">When to use `repeated` fields</span></span>

<span data-ttu-id="dbed8-110">Para qualquer conjunto de data restrito em tamanho e que possa ser gerado em sua totalidade em um curto tempo – digamos, em um segundo, você deve usar um campo de `repeated` em uma mensagem de Protobuf comum.</span><span class="sxs-lookup"><span data-stu-id="dbed8-110">For any dataset that is constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="dbed8-111">Por exemplo, em um sistema de comércio eletrônico, para criar uma lista de itens em um pedido é provavelmente rápido e a lista não será muito grande.</span><span class="sxs-lookup"><span data-stu-id="dbed8-111">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="dbed8-112">Retornar uma única mensagem com um campo de `repeated` é uma ordem de magnitude mais rápido do que usar um `stream` e incorre em menos sobrecarga de rede.</span><span class="sxs-lookup"><span data-stu-id="dbed8-112">Returning a single message with a `repeated` field is an order of magnitude faster than using a `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="dbed8-113">Se o cliente precisar de todos os dados antes de começar a processá-lo e se o conjunto for pequeno o suficiente para construir na memória, considere usar um campo `repeated` mesmo se a criação real do conjunto de dados na memória no servidor for mais lenta.</span><span class="sxs-lookup"><span data-stu-id="dbed8-113">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field even if the actual creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="dbed8-114">Quando usar os métodos de `stream`</span><span class="sxs-lookup"><span data-stu-id="dbed8-114">When to use `stream` methods</span></span>

<span data-ttu-id="dbed8-115">Os conjuntos de valores em que os objetos de mensagem são potencialmente muito grandes são transferidos melhor usando solicitações de streaming ou respostas.</span><span class="sxs-lookup"><span data-stu-id="dbed8-115">Datasets where the message objects are potentially very large are best transferred using streaming requests or responses.</span></span> <span data-ttu-id="dbed8-116">É mais eficiente construir um objeto grande na memória, gravá-lo na rede e, em seguida, liberar os recursos.</span><span class="sxs-lookup"><span data-stu-id="dbed8-116">It's more efficient to construct a large object in memory, write it to the network and then free up the resources.</span></span> <span data-ttu-id="dbed8-117">Essa abordagem melhorará a escalabilidade do seu serviço.</span><span class="sxs-lookup"><span data-stu-id="dbed8-117">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="dbed8-118">Da mesma forma, os conjuntos de datas de tamanho irrestrito devem ser enviados por fluxos para evitar a ausência de memória ao construí-los.</span><span class="sxs-lookup"><span data-stu-id="dbed8-118">Similarly, datasets of unconstrained size should be sent over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="dbed8-119">Para conjuntos de valores em que cada item individual pode ser processado separadamente pelo consumidor, você deve considerar o uso de um fluxo se isso significa que o progresso pode ser indicado para o usuário final.</span><span class="sxs-lookup"><span data-stu-id="dbed8-119">For datasets where each individual item can be processed separately by the consumer, you should consider using a stream if it means that progress can be indicated to the end user.</span></span> <span data-ttu-id="dbed8-120">Isso pode melhorar a capacidade de resposta aparente de um aplicativo, embora isso deva ser equilibrado em relação ao desempenho geral do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dbed8-120">This could improve the apparent responsiveness of an application, although this should be balanced against the overall performance of the application.</span></span>

<span data-ttu-id="dbed8-121">Outro cenário em que os fluxos podem ser úteis é onde uma mensagem está sendo processada em vários serviços.</span><span class="sxs-lookup"><span data-stu-id="dbed8-121">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="dbed8-122">Se cada serviço em uma cadeia retornar um fluxo, o serviço de terminal (ou seja, o último na cadeia) poderá começar a retornar mensagens que podem ser processadas e passadas de volta ao longo da cadeia para o solicitante original, que pode retornar um fluxo ou agregar o resulta em uma única mensagem de resposta.</span><span class="sxs-lookup"><span data-stu-id="dbed8-122">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages that can be processed and passed back along the chain to the original requestor, which can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="dbed8-123">Essa abordagem se presta bem a padrões como mapear/reduzir.</span><span class="sxs-lookup"><span data-stu-id="dbed8-123">This approach lends itself well to patterns like Map/Reduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="dbed8-124">[Anterior](migrate-duplex-services.md)
>[Próximo](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="dbed8-124">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>
