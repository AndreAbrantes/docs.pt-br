---
title: Configuração centralizada
description: A configuração centralizada usando o Azure Key Vault pode facilitar o gerenciamento de aplicativos nativos de nuvem.
ms.date: 06/30/2019
ms.openlocfilehash: 4c516b6773d913acd71ff06742302e9766a141e2
ms.sourcegitcommit: 56f1d1203d0075a461a10a301459d3aa452f4f47
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/24/2019
ms.locfileid: "71214002"
---
# <a name="centralized-configuration"></a><span data-ttu-id="8179b-103">Configuração centralizada</span><span class="sxs-lookup"><span data-stu-id="8179b-103">Centralized configuration</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="8179b-104">Os aplicativos nativos de nuvem envolvem muitos outros serviços em execução do que os aplicativos monolíticos de instância única tradicionais.</span><span class="sxs-lookup"><span data-stu-id="8179b-104">Cloud-native applications involve many more running services than traditional single-instance monolithic apps.</span></span> <span data-ttu-id="8179b-105">O gerenciamento de definições de configuração para dezenas de serviços interdependentes pode ser desafiador, motivo pelo qual os repositórios de configuração centralizados geralmente são implementados para aplicativos distribuídos.</span><span class="sxs-lookup"><span data-stu-id="8179b-105">Managing configuration settings for dozens of interdependent services can be challenging, which is why centralized configuration stores are often implemented for distributed applications.</span></span>

<span data-ttu-id="8179b-106">Conforme discutido no [capítulo 1](introduction.md), as recomendações do aplicativo de doze fatores exigem uma separação estrita entre o código e a configuração.</span><span class="sxs-lookup"><span data-stu-id="8179b-106">As discussed in [Chapter 1](introduction.md), the Twelve-Factor App recommendations require strict separation between code and configuration.</span></span> <span data-ttu-id="8179b-107">Isso significa que o armazenamento de definições de configuração como constantes ou valores literais no código é uma violação.</span><span class="sxs-lookup"><span data-stu-id="8179b-107">This means storing configuration settings as constants or literal values in code is a violation.</span></span> <span data-ttu-id="8179b-108">Essa recomendação existe porque o mesmo código deve ser usado em vários ambientes, incluindo desenvolvimento, teste, preparo e produção.</span><span class="sxs-lookup"><span data-stu-id="8179b-108">This recommendation exists because the same code should be used across multiple environments, including development, testing, staging, and production.</span></span> <span data-ttu-id="8179b-109">No entanto, é provável que os valores de configuração variem entre cada um desses ambientes.</span><span class="sxs-lookup"><span data-stu-id="8179b-109">However, configuration values are likely to vary between each of these environments.</span></span> <span data-ttu-id="8179b-110">Portanto, os valores de configuração devem ser armazenados no próprio ambiente ou o ambiente deve armazenar as credenciais em um repositório de configurações centralizado.</span><span class="sxs-lookup"><span data-stu-id="8179b-110">So, configuration values should be stored in the environment itself, or the environment should store the credentials to a centralized configuration store.</span></span>

<span data-ttu-id="8179b-111">O aplicativo eShopOnContainers inclui arquivos de configurações de aplicativo local com cada microserviço.</span><span class="sxs-lookup"><span data-stu-id="8179b-111">The eShopOnContainers application includes local application settings files with each microservice.</span></span> <span data-ttu-id="8179b-112">Esses arquivos são verificados no controle do código-fonte, mas não incluem segredos de produção, como cadeias de conexão ou chaves de API.</span><span class="sxs-lookup"><span data-stu-id="8179b-112">These files are checked into source control but don't include production secrets such as connection strings or API keys.</span></span> <span data-ttu-id="8179b-113">Em produção, as configurações individuais podem ser substituídas por variáveis de ambiente por serviço.</span><span class="sxs-lookup"><span data-stu-id="8179b-113">In production, individual settings may be overwritten with per-service environment variables.</span></span> <span data-ttu-id="8179b-114">Essa é uma prática comum para aplicativos hospedados, mas não fornece um repositório de configuração central.</span><span class="sxs-lookup"><span data-stu-id="8179b-114">This is a common practice for hosted applications, but doesn't provide a central configuration store.</span></span> <span data-ttu-id="8179b-115">Para dar suporte ao gerenciamento centralizado de definições de configuração, cada microserviço inclui uma configuração para alternar entre o uso de configurações locais ou configurações de Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="8179b-115">To support centralized management of configuration settings, each microservice includes a setting to toggle between its use of local settings or Azure Key Vault settings.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="8179b-116">Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="8179b-116">Azure Key Vault</span></span>

<span data-ttu-id="8179b-117">Azure Key Vault fornece armazenamento seguro de tokens, senhas, certificados, chaves de API e outros segredos confidenciais.</span><span class="sxs-lookup"><span data-stu-id="8179b-117">Azure Key Vault provides secure storage of tokens, passwords, certificates, API keys, and other sensitive secrets.</span></span> <span data-ttu-id="8179b-118">O acesso a Key Vault requer autenticação e autorização apropriadas do chamador, que no caso dos microserviços eShopOnContainers significam o uso de uma combinação ClientId/ClientSecret.</span><span class="sxs-lookup"><span data-stu-id="8179b-118">Access to Key Vault requires proper caller authentication and authorization, which in the case of the eShopOnContainers microservices means the use of a ClientId/ClientSecret combination.</span></span> <span data-ttu-id="8179b-119">Não faça check-in dessas credenciais no controle do código-fonte, mas, em vez disso, defina no ambiente do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8179b-119">Don't check in these credentials into source control, but instead set in the application's environment.</span></span> <span data-ttu-id="8179b-120">O acesso direto a Key Vault do AKS pode ser obtido usando [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span><span class="sxs-lookup"><span data-stu-id="8179b-120">Direct access to Key Vault from AKS can be achieved using [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span></span>

<span data-ttu-id="8179b-121">Com a configuração centralizada, as configurações que se aplicam ao aplicativo inteiro, como o ponto de extremidade de registro em log centralizado, podem ser definidas uma vez e usadas por cada parte do aplicativo distribuído.</span><span class="sxs-lookup"><span data-stu-id="8179b-121">With centralized configuration, settings that apply to the entire application, such as the centralized logging endpoint, can be set once and used by every part of the distributed application.</span></span> <span data-ttu-id="8179b-122">Embora os microserviços devam ser independentes um do outro, normalmente ainda serão algumas dependências compartilhadas cujos detalhes de configuração podem se beneficiar de um repositório de configuração centralizado.</span><span class="sxs-lookup"><span data-stu-id="8179b-122">Although microservices should be independent of one another, there will typically still be some shared dependencies whose configuration details can benefit from a centralized configuration store.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="8179b-123">[Anterior](deploy-eshoponcontainers-azure.md)
>[Próximo](scale-applications.md)</span><span class="sxs-lookup"><span data-stu-id="8179b-123">[Previous](deploy-eshoponcontainers-azure.md)
[Next](scale-applications.md)</span></span>
