---
title: Comunicação entre serviços
description: Saiba como os microserviços nativos de nuvem de back-end se comunicam com outros microserviços de back-end.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: e9f27309fd6b03830ab3098d0fb08a7ecf5c0eaa
ms.sourcegitcommit: 56f1d1203d0075a461a10a301459d3aa452f4f47
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/24/2019
ms.locfileid: "71214392"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="12d02-103">Comunicação entre serviços</span><span class="sxs-lookup"><span data-stu-id="12d02-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="12d02-104">Mudando do cliente front-end, agora resolvemos que os microserviços de back-end se comunicam entre si.</span><span class="sxs-lookup"><span data-stu-id="12d02-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="12d02-105">Ao construir um aplicativo nativo de nuvem, você desejará ser sensível à forma como os serviços de back-end se comunicam entre si.</span><span class="sxs-lookup"><span data-stu-id="12d02-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="12d02-106">Idealmente, quanto menos comunicação entre serviços, melhor.</span><span class="sxs-lookup"><span data-stu-id="12d02-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="12d02-107">No entanto, evitar nem sempre é possível, pois os serviços de back-end muitas vezes dependem uns dos outros para concluir uma operação.</span><span class="sxs-lookup"><span data-stu-id="12d02-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="12d02-108">Há várias abordagens amplamente aceitas para implementar a comunicação entre serviços.</span><span class="sxs-lookup"><span data-stu-id="12d02-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="12d02-109">O *tipo de interação de comunicação* geralmente determinará a melhor abordagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="12d02-110">Considere os seguintes tipos de interação:</span><span class="sxs-lookup"><span data-stu-id="12d02-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="12d02-111">*Consulta* – quando um microserviço de chamada requer uma resposta de um Microservice chamado, como "Ei, forneça as informações do comprador para uma determinada ID do cliente".</span><span class="sxs-lookup"><span data-stu-id="12d02-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="12d02-112">*Comando* – quando o microserviço de chamada precisa de outro microserviço para executar uma ação, mas não requer uma resposta, como "Ei, apenas envia este pedido."</span><span class="sxs-lookup"><span data-stu-id="12d02-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="12d02-113">*Evento* – quando um microserviço, chamado de Publicador, gera um evento que o estado mudou ou uma ação ocorreu.</span><span class="sxs-lookup"><span data-stu-id="12d02-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="12d02-114">Outros microserviços, chamados assinantes, que estão interessados, podem reagir ao evento adequadamente.</span><span class="sxs-lookup"><span data-stu-id="12d02-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="12d02-115">O Publicador e os assinantes não estão cientes uns dos outros.</span><span class="sxs-lookup"><span data-stu-id="12d02-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="12d02-116">Os sistemas de microserviço normalmente usam uma combinação desses tipos de interação ao executar operações que exigem interação entre serviços.</span><span class="sxs-lookup"><span data-stu-id="12d02-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="12d02-117">Vamos examinar cada um e saber como você pode implementá-los.</span><span class="sxs-lookup"><span data-stu-id="12d02-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="12d02-118">Consultas</span><span class="sxs-lookup"><span data-stu-id="12d02-118">Queries</span></span>

<span data-ttu-id="12d02-119">Muitas vezes, um microserviço pode precisar *consultar* outro, exigindo uma resposta imediata para concluir uma operação.</span><span class="sxs-lookup"><span data-stu-id="12d02-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="12d02-120">Um microserviço da cesta de compras pode precisar de informações do produto e um preço para adicionar um item à sua cesta.</span><span class="sxs-lookup"><span data-stu-id="12d02-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="12d02-121">Há várias abordagens para implementar operações de consulta.</span><span class="sxs-lookup"><span data-stu-id="12d02-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="12d02-122">Mensagens de solicitação/resposta</span><span class="sxs-lookup"><span data-stu-id="12d02-122">Request/Response Messaging</span></span>

<span data-ttu-id="12d02-123">Uma opção para implementar esse cenário é que o microserviço de back-end de chamada faça solicitações HTTP diretas para os microserviços que precisa consultar, mostrados na Figura 4-8.</span><span class="sxs-lookup"><span data-stu-id="12d02-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Comunicação direta de HTTP](./media/direct-http-communication.png)

<span data-ttu-id="12d02-125">**Figura 4-8**.</span><span class="sxs-lookup"><span data-stu-id="12d02-125">**Figure 4-8**.</span></span> <span data-ttu-id="12d02-126">Comunicação direta de HTTP</span><span class="sxs-lookup"><span data-stu-id="12d02-126">Direct HTTP communication</span></span>

<span data-ttu-id="12d02-127">Embora as chamadas HTTP diretas entre os microserviços sejam relativamente simples de implementar, deve-se ter cuidado para minimizar essa prática.</span><span class="sxs-lookup"><span data-stu-id="12d02-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="12d02-128">Para começar, essas chamadas são sempre *síncronas* e bloquearão a operação até que um resultado seja retornado ou a solicitação atingir o tempo limite.</span><span class="sxs-lookup"><span data-stu-id="12d02-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="12d02-129">O que era um pouco independente, os serviços independentes, capazes de evoluir de forma independente e implantar com frequência, agora são acoplados entre si.</span><span class="sxs-lookup"><span data-stu-id="12d02-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="12d02-130">Como o acoplamento entre os microserviços aumenta, seus benefícios arquitetônicos diminuem.</span><span class="sxs-lookup"><span data-stu-id="12d02-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="12d02-131">A execução de uma solicitação infrequente que faz uma única chamada HTTP direta para outro microserviço pode ser aceitável para alguns sistemas.</span><span class="sxs-lookup"><span data-stu-id="12d02-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="12d02-132">No entanto, chamadas de alto volume que invocam chamadas HTTP diretas para vários microserviços não são aconselhadas.</span><span class="sxs-lookup"><span data-stu-id="12d02-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="12d02-133">Eles podem aumentar a latência e afetar negativamente o desempenho, a escalabilidade e a disponibilidade do seu sistema.</span><span class="sxs-lookup"><span data-stu-id="12d02-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="12d02-134">Ainda pior, uma longa série de comunicação HTTP direta pode levar a cadeias profundas e complexas de chamadas de microservices síncronas, mostradas na Figura 4-9:</span><span class="sxs-lookup"><span data-stu-id="12d02-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Encadeando consultas HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="12d02-136">**Figura 4-9**.</span><span class="sxs-lookup"><span data-stu-id="12d02-136">**Figure 4-9**.</span></span> <span data-ttu-id="12d02-137">Encadeando consultas HTTP</span><span class="sxs-lookup"><span data-stu-id="12d02-137">Chaining HTTP queries</span></span>

<span data-ttu-id="12d02-138">Certamente, você pode imaginar o risco no design mostrado na imagem anterior.</span><span class="sxs-lookup"><span data-stu-id="12d02-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="12d02-139">O que acontece se \#a etapa 3 falhar?</span><span class="sxs-lookup"><span data-stu-id="12d02-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="12d02-140">Ou a \#etapa 8 falha?</span><span class="sxs-lookup"><span data-stu-id="12d02-140">Or Step \#8 fails?</span></span> <span data-ttu-id="12d02-141">Como você se recupera?</span><span class="sxs-lookup"><span data-stu-id="12d02-141">How do you recover?</span></span> <span data-ttu-id="12d02-142">E se a \#etapa 6 estiver lenta porque o serviço subjacente está ocupado?</span><span class="sxs-lookup"><span data-stu-id="12d02-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="12d02-143">Como você continua?</span><span class="sxs-lookup"><span data-stu-id="12d02-143">How do you continue?</span></span> <span data-ttu-id="12d02-144">Mesmo que tudo funcione corretamente, considere a latência que essa chamada incorreria, que é a soma da latência de cada etapa.</span><span class="sxs-lookup"><span data-stu-id="12d02-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="12d02-145">O grande grau de acoplamento na imagem anterior sugere que os serviços não foram modelados de forma ideal.</span><span class="sxs-lookup"><span data-stu-id="12d02-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="12d02-146">Seria cabe a equipe a revisitar seu design.</span><span class="sxs-lookup"><span data-stu-id="12d02-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="12d02-147">Padrão de exibição materializada</span><span class="sxs-lookup"><span data-stu-id="12d02-147">Materialized View pattern</span></span>

<span data-ttu-id="12d02-148">Uma opção popular para remover o acoplamento de microatendimento é o [padrão de exibição materializado](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span><span class="sxs-lookup"><span data-stu-id="12d02-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="12d02-149">Com esse padrão, um microserviço armazena sua própria cópia local e desnormalizada dos dados pertencentes a outros serviços.</span><span class="sxs-lookup"><span data-stu-id="12d02-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="12d02-150">Em vez do microserviço da cesta de compras consultar o catálogo de produtos e os microserviços, ele mantém sua própria cópia local desses dados.</span><span class="sxs-lookup"><span data-stu-id="12d02-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="12d02-151">Esse padrão elimina o acoplamento desnecessário e melhora a confiabilidade e o tempo de resposta.</span><span class="sxs-lookup"><span data-stu-id="12d02-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="12d02-152">A operação inteira é executada dentro de um único processo.</span><span class="sxs-lookup"><span data-stu-id="12d02-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="12d02-153">Exploramos esse padrão e outras preocupações de dados no capítulo 5.</span><span class="sxs-lookup"><span data-stu-id="12d02-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="12d02-154">Padrão de agregador de serviço</span><span class="sxs-lookup"><span data-stu-id="12d02-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="12d02-155">Outra opção para eliminar o acoplamento de microserviço para microserviço é um [microserviço agregador](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), mostrado em roxo na Figura 4-10.</span><span class="sxs-lookup"><span data-stu-id="12d02-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span> 

![Serviço de agregador](./media/aggregator-service.png)

<span data-ttu-id="12d02-157">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="12d02-157">**Figure 4-10**.</span></span> <span data-ttu-id="12d02-158">Microserviço agregador</span><span class="sxs-lookup"><span data-stu-id="12d02-158">Aggregator microservice</span></span>

<span data-ttu-id="12d02-159">O padrão Isola uma operação que faz chamadas para vários microserviços de back-end, centralizando sua lógica em um microserviço especializado.</span><span class="sxs-lookup"><span data-stu-id="12d02-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="12d02-160">O microserviço agregador de check-out roxo na figura anterior orquestra o fluxo de trabalho para a operação de check-out.</span><span class="sxs-lookup"><span data-stu-id="12d02-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="12d02-161">Ele inclui chamadas para vários microserviços de back-end em uma ordem sequenciada.</span><span class="sxs-lookup"><span data-stu-id="12d02-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="12d02-162">Os dados do fluxo de trabalho são agregados e retornados ao chamador.</span><span class="sxs-lookup"><span data-stu-id="12d02-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="12d02-163">Embora ainda implemente chamadas HTTP diretas, o microserviço de agregador reduz as dependências diretas entre os microserviços de back-end.</span><span class="sxs-lookup"><span data-stu-id="12d02-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span> 

### <a name="requestreply-pattern"></a><span data-ttu-id="12d02-164">Padrão de solicitação/resposta</span><span class="sxs-lookup"><span data-stu-id="12d02-164">Request/Reply Pattern</span></span>

<span data-ttu-id="12d02-165">Outra abordagem para desacoplar mensagens HTTP síncronas é um [padrão de solicitação-resposta](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), que usa a comunicação de enfileiramento.</span><span class="sxs-lookup"><span data-stu-id="12d02-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="12d02-166">A comunicação usando uma fila é sempre um canal unidirecional, com um produtor enviando a mensagem e o consumidor recebendo-a.</span><span class="sxs-lookup"><span data-stu-id="12d02-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="12d02-167">Com esse padrão, uma fila de solicitação e uma fila de resposta são implementadas, mostradas na Figura 4-11.</span><span class="sxs-lookup"><span data-stu-id="12d02-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Padrão de solicitação-resposta](./media/request-reply-pattern.png)

<span data-ttu-id="12d02-169">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="12d02-169">**Figure 4-11**.</span></span> <span data-ttu-id="12d02-170">Padrão de solicitação-resposta</span><span class="sxs-lookup"><span data-stu-id="12d02-170">Request-reply pattern</span></span>

<span data-ttu-id="12d02-171">Aqui, o produtor da mensagem cria uma mensagem baseada em consulta que contém uma ID de correlação exclusiva e a coloca em uma fila de solicitação.</span><span class="sxs-lookup"><span data-stu-id="12d02-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="12d02-172">O serviço de consumo removerá as mensagens da fila, processará e colocará a resposta na fila de respostas com a mesma ID de correlação.</span><span class="sxs-lookup"><span data-stu-id="12d02-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="12d02-173">O serviço produtor removerá a mensagem da fila, a corresponderá com a ID de correlação e continuará o processamento.</span><span class="sxs-lookup"><span data-stu-id="12d02-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="12d02-174">Abordaremos as filas detalhadamente na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="12d02-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="12d02-175">Comandos</span><span class="sxs-lookup"><span data-stu-id="12d02-175">Commands</span></span>

<span data-ttu-id="12d02-176">Outro tipo de interação de comunicação é um *comando*.</span><span class="sxs-lookup"><span data-stu-id="12d02-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="12d02-177">Um microserviço pode precisar de outro microserviço para executar uma ação.</span><span class="sxs-lookup"><span data-stu-id="12d02-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="12d02-178">O microserviço de pedidos pode precisar do microserviço de envio para criar uma remessa para uma ordem aprovada.</span><span class="sxs-lookup"><span data-stu-id="12d02-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="12d02-179">Na Figura 4-12, um microserviço, chamado produtor, envia uma mensagem para outro microserviço, o consumidor, o comando para fazer algo.</span><span class="sxs-lookup"><span data-stu-id="12d02-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span> 

![Interação do comando com uma fila](./media/command-interaction-with-queue.png)

<span data-ttu-id="12d02-181">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="12d02-181">**Figure 4-12**.</span></span> <span data-ttu-id="12d02-182">Interação do comando com uma fila</span><span class="sxs-lookup"><span data-stu-id="12d02-182">Command interaction with a queue</span></span>

<span data-ttu-id="12d02-183">Geralmente, o produtor não requer uma resposta e pode *acionar e esquecer* a mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="12d02-184">Se uma resposta for necessária, o consumidor enviará uma mensagem separada de volta para o produtor em outro canal.</span><span class="sxs-lookup"><span data-stu-id="12d02-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="12d02-185">Uma mensagem de comando é melhor enviada de forma assíncrona com uma fila de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="12d02-186">com suporte de um agente de mensagem leve.</span><span class="sxs-lookup"><span data-stu-id="12d02-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="12d02-187">No diagrama anterior, observe como uma fila separa e dissocia os dois serviços.</span><span class="sxs-lookup"><span data-stu-id="12d02-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="12d02-188">Uma fila de mensagens é uma construção intermediária por meio da qual um produtor e um consumidor passam uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="12d02-189">As filas implementam um padrão de mensagens assíncronas de ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="12d02-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="12d02-190">O produtor sabe onde um comando precisa ser enviado e direcionado adequadamente.</span><span class="sxs-lookup"><span data-stu-id="12d02-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="12d02-191">A fila garante que uma mensagem seja processada por exatamente uma das instâncias de consumidor que estão sendo lidas do canal.</span><span class="sxs-lookup"><span data-stu-id="12d02-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="12d02-192">Nesse cenário, o produtor ou o serviço de consumidor pode escalar horizontalmente sem afetar o outro.</span><span class="sxs-lookup"><span data-stu-id="12d02-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="12d02-193">Além disso, as tecnologias podem ser diferentes em cada lado, o que significa que poderemos ter um microserviço Java chamando um microserviço do [Golang](https://golang.org) .</span><span class="sxs-lookup"><span data-stu-id="12d02-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span> 

<span data-ttu-id="12d02-194">No capítulo 1, falamos sobre os *serviços de backup*.</span><span class="sxs-lookup"><span data-stu-id="12d02-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="12d02-195">Os serviços de backup são recursos complementares dos quais os sistemas nativos de nuvem dependem.</span><span class="sxs-lookup"><span data-stu-id="12d02-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="12d02-196">As filas de mensagens estão fazendo serviços de backup.</span><span class="sxs-lookup"><span data-stu-id="12d02-196">Message queues are backing services.</span></span> <span data-ttu-id="12d02-197">A nuvem do Azure dá suporte a dois tipos de filas de mensagens que seus sistemas nativos de nuvem podem consumir para implementar o sistema de mensagens de comando: Filas do armazenamento do Azure e filas do barramento de serviço do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="12d02-198">Filas do armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-198">Azure Storage Queues</span></span>

<span data-ttu-id="12d02-199">As filas do armazenamento do Azure oferecem uma infraestrutura de fila simples que é rápida, acessível e apoiada pelas contas de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="12d02-200">As [filas do armazenamento do Azure](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) apresentam um mecanismo de enfileiramento baseado em REST com mensagens confiáveis e persistentes.</span><span class="sxs-lookup"><span data-stu-id="12d02-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="12d02-201">Eles fornecem um conjunto mínimo de recursos, mas são baratos e armazenam milhões de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="12d02-202">Sua capacidade varia até 500 TB.</span><span class="sxs-lookup"><span data-stu-id="12d02-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="12d02-203">Uma única mensagem pode ter até 64 KB de tamanho.</span><span class="sxs-lookup"><span data-stu-id="12d02-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="12d02-204">Você pode acessar mensagens de qualquer lugar do mundo por meio de chamadas autenticadas usando HTTP ou HTTPS.</span><span class="sxs-lookup"><span data-stu-id="12d02-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="12d02-205">As filas de armazenamento podem ser expandidas para um grande número de clientes simultâneos para lidar com picos de tráfego.</span><span class="sxs-lookup"><span data-stu-id="12d02-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="12d02-206">Dito isso, há limitações com o serviço:</span><span class="sxs-lookup"><span data-stu-id="12d02-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="12d02-207">A ordem da mensagem não é garantida.</span><span class="sxs-lookup"><span data-stu-id="12d02-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="12d02-208">Uma mensagem só pode persistir por sete dias antes de ser removida automaticamente.</span><span class="sxs-lookup"><span data-stu-id="12d02-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="12d02-209">O suporte para gerenciamento de estado, detecção de duplicidades ou transações não está disponível.</span><span class="sxs-lookup"><span data-stu-id="12d02-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="12d02-210">A Figura 4-13 mostra a hierarquia de uma fila de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Hierarquia da fila de armazenamento](./media/storage-queue-hierarchy.png)

<span data-ttu-id="12d02-212">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="12d02-212">**Figure 4-13**.</span></span> <span data-ttu-id="12d02-213">Hierarquia da fila de armazenamento</span><span class="sxs-lookup"><span data-stu-id="12d02-213">Storage queue hierarchy</span></span>

<span data-ttu-id="12d02-214">Na figura anterior, observe como as filas de armazenamento armazenam suas mensagens na conta de armazenamento do Azure subjacente.</span><span class="sxs-lookup"><span data-stu-id="12d02-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="12d02-215">Para desenvolvedores, a Microsoft fornece várias bibliotecas do cliente e do lado do servidor para o processamento da fila de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="12d02-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="12d02-216">Há suporte para a maioria das principais plataformas, incluindo .NET, Java, JavaScript, Ruby, Python e go.</span><span class="sxs-lookup"><span data-stu-id="12d02-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="12d02-217">Os desenvolvedores nunca devem se comunicar diretamente com essas bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="12d02-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="12d02-218">Isso irá acoplar rigidamente o código de seu microserviço ao serviço Fila de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="12d02-219">É uma prática melhor isolar os detalhes de implementação da API.</span><span class="sxs-lookup"><span data-stu-id="12d02-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="12d02-220">Introduza uma camada de intermediação ou uma API intermediária, que expõe operações genéricas e encapsula a biblioteca concreta.</span><span class="sxs-lookup"><span data-stu-id="12d02-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="12d02-221">Esse acoplamento flexível permite que você troque um serviço de enfileiramento para outro sem precisar fazer alterações no código de serviço principal.</span><span class="sxs-lookup"><span data-stu-id="12d02-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span> 

<span data-ttu-id="12d02-222">As filas do armazenamento do Azure são uma opção econômica para implementar mensagens de comando em seus aplicativos nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="12d02-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="12d02-223">Especialmente quando um tamanho de fila exceder 80 GB ou um conjunto de recursos simples é aceitável.</span><span class="sxs-lookup"><span data-stu-id="12d02-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="12d02-224">Você paga apenas pelo armazenamento das mensagens; Não há encargos fixos por hora.</span><span class="sxs-lookup"><span data-stu-id="12d02-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="12d02-225">Filas do barramento de serviço do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="12d02-226">Para requisitos de mensagens mais complexos, considere as filas do barramento de serviço do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="12d02-227">Sentado em uma infra-estrutura de mensagens robusta, o [barramento de serviço do Azure](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) dá suporte a um *modelo de mensagens orientadas*.</span><span class="sxs-lookup"><span data-stu-id="12d02-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="12d02-228">As mensagens são armazenadas de forma confiável em um agente (a fila) até serem recebidas pelo consumidor.</span><span class="sxs-lookup"><span data-stu-id="12d02-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="12d02-229">A fila garante a entrega de mensagem PEPS (primeiro a entrar/primeiro a sair), respeitando a ordem na qual as mensagens foram adicionadas à fila.</span><span class="sxs-lookup"><span data-stu-id="12d02-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="12d02-230">O tamanho de uma mensagem pode ser muito maior, até 256 KB.</span><span class="sxs-lookup"><span data-stu-id="12d02-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="12d02-231">As mensagens são mantidas na fila por um período de tempo ilimitado.</span><span class="sxs-lookup"><span data-stu-id="12d02-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="12d02-232">O barramento de serviço dá suporte a chamadas não apenas baseadas em HTTP, mas também fornece suporte completo para o [protocolo AMPQ](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span><span class="sxs-lookup"><span data-stu-id="12d02-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMPQ protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="12d02-233">O AMPQ é um padrão aberto entre os fornecedores que oferece suporte a um protocolo binário e a níveis mais altos de confiabilidade.</span><span class="sxs-lookup"><span data-stu-id="12d02-233">AMPQ is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="12d02-234">O barramento de serviço fornece um conjunto avançado de recursos, incluindo [suporte a transações](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) e um recurso de [detecção de duplicidades](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span><span class="sxs-lookup"><span data-stu-id="12d02-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="12d02-235">A fila garante "no máximo uma vez na entrega" por mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="12d02-236">Ele descarta automaticamente uma mensagem que já foi enviada.</span><span class="sxs-lookup"><span data-stu-id="12d02-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="12d02-237">Se um produtor estiver em dúvida, ele poderá reenviar a mesma mensagem, e o barramento de serviço garante que apenas uma cópia será processada.</span><span class="sxs-lookup"><span data-stu-id="12d02-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="12d02-238">A detecção de duplicidades libera você de ter que criar o direcionamento de infraestrutura adicional.</span><span class="sxs-lookup"><span data-stu-id="12d02-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="12d02-239">Mais dois recursos corporativos são particionamento e sessões.</span><span class="sxs-lookup"><span data-stu-id="12d02-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="12d02-240">Uma fila convencional do barramento de serviço é tratada por um único agente de mensagem e armazenada em um único repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="12d02-241">Mas, o [particionamento do barramento de serviço](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) espalha a fila entre vários agentes de mensagens e repositórios de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="12d02-242">A taxa de transferência geral não é mais limitada pelo desempenho de um único agente de mensagens ou repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="12d02-243">Uma interrupção temporária de um repositório de mensagens não torna uma fila particionada indisponível.</span><span class="sxs-lookup"><span data-stu-id="12d02-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="12d02-244">As [sessões do barramento de serviço](https://codingcanvas.com/azure-service-bus-sessions/) fornecem uma maneira de agrupar mensagens relacionadas.</span><span class="sxs-lookup"><span data-stu-id="12d02-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="12d02-245">Imagine um cenário de fluxo de trabalho em que as mensagens devem ser processadas em conjunto e a operação seja concluída no final.</span><span class="sxs-lookup"><span data-stu-id="12d02-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="12d02-246">Para tirar proveito, as sessões devem ser explicitamente habilitadas para a fila e cada mensagem relacionada deve conter a mesma ID de sessão.</span><span class="sxs-lookup"><span data-stu-id="12d02-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="12d02-247">No entanto, há algumas advertências importantes: O tamanho das filas do barramento de serviço é limitado a 80 GB, o que é muito menor do que o que está disponível nas filas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="12d02-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="12d02-248">Além disso, as filas do barramento de serviço incorrem em custo base e cobrança por operação.</span><span class="sxs-lookup"><span data-stu-id="12d02-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="12d02-249">A Figura 4-14 descreve a arquitetura de alto nível de uma fila do barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="12d02-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![Fila do barramento de serviço](./media/service-bus-queue.png)

<span data-ttu-id="12d02-251">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="12d02-251">**Figure 4-14**.</span></span> <span data-ttu-id="12d02-252">Fila do barramento de serviço</span><span class="sxs-lookup"><span data-stu-id="12d02-252">Service Bus queue</span></span>

<span data-ttu-id="12d02-253">Na figura anterior, observe a relação ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="12d02-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="12d02-254">Duas instâncias do mesmo provedor estão enfileirando mensagens em uma única fila do barramento de serviço.</span><span class="sxs-lookup"><span data-stu-id="12d02-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="12d02-255">Cada mensagem é consumida por apenas uma das três instâncias de consumidor à direita.</span><span class="sxs-lookup"><span data-stu-id="12d02-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="12d02-256">Em seguida, discutiremos como implementar mensagens em que diferentes consumidores podem estar interessados na mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="12d02-257">Eventos</span><span class="sxs-lookup"><span data-stu-id="12d02-257">Events</span></span>

<span data-ttu-id="12d02-258">O enfileiramento de mensagens é uma maneira eficaz de implementar a comunicação em que um produtor pode enviar uma mensagem por um consumidor de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="12d02-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="12d02-259">No entanto, o que acontece quando *muitos consumidores diferentes* estão interessados na mesma mensagem?</span><span class="sxs-lookup"><span data-stu-id="12d02-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="12d02-260">Uma fila de mensagens dedicada para cada consumidor não pode ser bem dimensionada e seria difícil de gerenciar.</span><span class="sxs-lookup"><span data-stu-id="12d02-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span> 

<span data-ttu-id="12d02-261">Para resolver esse cenário, mudamos para o terceiro tipo de interação de mensagem, o *evento*.</span><span class="sxs-lookup"><span data-stu-id="12d02-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="12d02-262">Um microserviço anuncia que uma ação ocorreu.</span><span class="sxs-lookup"><span data-stu-id="12d02-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="12d02-263">Outros microserviços, se estiverem interessados, reagir à ação ou ao evento.</span><span class="sxs-lookup"><span data-stu-id="12d02-263">Other microservices, if interested, react to the action, or event.</span></span> 

<span data-ttu-id="12d02-264">O evento é um processo de duas etapas.</span><span class="sxs-lookup"><span data-stu-id="12d02-264">Eventing is a two-step process.</span></span> <span data-ttu-id="12d02-265">Para uma determinada alteração de estado, um microserviço publica um evento em um agente de mensagem, disponibilizando-o para qualquer outro microserviço interessado.</span><span class="sxs-lookup"><span data-stu-id="12d02-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="12d02-266">O microserviço interessado é notificado pela assinatura do evento no agente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="12d02-267">Você usa o padrão de [publicação/assinatura](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) para implementar a [comunicação baseada em eventos](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span><span class="sxs-lookup"><span data-stu-id="12d02-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="12d02-268">A Figura 4-15 mostra um microserviço de cesta de compras publicando um evento com dois outros microservices assinando-o.</span><span class="sxs-lookup"><span data-stu-id="12d02-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Mensagens controladas por eventos](./media/event-driven-messaging.png)

<span data-ttu-id="12d02-270">**Figura 4-15**.</span><span class="sxs-lookup"><span data-stu-id="12d02-270">**Figure 4-15**.</span></span> <span data-ttu-id="12d02-271">Mensagens controladas por eventos</span><span class="sxs-lookup"><span data-stu-id="12d02-271">Event-Driven messaging</span></span>

<span data-ttu-id="12d02-272">Observe o componente de *barramento de evento* que fica no meio do canal de comunicação.</span><span class="sxs-lookup"><span data-stu-id="12d02-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="12d02-273">É uma classe personalizada que encapsula o agente de mensagem e o dissocia do aplicativo subjacente.</span><span class="sxs-lookup"><span data-stu-id="12d02-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="12d02-274">Os microserviços de pedidos e de inventário operam de forma independente o evento sem nenhum conhecimento um do outro, nem o microserviço da cesta de compras.</span><span class="sxs-lookup"><span data-stu-id="12d02-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="12d02-275">Quando o evento registrado é publicado no barramento de evento, eles agem sobre ele.</span><span class="sxs-lookup"><span data-stu-id="12d02-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="12d02-276">Com eventos, mudamos da tecnologia de enfileiramento para *Tópicos*.</span><span class="sxs-lookup"><span data-stu-id="12d02-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="12d02-277">Um [tópico](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) é semelhante a uma fila, mas dá suporte a um padrão de mensagens de um-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="12d02-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="12d02-278">Um microserviço publica uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-278">One microservice publishes a message.</span></span> <span data-ttu-id="12d02-279">Vários microserviços de assinatura podem optar por receber e agir sobre essa mensagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="12d02-280">A Figura 4-16 mostra uma arquitetura de tópico.</span><span class="sxs-lookup"><span data-stu-id="12d02-280">Figure 4-16 shows a topic architecture.</span></span>

![Arquitetura do tópico](./media/topic-architecture.png)

<span data-ttu-id="12d02-282">**Figura 4-16**.</span><span class="sxs-lookup"><span data-stu-id="12d02-282">**Figure 4-16**.</span></span> <span data-ttu-id="12d02-283">Arquitetura do tópico</span><span class="sxs-lookup"><span data-stu-id="12d02-283">Topic architecture</span></span>

<span data-ttu-id="12d02-284">Na figura anterior, os editores enviam mensagens para o tópico.</span><span class="sxs-lookup"><span data-stu-id="12d02-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="12d02-285">No final, os assinantes recebem mensagens de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="12d02-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="12d02-286">No meio, o tópico encaminha mensagens para assinaturas com base em um conjunto de *regras*, mostrado em caixas azuis escuras.</span><span class="sxs-lookup"><span data-stu-id="12d02-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="12d02-287">As regras atuam como um filtro que encaminha mensagens específicas para uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="12d02-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="12d02-288">Aqui, um evento "CreateOrder" seria enviado à assinatura \#1 e à assinatura \#3, mas não à assinatura \#2.</span><span class="sxs-lookup"><span data-stu-id="12d02-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="12d02-289">Um evento "OrderCompleted" seria enviado para a assinatura \#2 e a \#assinatura 3.</span><span class="sxs-lookup"><span data-stu-id="12d02-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="12d02-290">A nuvem do Azure dá suporte a dois serviços de tópico diferentes: Tópicos do barramento de serviço do Azure e EventGrid do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="12d02-291">Tópicos do barramento de serviço do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="12d02-292">A parte superior do mesmo modelo robusto de mensagens orientadas das filas do barramento de serviço do Azure são os [Tópicos do barramento de serviço do Azure](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="12d02-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="12d02-293">Um tópico pode receber mensagens de vários Publicadores independentes e enviar mensagens para até 2.000 assinantes.</span><span class="sxs-lookup"><span data-stu-id="12d02-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="12d02-294">As assinaturas podem ser adicionadas ou removidas dinamicamente no tempo de execução sem interromper o sistema ou recriar o tópico.</span><span class="sxs-lookup"><span data-stu-id="12d02-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="12d02-295">Muitos recursos avançados das filas do barramento de serviço do Azure também estão disponíveis para tópicos, incluindo [detecção de duplicidades](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) e [suporte a transações](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="12d02-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="12d02-296">Por padrão, os tópicos do barramento de serviço são tratados por um único agente de mensagem e armazenados em um único repositório de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="12d02-297">Mas, o [particionamento do barramento de serviço](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) dimensiona um tópico distribuindo-o em vários agentes de mensagens e armazenamentos de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="12d02-298">A [entrega de mensagem agendada](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) marca uma mensagem com um horário específico para processamento.</span><span class="sxs-lookup"><span data-stu-id="12d02-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="12d02-299">A mensagem não aparecerá no tópico antes dessa hora.</span><span class="sxs-lookup"><span data-stu-id="12d02-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="12d02-300">O [adiamento de mensagens](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) permite adiar uma recuperação de uma mensagem para um momento posterior.</span><span class="sxs-lookup"><span data-stu-id="12d02-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="12d02-301">Ambos são comumente usados em cenários de processamento de fluxo de trabalho em que as operações são processadas em uma ordem específica.</span><span class="sxs-lookup"><span data-stu-id="12d02-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="12d02-302">Você pode adiar o processamento de mensagens recebidas até que o trabalho anterior tenha sido concluído.</span><span class="sxs-lookup"><span data-stu-id="12d02-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="12d02-303">Os tópicos do barramento de serviço são uma tecnologia robusta e comprovada para habilitar a comunicação de publicação/assinatura em seus sistemas nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="12d02-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="12d02-304">Grade de Eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-304">Azure Event Grid</span></span>

<span data-ttu-id="12d02-305">Embora o barramento de serviço do Azure seja um agente de mensagens testado por batalha com um conjunto completo de recursos corporativos, a [grade de eventos do Azure](https://docs.microsoft.com/azure/event-grid/overview) é a nova criança no bloco.</span><span class="sxs-lookup"><span data-stu-id="12d02-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="12d02-306">À primeira vista, a grade de eventos pode parecer apenas com outro sistema de mensagens baseado em tópico.</span><span class="sxs-lookup"><span data-stu-id="12d02-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="12d02-307">No entanto, ele é diferente de várias maneiras.</span><span class="sxs-lookup"><span data-stu-id="12d02-307">However, it's different in many ways.</span></span> <span data-ttu-id="12d02-308">Focado em cargas de trabalho controladas por eventos, ele permite o processamento de eventos em tempo real, a profunda integração do Azure e uma plataforma aberta em uma infraestrutura sem servidor.</span><span class="sxs-lookup"><span data-stu-id="12d02-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="12d02-309">Ele foi projetado para aplicativos contemporâneos de nuvem e nativas para servidores</span><span class="sxs-lookup"><span data-stu-id="12d02-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="12d02-310">Como um *replano de evento*centralizado, ou pipe, a grade de eventos reage a eventos dentro dos recursos do Azure e de seus próprios serviços.</span><span class="sxs-lookup"><span data-stu-id="12d02-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="12d02-311">As notificações de eventos são publicadas em um tópico da grade de eventos que, por sua vez, roteia cada evento para uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="12d02-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="12d02-312">Os assinantes mapeiam para assinaturas e consomem os eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="12d02-313">Assim como o barramento de serviço, a grade de eventos dá suporte a um *modelo de assinante filtrado* em que uma assinatura define a regra para os eventos que deseja receber.</span><span class="sxs-lookup"><span data-stu-id="12d02-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="12d02-314">A grade de eventos fornece uma taxa de transferência rápida com uma garantia de 10 milhões eventos por segundo, permitindo entrega quase em tempo real – muito mais do que o barramento de serviço do Azure pode gerar.</span><span class="sxs-lookup"><span data-stu-id="12d02-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="12d02-315">Um ponto ideal para a grade de eventos é sua integração profunda com a malha da infraestrutura do Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="12d02-316">Um recurso do Azure, como o Cosmos DB, pode publicar eventos internos diretamente em outros recursos interessados do Azure, sem a necessidade de código personalizado.</span><span class="sxs-lookup"><span data-stu-id="12d02-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="12d02-317">A grade de eventos pode publicar eventos de uma assinatura do Azure, grupo de recursos ou serviço, proporcionando aos desenvolvedores um controle refinado sobre o ciclo de vida dos recursos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="12d02-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="12d02-318">No entanto, a grade de eventos não está limitada ao Azure.</span><span class="sxs-lookup"><span data-stu-id="12d02-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="12d02-319">É uma plataforma aberta que pode consumir eventos HTTP personalizados publicados de aplicativos ou serviços de terceiros e rotear eventos para assinantes externos.</span><span class="sxs-lookup"><span data-stu-id="12d02-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="12d02-320">Ao publicar e assinar eventos nativos de recursos do Azure, nenhuma codificação é necessária.</span><span class="sxs-lookup"><span data-stu-id="12d02-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="12d02-321">Com a configuração simples, você pode integrar eventos de um recurso do Azure para outro, aproveitando o direcionamento interno para tópicos e assinaturas.</span><span class="sxs-lookup"><span data-stu-id="12d02-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="12d02-322">A Figura 4-17 mostra a anatomia da grade de eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Anatomia da grade de eventos](./media/event-grid-anatomy.png)

<span data-ttu-id="12d02-324">**Figura 4-17**.</span><span class="sxs-lookup"><span data-stu-id="12d02-324">**Figure 4-17**.</span></span> <span data-ttu-id="12d02-325">Anatomia da grade de eventos</span><span class="sxs-lookup"><span data-stu-id="12d02-325">Event Grid anatomy</span></span>

<span data-ttu-id="12d02-326">Uma grande diferença entre o EventGrid e o barramento de serviço é o *padrão de troca de mensagens*subjacente.</span><span class="sxs-lookup"><span data-stu-id="12d02-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="12d02-327">O barramento de serviço implementa um *modelo de pull* de estilo mais antigo no qual o assinante downstream sonda ativamente a assinatura do tópico em busca de novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="12d02-328">Na cabeça, essa abordagem dá ao Assinante controle total do ritmo no qual ele processa as mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="12d02-329">Ele controla quando e quantas mensagens são processadas em um determinado momento.</span><span class="sxs-lookup"><span data-stu-id="12d02-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="12d02-330">As mensagens não lidas permanecem na assinatura até que sejam processadas.</span><span class="sxs-lookup"><span data-stu-id="12d02-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="12d02-331">Uma deficiência significativa é a latência entre a hora em que o evento é gerado e a operação de sondagem que efetua pull dessa mensagem para o Assinante para processamento.</span><span class="sxs-lookup"><span data-stu-id="12d02-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="12d02-332">Além disso, a sobrecarga de sondagem constante para o próximo evento consome recursos e dinheiro.</span><span class="sxs-lookup"><span data-stu-id="12d02-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="12d02-333">EventGrid, no entanto, é diferente.</span><span class="sxs-lookup"><span data-stu-id="12d02-333">EventGrid, however, is different.</span></span> <span data-ttu-id="12d02-334">Ele implementa um *modelo de push* no qual os eventos são enviados para os EventHandlers como recebidos, fornecendo entrega de eventos quase em tempo real.</span><span class="sxs-lookup"><span data-stu-id="12d02-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="12d02-335">Ele também reduz o custo, pois o serviço é disparado apenas quando é necessário consumir um evento – não continuamente, assim como acontece com a sondagem.</span><span class="sxs-lookup"><span data-stu-id="12d02-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="12d02-336">Dito isso, um manipulador de eventos deve lidar com a carga de entrada e fornecer mecanismos de limitação para se proteger contra sobrecarregar.</span><span class="sxs-lookup"><span data-stu-id="12d02-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="12d02-337">Muitos serviços do Azure que consomem esses eventos, como Azure Functions e aplicativos lógicos, fornecem recursos automáticos de AutoEscala para lidar com cargas maiores.</span><span class="sxs-lookup"><span data-stu-id="12d02-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="12d02-338">A grade de eventos é um serviço de nuvem sem servidor totalmente gerenciado.</span><span class="sxs-lookup"><span data-stu-id="12d02-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="12d02-339">Ele é dimensionado dinamicamente com base no seu tráfego e cobra você apenas pelo uso real, não pela capacidade adquirida previamente.</span><span class="sxs-lookup"><span data-stu-id="12d02-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="12d02-340">As primeiras 100.000 operações por mês são gratuitas – operações que estão sendo definidas como entrada de evento (notificações de eventos de entrada), tentativas de entrega de assinatura, chamadas de gerenciamento e filtragem por assunto.</span><span class="sxs-lookup"><span data-stu-id="12d02-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="12d02-341">Com a disponibilidade de 99,99%, o EventGrid garante a entrega de um evento dentro de um período de 24 horas, com funcionalidade de repetição interna para entrega sem êxito.</span><span class="sxs-lookup"><span data-stu-id="12d02-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="12d02-342">As mensagens não entregues podem ser movidas para uma fila de "mensagens mortas" para resolução.</span><span class="sxs-lookup"><span data-stu-id="12d02-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="12d02-343">Ao contrário do barramento de serviço do Azure, a grade de eventos é ajustada para desempenho rápido e não oferece suporte a recursos como mensagens ordenadas, transações e sessões.</span><span class="sxs-lookup"><span data-stu-id="12d02-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="12d02-344">Transmissão de mensagens na nuvem do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="12d02-345">O barramento de serviço do Azure e a grade de eventos fornecem excelente suporte para aplicativos que expõem eventos únicos e discretos, como um novo documento inserido em um Cosmos DB).</span><span class="sxs-lookup"><span data-stu-id="12d02-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document been inserted into a Cosmos DB).</span></span> <span data-ttu-id="12d02-346">Mas e se o seu sistema nativo de nuvem precisar processar um *fluxo de eventos relacionados*?</span><span class="sxs-lookup"><span data-stu-id="12d02-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="12d02-347">Os [fluxos de eventos](https://msdn.microsoft.com/magazine/dn904671.aspx?f=255&MSPPError=-2147217396) são mais complexos.</span><span class="sxs-lookup"><span data-stu-id="12d02-347">[Event streams](https://msdn.microsoft.com/magazine/dn904671.aspx?f=255&MSPPError=-2147217396) are more complex.</span></span> <span data-ttu-id="12d02-348">Normalmente, eles são ordenados por tempo, inter-relacionados e devem ser processados como um grupo.</span><span class="sxs-lookup"><span data-stu-id="12d02-348">They're typically time-ordered, interrelated and must be processed as a group.</span></span>

<span data-ttu-id="12d02-349">O [Hub de eventos do Azure](https://azure.microsoft.com/services/event-hubs/) é uma plataforma de streaming de dados e um serviço de ingestão de eventos que coleta, transforma e armazena eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="12d02-350">Ele é ajustado para capturar dados de streaming, como notificações de eventos contínuos emitidas de um contexto de telemetria.</span><span class="sxs-lookup"><span data-stu-id="12d02-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="12d02-351">O serviço é altamente escalonável e pode armazenar e [processar milhões de eventos por segundo](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span><span class="sxs-lookup"><span data-stu-id="12d02-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="12d02-352">Mostrado na Figura 4-18, geralmente é uma porta frontal para um pipeline de eventos, desacoplando o fluxo de ingestão do consumo de eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Hub de eventos do Azure](./media/azure-event-hub.png)

<span data-ttu-id="12d02-354">**Figura 4-18**.</span><span class="sxs-lookup"><span data-stu-id="12d02-354">**Figure 4-18**.</span></span> <span data-ttu-id="12d02-355">Hub de eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="12d02-355">Azure Event Hub</span></span>

<span data-ttu-id="12d02-356">O Hub de eventos dá suporte à baixa latência e à retenção de tempo configurável.</span><span class="sxs-lookup"><span data-stu-id="12d02-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="12d02-357">Ao contrário das filas e dos tópicos, os hubs de eventos mantêm os dados do evento depois que eles são lidos por um consumidor.</span><span class="sxs-lookup"><span data-stu-id="12d02-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="12d02-358">Esse recurso permite que outros serviços analíticos de dados, internos e externos, reproduza os dados para análise posterior.</span><span class="sxs-lookup"><span data-stu-id="12d02-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="12d02-359">Os eventos armazenados no Hub de eventos são excluídos somente após a expiração do período de retenção, que é um dia por padrão, mas configurável.</span><span class="sxs-lookup"><span data-stu-id="12d02-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="12d02-360">O Hub de eventos dá suporte a protocolos comuns de publicação de eventos, incluindo HTTPS e AMQP.</span><span class="sxs-lookup"><span data-stu-id="12d02-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="12d02-361">Ele também dá suporte a Kafka 1,0.</span><span class="sxs-lookup"><span data-stu-id="12d02-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="12d02-362">Os [aplicativos Kafka existentes podem se comunicar com o Hub de eventos](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) usando o protocolo Kafka, fornecendo uma alternativa ao gerenciamento de clusters grandes do Kafka.</span><span class="sxs-lookup"><span data-stu-id="12d02-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="12d02-363">Muitos sistemas de código aberto em nuvem nativas adotam o Kafka.</span><span class="sxs-lookup"><span data-stu-id="12d02-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="12d02-364">Os hubs de eventos implementam o streaming de mensagens por meio de um [modelo de consumidor particionado](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) no qual cada consumidor lê apenas um subconjunto específico, ou partição, do fluxo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="12d02-365">Esse padrão permite uma enorme escala horizontal para processamento de eventos e fornece outros recursos voltados para o fluxo que não estão disponíveis em filas e tópicos.</span><span class="sxs-lookup"><span data-stu-id="12d02-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="12d02-366">Uma partição é uma sequência ordenada de eventos que é mantida em um hub de eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="12d02-367">À medida que os eventos mais recentes chegam, eles são adicionados ao final dessa sequência.</span><span class="sxs-lookup"><span data-stu-id="12d02-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="12d02-368"> A Figura 4-19 mostra o particionamento em um hub de eventos.</span><span class="sxs-lookup"><span data-stu-id="12d02-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Particionamento do hub de eventos](./media/event-hub-partitioning.png)

<span data-ttu-id="12d02-370">**Figura 4-19**.</span><span class="sxs-lookup"><span data-stu-id="12d02-370">**Figure 4-19**.</span></span> <span data-ttu-id="12d02-371">Particionamento do hub de eventos</span><span class="sxs-lookup"><span data-stu-id="12d02-371">Event Hub partitioning</span></span>

<span data-ttu-id="12d02-372">Em vez de ler do mesmo recurso, cada grupo de consumidores lê em um subconjunto, ou partição, do fluxo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="12d02-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span> 

<span data-ttu-id="12d02-373">Para aplicativos nativos de nuvem que devem transmitir um grande número de eventos, o Hub de eventos do Azure pode ser uma solução robusta e acessível.</span><span class="sxs-lookup"><span data-stu-id="12d02-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="12d02-374">[Anterior](front-end-communication.md)
>[Próximo](rest-grpc.md)</span><span class="sxs-lookup"><span data-stu-id="12d02-374">[Previous](front-end-communication.md)
[Next](rest-grpc.md)</span></span>
