---
title: Infraestrutura de comunicação de malha de serviço
description: Saiba mais sobre como as tecnologias de malha de serviço simplificam a comunicação de microserviço nativa na nuvem
author: robvet
ms.date: 09/10/2019
ms.openlocfilehash: dc9237197732ea622aad726583140623b0a5a4f4
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/23/2019
ms.locfileid: "71184781"
---
# <a name="service-mesh-communication-infrastructure"></a><span data-ttu-id="d039f-103">Infraestrutura de comunicação de malha de serviço</span><span class="sxs-lookup"><span data-stu-id="d039f-103">Service Mesh communication infrastructure</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="d039f-104">Ao longo deste capítulo, exploramos os desafios da comunicação de microserviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-104">Throughout this chapter, we've explored the challenges of microservice communication.</span></span> <span data-ttu-id="d039f-105">Dissemos que as equipes de desenvolvimento precisam ser sensíveis à forma como os serviços de back-end se comunicam entre si.</span><span class="sxs-lookup"><span data-stu-id="d039f-105">We said that development teams need to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="d039f-106">Idealmente, quanto menos comunicação entre serviços, melhor.</span><span class="sxs-lookup"><span data-stu-id="d039f-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="d039f-107">No entanto, evitar nem sempre é possível, pois os serviços de back-end muitas vezes dependem uns dos outros para concluir as operações.</span><span class="sxs-lookup"><span data-stu-id="d039f-107">However, avoidance isn't always possible as back-end services often rely on one another to complete operations.</span></span>

<span data-ttu-id="d039f-108">Exploramos abordagens diferentes para implementar comunicação HTTP síncrona e mensagens assíncronas.</span><span class="sxs-lookup"><span data-stu-id="d039f-108">We explored different approaches for implementing synchronous HTTP communication and asynchronous messaging.</span></span> <span data-ttu-id="d039f-109">Em cada um dos casos, o desenvolvedor está sobrecarregado com a implementação do código de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d039f-109">In each of the cases, the developer is burdened with implementing communication code.</span></span> <span data-ttu-id="d039f-110">O código de comunicação é complexo e demorado.</span><span class="sxs-lookup"><span data-stu-id="d039f-110">Communication code is complex and time intensive.</span></span> <span data-ttu-id="d039f-111">Decisões incorretas podem levar a problemas de desempenho significativos.</span><span class="sxs-lookup"><span data-stu-id="d039f-111">Incorrect decisions can lead to significant performance issues.</span></span>

<span data-ttu-id="d039f-112">Uma abordagem mais moderna para os centros de comunicação de microserviço em uma nova e rápida evolução de uma tecnologia de *serviço*qualificada.</span><span class="sxs-lookup"><span data-stu-id="d039f-112">A more modern approach to microservice communication centers around a new and rapidly evolving technology entitled *Service Mesh*.</span></span> <span data-ttu-id="d039f-113">Uma [malha de serviço](https://www.nginx.com/blog/what-is-a-service-mesh/) é uma camada de infraestrutura configurável com recursos internos para lidar com a comunicação de serviço a serviço, resiliência e muitas preocupações abrangentes.</span><span class="sxs-lookup"><span data-stu-id="d039f-113">A [service mesh](https://www.nginx.com/blog/what-is-a-service-mesh/) is a configurable infrastructure layer with built-in capabilities to handle service-to-service communication, resiliency, and many cross-cutting concerns.</span></span> <span data-ttu-id="d039f-114">Ele move a responsabilidade por essas preocupações dos microserviços e da camada de malha de serviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-114">It moves the responsibility for these concerns out of the microservices and into service mesh layer.</span></span> <span data-ttu-id="d039f-115">A comunicação é abstrata fora dos seus microserviços.</span><span class="sxs-lookup"><span data-stu-id="d039f-115">Communication is abstracted away from your microservices.</span></span>

<span data-ttu-id="d039f-116">Um componente-chave de uma malha de serviço é um proxy.</span><span class="sxs-lookup"><span data-stu-id="d039f-116">A key component of a service mesh is a proxy.</span></span> <span data-ttu-id="d039f-117">Em um aplicativo nativo de nuvem, uma instância de um proxy é normalmente colocalizada com cada microserviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-117">In a cloud-native application, an instance of a proxy is typically colocated with each microservice.</span></span> <span data-ttu-id="d039f-118">Enquanto eles são executados em processos separados, os dois estão fortemente vinculados e compartilham o mesmo ciclo de vida.</span><span class="sxs-lookup"><span data-stu-id="d039f-118">While they execute in separate processes, the two are closely linked and share the same lifecycle.</span></span> <span data-ttu-id="d039f-119">Esse padrão, conhecido como o [padrão sidecar](https://docs.microsoft.com/azure/architecture/patterns/sidecar), e é mostrado na Figura 4-23.</span><span class="sxs-lookup"><span data-stu-id="d039f-119">This pattern, known as the [Sidecar pattern](https://docs.microsoft.com/azure/architecture/patterns/sidecar), and is shown in Figure 4-23.</span></span>

![Malha de serviço com um carro lateral](./media/service-mesh-with-side-car.png)

<span data-ttu-id="d039f-121">**Figura 4-23**.</span><span class="sxs-lookup"><span data-stu-id="d039f-121">**Figure 4-23**.</span></span> <span data-ttu-id="d039f-122">Malha de serviço com um carro lateral</span><span class="sxs-lookup"><span data-stu-id="d039f-122">Service mesh with a side car</span></span>

<span data-ttu-id="d039f-123">Observe na figura anterior como as mensagens são interceptadas por um proxy que é executado junto com cada microserviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-123">Note in the previous figure how messages are intercepted by a proxy that runs alongside each microservice.</span></span> <span data-ttu-id="d039f-124">Cada proxy pode ser configurado com regras de tráfego específicas para o microserviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-124">Each proxy can be configured with traffic rules specific to the microservice.</span></span> <span data-ttu-id="d039f-125">Ele compreende mensagens e pode roteá-las entre seus serviços e o mundo exterior.</span><span class="sxs-lookup"><span data-stu-id="d039f-125">It understands messages and can route them across your services and the outside world.</span></span> 

<span data-ttu-id="d039f-126">Juntamente com o gerenciamento de comunicação serviço a serviço, a malha de serviço fornece suporte para descoberta de serviço e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="d039f-126">Along with managing service-to-service communication, the Service Mesh provides support for service discovery and load balancing.</span></span> 

<span data-ttu-id="d039f-127">Uma vez configurado, uma malha de serviço é altamente funcional.</span><span class="sxs-lookup"><span data-stu-id="d039f-127">Once configured, a service mesh is highly functional.</span></span> <span data-ttu-id="d039f-128">A malha recupera um pool de instâncias correspondente de um ponto de extremidade de descoberta de serviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-128">The mesh retrieves a corresponding pool of instances from a service discovery endpoint.</span></span> <span data-ttu-id="d039f-129">Ele envia uma solicitação para uma instância de serviço específica, registrando a latência e o tipo de resposta do resultado.</span><span class="sxs-lookup"><span data-stu-id="d039f-129">It sends a request to a specific service instance, recording the latency and response type of the result.</span></span> <span data-ttu-id="d039f-130">Ele escolhe a instância mais provável de retornar uma resposta rápida com base em diferentes fatores, incluindo a latência observada para solicitações recentes.</span><span class="sxs-lookup"><span data-stu-id="d039f-130">It chooses the instance most likely to return a fast response based on different factors, including the observed latency for recent requests.</span></span>

<span data-ttu-id="d039f-131">Uma malha de serviço gerencia o tráfego, a comunicação e as preocupações de rede no nível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d039f-131">A service mesh manages traffic, communication, and networking concerns at the application level.</span></span> <span data-ttu-id="d039f-132">Ele compreende mensagens e solicitações.</span><span class="sxs-lookup"><span data-stu-id="d039f-132">It understands messages and requests.</span></span> <span data-ttu-id="d039f-133">Uma malha de serviço normalmente se integra a um orquestrador de contêiner.</span><span class="sxs-lookup"><span data-stu-id="d039f-133">A service mesh typically integrates with a container orchestrator.</span></span> <span data-ttu-id="d039f-134">O kubernetes dá suporte a uma arquitetura extensível na qual uma malha de serviço pode ser adicionada.</span><span class="sxs-lookup"><span data-stu-id="d039f-134">Kubernetes supports an extensible architecture in which a service mesh can be added.</span></span>

<span data-ttu-id="d039f-135">No capítulo 6, aprofundamos-se nas tecnologias de malha de serviço, incluindo uma discussão sobre sua arquitetura e implementações de software livre disponíveis.</span><span class="sxs-lookup"><span data-stu-id="d039f-135">In chapter 6, we deep-dive into Service Mesh technologies including a discussion on its architecture and available open-source implementations.</span></span>

## <a name="summary"></a><span data-ttu-id="d039f-136">Resumo</span><span class="sxs-lookup"><span data-stu-id="d039f-136">Summary</span></span>

<span data-ttu-id="d039f-137">Neste capítulo, discutimos padrões de comunicação nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="d039f-137">In this chapter, we discussed cloud-native communication patterns.</span></span> <span data-ttu-id="d039f-138">Começamos examinando como os clientes front-end se comunicam com os microserviços de back-end.</span><span class="sxs-lookup"><span data-stu-id="d039f-138">We started by examining how front-end clients communicate with back-end microservices.</span></span> <span data-ttu-id="d039f-139">Ao longo do caminho, falamos sobre plataformas de gateway de API e comunicação em tempo real.</span><span class="sxs-lookup"><span data-stu-id="d039f-139">Along the way, we talked about API Gateway platforms and real-time communication.</span></span> <span data-ttu-id="d039f-140">Em seguida, vimos como os microserviços se comunicam com outros serviços de back-end.</span><span class="sxs-lookup"><span data-stu-id="d039f-140">We then looked at how microservices communicate with other back-end services.</span></span> <span data-ttu-id="d039f-141">Examinamos a comunicação HTTP síncrona e as mensagens assíncronas entre serviços.</span><span class="sxs-lookup"><span data-stu-id="d039f-141">We looked at both synchronous HTTP communication and asynchronous messaging across services.</span></span> <span data-ttu-id="d039f-142">Abordamos o gRPC, uma tecnologia futura no mundo nativo da nuvem.</span><span class="sxs-lookup"><span data-stu-id="d039f-142">We covered gRPC, an upcoming technology in the cloud-native world.</span></span> <span data-ttu-id="d039f-143">Por fim, apresentamos uma nova e rápida evolução tecnológica qualificada para malha de serviço que pode simplificar a comunicação de microserviço.</span><span class="sxs-lookup"><span data-stu-id="d039f-143">Finally, we introduced a new and rapidly evolving technology entitled Service Mesh that can streamline microservice communication.</span></span> 

<span data-ttu-id="d039f-144">A ênfase especial foi nos serviços gerenciados do Azure que podem ajudar a implementar a comunicação em sistemas nativos de nuvem:</span><span class="sxs-lookup"><span data-stu-id="d039f-144">Special emphasis was on managed Azure services that can help implement communication in cloud-native systems:</span></span>

- [<span data-ttu-id="d039f-145">Aplicativo Azure gateway</span><span class="sxs-lookup"><span data-stu-id="d039f-145">Azure Application Gateway</span></span>](https://docs.microsoft.com/azure/application-gateway/overview)
- [<span data-ttu-id="d039f-146">Gerenciamento de API do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-146">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="d039f-147">Serviço Azure SignalR</span><span class="sxs-lookup"><span data-stu-id="d039f-147">Azure SignalR Service</span></span>](https://azure.microsoft.com/services/signalr-service/)
- [<span data-ttu-id="d039f-148">Filas do armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-148">Azure Storage Queues</span></span>](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction)
- [<span data-ttu-id="d039f-149">Barramento de Serviço do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-149">Azure Service Bus</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview)
- [<span data-ttu-id="d039f-150">Grade de Eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-150">Azure Event Grid</span></span>](https://docs.microsoft.com/azure/event-grid/overview)
- [<span data-ttu-id="d039f-151">Hub de eventos do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-151">Azure Event Hub</span></span>](https://azure.microsoft.com/services/event-hubs/)

<span data-ttu-id="d039f-152">Em seguida, mudamos para os dados distribuídos em sistemas nativos de nuvem e os benefícios e os desafios que ele apresenta.</span><span class="sxs-lookup"><span data-stu-id="d039f-152">We next move to distributed data in cloud-native systems and the benefits and challenges that it presents.</span></span>

### <a name="references"></a><span data-ttu-id="d039f-153">Referências</span><span class="sxs-lookup"><span data-stu-id="d039f-153">References</span></span> 

- [<span data-ttu-id="d039f-154">Microsserviços do .NET: Arquitetura para aplicativos .NET em contêineres</span><span class="sxs-lookup"><span data-stu-id="d039f-154">.NET Microservices: Architecture for Containerized .NET applications</span></span>](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook)
  
- [<span data-ttu-id="d039f-155">Criando comunicação entre serviços para microserviços</span><span class="sxs-lookup"><span data-stu-id="d039f-155">Designing Interservice Communication for Microservices</span></span>](https://docs.microsoft.com/azure/architecture/microservices/design/interservice-communication)

- [<span data-ttu-id="d039f-156">Serviço do Azure Signalr, um serviço totalmente gerenciado para adicionar funcionalidade em tempo real</span><span class="sxs-lookup"><span data-stu-id="d039f-156">Azure SignalR Service, a fully managed service to add real-time functionality</span></span>](https://azure.microsoft.com/blog/azure-signalr-service-a-fully-managed-service-to-add-real-time-functionality/)
  
- [<span data-ttu-id="d039f-157">Controlador de entrada do gateway de API do Azure</span><span class="sxs-lookup"><span data-stu-id="d039f-157">Azure API Gateway Ingress Controller</span></span>](https://azure.github.io/application-gateway-kubernetes-ingress/)
  
- [<span data-ttu-id="d039f-158">Sobre a entrada no serviço de kubernetes do Azure (AKS)</span><span class="sxs-lookup"><span data-stu-id="d039f-158">About Ingress in Azure Kubernetes Service (AKS)</span></span>](https://vincentlauzon.com/2018/10/10/about-ingress-in-azure-kubernetes-service-aks/)
 
- [<span data-ttu-id="d039f-159">GRPC prático</span><span class="sxs-lookup"><span data-stu-id="d039f-159">Practical gRPC</span></span>](https://www.worldcat.org/title/practical-grpc/oclc/1042342319)

- [<span data-ttu-id="d039f-160">Documentação do gRPC</span><span class="sxs-lookup"><span data-stu-id="d039f-160">gRPC Documentation</span></span>](https://grpc.io/docs/guides/)

- <span data-ttu-id="d039f-161">[gRPC para desenvolvedores do WCF](https://bing.com) [Livro de gRPC do Mark]</span><span class="sxs-lookup"><span data-stu-id="d039f-161">[gRPC for WCF Developers](https://bing.com) [Mark's gRPC book]</span></span>
  
- [<span data-ttu-id="d039f-162">Comparando serviços gRPCs com APIs HTTP</span><span class="sxs-lookup"><span data-stu-id="d039f-162">Comparing gRPC Services with HTTP APIs</span></span>](https://docs.microsoft.com/en-us/aspnet/core/grpc/comparison?view=aspnetcore-3.0)

>[!div class="step-by-step"]
><span data-ttu-id="d039f-163">[Anterior](rest-grpc.md)
>[Próximo](distributed-data.md)</span><span class="sxs-lookup"><span data-stu-id="d039f-163">[Previous](rest-grpc.md)
[Next](distributed-data.md)</span></span> <!-- Next Chapter -->
