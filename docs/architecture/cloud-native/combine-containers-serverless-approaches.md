---
title: Como combinar contêineres e abordagens sem servidor
description: Combinando contêineres e kubernetes com abordagens sem servidor
ms.date: 06/30/2019
ms.openlocfilehash: 58aff43adbdd2e629370cc685f32c7b61c25f85e
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/23/2019
ms.locfileid: "71183430"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="b8afc-103">Como combinar contêineres e abordagens sem servidor</span><span class="sxs-lookup"><span data-stu-id="b8afc-103">Combining containers and serverless approaches</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="b8afc-104">Frequentemente, aplicativos baseados em microserviços dependem muito de contêineres, orquestração e passagem de mensagens para comunicação entre nós.</span><span class="sxs-lookup"><span data-stu-id="b8afc-104">Frequently, microservices-based applications rely heavily on containers, orchestration, and message-passing for communication between nodes.</span></span> <span data-ttu-id="b8afc-105">Esse sistema de mensagens é uma tarefa ideal para Azure Functions, mas com o restante do aplicativo configurado e implantado usando kubernetes e ferramentas relacionadas, seria interessante poder aproveitar Azure Functions dentro desse mesmo conjunto de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="b8afc-105">This messaging is an ideal task for Azure Functions, but with the rest of the application configured and deployed using Kubernetes and related tools, it would be nice to be able to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="b8afc-106">Felizmente, você pode encapsular Azure Functions em contêineres do Docker e implantá-los usando os mesmos processos e ferramentas que o restante de seu aplicativo baseado em kubernetes.</span><span class="sxs-lookup"><span data-stu-id="b8afc-106">Fortunately, you can wrap Azure Functions in Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="b8afc-107">Quando faz sentido usar contêineres sem servidor?</span><span class="sxs-lookup"><span data-stu-id="b8afc-107">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="b8afc-108">Por padrão, suas funções sem servidor não têm conhecimento da plataforma na qual elas serão executadas.</span><span class="sxs-lookup"><span data-stu-id="b8afc-108">By default, your serverless functions have no knowledge of the platform on which they'll run.</span></span> <span data-ttu-id="b8afc-109">No entanto, em alguns casos, você pode ter requisitos específicos que o tornam importante para você personalizar a imagem de contêiner na qual seu código será executado.</span><span class="sxs-lookup"><span data-stu-id="b8afc-109">However, in some cases you may have specific requirements that make it important for you to customize the container image in which your code will run.</span></span> <span data-ttu-id="b8afc-110">Talvez você queira usar uma imagem personalizada porque sua função depende de uma versão de idioma específica ou tem dependências ou requisitos de configuração que não têm suporte na imagem padrão.</span><span class="sxs-lookup"><span data-stu-id="b8afc-110">You may want to use a custom image because your function relies on a specific language version or has dependencies or configuration requirements that aren't supported by the default image.</span></span> <span data-ttu-id="b8afc-111">Nesses casos, pode fazer sentido personalizar seu próprio contêiner e implantar sua função em um contêiner personalizado do Docker.</span><span class="sxs-lookup"><span data-stu-id="b8afc-111">In these cases, it may make sense to customize your own container and deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="b8afc-112">Quando você deve evitar o uso de contêineres com Azure Functions?</span><span class="sxs-lookup"><span data-stu-id="b8afc-112">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="b8afc-113">Se você estiver esperando se beneficiar da cobrança do plano de consumo para sua função, não poderá fazer isso se estiver usando seu próprio contêiner.</span><span class="sxs-lookup"><span data-stu-id="b8afc-113">If you're expecting to benefit from the consumption plan billing for your function, you won't be able to do so if you're using your own container.</span></span> <span data-ttu-id="b8afc-114">Além disso, se você terminar de usar apenas um contêiner do Docker e implantar suas funções em seu próprio cluster kubernetes, você não se beneficiará mais do dimensionamento interno fornecido pelo Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="b8afc-114">What's more, if you go beyond just using a Docker container and deploy your functions to your own Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="b8afc-115">Você precisará usar os recursos de dimensionamento do kubernetes, descritos abaixo.</span><span class="sxs-lookup"><span data-stu-id="b8afc-115">You'll need to use Kubernetes' scaling features, described below.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="b8afc-116">Como combinar contêineres sem servidor e Docker</span><span class="sxs-lookup"><span data-stu-id="b8afc-116">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="b8afc-117">Para encapsular uma função do Azure em um contêiner do Docker, instale o Azure Functions Core Tools e, em seguida, execute o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="b8afc-117">To wrap an Azure Function in a Docker container, install the Azure Functions Core Tools and then run the following command:</span></span>

```console
func init ProjectName --docker
```

<span data-ttu-id="b8afc-118">Escolha qual tempo de execução de trabalho você deseja nas seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="b8afc-118">Choose which worker runtime you want from the following options:</span></span>

- <span data-ttu-id="b8afc-119">`dotnet` (C#)</span><span class="sxs-lookup"><span data-stu-id="b8afc-119">`dotnet` (C#)</span></span>
- <span data-ttu-id="b8afc-120">`node` (JavaScript)</span><span class="sxs-lookup"><span data-stu-id="b8afc-120">`node` (JavaScript)</span></span>
- `python`

<span data-ttu-id="b8afc-121">Quando o projeto for criado, ele incluirá um Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="b8afc-121">When the project is created, it will include a Dockerfile.</span></span> <span data-ttu-id="b8afc-122">Agora, você pode criar e testar sua função localmente.</span><span class="sxs-lookup"><span data-stu-id="b8afc-122">Now, you can create and test your function locally.</span></span> <span data-ttu-id="b8afc-123">Compile e execute-o usando os comandos `docker build` e `docker run`.</span><span class="sxs-lookup"><span data-stu-id="b8afc-123">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="b8afc-124">Para obter etapas detalhadas para começar a criar Azure Functions com o suporte do Docker, consulte o tutorial [criar uma função no Linux usando uma imagem personalizada](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="b8afc-124">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="b8afc-125">Como combinar servidores e kubernetes com KEDA</span><span class="sxs-lookup"><span data-stu-id="b8afc-125">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="b8afc-126">O Azure Functions é dimensionado automaticamente para atender à demanda com base na taxa de eventos que se destinam a uma determinada função.</span><span class="sxs-lookup"><span data-stu-id="b8afc-126">Azure functions scale automatically to meet demand based on the rate of events that are targeting a given function.</span></span> <span data-ttu-id="b8afc-127">Além disso, você pode aproveitar o kubernetes para hospedar suas funções e usar o dimensionamento automático controlado por evento baseado em kubernetes ou o KEDA.</span><span class="sxs-lookup"><span data-stu-id="b8afc-127">Additionally, you can leverage Kubernetes to host your functions and use Kubernetes-based Event Driven Autoscaling, or KEDA.</span></span> <span data-ttu-id="b8afc-128">Quando nenhum evento está ocorrendo, o KEDA pode ser reduzido para 0 instâncias e, em seguida, em resposta a eventos, ele pode escalar verticalmente o número de contêineres para atender à demanda usando o dimensionamento em escala do pod horizontal.</span><span class="sxs-lookup"><span data-stu-id="b8afc-128">When no events are occurring, KEDA can scale down to 0 instances, and then in response to events it can scale up the number of containers to meet the demand using its horizontal pod autoscaler.</span></span> <span data-ttu-id="b8afc-129">[Saiba mais sobre como dimensionar o Azure Functions com o Keda](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="b8afc-129">[Learn more about scaling Azure functions with KEDA](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span></span>

## <a name="references"></a><span data-ttu-id="b8afc-130">Referências</span><span class="sxs-lookup"><span data-stu-id="b8afc-130">References</span></span>

- [<span data-ttu-id="b8afc-131">Executar Azure Functions em um contêiner do Docker</span><span class="sxs-lookup"><span data-stu-id="b8afc-131">Run Azure Functions in a Docker Container</span></span>](https://markheath.net/post/azure-functions-docker)
- [<span data-ttu-id="b8afc-132">Criar uma função no Linux usando uma imagem personalizada</span><span class="sxs-lookup"><span data-stu-id="b8afc-132">Create a function on Linux using a custom image</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image)
- [<span data-ttu-id="b8afc-133">Azure Functions com dimensionamento automático controlado por evento kubernetes</span><span class="sxs-lookup"><span data-stu-id="b8afc-133">Azure Functions with Kubernetes Event Driven Autoscaling</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda)

>[!div class="step-by-step"]
><span data-ttu-id="b8afc-134">[Anterior](leverage-serverless-functions.md)
>[Próximo](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="b8afc-134">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>
