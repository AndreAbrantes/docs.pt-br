---
title: Combinando contêineres e abordagens sem servidor para serviços nativos de nuvem
description: Combinando contêineres e kubernetes com abordagens sem servidor
ms.date: 05/13/2020
ms.openlocfilehash: 67eee89659026db06eb16ef6f1154ab6935725a4
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/19/2020
ms.locfileid: "83614195"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="68e89-103">Como combinar contêineres e abordagens sem servidor</span><span class="sxs-lookup"><span data-stu-id="68e89-103">Combining containers and serverless approaches</span></span>

<span data-ttu-id="68e89-104">Aplicativos nativos de nuvem normalmente implementam serviços que aproveitam contêineres e orquestração.</span><span class="sxs-lookup"><span data-stu-id="68e89-104">Cloud-native applications typically implement services leveraging containers and orchestration.</span></span> <span data-ttu-id="68e89-105">Muitas vezes, há oportunidades para expor alguns dos serviços do aplicativo como Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="68e89-105">There are often opportunities to expose some of the application's services as Azure Functions.</span></span> <span data-ttu-id="68e89-106">No entanto, com um aplicativo nativo de nuvem implantado no kubernetes, seria interessante aproveitar Azure Functions dentro desse mesmo conjunto de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="68e89-106">However, with a cloud-native app deployed to Kubernetes, it would be nice to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="68e89-107">Felizmente, você pode encapsular Azure Functions dentro de contêineres do Docker e implantá-los usando os mesmos processos e ferramentas que o restante de seu aplicativo baseado em kubernetes.</span><span class="sxs-lookup"><span data-stu-id="68e89-107">Fortunately, you can wrap Azure Functions inside Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="68e89-108">Quando faz sentido usar contêineres sem servidor?</span><span class="sxs-lookup"><span data-stu-id="68e89-108">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="68e89-109">Sua função do Azure não tem conhecimento da plataforma na qual ela está implantada.</span><span class="sxs-lookup"><span data-stu-id="68e89-109">Your Azure Function has no knowledge of the platform on which it's deployed.</span></span> <span data-ttu-id="68e89-110">Para alguns cenários, você pode ter requisitos específicos e precisa personalizar o ambiente no qual o código de função será executado.</span><span class="sxs-lookup"><span data-stu-id="68e89-110">For some scenarios, you may have specific requirements and need to customize the environment on which your function code will run.</span></span> <span data-ttu-id="68e89-111">Você precisará de uma imagem personalizada que dê suporte a dependências ou a uma configuração não suportada pela imagem padrão.</span><span class="sxs-lookup"><span data-stu-id="68e89-111">You'll need a custom image that supports dependencies or a configuration not supported by the default image.</span></span> <span data-ttu-id="68e89-112">Nesses casos, faz sentido implantar sua função em um contêiner do Docker personalizado.</span><span class="sxs-lookup"><span data-stu-id="68e89-112">In these cases, it makes sense to deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="68e89-113">Quando você deve evitar o uso de contêineres com Azure Functions?</span><span class="sxs-lookup"><span data-stu-id="68e89-113">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="68e89-114">Se você quiser usar a cobrança de consumo, não poderá executar sua função em um contêiner.</span><span class="sxs-lookup"><span data-stu-id="68e89-114">If you want to use consumption billing, you won't be able to run your function in a container.</span></span> <span data-ttu-id="68e89-115">Além disso, se você implantar sua função em um cluster kubernetes, não se beneficiará mais do dimensionamento interno fornecido pelo Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="68e89-115">What's more, if you deploy your function to a Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="68e89-116">Você precisará usar os recursos de dimensionamento do kubernetes, descritos anteriormente neste capítulo.</span><span class="sxs-lookup"><span data-stu-id="68e89-116">You'll need to use Kubernetes' scaling features, described earlier in this chapter.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="68e89-117">Como combinar contêineres sem servidor e Docker</span><span class="sxs-lookup"><span data-stu-id="68e89-117">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="68e89-118">Para encapsular uma função do Azure em um contêiner do Docker, instale o [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) e, em seguida, execute o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="68e89-118">To wrap an Azure Function in a Docker container, install the [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) and then run the following command:</span></span>

```console
func init ProjectName --worker-runtime dotnet --docker
```

<span data-ttu-id="68e89-119">Quando o projeto for criado, ele incluirá um Dockerfile e o tempo de execução de trabalho configurado como `dotnet` .</span><span class="sxs-lookup"><span data-stu-id="68e89-119">When the project is created, it will include a Dockerfile and the worker runtime configured to `dotnet`.</span></span> <span data-ttu-id="68e89-120">Agora, você pode criar e testar sua função localmente.</span><span class="sxs-lookup"><span data-stu-id="68e89-120">Now, you can create and test your function locally.</span></span> <span data-ttu-id="68e89-121">Compile e execute-o usando `docker build` os `docker run` comandos e.</span><span class="sxs-lookup"><span data-stu-id="68e89-121">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="68e89-122">Para obter etapas detalhadas para começar a criar Azure Functions com o suporte do Docker, consulte o tutorial [criar uma função no Linux usando uma imagem personalizada](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="68e89-122">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="68e89-123">Como combinar servidores e kubernetes com KEDA</span><span class="sxs-lookup"><span data-stu-id="68e89-123">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="68e89-124">Neste capítulo, você viu que a plataforma Azure Functions ' é dimensionada automaticamente para atender à demanda.</span><span class="sxs-lookup"><span data-stu-id="68e89-124">In this chapter, you've seen that the Azure Functions' platform automatically scales out to meet demand.</span></span> <span data-ttu-id="68e89-125">Ao implantar funções em contêineres no AKS, no entanto, você perde a funcionalidade de dimensionamento interna.</span><span class="sxs-lookup"><span data-stu-id="68e89-125">When deploying containerized functions to AKS, however, you lose the built-in scaling functionality.</span></span> <span data-ttu-id="68e89-126">Para o resgate vem [com base em eventos baseados em kubernetes (Keda)](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="68e89-126">To the rescue comes [Kubernetes-based Event Driven (KEDA)](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span></span> <span data-ttu-id="68e89-127">Ele permite o dimensionamento automático refinado para `event-driven Kubernetes workloads,` incluir funções em contêineres.</span><span class="sxs-lookup"><span data-stu-id="68e89-127">It enables fine-grained autoscaling for `event-driven Kubernetes workloads,` including containerized functions.</span></span>

<span data-ttu-id="68e89-128">O KEDA fornece funcionalidade de dimensionamento orientada a eventos para o tempo de execução do Functions em um contêiner do Docker.</span><span class="sxs-lookup"><span data-stu-id="68e89-128">KEDA provides event-driven scaling functionality to the Functions' runtime in a Docker container.</span></span> <span data-ttu-id="68e89-129">KEDA pode ser dimensionado de zero instâncias (quando nenhum evento está ocorrendo) para `n instances` , com base na carga.</span><span class="sxs-lookup"><span data-stu-id="68e89-129">KEDA can scale from zero instances (when no events are occurring) out to `n instances`, based on load.</span></span> <span data-ttu-id="68e89-130">Ele permite o dimensionamento automático expondo métricas personalizadas para o kubernetes AutoScaler (dimensionamento automático de Pod horizontal).</span><span class="sxs-lookup"><span data-stu-id="68e89-130">It enables autoscaling by exposing custom metrics to the Kubernetes autoscaler (Horizontal Pod Autoscaler).</span></span> <span data-ttu-id="68e89-131">O uso de contêineres de funções com KEDA torna possível replicar recursos de função sem servidor em qualquer cluster kubernetes.</span><span class="sxs-lookup"><span data-stu-id="68e89-131">Using Functions containers with KEDA makes it possible to replicate serverless function capabilities in any Kubernetes cluster.</span></span>

<span data-ttu-id="68e89-132">Vale a pena observar que o projeto KEDA agora é gerenciado pela CNCF (nuvem Native Computing Foundation).</span><span class="sxs-lookup"><span data-stu-id="68e89-132">It is worth noting that the KEDA project is now managed by the Cloud Native Computing Foundation (CNCF).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="68e89-133">[Anterior](leverage-serverless-functions.md) 
> [Avançar](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="68e89-133">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>
