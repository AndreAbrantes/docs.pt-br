---
title: Como aproveitar funções sem servidor
description: Aproveitamento e Azure Functions sem servidor em aplicativos nativos de nuvem
ms.date: 05/13/2020
ms.openlocfilehash: 53a0fdd29630b2a4368f3aa37ddfc5f93df10a24
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/19/2020
ms.locfileid: "83613857"
---
# <a name="leveraging-serverless-functions"></a><span data-ttu-id="864d7-103">Como aproveitar funções sem servidor</span><span class="sxs-lookup"><span data-stu-id="864d7-103">Leveraging serverless functions</span></span>

<span data-ttu-id="864d7-104">No espectro do gerenciamento de máquinas físicas para aproveitar os recursos de nuvem, as vidas sem servidor no final extremo.</span><span class="sxs-lookup"><span data-stu-id="864d7-104">In the spectrum from managing physical machines to leveraging cloud capabilities, serverless lives at the extreme end.</span></span> <span data-ttu-id="864d7-105">Sua única responsabilidade é seu código, e você só paga quando seu código é executado.</span><span class="sxs-lookup"><span data-stu-id="864d7-105">Your only responsibility is your code, and you only pay when your code runs.</span></span> <span data-ttu-id="864d7-106">Azure Functions fornece uma maneira de criar recursos sem servidor em seus aplicativos nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="864d7-106">Azure Functions provides a way to build serverless capabilities into your cloud-native applications.</span></span>

## <a name="what-is-serverless"></a><span data-ttu-id="864d7-107">O que é sem servidor?</span><span class="sxs-lookup"><span data-stu-id="864d7-107">What is serverless?</span></span>

<span data-ttu-id="864d7-108">Sem servidor é um modelo de serviço relativamente novo de computação em nuvem.</span><span class="sxs-lookup"><span data-stu-id="864d7-108">Serverless is a relatively new service model of cloud computing.</span></span> <span data-ttu-id="864d7-109">Isso não significa que os servidores são opcionais-seu código ainda é executado em um servidor em algum lugar.</span><span class="sxs-lookup"><span data-stu-id="864d7-109">It doesn't mean that servers are optional - your code still runs on a server somewhere.</span></span> <span data-ttu-id="864d7-110">A diferença é que a equipe de aplicativos não se preocupa mais com o gerenciamento da infraestrutura de servidor.</span><span class="sxs-lookup"><span data-stu-id="864d7-110">The distinction is that the application team no longer concerns itself with managing server infrastructure.</span></span> <span data-ttu-id="864d7-111">Em vez disso, o fornecedor de nuvem possui essa responsabilidade.</span><span class="sxs-lookup"><span data-stu-id="864d7-111">Instead, the cloud vendor own this responsibility.</span></span> <span data-ttu-id="864d7-112">A equipe de desenvolvimento aumenta sua produtividade fornecendo soluções de negócios para os clientes, não para o trabalho.</span><span class="sxs-lookup"><span data-stu-id="864d7-112">The development team increases its productivity by delivering business solutions to customers, not plumbing.</span></span>

<span data-ttu-id="864d7-113">A computação sem servidor usa contêineres com estado disparados por eventos para hospedar seus serviços.</span><span class="sxs-lookup"><span data-stu-id="864d7-113">Serverless computing uses event-triggered stateless containers to host your services.</span></span> <span data-ttu-id="864d7-114">Eles podem escalar horizontalmente e em para atender à demanda conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="864d7-114">They can scale out and in to meet demand as-needed.</span></span> <span data-ttu-id="864d7-115">Plataformas sem servidor como Azure Functions têm integração total com outros serviços do Azure, como filas, eventos e armazenamento.</span><span class="sxs-lookup"><span data-stu-id="864d7-115">Serverless platforms like Azure Functions have tight integration with other Azure services like queues, events, and storage.</span></span>

## <a name="what-challenges-are-solved-by-serverless"></a><span data-ttu-id="864d7-116">Quais desafios são resolvidos sem servidor?</span><span class="sxs-lookup"><span data-stu-id="864d7-116">What challenges are solved by serverless?</span></span>

<span data-ttu-id="864d7-117">As plataformas sem servidor abordam muitas preocupações demoradas e caras:</span><span class="sxs-lookup"><span data-stu-id="864d7-117">Serverless platforms address many time-consuming and expensive concerns:</span></span>

- <span data-ttu-id="864d7-118">Compra de computadores e licenças de software</span><span class="sxs-lookup"><span data-stu-id="864d7-118">Purchasing machines and software licenses</span></span>
- <span data-ttu-id="864d7-119">Hospedagem, proteção, configuração e manutenção de computadores e seus requisitos de rede, energia e/C</span><span class="sxs-lookup"><span data-stu-id="864d7-119">Housing, securing, configuring, and maintaining the machines and their networking, power, and A/C requirements</span></span>
- <span data-ttu-id="864d7-120">Aplicação de patch e atualização de software e sistemas operacionais</span><span class="sxs-lookup"><span data-stu-id="864d7-120">Patching and upgrading operating systems and software</span></span>
- <span data-ttu-id="864d7-121">Configurando servidores Web ou serviços de máquina para hospedar software de aplicativo</span><span class="sxs-lookup"><span data-stu-id="864d7-121">Configuring web servers or machine services to host application software</span></span>
- <span data-ttu-id="864d7-122">Configurando o software de aplicativo em sua plataforma</span><span class="sxs-lookup"><span data-stu-id="864d7-122">Configuring application software within its platform</span></span>

<span data-ttu-id="864d7-123">Muitas empresas alocam grandes orçamentos para dar suporte a questões de infraestrutura de hardware.</span><span class="sxs-lookup"><span data-stu-id="864d7-123">Many companies allocate large budgets to support hardware infrastructure concerns.</span></span> <span data-ttu-id="864d7-124">A mudança para a nuvem pode ajudar a reduzir esses custos; a mudança de aplicativos para o sem servidor pode ajudar a eliminá-los.</span><span class="sxs-lookup"><span data-stu-id="864d7-124">Moving to the cloud can help reduce these costs; shifting applications to serverless can help eliminate them.</span></span>

## <a name="what-is-the-difference-between-a-microservice-and-a-serverless-function"></a><span data-ttu-id="864d7-125">Qual é a diferença entre um microserviço e uma função sem servidor?</span><span class="sxs-lookup"><span data-stu-id="864d7-125">What is the difference between a microservice and a serverless function?</span></span>

<span data-ttu-id="864d7-126">Normalmente, um microserviço encapsula um recurso de negócios, como um carrinho de compras para um site de comércio online.</span><span class="sxs-lookup"><span data-stu-id="864d7-126">Typically, a microservice encapsulates a business capability, such as a shopping cart for an online eCommerce site.</span></span> <span data-ttu-id="864d7-127">Ele expõe várias operações que permitem que um usuário gerencie sua experiência de compra.</span><span class="sxs-lookup"><span data-stu-id="864d7-127">It exposes multiple operations that enable a user to manage their shopping experience.</span></span> <span data-ttu-id="864d7-128">Uma função, no entanto, é um pequeno bloco leve de código que executa uma operação de finalidade única em resposta a um evento.</span><span class="sxs-lookup"><span data-stu-id="864d7-128">A function, however, is a small, lightweight block of code that executes a single-purpose operation in response to an event.</span></span>
<span data-ttu-id="864d7-129">Os microserviços normalmente são construídos para responder a solicitações, geralmente de uma interface.</span><span class="sxs-lookup"><span data-stu-id="864d7-129">Microservices are typically constructed to respond to requests, often from an interface.</span></span> <span data-ttu-id="864d7-130">As solicitações podem ser baseadas em HTTP REST ou gRPC.</span><span class="sxs-lookup"><span data-stu-id="864d7-130">Requests can be HTTP Rest- or gRPC-based.</span></span> <span data-ttu-id="864d7-131">Serviços sem servidor respondem a eventos.</span><span class="sxs-lookup"><span data-stu-id="864d7-131">Serverless services respond to events.</span></span> <span data-ttu-id="864d7-132">Sua arquitetura orientada por eventos é ideal para o processamento de tarefas em segundo plano e de execução curta.</span><span class="sxs-lookup"><span data-stu-id="864d7-132">Its event-driven architecture is ideal for processing short-running, background tasks.</span></span>

## <a name="what-scenarios-are-appropriate-for-serverless"></a><span data-ttu-id="864d7-133">Quais cenários são apropriados para servidores sem servidor?</span><span class="sxs-lookup"><span data-stu-id="864d7-133">What scenarios are appropriate for serverless?</span></span>

<span data-ttu-id="864d7-134">Serverless expõe funções de curta execução individuais que são invocadas em resposta a um gatilho.</span><span class="sxs-lookup"><span data-stu-id="864d7-134">Serverless exposes individual short-running functions that are invoked in response to a trigger.</span></span> <span data-ttu-id="864d7-135">Isso os torna ideais para o processamento de tarefas em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="864d7-135">This makes them ideal for processing background tasks.</span></span>

<span data-ttu-id="864d7-136">Um aplicativo pode precisar enviar um email como uma etapa em um fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="864d7-136">An application might need to send an email as a step in a workflow.</span></span> <span data-ttu-id="864d7-137">Em vez de enviar a notificação como parte de uma solicitação de microatendimento, coloque os detalhes da mensagem em uma fila.</span><span class="sxs-lookup"><span data-stu-id="864d7-137">Instead of sending the notification as part of a microservice request, place the message details onto a queue.</span></span> <span data-ttu-id="864d7-138">Uma função do Azure pode remover a mensagem da fila e enviar o email de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="864d7-138">An Azure Function can dequeue the message and asynchronously send the email.</span></span> <span data-ttu-id="864d7-139">Isso pode melhorar o desempenho e a escalabilidade do microserviço.</span><span class="sxs-lookup"><span data-stu-id="864d7-139">Doing so could improve the performance and scalability of the microservice.</span></span> <span data-ttu-id="864d7-140">O [nivelamento de carga baseado em fila](https://docs.microsoft.com/azure/architecture/patterns/queue-based-load-leveling) pode ser implementado para evitar gargalos relacionados ao envio dos emails.</span><span class="sxs-lookup"><span data-stu-id="864d7-140">[Queue-based load leveling](https://docs.microsoft.com/azure/architecture/patterns/queue-based-load-leveling) can be implemented to avoid bottlenecks related to sending the emails.</span></span> <span data-ttu-id="864d7-141">Além disso, esse serviço autônomo pode ser reutilizado como um utilitário em vários aplicativos diferentes.</span><span class="sxs-lookup"><span data-stu-id="864d7-141">Additionally, this stand-alone service could be reused as a utility across many different applications.</span></span>

<span data-ttu-id="864d7-142">Mensagens assíncronas de filas e tópicos é um padrão comum para disparar funções sem servidor.</span><span class="sxs-lookup"><span data-stu-id="864d7-142">Asynchronous messaging from queues and topics is a common pattern to trigger serverless functions.</span></span> <span data-ttu-id="864d7-143">No entanto, Azure Functions pode ser disparado por outros eventos, como alterações no armazenamento de BLOBs do Azure.</span><span class="sxs-lookup"><span data-stu-id="864d7-143">However, Azure Functions can be triggered by other events, such as changes to Azure Blob Storage.</span></span> <span data-ttu-id="864d7-144">Um serviço que dá suporte a carregamentos de imagem pode ter uma função do Azure responsável por otimizar o tamanho da imagem.</span><span class="sxs-lookup"><span data-stu-id="864d7-144">A service that supports image uploads could have an Azure Function responsible for optimizing the image size.</span></span> <span data-ttu-id="864d7-145">A função pode ser disparada diretamente por inserções no armazenamento de BLOBs do Azure, mantendo a complexidade das operações de microserviço.</span><span class="sxs-lookup"><span data-stu-id="864d7-145">The function could be triggered directly by inserts into Azure Blob Storage, keeping complexity out of the microservice operations.</span></span>

<span data-ttu-id="864d7-146">Muitos serviços têm processos de execução longa como parte de seus fluxos de trabalho.</span><span class="sxs-lookup"><span data-stu-id="864d7-146">Many services have long-running processes as part of their workflows.</span></span> <span data-ttu-id="864d7-147">Muitas vezes, essas tarefas são feitas como parte da interação do usuário com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="864d7-147">Often these tasks are done as part of the user's interaction with the application.</span></span> <span data-ttu-id="864d7-148">Essas tarefas podem forçar o usuário a esperar, afetando negativamente sua experiência.</span><span class="sxs-lookup"><span data-stu-id="864d7-148">These tasks can force the user to wait, negatively impacting their experience.</span></span> <span data-ttu-id="864d7-149">A computação sem servidor fornece uma ótima maneira de mover tarefas mais lentas para fora do loop de interação do usuário.</span><span class="sxs-lookup"><span data-stu-id="864d7-149">Serverless computing provides a great way to move slower tasks outside of the user interaction loop.</span></span> <span data-ttu-id="864d7-150">Essas tarefas podem ser dimensionadas com demanda sem a necessidade de dimensionar todo o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="864d7-150">These tasks can scale with demand without requiring the entire application to scale.</span></span>

## <a name="when-should-you-avoid-serverless"></a><span data-ttu-id="864d7-151">Quando você não deve evitar servidor?</span><span class="sxs-lookup"><span data-stu-id="864d7-151">When should you avoid serverless?</span></span>

<span data-ttu-id="864d7-152">Provisionamento e dimensionamento de soluções sem servidor sob demanda.</span><span class="sxs-lookup"><span data-stu-id="864d7-152">Serverless solutions provision and scale on demand.</span></span> <span data-ttu-id="864d7-153">Quando uma nova instância é chamada, o Cold Starts é um problema comum.</span><span class="sxs-lookup"><span data-stu-id="864d7-153">When a new instance is invoked, cold starts are a common issue.</span></span> <span data-ttu-id="864d7-154">Um início frio é o período de tempo necessário para provisionar essa instância.</span><span class="sxs-lookup"><span data-stu-id="864d7-154">A cold start is the period of time it takes to provision this instance.</span></span> <span data-ttu-id="864d7-155">Normalmente, esse atraso pode ser de alguns segundos, mas pode ser mais demorado dependendo de vários fatores.</span><span class="sxs-lookup"><span data-stu-id="864d7-155">Normally, this delay might be a few seconds, but can be longer depending on various factors.</span></span> <span data-ttu-id="864d7-156">Depois de provisionado, uma única instância é mantida ativa, desde que receba solicitações periódicas.</span><span class="sxs-lookup"><span data-stu-id="864d7-156">Once provisioned, a single instance is kept alive as long as it receives periodic requests.</span></span> <span data-ttu-id="864d7-157">Mas, se um serviço for chamado com menos frequência, o Azure poderá removê-lo da memória e exigir uma inicialização a frio quando for reinvocado.</span><span class="sxs-lookup"><span data-stu-id="864d7-157">But, if a service is called less frequently, Azure may remove it from memory and require a cold start when reinvoked.</span></span> <span data-ttu-id="864d7-158">Inícios frios também são necessários quando uma função é dimensionada para uma nova instância.</span><span class="sxs-lookup"><span data-stu-id="864d7-158">Cold starts are also required when a function scales out to a new instance.</span></span>

<span data-ttu-id="864d7-159">A Figura 3-10 mostra um padrão de inicialização a frio.</span><span class="sxs-lookup"><span data-stu-id="864d7-159">Figure 3-10 shows a cold-start pattern.</span></span> <span data-ttu-id="864d7-160">Observe as etapas adicionais necessárias quando o aplicativo está frio.</span><span class="sxs-lookup"><span data-stu-id="864d7-160">Note the extra steps required when the app is cold.</span></span>

<span data-ttu-id="864d7-161">![Inativo versus a figura de início quente ](./media/cold-start-warm-start.png)
 **3-10**.</span><span class="sxs-lookup"><span data-stu-id="864d7-161">![Cold versus warm start](./media/cold-start-warm-start.png)
**Figure 3-10**.</span></span> <span data-ttu-id="864d7-162">Início frio versus início quente.</span><span class="sxs-lookup"><span data-stu-id="864d7-162">Cold start versus warm start.</span></span>

<span data-ttu-id="864d7-163">Para evitar que o frio seja totalmente iniciado, você pode mudar de um [plano de consumo para um plano dedicado](https://azure.microsoft.com/blog/understanding-serverless-cold-start/).</span><span class="sxs-lookup"><span data-stu-id="864d7-163">To avoid cold starts entirely, you might switch from a [consumption plan to a dedicated plan](https://azure.microsoft.com/blog/understanding-serverless-cold-start/).</span></span> <span data-ttu-id="864d7-164">Você também pode configurar uma ou mais [instâncias pré-configuradas](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances) com a atualização do plano Premium.</span><span class="sxs-lookup"><span data-stu-id="864d7-164">You can also configure one or more [pre-warmed instances](https://docs.microsoft.com/azure/azure-functions/functions-premium-plan#pre-warmed-instances) with the premium plan upgrade.</span></span> <span data-ttu-id="864d7-165">Nesses casos, quando você precisa adicionar outra instância, ela já está ativa e pronta para uso.</span><span class="sxs-lookup"><span data-stu-id="864d7-165">In these cases, when you need to add another instance, it's already up and ready to go.</span></span> <span data-ttu-id="864d7-166">Essas opções podem ajudar a mitigar o problema de inicialização a frio associado à computação sem servidor.</span><span class="sxs-lookup"><span data-stu-id="864d7-166">These options can help mitigate the cold start issue associated with serverless computing.</span></span>

<span data-ttu-id="864d7-167">Os provedores de nuvem cobram por servidor com base no tempo de execução de computação e na memória consumida.</span><span class="sxs-lookup"><span data-stu-id="864d7-167">Cloud providers bill for serverless based on compute execution time and consumed memory.</span></span> <span data-ttu-id="864d7-168">Operações de longa execução ou cargas de trabalho de alto consumo de memória nem sempre são os melhores candidatos para servidor.</span><span class="sxs-lookup"><span data-stu-id="864d7-168">Long running operations or high memory consumption workloads aren't always the best candidates for serverless.</span></span> <span data-ttu-id="864d7-169">As funções sem servidor favorecem pequenas partes de trabalho que podem ser concluídas rapidamente.</span><span class="sxs-lookup"><span data-stu-id="864d7-169">Serverless functions favor small chunks of work that can complete quickly.</span></span> <span data-ttu-id="864d7-170">A maioria das plataformas sem servidor exige que as funções individuais sejam concluídas em alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="864d7-170">Most serverless platforms require individual functions to complete within a few minutes.</span></span> <span data-ttu-id="864d7-171">Azure Functions usa como padrão uma duração de tempo limite de 5 minutos, que pode ser configurada até 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="864d7-171">Azure Functions defaults to a 5-minute time-out duration, which can be configured up to 10 minutes.</span></span> <span data-ttu-id="864d7-172">O plano do Azure Functions Premium também pode mitigar esse problema, padronizando os tempos limite para 30 minutos com um limite superior não associado que pode ser configurado.</span><span class="sxs-lookup"><span data-stu-id="864d7-172">The Azure Functions premium plan can mitigate this issue as well, defaulting time-outs to 30 minutes with an unbounded higher limit that can be configured.</span></span> <span data-ttu-id="864d7-173">O tempo de computação não é o horário do calendário.</span><span class="sxs-lookup"><span data-stu-id="864d7-173">Compute time isn't calendar time.</span></span> <span data-ttu-id="864d7-174">Funções mais avançadas usando a [estrutura de durable Functions do Azure](https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=csharp) podem pausar a execução por um curso de vários dias.</span><span class="sxs-lookup"><span data-stu-id="864d7-174">More advanced functions using the [Azure Durable Functions framework](https://docs.microsoft.com/azure/azure-functions/durable/durable-functions-overview?tabs=csharp) may pause execution over a course of several days.</span></span> <span data-ttu-id="864d7-175">A cobrança é baseada no tempo de execução real – quando a função é ativada e retoma o processamento.</span><span class="sxs-lookup"><span data-stu-id="864d7-175">The billing is based on actual execution time - when the function wakes up and resumes processing.</span></span>

<span data-ttu-id="864d7-176">Por fim, aproveitar Azure Functions para tarefas de aplicativo adiciona complexidade.</span><span class="sxs-lookup"><span data-stu-id="864d7-176">Finally, leveraging Azure Functions for application tasks adds complexity.</span></span> <span data-ttu-id="864d7-177">É prudente primeiro arquitetar seu aplicativo com um design modular e menos rígido.</span><span class="sxs-lookup"><span data-stu-id="864d7-177">It's wise to first architect your application with a modular, loosely coupled design.</span></span> <span data-ttu-id="864d7-178">Em seguida, identifique se há benefícios sem servidor que justifiquem a complexidade adicional.</span><span class="sxs-lookup"><span data-stu-id="864d7-178">Then, identify if there are benefits serverless would offer that justify the additional complexity.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="864d7-179">[Anterior](leverage-containers-orchestrators.md) 
> [Avançar](combine-containers-serverless-approaches.md)</span><span class="sxs-lookup"><span data-stu-id="864d7-179">[Previous](leverage-containers-orchestrators.md)
[Next](combine-containers-serverless-approaches.md)</span></span>
