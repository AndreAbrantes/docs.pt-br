---
title: Como aproveitar contêineres e orquestradores
description: Aproveitando contêineres do Docker e orquestradores kubernetes no Azure
ms.date: 05/31/2020
ms.openlocfilehash: b4bdbe5c6b3946658e6c11a40cbbb2feb07cc951
ms.sourcegitcommit: a8a205034eeffc7c3e1bdd6f506a75b0f7099ebf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/06/2020
ms.locfileid: "91755903"
---
# <a name="leveraging-containers-and-orchestrators"></a><span data-ttu-id="187d1-103">Como aproveitar contêineres e orquestradores</span><span class="sxs-lookup"><span data-stu-id="187d1-103">Leveraging containers and orchestrators</span></span>

<span data-ttu-id="187d1-104">Contêineres e orquestradores são projetados para resolver problemas comuns a abordagens de implantação monolítica.</span><span class="sxs-lookup"><span data-stu-id="187d1-104">Containers and orchestrators are designed to solve problems common to monolithic deployment approaches.</span></span>

## <a name="challenges-with-monolithic-deployments"></a><span data-ttu-id="187d1-105">Desafios com implantações monolíticos</span><span class="sxs-lookup"><span data-stu-id="187d1-105">Challenges with monolithic deployments</span></span>

<span data-ttu-id="187d1-106">Tradicionalmente, a maioria dos aplicativos foi implantada como uma única unidade.</span><span class="sxs-lookup"><span data-stu-id="187d1-106">Traditionally, most applications have been deployed as a single unit.</span></span> <span data-ttu-id="187d1-107">Esses aplicativos são chamados de monolíticos.</span><span class="sxs-lookup"><span data-stu-id="187d1-107">Such applications are referred to as a monolith.</span></span> <span data-ttu-id="187d1-108">Essa abordagem geral de implantação de aplicativos como unidades únicas, mesmo se eles são compostos por vários módulos ou assemblies, é conhecida como arquitetura monolítica, como mostra a Figura 3-1.</span><span class="sxs-lookup"><span data-stu-id="187d1-108">This general approach of deploying applications as single units even if they're composed of multiple modules or assemblies is known as monolithic architecture, as shown in Figure 3-1.</span></span>

![Arquitetura monolítica.](./media/monolithic-design.png)

<span data-ttu-id="187d1-110">**Figura 3-1**.</span><span class="sxs-lookup"><span data-stu-id="187d1-110">**Figure 3-1**.</span></span> <span data-ttu-id="187d1-111">Arquitetura monolítica.</span><span class="sxs-lookup"><span data-stu-id="187d1-111">Monolithic architecture.</span></span>

<span data-ttu-id="187d1-112">Embora eles tenham o benefício da simplicidade, as arquiteturas monolíticos enfrentam vários desafios:</span><span class="sxs-lookup"><span data-stu-id="187d1-112">Although they have the benefit of simplicity, monolithic architectures face a number of challenges:</span></span>

### <a name="deployment"></a><span data-ttu-id="187d1-113">Implantação</span><span class="sxs-lookup"><span data-stu-id="187d1-113">Deployment</span></span>

<span data-ttu-id="187d1-114">Os aplicativos monolíticos exigem uma implantação completa de todo o aplicativo, mesmo que apenas uma pequena alteração tenha sido feita.</span><span class="sxs-lookup"><span data-stu-id="187d1-114">Monolithic applications require a full deployment of the entire application, even if only a small change has been made.</span></span> <span data-ttu-id="187d1-115">As implantações completas podem ser caras e sujeitas a erros.</span><span class="sxs-lookup"><span data-stu-id="187d1-115">Full deployments can be expensive and error prone.</span></span> <span data-ttu-id="187d1-116">Além disso, eles exigem uma reinicialização do aplicativo, o que afeta temporariamente a indisponibilidade.</span><span class="sxs-lookup"><span data-stu-id="187d1-116">Additionally, they require a restart of the application, which temporarily impacts unavailability.</span></span>

### <a name="scaling"></a><span data-ttu-id="187d1-117">Scaling</span><span class="sxs-lookup"><span data-stu-id="187d1-117">Scaling</span></span>

<span data-ttu-id="187d1-118">Um aplicativo monolítico é totalmente hospedado em uma única instância de computador, muitas vezes exigindo hardware de alta capacidade.</span><span class="sxs-lookup"><span data-stu-id="187d1-118">A monolithic application is hosted entirely on a single machine instance, often requiring high-capability hardware.</span></span> <span data-ttu-id="187d1-119">Se qualquer parte do monolítica exigir o dimensionamento, outra cópia do aplicativo inteiro deverá ser implantada em outro computador.</span><span class="sxs-lookup"><span data-stu-id="187d1-119">If any part of the monolith requires scaling, another copy of the entire application must be deployed to another machine.</span></span> <span data-ttu-id="187d1-120">Com um monolítico, você não pode dimensionar componentes de aplicativos individualmente – é tudo ou nada.</span><span class="sxs-lookup"><span data-stu-id="187d1-120">With a monolith, you can't scale application components individually - it's all or nothing.</span></span> <span data-ttu-id="187d1-121">O dimensionamento de componentes que não exigem dimensionamento resulta em um uso de recursos ineficiente e dispendioso.</span><span class="sxs-lookup"><span data-stu-id="187d1-121">Scaling components that don't require scaling results in inefficient and costly resource usage.</span></span>

### <a name="environment"></a><span data-ttu-id="187d1-122">Ambiente</span><span class="sxs-lookup"><span data-stu-id="187d1-122">Environment</span></span>

<span data-ttu-id="187d1-123">Os aplicativos monolíticos normalmente são implantados em um ambiente de hospedagem com um sistema operacional pré-instalado, tempo de execução e dependências de biblioteca.</span><span class="sxs-lookup"><span data-stu-id="187d1-123">Monolithic applications are typically deployed to a hosting environment with a pre-installed operating system, runtime, and library dependencies.</span></span> <span data-ttu-id="187d1-124">Esse ambiente pode não corresponder ao que o aplicativo foi desenvolvido ou testado.</span><span class="sxs-lookup"><span data-stu-id="187d1-124">This environment may not match that upon which the application was developed or tested.</span></span> <span data-ttu-id="187d1-125">Inconsistências entre ambientes de aplicativos são uma fonte comum de problemas para implantações monolíticos.</span><span class="sxs-lookup"><span data-stu-id="187d1-125">Inconsistencies across application environments are a common source of problems for monolithic deployments.</span></span>

### <a name="coupling"></a><span data-ttu-id="187d1-126">Acoplamento</span><span class="sxs-lookup"><span data-stu-id="187d1-126">Coupling</span></span>

<span data-ttu-id="187d1-127">Um aplicativo monolítico provavelmente experimentará um acoplamento alto em seus componentes funcionais.</span><span class="sxs-lookup"><span data-stu-id="187d1-127">A monolithic application is likely to experience high coupling across its functional components.</span></span> <span data-ttu-id="187d1-128">Sem limites rígidos, as alterações do sistema geralmente resultam em efeitos colaterais indesejados e dispendiosos.</span><span class="sxs-lookup"><span data-stu-id="187d1-128">Without hard boundaries, system changes often result in unintended and costly side effects.</span></span> <span data-ttu-id="187d1-129">Novos recursos/correções se tornam complicados, demorados e caros de implementar.</span><span class="sxs-lookup"><span data-stu-id="187d1-129">New features/fixes become tricky, time-consuming, and expensive to implement.</span></span> <span data-ttu-id="187d1-130">As atualizações exigem testes extensivos.</span><span class="sxs-lookup"><span data-stu-id="187d1-130">Updates require extensive testing.</span></span> <span data-ttu-id="187d1-131">O acoplamento também dificulta a refatoração de componentes ou a troca em implementações alternativas.</span><span class="sxs-lookup"><span data-stu-id="187d1-131">Coupling also makes it difficult to refactor components or swap in alternative implementations.</span></span> <span data-ttu-id="187d1-132">Mesmo quando construída com uma separação estrita de preocupações, a arquitetura erosion define como a base de código monolítica deteriorada com "casos especiais" que não terminam.</span><span class="sxs-lookup"><span data-stu-id="187d1-132">Even when constructed with a strict separation of concerns, architectural erosion sets in as the monolithic code base deteriorates with never-ending "special cases."</span></span>

### <a name="platform-lock-in"></a><span data-ttu-id="187d1-133">Bloqueio de plataforma</span><span class="sxs-lookup"><span data-stu-id="187d1-133">Platform lock-in</span></span>

<span data-ttu-id="187d1-134">Um aplicativo monolítico é construído com uma única pilha de tecnologia.</span><span class="sxs-lookup"><span data-stu-id="187d1-134">A monolithic application is constructed with a single technology stack.</span></span> <span data-ttu-id="187d1-135">Ao oferecer a uniformidade, esse compromisso pode se tornar uma barreira à inovação.</span><span class="sxs-lookup"><span data-stu-id="187d1-135">While offering uniformity, this commitment can become a barrier to innovation.</span></span> <span data-ttu-id="187d1-136">Novos recursos e componentes serão criados usando a pilha atual do aplicativo, mesmo quando mais tecnologias modernas podem ser uma opção melhor.</span><span class="sxs-lookup"><span data-stu-id="187d1-136">New features and components will be built using the application's current stack - even when more modern technologies may be a better choice.</span></span> <span data-ttu-id="187d1-137">Um risco de longo prazo é que sua pilha de tecnologia se torna desatualizada e obsoleta.</span><span class="sxs-lookup"><span data-stu-id="187d1-137">A longer-term risk is your technology stack becoming outdated and obsolete.</span></span> <span data-ttu-id="187d1-138">A reestruturação de um aplicativo inteiro para uma plataforma nova e mais moderna é a mais cara e arriscada.</span><span class="sxs-lookup"><span data-stu-id="187d1-138">Rearchitecting an entire application to a new, more modern platform is at best expensive and risky.</span></span>

## <a name="what-are-the-benefits-of-containers-and-orchestrators"></a><span data-ttu-id="187d1-139">Quais são os benefícios de contêineres e orquestradores?</span><span class="sxs-lookup"><span data-stu-id="187d1-139">What are the benefits of containers and orchestrators?</span></span>

<span data-ttu-id="187d1-140">Introduzimos contêineres no capítulo 1.</span><span class="sxs-lookup"><span data-stu-id="187d1-140">We introduced containers in Chapter 1.</span></span> <span data-ttu-id="187d1-141">Destacamos como a CNCF (nuvem Native Computing Foundation) classifica a Containerização como a primeira etapa em seu [mapa de rastros de nuvem nativa](https://raw.githubusercontent.com/cncf/trailmap/master/CNCF_TrailMap_latest.png) -orientação para empresas que começam sua jornada nativa de nuvem.</span><span class="sxs-lookup"><span data-stu-id="187d1-141">We highlighted how the Cloud Native Computing Foundation (CNCF) ranks containerization as the first step in their [Cloud-Native Trail Map](https://raw.githubusercontent.com/cncf/trailmap/master/CNCF_TrailMap_latest.png) - guidance for enterprises beginning their cloud-native journey.</span></span> <span data-ttu-id="187d1-142">Nesta seção, discutiremos os benefícios dos contêineres.</span><span class="sxs-lookup"><span data-stu-id="187d1-142">In this section, we discuss the benefits of containers.</span></span>

<span data-ttu-id="187d1-143">O Docker é a plataforma de gerenciamento de contêiner mais popular.</span><span class="sxs-lookup"><span data-stu-id="187d1-143">Docker is the most popular container management platform.</span></span> <span data-ttu-id="187d1-144">Ele funciona com contêineres no Linux ou no Windows.</span><span class="sxs-lookup"><span data-stu-id="187d1-144">It works with containers on both Linux or Windows.</span></span> <span data-ttu-id="187d1-145">Os contêineres fornecem ambientes de aplicativos separados, mas reproduzíveis, que são executados da mesma maneira em qualquer sistema.</span><span class="sxs-lookup"><span data-stu-id="187d1-145">Containers provide separate but reproducible application environments that run the same way on any system.</span></span> <span data-ttu-id="187d1-146">Esse aspecto torna-os perfeitos para desenvolver e hospedar serviços nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="187d1-146">This aspect makes them perfect for developing and hosting cloud-native services.</span></span> <span data-ttu-id="187d1-147">Os contêineres são isolados um do outro.</span><span class="sxs-lookup"><span data-stu-id="187d1-147">Containers are isolated from one another.</span></span> <span data-ttu-id="187d1-148">Dois contêineres no mesmo hardware de host podem ter versões diferentes do software, sem causar conflitos.</span><span class="sxs-lookup"><span data-stu-id="187d1-148">Two containers on the same host hardware can have different versions of software, without causing conflicts.</span></span>

<span data-ttu-id="187d1-149">Os contêineres são definidos por arquivos simples baseados em texto que se tornam artefatos do projeto e são verificados no controle do código-fonte.</span><span class="sxs-lookup"><span data-stu-id="187d1-149">Containers are defined by simple text-based files that become project artifacts and are checked into source control.</span></span> <span data-ttu-id="187d1-150">Embora os servidores completos e as máquinas virtuais exijam um esforço manual para atualizar, os contêineres são facilmente controlados por versão.</span><span class="sxs-lookup"><span data-stu-id="187d1-150">While full servers and virtual machines require manual effort to update, containers are easily version-controlled.</span></span> <span data-ttu-id="187d1-151">Aplicativos criados para execução em contêineres podem ser desenvolvidos, testados e implantados usando ferramentas automatizadas como parte de um pipeline de compilação.</span><span class="sxs-lookup"><span data-stu-id="187d1-151">Apps built to run in containers can be developed, tested, and deployed using automated tools as part of a build pipeline.</span></span>

<span data-ttu-id="187d1-152">Os contêineres são imutáveis.</span><span class="sxs-lookup"><span data-stu-id="187d1-152">Containers are immutable.</span></span> <span data-ttu-id="187d1-153">Depois de definir um contêiner, você pode recriá-lo e executá-lo exatamente da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="187d1-153">Once you define a container, you can recreate and run it exactly the same way.</span></span> <span data-ttu-id="187d1-154">Essa imutabilidade se presta ao design baseado em componentes.</span><span class="sxs-lookup"><span data-stu-id="187d1-154">This immutability lends itself to component-based design.</span></span> <span data-ttu-id="187d1-155">Se algumas partes de um aplicativo evoluem de forma diferente do que outras, por que reimplantar todo o aplicativo quando você pode simplesmente implantar as partes que mudam com mais frequência?</span><span class="sxs-lookup"><span data-stu-id="187d1-155">If some parts of an application evolve differently than others, why redeploy the entire app when you can just deploy the parts that change most frequently?</span></span> <span data-ttu-id="187d1-156">Diferentes recursos e preocupações abrangentes de um aplicativo podem ser divididos em unidades separadas.</span><span class="sxs-lookup"><span data-stu-id="187d1-156">Different features and cross-cutting concerns of an app can be broken up into separate units.</span></span> <span data-ttu-id="187d1-157">A Figura 3-2 mostra como um aplicativo monolítico pode aproveitar os contêineres e os microserviços delegando determinados recursos ou funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="187d1-157">Figure 3-2 shows how a monolithic app can take advantage of containers and microservices by delegating certain features or functionality.</span></span> <span data-ttu-id="187d1-158">A funcionalidade restante no aplicativo também foi contida em contêineres.</span><span class="sxs-lookup"><span data-stu-id="187d1-158">The remaining functionality in the app itself has also been containerized.</span></span>

![Dividir um aplicativo monolítico para usar os microserviços no back-end.](./media/cloud-native-design.png)

<span data-ttu-id="187d1-160">**Figura 3-2**.</span><span class="sxs-lookup"><span data-stu-id="187d1-160">**Figure 3-2**.</span></span> <span data-ttu-id="187d1-161">Decompondo um aplicativo monolítico para abraçar os microserviços.</span><span class="sxs-lookup"><span data-stu-id="187d1-161">Decomposing a monolithic app to embrace microservices.</span></span>

<span data-ttu-id="187d1-162">Cada serviço nativo de nuvem é criado e implantado em um contêiner separado.</span><span class="sxs-lookup"><span data-stu-id="187d1-162">Each cloud-native service is built and deployed in a separate container.</span></span> <span data-ttu-id="187d1-163">Cada uma pode ser atualizada conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="187d1-163">Each can update as needed.</span></span> <span data-ttu-id="187d1-164">Serviços individuais podem ser hospedados em nós com recursos apropriados para cada serviço.</span><span class="sxs-lookup"><span data-stu-id="187d1-164">Individual services can be hosted on nodes with resources appropriate to each service.</span></span> <span data-ttu-id="187d1-165">O ambiente em que cada serviço é executado é imutável, compartilhado entre ambientes de desenvolvimento, teste e produção e com controle de versão com facilidade.</span><span class="sxs-lookup"><span data-stu-id="187d1-165">The environment each service runs in is immutable, shared across dev, test, and production environments, and easily versioned.</span></span> <span data-ttu-id="187d1-166">O acoplamento entre diferentes áreas do aplicativo ocorre explicitamente como chamadas ou mensagens entre serviços, não as dependências de tempo de compilação dentro do monolítico.</span><span class="sxs-lookup"><span data-stu-id="187d1-166">Coupling between different areas of the application occurs explicitly as calls or messages between services, not compile-time dependencies within the monolith.</span></span> <span data-ttu-id="187d1-167">Você também pode escolher a tecnologia que melhor suites um determinado recurso sem a necessidade de alterações no restante do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="187d1-167">You can also choose the technology that best suites a given capability without requiring changes to the rest of the app.</span></span>

<span data-ttu-id="187d1-168">Os serviços em contêineres exigem gerenciamento automatizado.</span><span class="sxs-lookup"><span data-stu-id="187d1-168">Containerized services require automated management.</span></span> <span data-ttu-id="187d1-169">Não seria possível administrar manualmente um grande conjunto de contêineres implantados de forma independente.</span><span class="sxs-lookup"><span data-stu-id="187d1-169">It wouldn't be feasible to manually administer a large set of independently deployed containers.</span></span> <span data-ttu-id="187d1-170">Por exemplo, considere as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="187d1-170">For example, consider the following tasks:</span></span>

- <span data-ttu-id="187d1-171">Como as instâncias de contêiner serão provisionadas em um cluster de vários computadores?</span><span class="sxs-lookup"><span data-stu-id="187d1-171">How will container instances be provisioned across a cluster of many machines?</span></span>
- <span data-ttu-id="187d1-172">Uma vez implantado, como os contêineres irão descobrir e se comunicar entre si?</span><span class="sxs-lookup"><span data-stu-id="187d1-172">Once deployed, how will containers discover and communicate with each other?</span></span>
- <span data-ttu-id="187d1-173">Como os contêineres podem ser expandidos ou reduzidos sob demanda?</span><span class="sxs-lookup"><span data-stu-id="187d1-173">How can containers scale in or out on-demand?</span></span>
- <span data-ttu-id="187d1-174">Como monitorar a integridade de cada contêiner?</span><span class="sxs-lookup"><span data-stu-id="187d1-174">How do you monitor the health of each container?</span></span>
- <span data-ttu-id="187d1-175">Como proteger um contêiner contra falhas de hardware e software?</span><span class="sxs-lookup"><span data-stu-id="187d1-175">How do you protect a container against hardware and software failures?</span></span>
- <span data-ttu-id="187d1-176">Como atualizar contêineres para um aplicativo em tempo real sem tempo de inatividade?</span><span class="sxs-lookup"><span data-stu-id="187d1-176">How do upgrade containers for a live application with zero downtime?</span></span>

<span data-ttu-id="187d1-177">Os orquestradores de contêiner abordam e automatizam essas e outras preocupações.</span><span class="sxs-lookup"><span data-stu-id="187d1-177">Container orchestrators address and automate these and other concerns.</span></span>

<span data-ttu-id="187d1-178">No sistema de eco nativo de nuvem, kubernetes tornou-se o orquestrador de contêiner de fato.</span><span class="sxs-lookup"><span data-stu-id="187d1-178">In the cloud-native eco-system, Kubernetes has become the de facto container orchestrator.</span></span> <span data-ttu-id="187d1-179">É uma plataforma de software livre gerenciada pela CNCF (nuvem Native Computing Foundation).</span><span class="sxs-lookup"><span data-stu-id="187d1-179">It's an open-source platform managed by the Cloud Native Computing Foundation (CNCF).</span></span> <span data-ttu-id="187d1-180">O kubernetes automatiza a implantação, o dimensionamento e as preocupações operacionais de cargas de trabalho em contêineres em um cluster de máquina.</span><span class="sxs-lookup"><span data-stu-id="187d1-180">Kubernetes automates the deployment, scaling, and operational concerns of containerized workloads across a machine cluster.</span></span> <span data-ttu-id="187d1-181">No entanto, a instalação e o gerenciamento do kubernetes são notoriamente complexos.</span><span class="sxs-lookup"><span data-stu-id="187d1-181">However, installing and managing Kubernetes is notoriously complex.</span></span>

<span data-ttu-id="187d1-182">Uma abordagem muito melhor é aproveitar o kubernetes como um serviço gerenciado de um fornecedor de nuvem.</span><span class="sxs-lookup"><span data-stu-id="187d1-182">A much better approach is to leverage Kubernetes as a managed service from a cloud vendor.</span></span> <span data-ttu-id="187d1-183">A nuvem do Azure apresenta uma plataforma kubernetes totalmente gerenciada chamada [AKs (serviço kubernetes do Azure)](https://azure.microsoft.com/services/kubernetes-service/).</span><span class="sxs-lookup"><span data-stu-id="187d1-183">The Azure cloud features a fully managed Kubernetes platform entitled [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/).</span></span> <span data-ttu-id="187d1-184">O AKS abstrai a complexidade e a sobrecarga operacional do gerenciamento de kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-184">AKS abstracts the complexity and operational overhead of managing Kubernetes.</span></span> <span data-ttu-id="187d1-185">Você consome kubernetes como um serviço de nuvem; A Microsoft assume a responsabilidade por gerenciar e dar suporte a ela.</span><span class="sxs-lookup"><span data-stu-id="187d1-185">You consume Kubernetes as a cloud service; Microsoft takes responsibility for managing and supporting it.</span></span> <span data-ttu-id="187d1-186">O AKS também se integra perfeitamente com outros serviços do Azure e ferramentas de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="187d1-186">AKS also tightly integrates with other Azure services and dev tools.</span></span>

<span data-ttu-id="187d1-187">AKS é uma tecnologia baseada em cluster.</span><span class="sxs-lookup"><span data-stu-id="187d1-187">AKS is a cluster-based technology.</span></span> <span data-ttu-id="187d1-188">Um pool de máquinas virtuais federadas, ou nós, é implantado na nuvem do Azure.</span><span class="sxs-lookup"><span data-stu-id="187d1-188">A pool of federated virtual machines, or nodes, is deployed to the Azure cloud.</span></span> <span data-ttu-id="187d1-189">Juntos, eles formam um ambiente altamente disponível ou cluster.</span><span class="sxs-lookup"><span data-stu-id="187d1-189">Together they form a highly available environment, or cluster.</span></span> <span data-ttu-id="187d1-190">O cluster aparece como uma entidade simples e direta para seu aplicativo nativo de nuvem.</span><span class="sxs-lookup"><span data-stu-id="187d1-190">The cluster appears as a seamless, single entity to your cloud-native application.</span></span> <span data-ttu-id="187d1-191">Nos bastidores, o AKS implanta seus serviços em contêineres entre esses nós seguindo uma estratégia predefinida que distribui uniformemente a carga.</span><span class="sxs-lookup"><span data-stu-id="187d1-191">Under the hood, AKS deploys your containerized services across these nodes following a predefined strategy that evenly distributes the load.</span></span>

## <a name="what-are-the-scaling-benefits"></a><span data-ttu-id="187d1-192">Quais são os benefícios de dimensionamento?</span><span class="sxs-lookup"><span data-stu-id="187d1-192">What are the scaling benefits?</span></span>

<span data-ttu-id="187d1-193">Os serviços criados nos contêineres podem aproveitar os benefícios de dimensionamento fornecidos pelas ferramentas de orquestração como o kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-193">Services built on containers can leverage scaling benefits provided by orchestration tools like Kubernetes.</span></span> <span data-ttu-id="187d1-194">Os contêineres de design só sabem sobre si mesmos.</span><span class="sxs-lookup"><span data-stu-id="187d1-194">By design containers only know about themselves.</span></span> <span data-ttu-id="187d1-195">Depois de ter vários contêineres que precisam trabalhar juntos, você deve organizá-los em um nível mais alto.</span><span class="sxs-lookup"><span data-stu-id="187d1-195">Once you have multiple containers that need to work together, you should organize them at a higher level.</span></span> <span data-ttu-id="187d1-196">Organizar grandes números de contêineres e suas dependências compartilhadas, como a configuração de rede, é onde as ferramentas de orquestração entram para economizar o dia!</span><span class="sxs-lookup"><span data-stu-id="187d1-196">Organizing large numbers of containers and their shared dependencies, such as network configuration, is where orchestration tools come in to save the day!</span></span> <span data-ttu-id="187d1-197">O kubernetes cria uma camada de abstração em grupos de contêineres e os organiza em *pods*.</span><span class="sxs-lookup"><span data-stu-id="187d1-197">Kubernetes creates an abstraction layer over groups of containers and organizes them into *pods*.</span></span> <span data-ttu-id="187d1-198">O pods é executado em computadores de trabalho conhecidos como *nós*.</span><span class="sxs-lookup"><span data-stu-id="187d1-198">Pods run on worker machines referred to as *nodes*.</span></span> <span data-ttu-id="187d1-199">Essa estrutura organizada é conhecida como um *cluster*.</span><span class="sxs-lookup"><span data-stu-id="187d1-199">This organized structure is referred to as a *cluster*.</span></span> <span data-ttu-id="187d1-200">A Figura 3-3 mostra os diferentes componentes de um cluster kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-200">Figure 3-3 shows the different components of a Kubernetes cluster.</span></span>

<span data-ttu-id="187d1-201">![Componentes do cluster kubernetes. ](./media/kubernetes-cluster-components.png)
 **Figura 3-3**.</span><span class="sxs-lookup"><span data-stu-id="187d1-201">![Kubernetes cluster components.](./media/kubernetes-cluster-components.png)
**Figure 3-3**.</span></span> <span data-ttu-id="187d1-202">Componentes do cluster kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-202">Kubernetes cluster components.</span></span>

<span data-ttu-id="187d1-203">Dimensionar cargas de trabalho em contêineres é um recurso importante de orquestradores de contêiner.</span><span class="sxs-lookup"><span data-stu-id="187d1-203">Scaling containerized workloads is a key feature of container orchestrators.</span></span> <span data-ttu-id="187d1-204">O AKS dá suporte ao dimensionamento automático em duas dimensões: instâncias de contêiner e nós de computação.</span><span class="sxs-lookup"><span data-stu-id="187d1-204">AKS supports automatic scaling across two dimensions: Container instances and compute nodes.</span></span> <span data-ttu-id="187d1-205">Juntos, eles oferecem ao AKS a capacidade de responder de maneira rápida e eficiente a picos de demanda e adicionar recursos adicionais.</span><span class="sxs-lookup"><span data-stu-id="187d1-205">Together they give AKS the ability to quickly and efficiently respond to spikes in demand and add additional resources.</span></span> <span data-ttu-id="187d1-206">Discutiremos o dimensionamento em AKS mais adiante neste capítulo.</span><span class="sxs-lookup"><span data-stu-id="187d1-206">We discuss scaling in AKS later in this chapter.</span></span>

### <a name="declarative-versus-imperative"></a><span data-ttu-id="187d1-207">Declarativa versus imperativo</span><span class="sxs-lookup"><span data-stu-id="187d1-207">Declarative versus imperative</span></span>

<span data-ttu-id="187d1-208">O kubernetes dá suporte à configuração declarativa e imperativa.</span><span class="sxs-lookup"><span data-stu-id="187d1-208">Kubernetes supports both declarative and imperative configuration.</span></span> <span data-ttu-id="187d1-209">A abordagem imperativa envolve a execução de vários comandos que dizem ao kubernetes o que fazer em cada etapa do caminho.</span><span class="sxs-lookup"><span data-stu-id="187d1-209">The imperative approach involves running various commands that tell Kubernetes what to do each step of the way.</span></span> <span data-ttu-id="187d1-210">Executar esta imagem.</span><span class="sxs-lookup"><span data-stu-id="187d1-210">Run this image.</span></span> <span data-ttu-id="187d1-211">Excluir este Pod.</span><span class="sxs-lookup"><span data-stu-id="187d1-211">Delete this pod.</span></span> <span data-ttu-id="187d1-212">Expor esta porta.</span><span class="sxs-lookup"><span data-stu-id="187d1-212">Expose this port.</span></span> <span data-ttu-id="187d1-213">Com a abordagem declarativa, você cria um arquivo de configuração, chamado de manifesto, para descrever o que você deseja em vez do que fazer.</span><span class="sxs-lookup"><span data-stu-id="187d1-213">With the declarative approach, you create a configuration file, called a manifest, to describe what you want instead of what to do.</span></span> <span data-ttu-id="187d1-214">Kubernetes lê o manifesto e transforma o estado final desejado no estado de término real.</span><span class="sxs-lookup"><span data-stu-id="187d1-214">Kubernetes reads the manifest and transforms your desired end state into actual end state.</span></span>

<span data-ttu-id="187d1-215">Os comandos imperativos são ótimos para aprendizado e experimentação interativa.</span><span class="sxs-lookup"><span data-stu-id="187d1-215">Imperative commands are great for learning and interactive experimentation.</span></span> <span data-ttu-id="187d1-216">No entanto, você desejará criar declarativamente arquivos de manifesto kubernetes para adotar uma infraestrutura como abordagem de código, fornecendo implantações confiáveis e reproduzíveis.</span><span class="sxs-lookup"><span data-stu-id="187d1-216">However, you'll want to declaratively create Kubernetes manifest files to embrace an infrastructure as code approach, providing for reliable and repeatable deployments.</span></span> <span data-ttu-id="187d1-217">O arquivo de manifesto se torna um artefato de projeto e é usado em seu pipeline de CI/CD para automatizar implantações de kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-217">The manifest file becomes a project artifact and is used in your CI/CD pipeline for automating Kubernetes deployments.</span></span>

<span data-ttu-id="187d1-218">Se você já tiver configurado o cluster usando comandos imperativos, poderá exportar um manifesto declarativo usando o `kubectl get svc SERVICENAME -o yaml > service.yaml` .</span><span class="sxs-lookup"><span data-stu-id="187d1-218">If you've already configured your cluster using imperative commands, you can export a declarative manifest by using `kubectl get svc SERVICENAME -o yaml > service.yaml`.</span></span> <span data-ttu-id="187d1-219">Esse comando produz um manifesto semelhante a um mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="187d1-219">This command produces a manifest similar to one shown below:</span></span>

```yaml
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: "2019-09-13T13:58:47Z"
  labels:
    component: apiserver
    provider: kubernetes
  name: kubernetes
  namespace: default
  resourceVersion: "153"
  selfLink: /api/v1/namespaces/default/services/kubernetes
  uid: 9b1fac62-d62e-11e9-8968-00155d38010d
spec:
  clusterIP: 10.96.0.1
  ports:
  - name: https
    port: 443
    protocol: TCP
    targetPort: 6443
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
```

<span data-ttu-id="187d1-220">Ao usar a configuração declarativa, você pode visualizar as alterações que serão feitas antes de confirmá-las usando `kubectl diff -f FOLDERNAME` a pasta em que os arquivos de configuração estão localizados.</span><span class="sxs-lookup"><span data-stu-id="187d1-220">When using declarative configuration, you can preview the changes that will be made before committing them by using `kubectl diff -f FOLDERNAME` against the folder where your configuration files are located.</span></span> <span data-ttu-id="187d1-221">Quando tiver certeza de que deseja aplicar as alterações, execute `kubectl apply -f FOLDERNAME` .</span><span class="sxs-lookup"><span data-stu-id="187d1-221">Once you're sure you want to apply the changes, run `kubectl apply -f FOLDERNAME`.</span></span> <span data-ttu-id="187d1-222">Adicionar `-R` para processar recursivamente uma hierarquia de pastas.</span><span class="sxs-lookup"><span data-stu-id="187d1-222">Add `-R` to recursively process a folder hierarchy.</span></span>

<span data-ttu-id="187d1-223">Você também pode usar a configuração declarativa com outros recursos do kubernetes, um dos quais sendo implantações.</span><span class="sxs-lookup"><span data-stu-id="187d1-223">You can also use declarative configuration with other Kubernetes features, one of which being deployments.</span></span> <span data-ttu-id="187d1-224">As implantações declarativas ajudam a gerenciar versões, atualizações e dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="187d1-224">Declarative deployments help manage releases, updates, and scaling.</span></span> <span data-ttu-id="187d1-225">Eles instruem o controlador de implantação kubernetes sobre como implantar novas alterações, escalar horizontalmente a carga ou reverter para uma revisão anterior.</span><span class="sxs-lookup"><span data-stu-id="187d1-225">They instruct the Kubernetes deployment controller on how to deploy new changes, scale out load, or roll back to a previous revision.</span></span> <span data-ttu-id="187d1-226">Se um cluster estiver instável, uma implantação declarativa retornará automaticamente o cluster de volta para um estado desejado.</span><span class="sxs-lookup"><span data-stu-id="187d1-226">If a cluster is unstable, a declarative deployment will automatically return the cluster back to a desired state.</span></span> <span data-ttu-id="187d1-227">Por exemplo, se um nó deve falhar, o mecanismo de implantação reimplantará uma substituição para atingir o estado desejado</span><span class="sxs-lookup"><span data-stu-id="187d1-227">For example, if a node should crash, the deployment mechanism will redeploy a replacement to achieve your desired state</span></span>

<span data-ttu-id="187d1-228">O uso da configuração declarativa permite que a infraestrutura seja representada como código que pode ser verificado e com controle de versão junto com o código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="187d1-228">Using declarative configuration allows infrastructure to be represented as code that can be checked in and versioned alongside the application code.</span></span> <span data-ttu-id="187d1-229">Ele fornece controle de alterações aprimorado e melhor suporte para implantação contínua usando um pipeline de compilação e implantação.</span><span class="sxs-lookup"><span data-stu-id="187d1-229">It provides improved change control and better support for continuous deployment using a build and deploy pipeline.</span></span>

## <a name="what-scenarios-are-ideal-for-containers-and-orchestrators"></a><span data-ttu-id="187d1-230">Quais cenários são ideais para contêineres e orquestradores?</span><span class="sxs-lookup"><span data-stu-id="187d1-230">What scenarios are ideal for containers and orchestrators?</span></span>

<span data-ttu-id="187d1-231">Os cenários a seguir são ideais para usar contêineres e orquestradores.</span><span class="sxs-lookup"><span data-stu-id="187d1-231">The following scenarios are ideal for using containers and orchestrators.</span></span>

### <a name="applications-requiring-high-uptime-and-scalability"></a><span data-ttu-id="187d1-232">Aplicativos que exigem alto tempo de atividade e escalabilidade</span><span class="sxs-lookup"><span data-stu-id="187d1-232">Applications requiring high uptime and scalability</span></span>

<span data-ttu-id="187d1-233">Os aplicativos individuais que têm altos requisitos de tempo de atividade e escalabilidade são candidatos ideais para arquiteturas nativas de nuvem usando microservices, contêineres e orquestradores.</span><span class="sxs-lookup"><span data-stu-id="187d1-233">Individual applications that have high uptime and scalability requirements are ideal candidates for cloud-native architectures using microservices, containers, and orchestrators.</span></span> <span data-ttu-id="187d1-234">Eles podem ser desenvolvidos em contêineres, testados em ambientes com controle de versão e implantados em produção com tempo de inatividade zero.</span><span class="sxs-lookup"><span data-stu-id="187d1-234">They can be developed in containers, tested across versioned environments, and deployed into production with zero downtime.</span></span> <span data-ttu-id="187d1-235">O uso de clusters kubernetes garante que esses aplicativos também possam ser dimensionados sob demanda e recuperados automaticamente de falhas de nó.</span><span class="sxs-lookup"><span data-stu-id="187d1-235">The use of Kubernetes clusters ensures such apps can also scale on demand and recover automatically from node failures.</span></span>

### <a name="large-numbers-of-applications"></a><span data-ttu-id="187d1-236">Grandes números de aplicativos</span><span class="sxs-lookup"><span data-stu-id="187d1-236">Large numbers of applications</span></span>

<span data-ttu-id="187d1-237">As organizações que implantam e mantêm um grande número de aplicativos se beneficiam de contêineres e orquestradores.</span><span class="sxs-lookup"><span data-stu-id="187d1-237">Organizations that deploy and maintain large numbers of applications benefit from containers and orchestrators.</span></span> <span data-ttu-id="187d1-238">O esforço antecipado de configurar ambientes em contêineres e clusters kubernetes é, principalmente, um custo fixo.</span><span class="sxs-lookup"><span data-stu-id="187d1-238">The up front effort of setting up containerized environments and Kubernetes clusters is primarily a fixed cost.</span></span> <span data-ttu-id="187d1-239">Implantar, manter e atualizar aplicativos individuais tem um custo que varia de acordo com o número de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="187d1-239">Deploying, maintaining, and updating individual applications has a cost that varies with the number of applications.</span></span> <span data-ttu-id="187d1-240">Além de um pequeno número de aplicativos, a complexidade da manutenção manual de aplicativos personalizados excede o custo da implementação de uma solução usando contêineres e orquestradores.</span><span class="sxs-lookup"><span data-stu-id="187d1-240">Beyond a small number of applications, the complexity of maintaining custom applications manually exceeds the cost of implementing a solution using containers and orchestrators.</span></span>

## <a name="when-should-you-avoid-using-containers-and-orchestrators"></a><span data-ttu-id="187d1-241">Quando você deve evitar o uso de contêineres e orquestradores?</span><span class="sxs-lookup"><span data-stu-id="187d1-241">When should you avoid using containers and orchestrators?</span></span>

<span data-ttu-id="187d1-242">Se não for possível criar seu aplicativo seguindo os princípios do aplicativo de doze fatores, considere evitar contêineres e orquestradores.</span><span class="sxs-lookup"><span data-stu-id="187d1-242">If you're unable to build your application following the Twelve-Factor App principles, you should consider avoiding containers and orchestrators.</span></span> <span data-ttu-id="187d1-243">Nesses casos, considere uma plataforma de hospedagem baseada em VM ou possivelmente algum sistema híbrido.</span><span class="sxs-lookup"><span data-stu-id="187d1-243">In these cases, consider a VM-based hosting platform, or possibly some hybrid system.</span></span> <span data-ttu-id="187d1-244">Com ele, você sempre pode girar determinadas partes de funcionalidade em contêineres separados ou mesmo em funções sem servidor.</span><span class="sxs-lookup"><span data-stu-id="187d1-244">With it, you can always spin off certain pieces of functionality into separate containers or even serverless functions.</span></span>

## <a name="development-resources"></a><span data-ttu-id="187d1-245">Recursos de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="187d1-245">Development resources</span></span>

<span data-ttu-id="187d1-246">Esta seção mostra uma lista curta de recursos de desenvolvimento que podem ajudá-lo a começar a usar contêineres e orquestradores para seu próximo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="187d1-246">This section shows a short list of development resources that may help you get started using containers and orchestrators for your next application.</span></span> <span data-ttu-id="187d1-247">Se você estiver procurando orientação sobre como projetar seu aplicativo de arquitetura de microserviços nativos de nuvem, leia o complemento deste livro, [microservices .net: arquitetura para aplicativos .net em contêineres](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook).</span><span class="sxs-lookup"><span data-stu-id="187d1-247">If you're looking for guidance on how to design your cloud-native microservices architecture app, read this book's companion, [.NET Microservices: Architecture for Containerized .NET Applications](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook).</span></span>

### <a name="local-kubernetes-development"></a><span data-ttu-id="187d1-248">Desenvolvimento de kubernetes local</span><span class="sxs-lookup"><span data-stu-id="187d1-248">Local Kubernetes Development</span></span>

<span data-ttu-id="187d1-249">As implantações kubernetes fornecem um ótimo valor em ambientes de produção, mas também podem ser executadas localmente em seu computador de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="187d1-249">Kubernetes deployments provide great value in production environments, but can also run locally on your development machine.</span></span> <span data-ttu-id="187d1-250">Embora você possa trabalhar em microserviços individuais de forma independente, pode haver ocasiões em que você precisará executar todo o sistema localmente, assim como ele será executado quando implantado na produção.</span><span class="sxs-lookup"><span data-stu-id="187d1-250">While you may work on individual microservices independently, there may be times when you'll need to run the entire system locally - just as it will run when deployed to production.</span></span> <span data-ttu-id="187d1-251">Há várias ferramentas que podem ajudar: Minikube e Docker desktop.</span><span class="sxs-lookup"><span data-stu-id="187d1-251">There are several tools that can help: Minikube and Docker Desktop.</span></span> <span data-ttu-id="187d1-252">O Visual Studio também fornece ferramentas para o desenvolvimento do Docker.</span><span class="sxs-lookup"><span data-stu-id="187d1-252">Visual Studio also provides tooling for Docker development.</span></span>

### <a name="minikube"></a><span data-ttu-id="187d1-253">Minikube</span><span class="sxs-lookup"><span data-stu-id="187d1-253">Minikube</span></span>

<span data-ttu-id="187d1-254">O que é o Minikube?</span><span class="sxs-lookup"><span data-stu-id="187d1-254">What is Minikube?</span></span> <span data-ttu-id="187d1-255">O projeto Minikube diz "Minikube implementa um cluster kubernetes local no macOS, Linux e Windows."</span><span class="sxs-lookup"><span data-stu-id="187d1-255">The Minikube project says "Minikube implements a local Kubernetes cluster on macOS, Linux, and Windows."</span></span> <span data-ttu-id="187d1-256">Suas metas principais são "para ser a melhor ferramenta para o desenvolvimento de aplicativos kubernetes local e para dar suporte a todos os recursos do kubernetes que se ajustam".</span><span class="sxs-lookup"><span data-stu-id="187d1-256">Its primary goals are "to be the best tool for local Kubernetes application development and to support all Kubernetes features that fit."</span></span> <span data-ttu-id="187d1-257">A instalação do Minikube é separada do Docker, mas o Minikube dá suporte a diferentes hipervisores do que o Docker desktop dá suporte.</span><span class="sxs-lookup"><span data-stu-id="187d1-257">Installing Minikube is separate from Docker, but Minikube supports different hypervisors than Docker Desktop supports.</span></span> <span data-ttu-id="187d1-258">Atualmente, há suporte para os seguintes recursos de kubernetes pelo Minikube:</span><span class="sxs-lookup"><span data-stu-id="187d1-258">The following Kubernetes features are currently supported by Minikube:</span></span>

- <span data-ttu-id="187d1-259">DNS</span><span class="sxs-lookup"><span data-stu-id="187d1-259">DNS</span></span>
- <span data-ttu-id="187d1-260">NodePorts</span><span class="sxs-lookup"><span data-stu-id="187d1-260">NodePorts</span></span>
- <span data-ttu-id="187d1-261">ConfigMaps e segredos</span><span class="sxs-lookup"><span data-stu-id="187d1-261">ConfigMaps and secrets</span></span>
- <span data-ttu-id="187d1-262">Painéis</span><span class="sxs-lookup"><span data-stu-id="187d1-262">Dashboards</span></span>
- <span data-ttu-id="187d1-263">Tempos de execução de contêiner: Docker, RKT, CRI-O e em contêineres</span><span class="sxs-lookup"><span data-stu-id="187d1-263">Container runtimes: Docker, rkt, CRI-O, and containerd</span></span>
- <span data-ttu-id="187d1-264">Habilitando o CNI (interface de rede de contêiner)</span><span class="sxs-lookup"><span data-stu-id="187d1-264">Enabling Container Network Interface (CNI)</span></span>
- <span data-ttu-id="187d1-265">Entrada</span><span class="sxs-lookup"><span data-stu-id="187d1-265">Ingress</span></span>

<span data-ttu-id="187d1-266">Depois de instalar o Minikube, você pode começar rapidamente a usá-lo executando o `minikube start` comando, que baixa uma imagem e inicia o cluster kubernetes local.</span><span class="sxs-lookup"><span data-stu-id="187d1-266">After installing Minikube, you can quickly start using it by running the `minikube start` command, which downloads an image and start the local Kubernetes cluster.</span></span> <span data-ttu-id="187d1-267">Depois que o cluster é iniciado, você interage com ele usando os comandos padrão do kubernetes `kubectl` .</span><span class="sxs-lookup"><span data-stu-id="187d1-267">Once the cluster is started, you interact with it using the standard Kubernetes `kubectl` commands.</span></span>

### <a name="docker-desktop"></a><span data-ttu-id="187d1-268">Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="187d1-268">Docker Desktop</span></span>

<span data-ttu-id="187d1-269">Você também pode trabalhar com kubernetes diretamente da área de trabalho do Docker no Windows.</span><span class="sxs-lookup"><span data-stu-id="187d1-269">You can also work with Kubernetes directly from Docker Desktop on Windows.</span></span> <span data-ttu-id="187d1-270">É sua única opção se você estiver usando contêineres do Windows e também é uma ótima opção para contêineres que não são do Windows.</span><span class="sxs-lookup"><span data-stu-id="187d1-270">It is your only option if you're using Windows Containers, and is a great choice for non-Windows containers as well.</span></span> <span data-ttu-id="187d1-271">A Figura 3-4 mostra como habilitar o suporte a kubernetes local ao executar o Docker desktop.</span><span class="sxs-lookup"><span data-stu-id="187d1-271">Figure 3-4 shows how to enable local Kubernetes support when running Docker Desktop.</span></span>

![Configurando o kubernetes no Docker desktop](./media/docker-desktop-kubernetes.png)

<span data-ttu-id="187d1-273">**Figura 3-4**.</span><span class="sxs-lookup"><span data-stu-id="187d1-273">**Figure 3-4**.</span></span> <span data-ttu-id="187d1-274">Configurando o kubernetes no Docker desktop.</span><span class="sxs-lookup"><span data-stu-id="187d1-274">Configuring Kubernetes in Docker Desktop.</span></span>

<span data-ttu-id="187d1-275">O Docker desktop é a ferramenta mais popular para configurar e executar aplicativos em contêineres localmente.</span><span class="sxs-lookup"><span data-stu-id="187d1-275">Docker Desktop is the most popular tool for configuring and running containerized apps locally.</span></span> <span data-ttu-id="187d1-276">Ao trabalhar com o Docker desktop, você pode desenvolver localmente no mesmo conjunto de imagens de contêiner do Docker que você implantará na produção.</span><span class="sxs-lookup"><span data-stu-id="187d1-276">When you work with Docker Desktop, you can develop locally against the exact same set of Docker container images that you'll deploy to production.</span></span> <span data-ttu-id="187d1-277">O Docker desktop foi projetado para "Compilar, testar e enviar" aplicativos em contêineres localmente.</span><span class="sxs-lookup"><span data-stu-id="187d1-277">Docker Desktop is designed to "build, test, and ship" containerized apps locally.</span></span> <span data-ttu-id="187d1-278">Ele dá suporte a contêineres do Linux e do Windows.</span><span class="sxs-lookup"><span data-stu-id="187d1-278">It supports both Linux and Windows containers.</span></span> <span data-ttu-id="187d1-279">Depois de enviar suas imagens por push para um registro de imagem, como o registro de contêiner do Azure ou o Hub do Docker, o AKS pode efetuar pull e implantá-las na produção.</span><span class="sxs-lookup"><span data-stu-id="187d1-279">Once you push your images to an image registry, like Azure Container Registry or Docker Hub, AKS can pull and deploy them to production.</span></span>

### <a name="visual-studio-docker-tooling"></a><span data-ttu-id="187d1-280">Ferramentas do Docker do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-280">Visual Studio Docker Tooling</span></span>

<span data-ttu-id="187d1-281">O Visual Studio dá suporte ao desenvolvimento do Docker para aplicativos baseados na Web.</span><span class="sxs-lookup"><span data-stu-id="187d1-281">Visual Studio supports Docker development for web-based applications.</span></span> <span data-ttu-id="187d1-282">Ao criar um novo aplicativo ASP.NET Core, você tem a opção de configurá-lo com o suporte do Docker, como mostra a Figura 3-5.</span><span class="sxs-lookup"><span data-stu-id="187d1-282">When you create a new ASP.NET Core application, you have an option to configure it with Docker support, as shown in Figure 3-5.</span></span>

![Habilitar o suporte do Docker ao Visual Studio](./media/visual-studio-enable-docker-support.png)

<span data-ttu-id="187d1-284">**Figura 3-5**.</span><span class="sxs-lookup"><span data-stu-id="187d1-284">**Figure 3-5**.</span></span> <span data-ttu-id="187d1-285">Habilitar o suporte do Docker ao Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-285">Visual Studio Enable Docker Support</span></span>

<span data-ttu-id="187d1-286">Quando essa opção é selecionada, o projeto é criado com um `Dockerfile` em sua raiz, que pode ser usado para criar e hospedar o aplicativo em um contêiner do Docker.</span><span class="sxs-lookup"><span data-stu-id="187d1-286">When this option is selected, the project is created with a `Dockerfile` in its root, which can be used to build and host the app in a Docker container.</span></span> <span data-ttu-id="187d1-287">Um exemplo de Dockerfile é mostrado na Figura 3 -6. git</span><span class="sxs-lookup"><span data-stu-id="187d1-287">An example Dockerfile is shown in Figure 3-6.git</span></span>

```dockerfile
FROM mcr.microsoft.com/dotnet/core/aspnet:3.1-buster-slim AS base
WORKDIR /app
EXPOSE 80
EXPOSE 443

FROM mcr.microsoft.com/dotnet/core/sdk:3.1-buster AS build
WORKDIR /src
COPY ["eShopWeb/eShopWeb.csproj", "eShopWeb/"]
RUN dotnet restore "eShopWeb/eShopWeb.csproj"
COPY . .
WORKDIR "/src/eShopWeb"
RUN dotnet build "eShopWeb.csproj" -c Release -o /app/build

FROM build AS publish
RUN dotnet publish "eShopWeb.csproj" -c Release -o /app/publish

FROM base AS final
WORKDIR /app
COPY --from=publish /app/publish .
ENTRYPOINT ["dotnet", "eShopWeb.dll"]
```

<span data-ttu-id="187d1-288">**Figura 3-6**.</span><span class="sxs-lookup"><span data-stu-id="187d1-288">**Figure 3-6**.</span></span> <span data-ttu-id="187d1-289">Dockerfile gerado pelo Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-289">Visual Studio generated Dockerfile</span></span>

<span data-ttu-id="187d1-290">O comportamento padrão quando o aplicativo é executado é configurado para usar o Docker também.</span><span class="sxs-lookup"><span data-stu-id="187d1-290">The default behavior when the app runs is configured to use Docker as well.</span></span> <span data-ttu-id="187d1-291">A Figura 3-7 mostra as diferentes opções de execução disponíveis em um novo projeto ASP.NET Core criado com o suporte do Docker adicionado.</span><span class="sxs-lookup"><span data-stu-id="187d1-291">Figure 3-7 shows the different run options available from a new ASP.NET Core project created with Docker support added.</span></span>

![Opções de execução do Docker do Visual Studio](./media/visual-studio-docker-run-options.png)

<span data-ttu-id="187d1-293">**Figura 3-7**.</span><span class="sxs-lookup"><span data-stu-id="187d1-293">**Figure 3-7**.</span></span> <span data-ttu-id="187d1-294">Opções de execução do Docker do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-294">Visual Studio Docker Run Options</span></span>

<span data-ttu-id="187d1-295">Além do desenvolvimento local, o [Azure dev Spaces](/azure/dev-spaces/) fornece uma maneira conveniente para vários desenvolvedores trabalharem com suas próprias configurações de kubernetes no Azure.</span><span class="sxs-lookup"><span data-stu-id="187d1-295">In addition to local development, [Azure Dev Spaces](/azure/dev-spaces/) provides a convenient way for multiple developers to work with their own Kubernetes configurations within Azure.</span></span> <span data-ttu-id="187d1-296">Como você pode ver na Figura 3-7, você também pode executar o aplicativo em Azure Dev Spaces.</span><span class="sxs-lookup"><span data-stu-id="187d1-296">As you can see in Figure 3-7, you can also run the application in Azure Dev Spaces.</span></span>

<span data-ttu-id="187d1-297">Além disso, a qualquer momento você pode adicionar o suporte do Docker a um aplicativo ASP.NET Core existente.</span><span class="sxs-lookup"><span data-stu-id="187d1-297">Also, at any time you can add Docker support to an existing ASP.NET Core application.</span></span> <span data-ttu-id="187d1-298">No Gerenciador de soluções do Visual Studio, clique com o botão direito do mouse no projeto e selecione **Adicionar**  >  **suporte ao Docker**, conforme mostrado na Figura 3-8.</span><span class="sxs-lookup"><span data-stu-id="187d1-298">From the Visual Studio Solution Explorer, right-click on the project and select **Add** > **Docker Support**, as shown in Figure 3-8.</span></span>

![Adicionar suporte ao Docker ao Visual Studio](./media/visual-studio-add-docker-support.png)

<span data-ttu-id="187d1-300">**Figura 3-8**.</span><span class="sxs-lookup"><span data-stu-id="187d1-300">**Figure 3-8**.</span></span> <span data-ttu-id="187d1-301">Adicionando suporte ao Docker ao Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-301">Adding Docker support to Visual Studio</span></span>

<span data-ttu-id="187d1-302">Você também pode adicionar suporte à orquestração de contêiner, também mostrada na Figura 3-8.</span><span class="sxs-lookup"><span data-stu-id="187d1-302">You can also add Container Orchestration Support, also shown in Figure 3-8.</span></span> <span data-ttu-id="187d1-303">Por padrão, o orquestrador usa kubernetes e Helm.</span><span class="sxs-lookup"><span data-stu-id="187d1-303">By default, the orchestrator uses Kubernetes and Helm.</span></span> <span data-ttu-id="187d1-304">Depois de escolher o orquestrador, um `azds.yaml` arquivo é adicionado à raiz do projeto e uma `charts` pasta é adicionada contendo os gráficos Helm usados para configurar e implantar o aplicativo no kubernetes.</span><span class="sxs-lookup"><span data-stu-id="187d1-304">Once you've chosen the orchestrator, a `azds.yaml` file is added to the project root and a `charts` folder is added containing the Helm charts used to configure and deploy the application to Kubernetes.</span></span> <span data-ttu-id="187d1-305">A Figura 3-9 mostra os arquivos resultantes em um novo projeto.</span><span class="sxs-lookup"><span data-stu-id="187d1-305">Figure 3-9 shows the resulting files in a new project.</span></span>

![Adicionar suporte ao Orchestrator no Visual Studio](./media/visual-studio-add-orchestrator-support.png)

<span data-ttu-id="187d1-307">**Figura 3-9**.</span><span class="sxs-lookup"><span data-stu-id="187d1-307">**Figure 3-9**.</span></span> <span data-ttu-id="187d1-308">Adicionando suporte de orquestração ao Visual Studio</span><span class="sxs-lookup"><span data-stu-id="187d1-308">Adding orchestration support to Visual Studio</span></span>

### <a name="visual-studio-code-docker-tooling"></a><span data-ttu-id="187d1-309">Visual Studio Code ferramentas do Docker</span><span class="sxs-lookup"><span data-stu-id="187d1-309">Visual Studio Code Docker Tooling</span></span>

<span data-ttu-id="187d1-310">Há várias extensões disponíveis para Visual Studio Code que dão suporte ao desenvolvimento do Docker.</span><span class="sxs-lookup"><span data-stu-id="187d1-310">There are a number of extensions available for Visual Studio Code that support Docker development.</span></span>

<span data-ttu-id="187d1-311">A Microsoft fornece o [Docker para a extensão de Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker).</span><span class="sxs-lookup"><span data-stu-id="187d1-311">Microsoft provides the [Docker for Visual Studio Code extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker).</span></span> <span data-ttu-id="187d1-312">Essa extensão simplifica o processo de adição de suporte a contêineres a aplicativos.</span><span class="sxs-lookup"><span data-stu-id="187d1-312">This extension simplifies the process of adding container support to applications.</span></span> <span data-ttu-id="187d1-313">Ele aplica Scaffold arquivos necessários, cria imagens do Docker e permite que você depure seu aplicativo dentro de um contêiner.</span><span class="sxs-lookup"><span data-stu-id="187d1-313">It scaffolds required files, builds Docker images, and enables you to debug your app inside a container.</span></span> <span data-ttu-id="187d1-314">A extensão apresenta um Visual Explorer que torna mais fácil executar ações em contêineres e imagens como iniciar, parar, inspecionar, remover e muito mais.</span><span class="sxs-lookup"><span data-stu-id="187d1-314">The extension features a visual explorer that makes it easy to take actions on containers and images such as start, stop, inspect, remove, and more.</span></span> <span data-ttu-id="187d1-315">A extensão também dá suporte a Docker Compose permitindo que você gerencie vários contêineres em execução como uma única unidade.</span><span class="sxs-lookup"><span data-stu-id="187d1-315">The extension also supports Docker Compose enabling you to manage multiple running containers as a single unit.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="187d1-316">[Anterior](scale-applications.md) 
> [Avançar](leverage-serverless-functions.md)</span><span class="sxs-lookup"><span data-stu-id="187d1-316">[Previous](scale-applications.md)
[Next](leverage-serverless-functions.md)</span></span>
