---
title: REST e gRPC
description: Saiba mais sobre o gRPC, sua função em aplicativos nativos de nuvem e como ele difere do HTTP REST
author: robvet
ms.date: 09/08/2019
ms.openlocfilehash: 4baccccf12bcd76366a4a934bb39a41d76ac11e0
ms.sourcegitcommit: 5a28f8eb071fcc09b045b0c4ae4b96898673192e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/31/2019
ms.locfileid: "73191996"
---
# <a name="rest-and-grpc"></a><span data-ttu-id="0d626-103">REST e gRPC</span><span class="sxs-lookup"><span data-stu-id="0d626-103">REST and gRPC</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="0d626-104">Até agora neste livro, nos concentramos na comunicação [baseada em REST](https://docs.microsoft.com/azure/architecture/best-practices/api-design) .</span><span class="sxs-lookup"><span data-stu-id="0d626-104">So far in this book, we’ve focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="0d626-105">O REST é um estilo de arquitetura que promove a interoperabilidade entre sistemas de computadores distribuídos.</span><span class="sxs-lookup"><span data-stu-id="0d626-105">REST is an architectural style that promotes interoperability between distributed computer systems.</span></span> <span data-ttu-id="0d626-106">Ele usa um modelo de solicitação/resposta em que cada resposta do servidor é para uma solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="0d626-106">It uses a request/response model where every response from the server is to a request from the client.</span></span> <span data-ttu-id="0d626-107">Embora seja amplamente popular, o REST não é perfeito para cada problema.</span><span class="sxs-lookup"><span data-stu-id="0d626-107">While widely popular, REST isn't a perfect fit for every problem.</span></span> <span data-ttu-id="0d626-108">Uma tecnologia de comunicação mais recente, chamada gRPC, está ganhando popularidade rapidamente e dando seu caminho ao mundo nativo da nuvem.</span><span class="sxs-lookup"><span data-stu-id="0d626-108">A newer communication technology, entitled gRPC, is rapidly gaining popularity and making its way into the cloud-native world.</span></span>

## <a name="grpc"></a><span data-ttu-id="0d626-109">gRPC</span><span class="sxs-lookup"><span data-stu-id="0d626-109">gRPC</span></span>

<span data-ttu-id="0d626-110">gRPC é uma comunicação de software livre originada no Google.</span><span class="sxs-lookup"><span data-stu-id="0d626-110">gRPC is an open-source communication that originates from Google.</span></span> <span data-ttu-id="0d626-111">Ele foi criado sobre o modelo de [RPC (chamada de procedimento remoto)](https://en.wikipedia.org/wiki/Remote_procedure_call) , popular em computação distribuída.</span><span class="sxs-lookup"><span data-stu-id="0d626-111">It's built upon the [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) model, popular in distributed computing.</span></span> <span data-ttu-id="0d626-112">Após esse modelo, um programa cliente local expõe um método em processo para executar uma operação.</span><span class="sxs-lookup"><span data-stu-id="0d626-112">Following this model, a local client program exposes an in-process method to execute an operation.</span></span> <span data-ttu-id="0d626-113">Em segundo plano, essa chamada é invocada em um microserviço fora de processo em uma rede distribuída.</span><span class="sxs-lookup"><span data-stu-id="0d626-113">Behind the scenes, that call is invoked on an out-of-process microservice across a distributed network.</span></span> <span data-ttu-id="0d626-114">O desenvolvedor codifica a operação como uma chamada de procedimento local.</span><span class="sxs-lookup"><span data-stu-id="0d626-114">The developer codes the operation as a local procedure call.</span></span> <span data-ttu-id="0d626-115">A plataforma subjacente abstrai a comunicação, a serialização e a execução da rede ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="0d626-115">The underlying platform abstracts the point-to-point networking communication, serialization, and execution.</span></span>

<span data-ttu-id="0d626-116">o gRPC é uma estrutura de RPC moderna que é leve e altamente funcional.</span><span class="sxs-lookup"><span data-stu-id="0d626-116">gRPC is a modern RPC framework that is lightweight and highly performant.</span></span> <span data-ttu-id="0d626-117">Ele usa HTTP/2 para seu protocolo de transporte.</span><span class="sxs-lookup"><span data-stu-id="0d626-117">It uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="0d626-118">Embora seja compatível com HTTP 1,1, o HTTP/2 apresenta muitos recursos avançados:</span><span class="sxs-lookup"><span data-stu-id="0d626-118">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="0d626-119">Embora HTTP 1,1 envie dados como texto não criptografado, HTTP/2 é um protocolo binário.</span><span class="sxs-lookup"><span data-stu-id="0d626-119">While HTTP 1.1 sends data as clear text, HTTP/2 is a binary protocol.</span></span> <span data-ttu-id="0d626-120">Ele analisa os dados mais rapidamente usando menos memória, reduz a latência de rede com as melhorias relacionadas à velocidade e gerencia os recursos de rede com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="0d626-120">It parses data faster using less memory, reduces network latency with the related improvements to speed, and manages network resources more efficiently.</span></span>
- <span data-ttu-id="0d626-121">Embora o HTTP 1,1 esteja limitado ao processamento de uma solicitação/resposta de ida e volta por vez, o HTTP/2 dá suporte à multiplexação ou a várias solicitações paralelas pela mesma conexão.</span><span class="sxs-lookup"><span data-stu-id="0d626-121">While HTTP 1.1 is limited to processing one round-trip request/response at a time, HTTP/2 supports multiplexing, or multiple parallel requests over the same connection.</span></span>
- <span data-ttu-id="0d626-122">O HTTP/2 dá suporte à comunicação full-duplex ou bidirecional, em que tanto o cliente quanto o servidor podem se comunicar ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="0d626-122">HTTP/2 supports full-duplex, or bidirectional communication, where both client and server and can communicate at the same time.</span></span> <span data-ttu-id="0d626-123">O cliente pode carregar dados de solicitação ao mesmo tempo em que o servidor está enviando dados de resposta de retorno.</span><span class="sxs-lookup"><span data-stu-id="0d626-123">The client can be uploading request data at the same time the server is sending back response data.</span></span>
- <span data-ttu-id="0d626-124">O streaming é criado no HTTP/2, o que significa que tanto as solicitações quanto as respostas podem transmitir de forma assíncrona grandes conjuntos de dados.</span><span class="sxs-lookup"><span data-stu-id="0d626-124">Streaming is built into HTTP/2 meaning that both requests and responses can asynchronously stream large data sets.</span></span>
- <span data-ttu-id="0d626-125">Combinando gRPC e HTTP/2, o desempenho aumenta drasticamente.</span><span class="sxs-lookup"><span data-stu-id="0d626-125">Combining gRPC and HTTP/2, performance dramatically increases.</span></span> <span data-ttu-id="0d626-126">Na linguagem [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) , o desempenho do gPRC atende e excede a velocidade e a eficiência das [associações NetTcp](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span><span class="sxs-lookup"><span data-stu-id="0d626-126">In [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gPRC performance meets and exceeds the speed and efficiency of [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="0d626-127">No entanto, diferentemente do NetTCP, o gRPC não é restrito às C# linguagens da Microsoft, como ou VB.net.</span><span class="sxs-lookup"><span data-stu-id="0d626-127">However, unlike NetTCP, gRPC isn't constrained to Microsoft languages such as C# or VB.NET.</span></span>

<span data-ttu-id="0d626-128">o gRPC tem suporte nas plataformas mais populares, incluindo Java C#,, Golang e NodeJS.</span><span class="sxs-lookup"><span data-stu-id="0d626-128">gRPC is supported across most popular platforms, including Java, C#, Golang, and NodeJS.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="0d626-129">Buffers de protocolo</span><span class="sxs-lookup"><span data-stu-id="0d626-129">Protocol Buffers</span></span>

<span data-ttu-id="0d626-130">o gRPC adota outra tecnologia de software livre chamada [buffers de protocolo](https://developers.google.com/protocol-buffers/docs/overview) ou mensagens Protobuf para enviar e receber dados.</span><span class="sxs-lookup"><span data-stu-id="0d626-130">gRPC embraces another open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview) or Protobuf messages to send and receive data.</span></span> <span data-ttu-id="0d626-131">Semelhante a um [contrato de dados do WCF](https://docs.microsoft.com/dotnet/framework/wcf/feature-details/using-data-contracts), o Protobuf serializa dados estruturados para leitura e gravação de sistemas.</span><span class="sxs-lookup"><span data-stu-id="0d626-131">Similar to a [WCF Data Contract](https://docs.microsoft.com/dotnet/framework/wcf/feature-details/using-data-contracts), Protobuf serializes structured data for systems to read and write.</span></span> <span data-ttu-id="0d626-132">Ele reduz a sobrecarga de que os formatos legíveis, como XML ou JSON, incorrem.</span><span class="sxs-lookup"><span data-stu-id="0d626-132">It reduces the overhead that human-readable formats like XML or JSON incur.</span></span>

<span data-ttu-id="0d626-133">Muitas técnicas de serialização de objeto refletem na estrutura de objetos de dados em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0d626-133">Many object serialization techniques reflect across the structure of data objects at run-time.</span></span> <span data-ttu-id="0d626-134">O Protobuf exige que você defina a estrutura antecipadamente com uma linguagem independente de plataforma (linguagem de buffer de protocolo).</span><span class="sxs-lookup"><span data-stu-id="0d626-134">Protobuf requires you to define the structure up front with a platform-agnostic language (Protocol Buffer Language).</span></span> <span data-ttu-id="0d626-135">Cada definição é armazenada em um arquivo ". proto".</span><span class="sxs-lookup"><span data-stu-id="0d626-135">Each definition is stored in a ".proto" file.</span></span> <span data-ttu-id="0d626-136">Em seguida, usando o compilador Protobuf, "Proton", você gera o código do cliente e do servidor para qualquer uma das plataformas com suporte.</span><span class="sxs-lookup"><span data-stu-id="0d626-136">Then using Protobuf compiler, "Proton," you generate client and server code for any of the supported platforms.</span></span> <span data-ttu-id="0d626-137">O código gerado é otimizado para serialização/desserialização rápida de dados.</span><span class="sxs-lookup"><span data-stu-id="0d626-137">The generated code is optimized for fast serialization/deserialization of data.</span></span> <span data-ttu-id="0d626-138">Em tempo de execução, cada mensagem é encapsulada no contrato de serviço fortemente tipado e serializada em uma representação Protobuf padrão.</span><span class="sxs-lookup"><span data-stu-id="0d626-138">At runtime, each message is wrapped in the strongly-typed service contract and serialized in a standard Protobuf representation.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="0d626-139">suporte do gRPC no .NET</span><span class="sxs-lookup"><span data-stu-id="0d626-139">gRPC support in .NET</span></span>

<span data-ttu-id="0d626-140">O Microsoft .NET Core Framework 3,0 inclui ferramentas e suporte nativo para gRPC.</span><span class="sxs-lookup"><span data-stu-id="0d626-140">The Microsoft .NET Core framework 3.0 includes tooling and native support for gRPC.</span></span> <span data-ttu-id="0d626-141">A Figura 4-20 mostra o modelo do Visual Studio 2019 que aplica Scaffold um projeto de esqueleto gRPC para um serviço gRPC.</span><span class="sxs-lookup"><span data-stu-id="0d626-141">Figure 4-20 shows the Visual Studio 2019 template that scaffolds a gRPC skeleton project for a gRPC service.</span></span> <span data-ttu-id="0d626-142">Observe como o .NET Core dá suporte às plataformas Windows, Linux e macOS.</span><span class="sxs-lookup"><span data-stu-id="0d626-142">Note how .NET Core supports the Windows, Linux, and macOS platforms.</span></span>

![Suporte do gRPC no Visual Studio 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="0d626-144">**Figura 4-20**.</span><span class="sxs-lookup"><span data-stu-id="0d626-144">**Figure 4-20**.</span></span> <span data-ttu-id="0d626-145">suporte do gRPC no Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="0d626-145">gRPC support in Visual Studio 2019</span></span>

<span data-ttu-id="0d626-146">O .NET Core 3,0 integra perfeitamente o gRPC à sua estrutura, incluindo roteamento de ponto de extremidade, suporte interno de IoC e registro em log.</span><span class="sxs-lookup"><span data-stu-id="0d626-146">.NET Core 3.0 seamlessly integrates gRPC into its framework, including endpoint routing, built-in IoC support, and logging.</span></span> <span data-ttu-id="0d626-147">O servidor Web Kestrel de software livre dá suporte total a conexões HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="0d626-147">The open-source Kestrel web server fully supports HTTP/2 connections.</span></span>

<span data-ttu-id="0d626-148">A Figura 4-21 mostra a estrutura de um serviço gRPC no Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="0d626-148">Figure 4-21 shows structure of a gRPC service in Visual Studio 2019.</span></span> <span data-ttu-id="0d626-149">Observe como a estrutura de pastas inclui pastas para os arquivos proto e o código de serviço.</span><span class="sxs-lookup"><span data-stu-id="0d626-149">Note how the folder structure includes folders for the proto files and service code.</span></span>

![projeto gRPC no Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="0d626-151">**Figura 4-21**.</span><span class="sxs-lookup"><span data-stu-id="0d626-151">**Figure 4-21**.</span></span> <span data-ttu-id="0d626-152">projeto gRPC no Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="0d626-152">gRPC project in Visual Studio 2019</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="0d626-153">Uso de gRPC</span><span class="sxs-lookup"><span data-stu-id="0d626-153">gRPC Usage</span></span>

<span data-ttu-id="0d626-154">o gRPC é bem adequado para os seguintes cenários:</span><span class="sxs-lookup"><span data-stu-id="0d626-154">gRPC is well suited for the following scenarios:</span></span>

- <span data-ttu-id="0d626-155">Comunicação de baixa latência e alta taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="0d626-155">Low latency and high throughput communication.</span></span> <span data-ttu-id="0d626-156">o gRPC é ótimo para microserviços leves em que a eficiência é fundamental.</span><span class="sxs-lookup"><span data-stu-id="0d626-156">gRPC is great for lightweight microservices where efficiency is critical.</span></span>
- <span data-ttu-id="0d626-157">Comunicação ponto a ponto em tempo real.</span><span class="sxs-lookup"><span data-stu-id="0d626-157">Point-to-point real-time communication.</span></span> <span data-ttu-id="0d626-158">o gRPC tem um excelente suporte para streaming bidirecional.</span><span class="sxs-lookup"><span data-stu-id="0d626-158">gRPC has excellent support for bi-directional streaming.</span></span> <span data-ttu-id="0d626-159">os serviços gRPCs podem enviar mensagens em tempo real sem sondagem.</span><span class="sxs-lookup"><span data-stu-id="0d626-159">gRPC services can push messages in real time without polling.</span></span>
- <span data-ttu-id="0d626-160">Ambientes poliglota – as ferramentas de gRPC dão suporte às linguagens de desenvolvimento mais populares, o que o torna uma boa opção para ambientes com vários idiomas.</span><span class="sxs-lookup"><span data-stu-id="0d626-160">Polyglot environments – gRPC tooling supports most popular development languages, making it a good choice for multi-language environments.</span></span>
- <span data-ttu-id="0d626-161">Ambientes com restrição de rede – as mensagens gRPC são serializadas com Protobuf, um formato de mensagem leve.</span><span class="sxs-lookup"><span data-stu-id="0d626-161">Network constrained environments – gRPC messages are serialized with Protobuf, a lightweight message format.</span></span> <span data-ttu-id="0d626-162">Uma mensagem gRPC é sempre menor do que uma mensagem JSON equivalente.</span><span class="sxs-lookup"><span data-stu-id="0d626-162">A gRPC message is always smaller than an equivalent JSON message.</span></span>

<span data-ttu-id="0d626-163">No momento da elaboração deste livro, a maioria dos navegadores tem suporte limitado para gRPC.</span><span class="sxs-lookup"><span data-stu-id="0d626-163">At the time of writing of this book, most browsers have limited support for gRPC.</span></span> <span data-ttu-id="0d626-164">gRPC usa intensamente recursos HTTP/2 e nenhum navegador fornece o nível de controle necessário em relação a solicitações da Web para dar suporte a um cliente gRPC.</span><span class="sxs-lookup"><span data-stu-id="0d626-164">gRPC heavily uses HTTP/2 features and no browser provides the level of control required over web requests to support a gRPC client.</span></span> <span data-ttu-id="0d626-165">gRPC normalmente é usado para a comunicação interna de microserviço com o Microservice.</span><span class="sxs-lookup"><span data-stu-id="0d626-165">gRPC is typically used for internal microservice to microservice communication.</span></span> <span data-ttu-id="0d626-166">A Figura 4-22 mostra um padrão de uso simples, mas comum.</span><span class="sxs-lookup"><span data-stu-id="0d626-166">Figure 4-22 shows a simple, but common usage pattern.</span></span>

![Padrões de uso do gRPC](./media/grpc-usage.png)

<span data-ttu-id="0d626-168">**Figura 4-22**.</span><span class="sxs-lookup"><span data-stu-id="0d626-168">**Figure 4-22**.</span></span> <span data-ttu-id="0d626-169">padrões de uso do gRPC</span><span class="sxs-lookup"><span data-stu-id="0d626-169">gRPC usage patterns</span></span>

<span data-ttu-id="0d626-170">Observação na figura anterior como o tráfego de front-end é invocado com HTTP enquanto o microserviço de back-end para o Microservice usa gRPC.</span><span class="sxs-lookup"><span data-stu-id="0d626-170">Note in the previous figure how front-end traffic is invoked with HTTP while back-end microservice to microservice uses gRPC.</span></span>

<span data-ttu-id="0d626-171">Olhando para a frente, gRPC poderia desempenhar uma função importante no dethroning da predominância do REST para sistemas nativos de nuvem.</span><span class="sxs-lookup"><span data-stu-id="0d626-171">Looking ahead, gRPC could play a major role in dethroning the dominance of REST for cloud-native systems.</span></span> <span data-ttu-id="0d626-172">Os benefícios de desempenho e a facilidade de desenvolvimento são muito bons para se passar.</span><span class="sxs-lookup"><span data-stu-id="0d626-172">The performance benefits and ease of development are too good to pass up.</span></span> <span data-ttu-id="0d626-173">No entanto, não cometa nenhum erro, o REST ainda estará disponível por muito tempo.</span><span class="sxs-lookup"><span data-stu-id="0d626-173">However, make no mistake, REST will still be around for a long time.</span></span> <span data-ttu-id="0d626-174">Ele ainda está em Excel para APIs expostas publicamente e por motivos de compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="0d626-174">It still excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="0d626-175">[Anterior](service-to-service-communication.md)
>[Próximo](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="0d626-175">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
