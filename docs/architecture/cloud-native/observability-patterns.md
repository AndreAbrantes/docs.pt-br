---
title: Padrões de observabilidade
description: Padrões de observação para aplicativos nativos de nuvem
ms.date: 05/13/2020
ms.openlocfilehash: db6a56358923025cbcca9478908474227e5da96d
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/19/2020
ms.locfileid: "83613805"
---
# <a name="observability-patterns"></a><span data-ttu-id="b7d01-103">Padrões de observabilidade</span><span class="sxs-lookup"><span data-stu-id="b7d01-103">Observability patterns</span></span>

<span data-ttu-id="b7d01-104">Assim como os padrões foram desenvolvidos para auxiliar no layout do código em aplicativos, há padrões para aplicativos operacionais de maneira confiável.</span><span class="sxs-lookup"><span data-stu-id="b7d01-104">Just as patterns have been developed to aid in the layout of code in applications, there are patterns for operating applications in a reliable way.</span></span> <span data-ttu-id="b7d01-105">Três padrões úteis na manutenção de aplicativos surgiram: **log**, **monitoramento**e **alertas**.</span><span class="sxs-lookup"><span data-stu-id="b7d01-105">Three useful patterns in maintaining applications have emerged: **logging**, **monitoring**, and **alerts**.</span></span>

## <a name="when-to-use-logging"></a><span data-ttu-id="b7d01-106">Quando usar o registro em log</span><span class="sxs-lookup"><span data-stu-id="b7d01-106">When to use logging</span></span>

<span data-ttu-id="b7d01-107">Não importa o cuidado que estamos, os aplicativos quase sempre se comportam de maneiras inesperadas na produção.</span><span class="sxs-lookup"><span data-stu-id="b7d01-107">No matter how careful we are, applications almost always behave in unexpected ways in production.</span></span> <span data-ttu-id="b7d01-108">Quando os usuários relatam problemas com um aplicativo, é extremamente útil conseguir ver o que estava acontecendo com o aplicativo quando o problema ocorreu.</span><span class="sxs-lookup"><span data-stu-id="b7d01-108">When users report problems with an application, it's extremely useful to be able to see what was going on with the app when the problem occurred.</span></span> <span data-ttu-id="b7d01-109">Uma das maneiras mais testadas e verdadeiras de capturar informações sobre o que um aplicativo está fazendo durante sua execução é fazer com que o aplicativo anote o que está fazendo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-109">One of the most tried and true ways of capturing information about what an application is doing while it's running is to have the application write down what it's doing.</span></span> <span data-ttu-id="b7d01-110">Esse processo é conhecido como registro em log.</span><span class="sxs-lookup"><span data-stu-id="b7d01-110">This process is known as logging.</span></span> <span data-ttu-id="b7d01-111">Sempre que ocorrerem falhas ou problemas na produção, o objetivo deve ser reproduzir as condições sob as quais as falhas ocorreram, em um ambiente de não produção.</span><span class="sxs-lookup"><span data-stu-id="b7d01-111">Any time failures or problems occur in production, the goal should be to reproduce the conditions under which the failures occurred, in a non-production environment.</span></span> <span data-ttu-id="b7d01-112">Ter um bom registro em vigor fornece um roteiro para os desenvolvedores seguirem a fim de duplicar problemas em um ambiente que pode ser testado e experimentado.</span><span class="sxs-lookup"><span data-stu-id="b7d01-112">Having good logging in place provides a roadmap for developers to follow in order to duplicate problems in an environment that can be tested and experimented with.</span></span>

### <a name="challenges-when-logging-with-cloud-native-applications"></a><span data-ttu-id="b7d01-113">Desafios ao registrar em log com aplicativos nativos de nuvem</span><span class="sxs-lookup"><span data-stu-id="b7d01-113">Challenges when logging with cloud-native applications</span></span>

<span data-ttu-id="b7d01-114">Em aplicativos tradicionais, os arquivos de log normalmente são armazenados no computador local.</span><span class="sxs-lookup"><span data-stu-id="b7d01-114">In traditional applications, log files are typically stored on the local machine.</span></span> <span data-ttu-id="b7d01-115">Na verdade, em sistemas operacionais semelhantes ao Unix, há uma estrutura de pastas definida para manter todos os logs, normalmente sob `/var/log` .</span><span class="sxs-lookup"><span data-stu-id="b7d01-115">In fact, on Unix-like operating systems, there's a folder structure defined to hold any logs, typically under `/var/log`.</span></span>

<span data-ttu-id="b7d01-116">![Registro em log em um arquivo em um aplicativo monolítico. ](./media/single-monolith-logging.png)
 **Figura 7-1**.</span><span class="sxs-lookup"><span data-stu-id="b7d01-116">![Logging to a file in a monolithic app.](./media/single-monolith-logging.png)
**Figure 7-1**.</span></span> <span data-ttu-id="b7d01-117">Registro em log em um arquivo em um aplicativo monolítico.</span><span class="sxs-lookup"><span data-stu-id="b7d01-117">Logging to a file in a monolithic app.</span></span>

<span data-ttu-id="b7d01-118">A utilidade de fazer logon em um arquivo simples em um único computador é amplamente reduzida em um ambiente de nuvem.</span><span class="sxs-lookup"><span data-stu-id="b7d01-118">The usefulness of logging to a flat file on a single machine is vastly reduced in a cloud environment.</span></span> <span data-ttu-id="b7d01-119">Os aplicativos que produzem logs podem não ter acesso ao disco local ou o disco local pode ser altamente transitório, pois os contêineres são embaralhados em relação a computadores físicos.</span><span class="sxs-lookup"><span data-stu-id="b7d01-119">Applications producing logs may not have access to the local disk or the local disk may be highly transient as containers are shuffled around physical machines.</span></span> <span data-ttu-id="b7d01-120">Até mesmo o dimensionamento simples dos aplicativos monolíticos em vários nós pode tornar difícil localizar o arquivo de log apropriado baseado em arquivo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-120">Even simple scaling up of monolithic applications across multiple nodes can make it challenging to locate the appropriate file-based log file.</span></span>

<span data-ttu-id="b7d01-121">![Registrando em log em arquivos em um aplicativo monolítico dimensionado. ](./media/multiple-node-monolith-logging.png)
 **Figura 7-2**.</span><span class="sxs-lookup"><span data-stu-id="b7d01-121">![Logging to files in a scaled monolithic app.](./media/multiple-node-monolith-logging.png)
**Figure 7-2**.</span></span> <span data-ttu-id="b7d01-122">Registrando em log em arquivos em um aplicativo monolítico dimensionado.</span><span class="sxs-lookup"><span data-stu-id="b7d01-122">Logging to files in a scaled monolithic app.</span></span>

<span data-ttu-id="b7d01-123">Aplicativos nativos de nuvem desenvolvidos usando uma arquitetura de microservices também apresentam alguns desafios para agentes baseados em arquivo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-123">Cloud-native applications developed using a microservices architecture also pose some challenges for file-based loggers.</span></span> <span data-ttu-id="b7d01-124">As solicitações de usuário agora podem abranger vários serviços que são executados em computadores diferentes e podem incluir funções sem servidor e não têm acesso a um sistema de arquivos local.</span><span class="sxs-lookup"><span data-stu-id="b7d01-124">User requests may now span multiple services that are run on different machines and may include serverless functions with no access to a local file system at all.</span></span> <span data-ttu-id="b7d01-125">Seria muito desafiador correlacionar os logs de um usuário ou uma sessão entre esses vários serviços e máquinas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-125">It would be very challenging to correlate the logs from a user or a session across these many services and machines.</span></span>

<span data-ttu-id="b7d01-126">![Registrando em log em arquivos locais em um aplicativo de microserviços. ](./media/local-log-file-per-service.png)
 **Figura 7-3**.</span><span class="sxs-lookup"><span data-stu-id="b7d01-126">![Logging to local files in a microservices app.](./media/local-log-file-per-service.png)
**Figure 7-3**.</span></span> <span data-ttu-id="b7d01-127">Registrando em log em arquivos locais em um aplicativo de microserviços.</span><span class="sxs-lookup"><span data-stu-id="b7d01-127">Logging to local files in a microservices app.</span></span>

<span data-ttu-id="b7d01-128">Por fim, o número de usuários em alguns aplicativos nativos de nuvem é alto.</span><span class="sxs-lookup"><span data-stu-id="b7d01-128">Finally, the number of users in some cloud-native applications is high.</span></span> <span data-ttu-id="b7d01-129">Imagine que cada usuário gere uma centena de linhas de mensagens de log ao fazer logon em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-129">Imagine that each user generates a hundred lines of log messages when they log into an application.</span></span> <span data-ttu-id="b7d01-130">Em isolamento, isso é gerenciável, mas multiplique mais de 100.000 usuários e o volume de logs se torna grande o suficiente para que as ferramentas especializadas sejam necessárias para dar suporte ao uso efetivo dos logs.</span><span class="sxs-lookup"><span data-stu-id="b7d01-130">In isolation, that is manageable, but multiply that over 100,000 users and the volume of logs becomes large enough that specialized tools are needed to support effective use of the logs.</span></span>

### <a name="logging-in-cloud-native-applications"></a><span data-ttu-id="b7d01-131">Log em aplicativos nativos de nuvem</span><span class="sxs-lookup"><span data-stu-id="b7d01-131">Logging in cloud-native applications</span></span>

<span data-ttu-id="b7d01-132">Cada linguagem de programação tem ferramentas que permitem a gravação de logs e, normalmente, a sobrecarga para a gravação desses logs é baixa.</span><span class="sxs-lookup"><span data-stu-id="b7d01-132">Every programming language has tooling that permits writing logs, and typically the overhead for writing these logs is low.</span></span> <span data-ttu-id="b7d01-133">Muitas das bibliotecas de log fornecem o registro em log de diferentes tipos de criticalidades, que podem ser ajustadas em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="b7d01-133">Many of the logging libraries provide logging different kinds of criticalities, which can be tuned at run time.</span></span> <span data-ttu-id="b7d01-134">Por exemplo, a [biblioteca Serilog](https://serilog.net/) é uma biblioteca de logs estruturada popular para .NET que fornece os seguintes níveis de log:</span><span class="sxs-lookup"><span data-stu-id="b7d01-134">For instance, the [Serilog library](https://serilog.net/) is a popular structured logging library for .NET that provides the following logging levels:</span></span>

* <span data-ttu-id="b7d01-135">Detalhado</span><span class="sxs-lookup"><span data-stu-id="b7d01-135">Verbose</span></span>
* <span data-ttu-id="b7d01-136">Depurar</span><span class="sxs-lookup"><span data-stu-id="b7d01-136">Debug</span></span>
* <span data-ttu-id="b7d01-137">Informações</span><span class="sxs-lookup"><span data-stu-id="b7d01-137">Information</span></span>
* <span data-ttu-id="b7d01-138">Aviso</span><span class="sxs-lookup"><span data-stu-id="b7d01-138">Warning</span></span>
* <span data-ttu-id="b7d01-139">Erro</span><span class="sxs-lookup"><span data-stu-id="b7d01-139">Error</span></span>
* <span data-ttu-id="b7d01-140">Fatais</span><span class="sxs-lookup"><span data-stu-id="b7d01-140">Fatal</span></span>

<span data-ttu-id="b7d01-141">Esses diferentes níveis de log fornecem granularidade no registro em log.</span><span class="sxs-lookup"><span data-stu-id="b7d01-141">These different log levels provide granularity in logging.</span></span> <span data-ttu-id="b7d01-142">Quando o aplicativo está funcionando corretamente na produção, ele pode ser configurado para registrar apenas mensagens importantes.</span><span class="sxs-lookup"><span data-stu-id="b7d01-142">When the application is functioning properly in production, it may be configured to only log important messages.</span></span> <span data-ttu-id="b7d01-143">Quando o aplicativo está com comportamento inadequado, o nível de log pode ser aumentado para que logs mais detalhados sejam coletados.</span><span class="sxs-lookup"><span data-stu-id="b7d01-143">When the application is misbehaving, then the log level can be increased so more verbose logs are gathered.</span></span> <span data-ttu-id="b7d01-144">Isso equilibra o desempenho contra a facilidade de depuração.</span><span class="sxs-lookup"><span data-stu-id="b7d01-144">This balances performance against ease of debugging.</span></span>

<span data-ttu-id="b7d01-145">O alto desempenho das ferramentas de log e o tunability de detalhes deve incentivar os desenvolvedores a registrarem com frequência.</span><span class="sxs-lookup"><span data-stu-id="b7d01-145">The high performance of logging tools and the tunability of verbosity should encourage developers to log frequently.</span></span> <span data-ttu-id="b7d01-146">Muitos favorecem um padrão de registrar a entrada e sair de cada método.</span><span class="sxs-lookup"><span data-stu-id="b7d01-146">Many favor a pattern of logging the entry and exit of each method.</span></span> <span data-ttu-id="b7d01-147">Essa abordagem pode parecer um exagero, mas não é freqüente que os desenvolvedores desejarão ter menos registro em log.</span><span class="sxs-lookup"><span data-stu-id="b7d01-147">This approach may sound like overkill, but it's infrequent that developers will wish for less logging.</span></span> <span data-ttu-id="b7d01-148">Na verdade, não é incomum executar implantações para a única finalidade de adicionar o registro em log em um método problemático.</span><span class="sxs-lookup"><span data-stu-id="b7d01-148">In fact, it's not uncommon to perform deployments for the sole purpose of adding logging around a problematic method.</span></span> <span data-ttu-id="b7d01-149">Erro no lado de um excesso de logs e não há muito pouco.</span><span class="sxs-lookup"><span data-stu-id="b7d01-149">Err on the side of too much logging and not on too little.</span></span> <span data-ttu-id="b7d01-150">Algumas ferramentas podem ser usadas para fornecer automaticamente esse tipo de registro em log.</span><span class="sxs-lookup"><span data-stu-id="b7d01-150">Some tools can be used to automatically provide this kind of logging.</span></span>

<span data-ttu-id="b7d01-151">Devido aos desafios associados ao uso de logs baseados em arquivo em aplicativos nativos de nuvem, os logs centralizados são preferidos.</span><span class="sxs-lookup"><span data-stu-id="b7d01-151">Because of the challenges associated with using file-based logs in cloud-native apps, centralized logs are preferred.</span></span> <span data-ttu-id="b7d01-152">Os logs são coletados pelos aplicativos e enviados para um aplicativo de log central que indexa e armazena os logs.</span><span class="sxs-lookup"><span data-stu-id="b7d01-152">Logs are collected by the applications and shipped to a central logging application which indexes and stores the logs.</span></span> <span data-ttu-id="b7d01-153">Essa classe de sistema pode incluir dezenas de gigabytes de logs todos os dias.</span><span class="sxs-lookup"><span data-stu-id="b7d01-153">This class of system can ingest tens of gigabytes of logs every day.</span></span>

<span data-ttu-id="b7d01-154">Também é útil seguir algumas práticas padrão ao criar logs que abrangem muitos serviços.</span><span class="sxs-lookup"><span data-stu-id="b7d01-154">It's also helpful to follow some standard practices when building logging that spans many services.</span></span> <span data-ttu-id="b7d01-155">Por exemplo, a geração de uma [ID de correlação](https://blog.rapid7.com/2016/12/23/the-value-of-correlation-ids/) no início de uma interação demorada e, em seguida, o registro em cada mensagem relacionada a essa interação, facilita a pesquisa de todas as mensagens relacionadas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-155">For instance, generating a [correlation ID](https://blog.rapid7.com/2016/12/23/the-value-of-correlation-ids/) at the start of a lengthy interaction, and then logging it in each message that is related to that interaction, makes it easier to search for all related messages.</span></span> <span data-ttu-id="b7d01-156">Só é necessário localizar uma única mensagem e extrair a ID de correlação para localizar todas as mensagens relacionadas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-156">One need only find a single message and extract the correlation ID to find all the related messages.</span></span> <span data-ttu-id="b7d01-157">Outro exemplo é garantir que o formato de log seja o mesmo para todos os serviços, seja qual for o idioma ou a biblioteca de log que ele usa.</span><span class="sxs-lookup"><span data-stu-id="b7d01-157">Another example is ensuring that the log format is the same for every service, whatever the language or logging library it uses.</span></span> <span data-ttu-id="b7d01-158">Essa padronização torna muito mais fácil a leitura de logs.</span><span class="sxs-lookup"><span data-stu-id="b7d01-158">This standardization makes reading logs much easier.</span></span> <span data-ttu-id="b7d01-159">A Figura 7-4 demonstra como uma arquitetura de microserviços pode aproveitar o registro em log centralizado como parte de seu fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="b7d01-159">Figure 7-4 demonstrates how a microservices architecture can leverage centralized logging as part of its workflow.</span></span>

<span data-ttu-id="b7d01-160">![Os logs de várias fontes são incluídos em um repositório de logs centralizado. ](./media/centralized-logging.png)
 **Figura 7-4**.</span><span class="sxs-lookup"><span data-stu-id="b7d01-160">![Logs from various sources are ingested into a centralized log store.](./media/centralized-logging.png)
**Figure 7-4**.</span></span> <span data-ttu-id="b7d01-161">Os logs de várias fontes são incluídos em um repositório de logs centralizado.</span><span class="sxs-lookup"><span data-stu-id="b7d01-161">Logs from various sources are ingested into a centralized log store.</span></span>

## <a name="challenges-with-detecting-and-responding-to-potential-app-health-issues"></a><span data-ttu-id="b7d01-162">Desafios para detectar e responder a possíveis problemas de integridade do aplicativo</span><span class="sxs-lookup"><span data-stu-id="b7d01-162">Challenges with detecting and responding to potential app health issues</span></span>

<span data-ttu-id="b7d01-163">Alguns aplicativos não são de missão crítica.</span><span class="sxs-lookup"><span data-stu-id="b7d01-163">Some applications aren't mission critical.</span></span> <span data-ttu-id="b7d01-164">Talvez eles sejam usados apenas internamente e, quando ocorrer um problema, o usuário possa entrar em contato com a equipe responsável e o aplicativo possa ser reiniciado.</span><span class="sxs-lookup"><span data-stu-id="b7d01-164">Maybe they're only used internally, and when a problem occurs, the user can contact the team responsible and the application can be restarted.</span></span> <span data-ttu-id="b7d01-165">No entanto, os clientes geralmente têm mais expectativas para os aplicativos que consomem.</span><span class="sxs-lookup"><span data-stu-id="b7d01-165">However, customers often have higher expectations for the applications they consume.</span></span> <span data-ttu-id="b7d01-166">Você deve saber quando ocorrem problemas com seu aplicativo *antes que* os usuários façam, ou antes que os usuários o notifiquem.</span><span class="sxs-lookup"><span data-stu-id="b7d01-166">You should know when problems occur with your application *before* users do, or before users notify you.</span></span> <span data-ttu-id="b7d01-167">Caso contrário, o primeiro que você sabe sobre um problema pode ser quando você percebe que uma avalanche de postagens de mídia social está disparando seu aplicativo ou até mesmo sua organização.</span><span class="sxs-lookup"><span data-stu-id="b7d01-167">Otherwise, the first you know about a problem may be when you notice an angry deluge of social media posts deriding your application or even your organization.</span></span>

<span data-ttu-id="b7d01-168">Alguns cenários que talvez você precise considerar incluem:</span><span class="sxs-lookup"><span data-stu-id="b7d01-168">Some scenarios you may need to consider include:</span></span>

- <span data-ttu-id="b7d01-169">Um serviço em seu aplicativo continua falhando e reiniciando, resultando em respostas intermitentes lentas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-169">One service in your application keeps failing and restarting, resulting in intermittent slow responses.</span></span>
- <span data-ttu-id="b7d01-170">Em algumas ocasiões do dia, o tempo de resposta do seu aplicativo é lento.</span><span class="sxs-lookup"><span data-stu-id="b7d01-170">At some times of the day, your application's response time is slow.</span></span>
- <span data-ttu-id="b7d01-171">Após uma implantação recente, a carga no banco de dados foi tripla.</span><span class="sxs-lookup"><span data-stu-id="b7d01-171">After a recent deployment, load on the database has tripled.</span></span>

<span data-ttu-id="b7d01-172">Implementado corretamente, o monitoramento pode informá-lo sobre condições que resultarão em problemas, permitindo que você resolva as condições subjacentes antes que elas resultem em qualquer impacto significativo do usuário.</span><span class="sxs-lookup"><span data-stu-id="b7d01-172">Implemented properly, monitoring can let you know about conditions that will lead to problems, letting you address underlying conditions before they result in any significant user impact.</span></span>

### <a name="monitoring-cloud-native-apps"></a><span data-ttu-id="b7d01-173">Monitorando aplicativos nativos de nuvem</span><span class="sxs-lookup"><span data-stu-id="b7d01-173">Monitoring cloud-native apps</span></span>

<span data-ttu-id="b7d01-174">Alguns sistemas de registro em log centralizados assumem uma função adicional de coleta de telemetria fora de logs puros.</span><span class="sxs-lookup"><span data-stu-id="b7d01-174">Some centralized logging systems take on an additional role of collecting telemetry outside of pure logs.</span></span> <span data-ttu-id="b7d01-175">Eles podem coletar métricas, como tempo para executar uma consulta de banco de dados, tempo médio de resposta de um servidor Web e até mesmo médias de carga de CPU e pressão de memória, conforme relatado pelo sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="b7d01-175">They can collect metrics, such as time to run a database query, average response time from a web server, and even CPU load averages and memory pressure as reported by the operating system.</span></span> <span data-ttu-id="b7d01-176">Em conjunto com os logs, esses sistemas podem fornecer uma visão holística da integridade dos nós no sistema e do aplicativo como um todo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-176">In conjunction with the logs, these systems can provide a holistic view of the health of nodes in the system and the application as a whole.</span></span>

<span data-ttu-id="b7d01-177">Os recursos de coleta de métrica das ferramentas de monitoramento também podem ser alimentados manualmente de dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-177">The metric-gathering capabilities of the monitoring tools can also be fed manually from within the application.</span></span> <span data-ttu-id="b7d01-178">Os fluxos de negócios que são de interesse particular, como novos usuários se inscrevendo ou encomendando, podem ser instrumentados de forma que eles incrementam um contador no sistema de monitoramento central.</span><span class="sxs-lookup"><span data-stu-id="b7d01-178">Business flows that are of particular interest such as new users signing up or orders being placed, may be instrumented such that they increment a counter in the central monitoring system.</span></span> <span data-ttu-id="b7d01-179">Isso desbloqueia as ferramentas de monitoramento para não apenas monitorar a integridade do aplicativo, mas a integridade dos negócios.</span><span class="sxs-lookup"><span data-stu-id="b7d01-179">This unlocks the monitoring tools to not only monitor the health of the application but the health of the business.</span></span>

<span data-ttu-id="b7d01-180">As consultas podem ser construídas nas ferramentas de agregação de log para procurar determinadas estatísticas ou padrões, que podem ser exibidas em formato gráfico, em painéis personalizados.</span><span class="sxs-lookup"><span data-stu-id="b7d01-180">Queries can be constructed in the log aggregation tools to look for certain statistics or patterns, which can then be displayed in graphical form, on custom dashboards.</span></span> <span data-ttu-id="b7d01-181">Frequentemente, as equipes investirão em grandes exibições com montagem de parede que giram pelas estatísticas relacionadas a um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-181">Frequently, teams will invest in large, wall-mounted displays that rotate through the statistics related to an application.</span></span> <span data-ttu-id="b7d01-182">Dessa forma, é simples Ver os problemas conforme eles ocorrem.</span><span class="sxs-lookup"><span data-stu-id="b7d01-182">This way, it's simple to see the problems as they occur.</span></span>

<span data-ttu-id="b7d01-183">As ferramentas de monitoramento nativas de nuvem fornecem telemetria em tempo real e informações sobre aplicativos, independentemente de serem aplicativos monolíticos de processo único ou arquiteturas de microserviço distribuídas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-183">Cloud-native monitoring tools provide real-time telemetry and insight into apps regardless of whether they're single-process monolithic applications or distributed microservice architectures.</span></span> <span data-ttu-id="b7d01-184">Eles incluem ferramentas que permitem a coleta de dados do aplicativo, bem como ferramentas para consultar e exibir informações sobre a integridade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-184">They include tools that allow collection of data from the app as well as tools for querying and displaying information about the app's health.</span></span>

## <a name="challenges-with-reacting-to-critical-problems-in-cloud-native-apps"></a><span data-ttu-id="b7d01-185">Desafios para reagir a problemas críticos em aplicativos nativos de nuvem</span><span class="sxs-lookup"><span data-stu-id="b7d01-185">Challenges with reacting to critical problems in cloud-native apps</span></span>

<span data-ttu-id="b7d01-186">Se você precisar reagir a problemas com seu aplicativo, precisará de alguma maneira de alertar o pessoal certo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-186">If you need to react to problems with your application, you need some way to alert the right personnel.</span></span> <span data-ttu-id="b7d01-187">Esse é o terceiro padrão de observação do aplicativo de nuvem nativa e depende do registro em log e do monitoramento.</span><span class="sxs-lookup"><span data-stu-id="b7d01-187">This is the third cloud-native application observability pattern and depends on logging and monitoring.</span></span> <span data-ttu-id="b7d01-188">Seu aplicativo precisa ter o registro em log para permitir que os problemas sejam diagnosticados e, em alguns casos, alimentar a ferramentas de monitoramento.</span><span class="sxs-lookup"><span data-stu-id="b7d01-188">Your application needs to have logging in place to allow problems to be diagnosed, and in some cases to feed into monitoring tools.</span></span> <span data-ttu-id="b7d01-189">Ele precisa de monitoramento para agregar dados de integridade e métricas de aplicativo em um único lugar.</span><span class="sxs-lookup"><span data-stu-id="b7d01-189">It needs monitoring to aggregate application metrics and health data in one place.</span></span> <span data-ttu-id="b7d01-190">Depois que isso tiver sido estabelecido, poderão ser criadas regras que dispararão alertas quando determinadas métricas ficarem fora dos níveis aceitáveis.</span><span class="sxs-lookup"><span data-stu-id="b7d01-190">Once this has been established, rules can be created that will trigger alerts when certain metrics fall outside of acceptable levels.</span></span>

<span data-ttu-id="b7d01-191">Em geral, os alertas são dispostos em camadas sobre o monitoramento, de modo que determinadas condições disparem os alertas apropriados para notificar os membros da equipe sobre problemas urgentes.</span><span class="sxs-lookup"><span data-stu-id="b7d01-191">Generally, alerts are layered on top of monitoring such that certain conditions trigger appropriate alerts to notify team members of urgent problems.</span></span> <span data-ttu-id="b7d01-192">Alguns cenários que podem exigir alertas incluem:</span><span class="sxs-lookup"><span data-stu-id="b7d01-192">Some scenarios that may require alerts include:</span></span>

- <span data-ttu-id="b7d01-193">Um dos serviços do seu aplicativo não está respondendo após 1 minuto de inatividade.</span><span class="sxs-lookup"><span data-stu-id="b7d01-193">One of your application's services is not responding after 1 minute of downtime.</span></span>
- <span data-ttu-id="b7d01-194">Seu aplicativo está retornando respostas HTTP malsucedidas para mais de 1% das solicitações.</span><span class="sxs-lookup"><span data-stu-id="b7d01-194">Your application is returning unsuccessful HTTP responses to more than 1% of requests.</span></span>
- <span data-ttu-id="b7d01-195">O tempo médio de resposta do seu aplicativo para pontos de extremidade de chave excede 2000 MS.</span><span class="sxs-lookup"><span data-stu-id="b7d01-195">Your application's average response time for key endpoints exceeds 2000 ms.</span></span>

### <a name="alerts-in-cloud-native-apps"></a><span data-ttu-id="b7d01-196">Alertas em aplicativos nativos de nuvem</span><span class="sxs-lookup"><span data-stu-id="b7d01-196">Alerts in cloud-native apps</span></span>

<span data-ttu-id="b7d01-197">Você pode criar consultas em relação às ferramentas de monitoramento para procurar condições de falha conhecidas.</span><span class="sxs-lookup"><span data-stu-id="b7d01-197">You can craft queries against the monitoring tools to look for known failure conditions.</span></span> <span data-ttu-id="b7d01-198">Por exemplo, as consultas podem pesquisar nos logs de entrada as indicações do código de status HTTP 500, que indica um problema em um servidor Web.</span><span class="sxs-lookup"><span data-stu-id="b7d01-198">For instance, queries could search through the incoming logs for indications of HTTP status code 500, which indicates a problem on a web server.</span></span> <span data-ttu-id="b7d01-199">Assim que um deles é detectado, um email ou um SMS pode ser enviado para o proprietário do serviço de origem que pode começar a investigar.</span><span class="sxs-lookup"><span data-stu-id="b7d01-199">As soon as one of these is detected, then an e-mail or an SMS could be sent to the owner of the originating service who can begin to investigate.</span></span>

<span data-ttu-id="b7d01-200">Normalmente, no entanto, um único erro 500 não é suficiente para determinar se ocorreu um problema.</span><span class="sxs-lookup"><span data-stu-id="b7d01-200">Typically, though, a single 500 error isn't enough to determine that a problem has occurred.</span></span> <span data-ttu-id="b7d01-201">Isso pode significar que um usuário digitou sua senha incorretamente ou inseriu alguns dados malformados.</span><span class="sxs-lookup"><span data-stu-id="b7d01-201">It could mean that a user mistyped their password or entered some malformed data.</span></span> <span data-ttu-id="b7d01-202">As consultas de alerta podem ser criadas para serem acionadas apenas quando um número médio maior que 500 erros forem detectados.</span><span class="sxs-lookup"><span data-stu-id="b7d01-202">The alert queries can be crafted to only fire when a larger than average number of 500 errors are detected.</span></span>

<span data-ttu-id="b7d01-203">Um dos padrões mais prejudiciais no alerta é acionar muitos alertas para que os seres humanos investiguem.</span><span class="sxs-lookup"><span data-stu-id="b7d01-203">One of the most damaging patterns in alerting is to fire too many alerts for humans to investigate.</span></span> <span data-ttu-id="b7d01-204">Os proprietários de serviço se tornarão rapidamente dessensibilizamos a erros que foram previamente investigados e considerados benignos.</span><span class="sxs-lookup"><span data-stu-id="b7d01-204">Service owners will rapidly become desensitized to errors that they've previously investigated and found to be benign.</span></span> <span data-ttu-id="b7d01-205">Em seguida, quando ocorrerem erros verdadeiros, eles serão perdidos no ruído de centenas de falsos positivos.</span><span class="sxs-lookup"><span data-stu-id="b7d01-205">Then, when true errors occur, they'll be lost in the noise of hundreds of false positives.</span></span> <span data-ttu-id="b7d01-206">O Parable do [rapaz que chorei Wolf](https://en.wikipedia.org/wiki/The_Boy_Who_Cried_Wolf) é frequentemente dito a crianças para avisá-los dessa grande perigo.</span><span class="sxs-lookup"><span data-stu-id="b7d01-206">The parable of the [Boy Who Cried Wolf](https://en.wikipedia.org/wiki/The_Boy_Who_Cried_Wolf) is frequently told to children to warn them of this very danger.</span></span> <span data-ttu-id="b7d01-207">É importante garantir que os alertas que são acionados sejam indícios de um problema real.</span><span class="sxs-lookup"><span data-stu-id="b7d01-207">It's important to ensure that the alerts that do fire are indicative of a real problem.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="b7d01-208">[Anterior](monitoring-health.md) 
> [Avançar](logging-with-elastic-stack.md)</span><span class="sxs-lookup"><span data-stu-id="b7d01-208">[Previous](monitoring-health.md)
[Next](logging-with-elastic-stack.md)</span></span>
