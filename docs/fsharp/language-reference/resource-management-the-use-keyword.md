---
title: 'Gerenciamento de recursos: a palavra-chave use (F#)'
description: "Saiba mais sobre o F # palavra-chave 'use' e a função 'using', o que pode controlar a inicialização e a liberação de recursos."
ms.date: 05/16/2016
ms.openlocfilehash: ffa1cb515139a3705920d9d9f79be1a69602f7d8
ms.sourcegitcommit: db8b83057d052c1f9f249d128b08d4423af0f7c2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/02/2018
ms.locfileid: "45616052"
---
# <a name="resource-management-the-use-keyword"></a><span data-ttu-id="48e9b-103">Gerenciamento de recursos: a palavra-chave use</span><span class="sxs-lookup"><span data-stu-id="48e9b-103">Resource Management: The use Keyword</span></span>

<span data-ttu-id="48e9b-104">Este tópico descreve a palavra-chave `use` e o `using` função, que pode controlar a inicialização e a liberação de recursos.</span><span class="sxs-lookup"><span data-stu-id="48e9b-104">This topic describes the keyword `use` and the `using` function, which can control the initialization and release of resources.</span></span>

## <a name="resources"></a><span data-ttu-id="48e9b-105">Recursos</span><span class="sxs-lookup"><span data-stu-id="48e9b-105">Resources</span></span>

<span data-ttu-id="48e9b-106">O termo *recurso* é usado em mais de uma maneira.</span><span class="sxs-lookup"><span data-stu-id="48e9b-106">The term *resource* is used in more than one way.</span></span> <span data-ttu-id="48e9b-107">Sim, os recursos podem ser dados que usa um aplicativo, como cadeias de caracteres, gráficos e assim por diante, mas nesse contexto, *recursos* refere-se aos recursos de software ou sistema operacional, como os contextos de dispositivo de gráficos, identificadores de arquivos, rede banco de dados e conexões, objetos de simultaneidade, como identificadores de espera e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="48e9b-107">Yes, resources can be data that an application uses, such as strings, graphics, and the like, but in this context, *resources* refers to software or operating system resources, such as graphics device contexts, file handles, network and database connections, concurrency objects such as wait handles, and so on.</span></span> <span data-ttu-id="48e9b-108">O uso desses recursos por aplicativos envolve a aquisição do recurso do sistema operacional ou outro provedor de recursos, seguido da versão mais recente do recurso para o pool para que ele pode ser fornecido para outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="48e9b-108">The use of these resources by applications involves the acquisition of the resource from the operating system or other resource provider, followed by the later release of the resource to the pool so that it can be provided to another application.</span></span> <span data-ttu-id="48e9b-109">Problemas ocorrem quando os aplicativos não liberar recursos de volta para o pool comum.</span><span class="sxs-lookup"><span data-stu-id="48e9b-109">Problems occur when applications do not release resources back to the common pool.</span></span>

## <a name="managing-resources"></a><span data-ttu-id="48e9b-110">Gerenciamento de recursos</span><span class="sxs-lookup"><span data-stu-id="48e9b-110">Managing Resources</span></span>

<span data-ttu-id="48e9b-111">Para gerenciar os recursos em um aplicativo com responsabilidade e com eficiência, você deve liberar recursos imediatamente e de maneira previsível.</span><span class="sxs-lookup"><span data-stu-id="48e9b-111">To efficiently and responsibly manage resources in an application, you must release resources promptly and in a predictable manner.</span></span> <span data-ttu-id="48e9b-112">O .NET Framework ajuda você a fazer isso, fornecendo o `System.IDisposable` interface.</span><span class="sxs-lookup"><span data-stu-id="48e9b-112">The .NET Framework helps you do this by providing the `System.IDisposable` interface.</span></span> <span data-ttu-id="48e9b-113">Um tipo que implementa `System.IDisposable` tem o `System.IDisposable.Dispose` método, que libera os recursos corretamente.</span><span class="sxs-lookup"><span data-stu-id="48e9b-113">A type that implements `System.IDisposable` has the `System.IDisposable.Dispose` method, which correctly frees resources.</span></span> <span data-ttu-id="48e9b-114">Aplicativos bem escritos garantem que `System.IDisposable.Dispose` é chamado imediatamente quando qualquer objeto que contém um recurso limitado não é mais necessário.</span><span class="sxs-lookup"><span data-stu-id="48e9b-114">Well-written applications guarantee that `System.IDisposable.Dispose` is called promptly when any object that holds a limited resource is no longer needed.</span></span> <span data-ttu-id="48e9b-115">Felizmente, a maioria das linguagens .NET fornecem suporte para facilitar essa tarefa, e F # não é exceção.</span><span class="sxs-lookup"><span data-stu-id="48e9b-115">Fortunately, most .NET languages provide support to make this easier, and F# is no exception.</span></span> <span data-ttu-id="48e9b-116">Há duas construções de linguagem úteis que suportam o padrão dispose: o `use` associação e o `using` função.</span><span class="sxs-lookup"><span data-stu-id="48e9b-116">There are two useful language constructs that support the dispose pattern: the `use` binding and the `using` function.</span></span>

## <a name="use-binding"></a><span data-ttu-id="48e9b-117">Usar associação</span><span class="sxs-lookup"><span data-stu-id="48e9b-117">use Binding</span></span>

<span data-ttu-id="48e9b-118">O `use` palavra-chave tem um formulário que é semelhante do `let` associação:</span><span class="sxs-lookup"><span data-stu-id="48e9b-118">The `use` keyword has a form that resembles that of the `let` binding:</span></span>

<span data-ttu-id="48e9b-119">Use *valor* = *expressão*</span><span class="sxs-lookup"><span data-stu-id="48e9b-119">use *value* = *expression*</span></span>

<span data-ttu-id="48e9b-120">Ele fornece a mesma funcionalidade que um `let` vinculação, mas adiciona uma chamada para `Dispose` no valor quando o valor sai do escopo.</span><span class="sxs-lookup"><span data-stu-id="48e9b-120">It provides the same functionality as a `let` binding but adds a call to `Dispose` on the value when the value goes out of scope.</span></span> <span data-ttu-id="48e9b-121">Observe que o compilador insere uma verificação de nulos no valor, assim que, se o valor é `null`, a chamada para `Dispose` não foi tentada.</span><span class="sxs-lookup"><span data-stu-id="48e9b-121">Note that the compiler inserts a null check on the value, so that if the value is `null`, the call to `Dispose` is not attempted.</span></span>

<span data-ttu-id="48e9b-122">O exemplo a seguir mostra como fechar um arquivo automaticamente usando o `use` palavra-chave.</span><span class="sxs-lookup"><span data-stu-id="48e9b-122">The following example shows how to close a file automatically by using the `use` keyword.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet6301.fs)]

>[!NOTE]
<span data-ttu-id="48e9b-123">Você pode usar `use` em expressões de cálculo, caso em que uma versão personalizada do `use` expressão é usada.</span><span class="sxs-lookup"><span data-stu-id="48e9b-123">You can use `use` in computation expressions, in which case a customized version of the `use` expression is used.</span></span> <span data-ttu-id="48e9b-124">Para obter mais informações, consulte [sequências](sequences.md), [fluxos de trabalho assíncronos](asynchronous-workflows.md), e [expressões de computação](computation-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="48e9b-124">For more information, see [Sequences](sequences.md), [Asynchronous Workflows](asynchronous-workflows.md), and [Computation Expressions](computation-expressions.md).</span></span>

## <a name="using-function"></a><span data-ttu-id="48e9b-125">usando a função</span><span class="sxs-lookup"><span data-stu-id="48e9b-125">using Function</span></span>

<span data-ttu-id="48e9b-126">O `using` função tem a seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="48e9b-126">The `using` function has the following form:</span></span>

<span data-ttu-id="48e9b-127">`using` (*expression1*) *função ou lambda*</span><span class="sxs-lookup"><span data-stu-id="48e9b-127">`using` (*expression1*) *function-or-lambda*</span></span>

<span data-ttu-id="48e9b-128">Em um `using` expressão, *expression1* cria o objeto que deve ser descartado.</span><span class="sxs-lookup"><span data-stu-id="48e9b-128">In a `using` expression, *expression1* creates the object that must be disposed.</span></span> <span data-ttu-id="48e9b-129">O resultado de *expression1* (o objeto que deve ser descartado) se torna um argumento *valor*, para *função ou lambda*, que é qualquer função que espera um único restante do argumento de um tipo que corresponde ao valor produzido pela *expression1*, ou uma expressão lambda que espera um argumento desse tipo.</span><span class="sxs-lookup"><span data-stu-id="48e9b-129">The result of *expression1* (the object that must be disposed) becomes an argument, *value*, to *function-or-lambda*, which is either a function that expects a single remaining argument of a type that matches the value produced by *expression1*, or a lambda expression that expects an argument of that type.</span></span> <span data-ttu-id="48e9b-130">No final da execução da função, o tempo de execução chama `Dispose` e libera os recursos (a menos que o valor é `null`, caso em que a chamada de Dispose não é realizada).</span><span class="sxs-lookup"><span data-stu-id="48e9b-130">At the end of the execution of the function, the runtime calls `Dispose` and frees the resources (unless the value is `null`, in which case the call to Dispose is not attempted).</span></span>

<span data-ttu-id="48e9b-131">O exemplo a seguir demonstra o `using` expressão com uma expressão lambda.</span><span class="sxs-lookup"><span data-stu-id="48e9b-131">The following example demonstrates the `using` expression with a lambda expression.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet6302.fs)]

<span data-ttu-id="48e9b-132">A exemplo a seguir mostra o `using` expressão com uma função.</span><span class="sxs-lookup"><span data-stu-id="48e9b-132">The next example shows the `using` expression with a function.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet6303.fs)]

<span data-ttu-id="48e9b-133">Observe que a função pode ser uma função que tem alguns argumentos aplicados já.</span><span class="sxs-lookup"><span data-stu-id="48e9b-133">Note that the function could be a function that has some arguments applied already.</span></span> <span data-ttu-id="48e9b-134">O código de exemplo a seguir demonstra isso.</span><span class="sxs-lookup"><span data-stu-id="48e9b-134">The following code example demonstrates this.</span></span> <span data-ttu-id="48e9b-135">Ele cria um arquivo que contém a cadeia de caracteres `XYZ`.</span><span class="sxs-lookup"><span data-stu-id="48e9b-135">It creates a file that contains the string `XYZ`.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet6304.fs)]

<span data-ttu-id="48e9b-136">O `using` função e o `use` associação são quase equivalentes maneiras de realizar a mesma coisa.</span><span class="sxs-lookup"><span data-stu-id="48e9b-136">The `using` function and the `use` binding are nearly equivalent ways to accomplish the same thing.</span></span> <span data-ttu-id="48e9b-137">O `using` palavra-chave fornece mais controle sobre quando `Dispose` é chamado.</span><span class="sxs-lookup"><span data-stu-id="48e9b-137">The `using` keyword provides more control over when `Dispose` is called.</span></span> <span data-ttu-id="48e9b-138">Quando você usa `using`, `Dispose` é chamado no final da expressão lambda ou função; quando você usa o `use` palavra-chave, `Dispose` é chamado no final do bloco de código.</span><span class="sxs-lookup"><span data-stu-id="48e9b-138">When you use `using`, `Dispose` is called at the end of the function or lambda expression; when you use the `use` keyword, `Dispose` is called at the end of the containing code block.</span></span> <span data-ttu-id="48e9b-139">Em geral, você deve preferir usar `use` em vez do `using` função.</span><span class="sxs-lookup"><span data-stu-id="48e9b-139">In general, you should prefer to use `use` instead of the `using` function.</span></span>

## <a name="see-also"></a><span data-ttu-id="48e9b-140">Consulte também</span><span class="sxs-lookup"><span data-stu-id="48e9b-140">See also</span></span>

- [<span data-ttu-id="48e9b-141">Referência da Linguagem F#</span><span class="sxs-lookup"><span data-stu-id="48e9b-141">F# Language Reference</span></span>](index.md)
