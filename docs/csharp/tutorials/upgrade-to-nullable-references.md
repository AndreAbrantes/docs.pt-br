---
title: Criar com tipos de referência que permitem valor nulo
description: Este tutorial avançado fornece uma introdução aos tipos de referência que permitem valor nulo. Você aprenderá a expressar sua intenção de design quando os valores de referência puderem ser nulos e ter o compilador obrigatório quando eles não puderem ser nulos.
ms.date: 02/19/2019
ms.custom: mvc
ms.openlocfilehash: 0c95065e6c380fab6ba33432a32b3297e78027a3
ms.sourcegitcommit: 33c8d6f7342a4bb2c577842b7f075b0e20a2fa40
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/12/2019
ms.locfileid: "70926623"
---
# <a name="tutorial-migrate-existing-code-with-nullable-reference-types"></a><span data-ttu-id="1a075-104">Tutorial: Migrar o código existente com tipos de referência anuláveis</span><span class="sxs-lookup"><span data-stu-id="1a075-104">Tutorial: Migrate existing code with nullable reference types</span></span>

<span data-ttu-id="1a075-105">O C# 8 introduz **tipos de referência que permitem valor nulo** que complementam os tipos de referência da mesma maneira que os tipos de valor que permitem valor nulo complementam os tipos de valor.</span><span class="sxs-lookup"><span data-stu-id="1a075-105">C# 8 introduces **nullable reference types**, which complement reference types the same way nullable value types complement value types.</span></span> <span data-ttu-id="1a075-106">Para declarar que uma variável é um **tipo de referência que permite valor nulo**, anexe um `?` ao tipo.</span><span class="sxs-lookup"><span data-stu-id="1a075-106">You declare a variable to be a **nullable reference type** by appending a `?` to the type.</span></span> <span data-ttu-id="1a075-107">Por exemplo, `string?` representa uma `string` que permite valor nulo.</span><span class="sxs-lookup"><span data-stu-id="1a075-107">For example, `string?` represents a nullable `string`.</span></span> <span data-ttu-id="1a075-108">Você pode usar esses novos tipos para expressar mais claramente sua intenção de design: algumas variáveis *devem sempre ter um valor*, outras *podem ter um valor* ausente.</span><span class="sxs-lookup"><span data-stu-id="1a075-108">You can use these new types to more clearly express your design intent: some variables *must always have a value*, others *may be missing a value*.</span></span> <span data-ttu-id="1a075-109">Quaisquer variáveis existentes de um tipo de referência seriam interpretadas como um tipo de referência não anulável.</span><span class="sxs-lookup"><span data-stu-id="1a075-109">Any existing variables of a reference type would be interpreted as a non-nullable reference type.</span></span> 

<span data-ttu-id="1a075-110">Neste tutorial, você aprenderá a:</span><span class="sxs-lookup"><span data-stu-id="1a075-110">In this tutorial, you'll learn how to:</span></span>

> [!div class="checklist"]
>
> - <span data-ttu-id="1a075-111">Habilitar verificações de referência nula enquanto trabalha com o código.</span><span class="sxs-lookup"><span data-stu-id="1a075-111">Enable null reference checks as you work with code.</span></span>
> - <span data-ttu-id="1a075-112">Diagnosticar e corrigir avisos diferentes relacionados a valores nulos.</span><span class="sxs-lookup"><span data-stu-id="1a075-112">Diagnose and correct different warnings related to null values.</span></span>
> - <span data-ttu-id="1a075-113">Gerenciar a interface entre contextos habilitados para anulável e desabilitados para anulável.</span><span class="sxs-lookup"><span data-stu-id="1a075-113">Manage the interface between nullable enabled and nullable disabled contexts.</span></span>
> - <span data-ttu-id="1a075-114">Controlar contextos de anotação anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-114">Control nullable annotation contexts.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1a075-115">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="1a075-115">Prerequisites</span></span>

<span data-ttu-id="1a075-116">Você precisará configurar seu computador para executar o .NET Core, incluindo o compilador beta do C# 8.0.</span><span class="sxs-lookup"><span data-stu-id="1a075-116">You'll need to set up your machine to run .NET Core, including the C# 8.0 beta compiler.</span></span> <span data-ttu-id="1a075-117">O compilador beta do C# 8 está disponível com o [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019) ou a mais recente [.NET Core 3.0 versão prévia 3](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span><span class="sxs-lookup"><span data-stu-id="1a075-117">The C# 8 beta compiler is available with [Visual Studio 2019](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=inline+link&utm_content=download+vs2019), or the latest [.NET Core 3.0 preview](https://dotnet.microsoft.com/download/dotnet-core/3.0).</span></span>

<span data-ttu-id="1a075-118">Este tutorial pressupõe que você esteja familiarizado com o C# e .NET, incluindo o Visual Studio ou a CLI do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a075-118">This tutorial assumes you're familiar with C# and .NET, including either Visual Studio or the .NET Core CLI.</span></span>

## <a name="explore-the-sample-application"></a><span data-ttu-id="1a075-119">Explorar o aplicativo de exemplo</span><span class="sxs-lookup"><span data-stu-id="1a075-119">Explore the sample application</span></span>

<span data-ttu-id="1a075-120">O aplicativo de exemplo que você migrará é aplicativo Web leitor de feed RSS.</span><span class="sxs-lookup"><span data-stu-id="1a075-120">The sample application that you'll migrate is an RSS feed reader web app.</span></span> <span data-ttu-id="1a075-121">Ele lê de um único feed RSS e exibe resumos para os artigos mais recentes.</span><span class="sxs-lookup"><span data-stu-id="1a075-121">It reads from a single RSS feed and displays summaries for the most recent articles.</span></span> <span data-ttu-id="1a075-122">Você pode clicar em qualquer um dos artigos para visitar o site.</span><span class="sxs-lookup"><span data-stu-id="1a075-122">You can click on any of the articles to visit the site.</span></span> <span data-ttu-id="1a075-123">O aplicativo é relativamente novo, mas foi escrito antes da disponibilização de tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-123">The application is relatively new but was written before nullable reference types were available.</span></span> <span data-ttu-id="1a075-124">As decisões de design sobre o aplicativo representam princípios sólidos, mas não aproveitam esse recurso importante de linguagem.</span><span class="sxs-lookup"><span data-stu-id="1a075-124">The design decisions for the application represented sound principles, but don't take advantage of this important language feature.</span></span>

<span data-ttu-id="1a075-125">O aplicativo de exemplo inclui uma biblioteca de teste de unidade que valida a funcionalidade principal do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1a075-125">The sample application includes a unit test library that validates the major functionality of the app.</span></span> <span data-ttu-id="1a075-126">Esse projeto facilitará a atualização com segurança, caso você altere qualquer implementação com base nos avisos gerados.</span><span class="sxs-lookup"><span data-stu-id="1a075-126">That project will make it easier to upgrade safely, if you change any of the implementation based on the warnings generated.</span></span> <span data-ttu-id="1a075-127">Faça o download do código inicial no repositório [dotnet/samples](https://github.com/dotnet/samples/tree/master/csharp/tutorials/nullable-reference-migration/start) do GitHub.</span><span class="sxs-lookup"><span data-stu-id="1a075-127">You can download the starter code from the [dotnet/samples](https://github.com/dotnet/samples/tree/master/csharp/tutorials/nullable-reference-migration/start) GitHub repository.</span></span>

<span data-ttu-id="1a075-128">Sua meta ao migrar um projeto deve ser aproveitar os novos recursos de linguagem para poder expressar claramente sua intenção sobre a nulidade de variáveis, e fazer isso de forma que o compilador não gere avisos quando o contexto de anotação anulável e o contexto de aviso anulável estiverem definidos como `enabled`.</span><span class="sxs-lookup"><span data-stu-id="1a075-128">Your goal migrating a project should be to leverage the new language features so that you clearly express your intent on the nullability of variables, and do so in such a way that the compiler doesn't generate warnings when you have the nullable annotation context and nullable warning context set to `enabled`.</span></span>

## <a name="upgrade-the-projects-to-c-8"></a><span data-ttu-id="1a075-129">Atualizar os projetos para C# 8</span><span class="sxs-lookup"><span data-stu-id="1a075-129">Upgrade the projects to C# 8</span></span>

<span data-ttu-id="1a075-130">Primeiro, determine o escopo da tarefa de migração.</span><span class="sxs-lookup"><span data-stu-id="1a075-130">A good first step is to determine the scope of the migration task.</span></span> <span data-ttu-id="1a075-131">Comece atualizando o projeto para C# 8.0 (ou mais recente).</span><span class="sxs-lookup"><span data-stu-id="1a075-131">Start by upgrading the project to C# 8.0 (or newer).</span></span> <span data-ttu-id="1a075-132">Adicione o elemento `LangVersion` aos dois arquivos csproj, para o projeto da Web e o projeto de teste de unidade:</span><span class="sxs-lookup"><span data-stu-id="1a075-132">Add the `LangVersion` element to both csproj files for the web project and the unit test project:</span></span>

```xml
<LangVersion>8.0</LangVersion>
```

<span data-ttu-id="1a075-133">A atualização da versão da linguagem seleciona C# 8.0, mas não habilita o contexto de anotação anulável ou o contexto de aviso anulável.</span><span class="sxs-lookup"><span data-stu-id="1a075-133">Upgrading the language version selects C# 8.0, but does not enable the nullable annotation context or the nullable warning context.</span></span> <span data-ttu-id="1a075-134">Recompile o projeto para garantir que ocorra sem avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-134">Rebuild the project to ensure that it builds without warnings.</span></span>

<span data-ttu-id="1a075-135">Em seguida, ative o contexto de anotação anulável e veja quantos avisos são gerados.</span><span class="sxs-lookup"><span data-stu-id="1a075-135">A good next step is to turn on the nullable annotation context and see how many warnings are generated.</span></span> <span data-ttu-id="1a075-136">Adicione o seguinte elemento aos dois arquivos csproj na solução, diretamente abaixo do elemento `LangVersion`:</span><span class="sxs-lookup"><span data-stu-id="1a075-136">Add the following element to both csproj files in the solution, directly under the `LangVersion` element:</span></span>

```xml
<Nullable>enable</Nullable>
```

> [!IMPORTANT]
> <span data-ttu-id="1a075-137">O elemento `Nullable` era chamado `NullableContextOptions`.</span><span class="sxs-lookup"><span data-stu-id="1a075-137">The `Nullable` element was previously named `NullableContextOptions`.</span></span> <span data-ttu-id="1a075-138">A renomeação acompanha o Visual Studio 2019, 16.2-p1.</span><span class="sxs-lookup"><span data-stu-id="1a075-138">The rename ships with Visual Studio 2019, 16.2-p1.</span></span> <span data-ttu-id="1a075-139">O SDK do .NET Core 3.0.100-preview5-011568 não tem essa alteração.</span><span class="sxs-lookup"><span data-stu-id="1a075-139">The .NET Core SDK 3.0.100-preview5-011568 does not have this change.</span></span> <span data-ttu-id="1a075-140">Se você estiver usando a CLI do .NET Core, precisará usar `NullableContextOptions` até que a próxima versão prévia esteja disponível.</span><span class="sxs-lookup"><span data-stu-id="1a075-140">If you are using the .NET Core CLI, you'll need to use `NullableContextOptions` until the next preview is available.</span></span>

<span data-ttu-id="1a075-141">Faça uma compilação de teste e observe a lista de avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-141">Do a test build, and notice the warning list.</span></span> <span data-ttu-id="1a075-142">Neste aplicativo pequeno, o compilador gera cinco avisos. Provavelmente, você deixaria o contexto de anotação anulável habilitado e iniciaria a correção de avisos de todo o projeto.</span><span class="sxs-lookup"><span data-stu-id="1a075-142">In this small application, the compiler generates five warnings, so it's likely you'd leave the nullable annotation context enabled and start fixing warnings for the entire project.</span></span>

<span data-ttu-id="1a075-143">Essa estratégia funciona apenas para projetos menores.</span><span class="sxs-lookup"><span data-stu-id="1a075-143">That strategy works only for smaller projects.</span></span> <span data-ttu-id="1a075-144">Para os projetos maiores, o número de avisos gerados com a habilitação do contexto de anotação anulável em toda a base de código dificulta a correção sistemática dos avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-144">For any larger projects, the number of warnings generated by enabling the nullable annotation context for the entire codebase makes it harder to fix the warnings systematically.</span></span> <span data-ttu-id="1a075-145">Para projetos corporativos maiores, convém migrar um projeto de cada vez.</span><span class="sxs-lookup"><span data-stu-id="1a075-145">For larger enterprise projects, you'll often want to migrate one project at a time.</span></span> <span data-ttu-id="1a075-146">Em cada projeto, migre uma classe ou arquivo por vez.</span><span class="sxs-lookup"><span data-stu-id="1a075-146">In each project, migrate one class or file at a time.</span></span>

## <a name="warnings-help-discover-original-design-intent"></a><span data-ttu-id="1a075-147">Os avisos ajudam a descobrir a intenção do design original</span><span class="sxs-lookup"><span data-stu-id="1a075-147">Warnings help discover original design intent</span></span>

<span data-ttu-id="1a075-148">Há duas classes que geram vários avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-148">There are two classes that generate multiple warnings.</span></span> <span data-ttu-id="1a075-149">Comece com a classe `NewsStoryViewModel`.</span><span class="sxs-lookup"><span data-stu-id="1a075-149">Start with the `NewsStoryViewModel` class.</span></span> <span data-ttu-id="1a075-150">Remova o elemento `Nullable` dos arquivos csproj para que você possa limitar o escopo dos avisos para as seções do código com as quais você está trabalhando.</span><span class="sxs-lookup"><span data-stu-id="1a075-150">Remove the `Nullable` element from both csproj files so that you can limit the scope of warnings to the sections of code you're working with.</span></span> <span data-ttu-id="1a075-151">Abra o arquivo *NewsStoryViewModel.cs* e adicione as seguintes diretivas para habilitar o contexto de anotação anulável para `NewsStoryViewModel` e restaure-a seguindo a definição dessa classe:</span><span class="sxs-lookup"><span data-stu-id="1a075-151">Open the *NewsStoryViewModel.cs* file and add the following directives to enable the nullable annotation context for the `NewsStoryViewModel` and restore it following that class definition:</span></span>

```csharp
#nullable enable
public class NewsStoryViewModel
{
    public DateTimeOffset Published { get; set; }
    public string Title { get; set; }
    public string Uri { get; set; }
}
#nullable restore
```

<span data-ttu-id="1a075-152">Essas duas diretivas ajudam você a concentrar seus esforços de migração.</span><span class="sxs-lookup"><span data-stu-id="1a075-152">These two directives help you focus your migration efforts.</span></span> <span data-ttu-id="1a075-153">Os avisos anuláveis são gerados para a área do código na qual você está trabalhando ativamente.</span><span class="sxs-lookup"><span data-stu-id="1a075-153">The nullable warnings are generated for the area of code you're actively working on.</span></span> <span data-ttu-id="1a075-154">Deixe-os ativos até que você esteja pronto para ativar os avisos de todo o projeto.</span><span class="sxs-lookup"><span data-stu-id="1a075-154">You'll leave them on until you're ready to turn on the warnings for the entire project.</span></span> <span data-ttu-id="1a075-155">Use `restore` em vez do valor `disable` para não desabilitar acidentalmente o contexto após ativar as anotações anuláveis do projeto inteiro.</span><span class="sxs-lookup"><span data-stu-id="1a075-155">You should use the `restore` rather than `disable` value so that you don't accidentally disable the context later when you've turned on nullable annotations for the entire project.</span></span> <span data-ttu-id="1a075-156">Depois de ativar o contexto de anotação anulável para de todo o projeto, remova todas as pragmas `#nullable` desse projeto.</span><span class="sxs-lookup"><span data-stu-id="1a075-156">Once you've turned on the nullable annotation context for the entire project, you can remove all the `#nullable` pragmas from that project.</span></span>

<span data-ttu-id="1a075-157">A classe `NewsStoryViewModel` é um DTO (objeto de transferência de dados) e duas propriedades são cadeias de caracteres de leitura/gravação:</span><span class="sxs-lookup"><span data-stu-id="1a075-157">The `NewsStoryViewModel` class is a data transfer object (DTO) and two of the properties are read/write strings:</span></span>

[!code-csharp[InitialViewModel](~/samples/csharp/tutorials/nullable-reference-migration/start/SimpleFeedReader/ViewModels/NewsStoryViewModel.cs#StarterViewModel)]

<span data-ttu-id="1a075-158">Essas duas propriedades causam `CS8618`, "Propriedade não anulável não inicializada".</span><span class="sxs-lookup"><span data-stu-id="1a075-158">These two properties cause `CS8618`, "Non-nullable property is uninitialized".</span></span> <span data-ttu-id="1a075-159">Está bem claro: as duas propriedades `string` têm o valor padrão de `null` quando um `NewsStoryViewModel` é construído.</span><span class="sxs-lookup"><span data-stu-id="1a075-159">That's clear enough: both `string` properties have the default value of `null` when a `NewsStoryViewModel` is constructed.</span></span> <span data-ttu-id="1a075-160">O importante é descobrir como os objetos `NewsStoryViewModel` são construídos.</span><span class="sxs-lookup"><span data-stu-id="1a075-160">What's important to discover is how `NewsStoryViewModel` objects are constructed.</span></span> <span data-ttu-id="1a075-161">Examinando essa classe, não é possível determinar se o valor `null` faz parte do design, ou se esses objetos são definidos como valores não nulos sempre que um é criado.</span><span class="sxs-lookup"><span data-stu-id="1a075-161">Looking at this class, you can't tell if the `null` value is part of the design, or if these objects are set to non-null values whenever one is created.</span></span> <span data-ttu-id="1a075-162">As histórias de notícias são criadas no método `GetNews` da classe `NewsService`:</span><span class="sxs-lookup"><span data-stu-id="1a075-162">The news stories are created in the `GetNews` method of the `NewsService` class:</span></span>

[!code-csharp[StarterCreateNewsItem](~/samples/csharp/tutorials/nullable-reference-migration/start/SimpleFeedReader/Services/NewsService.cs#CreateNewsItem)]

<span data-ttu-id="1a075-163">Há muita coisa acontecendo no bloco de código anterior.</span><span class="sxs-lookup"><span data-stu-id="1a075-163">There's quite a bit going on in the preceding block of code.</span></span> <span data-ttu-id="1a075-164">Esse aplicativo usa o pacote NuGet [AutoMapper](https://automapper.org/) para construir um item de notícias a partir de um `ISyndicationItem`.</span><span class="sxs-lookup"><span data-stu-id="1a075-164">This application uses the [AutoMapper](https://automapper.org/) NuGet package to construct a news item from an `ISyndicationItem`.</span></span> <span data-ttu-id="1a075-165">Você descobriu que os itens de notícias são construídos, e as propriedades são definidas nessa instrução.</span><span class="sxs-lookup"><span data-stu-id="1a075-165">You've discovered that the news story items are constructed and the properties are set in that one statement.</span></span> <span data-ttu-id="1a075-166">Isso significa que o design do `NewsStoryViewModel` indica que essas propriedades nunca devem ter o valor `null`.</span><span class="sxs-lookup"><span data-stu-id="1a075-166">That means the design for the `NewsStoryViewModel` indicates that these properties should never have the `null` value.</span></span> <span data-ttu-id="1a075-167">Essas propriedades devem ser **tipos de referência não anuláveis**.</span><span class="sxs-lookup"><span data-stu-id="1a075-167">These properties should be **nonnullable reference types**.</span></span> <span data-ttu-id="1a075-168">Isso expressa melhor a intenção do design original.</span><span class="sxs-lookup"><span data-stu-id="1a075-168">That best expresses the original design intent.</span></span> <span data-ttu-id="1a075-169">Na verdade, qualquer `NewsStoryViewModel` *é* corretamente instanciada com valores não nulos.</span><span class="sxs-lookup"><span data-stu-id="1a075-169">In fact, any `NewsStoryViewModel` *is* correctly instantiated with non-null values.</span></span> <span data-ttu-id="1a075-170">Isso torna o código de inicialização a seguir uma correção válida:</span><span class="sxs-lookup"><span data-stu-id="1a075-170">That makes the following initialization code a valid fix:</span></span>

```csharp
public class NewsStoryViewModel
{
    public DateTimeOffset Published { get; set; }
    public string Title { get; set; } = default!;
    public string Uri { get; set; } = default!;
}
```

<span data-ttu-id="1a075-171">A atribuição de `Title` e `Uri` a `default`, que é `null` para o tipo `string`, não altera o comportamento de tempo de execução do programa.</span><span class="sxs-lookup"><span data-stu-id="1a075-171">The assignment of `Title` and `Uri` to `default` which is `null` for the `string` type doesn't change the runtime behavior of the program.</span></span> <span data-ttu-id="1a075-172">O `NewsStoryViewModel` ainda é construído com valores nulos, mas agora o compilador não retorna avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-172">The `NewsStoryViewModel` is still constructed with null values, but now the compiler reports no warnings.</span></span> <span data-ttu-id="1a075-173">O **operador que tolera valores nulos**, o caractere `!` logo após a expressão `default` informa ao compilador que a expressão anterior não é nula.</span><span class="sxs-lookup"><span data-stu-id="1a075-173">The **null-forgiving operator**, the `!` character following the `default` expression tells the compiler that the preceding expression is not null.</span></span> <span data-ttu-id="1a075-174">Essa técnica pode ser conveniente quando outras alterações forçarem mudanças muito maiores em uma base de código, mas, neste aplicativo, há uma solução relativamente rápida e mais adequada: Torne o `NewsStoryViewModel` um tipo imutável, onde todas as propriedades são definidas no construtor.</span><span class="sxs-lookup"><span data-stu-id="1a075-174">This technique may be expedient when other changes force much larger changes to a code base, but in this application there is a relatively quick and better solution: Make the `NewsStoryViewModel` an immutable type where all the properties are set in the constructor.</span></span> <span data-ttu-id="1a075-175">Faça estas alterações em `NewsStoryViewModel`:</span><span class="sxs-lookup"><span data-stu-id="1a075-175">Make the following changes to the `NewsStoryViewModel`:</span></span>

[!code-csharp[FinishedViewModel](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/ViewModels/NewsStoryViewModel.cs#FinishedViewModel)]

<span data-ttu-id="1a075-176">Depois disso, atualize o código que configura o AutoMapper, para que ele use o construtor em vez de definir propriedades.</span><span class="sxs-lookup"><span data-stu-id="1a075-176">Once that's done, you need to update the code that configures the AutoMapper so that it uses the constructor rather than setting properties.</span></span> <span data-ttu-id="1a075-177">Abra `NewsService.cs` e procure o seguinte código na parte inferior do arquivo:</span><span class="sxs-lookup"><span data-stu-id="1a075-177">Open `NewsService.cs` and look for the following code at the bottom of the file:</span></span>

[!code-csharp[StarterAutoMapper](~/samples/csharp/tutorials/nullable-reference-migration/start/SimpleFeedReader/Services/NewsService.cs#ConfigureAutoMapper)]

<span data-ttu-id="1a075-178">O código mapeia as propriedades do objeto `ISyndicationItem` para as propriedades `NewsStoryViewModel`.</span><span class="sxs-lookup"><span data-stu-id="1a075-178">That code maps properties of the `ISyndicationItem` object to the `NewsStoryViewModel` properties.</span></span> <span data-ttu-id="1a075-179">Em vez disso, você deseja que o AutoMapper forneça o mapeamento usando um construtor.</span><span class="sxs-lookup"><span data-stu-id="1a075-179">You want the AutoMapper to provide the mapping using a constructor instead.</span></span> <span data-ttu-id="1a075-180">Substitua o código acima pela seguinte configuração do automapper:</span><span class="sxs-lookup"><span data-stu-id="1a075-180">Replace the above code with the following automapper configuration:</span></span>

[!code-csharp[FinishedViewModel](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Services/NewsService.cs#ConfigureAutoMapper)]

<span data-ttu-id="1a075-181">Note que como essa classe é pequena, e você examinou cuidadosamente, ative a diretiva `#nullable enable` acima dessa declaração de classe.</span><span class="sxs-lookup"><span data-stu-id="1a075-181">Notice that because this class is small, and you've examined carefully, you should turn on the `#nullable enable` directive above this class declaration.</span></span> <span data-ttu-id="1a075-182">A alteração no construtor poderia ter quebrado algo, portanto, vale a pena executar todos os testes e testar o aplicativo antes de prosseguir.</span><span class="sxs-lookup"><span data-stu-id="1a075-182">The change to the constructor could have broken something, so it's worthwhile to run all the tests and test the application before moving on.</span></span>

<span data-ttu-id="1a075-183">O primeiro conjunto de alterações mostrou como descobrir quando o design original indicou que as variáveis não devem ser definidas como `null`.</span><span class="sxs-lookup"><span data-stu-id="1a075-183">The first set of changes showed you how to discover when the original design indicated that variables shouldn't be set to `null`.</span></span> <span data-ttu-id="1a075-184">A técnica é conhecida como **corrigir pela construção**.</span><span class="sxs-lookup"><span data-stu-id="1a075-184">The technique is referred to as **correct by construction**.</span></span> <span data-ttu-id="1a075-185">Você declara que um objeto e suas propriedades não podem ser `null` quando ele é construído.</span><span class="sxs-lookup"><span data-stu-id="1a075-185">You declare that an object and its properties cannot be `null` when it's constructed.</span></span> <span data-ttu-id="1a075-186">A análise de fluxo do compilador fornece garantia de que essas propriedades não são definidas como `null` após a construção.</span><span class="sxs-lookup"><span data-stu-id="1a075-186">The compiler's flow analysis provides assurance that those properties aren't set to `null` after construction.</span></span> <span data-ttu-id="1a075-187">Observe que esse construtor é chamado pelo código externo, e que o código é **indiferente ao anulável**.</span><span class="sxs-lookup"><span data-stu-id="1a075-187">Note that this constructor is called by external code, and that code is **nullable oblivious**.</span></span> <span data-ttu-id="1a075-188">A nova sintaxe não fornece uma verificação de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="1a075-188">The new syntax doesn't provide runtime checking.</span></span> <span data-ttu-id="1a075-189">O código externo pode enganar a análise de fluxo do compilador.</span><span class="sxs-lookup"><span data-stu-id="1a075-189">External code might circumvent the compiler's flow analysis.</span></span> 

<span data-ttu-id="1a075-190">Outras vezes, a estrutura de uma classe fornece dicas sobre diferentes sobre a intenção.</span><span class="sxs-lookup"><span data-stu-id="1a075-190">Other times, the structure of a class provides different clues to the intent.</span></span> <span data-ttu-id="1a075-191">Abra o arquivo *Error.cshtml.cs* na pasta *Páginas*.</span><span class="sxs-lookup"><span data-stu-id="1a075-191">Open the *Error.cshtml.cs* file in the *Pages* folder.</span></span> <span data-ttu-id="1a075-192">O `ErrorViewModel` contém o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="1a075-192">The `ErrorViewModel` contains the following code:</span></span>

[!code-csharp[StarterErrorModel](~/samples/csharp/tutorials/nullable-reference-migration/start/SimpleFeedReader/Pages/Error.cshtml.cs#StartErrorModel)]

<span data-ttu-id="1a075-193">Adicione a diretiva `#nullable enable` antes da declaração de classe e uma diretiva `#nullable restore` depois dela.</span><span class="sxs-lookup"><span data-stu-id="1a075-193">Add the `#nullable enable` directive before the class declaration, and a `#nullable restore` directive after it.</span></span> <span data-ttu-id="1a075-194">Você receberá um aviso de que `RequestId` não foi inicializado.</span><span class="sxs-lookup"><span data-stu-id="1a075-194">You'll get one warning that `RequestId` is not initialized.</span></span> <span data-ttu-id="1a075-195">Ao examinar a classe, você deve decidir que a propriedade `RequestId` deve ser nula em alguns casos.</span><span class="sxs-lookup"><span data-stu-id="1a075-195">By looking at the class, you should decide that the `RequestId` property should be null in some cases.</span></span> <span data-ttu-id="1a075-196">A existência da propriedade `ShowRequestId` indica que é possível faltar valores.</span><span class="sxs-lookup"><span data-stu-id="1a075-196">The existence of the `ShowRequestId` property indicates that missing values are possible.</span></span> <span data-ttu-id="1a075-197">Como `null` é válido, adicione o `?` no tipo `string` para indicar que a propriedade `RequestId` é um *tipo de referência anulável*.</span><span class="sxs-lookup"><span data-stu-id="1a075-197">Because `null` is valid, add the `?` on the `string` type to indicate the `RequestId` property is a *nullable reference type*.</span></span> <span data-ttu-id="1a075-198">A classe final se parece com o seguinte exemplo:</span><span class="sxs-lookup"><span data-stu-id="1a075-198">The final class looks like the following example:</span></span>

[!code-csharp[FinishedErrorModel](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Pages/Error.cshtml.cs#ErrorModel)]

<span data-ttu-id="1a075-199">Verifique os usos da propriedade, e você verá que na página associada, a propriedade passa por uma verificação de valor nulo antes da renderização na marcação.</span><span class="sxs-lookup"><span data-stu-id="1a075-199">Check for the uses of the property, and you see that in the associated page, the property is checked for null before rendering it in markup.</span></span> <span data-ttu-id="1a075-200">Esse é um uso seguro de um tipo de referência anulável, portanto, você concluiu essa classe.</span><span class="sxs-lookup"><span data-stu-id="1a075-200">That's a safe use of a nullable reference type, so you're done with this class.</span></span>

## <a name="fixing-nulls-causes-change"></a><span data-ttu-id="1a075-201">Corrigir nulos causa alteração</span><span class="sxs-lookup"><span data-stu-id="1a075-201">Fixing nulls causes change</span></span>

<span data-ttu-id="1a075-202">Com frequência, a correção para um conjunto de avisos cria novos avisos no código relacionado.</span><span class="sxs-lookup"><span data-stu-id="1a075-202">Frequently, the fix for one set of warnings creates new warnings in related code.</span></span> <span data-ttu-id="1a075-203">Vamos ver os avisos em ação corrigindo a classe `index.cshtml.cs`.</span><span class="sxs-lookup"><span data-stu-id="1a075-203">Let's see the warnings in action by fixing the `index.cshtml.cs` class.</span></span> <span data-ttu-id="1a075-204">Abra o arquivo `index.cshtml.cs` e examine o código.</span><span class="sxs-lookup"><span data-stu-id="1a075-204">Open the `index.cshtml.cs` file and examine the code.</span></span> <span data-ttu-id="1a075-205">Esse arquivo contém o código por trás da página de índice:</span><span class="sxs-lookup"><span data-stu-id="1a075-205">This file contains the code behind for the index page:</span></span>

[!code-csharp[StarterIndexModel](~/samples/csharp/tutorials/nullable-reference-migration/start/SimpleFeedReader/Pages/Index.cshtml.cs#IndexModelStart)]

<span data-ttu-id="1a075-206">Adicione a diretiva `#nullable enable` e você verá dois avisos.</span><span class="sxs-lookup"><span data-stu-id="1a075-206">Add the `#nullable enable` directive and you'll see two warnings.</span></span> <span data-ttu-id="1a075-207">Nem a propriedade `ErrorText`, ou a propriedade `NewsItems` é inicializada.</span><span class="sxs-lookup"><span data-stu-id="1a075-207">Neither the `ErrorText` property nor the `NewsItems` property is initialized.</span></span> <span data-ttu-id="1a075-208">Um exame dessa classe poderia levar você a acreditar que as duas propriedades devem ser tipos de referência anuláveis: Ambos têm setters privados.</span><span class="sxs-lookup"><span data-stu-id="1a075-208">An examination of this class would lead you to believe that both properties should be nullable reference types: Both have private setters.</span></span> <span data-ttu-id="1a075-209">Exatamente um é atribuído no método `OnGet`.</span><span class="sxs-lookup"><span data-stu-id="1a075-209">Exactly one is assigned in the `OnGet` method.</span></span> <span data-ttu-id="1a075-210">Antes de fazer alterações, examine os consumidores das duas propriedades.</span><span class="sxs-lookup"><span data-stu-id="1a075-210">Before making changes, look at the consumers of both properties.</span></span> <span data-ttu-id="1a075-211">Na própria página, o `ErrorText` é verificado em relação ao valor nulo antes de gerar a marcação dos erros.</span><span class="sxs-lookup"><span data-stu-id="1a075-211">In the page itself, the `ErrorText` is checked against null before generating markup for any errors.</span></span> <span data-ttu-id="1a075-212">A coleção `NewsItems` é verificada com relação a `null` e verificada para garantir que a coleção tenha itens.</span><span class="sxs-lookup"><span data-stu-id="1a075-212">The `NewsItems` collection is checked against `null`, and checked to ensure the collection has items.</span></span> <span data-ttu-id="1a075-213">Uma correção rápida seria transformar as duas propriedades em tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-213">A quick fix would be to make both properties nullable reference types.</span></span> <span data-ttu-id="1a075-214">Uma correção melhor seria transformar a coleção em um tipo de referência não anulável e adicionar itens à coleção existente ao recuperar notícias.</span><span class="sxs-lookup"><span data-stu-id="1a075-214">A better fix would be to make the collection a nonnullable reference type, and add items to the existing collection when retrieving news.</span></span> <span data-ttu-id="1a075-215">A primeira correção é adicionar o `?` ao tipo `string` para o `ErrorText`:</span><span class="sxs-lookup"><span data-stu-id="1a075-215">The first fix is to add the `?` to the `string` type for the `ErrorText`:</span></span>

[!code-csharp[UpdateErrorText](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Pages/Index.cshtml.cs#UpdateErrorText)]

<span data-ttu-id="1a075-216">Essa alteração não se propagará pelo outro código, pois qualquer acesso à propriedade `ErrorText` já foi protegida por verificações de valor nulo.</span><span class="sxs-lookup"><span data-stu-id="1a075-216">That change won't ripple through other code, because any access to the `ErrorText` property was already guarded by null checks.</span></span> <span data-ttu-id="1a075-217">Em seguida, inicialize a lista `NewsItems` e remova a propriedade setter, tornando-a uma propriedade somente leitura:</span><span class="sxs-lookup"><span data-stu-id="1a075-217">Next, initialize the `NewsItems` list and remove the property setter, making it a readonly property:</span></span>

[!code-csharp[InitializeNewsItems](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Pages/Index.cshtml.cs#InitializeNewsItems)]

<span data-ttu-id="1a075-218">Isso corrigiu o aviso, mas introduziu um erro.</span><span class="sxs-lookup"><span data-stu-id="1a075-218">That fixed the warning but introduced an error.</span></span> <span data-ttu-id="1a075-219">Agora, a lista `NewsItems` foi **corrigida pela construção**, mas o código que define a lista no `OnGet` deve ser alterado para coincidir com a nova API.</span><span class="sxs-lookup"><span data-stu-id="1a075-219">The `NewsItems` list is now **correct by construction**, but the code that sets the list in `OnGet` must change to match the new API.</span></span> <span data-ttu-id="1a075-220">Em vez de uma atribuição, chame `AddRange` para adicionar os itens de notícias à lista existente:</span><span class="sxs-lookup"><span data-stu-id="1a075-220">Instead of an assignment, call `AddRange` to add the news items to the existing list:</span></span>

[!code-csharp[AddRange](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Pages/Index.cshtml.cs#AddRange)]

<span data-ttu-id="1a075-221">Usar `AddRange` em vez de uma atribuição significa que o método `GetNews` pode retornar um `IEnumerable` em vez de um `List`.</span><span class="sxs-lookup"><span data-stu-id="1a075-221">Using `AddRange` instead of an assignment means that the `GetNews` method can return an `IEnumerable` instead of a `List`.</span></span> <span data-ttu-id="1a075-222">Isso salva uma alocação.</span><span class="sxs-lookup"><span data-stu-id="1a075-222">That saves one allocation.</span></span> <span data-ttu-id="1a075-223">Altere a assinatura do método e remova a chamada a `ToList`, conforme mostra o exemplo de código a seguir:</span><span class="sxs-lookup"><span data-stu-id="1a075-223">Change the signature of the method, and remove the `ToList` call, as shown in the following code sample:</span></span>

[!code-csharp[GetNews](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Services/NewsService.cs#GetNewsFinished)]

<span data-ttu-id="1a075-224">A alteração da assinatura também interrompe testes de uma das opções.</span><span class="sxs-lookup"><span data-stu-id="1a075-224">Changing the signature breaks one of tests as well.</span></span> <span data-ttu-id="1a075-225">Abra o arquivo `NewsServiceTests.cs` na pasta `Services` do projeto `SimpleFeedReader.Tests`.</span><span class="sxs-lookup"><span data-stu-id="1a075-225">Open the `NewsServiceTests.cs` file in the `Services` folder of the `SimpleFeedReader.Tests` project.</span></span> <span data-ttu-id="1a075-226">Navegue até o teste `Returns_News_Stories_Given_Valid_Uri` e altere o tipo da variável `result` para `IEnumerable<NewsItem>`.</span><span class="sxs-lookup"><span data-stu-id="1a075-226">Navigate to the `Returns_News_Stories_Given_Valid_Uri` test and change the type of the `result` variable to `IEnumerable<NewsItem>`.</span></span> <span data-ttu-id="1a075-227">A alteração do tipo significa que a propriedade `Count` não está mais disponível. Portanto, substitua a propriedade `Count` no `Assert` com uma chamada para `Any()`:</span><span class="sxs-lookup"><span data-stu-id="1a075-227">Changing the type means the `Count` property is no longer available, so replace the `Count` property in the `Assert` with a call to `Any()`:</span></span>

[!code-csharp[FixTests](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader.Tests/Services/NewsServiceTests.cs#FixTestSignature)]

<span data-ttu-id="1a075-228">Você também precisará adicionar uma instrução `using System.Linq` ao início do arquivo.</span><span class="sxs-lookup"><span data-stu-id="1a075-228">You'll need to add a `using System.Linq` statement to the beginning of the file as well.</span></span>

<span data-ttu-id="1a075-229">Esse conjunto de alterações destaca uma consideração especial ao atualizar o código que inclui instanciações genéricas.</span><span class="sxs-lookup"><span data-stu-id="1a075-229">This set of changes highlights special consideration when updating code that includes generic instantiations.</span></span> <span data-ttu-id="1a075-230">Tanto a lista quanto os elementos na lista de tipos não anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-230">Both the list and the elements in the list of non-nullable types.</span></span> <span data-ttu-id="1a075-231">Um deles ou ambos podem ser tipos anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-231">Either or both could be nullable types.</span></span> <span data-ttu-id="1a075-232">Todas as declarações a seguir são permitidas:</span><span class="sxs-lookup"><span data-stu-id="1a075-232">All the following declarations are allowed:</span></span>

- <span data-ttu-id="1a075-233">`List<NewsStoryViewModel>`: lista não anulável de modelos de exibição não anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-233">`List<NewsStoryViewModel>`: nonnullable list of nonullable view models.</span></span>
- <span data-ttu-id="1a075-234">`List<NewsStoryViewModel?>`: lista não anulável de modelos de exibição anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-234">`List<NewsStoryViewModel?>`: nonnullable list of nullable view models.</span></span>
- <span data-ttu-id="1a075-235">`List<NewsStoryViewModel>?`: lista anulável de modelos de exibição não anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-235">`List<NewsStoryViewModel>?`: nullable list of nonnullable view models.</span></span>
- <span data-ttu-id="1a075-236">`List<NewsStoryViewModel?>?`: lista anulável de modelos de exibição anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-236">`List<NewsStoryViewModel?>?`: nullable list of nullable view models.</span></span>

## <a name="interfaces-with-external-code"></a><span data-ttu-id="1a075-237">Interfaces com código externo</span><span class="sxs-lookup"><span data-stu-id="1a075-237">Interfaces with external code</span></span>

<span data-ttu-id="1a075-238">Você fez alterações na classe `NewsService`, então, ative a anotação `#nullable enable` para essa classe.</span><span class="sxs-lookup"><span data-stu-id="1a075-238">You've made changes to the `NewsService` class, so turn on the `#nullable enable` annotation for that class.</span></span> <span data-ttu-id="1a075-239">Isso não gerará avisos novos.</span><span class="sxs-lookup"><span data-stu-id="1a075-239">This won't generate any new warnings.</span></span> <span data-ttu-id="1a075-240">No entanto, um exame cuidadoso da classe ajuda a ilustrar algumas das limitações da análise de fluxo do compilador.</span><span class="sxs-lookup"><span data-stu-id="1a075-240">However, careful examination of the class helps to illustrate some of the limitations of the compiler's flow analysis.</span></span> <span data-ttu-id="1a075-241">Examine o construtor:</span><span class="sxs-lookup"><span data-stu-id="1a075-241">Examine the constructor:</span></span>

[!code-csharp[ServiceConstructor](~/samples/csharp/tutorials/nullable-reference-migration/finished/SimpleFeedReader/Services/NewsService.cs#ServiceConstructor)]

<span data-ttu-id="1a075-242">O parâmetro `IMapper` é tipado como uma referência não anulável.</span><span class="sxs-lookup"><span data-stu-id="1a075-242">The `IMapper` parameter is typed as a nonnullable reference.</span></span> <span data-ttu-id="1a075-243">Ele é chamado pelo código de infraestrutura do ASP.NET Core, portanto, o compilador não sabe que o `IMapper` nunca será nulo.</span><span class="sxs-lookup"><span data-stu-id="1a075-243">It's called by ASP.NET Core infrastructure code, so the compiler doesn't really know that the `IMapper` will never be null.</span></span> <span data-ttu-id="1a075-244">O contêiner de DI (injeção de dependência) do ASP.NET Core padrão gera uma exceção se não puder resolver um serviço necessário, para que o código fique correto.</span><span class="sxs-lookup"><span data-stu-id="1a075-244">The default ASP.NET Core dependency injection (DI) container throws an exception if it can't resolve a necessary service, so the code is correct.</span></span> <span data-ttu-id="1a075-245">O compilador não consegue validar todas as chamadas para suas APIs públicas, mesmo que seu código seja compilado com contextos de anotação anuláveis habilitados.</span><span class="sxs-lookup"><span data-stu-id="1a075-245">The compiler can't validate all calls to your public APIs, even if your code is compiled with nullable annotation contexts enabled.</span></span> <span data-ttu-id="1a075-246">Além disso, suas bibliotecas podem ser consumidas por projetos que ainda não aceitaram o uso de tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-246">Furthermore, your libraries may be consumed by projects that have not yet opted into using nullable reference types.</span></span> <span data-ttu-id="1a075-247">Valide as entradas para APIs públicas, mesmo que você as tenha declarado como tipos não anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-247">Validate inputs to public APIs even though you've declared them as nonnullable types.</span></span>

## <a name="get-the-code"></a><span data-ttu-id="1a075-248">Obter o código</span><span class="sxs-lookup"><span data-stu-id="1a075-248">Get the code</span></span>

<span data-ttu-id="1a075-249">Você corrigiu os avisos identificados na compilação de teste inicial, portanto, agora você pode ativar o contexto de anotação anulável para os dois projetos.</span><span class="sxs-lookup"><span data-stu-id="1a075-249">You've fixed the warnings you identified in the initial test compile, so now you can turn on the nullable annotation context for both projects.</span></span> <span data-ttu-id="1a075-250">Recompile os projetos; o compilador não relatará nenhum aviso.</span><span class="sxs-lookup"><span data-stu-id="1a075-250">Rebuild the projects; the compiler reports no warnings.</span></span> <span data-ttu-id="1a075-251">Você pode obter o código do projeto concluído no repositório do GitHub [dotnet/samples](https://github.com/dotnet/samples/tree/master/csharp/tutorials/nullable-reference-migration/finished).</span><span class="sxs-lookup"><span data-stu-id="1a075-251">You can get the code for the finished project in the [dotnet/samples](https://github.com/dotnet/samples/tree/master/csharp/tutorials/nullable-reference-migration/finished) GitHub repository.</span></span>

<span data-ttu-id="1a075-252">Os novos recursos que dão suporte aos tipos de referência anuláveis ajudam você a encontrar e corrigir possíveis erros no modo de manipulação de valores `null` em seu código.</span><span class="sxs-lookup"><span data-stu-id="1a075-252">The new features that support nullable reference types help you find and fix potential errors in how you handle `null` values in your code.</span></span> <span data-ttu-id="1a075-253">A habilitação do contexto de anotação anulável permite que você expresse sua intenção de design: algumas variáveis nunca devem ser nulas, outras variáveis podem conter valores nulos.</span><span class="sxs-lookup"><span data-stu-id="1a075-253">Enabling the nullable annotation context allows you to express your design intent: some variables should never be null, other variables may contain null values.</span></span> <span data-ttu-id="1a075-254">Esses recursos facilitam a declaração de sua intenção de design.</span><span class="sxs-lookup"><span data-stu-id="1a075-254">These features make it easier for you to declare your design intent.</span></span> <span data-ttu-id="1a075-255">Da mesma forma, o contexto de aviso anulável instrui o compilador a emitir avisos quando você violar essa intenção.</span><span class="sxs-lookup"><span data-stu-id="1a075-255">Similarly, the nullable warning context instructs the compiler to issue warnings when you have violated that intent.</span></span> <span data-ttu-id="1a075-256">Esses avisos servirão como orientação para criar atualizações que tornem seu código mais resiliente e menos propensa a lançar uma `NullReferenceException` durante a execução.</span><span class="sxs-lookup"><span data-stu-id="1a075-256">Those warnings guide you to make updates that make your code more resilient and less likely to throw a `NullReferenceException` during execution.</span></span> <span data-ttu-id="1a075-257">Você pode controlar o escopo desses contextos para se concentrar na migração de áreas locais do código, enquanto a base de código restante permanece inalterada.</span><span class="sxs-lookup"><span data-stu-id="1a075-257">You can control the scope of these contexts so that you can focus on local areas of code to migrate while the remaining codebase is untouched.</span></span> <span data-ttu-id="1a075-258">Na prática, você pode tornar essa tarefa de migração uma parte da manutenção regular das suas classes.</span><span class="sxs-lookup"><span data-stu-id="1a075-258">In practice, you can make this migration task a part of regular maintenance to your classes.</span></span> <span data-ttu-id="1a075-259">Este tutorial demonstrou o processo para migrar um aplicativo a fim de usar tipos de referência anuláveis.</span><span class="sxs-lookup"><span data-stu-id="1a075-259">This tutorial demonstrated the process to migrate an application to use nullable reference types.</span></span> <span data-ttu-id="1a075-260">Você pode explorar um exemplo real maior desse processo examinando a solicitação de pull feita por [Jon Skeet](https://github.com/jskeet) para incorporar tipos de referência anuláveis em [NodaTime](https://github.com/nodatime/nodatime/pull/1240/commits).</span><span class="sxs-lookup"><span data-stu-id="1a075-260">You can explore a larger real-world example of this process by examining the PR [Jon Skeet](https://github.com/jskeet) made to incorporate nullable reference types into [NodaTime](https://github.com/nodatime/nodatime/pull/1240/commits).</span></span>
