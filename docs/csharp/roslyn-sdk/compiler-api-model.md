---
title: Conceitos e modelo de objeto do SDK do .NET Compiler Platform
description: Esta visão geral fornece o contexto necessário para trabalhar efetivamente com o SDK do .NET Compiler. Você aprenderá sobre as camadas de API, os principais tipos envolvidos e o modelo de objeto geral.
ms.date: 07/13/2020
ms.custom: mvc
ms.openlocfilehash: a65d282dd3c58279bbfd635c0386d50ce3f30055
ms.sourcegitcommit: e7748001b1cee80ced691d8a76ca814c0b02dd9b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/14/2020
ms.locfileid: "86374462"
---
# <a name="understand-the-net-compiler-platform-sdk-model"></a><span data-ttu-id="de6f9-104">Entender o modelo do SDK do .NET Compiler Platform</span><span class="sxs-lookup"><span data-stu-id="de6f9-104">Understand the .NET Compiler Platform SDK model</span></span>

<span data-ttu-id="de6f9-105">Os compiladores processam o código escrito seguindo regras estruturadas que geralmente diferem da forma como os humanos leem e entendem um código.</span><span class="sxs-lookup"><span data-stu-id="de6f9-105">Compilers process the code you write following structured rules that often differ from the way humans read and understand code.</span></span> <span data-ttu-id="de6f9-106">Uma compreensão básica do modelo usado pelos compiladores é essencial para compreender as APIs usadas ao criar ferramentas baseadas no Roslyn.</span><span class="sxs-lookup"><span data-stu-id="de6f9-106">A basic understanding of the model used by compilers is essential to understanding the APIs you use when building Roslyn-based tools.</span></span>

## <a name="compiler-pipeline-functional-areas"></a><span data-ttu-id="de6f9-107">Áreas funcionais do pipeline do compilador</span><span class="sxs-lookup"><span data-stu-id="de6f9-107">Compiler pipeline functional areas</span></span>

<span data-ttu-id="de6f9-108">O SDK do .NET Compiler Platform expõe a análise de código dos compiladores C# e Visual Basic para você como um consumidor, fornecendo uma camada de API que espelha um pipeline de compilador tradicional.</span><span class="sxs-lookup"><span data-stu-id="de6f9-108">The .NET Compiler Platform SDK exposes the C# and Visual Basic compilers' code analysis to you as a consumer by providing an API layer that mirrors a traditional compiler pipeline.</span></span>

![etapas de processamento do pipeline do compilador do código-fonte para o código de objeto](media/compiler-api-model/compiler-pipeline.png)

<span data-ttu-id="de6f9-110">Cada fase desse pipeline é um componente separado.</span><span class="sxs-lookup"><span data-stu-id="de6f9-110">Each phase of this pipeline is a separate component.</span></span> <span data-ttu-id="de6f9-111">Primeiro, a fase de análise cria tokens do texto de origem e o analisa na sintaxe que segue a gramática da linguagem.</span><span class="sxs-lookup"><span data-stu-id="de6f9-111">First, the parse phase tokenizes and parses source text into syntax that follows the language grammar.</span></span> <span data-ttu-id="de6f9-112">Depois, a fase de declaração analisa os metadados de origem e importados para formar símbolos nomeados.</span><span class="sxs-lookup"><span data-stu-id="de6f9-112">Second, the declaration phase analyzes source and imported metadata to form named symbols.</span></span> <span data-ttu-id="de6f9-113">Em seguida, a fase de associação corresponde os identificadores no código aos símbolos.</span><span class="sxs-lookup"><span data-stu-id="de6f9-113">Next, the bind phase matches identifiers in the code to symbols.</span></span> <span data-ttu-id="de6f9-114">Por fim, a fase de emissão emite um assembly com todas as informações criadas pelo compilador.</span><span class="sxs-lookup"><span data-stu-id="de6f9-114">Finally, the emit phase emits an assembly with all the information built up by the compiler.</span></span>

![API do pipeline do compilador fornece acesso a cada etapa que faz parte do pipeline do compilador](media/compiler-api-model/compiler-pipeline-api.png)

<span data-ttu-id="de6f9-116">Correspondente a cada uma dessas fases, o SDK do .NET Compiler Platform expõe um modelo de objeto que permite o acesso às informações da fase.</span><span class="sxs-lookup"><span data-stu-id="de6f9-116">Corresponding to each of those phases, the .NET Compiler Platform SDK exposes an object model that allows access to the information at that phase.</span></span> <span data-ttu-id="de6f9-117">A fase de análise expõe uma árvore de sintaxe, a fase de declaração expõe uma tabela de símbolos hierárquica, a fase de ligação expõe o resultado da análise semântica do compilador e a fase de emissão é uma API que produz códigos de bytes de IL.</span><span class="sxs-lookup"><span data-stu-id="de6f9-117">The parsing phase exposes a syntax tree, the declaration phase exposes a hierarchical symbol table, the binding phase exposes the result of the compiler's semantic analysis, and the emit phase is an API that produces IL byte codes.</span></span>

![os serviço de linguagem disponíveis na API do compilador em cada etapa do pipeline do compilador](media/compiler-api-model/compiler-pipeline-lang-svc.png)

<span data-ttu-id="de6f9-119">Cada compilador combina esses componentes como um único inteiro de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="de6f9-119">Each compiler combines these components together as a single end-to-end whole.</span></span>

<span data-ttu-id="de6f9-120">Essas APIs são as mesmas usadas pelo Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="de6f9-120">These APIs are the same ones used by Visual Studio.</span></span> <span data-ttu-id="de6f9-121">Por exemplo, os recursos de estrutura de tópicos e formatação do código usam as árvores de sintaxe, o **pesquisador de objetos**e os recursos de navegação usam a tabela de símbolos, refatoração e **ir para definição** usam o modelo semântico, e **Editar e continuar** usa todos eles, incluindo a API de emissão.</span><span class="sxs-lookup"><span data-stu-id="de6f9-121">For instance, the code outlining and formatting features use the syntax trees, the **Object Browser**, and navigation features use the symbol table, refactorings and **Go to Definition** use the semantic model, and **Edit and Continue** uses all of these, including the Emit API.</span></span>

## <a name="api-layers"></a><span data-ttu-id="de6f9-122">Camadas de API</span><span class="sxs-lookup"><span data-stu-id="de6f9-122">API layers</span></span>

<span data-ttu-id="de6f9-123">O SDK do compilador .NET consiste em várias camadas de APIs: APIs de compilador, APIs de diagnóstico, APIs de script e APIs de espaços de trabalho.</span><span class="sxs-lookup"><span data-stu-id="de6f9-123">The .NET compiler SDK consists of several layers of APIs: compiler APIs, diagnostic APIs, scripting APIs, and workspaces APIs.</span></span>

### <a name="compiler-apis"></a><span data-ttu-id="de6f9-124">APIs do compilador</span><span class="sxs-lookup"><span data-stu-id="de6f9-124">Compiler APIs</span></span>

<span data-ttu-id="de6f9-125">A camada do compilador contém os modelos de objeto que correspondem às informações expostas em cada fase do pipeline do compilador, tanto sintáticas quanto semânticas.</span><span class="sxs-lookup"><span data-stu-id="de6f9-125">The compiler layer contains the object models that correspond to information exposed at each phase of the compiler pipeline, both syntactic and semantic.</span></span> <span data-ttu-id="de6f9-126">A camada do compilador também contém um instantâneo imutável de uma única invocação de um compilador, incluindo referências de assembly, opções do compilador e arquivos de código-fonte.</span><span class="sxs-lookup"><span data-stu-id="de6f9-126">The compiler layer also contains an immutable snapshot of a single invocation of a compiler, including assembly references, compiler options, and source code files.</span></span> <span data-ttu-id="de6f9-127">Há duas APIs distintas que representam a linguagem C# e a linguagem Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="de6f9-127">There are two distinct APIs that represent the C# language and the Visual Basic language.</span></span> <span data-ttu-id="de6f9-128">As duas APIs são semelhantes em forma, mas adaptadas para alta fidelidade a cada idioma individual.</span><span class="sxs-lookup"><span data-stu-id="de6f9-128">The two APIs are similar in shape but tailored for high-fidelity to each individual language.</span></span> <span data-ttu-id="de6f9-129">Essa camada não tem dependências em componentes do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="de6f9-129">This layer has no dependencies on Visual Studio components.</span></span>

### <a name="diagnostic-apis"></a><span data-ttu-id="de6f9-130">APIs de diagnóstico</span><span class="sxs-lookup"><span data-stu-id="de6f9-130">Diagnostic APIs</span></span>

<span data-ttu-id="de6f9-131">Como parte de sua análise, o compilador pode produzir um conjunto de diagnósticos que abrangem tudo, desde a sintaxe, semântica e erros de atribuição definitiva a vários diagnósticos de avisos e informativos.</span><span class="sxs-lookup"><span data-stu-id="de6f9-131">As part of its analysis the compiler may produce a set of diagnostics covering everything from syntax, semantic, and definite assignment errors to various warnings and informational diagnostics.</span></span> <span data-ttu-id="de6f9-132">A camada de API do Compilador expõe o diagnóstico por meio de uma API extensível que permite que os analisadores definidos pelo usuário sejam conectados ao processo de compilação.</span><span class="sxs-lookup"><span data-stu-id="de6f9-132">The Compiler API layer exposes diagnostics through an extensible API that allows user-defined analyzers to be plugged into the compilation process.</span></span> <span data-ttu-id="de6f9-133">Ela possibilita que o diagnóstico definido pelo usuário, como aqueles gerados por ferramentas como o StyleCop ou FxCop, seja produzido junto com o diagnóstico definido pelo compilador.</span><span class="sxs-lookup"><span data-stu-id="de6f9-133">It allows user-defined diagnostics, such as those produced by tools like StyleCop or FxCop, to be produced alongside compiler-defined diagnostics.</span></span> <span data-ttu-id="de6f9-134">A produção de diagnóstico dessa maneira tem o benefício de integrar naturalmente com ferramentas como o MSBuild e o Visual Studio, que dependem de diagnósticos para experiências como interromper uma compilação com base na política e mostrar rabiscos ao vivo no editor e sugerir correções de código.</span><span class="sxs-lookup"><span data-stu-id="de6f9-134">Producing diagnostics in this way has the benefit of integrating naturally with tools such as MSBuild and Visual Studio, which depend on diagnostics for experiences such as halting a build based on policy and showing live squiggles in the editor and suggesting code fixes.</span></span>

### <a name="scripting-apis"></a><span data-ttu-id="de6f9-135">APIs de script</span><span class="sxs-lookup"><span data-stu-id="de6f9-135">Scripting APIs</span></span>

<span data-ttu-id="de6f9-136">APIs de hospedagem e script fazem parte da camada do compilador.</span><span class="sxs-lookup"><span data-stu-id="de6f9-136">Hosting and scripting APIs are part of the compiler layer.</span></span> <span data-ttu-id="de6f9-137">Você pode usá-las para execução de snippets de código e acúmulo de um contexto de execução em runtime.</span><span class="sxs-lookup"><span data-stu-id="de6f9-137">You can use them for executing code snippets and accumulating a runtime execution context.</span></span>
<span data-ttu-id="de6f9-138">O REPL (Loop de Leitura-Avaliação-Impressão) interativo do C# usa essas APIs.</span><span class="sxs-lookup"><span data-stu-id="de6f9-138">The C# interactive REPL (Read-Evaluate-Print Loop) uses these APIs.</span></span> <span data-ttu-id="de6f9-139">O REPL permite usar o C# como a linguagem de scripts, executando o código de forma interativa à medida que ele é escrito.</span><span class="sxs-lookup"><span data-stu-id="de6f9-139">The REPL enables you to use C# as a scripting language, executing the code interactively as you write it.</span></span>

### <a name="workspaces-apis"></a><span data-ttu-id="de6f9-140">APIs dos workspaces</span><span class="sxs-lookup"><span data-stu-id="de6f9-140">Workspaces APIs</span></span>

<span data-ttu-id="de6f9-141">A camada Workspaces contém a API de Workspace, que é o ponto de partida para fazer a análise de código e refatoração em soluções inteiras.</span><span class="sxs-lookup"><span data-stu-id="de6f9-141">The Workspaces layer contains the Workspace API, which is the starting point for doing code analysis and refactoring over entire solutions.</span></span> <span data-ttu-id="de6f9-142">Ele ajuda você a organizar todas as informações sobre os projetos em uma solução em um único modelo de objeto, oferecendo acesso direto aos modelos de objeto da camada do compilador sem a necessidade de analisar arquivos, configurar opções ou gerenciar dependências de projeto para projeto.</span><span class="sxs-lookup"><span data-stu-id="de6f9-142">It assists you in organizing all the information about the projects in a solution into a single object model, offering you direct access to the compiler layer object models without needing to parse files, configure options, or manage project-to-project dependencies.</span></span>

<span data-ttu-id="de6f9-143">Além disso, a camada Workspaces expõe um conjunto de APIs usado ao implementar ferramentas de análise de código e refatoração que funcionam em um ambiente de host como o IDE do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="de6f9-143">In addition, the Workspaces layer surfaces a set of APIs used when implementing code analysis and refactoring tools that function within a host environment like the Visual Studio IDE.</span></span> <span data-ttu-id="de6f9-144">Exemplos incluem as APIs Localizar Todas as Referências, Formatação e Geração de Código.</span><span class="sxs-lookup"><span data-stu-id="de6f9-144">Examples include the Find All References, Formatting, and Code Generation APIs.</span></span>

<span data-ttu-id="de6f9-145">Essa camada não tem dependências em componentes do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="de6f9-145">This layer has no dependencies on Visual Studio components.</span></span>
