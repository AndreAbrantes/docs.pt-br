---
title: 'Passo a passo: Criando e usando objetos dinâmicos (C# e Visual Basic)'
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
ms.openlocfilehash: f315b6500e68812863da722791d257930e190602
ms.sourcegitcommit: e614e0f3b031293e4107f37f752be43652f3f253
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/26/2018
ms.locfileid: "42931284"
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="bf27a-102">Passo a passo: Criando e usando objetos dinâmicos (C# e Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bf27a-102">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="bf27a-103">Objetos dinâmicos expõem membros como métodos e propriedades em tempo de execução e não em tempo de compilação.</span><span class="sxs-lookup"><span data-stu-id="bf27a-103">Dynamic objects expose members such as properties and methods at run time, instead of in at compile time.</span></span> <span data-ttu-id="bf27a-104">Isso permite que você crie objetos para trabalhar com estruturas que não correspondem a um formato ou tipo estático.</span><span class="sxs-lookup"><span data-stu-id="bf27a-104">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="bf27a-105">Por exemplo, você pode usar um objeto dinâmico para fazer referência ao DOM (Modelo de Objeto do Documento) HTML, que pode conter qualquer combinação de atributos e elementos de marcação HTML válidos.</span><span class="sxs-lookup"><span data-stu-id="bf27a-105">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="bf27a-106">Como cada documento HTML é único, os membros de um determinado documento HTML são determinados em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="bf27a-106">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="bf27a-107">Um método comum para fazer referência a um atributo de um elemento HTML é passar o nome do atributo para o método `GetProperty` do elemento.</span><span class="sxs-lookup"><span data-stu-id="bf27a-107">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="bf27a-108">Para fazer referência ao atributo `id` do elemento HTML `<div id="Div1">`, primeiro você obtém uma referência ao elemento `<div>` e, depois, usa `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-108">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="bf27a-109">Se usar um objeto dinâmico, você poderá fazer referência ao atributo `id` como `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-109">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="bf27a-110">Objetos dinâmicos também fornecem acesso conveniente a linguagens dinâmicas, como IronPython e IronRuby.</span><span class="sxs-lookup"><span data-stu-id="bf27a-110">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="bf27a-111">É possível usar um objeto dinâmico para fazer referência a um script dinâmico que é interpretado em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="bf27a-111">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="bf27a-112">Você faz referência a um objeto dinâmico usando a associação tardia.</span><span class="sxs-lookup"><span data-stu-id="bf27a-112">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="bf27a-113">Em C#, você especifica o tipo de um objeto com associação tardia como `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-113">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="bf27a-114">No Visual Basic, você especifica o tipo de um objeto de associação tardia como `Object`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-114">In Visual Basic, you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="bf27a-115">Para obter mais informações, consulte [dynamic](../../../csharp/language-reference/keywords/dynamic.md) e [Associação antecipada e tardia](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="bf27a-115">For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="bf27a-116">Você pode criar objetos dinâmicos personalizados usando classes no namespace <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bf27a-116">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="bf27a-117">Por exemplo, é possível criar um <xref:System.Dynamic.ExpandoObject> e especificar os membros desse objeto em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="bf27a-117">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="bf27a-118">Você também pode criar seu próprio tipo que herda da classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="bf27a-118">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="bf27a-119">Em seguida, você pode substituir os membros da classe <xref:System.Dynamic.DynamicObject> para fornecer funcionalidade dinâmica de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="bf27a-119">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="bf27a-120">Nesta explicação passo a passo, você executará as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="bf27a-120">In this walkthrough you will perform the following tasks:</span></span>  
  
-   <span data-ttu-id="bf27a-121">Criar um objeto personalizado que expõe dinamicamente o conteúdo de um arquivo de texto como propriedades de um objeto.</span><span class="sxs-lookup"><span data-stu-id="bf27a-121">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
-   <span data-ttu-id="bf27a-122">Criar um projeto que usa uma biblioteca `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-122">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="bf27a-123">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="bf27a-123">Prerequisites</span></span>  
<span data-ttu-id="bf27a-124">É necessário ter o [IronPython](http://ironpython.net/) para .NET para concluir este passo a passo.</span><span class="sxs-lookup"><span data-stu-id="bf27a-124">You need [IronPython](http://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="bf27a-125">Navegue até a respectiva [página de download](http://ironpython.net/download/) para obter a versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="bf27a-125">Go to their [Download page](http://ironpython.net/download/) to obtain the latest version.</span></span>
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="bf27a-126">Criando um objeto dinâmico personalizado</span><span class="sxs-lookup"><span data-stu-id="bf27a-126">Creating a Custom Dynamic Object</span></span>

<span data-ttu-id="bf27a-127">O primeiro projeto que você cria neste passo a passo define um objeto dinâmico personalizado que pesquisa o conteúdo de um arquivo de texto.</span><span class="sxs-lookup"><span data-stu-id="bf27a-127">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="bf27a-128">O texto a ser pesquisado é especificado pelo nome de uma propriedade dinâmica.</span><span class="sxs-lookup"><span data-stu-id="bf27a-128">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="bf27a-129">Por exemplo, se o código de chamada especificar `dynamicFile.Sample`, a classe dinâmica retornará uma lista genérica de cadeias de caracteres que contém todas as linhas do arquivo que começam com "Sample".</span><span class="sxs-lookup"><span data-stu-id="bf27a-129">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="bf27a-130">A pesquisa diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="bf27a-130">The search is case-insensitive.</span></span> <span data-ttu-id="bf27a-131">A classe dinâmica também dá suporte a dois argumentos opcionais.</span><span class="sxs-lookup"><span data-stu-id="bf27a-131">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="bf27a-132">O primeiro argumento é um valor de enum de opção de pesquisa que especifica que a classe dinâmica deve pesquisar por correspondências no início da linha, no final da linha ou em qualquer lugar da linha.</span><span class="sxs-lookup"><span data-stu-id="bf27a-132">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="bf27a-133">O segundo argumento especifica que a classe dinâmica deve cortar espaços iniciais e finais de cada linha antes de pesquisar.</span><span class="sxs-lookup"><span data-stu-id="bf27a-133">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="bf27a-134">Por exemplo, se o código de chamada especificar `dynamicFile.Sample(StringSearchOption.Contains)`, a classe dinâmica pesquisará por "Sample" em qualquer lugar de uma linha.</span><span class="sxs-lookup"><span data-stu-id="bf27a-134">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="bf27a-135">Se o código de chamada especificar `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, a classe dinâmica pesquisará por "Sample" no início de cada linha e não removerá espaços à direita e à esquerda.</span><span class="sxs-lookup"><span data-stu-id="bf27a-135">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="bf27a-136">O comportamento padrão da classe dinâmica é pesquisar por uma correspondência no início de cada linha e remover espaços à direita e à esquerda.</span><span class="sxs-lookup"><span data-stu-id="bf27a-136">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="bf27a-137">Para criar uma classe dinâmica personalizada</span><span class="sxs-lookup"><span data-stu-id="bf27a-137">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="bf27a-138">Inicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bf27a-138">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="bf27a-139">No menu **Arquivo**, aponte para **Novo** e clique em **Projeto**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-139">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3.  <span data-ttu-id="bf27a-140">Na caixa de diálogo **Novo Projeto**, no painel **Tipos de Projetos**, certifique-se de que **Windows** esteja selecionado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-140">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="bf27a-141">Selecione **Aplicativo de Console** no painel **Modelos**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-141">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="bf27a-142">Na caixa **Nome**, digite `DynamicSample` e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-142">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="bf27a-143">O novo projeto é criado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-143">The new project is created.</span></span>  
  
4.  <span data-ttu-id="bf27a-144">Clique com botão direito do mouse no projeto DynamicSample e aponte para **Adicionar** e, em seguida, clique em **Classe**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-144">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="bf27a-145">Na caixa **Nome**, digite `ReadOnlyFile` e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-145">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="bf27a-146">É adicionado um novo arquivo que contém a classe ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="bf27a-146">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5.  <span data-ttu-id="bf27a-147">Na parte superior do arquivo ReadOnlyFile.cs ou ReadOnlyFile.vb, adicione o código a seguir para importar os namespaces <xref:System.IO?displayProperty=nameWithType> e <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bf27a-147">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>  

    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]
    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]  

6.  <span data-ttu-id="bf27a-148">O objeto dinâmico personalizado usa um enum para determinar os critérios de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bf27a-148">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="bf27a-149">Antes da instrução de classe, adicione a seguinte definição de enum.</span><span class="sxs-lookup"><span data-stu-id="bf27a-149">Before the class statement, add the following enum definition.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]
    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]
  
7.  <span data-ttu-id="bf27a-150">Atualize a instrução de classe para herdar a classe `DynamicObject`, conforme mostrado no exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="bf27a-150">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]
    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]

8.  <span data-ttu-id="bf27a-151">Adicione o código a seguir para a classe `ReadOnlyFile` para definir um campo particular para o caminho do arquivo e um construtor para a classe `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-151">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]
    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]
  
9. <span data-ttu-id="bf27a-152">Adicione o seguinte método de `GetPropertyValue` a classe de `ReadOnlyFile` .</span><span class="sxs-lookup"><span data-stu-id="bf27a-152">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="bf27a-153">O método `GetPropertyValue` usa, como entrada, critérios de pesquisa e retorna as linhas de um arquivo de texto que correspondem a esse critério de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bf27a-153">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="bf27a-154">Os métodos dinâmicos fornecidos pela classe `ReadOnlyFile` chamam o método `GetPropertyValue` para recuperar seus respectivos resultados.</span><span class="sxs-lookup"><span data-stu-id="bf27a-154">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]
    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]  
  
10. <span data-ttu-id="bf27a-155">Após o método `GetPropertyValue`, adicione o seguinte código para substituir o método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> da classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="bf27a-155">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="bf27a-156">O método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> é chamado quando um membro de uma classe dinâmica é solicitado e nenhum argumento é especificado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-156">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="bf27a-157">O argumento `binder` contém informações sobre o membro referenciado e o argumento `result` faz referência ao resultado retornado para o membro especificado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-157">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="bf27a-158">O método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> retorna um valor booliano que retorna `true` se o membro solicitado existe; caso contrário, ele retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]
    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]
  
11. <span data-ttu-id="bf27a-159">Após o método `TryGetMember`, adicione o seguinte código para substituir o método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> da classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="bf27a-159">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="bf27a-160">O método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> é chamado quando um membro de uma classe dinâmica é solicitado com argumentos.</span><span class="sxs-lookup"><span data-stu-id="bf27a-160">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="bf27a-161">O argumento `binder` contém informações sobre o membro referenciado e o argumento `result` faz referência ao resultado retornado para o membro especificado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-161">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="bf27a-162">O argumento `args` contém uma matriz de argumentos que são passados ao membro.</span><span class="sxs-lookup"><span data-stu-id="bf27a-162">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="bf27a-163">O método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> retorna um valor booliano que retorna `true` se o membro solicitado existe; caso contrário, ele retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="bf27a-163">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    <span data-ttu-id="bf27a-164">A versão personalizada do método `TryInvokeMember` espera que o primeiro argumento seja um valor do enum `StringSearchOption` que você definiu na etapa anterior.</span><span class="sxs-lookup"><span data-stu-id="bf27a-164">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="bf27a-165">O método `TryInvokeMember` espera que o segundo argumento seja um valor booliano.</span><span class="sxs-lookup"><span data-stu-id="bf27a-165">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="bf27a-166">Se um ou os dois argumentos forem valores válidos, eles serão passados para o método `GetPropertyValue` para recuperar os resultados.</span><span class="sxs-lookup"><span data-stu-id="bf27a-166">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]
    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]
  
12. <span data-ttu-id="bf27a-167">Salve e feche o arquivo.</span><span class="sxs-lookup"><span data-stu-id="bf27a-167">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="bf27a-168">Para criar um arquivo de texto de exemplo</span><span class="sxs-lookup"><span data-stu-id="bf27a-168">To create a sample text file</span></span>  
  
1.  <span data-ttu-id="bf27a-169">Clique com botão direito do mouse no projeto DynamicSample e aponte para **Adicionar** e, em seguida, clique em **Novo Item**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-169">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="bf27a-170">No painel **Modelos Instalados**, selecione **Geral** e, então, selecione o modelo **Arquivo de Texto**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-170">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="bf27a-171">Deixe o nome padrão de TextFile1.txt na caixa **Nome** caixa e, em seguida, clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-171">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="bf27a-172">Um novo arquivo de texto é adicionado ao projeto.</span><span class="sxs-lookup"><span data-stu-id="bf27a-172">A new text file is added to the project.</span></span>  
  
2.  <span data-ttu-id="bf27a-173">Copie o seguinte texto para o arquivo TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="bf27a-173">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (http://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (http://www.graphicdesigninstitute.com/)   
    Supplier: Fabrikam, Inc. (http://www.fabrikam.com/)   
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)   
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3.  <span data-ttu-id="bf27a-174">Salve e feche o arquivo.</span><span class="sxs-lookup"><span data-stu-id="bf27a-174">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="bf27a-175">Para criar um aplicativo de exemplo que usa o objeto dinâmico personalizado</span><span class="sxs-lookup"><span data-stu-id="bf27a-175">To create a sample application that uses the custom dynamic object</span></span>  
  
1.  <span data-ttu-id="bf27a-176">No **Gerenciador de Soluções**, clique duas vezes no arquivo Module1.vb se você estiver usando Visual Basic ou no arquivo Program.cs se estiver usando o Visual C#.</span><span class="sxs-lookup"><span data-stu-id="bf27a-176">In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.</span></span>  
  
2.  <span data-ttu-id="bf27a-177">Adicione o código a seguir ao procedimento Main para criar uma instância da classe `ReadOnlyFile` para o arquivo TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="bf27a-177">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="bf27a-178">O código usa associação tardia para chamar membros dinâmicos e recuperar linhas de texto que contêm a cadeia de caracteres "Customer".</span><span class="sxs-lookup"><span data-stu-id="bf27a-178">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]
     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]
  
3.  <span data-ttu-id="bf27a-179">Salve o arquivo e pressione CTRL+F5 para compilar e executar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bf27a-179">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="bf27a-180">Chamando uma biblioteca de linguagem dinâmica</span><span class="sxs-lookup"><span data-stu-id="bf27a-180">Calling a Dynamic Language Library</span></span>  

<span data-ttu-id="bf27a-181">O próximo projeto que você cria neste passo a passo acessa uma biblioteca escrita na linguagem dinâmica IronPython.</span><span class="sxs-lookup"><span data-stu-id="bf27a-181">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="bf27a-182">Para criar uma classe dinâmica personalizada</span><span class="sxs-lookup"><span data-stu-id="bf27a-182">To create a custom dynamic class</span></span>
  
1.  <span data-ttu-id="bf27a-183">No Visual Studio, no menu **Arquivo**, aponte para **Novo** e clique em **Projeto**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-183">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="bf27a-184">Na caixa de diálogo **Novo Projeto**, no painel **Tipos de Projetos**, certifique-se de que **Windows** esteja selecionado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-184">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="bf27a-185">Selecione **Aplicativo de Console** no painel **Modelos**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-185">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="bf27a-186">Na caixa **Nome**, digite `DynamicIronPythonSample` e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-186">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="bf27a-187">O novo projeto é criado.</span><span class="sxs-lookup"><span data-stu-id="bf27a-187">The new project is created.</span></span>  
  
3.  <span data-ttu-id="bf27a-188">Se você estiver usando o Visual Basic, clique com o botão direito do mouse no projeto DynamicIronPythonSample e, em seguida, clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-188">If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="bf27a-189">Clique na guia **Referências**. Clique no botão **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-189">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="bf27a-190">Se você estiver usando o Visual C#, no **Gerenciador de Soluções**, clique com botão direito do mouse na pasta **Referências** e, em seguida, clique em **Adicionar Referência**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-190">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4.  <span data-ttu-id="bf27a-191">Na guia **Procurar**, navegue até a pasta em que as bibliotecas do IronPython estão instaladas.</span><span class="sxs-lookup"><span data-stu-id="bf27a-191">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="bf27a-192">Por exemplo, C:\Program Files\IronPython 2.6 for .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="bf27a-192">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="bf27a-193">Selecione as bibliotecas **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll** e **Microsoft.Dynamic.dll**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-193">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="bf27a-194">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="bf27a-194">Click **OK**.</span></span>  
  
5.  <span data-ttu-id="bf27a-195">Se você estiver usando o Visual Basic, edite o arquivo Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="bf27a-195">If you are using Visual Basic, edit the Module1.vb file.</span></span> <span data-ttu-id="bf27a-196">Se estiver usando o Visual C#, edite o arquivo Program.cs.</span><span class="sxs-lookup"><span data-stu-id="bf27a-196">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6.  <span data-ttu-id="bf27a-197">Na parte superior do arquivo, adicione o código a seguir para importar os namespaces `Microsoft.Scripting.Hosting` e `IronPython.Hosting` das bibliotecas do IronPython.</span><span class="sxs-lookup"><span data-stu-id="bf27a-197">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]
    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]
  
7.  <span data-ttu-id="bf27a-198">No método Main, adicione o código a seguir para criar um novo objeto `Microsoft.Scripting.Hosting.ScriptRuntime` para hospedar as bibliotecas do IronPython.</span><span class="sxs-lookup"><span data-stu-id="bf27a-198">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="bf27a-199">O objeto `ScriptRuntime` carrega o módulo random.py da biblioteca do IronPython.</span><span class="sxs-lookup"><span data-stu-id="bf27a-199">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]
     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]
  
8.  <span data-ttu-id="bf27a-200">Após o código carregar o módulo random.py, adicione o seguinte código para criar uma matriz de inteiros.</span><span class="sxs-lookup"><span data-stu-id="bf27a-200">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="bf27a-201">A matriz é passada para o método `shuffle` do módulo random.py, que classifica aleatoriamente os valores na matriz.</span><span class="sxs-lookup"><span data-stu-id="bf27a-201">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]
     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]
  
9. <span data-ttu-id="bf27a-202">Salve o arquivo e pressione CTRL+F5 para compilar e executar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bf27a-202">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bf27a-203">Consulte também</span><span class="sxs-lookup"><span data-stu-id="bf27a-203">See Also</span></span>  
 <xref:System.Dynamic?displayProperty=nameWithType>  
 <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>  
 [<span data-ttu-id="bf27a-204">Usando o tipo dynamic</span><span class="sxs-lookup"><span data-stu-id="bf27a-204">Using Type dynamic</span></span>](../../../csharp/programming-guide/types/using-type-dynamic.md)  
 [<span data-ttu-id="bf27a-205">Associação Antecipada e Tardia</span><span class="sxs-lookup"><span data-stu-id="bf27a-205">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)  
 [<span data-ttu-id="bf27a-206">dynamic</span><span class="sxs-lookup"><span data-stu-id="bf27a-206">dynamic</span></span>](../../../csharp/language-reference/keywords/dynamic.md)  
 [<span data-ttu-id="bf27a-207">Implementando interfaces dinâmicas (PDF baixável do Microsoft TechNet)</span><span class="sxs-lookup"><span data-stu-id="bf27a-207">Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)</span></span>](http://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)
