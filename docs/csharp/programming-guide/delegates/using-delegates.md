---
title: Como usar delegados – Guia de Programação em C#
ms.custom: seodec18
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [C#], how to use
ms.assetid: 99a2fc27-a32e-4a34-921c-e65497520eec
ms.openlocfilehash: 1e77c994062c7ac9ee009bc0e12d39e530e8af80
ms.sourcegitcommit: 9ee6cd851b6e176a5811ea28ed0d5935c71950f9
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/09/2019
ms.locfileid: "68868844"
---
# <a name="using-delegates-c-programming-guide"></a><span data-ttu-id="ada03-102">Usando delegados (Guia de Programação em C#)</span><span class="sxs-lookup"><span data-stu-id="ada03-102">Using Delegates (C# Programming Guide)</span></span>
<span data-ttu-id="ada03-103">Um [delegado](../../../csharp/language-reference/keywords/delegate.md) é um tipo que encapsula com segurança um método, semelhante a um ponteiro de função em C e C++.</span><span class="sxs-lookup"><span data-stu-id="ada03-103">A [delegate](../../../csharp/language-reference/keywords/delegate.md) is a type that safely encapsulates a method, similar to a function pointer in C and C++.</span></span> <span data-ttu-id="ada03-104">No entanto, ao contrário dos ponteiros de função de C, delegados são orientados a objeto, fortemente tipados e seguros.</span><span class="sxs-lookup"><span data-stu-id="ada03-104">Unlike C function pointers, delegates are object-oriented, type safe, and secure.</span></span> <span data-ttu-id="ada03-105">O tipo de um delegado é definido pelo nome do delegado.</span><span class="sxs-lookup"><span data-stu-id="ada03-105">The type of a delegate is defined by the name of the delegate.</span></span> <span data-ttu-id="ada03-106">O exemplo a seguir declara um delegado chamado `Del` que pode encapsular um método que usa uma [cadeia de caracteres](../../../csharp/language-reference/keywords/string.md) como um argumento e retorna [nulo](../../../csharp/language-reference/keywords/void.md):</span><span class="sxs-lookup"><span data-stu-id="ada03-106">The following example declares a delegate named `Del` that can encapsulate a method that takes a [string](../../../csharp/language-reference/keywords/string.md) as an argument and returns [void](../../../csharp/language-reference/keywords/void.md):</span></span>  
  
 [!code-csharp[csProgGuideDelegates#21](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#21)]  
  
 <span data-ttu-id="ada03-107">Um objeto delegado é normalmente construído fornecendo-se o nome do método que o delegado encapsulará ou com uma [função anônima](../../../csharp/programming-guide/statements-expressions-operators/anonymous-functions.md).</span><span class="sxs-lookup"><span data-stu-id="ada03-107">A delegate object is normally constructed by providing the name of the method the delegate will wrap, or with an [anonymous function](../../../csharp/programming-guide/statements-expressions-operators/anonymous-functions.md).</span></span> <span data-ttu-id="ada03-108">Quando um delegado é instanciado, uma chamada de método feita ao delegado será passada pelo delegado para esse método.</span><span class="sxs-lookup"><span data-stu-id="ada03-108">Once a delegate is instantiated, a method call made to the delegate will be passed by the delegate to that method.</span></span> <span data-ttu-id="ada03-109">Os parâmetros passados para o delegado pelo chamador são passados para o método e o valor de retorno, se houver, do método é retornado ao chamador pelo delegado.</span><span class="sxs-lookup"><span data-stu-id="ada03-109">The parameters passed to the delegate by the caller are passed to the method, and the return value, if any, from the method is returned to the caller by the delegate.</span></span> <span data-ttu-id="ada03-110">Isso é conhecido como invocar o delegado.</span><span class="sxs-lookup"><span data-stu-id="ada03-110">This is known as invoking the delegate.</span></span> <span data-ttu-id="ada03-111">Um delegado instanciado pode ser invocado como se fosse o método encapsulado em si.</span><span class="sxs-lookup"><span data-stu-id="ada03-111">An instantiated delegate can be invoked as if it were the wrapped method itself.</span></span> <span data-ttu-id="ada03-112">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="ada03-112">For example:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#22](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#22)]  
  
 [!code-csharp[csProgGuideDelegates#23](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#23)]  
  
 <span data-ttu-id="ada03-113">Tipos de delegado são derivados da classe <xref:System.Delegate> do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ada03-113">Delegate types are derived from the <xref:System.Delegate> class in the .NET Framework.</span></span> <span data-ttu-id="ada03-114">Tipos de delegado são [lacrados](../../../csharp/language-reference/keywords/sealed.md) – não podem ser derivados de – e não é possível derivar classes personalizadas de <xref:System.Delegate>.</span><span class="sxs-lookup"><span data-stu-id="ada03-114">Delegate types are [sealed](../../../csharp/language-reference/keywords/sealed.md)—they cannot be derived from— and it is not possible to derive custom classes from <xref:System.Delegate>.</span></span> <span data-ttu-id="ada03-115">Como o delegado instanciado é um objeto, ele pode ser passado como um parâmetro ou atribuído a uma propriedade.</span><span class="sxs-lookup"><span data-stu-id="ada03-115">Because the instantiated delegate is an object, it can be passed as a parameter, or assigned to a property.</span></span> <span data-ttu-id="ada03-116">Isso permite que um método aceite um delegado como um parâmetro e chame o delegado posteriormente.</span><span class="sxs-lookup"><span data-stu-id="ada03-116">This allows a method to accept a delegate as a parameter, and call the delegate at some later time.</span></span> <span data-ttu-id="ada03-117">Isso é conhecido como um retorno de chamada assíncrono e é um método comum de notificação de um chamador quando um processo longo for concluído.</span><span class="sxs-lookup"><span data-stu-id="ada03-117">This is known as an asynchronous callback, and is a common method of notifying a caller when a long process has completed.</span></span> <span data-ttu-id="ada03-118">Quando um delegado é usado dessa maneira, o código que usa o delegado não precisa de conhecimento algum da implementação do método que está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="ada03-118">When a delegate is used in this fashion, the code using the delegate does not need any knowledge of the implementation of the method being used.</span></span> <span data-ttu-id="ada03-119">A funcionalidade é semelhante ao encapsulamento que as interfaces fornecem.</span><span class="sxs-lookup"><span data-stu-id="ada03-119">The functionality is similar to the encapsulation interfaces provide.</span></span>  
  
 <span data-ttu-id="ada03-120">Outro uso comum de chamadas de retorno é definir um método de comparação personalizada e passar esse delegado para um método de classificação.</span><span class="sxs-lookup"><span data-stu-id="ada03-120">Another common use of callbacks is defining a custom comparison method and passing that delegate to a sort method.</span></span> <span data-ttu-id="ada03-121">Ele permite que o código do chamador se torne parte do algoritmo de classificação.</span><span class="sxs-lookup"><span data-stu-id="ada03-121">It allows the caller's code to become part of the sort algorithm.</span></span> <span data-ttu-id="ada03-122">O método de exemplo a seguir usa o tipo `Del` como um parâmetro:</span><span class="sxs-lookup"><span data-stu-id="ada03-122">The following example method uses the `Del` type as a parameter:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#24](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#24)]  
  
 <span data-ttu-id="ada03-123">Em seguida, você pode passar o delegado criado acima para esse método:</span><span class="sxs-lookup"><span data-stu-id="ada03-123">You can then pass the delegate created above to that method:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#25](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#25)]  
  
 <span data-ttu-id="ada03-124">e receber a seguinte saída para o console:</span><span class="sxs-lookup"><span data-stu-id="ada03-124">and receive the following output to the console:</span></span>  
  
 `The number is: 3`  
  
 <span data-ttu-id="ada03-125">Usando o delegado como uma abstração, `MethodWithCallback` não precisa chamar o console diretamente — ele não precisa ser criado com um console em mente.</span><span class="sxs-lookup"><span data-stu-id="ada03-125">Using the delegate as an abstraction, `MethodWithCallback` does not need to call the console directly—it does not have to be designed with a console in mind.</span></span> <span data-ttu-id="ada03-126">O que `MethodWithCallback` faz é simplesmente preparar uma cadeia de caracteres e passá-la para outro método.</span><span class="sxs-lookup"><span data-stu-id="ada03-126">What `MethodWithCallback` does is simply prepare a string and pass the string to another method.</span></span> <span data-ttu-id="ada03-127">Isso é especialmente poderoso, uma vez que um método delegado pode usar qualquer número de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="ada03-127">This is especially powerful since a delegated method can use any number of parameters.</span></span>  
  
 <span data-ttu-id="ada03-128">Quando um delegado é construído para encapsular um método de instância, o delegado faz referência à instância e ao método.</span><span class="sxs-lookup"><span data-stu-id="ada03-128">When a delegate is constructed to wrap an instance method, the delegate references both the instance and the method.</span></span> <span data-ttu-id="ada03-129">Um delegado não tem conhecimento do tipo de instância além do método que ele encapsula, de modo que um delegado pode se referir a qualquer tipo de objeto desde que haja um método nesse objeto que corresponda à assinatura do delegado.</span><span class="sxs-lookup"><span data-stu-id="ada03-129">A delegate has no knowledge of the instance type aside from the method it wraps, so a delegate can refer to any type of object as long as there is a method on that object that matches the delegate signature.</span></span> <span data-ttu-id="ada03-130">Quando um delegado é construído para encapsular um método estático, ele só faz referência ao método.</span><span class="sxs-lookup"><span data-stu-id="ada03-130">When a delegate is constructed to wrap a static method, it only references the method.</span></span> <span data-ttu-id="ada03-131">Considere as seguintes declarações:</span><span class="sxs-lookup"><span data-stu-id="ada03-131">Consider the following declarations:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#26](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#26)]  
  
 <span data-ttu-id="ada03-132">Além do `DelegateMethod` estático mostrado anteriormente, agora temos três métodos que podem ser encapsulados por uma instância `Del`.</span><span class="sxs-lookup"><span data-stu-id="ada03-132">Along with the static `DelegateMethod` shown previously, we now have three methods that can be wrapped by a `Del` instance.</span></span>  
  
 <span data-ttu-id="ada03-133">Um delegado pode chamar mais de um método quando invocado.</span><span class="sxs-lookup"><span data-stu-id="ada03-133">A delegate can call more than one method when invoked.</span></span> <span data-ttu-id="ada03-134">Isso é chamado de multicast.</span><span class="sxs-lookup"><span data-stu-id="ada03-134">This is referred to as multicasting.</span></span> <span data-ttu-id="ada03-135">Para adicionar um método extra à lista de métodos do delegado — a lista de invocação — basta adicionar dois delegados usando os operadores de adição ou de atribuição de adição ('+' ou '+ =').</span><span class="sxs-lookup"><span data-stu-id="ada03-135">To add an extra method to the delegate's list of methods—the invocation list—simply requires adding two delegates using the addition or addition assignment operators ('+' or '+=').</span></span> <span data-ttu-id="ada03-136">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="ada03-136">For example:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#27](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#27)]  
  
 <span data-ttu-id="ada03-137">Nesse ponto, `allMethodsDelegate` contém três métodos em sua lista de invocação —`Method1`, `Method2` e `DelegateMethod`.</span><span class="sxs-lookup"><span data-stu-id="ada03-137">At this point `allMethodsDelegate` contains three methods in its invocation list—`Method1`, `Method2`, and `DelegateMethod`.</span></span> <span data-ttu-id="ada03-138">Os três delegados originais, `d1`, `d2` e `d3`, permanecem inalterados.</span><span class="sxs-lookup"><span data-stu-id="ada03-138">The original three delegates, `d1`, `d2`, and `d3`, remain unchanged.</span></span> <span data-ttu-id="ada03-139">Quando `allMethodsDelegate` é invocado, os três métodos são chamados na ordem.</span><span class="sxs-lookup"><span data-stu-id="ada03-139">When `allMethodsDelegate` is invoked, all three methods are called in order.</span></span> <span data-ttu-id="ada03-140">Se o delegado usar parâmetros de referência, a referência será passada em sequência para cada um dos três métodos por vez, e quaisquer alterações em um método serão visíveis no próximo método.</span><span class="sxs-lookup"><span data-stu-id="ada03-140">If the delegate uses reference parameters, the reference is passed sequentially to each of the three methods in turn, and any changes by one method are visible to the next method.</span></span> <span data-ttu-id="ada03-141">Quando algum dos métodos gerar uma exceção que não foi detectada dentro do método, essa exceção será passada ao chamador do delegado e nenhum método subsequente na lista de invocação será chamado.</span><span class="sxs-lookup"><span data-stu-id="ada03-141">When any of the methods throws an exception that is not caught within the method, that exception is passed to the caller of the delegate and no subsequent methods in the invocation list are called.</span></span> <span data-ttu-id="ada03-142">Se o delegado tiver um valor de retorno e/ou parâmetros de saída, ele retornará o valor de retorno e os parâmetros do último método invocado.</span><span class="sxs-lookup"><span data-stu-id="ada03-142">If the delegate has a return value and/or out parameters, it returns the return value and parameters of the last method invoked.</span></span> <span data-ttu-id="ada03-143">Para remover um método da lista de invocação, use os [operadores de atribuição de subtração ou subtração](../../language-reference/operators/subtraction-operator.md) (`-` ou `-=`).</span><span class="sxs-lookup"><span data-stu-id="ada03-143">To remove a method from the invocation list, use the [subtraction or subtraction assignment operators](../../language-reference/operators/subtraction-operator.md) (`-` or `-=`).</span></span> <span data-ttu-id="ada03-144">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="ada03-144">For example:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#28](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#28)]  
  
 <span data-ttu-id="ada03-145">Como os tipos de delegados são derivados de `System.Delegate`, os métodos e as propriedades definidos por essa classe podem ser chamados no delegado.</span><span class="sxs-lookup"><span data-stu-id="ada03-145">Because delegate types are derived from `System.Delegate`, the methods and properties defined by that class can be called on the delegate.</span></span> <span data-ttu-id="ada03-146">Por exemplo, para localizar o número de métodos na lista de invocação do delegado, é possível escrever:</span><span class="sxs-lookup"><span data-stu-id="ada03-146">For example, to find the number of methods in a delegate's invocation list, you may write:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#29](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#29)]  
  
 <span data-ttu-id="ada03-147">Delegados com mais de um método em sua lista de invocação derivam de <xref:System.MulticastDelegate>, que é uma subclasse de `System.Delegate`.</span><span class="sxs-lookup"><span data-stu-id="ada03-147">Delegates with more than one method in their invocation list derive from <xref:System.MulticastDelegate>, which is a subclass of `System.Delegate`.</span></span> <span data-ttu-id="ada03-148">O código acima funciona em ambos os casos, pois as classes oferecem suporte à `GetInvocationList`.</span><span class="sxs-lookup"><span data-stu-id="ada03-148">The above code works in either case because both classes support `GetInvocationList`.</span></span>  
  
 <span data-ttu-id="ada03-149">Delegados multicast são amplamente usados na manipulação de eventos.</span><span class="sxs-lookup"><span data-stu-id="ada03-149">Multicast delegates are used extensively in event handling.</span></span> <span data-ttu-id="ada03-150">Objetos de origem do evento enviam notificações de eventos aos objetos de destinatário que se registraram para receber esse evento.</span><span class="sxs-lookup"><span data-stu-id="ada03-150">Event source objects send event notifications to recipient objects that have registered to receive that event.</span></span> <span data-ttu-id="ada03-151">Para se registrar para um evento, o destinatário cria um método projetado para lidar com o evento, em seguida, cria um delegado para esse método e passa o delegado para a origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ada03-151">To register for an event, the recipient creates a method designed to handle the event, then creates a delegate for that method and passes the delegate to the event source.</span></span> <span data-ttu-id="ada03-152">A origem chama o delegado quando o evento ocorre.</span><span class="sxs-lookup"><span data-stu-id="ada03-152">The source calls the delegate when the event occurs.</span></span> <span data-ttu-id="ada03-153">O delegado chama então o método de manipulação de eventos no destinatário, fornecendo os dados do evento.</span><span class="sxs-lookup"><span data-stu-id="ada03-153">The delegate then calls the event handling method on the recipient, delivering the event data.</span></span> <span data-ttu-id="ada03-154">O tipo de delegado de um determinado evento é definido pela origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ada03-154">The delegate type for a given event is defined by the event source.</span></span> <span data-ttu-id="ada03-155">Para saber mais, consulte [Eventos](../../../csharp/programming-guide/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="ada03-155">For more, see [Events](../../../csharp/programming-guide/events/index.md).</span></span>  
  
 <span data-ttu-id="ada03-156">A comparação de delegados de dois tipos diferentes atribuídos no tempo de compilação resultará em um erro de compilação.</span><span class="sxs-lookup"><span data-stu-id="ada03-156">Comparing delegates of two different types assigned at compile-time will result in a compilation error.</span></span> <span data-ttu-id="ada03-157">Se as instâncias de delegado forem estaticamente do tipo `System.Delegate`, então a comparação será permitida, mas retornará false no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="ada03-157">If the delegate instances are statically of the type `System.Delegate`, then the comparison is allowed, but will return false at run time.</span></span> <span data-ttu-id="ada03-158">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="ada03-158">For example:</span></span>  
  
 [!code-csharp[csProgGuideDelegates#30](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#30)]  
  
## <a name="see-also"></a><span data-ttu-id="ada03-159">Consulte também</span><span class="sxs-lookup"><span data-stu-id="ada03-159">See also</span></span>

- [<span data-ttu-id="ada03-160">Guia de Programação em C#</span><span class="sxs-lookup"><span data-stu-id="ada03-160">C# Programming Guide</span></span>](../../../csharp/programming-guide/index.md)
- [<span data-ttu-id="ada03-161">Delegados</span><span class="sxs-lookup"><span data-stu-id="ada03-161">Delegates</span></span>](../../../csharp/programming-guide/delegates/index.md)
- [<span data-ttu-id="ada03-162">Usando Variação em Delegações</span><span class="sxs-lookup"><span data-stu-id="ada03-162">Using Variance in Delegates</span></span>](../../../csharp/programming-guide/concepts/covariance-contravariance/using-variance-in-delegates.md)
- [<span data-ttu-id="ada03-163">Variação em Delegações</span><span class="sxs-lookup"><span data-stu-id="ada03-163">Variance in Delegates</span></span>](../../../csharp/programming-guide/concepts/covariance-contravariance/variance-in-delegates.md)
- [<span data-ttu-id="ada03-164">Usando Variação para Delegações Genéricas Func e Action</span><span class="sxs-lookup"><span data-stu-id="ada03-164">Using Variance for Func and Action Generic Delegates</span></span>](../../../csharp/programming-guide/concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md)
- [<span data-ttu-id="ada03-165">Eventos</span><span class="sxs-lookup"><span data-stu-id="ada03-165">Events</span></span>](../../../csharp/programming-guide/events/index.md)
