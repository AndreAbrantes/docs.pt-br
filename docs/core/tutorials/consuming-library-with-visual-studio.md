---
title: Consumindo uma biblioteca de classes com .NET Core no Visual Studio 2017
description: Saiba como chamar os membros em uma biblioteca de classes com o Visual Studio 2017.
author: BillWagner
ms.author: wiwagn
ms.date: 08/07/2017
ms.topic: article
ms.prod: .net-core
ms.translationtype: HT
ms.sourcegitcommit: 1b028e5880f9e57e87c16eabeb442e0a46a369da
ms.openlocfilehash: 38e6c7d8797285abc4eb2e87602cc0bbf46ba590
ms.contentlocale: pt-br
ms.lasthandoff: 09/08/2017

---

# <a name="consuming-a-class-library-with-net-core-in-visual-studio-2017"></a><span data-ttu-id="a4f2b-103">Consumindo uma biblioteca de classes com .NET Core no Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="a4f2b-103">Consuming a class library with .NET Core in Visual Studio 2017</span></span>

<span data-ttu-id="a4f2b-104">Depois de criar uma biblioteca de classes seguindo as etapas em [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) (Compilação de uma biblioteca de classes em C# com o .NET Core no Visual Studio 2017) ou [Building a Visual Basic class library with .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) (Compilação de uma biblioteca de classes em Visual Basic com o .NET Core no Visual Studio 2017), testá-la em [Testar uma biblioteca de classes com .NET Core no Visual Studio 2017](testing-library-with-visual-studio.md), compilar uma versão de liberação da biblioteca, a próxima etapa é disponibilizá-la aos chamadores.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-104">Once you've created a class library by following the steps in [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) or [Building a Visual Basic class library with .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), tested it in [Testing a class library with .NET Core in Visual Studio 2017](testing-library-with-visual-studio.md), and built a Release version of the library, the next step is to make it available to callers.</span></span> <span data-ttu-id="a4f2b-105">Você pode fazer isso de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="a4f2b-105">You can do this in two ways:</span></span>

* <span data-ttu-id="a4f2b-106">Se a biblioteca for usada por uma única solução (por exemplo, se for um componente em um único aplicativo grande), você poderá incluí-la como um projeto de sua solução.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-106">If the library will be used by a single solution (for example, if it's a component in a single large application), you can include it as a project in your solution.</span></span>

* <span data-ttu-id="a4f2b-107">Se a biblioteca for, geralmente, acessível, você poderá distribuí-la como um pacote do NuGet.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-107">If the library will be generally accessible, you can distribute it as a NuGet package.</span></span>

## <a name="including-a-library-as-a-project-in-a-solution"></a><span data-ttu-id="a4f2b-108">Incluindo uma biblioteca como um projeto em uma solução</span><span class="sxs-lookup"><span data-stu-id="a4f2b-108">Including a library as a project in a solution</span></span>

<span data-ttu-id="a4f2b-109">Assim como você incluiu os testes de unidade na mesma solução que nossa biblioteca de classes, pode incluir seu aplicativo como parte da solução.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-109">Just as you included unit tests in the same solution as your class library, you can include your application as part of that solution.</span></span> <span data-ttu-id="a4f2b-110">Por exemplo, você pode usar a biblioteca de classes em um aplicativo de console que solicita que o usuário insira uma cadeia de caracteres e informe se o primeiro caractere é maiúsculo:</span><span class="sxs-lookup"><span data-stu-id="a4f2b-110">For example, you can use your class library in a console application that prompts the user to enter a string and reports whether its first character is uppercase:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="a4f2b-111">C#</span><span class="sxs-lookup"><span data-stu-id="a4f2b-111">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="a4f2b-112">Abra a solução `ClassLibraryProjects` criada no tópico [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) (Compilando uma biblioteca de classes em C# com o .NET Core no Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="a4f2b-112">Open the `ClassLibraryProjects` solution you created in the [Building a C# Class Library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="a4f2b-113">No **Gerenciador de Soluções**, clique com o botão direito do mouse na solução **ClassLibraryProjects** e selecione **Adicionar** > **Novo Projeto** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-113">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="a4f2b-114">Na caixa de diálogo **Adicionar novo projeto**, expanda o nó **Visual C#** e selecione o nó **.NET Core** seguido pelo modelo de projeto **Aplicativo de console (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-114">In the **Add New Project** dialog, expand the **Visual C#** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="a4f2b-115">Na caixa de texto **Nome**, digite "ShowCase" e selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-115">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Caixa de diálogo Adicionar Novo Projeto](./media/consuming-library-with-visual-studio/addnewproject.png)

1. <span data-ttu-id="a4f2b-117">No **Gerenciador de Soluções**, clique com o botão direito do mouse no projeto **ShowCase** e selecione **Definir como Projeto de Inicialização** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-117">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span> 

   ![Menu de contexto de ShowCase](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. <span data-ttu-id="a4f2b-119">Inicialmente, seu projeto não tem acesso à sua biblioteca de classes.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-119">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="a4f2b-120">Para permitir que ele chame métodos na biblioteca de classes, você cria uma referência à biblioteca de classes.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-120">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="a4f2b-121">No **Gerenciador de Soluções**, clique com o botão direito do mouse no nó **Dependências** do projeto `ShowCase` e selecione **Adicionar Referência**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-121">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menu de contexto Dependências de ShowCase](./media/consuming-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="a4f2b-123">Na caixa de diálogo **Gerenciador de Referências**, selecione **StringLibrary**, seu projeto de biblioteca de classes, e selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-123">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Gerenciador de referências](./media/consuming-library-with-visual-studio/referencemanager.png)

1. <span data-ttu-id="a4f2b-125">Na janela de código para o arquivo *Program.cs*, substitua todo o código pelo seguinte código:</span><span class="sxs-lookup"><span data-stu-id="a4f2b-125">In the code window for the *Program.cs* file, replace all of the code with the following code:</span></span>

   <span data-ttu-id="a4f2b-126">[!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]</span><span class="sxs-lookup"><span data-stu-id="a4f2b-126">[!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]</span></span>

   <span data-ttu-id="a4f2b-127">O código usa a propriedade [Console.WindowHeight](xref:System.Console.WindowHeight) para determinar o número de linhas na janela do console.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-127">The code uses the [Console.WindowHeight](xref:System.Console.WindowHeight) property to determine the number of rows in the console window.</span></span> <span data-ttu-id="a4f2b-128">Sempre que a propriedade [Console.CursorTop](xref:System.Console.CursorTop) for maior ou igual ao número de linhas na janela do console, o código limpará a janela do console e exibirá novamente uma mensagem para o usuário.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-128">Whenever the [Console.CursorTop](xref:System.Console.CursorTop) property is greater than or equal to the number of rows in the console window, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="a4f2b-129">O programa solicita que o usuário insira uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-129">The program prompts the user to enter a string.</span></span> <span data-ttu-id="a4f2b-130">Ele indica se a cadeia de caracteres começa com um caractere maiúsculo.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-130">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="a4f2b-131">Se o usuário pressionar a tecla Enter sem inserir uma cadeia de caracteres, o aplicativo será encerrado e a janela do console será fechada.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-131">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="a4f2b-132">Se necessário, altere a barra de ferramentas para compilar a versão de **Depuração** do projeto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-132">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="a4f2b-133">Compile e execute o programa selecionando a seta verde no botão **ShowCase**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-133">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Image](./media/consuming-library-with-visual-studio/toolbar.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="a4f2b-135">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="a4f2b-135">Visual Basic</span></span>](#tab/visual-basic)
1. <span data-ttu-id="a4f2b-136">Abra a solução `ClassLibraryProjects` criada no tópico [Building a class Library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) (Compilando uma biblioteca de classes com o Visual Basic e com o .NET Core no Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="a4f2b-136">Open the `ClassLibraryProjects` solution you created in the [Building a class Library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="a4f2b-137">No **Gerenciador de Soluções**, clique com o botão direito do mouse na solução **ClassLibraryProjects** e selecione **Adicionar** > **Novo Projeto** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-137">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="a4f2b-138">Na caixa de diálogo **Adicionar novo projeto**, expanda o nó **Visual Basic** e selecione o nó **.NET Core** seguido pelo modelo de projeto **Aplicativo de console (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-138">In the **Add New Project** dialog, expand the **Visual Basic** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="a4f2b-139">Na caixa de texto **Nome**, digite "ShowCase" e selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-139">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Caixa de diálogo Adicionar Novo Projeto](./media/consuming-library-with-visual-studio/vb-addnewproject.png)

1. <span data-ttu-id="a4f2b-141">No **Gerenciador de Soluções**, clique com o botão direito do mouse no projeto **ShowCase** e selecione **Definir como Projeto de Inicialização** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-141">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span> 

   ![Menu de contexto de ShowCase](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. <span data-ttu-id="a4f2b-143">Inicialmente, seu projeto não tem acesso à sua biblioteca de classes.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-143">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="a4f2b-144">Para permitir que ele chame métodos na biblioteca de classes, você cria uma referência à biblioteca de classes.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-144">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="a4f2b-145">No **Gerenciador de Soluções**, clique com o botão direito do mouse no nó **Dependências** do projeto `ShowCase` e selecione **Adicionar Referência**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-145">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menu de contexto Dependências de ShowCase](./media/consuming-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="a4f2b-147">Na caixa de diálogo **Gerenciador de Referências**, selecione **StringLibrary**, seu projeto de biblioteca de classes, e selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-147">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Gerenciador de referências](./media/consuming-library-with-visual-studio/referencemanager.png)

1. <span data-ttu-id="a4f2b-149">Na janela de código do arquivo *Program.vb*, substitua todo o código pelo seguinte código:</span><span class="sxs-lookup"><span data-stu-id="a4f2b-149">In the code window for the *Program.vb* file, replace all of the code with the following code:</span></span>

    <span data-ttu-id="a4f2b-150">[!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]</span><span class="sxs-lookup"><span data-stu-id="a4f2b-150">[!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]</span></span>

   <span data-ttu-id="a4f2b-151">O código usa a propriedade [Console.WindowHeight](xref:System.Console.WindowHeight) para determinar o número de linhas na janela do console.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-151">The code uses the [Console.WindowHeight](xref:System.Console.WindowHeight) property to determine the number of rows in the console window.</span></span> <span data-ttu-id="a4f2b-152">Sempre que a propriedade [Console.CursorTop](xref:System.Console.CursorTop) for maior ou igual ao número de linhas na janela do console, o código limpará a janela do console e exibirá novamente uma mensagem para o usuário.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-152">Whenever the [Console.CursorTop](xref:System.Console.CursorTop) property is greater than or equal to the number of rows in the console window, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="a4f2b-153">O programa solicita que o usuário insira uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-153">The program prompts the user to enter a string.</span></span> <span data-ttu-id="a4f2b-154">Ele indica se a cadeia de caracteres começa com um caractere maiúsculo.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-154">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="a4f2b-155">Se o usuário pressionar a tecla Enter sem inserir uma cadeia de caracteres, o aplicativo será encerrado e a janela do console será fechada.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-155">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="a4f2b-156">Se necessário, altere a barra de ferramentas para compilar a versão de **Depuração** do projeto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-156">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="a4f2b-157">Compile e execute o programa selecionando a seta verde no botão **ShowCase**.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-157">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Image](./media/consuming-library-with-visual-studio/toolbar.png)
---

<span data-ttu-id="a4f2b-159">É possível depurar e publicar o aplicativo que usa essa biblioteca seguindo as etapas em [Debugging your Hello World application with Visual Studio 2017](debugging-with-visual-studio.md) (Depurar um aplicativo Olá, Mundo com o Visual Studio 2017) e em [Publishing your Hello World Application with Visual Studio 2017](publishing-with-visual-studio.md) (Publicar um aplicativo Olá, Mundo com o Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="a4f2b-159">You can debug and publish the application that uses this library by following the steps in [Debugging your Hello World application with Visual Studio 2017](debugging-with-visual-studio.md) and [Publishing your Hello World Application with Visual Studio 2017](publishing-with-visual-studio.md).</span></span>

## <a name="distributing-the-library-in-a-nuget-package"></a><span data-ttu-id="a4f2b-160">Distribuindo a biblioteca em um pacote do NuGet</span><span class="sxs-lookup"><span data-stu-id="a4f2b-160">Distributing the library in a NuGet package</span></span>

<span data-ttu-id="a4f2b-161">Você pode fazer com que sua biblioteca de classes esteja amplamente disponível ao publicá-la como um pacote do NuGet.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-161">You can make your class library widely available by publishing it as a NuGet package.</span></span> <span data-ttu-id="a4f2b-162">O Visual Studio não dá suporte à criação de pacotes do NuGet.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-162">Visual Studio does not support the creation of NuGet packages.</span></span> <span data-ttu-id="a4f2b-163">Para criar um, use o [Utilitário de linha de comando do `dotnet`](../../core/tools/dotnet.md):</span><span class="sxs-lookup"><span data-stu-id="a4f2b-163">To create one, you use the [`dotnet` command line utility](../../core/tools/dotnet.md):</span></span>

1. <span data-ttu-id="a4f2b-164">Abra uma janela de console.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-164">Open a console window.</span></span> <span data-ttu-id="a4f2b-165">Por exemplo, na caixa de texto **Pergunte-me alguma coisa** na barra de tarefas do Windows, insira `Command Prompt` (ou `cmd` de forma abreviada) e abra uma janela de console selecionando o aplicativo da área de trabalho **Prompt de Comando** ou pressionando Enter se ele estiver selecionado nos resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-165">For example in the **Ask me anything** text box in the Windows taskbar, enter `Command Prompt` (or `cmd` for short), and open a console window by either selecting the **Command Prompt** desktop app or pressing Enter if it's selected in the search results.</span></span>

1. <span data-ttu-id="a4f2b-166">Navegue até o diretório do projeto da biblioteca.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-166">Navigate to your library's project directory.</span></span> <span data-ttu-id="a4f2b-167">A menos que você tenha reconfigurado o local do arquivo típico, ele está no diretório *Documentos\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary*.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-167">Unless you've reconfigured the typical file location, it's in the *Documents\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary* directory.</span></span> <span data-ttu-id="a4f2b-168">O diretório contém o código-fonte e um arquivo de projeto, *StringLibrary.csproj*.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-168">The directory contains your source code and a project file, *StringLibrary.csproj*.</span></span>

1. <span data-ttu-id="a4f2b-169">Execute o comando `dotnet pack --no-build`.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-169">Issue the command `dotnet pack --no-build`.</span></span> <span data-ttu-id="a4f2b-170">O utilitário `dotnet` gera um pacote com uma extensão *.nupkg*.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-170">The `dotnet` utility generates a package with a *.nupkg* extension.</span></span>

   > [!TIP]
   > <span data-ttu-id="a4f2b-171">Se o diretório que contém *dotnet.exe* não está no seu PATH, você pode encontrar seu local digitando `where dotnet.exe` na janela do console.</span><span class="sxs-lookup"><span data-stu-id="a4f2b-171">If the directory that contains *dotnet.exe* is not in your PATH, you can find its location by entering `where dotnet.exe` in the console window.</span></span>

<span data-ttu-id="a4f2b-172">Para obter mais informações sobre a criação de pacotes do NuGet, consulte [Como criar um pacote do NuGet com ferramentas de plataforma cruzada](../../core/deploying/creating-nuget-packages.md).</span><span class="sxs-lookup"><span data-stu-id="a4f2b-172">For more information on creating NuGet packages, see [How to Create a NuGet Package with Cross Platform Tools](../../core/deploying/creating-nuget-packages.md).</span></span>

