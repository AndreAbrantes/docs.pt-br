---
title: Testar uma biblioteca de classes .NET Standard com o .NET Core no Visual Studio 2017
description: Crie um projeto de teste de unidade para sua biblioteca de classes do .NET Core. Verifique se sua biblioteca de classes do .NET Core funciona corretamente com testes de unidade.
author: BillWagner
ms.author: wiwagn
ms.date: 08/07/2017
dev_langs:
- csharp
- vb
ms.custom: vs-dotnet, seodoc18
ms.openlocfilehash: 352599d60a42a034b3d6647b1fe8f1cbf2f4572d
ms.sourcegitcommit: 438919211260bb415fc8f96ca3eabc33cf2d681d
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/16/2019
ms.locfileid: "59611998"
---
# <a name="test-a-net-standard-library-with-net-core-in-visual-studio-2017"></a><span data-ttu-id="61c4d-104">Testar uma biblioteca .NET Standard com o .NET Core no Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="61c4d-104">Test a .NET Standard library with .NET Core in Visual Studio 2017</span></span>

<span data-ttu-id="61c4d-105">Em [Compilar uma biblioteca .NET Standard com C# e o .NET Core no Visual Studio 2017](library-with-visual-studio.md) ou [Compilar uma biblioteca .NET Standard com Visual Basic e o .NET Core no Visual Studio 2017](vb-library-with-visual-studio.md), você criou uma biblioteca de classes simples que adiciona um método de extensão à classe <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="61c4d-105">In [Build a .NET Standard library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md) or [Build a .NET Standard library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), you created a simple class library that adds an extension method to the <xref:System.String> class.</span></span> <span data-ttu-id="61c4d-106">Agora, você criará um teste de unidade para ter certeza de que ela funciona conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-106">Now, you'll create a unit test to make sure that it works as expected.</span></span> <span data-ttu-id="61c4d-107">Você adicionará seu projeto de teste de unidade à solução criada no artigo anterior.</span><span class="sxs-lookup"><span data-stu-id="61c4d-107">You'll add your unit test project to the solution you created in the previous article.</span></span>

## <a name="creating-a-unit-test-project"></a><span data-ttu-id="61c4d-108">Criar um projeto de teste de unidade</span><span class="sxs-lookup"><span data-stu-id="61c4d-108">Creating a unit test project</span></span>

<span data-ttu-id="61c4d-109">Para criar o projeto de teste de unidade, faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="61c4d-109">To create the unit test project, do the following:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="61c4d-110">C#</span><span class="sxs-lookup"><span data-stu-id="61c4d-110">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="61c4d-111">No **Gerenciador de Soluções**, abra o menu de contexto do nó da solução **ClassLibraryProjects** e selecione **Adicionar** > **Novo Projeto**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-111">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="61c4d-112">Na caixa de diálogo **Adicionar novo projeto**, selecione o nó **Visual C#**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-112">In the **Add New Project** dialog, select the **Visual C#** node.</span></span> <span data-ttu-id="61c4d-113">Em seguida, selecione o nó **.NET Core** seguido pelo modelo de projeto **Projeto de Teste do MSTest (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-113">Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="61c4d-114">Na caixa de texto **Nome**, digite "StringLibraryTest" como o nome do projeto.</span><span class="sxs-lookup"><span data-stu-id="61c4d-114">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="61c4d-115">Selecione **OK** para criar o projeto de teste de unidade.</span><span class="sxs-lookup"><span data-stu-id="61c4d-115">Select **OK** to create the unit test project.</span></span>

   ![Caixa de diálogo Adicionar Novo Projeto com o projeto de teste de unidade exibido – C#](./media/testing-library-with-visual-studio/create-new-test-project.png)

   > [!NOTE]  
   > <span data-ttu-id="61c4d-117">Além de um projeto de Teste do MSTest, também é possível usar o Visual Studio para criar um projeto de teste do xUnit para o .NET Core.</span><span class="sxs-lookup"><span data-stu-id="61c4d-117">In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="61c4d-118">O Visual Studio cria o projeto e abre o arquivo *UnitTest1.cs* na janela do código.</span><span class="sxs-lookup"><span data-stu-id="61c4d-118">Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window.</span></span>

   ![Janela de código do Visual Studio para o método e a classe de projeto de teste de unidade – C#](./media/testing-library-with-visual-studio/unit-test-editor-window.png)

   <span data-ttu-id="61c4d-120">O código-fonte criado pelo modelo de teste de unidade faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="61c4d-120">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="61c4d-121">Ele importa o namespace <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType>, que contém os tipos usados para o teste de unidade.</span><span class="sxs-lookup"><span data-stu-id="61c4d-121">It imports the <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType> namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="61c4d-122">Ele aplica o atributo<xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> à classe `UnitTest1`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-122">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="61c4d-123">Cada método de teste em uma classe de teste marcada com o atributo \[TestMethod\] é executado automaticamente quando o teste de unidade é executado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-123">Each test method in a test class tagged with the \[TestMethod\] attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="61c4d-124">Ele aplica o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> para definir `TestMethod1` como um método de teste para execução automática quando o teste de unidade é executado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-124">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="61c4d-125">No **Gerenciador de Soluções**, clique com o botão direito do mouse no nó **Dependências** do projeto **StringLibraryTest** e selecione **Adicionar Referência** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="61c4d-125">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Menu de contexto de Dependências de StringLibraryTest – C#](./media/testing-library-with-visual-studio/add-reference-context-menu.png)

1. <span data-ttu-id="61c4d-127">Na caixa de diálogo **Gerenciador de Referências**, expanda o nó **Projetos** e marque a caixa ao lado de **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-127">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="61c4d-128">A adição de uma referência ao assembly `StringLibrary` permite que o compilador localize os métodos **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-128">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="61c4d-129">Selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-129">Select the **OK** button.</span></span> <span data-ttu-id="61c4d-130">Isso adiciona uma referência ao seu projeto de biblioteca de classes, `StringLibrary`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-130">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Caixa de diálogo Adicionar referência de projeto do Visual Studio](./media/testing-library-with-visual-studio/project-reference-manager.png)
# <a name="visual-basictabvb"></a>[<span data-ttu-id="61c4d-132">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="61c4d-132">Visual Basic</span></span>](#tab/vb) 
1. <span data-ttu-id="61c4d-133">No **Gerenciador de Soluções**, abra o menu de contexto do nó da solução **ClassLibraryProjects** e selecione **Adicionar** > **Novo Projeto**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-133">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="61c4d-134">Na caixa de diálogo **Adicionar novo projeto**, selecione o nó **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-134">In the **Add New Project** dialog, select the **Visual Basic** node.</span></span> <span data-ttu-id="61c4d-135">Em seguida, selecione o nó **.NET Core** seguido pelo modelo de projeto **Projeto de Teste do MSTest (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-135">Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="61c4d-136">Na caixa de texto **Nome**, digite "StringLibraryTest" como o nome do projeto.</span><span class="sxs-lookup"><span data-stu-id="61c4d-136">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="61c4d-137">Selecione **OK** para criar o projeto de teste de unidade.</span><span class="sxs-lookup"><span data-stu-id="61c4d-137">Select **OK** to create the unit test project.</span></span>

   ![Caixa de diálogo Adicionar Novo Projeto com o projeto de teste de unidade exibido – Visual Basic](./media/testing-library-with-visual-studio/vb-create-new-test-project.png)

   > [!NOTE]  
   > <span data-ttu-id="61c4d-139">Além de um projeto de Teste do MSTest, também é possível usar o Visual Studio para criar um projeto de teste do xUnit para o .NET Core.</span><span class="sxs-lookup"><span data-stu-id="61c4d-139">In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="61c4d-140">O Visual Studio cria o projeto e abre o arquivo *UnitTest1.vb* na janela do código.</span><span class="sxs-lookup"><span data-stu-id="61c4d-140">Visual Studio creates the project and opens the *UnitTest1.vb* file in the code window.</span></span>

   ![Janela de código do Visual Studio para o método e a classe de projeto de teste de unidade – Visual Basic](./media/testing-library-with-visual-studio/vb-unit-test-editor-window.png)

   <span data-ttu-id="61c4d-142">O código-fonte criado pelo modelo de teste de unidade faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="61c4d-142">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="61c4d-143">Ele importa o namespace [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType>, que contém os tipos usados para o teste de unidade.</span><span class="sxs-lookup"><span data-stu-id="61c4d-143">It imports the [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType> namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="61c4d-144">Ele aplica o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute>) à classe `UnitTest1`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-144">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute>) attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="61c4d-145">Cada método de teste em uma classe de teste marcada com o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> é executado automaticamente quando o teste de unidade é executado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-145">Each test method in a test class tagged with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="61c4d-146">Ele aplica o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> para definir `TestMethod1` como um método de teste para execução automática quando o teste de unidade é executado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-146">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="61c4d-147">No **Gerenciador de Soluções**, clique com o botão direito do mouse no nó **Dependências** do projeto **StringLibraryTest** e selecione **Adicionar Referência** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="61c4d-147">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Menu de contexto de Dependências de StringLibraryTest](./media/testing-library-with-visual-studio/add-reference-context-menu.png)

1. <span data-ttu-id="61c4d-149">Na caixa de diálogo **Gerenciador de Referências**, expanda o nó **Projetos** e marque a caixa ao lado de **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-149">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="61c4d-150">A adição de uma referência ao assembly `StringLibrary` permite que o compilador localize os métodos **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-150">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="61c4d-151">Selecione o botão **OK**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-151">Select the **OK** button.</span></span> <span data-ttu-id="61c4d-152">Isso adiciona uma referência ao seu projeto de biblioteca de classes, `StringLibrary`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-152">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Caixa de diálogo Adicionar referência de projeto do Visual Studio – Visual Basic](./media/testing-library-with-visual-studio/project-reference-manager.png)
---

## <a name="adding-and-running-unit-test-methods"></a><span data-ttu-id="61c4d-154">Adicionar e executar métodos de teste de unidade</span><span class="sxs-lookup"><span data-stu-id="61c4d-154">Adding and running unit test methods</span></span>

<span data-ttu-id="61c4d-155">Quando o Visual Studio executa um teste de unidade, ele executa cada método marcado com o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> em uma classe de teste de unidade, a classe à qual o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> é aplicado.</span><span class="sxs-lookup"><span data-stu-id="61c4d-155">When Visual Studio runs a unit test, it executes each method marked with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute in a unit test class, the class to which the  <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute is applied.</span></span> <span data-ttu-id="61c4d-156">Um método de teste termina quando a primeira falha é encontrada ou quando todos os testes contidos no método têm êxito.</span><span class="sxs-lookup"><span data-stu-id="61c4d-156">A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.</span></span>

<span data-ttu-id="61c4d-157">Os testes mais comuns chamam membros da classe <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert>.</span><span class="sxs-lookup"><span data-stu-id="61c4d-157">The most common tests call members of the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> class.</span></span> <span data-ttu-id="61c4d-158">Muitos métodos assert incluem pelo menos dois parâmetros, um deles é o resultado esperado do teste, e o outro é o resultado real do teste.</span><span class="sxs-lookup"><span data-stu-id="61c4d-158">Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result.</span></span> <span data-ttu-id="61c4d-159">Alguns de seus métodos chamados com mais frequência são mostrados na tabela abaixo.</span><span class="sxs-lookup"><span data-stu-id="61c4d-159">Some of its most frequently called methods are shown in the table below.</span></span>

<span data-ttu-id="61c4d-160">Métodos assert</span><span class="sxs-lookup"><span data-stu-id="61c4d-160">Assert methods</span></span> | <span data-ttu-id="61c4d-161">Função</span><span class="sxs-lookup"><span data-stu-id="61c4d-161">Function</span></span>
--- | ---
`Assert.AreEqual` | <span data-ttu-id="61c4d-162">Verifica se os dois valores ou objetos são iguais.</span><span class="sxs-lookup"><span data-stu-id="61c4d-162">Verifies that two values or objects are equal.</span></span> <span data-ttu-id="61c4d-163">A assert falha se os valores ou objetos não forem iguais.</span><span class="sxs-lookup"><span data-stu-id="61c4d-163">The assert fails if the values or objects are not equal.</span></span>
`Assert.AreSame` | <span data-ttu-id="61c4d-164">Verifica se duas variáveis de objeto se referem ao mesmo objeto.</span><span class="sxs-lookup"><span data-stu-id="61c4d-164">Verifies that two object variables refer to the same object.</span></span> <span data-ttu-id="61c4d-165">A assert falhará se as variáveis se referirem a objetos diferentes.</span><span class="sxs-lookup"><span data-stu-id="61c4d-165">The assert fails if the variables refer to different objects.</span></span>
`Assert.IsFalse` | <span data-ttu-id="61c4d-166">Verifica se uma condição é `false`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-166">Verifies that a condition is `false`.</span></span> <span data-ttu-id="61c4d-167">O assert falhará se a condição for `true`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-167">The assert fails if the condition is `true`.</span></span>
`Assert.IsNotNull` | <span data-ttu-id="61c4d-168">Verifica se um objeto não é `null`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-168">Verifies that an object is not `null`.</span></span> <span data-ttu-id="61c4d-169">A assert falhará se o objeto for `null`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-169">The assert fails if the object is `null`.</span></span>

<span data-ttu-id="61c4d-170">Também é possível aplicar o atributo <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> a um método de teste.</span><span class="sxs-lookup"><span data-stu-id="61c4d-170">You can also apply the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> attribute to a test method.</span></span> <span data-ttu-id="61c4d-171">Ele indica o tipo de exceção que um método de teste deve gerar.</span><span class="sxs-lookup"><span data-stu-id="61c4d-171">It indicates the type of exception a test method is expected to throw.</span></span> <span data-ttu-id="61c4d-172">O teste falhará se a exceção especificada não for lançada.</span><span class="sxs-lookup"><span data-stu-id="61c4d-172">The test fails if the specified exception is not thrown.</span></span>

<span data-ttu-id="61c4d-173">Ao testar o método `StringLibrary.StartsWithUpper`, você quer fornecer um número de cadeias de caracteres que comecem com um caractere maiúsculo.</span><span class="sxs-lookup"><span data-stu-id="61c4d-173">In testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character.</span></span> <span data-ttu-id="61c4d-174">Você espera que o método retorne `true` nesses casos, para que possa chamar o método <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A>.</span><span class="sxs-lookup"><span data-stu-id="61c4d-174">You expect the method to return `true` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A> method.</span></span> <span data-ttu-id="61c4d-175">Da mesma forma, você deseja fornecer um número de cadeias de caracteres que comecem com algo diferente de um caractere maiúsculo.</span><span class="sxs-lookup"><span data-stu-id="61c4d-175">Similarly, you want to provide a number of strings that begin with something other than an uppercase character.</span></span> <span data-ttu-id="61c4d-176">Você espera que o método retorne `false` nesses casos, para que possa chamar o método <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A>.</span><span class="sxs-lookup"><span data-stu-id="61c4d-176">You expect the method to return `false` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A> method.</span></span>

<span data-ttu-id="61c4d-177">Como seu método de biblioteca lida com cadeias de caracteres, convém ter certeza de que ele manipulará com êxito uma [cadeia de caracteres vazia (`String.Empty`)](xref:System.String.Empty), uma cadeia de caracteres válida sem caracteres e cujo <xref:System.String.Length> é 0 e uma cadeia de caracteres `null` que não foi inicializada.</span><span class="sxs-lookup"><span data-stu-id="61c4d-177">Since your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose <xref:System.String.Length> is 0, and a `null` string that has not been initialized.</span></span> <span data-ttu-id="61c4d-178">Se `StartsWithUpper` for chamado como um método de extensão em uma instância de <xref:System.String>, ele não poderá receber uma cadeia de caracteres `null`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-178">If `StartsWithUpper` is called as an extension method on a <xref:System.String> instance, it cannot be passed a `null` string.</span></span> <span data-ttu-id="61c4d-179">No entanto, você também pode chamá-lo diretamente como um método estático e passa um único argumento <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="61c4d-179">However, you can also call it directly as a static method and pass a single <xref:System.String> argument.</span></span>

<span data-ttu-id="61c4d-180">Você definirá três métodos, cada um deles chamará seu método <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> repetidamente para cada elemento em uma matriz de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="61c4d-180">You'll define three methods, each of which calls its <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> method repeatedly for each element in a string array.</span></span> <span data-ttu-id="61c4d-181">Como o método de teste falha assim que encontra a primeira falha, você chamará uma sobrecarga de método que permite passar uma cadeia de caracteres que indica o valor da cadeia de caracteres usado na chamada do método.</span><span class="sxs-lookup"><span data-stu-id="61c4d-181">Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.</span></span>

<span data-ttu-id="61c4d-182">Para criar os métodos de teste:</span><span class="sxs-lookup"><span data-stu-id="61c4d-182">To create the test methods:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="61c4d-183">C#</span><span class="sxs-lookup"><span data-stu-id="61c4d-183">C#</span></span>](#tab/csharp) 
1. <span data-ttu-id="61c4d-184">Na janela de código *UnitTest1.cs*, substitua o código pelo seguinte código:</span><span class="sxs-lookup"><span data-stu-id="61c4d-184">In the *UnitTest1.cs* code window, replace the code with the following code:</span></span>

   [!CODE-csharp[Test#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/testlib1.cs)]

   <span data-ttu-id="61c4d-185">Observe que seu teste de caracteres maiúsculos no método `TestStartsWithUpper` inclui a letra maiúscula grega alfa (U+0391) e a letra maiúscula cirílica EM (U+041C) e o teste de caracteres minúsculos no método `TestDoesNotStartWithUpper` inclui a letra minúscula grega alfa (U+03B1) e a letra minúscula cirílica Ghe (U+0433).</span><span class="sxs-lookup"><span data-stu-id="61c4d-185">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="61c4d-186">Na barra de menus, selecione **Arquivo** > **Salvar UnitTest1.cs Como**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-186">On the menu bar, select **File** > **Save UnitTest1.cs As**.</span></span> <span data-ttu-id="61c4d-187">Na caixa de diálogo **Salvar Arquivo Como**, selecione a seta ao lado do botão **Salvar** e selecione **Salvar com Codificação**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-187">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Caixa de diálogo Salvar Arquivo como do Visual Studio – C#](./media/testing-library-with-visual-studio/save-file-as-dialog.png)
# <a name="visual-basictabvb"></a>[<span data-ttu-id="61c4d-189">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="61c4d-189">Visual Basic</span></span>](#tab/vb) 
1. <span data-ttu-id="61c4d-190">Na janela de código *UnitTest1.vb*, substitua o código pelo seguinte código:</span><span class="sxs-lookup"><span data-stu-id="61c4d-190">In the *UnitTest1.vb* code window, replace the code with the following code:</span></span>

    [!CODE-vb[Test#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/testlib.vb)]

   <span data-ttu-id="61c4d-191">Observe que seu teste de caracteres maiúsculos no método `TestStartsWithUpper` inclui a letra maiúscula grega alfa (U+0391) e a letra maiúscula cirílica EM (U+041C) e o teste de caracteres minúsculos no método `TestDoesNotStartWithUpper` inclui a letra minúscula grega alfa (U+03B1) e a letra minúscula cirílica Ghe (U+0433).</span><span class="sxs-lookup"><span data-stu-id="61c4d-191">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="61c4d-192">Na barra de menus, selecione **Arquivo** > **Salvar UnitTest1.vb Como**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-192">On the menu bar, select **File** > **Save UnitTest1.vb As**.</span></span> <span data-ttu-id="61c4d-193">Na caixa de diálogo **Salvar Arquivo Como**, selecione a seta ao lado do botão **Salvar** e selecione **Salvar com Codificação**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-193">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Caixa de diálogo Salvar Arquivo como do Visual Studio – Visual Basic](./media/testing-library-with-visual-studio/save-file-as-dialog.png)
---

1. <span data-ttu-id="61c4d-195">Na caixa de diálogo **Confirmar Salvar Como**, selecione o botão **Sim** para salvar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="61c4d-195">In the **Confirm Save As** dialog, select the **Yes** button to save the file.</span></span>

1. <span data-ttu-id="61c4d-196">Na caixa de diálogo **Opções Avançadas de Salvamento**, selecione **Unicode (UTF-8 com assinatura) – página de código 65001** na lista suspensa **Codificação** e selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-196">In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**.</span></span>

   ![Caixa de diálogo Opções Avançadas de Salvamento do Visual Studio](./media/testing-library-with-visual-studio/advanced-save-options.png)

   <span data-ttu-id="61c4d-198">Se você não salvar seu código-fonte como um arquivo codificado em UTF8, o Visual Studio poderá salvá-lo como um arquivo ASCII.</span><span class="sxs-lookup"><span data-stu-id="61c4d-198">If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file.</span></span> <span data-ttu-id="61c4d-199">Quando isso acontecer, o tempo de execução não decodificará de forma precisa os caracteres UTF8 fora do intervalo ASCII e os resultados de teste não serão precisos.</span><span class="sxs-lookup"><span data-stu-id="61c4d-199">When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.</span></span>

1. <span data-ttu-id="61c4d-200">Na barra de menus, selecione **Testar** > **Executar** > **Todos os Testes**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-200">On the menu bar, select **Test** > **Run** > **All Tests**.</span></span> <span data-ttu-id="61c4d-201">A janela **Gerenciador de Testes** é aberta e mostra que os testes foram executados com êxito.</span><span class="sxs-lookup"><span data-stu-id="61c4d-201">The **Test Explorer** window opens and shows that the tests ran successfully.</span></span> <span data-ttu-id="61c4d-202">Os três testes estão listados na seção **Testes Aprovados**, e a seção **Resumo** relata o resultado da execução de teste.</span><span class="sxs-lookup"><span data-stu-id="61c4d-202">The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run.</span></span>

   ![Janela Gerenciador de Testes com testes aprovados](./media/testing-library-with-visual-studio/test-explorer-window.png)

## <a name="handling-test-failures"></a><span data-ttu-id="61c4d-204">Tratamento de falhas do teste</span><span class="sxs-lookup"><span data-stu-id="61c4d-204">Handling test failures</span></span>

<span data-ttu-id="61c4d-205">Sua execução de teste não apresentou falhas, mas altere-a um pouco para que um dos métodos do teste falhe:</span><span class="sxs-lookup"><span data-stu-id="61c4d-205">Your test run had no failures, but change it slightly so that one of the test methods fails:</span></span>

1. <span data-ttu-id="61c4d-206">Modifique a matriz `words` no método `TestDoesNotStartWithUpper` para incluir a cadeia de caracteres “Error”.</span><span class="sxs-lookup"><span data-stu-id="61c4d-206">Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string "Error".</span></span> <span data-ttu-id="61c4d-207">Não é necessário salvar o arquivo porque o Visual Studio salva automaticamente os arquivos abertos quando uma solução é criada para executar testes.</span><span class="sxs-lookup"><span data-stu-id="61c4d-207">You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.</span></span>

   ```csharp
   string[] words = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " };
   ```

   ```vb
   Dim words() As String = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " }

   ```

1. <span data-ttu-id="61c4d-208">Execute o teste selecionando **Testar** > **Executar** > **Todos os Testes** na barra de menus.</span><span class="sxs-lookup"><span data-stu-id="61c4d-208">Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="61c4d-209">A Janela **Gerenciador de Testes** indica que dois testes tiveram êxito e um falhou.</span><span class="sxs-lookup"><span data-stu-id="61c4d-209">The **Test Explorer** window indicates that two tests succeeded and one failed.</span></span>

   ![Janela Gerenciador de Testes com testes com falha](./media/testing-library-with-visual-studio/failed-test-window.png)

1. <span data-ttu-id="61c4d-211">Na seção **Testes com Falha**, selecione o teste com falha, `TestDoesNotStartWith`.</span><span class="sxs-lookup"><span data-stu-id="61c4d-211">In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`.</span></span> <span data-ttu-id="61c4d-212">A janela **Gerenciador de Testes** exibe a mensagem produzida pelo assert: "Falha em Assert.IsFalse.</span><span class="sxs-lookup"><span data-stu-id="61c4d-212">The **Test Explorer** window displays the message produced by the assert: "Assert.IsFalse failed.</span></span> <span data-ttu-id="61c4d-213">Esperado para 'Error': false, real: True".</span><span class="sxs-lookup"><span data-stu-id="61c4d-213">Expected for 'Error': false; actual: True".</span></span> <span data-ttu-id="61c4d-214">Devido à falha, todas as cadeias de caracteres na matriz após "Error" não foram testadas.</span><span class="sxs-lookup"><span data-stu-id="61c4d-214">Because of the failure, all strings in the array after "Error" were not tested.</span></span>

   ![Janela Gerenciador de Testes mostrando a falha de asserção Is False](./media/testing-library-with-visual-studio/failed-test-detail.png)

1. <span data-ttu-id="61c4d-216">Desfaça as modificações feitas na etapa 1 e remova a cadeia de caracteres "Error".</span><span class="sxs-lookup"><span data-stu-id="61c4d-216">Undo the modification you did in step 1 and remove the string "Error".</span></span> <span data-ttu-id="61c4d-217">Execute novamente o teste, e eles serão aprovados.</span><span class="sxs-lookup"><span data-stu-id="61c4d-217">Rerun the test and the tests will pass.</span></span>

## <a name="testing-the-release-version-of-the-library"></a><span data-ttu-id="61c4d-218">Testar a versão de lançamento da biblioteca</span><span class="sxs-lookup"><span data-stu-id="61c4d-218">Testing the Release version of the library</span></span>

<span data-ttu-id="61c4d-219">Você estava executando nossos testes na versão de Depuração da biblioteca.</span><span class="sxs-lookup"><span data-stu-id="61c4d-219">You've been running your tests against the Debug version of the library.</span></span> <span data-ttu-id="61c4d-220">Agora que todos os testes foram aprovados, e nós testamos adequadamente nossa biblioteca, você deve executar os testes mais uma vez no build de Lançamento da biblioteca.</span><span class="sxs-lookup"><span data-stu-id="61c4d-220">Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library.</span></span> <span data-ttu-id="61c4d-221">Vários fatores, incluindo as otimizações do compilador, podem produzir um comportamento diferente entre as compilações de Depuração e Lançamento.</span><span class="sxs-lookup"><span data-stu-id="61c4d-221">A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.</span></span>

<span data-ttu-id="61c4d-222">Para testar a compilação de Lançamento:</span><span class="sxs-lookup"><span data-stu-id="61c4d-222">To test the Release build:</span></span>

1. <span data-ttu-id="61c4d-223">Na barra de ferramentas do Visual Studio, altere a configuração de compilação de **Depurar** para **Lançamento**.</span><span class="sxs-lookup"><span data-stu-id="61c4d-223">In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**.</span></span>

   ![Barra de ferramentas do Visual Studio com build de versão realçado](./media/testing-library-with-visual-studio/visual-studio-toolbar-release.png)

1. <span data-ttu-id="61c4d-225">No **Gerenciador de Soluções**, clique com o botão direito do mouse no projeto **StringLibrary** e selecione **Compilar** no menu de contexto para recompilar a biblioteca.</span><span class="sxs-lookup"><span data-stu-id="61c4d-225">In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library.</span></span>

   ![Menu de contexto de StringLibrary com comando de build](./media/testing-library-with-visual-studio/build-library-context-menu.png)

1. <span data-ttu-id="61c4d-227">Execute os testes de unidade escolhendo **Testar** > **Executar** > **Todos os Testes** na barra de menus.</span><span class="sxs-lookup"><span data-stu-id="61c4d-227">Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="61c4d-228">Os testes são aprovados.</span><span class="sxs-lookup"><span data-stu-id="61c4d-228">The tests pass.</span></span>

<span data-ttu-id="61c4d-229">Agora que você concluiu o teste de sua biblioteca, a próxima etapa é disponibilizá-la aos chamadores.</span><span class="sxs-lookup"><span data-stu-id="61c4d-229">Now that you've finished testing your library, the next step is to make it available to callers.</span></span> <span data-ttu-id="61c4d-230">Você pode agrupá-la com um ou mais aplicativos, ou pode distribuí-la como um pacote do NuGet.</span><span class="sxs-lookup"><span data-stu-id="61c4d-230">You can bundle it with one or more applications, or you can distribute it as a NuGet package.</span></span> <span data-ttu-id="61c4d-231">Para obter mais informações, consulte [Consumindo uma biblioteca de classes .NET Standard](./consuming-library-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="61c4d-231">For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md).</span></span>
