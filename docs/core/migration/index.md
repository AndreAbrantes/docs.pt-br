---
title: "Migração do .NET Core para o formato csproj"
description: "Migração do project.json para o csproj do .NET Core"
keywords: ".NET, .NET Core, migração do .NET Core"
author: blackdwarf
ms.author: mairaw
ms.date: 07/19/2017
ms.topic: article
ms.prod: .net-core
ms.devlang: dotnet
ms.assetid: 1feadf3d-3cfc-41dd-abb5-a4fc303a7b53
ms.openlocfilehash: 1d972489536e929c8694bd6a4cab31c9f2d624a8
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/18/2017
---
# <a name="migrating-net-core-projects-to-the-csproj-format"></a><span data-ttu-id="76e7b-104">Migrando projetos do .NET Core no formato .csproj</span><span class="sxs-lookup"><span data-stu-id="76e7b-104">Migrating .NET Core projects to the .csproj format</span></span>

<span data-ttu-id="76e7b-105">Este documento abrange cenários de migração para projetos do .NET Core e examina os três seguintes cenários de migração:</span><span class="sxs-lookup"><span data-stu-id="76e7b-105">This document will cover migration scenarios for .NET Core projects and will go over the following three migration scenarios:</span></span>

1. [<span data-ttu-id="76e7b-106">Migração de um esquema válido mais recente do *project.json* para o *csproj*</span><span class="sxs-lookup"><span data-stu-id="76e7b-106">Migration from a valid latest schema of *project.json* to *csproj*</span></span>](#migration-from-projectjson-to-csproj)
2. [<span data-ttu-id="76e7b-107">Migração do DNX para o csproj</span><span class="sxs-lookup"><span data-stu-id="76e7b-107">Migration from DNX to csproj</span></span>](#migration-from-dnx-to-csproj)
3. [<span data-ttu-id="76e7b-108">Migração do RC3 e de projetos csproj anteriores do .NET Core para o formato final</span><span class="sxs-lookup"><span data-stu-id="76e7b-108">Migration from RC3 and previous .NET Core csproj projects to the final format</span></span>](#migration-from-earlier-net-core-csproj-formats-to-rtm-csproj)

## <a name="migration-from-projectjson-to-csproj"></a><span data-ttu-id="76e7b-109">Migração do project.json para o csproj</span><span class="sxs-lookup"><span data-stu-id="76e7b-109">Migration from project.json to csproj</span></span>
<span data-ttu-id="76e7b-110">A migração do *project.json* para o *.csproj* pode ser feita usando um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="76e7b-110">Migration from *project.json* to *.csproj* can be done using one of the following methods:</span></span>

- [<span data-ttu-id="76e7b-111">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="76e7b-111">Visual Studio 2017</span></span>](#visual-studio-2017)
- [<span data-ttu-id="76e7b-112">ferramenta de linha de comando de migração do dotnet</span><span class="sxs-lookup"><span data-stu-id="76e7b-112">dotnet migrate command-line tool</span></span>](#dotnet-migrate)
 
<span data-ttu-id="76e7b-113">Ambos os métodos usam o mesmo mecanismo subjacente para migrar os projetos. Portanto, os resultados serão os mesmos.</span><span class="sxs-lookup"><span data-stu-id="76e7b-113">Both methods use the same underlying engine to migrate the projects, so the results will be the same for both.</span></span> <span data-ttu-id="76e7b-114">Na maioria dos casos, o uso de uma destas duas maneiras para migrar o *project.json* para o *csproj* é a única coisa exigida e nenhuma edição manual adicional do arquivo de projeto é necessária.</span><span class="sxs-lookup"><span data-stu-id="76e7b-114">In most cases, using one of these two ways to migrate the *project.json* to *csproj* is the only thing that is needed and no further manual editing of the project file is necessary.</span></span> <span data-ttu-id="76e7b-115">O arquivo *.csproj* resultante terá o mesmo nome que o diretório contido.</span><span class="sxs-lookup"><span data-stu-id="76e7b-115">The resulting *.csproj* file will be named the same as the containing directory name.</span></span>

### <a name="visual-studio-2017"></a><span data-ttu-id="76e7b-116">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="76e7b-116">Visual Studio 2017</span></span>

<span data-ttu-id="76e7b-117">Quando você abre um arquivo *.xproj* ou uma solução que faz referência a arquivos *.xproj*, a caixa de diálogo **Atualização unidirecional** aparece.</span><span class="sxs-lookup"><span data-stu-id="76e7b-117">When you open a *.xproj* file or a solution file which references *.xproj* files, the **One-way upgrade** dialog appears.</span></span> <span data-ttu-id="76e7b-118">A caixa de diálogo exibe os projetos a serem migrados.</span><span class="sxs-lookup"><span data-stu-id="76e7b-118">The dialog displays the projects to be migrated.</span></span> <span data-ttu-id="76e7b-119">Se você abrir um arquivo de solução, todos os projetos especificados no arquivo de solução serão listados.</span><span class="sxs-lookup"><span data-stu-id="76e7b-119">If you open a solution file, all the projects specified in the solution file will be listed.</span></span> <span data-ttu-id="76e7b-120">Examine a lista de projetos a serem migrados e selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="76e7b-120">Review the list of projects to be migrated and select **OK**.</span></span>

![Caixa de diálogo Atualização unidirecional mostrando a lista de projetos que serão migrados](media/one-way-upgrade.jpg)

<span data-ttu-id="76e7b-122">O Visual Studio migrará os projetos escolhidos automaticamente.</span><span class="sxs-lookup"><span data-stu-id="76e7b-122">Visual Studio will migrate the projects chosen automatically.</span></span> <span data-ttu-id="76e7b-123">Ao migrar uma solução, se você não escolher todos os projetos, a mesma caixa de diálogo será exibida solicitando que você atualize os projetos restantes da solução.</span><span class="sxs-lookup"><span data-stu-id="76e7b-123">When migrating a solution, if you don't choose all projects, the same dialog will appear asking you to upgrade the remaining projects from that solution.</span></span> <span data-ttu-id="76e7b-124">Depois que o projeto é migrado, é possível ver e modificar seus conteúdos clicando com o botão direito no projeto na janela do **Gerenciador de Soluções** e selecionando **Editar \<nome do projeto>. csproj**.</span><span class="sxs-lookup"><span data-stu-id="76e7b-124">After the project is migrated, you can see and modify its contents by right-clicking the project in the **Solution Explorer** window and selecting **Edit \<project name>.csproj**.</span></span>

<span data-ttu-id="76e7b-125">Os arquivos que foram migrados (*project.json*, *global.json*, *.xproj* e o arquivo de solução) serão movidos para uma pasta de *Backup*.</span><span class="sxs-lookup"><span data-stu-id="76e7b-125">Files that were migrated (*project.json*, *global.json*, *.xproj* and solution file) will be moved to a *Backup* folder.</span></span> <span data-ttu-id="76e7b-126">O arquivo de solução que foi migrado será atualizado para o Visual Studio 2017 e você não poderá abrir esse arquivo de solução em versões anteriores do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="76e7b-126">The solution file that is migrated will be upgraded to Visual Studio 2017 and you won't be able to open that solution file in previous versions of Visual Studio.</span></span> <span data-ttu-id="76e7b-127">Um arquivo chamado *UpgradeLog.htm* também será salvo e aberto automaticamente. Ele contém um relatório de migração.</span><span class="sxs-lookup"><span data-stu-id="76e7b-127">A file named *UpgradeLog.htm* is also saved and automatically opened that contains a migration report.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="76e7b-128">As novas ferramentas não estão disponível no Visual Studio 2015. Portanto, você não pode migrar seus projetos usando essa versão do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="76e7b-128">The new tooling is not available in Visual Studio 2015, so you cannot migrate your projects using that version of Visual Studio.</span></span>

### <a name="dotnet-migrate"></a><span data-ttu-id="76e7b-129">dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="76e7b-129">dotnet migrate</span></span>

<span data-ttu-id="76e7b-130">No cenário da linha de comando, você pode usar o comando [`dotnet migrate`](../tools/dotnet-migrate.md).</span><span class="sxs-lookup"><span data-stu-id="76e7b-130">In the command-line scenario, you can use the [`dotnet migrate`](../tools/dotnet-migrate.md) command.</span></span> <span data-ttu-id="76e7b-131">Ele migrará um projeto, uma solução ou um conjunto de pastas em uma determinada ordem, dependendo em qual eles foram encontrados.</span><span class="sxs-lookup"><span data-stu-id="76e7b-131">It will migrate a project, a solution or a set of folders in that order, depending on which ones were found.</span></span> <span data-ttu-id="76e7b-132">Ao migrar um projeto, o projeto e todas as suas dependências são migrados.</span><span class="sxs-lookup"><span data-stu-id="76e7b-132">When you migrate a project, the project and all its dependencies are migrated.</span></span>

<span data-ttu-id="76e7b-133">Os arquivos que foram migrados (*project.json*, *global.json* e *.xproj*) serão movidos para uma pasta de *Backup*.</span><span class="sxs-lookup"><span data-stu-id="76e7b-133">Files that were migrated (*project.json*, *global.json* and *.xproj*) will be moved to a *backup* folder.</span></span>

> [!NOTE]
> <span data-ttu-id="76e7b-134">Se estiver usando o Visual Studio Code, o comando `dotnet migrate` não modificará arquivos específicos do Visual Studio Code, como `tasks.json`.</span><span class="sxs-lookup"><span data-stu-id="76e7b-134">If you are using Visual Studio Code, the `dotnet migrate` command will not modify Visual Studio Code-specific files such as `tasks.json`.</span></span> <span data-ttu-id="76e7b-135">Esses arquivos precisam ser alterados manualmente.</span><span class="sxs-lookup"><span data-stu-id="76e7b-135">These files need to be changed manually.</span></span> <span data-ttu-id="76e7b-136">Isso também será verdadeiro se você estiver usando o Project Ryder ou qualquer editor ou IDE (ambiente de desenvolvimento integrado) diferente do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="76e7b-136">This is also true if you are using Project Ryder or any editor or Integrated Development Environment (IDE) other than Visual Studio.</span></span> 

<span data-ttu-id="76e7b-137">Consulte [Um mapeamento entre as propriedades project.json e csproj](../tools/project-json-to-csproj.md) para obter uma comparação dos formatos project.json e csproj.</span><span class="sxs-lookup"><span data-stu-id="76e7b-137">See [A mapping between project.json and csproj properties](../tools/project-json-to-csproj.md) for a comparison of project.json and csproj formats.</span></span>

### <a name="common-issues"></a><span data-ttu-id="76e7b-138">Problemas comuns</span><span class="sxs-lookup"><span data-stu-id="76e7b-138">Common issues</span></span>

- <span data-ttu-id="76e7b-139">Se houver um erro: "Nenhum executável encontrado corresponde ao comando dotnet-migrate":</span><span class="sxs-lookup"><span data-stu-id="76e7b-139">If you get an error: "No executable found matching command dotnet-migrate":</span></span>

<span data-ttu-id="76e7b-140">Execute `dotnet --version` para ver qual versão você está usando.</span><span class="sxs-lookup"><span data-stu-id="76e7b-140">Run `dotnet --version` to see which version you are using.</span></span> <span data-ttu-id="76e7b-141">[`dotnet migrate`](../tools/dotnet-migrate.md) requer o .NET Core CLI RC3 ou superior.</span><span class="sxs-lookup"><span data-stu-id="76e7b-141">[`dotnet migrate`](../tools/dotnet-migrate.md) requires .NET Core CLI RC3 or higher.</span></span>
<span data-ttu-id="76e7b-142">Esse erro ocorrerá se você tiver um arquivo *global.json* no diretório atual ou pai e se a versão `sdk` estiver definida como uma versão mais antiga.</span><span class="sxs-lookup"><span data-stu-id="76e7b-142">You’ll get this error if you have a *global.json* file in the current or parent directory and the `sdk` version is set to an older version.</span></span>

## <a name="migration-from-dnx-to-csproj"></a><span data-ttu-id="76e7b-143">Migração do DNX para o csproj</span><span class="sxs-lookup"><span data-stu-id="76e7b-143">Migration from DNX to csproj</span></span>
<span data-ttu-id="76e7b-144">Se você ainda estiver usando o DNX para desenvolvimento no .NET Core, o processo de migração deverá ser feito em dois estágios:</span><span class="sxs-lookup"><span data-stu-id="76e7b-144">If you are still using DNX for .NET Core development, your migration process should be done in two stages:</span></span>

1. <span data-ttu-id="76e7b-145">Use as [diretrizes de migração existentes do DNX](from-dnx.md) para migrar do DNX para a CLI habilitada para project-json.</span><span class="sxs-lookup"><span data-stu-id="76e7b-145">Use the [existing DNX migration guidance](from-dnx.md) to migrate from DNX to project-json enabled CLI.</span></span>
2. <span data-ttu-id="76e7b-146">Siga as etapas da seção anterior para migrar do *project.json* para o *.csproj*.</span><span class="sxs-lookup"><span data-stu-id="76e7b-146">Follow the steps from the previous section to migrate from *project.json* to *.csproj*.</span></span>  

> [!NOTE]
> <span data-ttu-id="76e7b-147">O DNX foi preterido oficialmente durante a versão Visualização 1 da CLI do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="76e7b-147">DNX has become officially deprecated during the Preview 1 release of the .NET Core CLI.</span></span> 

## <a name="migration-from-earlier-net-core-csproj-formats-to-rtm-csproj"></a><span data-ttu-id="76e7b-148">Migração de formatos csproj anteriores do .NET Core para o csproj do RTM</span><span class="sxs-lookup"><span data-stu-id="76e7b-148">Migration from earlier .NET Core csproj formats to RTM csproj</span></span>
<span data-ttu-id="76e7b-149">O formato csproj do .NET Core foi mudando e evoluindo com cada nova versão de pré-lançamento da ferramenta.</span><span class="sxs-lookup"><span data-stu-id="76e7b-149">The .NET Core csproj format has been changing and evolving with each new pre-release version of the tooling.</span></span> <span data-ttu-id="76e7b-150">Não há nenhuma ferramenta que migrará seu arquivo de projeto de versões anteriores do csproj para a versão mais recente. Sendo assim, você precisa editar manualmente o arquivo de projeto.</span><span class="sxs-lookup"><span data-stu-id="76e7b-150">There is no tool that will migrate your project file from earlier versions of csproj to the latest, so you need to manually edit the project file.</span></span> <span data-ttu-id="76e7b-151">As etapas reais dependem da versão do arquivo de projeto que você está migrando.</span><span class="sxs-lookup"><span data-stu-id="76e7b-151">The actual steps depend on the version of the project file you are migrating.</span></span> <span data-ttu-id="76e7b-152">A seguir, há algumas diretrizes para serem consideradas com base nas alterações que ocorreram entre as versões:</span><span class="sxs-lookup"><span data-stu-id="76e7b-152">The following is some guidance to consider based on the changes that happened between versions:</span></span>

* <span data-ttu-id="76e7b-153">Remova a propriedade de versão das ferramentas do elemento `<Project>`, se ele existir.</span><span class="sxs-lookup"><span data-stu-id="76e7b-153">Remove the tools version property from the `<Project>` element, if it exists.</span></span> 
* <span data-ttu-id="76e7b-154">Remova o namespace de XML (`xmlns`) do elemento `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="76e7b-154">Remove the XML namespace (`xmlns`) from the `<Project>` element.</span></span>
* <span data-ttu-id="76e7b-155">Se ele não existir, adicione o atributo `Sdk` ao elemento `<Project>` e defina-o como `Microsoft.NET.Sdk` ou `Microsoft.NET.Sdk.Web`.</span><span class="sxs-lookup"><span data-stu-id="76e7b-155">If it doesn't exist, add the `Sdk` attribute to the `<Project>` element and set it to `Microsoft.NET.Sdk` or `Microsoft.NET.Sdk.Web`.</span></span> <span data-ttu-id="76e7b-156">Esse atributo especifica que o projeto usa o SDK que será utilizado.</span><span class="sxs-lookup"><span data-stu-id="76e7b-156">This attribute specifies that the project uses the SDK to be used.</span></span> <span data-ttu-id="76e7b-157">`Microsoft.NET.Sdk.Web` é usado em aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="76e7b-157">`Microsoft.NET.Sdk.Web` is used for web apps.</span></span>
* <span data-ttu-id="76e7b-158">Remova as instruções `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` e `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` da parte superior e inferior do projeto.</span><span class="sxs-lookup"><span data-stu-id="76e7b-158">Remove the `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` and `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` statements from the top and bottom of the project.</span></span> <span data-ttu-id="76e7b-159">Essas instruções estão implícitas no SDK. Portanto, não é necessário que elas estejam no projeto.</span><span class="sxs-lookup"><span data-stu-id="76e7b-159">These import statements are implied by the SDK, so there is no need for them to be in the project.</span></span> 
* <span data-ttu-id="76e7b-160">Se os itens `Microsoft.NETCore.App` ou `NETStandard.Library` `<PackageReference>` estiverem em seu projeto, você deverá removê-los.</span><span class="sxs-lookup"><span data-stu-id="76e7b-160">If you have `Microsoft.NETCore.App` or `NETStandard.Library` `<PackageReference>` items in your project, you should remove them.</span></span> <span data-ttu-id="76e7b-161">Essas referências do pacote estão [implícitas no SDK](https://aka.ms/sdkimplicitrefs).</span><span class="sxs-lookup"><span data-stu-id="76e7b-161">These package references are [implied by the SDK](https://aka.ms/sdkimplicitrefs).</span></span> 
* <span data-ttu-id="76e7b-162">Remova o elemento `Microsoft.NET.Sdk` `<PackageReference>`, se ele existir.</span><span class="sxs-lookup"><span data-stu-id="76e7b-162">Remove the `Microsoft.NET.Sdk` `<PackageReference>` element, if it exists.</span></span> <span data-ttu-id="76e7b-163">A referência do SDK é fornecida por meio do atributo `Sdk` no elemento `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="76e7b-163">The SDK reference comes through the `Sdk` attribute on the `<Project>` element.</span></span> 
* <span data-ttu-id="76e7b-164">Remova os [globs](https://en.wikipedia.org/wiki/Glob_(programming)) que estão [implícitos no SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span><span class="sxs-lookup"><span data-stu-id="76e7b-164">Remove the [globs](https://en.wikipedia.org/wiki/Glob_(programming)) that are [implied by the SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span></span> <span data-ttu-id="76e7b-165">Deixar esses globs em seu projeto causará um erro no build, uma vez que os itens de compilação serão duplicados.</span><span class="sxs-lookup"><span data-stu-id="76e7b-165">Leaving these globs in your project will cause an error on build because compile items will be duplicated.</span></span> 

<span data-ttu-id="76e7b-166">Após essas etapas, seu projeto deverá estar totalmente compatível com o formato csproj do RTM .NET Core.</span><span class="sxs-lookup"><span data-stu-id="76e7b-166">After these steps your project should be fully compatible with the RTM .NET Core csproj format.</span></span> 

<span data-ttu-id="76e7b-167">Para obter exemplos de antes e depois da migração do formato csproj antigo para o novo, consulte o artigo [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://blogs.msdn.microsoft.com/dotnet/2016/12/12/updating-visual-studio-2017-rc-net-core-tooling-improvements/) (Atualizando o Visual Studio 2017 RC – melhorias na ferramenta .NET Core) no blog do .NET.</span><span class="sxs-lookup"><span data-stu-id="76e7b-167">For examples of before and after the migration from old csproj format to the new one, see the [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://blogs.msdn.microsoft.com/dotnet/2016/12/12/updating-visual-studio-2017-rc-net-core-tooling-improvements/) article on the .NET blog.</span></span>

## <a name="see-also"></a><span data-ttu-id="76e7b-168">Consulte também</span><span class="sxs-lookup"><span data-stu-id="76e7b-168">See also</span></span>
[<span data-ttu-id="76e7b-169">Portar, migrar e atualizar projetos do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="76e7b-169">Port, Migrate, and Upgrade Visual Studio Projects</span></span>](/visualstudio/porting/port-migrate-and-upgrade-visual-studio-projects)
