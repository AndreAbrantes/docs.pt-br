---
title: Trabalhando com nota nota notardo pelo macOS Catalina
description: Como lidar com problemas de autenticação e certificado com macOS quando você instala o tempo de execução do .NET Core, SDK e aplicativos construídos com o .NET Core.
author: thraka
ms.author: adegeo
ms.date: 02/14/2020
ms.openlocfilehash: be39c1ea56699f84736a2b37bc958507b16e826b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/14/2020
ms.locfileid: "79146743"
---
# <a name="macos-catalina-notarization-and-the-impact-on-net-core-downloads-and-projects"></a><span data-ttu-id="0943e-103">macOS Catalina Notarization e o impacto em downloads e projetos do .NET Core</span><span class="sxs-lookup"><span data-stu-id="0943e-103">macOS Catalina Notarization and the impact on .NET Core downloads and projects</span></span>

<span data-ttu-id="0943e-104">A partir do macOS Catalina (versão 10.15), todos os softwares construídos após 1º de junho de 2019, e distribuídos com o Developer ID, devem ser autenticados em cartório.</span><span class="sxs-lookup"><span data-stu-id="0943e-104">Beginning with macOS Catalina (version 10.15), all software built after June 1, 2019, and distributed with Developer ID, must be notarized.</span></span> <span data-ttu-id="0943e-105">Esse requisito se aplica ao tempo de execução do .NET Core, .NET Core SDK e software criado com o .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0943e-105">This requirement applies to the .NET Core runtime, .NET Core SDK, and software created with .NET Core.</span></span> <span data-ttu-id="0943e-106">Este artigo descreve os cenários comuns que você pode enfrentar com a autenticação de nota notsio.</span><span class="sxs-lookup"><span data-stu-id="0943e-106">This article describes the common scenarios you may face with .NET Core and macOS notarization.</span></span>

## <a name="installing-net-core"></a><span data-ttu-id="0943e-107">Instalando o .NET Core</span><span class="sxs-lookup"><span data-stu-id="0943e-107">Installing .NET Core</span></span>

<span data-ttu-id="0943e-108">Os instaladores das versões .NET Core (tempo de execução e SDK) 3.1, 3.0 e 2.1, foram reconhecidos em cartório desde 18 de fevereiro de 2020.</span><span class="sxs-lookup"><span data-stu-id="0943e-108">The installers for .NET Core (both runtime and SDK) versions 3.1, 3.0, and 2.1, have been notarized since February 18, 2020.</span></span> <span data-ttu-id="0943e-109">As versões lançadas anteriormente não são autenticadas em cartório.</span><span class="sxs-lookup"><span data-stu-id="0943e-109">Prior released versions aren't notarized.</span></span> <span data-ttu-id="0943e-110">Você pode instalar manualmente uma versão não autenticada do .NET Core baixando `sudo installer` primeiro o instalador e, em seguida, usando o comando.</span><span class="sxs-lookup"><span data-stu-id="0943e-110">You can manually install a non-notarized version of .NET Core by first downloading the installer, and then using the `sudo installer` command.</span></span> <span data-ttu-id="0943e-111">Para obter mais informações, consulte [Baixar e instalar manualmente para macOS](sdk.md?pivots=os-macos#download-and-manually-install).</span><span class="sxs-lookup"><span data-stu-id="0943e-111">For more information, see [Download and manually install for macOS](sdk.md?pivots=os-macos#download-and-manually-install).</span></span>

<span data-ttu-id="0943e-112">Começando com as seguintes versões, os instaladores .NET Core são autenticados em cartório:</span><span class="sxs-lookup"><span data-stu-id="0943e-112">Beginning with the following versions, the .NET Core installers are notarized:</span></span>

- <span data-ttu-id="0943e-113">Runtime do .NET Core</span><span class="sxs-lookup"><span data-stu-id="0943e-113">.NET Core Runtime</span></span>
  - <span data-ttu-id="0943e-114">2.1.16</span><span class="sxs-lookup"><span data-stu-id="0943e-114">2.1.16</span></span>
  - <span data-ttu-id="0943e-115">3.0.3</span><span class="sxs-lookup"><span data-stu-id="0943e-115">3.0.3</span></span>
  - <span data-ttu-id="0943e-116">3.1.2</span><span class="sxs-lookup"><span data-stu-id="0943e-116">3.1.2</span></span>

- <span data-ttu-id="0943e-117">SDK do .Net Core</span><span class="sxs-lookup"><span data-stu-id="0943e-117">.NET Core SDK</span></span>
  - <span data-ttu-id="0943e-118">2.1.512</span><span class="sxs-lookup"><span data-stu-id="0943e-118">2.1.512</span></span>
  - <span data-ttu-id="0943e-119">3.0.103</span><span class="sxs-lookup"><span data-stu-id="0943e-119">3.0.103</span></span>
  - <span data-ttu-id="0943e-120">3.1.102</span><span class="sxs-lookup"><span data-stu-id="0943e-120">3.1.102</span></span>

## <a name="apphost-is-disabled-by-default"></a><span data-ttu-id="0943e-121">appHost é desativado por padrão</span><span class="sxs-lookup"><span data-stu-id="0943e-121">appHost is disabled by default</span></span>

<span data-ttu-id="0943e-122">Por padrão, versões não autenticadas do .NET Core SDK 3.0 e acima produzem um executável Mach-O nativo (conhecido como **appHost)** quando seu projeto compila, publica ou é executado.</span><span class="sxs-lookup"><span data-stu-id="0943e-122">By default, non-notarized versions of the .NET Core SDK 3.0 and above produce a native Mach-O executable (known as the **appHost**) when your project compiles, publishes, or is run.</span></span> <span data-ttu-id="0943e-123">Este executável é uma maneira conveniente de executar o seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0943e-123">This executable is a convenient way to run your app.</span></span> <span data-ttu-id="0943e-124">Caso contrário, seu aplicativo deve `dotnet <filename.dll>`ser iniciado executando .</span><span class="sxs-lookup"><span data-stu-id="0943e-124">Otherwise, your app must be started by running `dotnet <filename.dll>`.</span></span> <span data-ttu-id="0943e-125">Quando o appHost está `dotnet run` ativado, o comando é invocado no contexto do appHost.</span><span class="sxs-lookup"><span data-stu-id="0943e-125">When the appHost is enabled, the `dotnet run` command is invoked in the context of the appHost.</span></span> <span data-ttu-id="0943e-126">Para obter mais informações, consulte [Contexto do aplicativoHost](#context-of-the-apphost).</span><span class="sxs-lookup"><span data-stu-id="0943e-126">For more information, see [Context of the appHost](#context-of-the-apphost).</span></span>

<span data-ttu-id="0943e-127">Começando com as versões autenticadas do .NET Core SDK 3.0 e acima, o aplicativoHost executável não é gerado por padrão.</span><span class="sxs-lookup"><span data-stu-id="0943e-127">Starting with the notarized versions of the .NET Core SDK 3.0 and above, the appHost executable isn't generated by default.</span></span> <span data-ttu-id="0943e-128">Você pode ativar a geração [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) appHost com a configuração booleana no arquivo do projeto.</span><span class="sxs-lookup"><span data-stu-id="0943e-128">You can turn on appHost generation with the [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) boolean setting in the project file.</span></span> <span data-ttu-id="0943e-129">Você também pode alternar o `-p:UseAppHost` aplicativoHost com o parâmetro `dotnet` na linha de comando para o comando específico executado:</span><span class="sxs-lookup"><span data-stu-id="0943e-129">You can also toggle the appHost with the `-p:UseAppHost` parameter on the command line for the specific `dotnet` command you run:</span></span>

- <span data-ttu-id="0943e-130">Arquivo de projeto</span><span class="sxs-lookup"><span data-stu-id="0943e-130">Project file</span></span>

  ```xml
  <PropertyGroup>
    <UseAppHost>true</UseAppHost>
  </PropertyGroup>
  ```

- <span data-ttu-id="0943e-131">Parâmetro de linha de comando</span><span class="sxs-lookup"><span data-stu-id="0943e-131">Command-line parameter</span></span>

  ```dotnetcli
  dotnet run -p:UseAppHost=true
  ```

<span data-ttu-id="0943e-132">Um aplicativoHost é sempre criado quando você publica seu aplicativo [independente](../deploying/index.md#publish-self-contained).</span><span class="sxs-lookup"><span data-stu-id="0943e-132">An appHost is always created when you publish your app [self-contained](../deploying/index.md#publish-self-contained).</span></span>

<span data-ttu-id="0943e-133">Para obter mais `UseAppHost` informações sobre a configuração, consulte [as propriedades MSBuild para Microsoft.NET.Sdk](../project-sdk/msbuild-props.md#useapphost).</span><span class="sxs-lookup"><span data-stu-id="0943e-133">For more information about the `UseAppHost` setting, see [MSBuild properties for Microsoft.NET.Sdk](../project-sdk/msbuild-props.md#useapphost).</span></span>

### <a name="context-of-the-apphost"></a><span data-ttu-id="0943e-134">Contexto do appHost</span><span class="sxs-lookup"><span data-stu-id="0943e-134">Context of the appHost</span></span>

<span data-ttu-id="0943e-135">Quando o appHost está ativado em seu `dotnet run` projeto e você usa o comando para executar seu aplicativo, o aplicativo é invocado `dotnet` no contexto do appHost e não no host padrão (o host padrão é o comando).</span><span class="sxs-lookup"><span data-stu-id="0943e-135">When the appHost is enabled in your project, and you use the `dotnet run` command to run your app, the app is invoked in the context of the appHost and not the default host (the default host is the `dotnet` command).</span></span> <span data-ttu-id="0943e-136">Se o aplicativoHost estiver desativado `dotnet run` em seu projeto, o comando será executado no contexto do host padrão.</span><span class="sxs-lookup"><span data-stu-id="0943e-136">If the appHost is disabled in your project, the `dotnet run` command runs your app in the context of the default host.</span></span> <span data-ttu-id="0943e-137">Mesmo que o aplicativoHost esteja desativado, publicar seu aplicativo como autônomo gera um aplicativoExecutável host, e os usuários usam esse executável para executar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0943e-137">Even if the appHost is disabled, publishing your app as self-contained generates an appHost executable, and users use that executable to run your app.</span></span> <span data-ttu-id="0943e-138">Executar seu `dotnet <filename.dll>` aplicativo com invoca o aplicativo com o host padrão, o tempo de execução compartilhado.</span><span class="sxs-lookup"><span data-stu-id="0943e-138">Running your app with `dotnet <filename.dll>` invokes the app with the default host, the shared runtime.</span></span>

<span data-ttu-id="0943e-139">Quando um aplicativo usando o aplicativoHost é invocado, a partição de certificado acessada pelo aplicativo é diferente do host padrão autenticado em cartório.</span><span class="sxs-lookup"><span data-stu-id="0943e-139">When an app using the appHost is invoked, the certificate partition accessed by the app is different from the notarized default host.</span></span> <span data-ttu-id="0943e-140">Se o aplicativo tiver que acessar os certificados `dotnet run` instalados através do host padrão, use `dotnet <filename.dll>` o comando para executar seu aplicativo a partir de seu arquivo de projeto ou use o comando para iniciar o aplicativo diretamente.</span><span class="sxs-lookup"><span data-stu-id="0943e-140">If your app must access the certificates installed through the default host, use the `dotnet run` command to run your app from its project file, or use the `dotnet <filename.dll>` command to start the app directly.</span></span>

<span data-ttu-id="0943e-141">Mais informações sobre esse cenário são fornecidas na seção [ASP.NET Core e macOS e certificados.](#aspnet-core-and-macos-and-certificates)</span><span class="sxs-lookup"><span data-stu-id="0943e-141">More information about this scenario is provided in the [ASP.NET Core and macOS and certificates](#aspnet-core-and-macos-and-certificates) section.</span></span>

## <a name="aspnet-core-and-macos-and-certificates"></a><span data-ttu-id="0943e-142">ASP.NET Core e macOS e certificados</span><span class="sxs-lookup"><span data-stu-id="0943e-142">ASP.NET Core and macOS and certificates</span></span>

<span data-ttu-id="0943e-143">O .NET Core oferece a capacidade de gerenciar certificados no chaveiro macOS com a <xref:System.Security.Cryptography.X509Certificates> classe.</span><span class="sxs-lookup"><span data-stu-id="0943e-143">.NET Core provides the ability to manage certificates in the macOS Keychain with the <xref:System.Security.Cryptography.X509Certificates> class.</span></span> <span data-ttu-id="0943e-144">O acesso ao chaveiro macOS usa a identidade dos aplicativos como chave principal ao decidir qual partição considerar.</span><span class="sxs-lookup"><span data-stu-id="0943e-144">Access to the macOS Keychain uses the applications identity as the primary key when deciding which partition to consider.</span></span> <span data-ttu-id="0943e-145">Por exemplo, aplicativos não assinados armazenam segredos na partição não assinada, mas aplicativos assinados armazenam seus segredos em partições que só eles podem acessar.</span><span class="sxs-lookup"><span data-stu-id="0943e-145">For example, unsigned applications store secrets in the unsigned partition, but signed applications store their secrets in partitions only they can access.</span></span> <span data-ttu-id="0943e-146">A fonte de execução que invoca seu aplicativo decide qual partição usar.</span><span class="sxs-lookup"><span data-stu-id="0943e-146">The source of execution that invokes your app decides which partition to use.</span></span>

<span data-ttu-id="0943e-147">O .NET Core fornece três fontes de execução: [appHost,](#apphost-is-disabled-by-default)host padrão (o `dotnet` comando) e um host personalizado.</span><span class="sxs-lookup"><span data-stu-id="0943e-147">.NET Core provides three sources of execution: [appHost](#apphost-is-disabled-by-default), default host (the `dotnet` command), and a custom host.</span></span> <span data-ttu-id="0943e-148">Cada modelo de execução pode ter identidades diferentes, assinadas ou não, e tem acesso a diferentes partições dentro do Chaveiro.</span><span class="sxs-lookup"><span data-stu-id="0943e-148">Each execution model may have different identities, either signed or unsigned, and has access to different partitions within the Keychain.</span></span> <span data-ttu-id="0943e-149">Os certificados importados por um modo podem não estar acessíveis de outro.</span><span class="sxs-lookup"><span data-stu-id="0943e-149">Certificates imported by one mode may not be accessible from another.</span></span> <span data-ttu-id="0943e-150">Por exemplo, as versões autenticadas em cartório do .NET Core têm um host padrão que é assinado.</span><span class="sxs-lookup"><span data-stu-id="0943e-150">For example, the notarized versions of .NET Core have a default host that is signed.</span></span> <span data-ttu-id="0943e-151">Os certificados são importados para uma partição segura com base em sua identidade.</span><span class="sxs-lookup"><span data-stu-id="0943e-151">Certificates are imported into a secure partition based on its identity.</span></span> <span data-ttu-id="0943e-152">Esses certificados não estão acessíveis a partir de um aplicativo geradoHost, pois o aplicativoHost não está assinado.</span><span class="sxs-lookup"><span data-stu-id="0943e-152">These certificates aren't accessible from a generated appHost, as the appHost is unsigned.</span></span>

<span data-ttu-id="0943e-153">Outro exemplo, por padrão, ASP.NET O Core importa um certificado SSL padrão através do host padrão.</span><span class="sxs-lookup"><span data-stu-id="0943e-153">Another example, by default, ASP.NET Core imports a default SSL certificate through the default host.</span></span> <span data-ttu-id="0943e-154">ASP.NET Os aplicativos Core que usam um aplicativoHost não terão acesso a este certificado e receberão um erro quando o .NET Core detectar que o certificado não está acessível.</span><span class="sxs-lookup"><span data-stu-id="0943e-154">ASP.NET Core applications that use an appHost won't have access to this certificate and will receive an error when .NET Core detects the certificate isn't accessible.</span></span> <span data-ttu-id="0943e-155">A mensagem de erro fornece instruções sobre como corrigir este problema.</span><span class="sxs-lookup"><span data-stu-id="0943e-155">The error message provides instructions on how to fix this problem.</span></span>

<span data-ttu-id="0943e-156">Se o compartilhamento de certificadofor necessário, `security` o macOS fornecerá opções de configuração com o utilitário.</span><span class="sxs-lookup"><span data-stu-id="0943e-156">If certificate sharing is required, macOS provides configuration options with the `security` utility.</span></span>

<span data-ttu-id="0943e-157">Para obter mais informações sobre como solucionar problemas ASP.NET problemas de certificado Core, consulte [Impor HTTPS no ASP.NET Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span><span class="sxs-lookup"><span data-stu-id="0943e-157">For more information on how to troubleshoot ASP.NET Core certificate issues, see [Enforce HTTPS in ASP.NET Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span></span>

## <a name="default-entitlements"></a><span data-ttu-id="0943e-158">Direitos padrão</span><span class="sxs-lookup"><span data-stu-id="0943e-158">Default entitlements</span></span>

<span data-ttu-id="0943e-159">O host padrão do .NET Core (o `dotnet` comando) tem um conjunto de direitos padrão.</span><span class="sxs-lookup"><span data-stu-id="0943e-159">.NET Core’s default host (the `dotnet` command) has a set of default entitlements.</span></span> <span data-ttu-id="0943e-160">Esses direitos são necessários para o bom funcionamento do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0943e-160">These entitlements are required for proper operation of .NET Core.</span></span> <span data-ttu-id="0943e-161">É possível que sua aplicação precise de direitos adicionais, nesse caso você precisará gerar e usar um [appHost](#apphost-is-disabled-by-default) e, em seguida, adicionar os direitos necessários localmente.</span><span class="sxs-lookup"><span data-stu-id="0943e-161">It's possible that your application may need additional entitlements, in which case you'll need to generate and use an [appHost](#apphost-is-disabled-by-default) and then add the necessary entitlements locally.</span></span>

<span data-ttu-id="0943e-162">Conjunto padrão de direitos para .NET Core:</span><span class="sxs-lookup"><span data-stu-id="0943e-162">Default set of entitlements for .NET Core:</span></span>

- `com.apple.security.cs.allow-jit`
- `com.apple.security.cs.allow-unsigned-executable-memory`
- `com.apple.security.cs.allow-dyld-environment-variables`
- `com.apple.security.cs.disable-library-validation`

## <a name="notarize-a-net-core-app"></a><span data-ttu-id="0943e-163">Nota notar um aplicativo .NET Core</span><span class="sxs-lookup"><span data-stu-id="0943e-163">Notarize a .NET Core app</span></span>

<span data-ttu-id="0943e-164">Se você quiser que seu aplicativo seja executado no macOS Catalina (versão 10.15) ou superior, você vai querer autenticar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0943e-164">If you want your application to run on macOS Catalina (version 10.15) or higher, you'll want to notarize your app.</span></span> <span data-ttu-id="0943e-165">O aplicativoHost que você envia com seu pedido de autenticação de cartório deve ser usado com pelo menos os [mesmos direitos padrão](#default-entitlements) do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0943e-165">The appHost you submit with your application for notarization should be used with at least the same [default entitlements](#default-entitlements) for .NET Core.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0943e-166">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="0943e-166">Next steps</span></span>

- <span data-ttu-id="0943e-167">[.NET Core dependências e requisitos](dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="0943e-167">[.NET Core dependencies and requirements](dependencies.md).</span></span>
- <span data-ttu-id="0943e-168">[Instale o .NET Core SDK](sdk.md).</span><span class="sxs-lookup"><span data-stu-id="0943e-168">[Install the .NET Core SDK](sdk.md).</span></span>
- [<span data-ttu-id="0943e-169">Instale o tempo de execução do .NET Core</span><span class="sxs-lookup"><span data-stu-id="0943e-169">Install the .NET Core Runtime</span></span>](runtime.md)
