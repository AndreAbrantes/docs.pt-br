---
title: Entendendo o AssemblyLoadContext-.NET Core
description: Conceitos principais para entender a finalidade e o comportamento do AssemblyLoadContext no .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 8a73a432bf8cc72cced77cf6c62a785b72032913
ms.sourcegitcommit: 9c3a4f2d3babca8919a1e490a159c1500ba7a844
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/12/2019
ms.locfileid: "72291256"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="d75e8-103">Compreendendo System. Runtime. Loader. AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="d75e8-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="d75e8-104">A classe <xref:System.Runtime.Loader.AssemblyLoadContext> é exclusiva do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="d75e8-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="d75e8-105">Este artigo tenta complementar a documentação da API <xref:System.Runtime.Loader.AssemblyLoadContext> com informações conceituais.</span><span class="sxs-lookup"><span data-stu-id="d75e8-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="d75e8-106">Este artigo é relevante para os desenvolvedores que implementam o carregamento dinâmico, especialmente os desenvolvedores de estrutura de carregamento dinâmico.</span><span class="sxs-lookup"><span data-stu-id="d75e8-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="d75e8-107">O que é o AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="d75e8-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="d75e8-108">Cada aplicativo .NET Core usa implicitamente o <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="d75e8-109">É o provedor do tempo de execução para localizar e carregar dependências.</span><span class="sxs-lookup"><span data-stu-id="d75e8-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="d75e8-110">Sempre que uma dependência é carregada, uma instância <xref:System.Runtime.Loader.AssemblyLoadContext> é chamada para localizá-la.</span><span class="sxs-lookup"><span data-stu-id="d75e8-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="d75e8-111">Ele fornece um serviço de localizar, carregar e armazenar em cache assemblies gerenciados e outras dependências.</span><span class="sxs-lookup"><span data-stu-id="d75e8-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="d75e8-112">Para dar suporte ao carregamento e descarregamento de código dinâmico, ele cria um contexto isolado para carregar o código e suas dependências em sua própria instância <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="d75e8-113">Quando você precisa de várias instâncias de AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="d75e8-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="d75e8-114">Uma única instância <xref:System.Runtime.Loader.AssemblyLoadContext> é limitada a carregar exatamente uma versão de um <xref:System.Reflection.Assembly> por nome de assembly simples, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="d75e8-115">Essa restrição pode se tornar um problema ao carregar módulos de código dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="d75e8-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="d75e8-116">Cada módulo é compilado de forma independente e pode depender de versões diferentes de um <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="d75e8-117">Esse problema geralmente ocorre quando diferentes módulos dependem de versões diferentes de uma biblioteca comumente usada.</span><span class="sxs-lookup"><span data-stu-id="d75e8-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="d75e8-118">Para dar suporte ao carregamento dinâmico de código, a API <xref:System.Runtime.Loader.AssemblyLoadContext> fornece o carregamento de versões conflitantes de um <xref:System.Reflection.Assembly> no mesmo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d75e8-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="d75e8-119">Cada instância <xref:System.Runtime.Loader.AssemblyLoadContext> fornece um mapeamento de dicionário exclusivo de cada <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> para uma instância <xref:System.Reflection.Assembly> específica.</span><span class="sxs-lookup"><span data-stu-id="d75e8-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="d75e8-120">Ele também fornece um mecanismo conveniente para agrupar dependências relacionadas a um módulo de código para descarregamento posterior.</span><span class="sxs-lookup"><span data-stu-id="d75e8-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="d75e8-121">O que é especial sobre a instância AssemblyLoadContext. Default?</span><span class="sxs-lookup"><span data-stu-id="d75e8-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="d75e8-122">A instância <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> é preenchida automaticamente pelo tempo de execução na inicialização.</span><span class="sxs-lookup"><span data-stu-id="d75e8-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="d75e8-123">Ele usa a [investigação padrão](default-probing.md) para localizar e localizar todas as dependências estáticas.</span><span class="sxs-lookup"><span data-stu-id="d75e8-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="d75e8-124">Ele resolve os cenários de carregamento de dependência mais comuns.</span><span class="sxs-lookup"><span data-stu-id="d75e8-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="d75e8-125">Como o AssemblyLoadContext dá suporte a dependências dinâmicas?</span><span class="sxs-lookup"><span data-stu-id="d75e8-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="d75e8-126"><xref:System.Runtime.Loader.AssemblyLoadContext> tem vários eventos e funções virtuais que podem ser substituídos.</span><span class="sxs-lookup"><span data-stu-id="d75e8-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="d75e8-127">A instância <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> dá suporte apenas à substituição dos eventos.</span><span class="sxs-lookup"><span data-stu-id="d75e8-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="d75e8-128">Os artigos [algoritmos de carregamento de assembly gerenciado](loading-managed.md), [algoritmo de carregamento de assembly satélite](loading-resources.md)e [algoritmo de carregamento de biblioteca não gerenciada (nativa)](loading-unmanaged.md) referem-se a todos os eventos e funções virtuais disponíveis.</span><span class="sxs-lookup"><span data-stu-id="d75e8-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="d75e8-129">Os artigos mostram cada evento e a posição relativa da função nos algoritmos de carregamento.</span><span class="sxs-lookup"><span data-stu-id="d75e8-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="d75e8-130">Este artigo não reproduz essas informações.</span><span class="sxs-lookup"><span data-stu-id="d75e8-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="d75e8-131">Esta seção aborda os princípios gerais para os eventos e funções relevantes.</span><span class="sxs-lookup"><span data-stu-id="d75e8-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="d75e8-132">**Ser repetível**.</span><span class="sxs-lookup"><span data-stu-id="d75e8-132">**Be repeatable**.</span></span> <span data-ttu-id="d75e8-133">Uma consulta para uma dependência específica sempre deve resultar na mesma resposta.</span><span class="sxs-lookup"><span data-stu-id="d75e8-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="d75e8-134">A mesma instância de dependência carregada deve ser retornada.</span><span class="sxs-lookup"><span data-stu-id="d75e8-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="d75e8-135">Esse requisito é fundamental para a consistência do cache.</span><span class="sxs-lookup"><span data-stu-id="d75e8-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="d75e8-136">Para assemblies gerenciados em particular, estamos criando um cache <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-136">For managed assemblies in particular, we're creating a <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="d75e8-137">A chave de cache é um nome de assembly simples, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="d75e8-138">**Normalmente não geram**.</span><span class="sxs-lookup"><span data-stu-id="d75e8-138">**Typically don't throw**.</span></span>  <span data-ttu-id="d75e8-139">Espera-se que essas funções retornem `null` em vez de throw quando não for possível localizar a dependência solicitada.</span><span class="sxs-lookup"><span data-stu-id="d75e8-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="d75e8-140">A geração encerrará prematuramente a pesquisa e será propagada uma exceção para o chamador.</span><span class="sxs-lookup"><span data-stu-id="d75e8-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="d75e8-141">O lançamento deve ser restrito a erros inesperados, como um assembly corrompido ou uma condição de memória insuficiente.</span><span class="sxs-lookup"><span data-stu-id="d75e8-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="d75e8-142">**Evite a recursão**.</span><span class="sxs-lookup"><span data-stu-id="d75e8-142">**Avoid recursion**.</span></span> <span data-ttu-id="d75e8-143">Lembre-se de que essas funções e manipuladores implementam as regras de carregamento para localizar dependências.</span><span class="sxs-lookup"><span data-stu-id="d75e8-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="d75e8-144">Sua implementação não deve chamar APIs que disparam a recursão.</span><span class="sxs-lookup"><span data-stu-id="d75e8-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="d75e8-145">Seu código normalmente deve chamar funções de carregamento **AssemblyLoadContext** que exigem um caminho específico ou um argumento de referência de memória.</span><span class="sxs-lookup"><span data-stu-id="d75e8-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="d75e8-146">**Carregue no AssemblyLoadContext correto**.</span><span class="sxs-lookup"><span data-stu-id="d75e8-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="d75e8-147">A escolha de onde carregar dependências é específica do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d75e8-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="d75e8-148">A escolha é implementada por esses eventos e funções.</span><span class="sxs-lookup"><span data-stu-id="d75e8-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="d75e8-149">Quando seu código chama o **AssemblyLoadContext** , as funções carregadas por caminho as chamam na instância em que você deseja que o código seja carregado.</span><span class="sxs-lookup"><span data-stu-id="d75e8-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="d75e8-150">Ao retornar `null` e deixar o identificador de <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> a carga pode ser a opção mais simples.</span><span class="sxs-lookup"><span data-stu-id="d75e8-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="d75e8-151">**Lembre-se de corridas de thread**.</span><span class="sxs-lookup"><span data-stu-id="d75e8-151">**Be aware of thread races**.</span></span> <span data-ttu-id="d75e8-152">O carregamento pode ser disparado por vários threads.</span><span class="sxs-lookup"><span data-stu-id="d75e8-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="d75e8-153">O AssemblyLoadContext lida com corridas de thread por meio da adição atômica de assemblies ao seu cache.</span><span class="sxs-lookup"><span data-stu-id="d75e8-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="d75e8-154">A instância do perdedor da corrida é descartada.</span><span class="sxs-lookup"><span data-stu-id="d75e8-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="d75e8-155">Na lógica de implementação, não adicione uma lógica extra que não manipule vários threads corretamente.</span><span class="sxs-lookup"><span data-stu-id="d75e8-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="d75e8-156">Como as dependências dinâmicas são isoladas?</span><span class="sxs-lookup"><span data-stu-id="d75e8-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="d75e8-157">Cada instância <xref:System.Runtime.Loader.AssemblyLoadContext> representa um escopo exclusivo para as definições <xref:System.Reflection.Assembly> e <xref:System.Type>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="d75e8-158">Não há nenhum isolamento binário entre essas dependências.</span><span class="sxs-lookup"><span data-stu-id="d75e8-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="d75e8-159">Eles são isolados apenas por não encontrar um ao outro por nome.</span><span class="sxs-lookup"><span data-stu-id="d75e8-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="d75e8-160">Em cada <xref:System.Runtime.Loader.AssemblyLoadContext>:</span><span class="sxs-lookup"><span data-stu-id="d75e8-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="d75e8-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> pode se referir a uma instância diferente de <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="d75e8-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> pode retornar uma instância de tipo diferente para o mesmo tipo `name`.</span><span class="sxs-lookup"><span data-stu-id="d75e8-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="d75e8-163">Como as dependências são compartilhadas?</span><span class="sxs-lookup"><span data-stu-id="d75e8-163">How are dependencies shared?</span></span>

<span data-ttu-id="d75e8-164">As dependências podem ser facilmente compartilhadas entre instâncias <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="d75e8-165">O modelo geral é para um <xref:System.Runtime.Loader.AssemblyLoadContext> para carregar uma dependência.</span><span class="sxs-lookup"><span data-stu-id="d75e8-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="d75e8-166">O outro compartilha a dependência usando uma referência ao assembly carregado.</span><span class="sxs-lookup"><span data-stu-id="d75e8-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="d75e8-167">Esse compartilhamento é necessário para os assemblies de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="d75e8-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="d75e8-168">Esses assemblies só podem ser carregados no <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="d75e8-169">O mesmo é necessário para estruturas como `ASP.NET`, `WPF` ou `WinForms`.</span><span class="sxs-lookup"><span data-stu-id="d75e8-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="d75e8-170">É recomendável que as dependências compartilhadas sejam carregadas em <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="d75e8-171">Esse compartilhamento é o padrão de design comum.</span><span class="sxs-lookup"><span data-stu-id="d75e8-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="d75e8-172">O compartilhamento é implementado na codificação da instância personalizada <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="d75e8-173"><xref:System.Runtime.Loader.AssemblyLoadContext> tem vários eventos e funções virtuais que podem ser substituídos.</span><span class="sxs-lookup"><span data-stu-id="d75e8-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="d75e8-174">Quando qualquer uma dessas funções retorna uma referência a uma instância <xref:System.Reflection.Assembly> que foi carregada em outra instância <xref:System.Runtime.Loader.AssemblyLoadContext>, a instância <xref:System.Reflection.Assembly> é compartilhada.</span><span class="sxs-lookup"><span data-stu-id="d75e8-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="d75e8-175">O algoritmo de carga padrão é adiado para <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> para carregar a fim de simplificar o padrão de compartilhamento comum.</span><span class="sxs-lookup"><span data-stu-id="d75e8-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="d75e8-176">Consulte [algoritmo de carregamento de assembly gerenciado](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="d75e8-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="d75e8-177">Complicações</span><span class="sxs-lookup"><span data-stu-id="d75e8-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="d75e8-178">Problemas de conversão de tipo</span><span class="sxs-lookup"><span data-stu-id="d75e8-178">Type conversion issues</span></span>

<span data-ttu-id="d75e8-179">Quando duas instâncias <xref:System.Runtime.Loader.AssemblyLoadContext> contêm definições de tipo com o mesmo `name`, elas não são do mesmo tipo.</span><span class="sxs-lookup"><span data-stu-id="d75e8-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="d75e8-180">Eles serão do mesmo tipo se forem provenientes da mesma instância <xref:System.Reflection.Assembly>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="d75e8-181">Para complicar as coisas, as mensagens de exceção sobre esses tipos incompatíveis podem ser confusas.</span><span class="sxs-lookup"><span data-stu-id="d75e8-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="d75e8-182">Os tipos são referenciados nas mensagens de exceção por seus nomes de tipo simples.</span><span class="sxs-lookup"><span data-stu-id="d75e8-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="d75e8-183">A mensagem de exceção comum, neste caso, seria a forma:</span><span class="sxs-lookup"><span data-stu-id="d75e8-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="d75e8-184">O objeto do tipo ' Isolatype ' não pode ser convertido para o tipo ' Isolatype '.</span><span class="sxs-lookup"><span data-stu-id="d75e8-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="d75e8-185">Problemas de conversão de tipo de depuração</span><span class="sxs-lookup"><span data-stu-id="d75e8-185">Debugging type conversion issues</span></span>

<span data-ttu-id="d75e8-186">Dado um par de tipos incompatíveis, é importante também saber:</span><span class="sxs-lookup"><span data-stu-id="d75e8-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="d75e8-187">@No__t-0 de cada tipo</span><span class="sxs-lookup"><span data-stu-id="d75e8-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="d75e8-188">O <xref:System.Runtime.Loader.AssemblyLoadContext> de cada tipo, que pode ser obtido por meio da função <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d75e8-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="d75e8-189">Dado dois objetos `a` e `b`, a avaliação do seguinte no depurador será útil:</span><span class="sxs-lookup"><span data-stu-id="d75e8-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="d75e8-190">Resolvendo problemas de conversão de tipo</span><span class="sxs-lookup"><span data-stu-id="d75e8-190">Resolving type conversion issues</span></span>

<span data-ttu-id="d75e8-191">Há dois padrões de design para resolver esses problemas de conversão de tipo.</span><span class="sxs-lookup"><span data-stu-id="d75e8-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="d75e8-192">Use tipos compartilhados comuns.</span><span class="sxs-lookup"><span data-stu-id="d75e8-192">Use common shared types.</span></span> <span data-ttu-id="d75e8-193">Esse tipo compartilhado pode ser um tipo de tempo de execução primitivo ou pode envolver a criação de um novo tipo compartilhado em um assembly compartilhado.</span><span class="sxs-lookup"><span data-stu-id="d75e8-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="d75e8-194">Geralmente, o tipo compartilhado é uma [interface](../../csharp/language-reference/keywords/interface.md) definida em um assembly de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d75e8-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="d75e8-195">Confira também:  [Como as dependências são compartilhadas?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="d75e8-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="d75e8-196">Use técnicas de marshaling para converter de um tipo para outro.</span><span class="sxs-lookup"><span data-stu-id="d75e8-196">Use marshaling techniques to convert from one type to another.</span></span>
