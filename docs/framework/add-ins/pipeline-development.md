---
title: Desenvolvimento de pipelines
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 2d889b7de4bc766deda9b91877ceefb4aebfc551
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/03/2018
---
# <a name="pipeline-development"></a><span data-ttu-id="3c3fa-102">Desenvolvimento de pipelines</span><span class="sxs-lookup"><span data-stu-id="3c3fa-102">Pipeline Development</span></span>
<span data-ttu-id="3c3fa-103">O pipeline de suplemento é o caminho de segmentos de pipeline que o aplicativo de host e o suplemento devem usar para se comunicar entre si.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="3c3fa-104">A ilustração a seguir mostra o canal de comunicação e seus segmentos.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="3c3fa-105">![Adicionar&#45;no modelo de pipeline. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="3c3fa-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="3c3fa-106">Pipeline de suplemento</span><span class="sxs-lookup"><span data-stu-id="3c3fa-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="3c3fa-107">O aplicativo host é um final do pipeline e o suplemento está na outra extremidade.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="3c3fa-108">A partir de cada extremidade e movendo no meio, o aplicativo de host e o suplemento tem uma classe base abstrata que define uma exibição do modelo de objeto que ambos compartilham.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="3c3fa-109">Esses tipos (classes) compõem o segmento de pipeline de suplemento do modo de exibição e o modo de host do segmento de pipeline de suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="3c3fa-110">O segmento de pipeline de suplemento exibição geralmente contém mais de uma classe abstrata, mas a classe que o suplemento herda é conhecida como a base de suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="3c3fa-111">O segmento de pipeline do adaptador do lado do suplemento e a converter de segmento de pipeline do adaptador do host o fluxo de tipos entre seus segmentos de pipeline de exibição e o segmento de pipeline do contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="3c3fa-112">O segmento central do pipeline é um contrato que é derivado de <xref:System.AddIn.Contract.IContract> interface.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="3c3fa-113">Esse contrato define os métodos que o aplicativo de host e o suplemento irá usar.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="3c3fa-114">Se você carregar o host e o suplemento em domínios de aplicativo separados, você tem um limite de isolamento que separa o escopo do aplicativo host do escopo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="3c3fa-115">O contrato é o assembly só que é carregado no host e domínios de aplicativo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="3c3fa-116">O host e o suplemento cada referem-se apenas à sua exibição dos métodos de contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="3c3fa-117">Portanto, eles serão separados por uma camada de abstração do contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="3c3fa-118">Para desenvolver os segmentos de pipeline, você deve criar uma estrutura de diretório que conterá a eles.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="3c3fa-119">Para obter mais informações sobre os requisitos de desenvolvimento e diretrizes de escopo, consulte [requisitos de desenvolvimento de Pipeline](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span><span class="sxs-lookup"><span data-stu-id="3c3fa-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="3c3fa-120">A ilustração a seguir mostra os tipos que compõem os segmentos de pipeline.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="3c3fa-121">Os nomes dos tipos mostrados na ilustração são arbitrários, mas todos os tipos, exceto para o host e o host de exibição dos atributos suplemento exigem para que possam ser descobertos por métodos que construir um armazenamento de informações.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="3c3fa-122">![Adicionar&#45;no modelo com atributos necessários em tipos. ] (../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="3c3fa-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="3c3fa-123">Pipeline de suplemento com tipos</span><span class="sxs-lookup"><span data-stu-id="3c3fa-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="3c3fa-124">A tabela a seguir descreve os segmentos de pipeline para ativar um suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="3c3fa-125">Para obter mais informações sobre esses segmentos, consulte [contratos, exibições e adaptadores](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span><span class="sxs-lookup"><span data-stu-id="3c3fa-125">For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="3c3fa-126">Segmento de pipeline</span><span class="sxs-lookup"><span data-stu-id="3c3fa-126">Pipeline segment</span></span>|<span data-ttu-id="3c3fa-127">Descrição</span><span class="sxs-lookup"><span data-stu-id="3c3fa-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="3c3fa-128">Host</span><span class="sxs-lookup"><span data-stu-id="3c3fa-128">Host</span></span>|<span data-ttu-id="3c3fa-129">O assembly de aplicativo que cria uma instância de um suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="3c3fa-130">Modo de host do suplemento</span><span class="sxs-lookup"><span data-stu-id="3c3fa-130">Host view of the add-in</span></span>|<span data-ttu-id="3c3fa-131">Representa a exibição do aplicativo host dos tipos de objetos e métodos usados para se comunicar com o suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="3c3fa-132">O modo de host é uma interface ou classe base abstrata.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="3c3fa-133">Adaptador do lado do host</span><span class="sxs-lookup"><span data-stu-id="3c3fa-133">Host-side adapter</span></span>|<span data-ttu-id="3c3fa-134">Um assembly com uma ou mais classes que se adapta a métodos de e para o contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="3c3fa-135">Este segmento de pipeline é identificado usando o <xref:System.AddIn.Pipeline.HostAdapterAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="3c3fa-136">Não há suporte para assemblies de vários módulos.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="3c3fa-137">Contrato</span><span class="sxs-lookup"><span data-stu-id="3c3fa-137">Contract</span></span>|<span data-ttu-id="3c3fa-138">Uma interface que é derivada de <xref:System.AddIn.Contract.IContract> interface e que define o protocolo de comunicação de tipos entre o host e o suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="3c3fa-139">Este segmento de pipeline é identificado, definindo o <xref:System.AddIn.Pipeline.AddInContractAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="3c3fa-140">Adicionar no lado adaptador</span><span class="sxs-lookup"><span data-stu-id="3c3fa-140">Add-in-side adapter</span></span>|<span data-ttu-id="3c3fa-141">Um assembly com uma ou mais classes que se adapta a métodos de e para o contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="3c3fa-142">Este segmento de pipeline é identificado usando o <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="3c3fa-143">Cada assembly no diretório do adaptador do lado do suplemento que contém um tipo que tem um <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atributo é carregado no domínio de aplicativo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="3c3fa-144">Cada assembly no diretório do lado do suplemento é carregado em seu próprio domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="3c3fa-145">Não há suporte para assemblies de vários módulos</span><span class="sxs-lookup"><span data-stu-id="3c3fa-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="3c3fa-146">Adicionar em modo de exibição</span><span class="sxs-lookup"><span data-stu-id="3c3fa-146">Add-in view</span></span>|<span data-ttu-id="3c3fa-147">Um assembly que representa a exibição do suplemento do tipos de objeto e os métodos que são usados para se comunicar com o host.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="3c3fa-148">O modo de exibição é uma interface ou classe base abstrata.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="3c3fa-149">Este segmento de pipeline é identificado usando o <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="3c3fa-150">Cada assembly na pasta AddInViews que contém um tipo que tem um <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo é carregado no domínio de aplicativo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="3c3fa-151">suplemento</span><span class="sxs-lookup"><span data-stu-id="3c3fa-151">Add-in</span></span>|<span data-ttu-id="3c3fa-152">Um tipo instanciado que executa um serviço para o host.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="3c3fa-153">Caminho de ativação de pipeline</span><span class="sxs-lookup"><span data-stu-id="3c3fa-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="3c3fa-154">A ilustração a seguir mostra a ativação de tipos, quando um suplemento é ativado.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="3c3fa-155">Ele também mostra a passagem de objetos para o host, como os resultados de um cálculo ou uma coleção de objetos.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="3c3fa-156">Este é o cenário mais comum.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="3c3fa-157">![Adicionar&#45;no modelo com caminho de ativação. ] (../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="3c3fa-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="3c3fa-158">Caminho de ativação de suplemento para o host</span><span class="sxs-lookup"><span data-stu-id="3c3fa-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="3c3fa-159">O caminho de ativação do pipeline ocorre da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="3c3fa-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="3c3fa-160">O aplicativo de host ativa o suplemento com o <xref:System.AddIn.Hosting.AddInToken.Activate%2A> método.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="3c3fa-161">O modo de exibição do suplemento, add-in, adaptador do lado do suplemento e os assemblies de contrato são carregados no domínio de aplicativo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="3c3fa-162">Uma instância do adaptador do lado do suplemento é criada usando o modo de exibição (com a classe identificada pelo <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo) como seu construtor.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="3c3fa-163">O adaptador do lado do suplemento herda do contrato.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="3c3fa-164">O adaptador do lado do suplemento, que é digitado como o contrato, é passado através dos limites de isolamento (opcional) para o construtor do adaptador do host.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="3c3fa-165">O modo de host do adaptador de suplemento, do lado do host e os assemblies de contrato são carregados no domínio do aplicativo do host.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="3c3fa-166">Uma instância do adaptador do host é criada usando o contrato como seu construtor.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="3c3fa-167">O adaptador do lado do host herda o modo de host do suplemento.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="3c3fa-168">O host tem o suplemento, que é digitado como o host de exibição do suplemento e pode continuar a chamar seus métodos.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="3c3fa-169">Passo a passo</span><span class="sxs-lookup"><span data-stu-id="3c3fa-169">Walkthroughs</span></span>  
 <span data-ttu-id="3c3fa-170">Há três tópicos de instruções passo a passo que descrevem como criar pipelines usando o Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="3c3fa-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="3c3fa-171">Passo a passo: criando um aplicativo extensível</span><span class="sxs-lookup"><span data-stu-id="3c3fa-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="3c3fa-172">Descreve um suplemento de cálculo que executa a adição, subtração, multiplicação e cálculos de divisão para o host.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.</span></span>  
  
-   [<span data-ttu-id="3c3fa-173">Passo a passo: Habilitando a compatibilidade com versões anteriores, como as alterações de Host</span><span class="sxs-lookup"><span data-stu-id="3c3fa-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="3c3fa-174">Descreve um suplemento de calculadora com recursos aprimorados de cálculo e como manter a compatibilidade com o suplemento de calculadora primeiro.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="3c3fa-175">Passo a passo: Passando coleções entre Hosts e suplementos</span><span class="sxs-lookup"><span data-stu-id="3c3fa-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="3c3fa-176">Descreve como passar conjuntos de dados pelo pipeline usando um cenário de armazenamento do catálogo.</span><span class="sxs-lookup"><span data-stu-id="3c3fa-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3c3fa-177">Consulte também</span><span class="sxs-lookup"><span data-stu-id="3c3fa-177">See Also</span></span>  
 [<span data-ttu-id="3c3fa-178">Cenários de Pipeline do suplemento</span><span class="sxs-lookup"><span data-stu-id="3c3fa-178">Add-in Pipeline Scenarios</span></span>](http://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [<span data-ttu-id="3c3fa-179">Suplementos e extensibilidade</span><span class="sxs-lookup"><span data-stu-id="3c3fa-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
