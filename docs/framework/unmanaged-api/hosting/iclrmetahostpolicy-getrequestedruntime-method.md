---
title: "Método ICLRMetaHostPolicy::GetRequestedRuntime"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: 
ms.topic: reference
api_name:
- ICLRMetaHostPolicy.GetRequestedRuntime
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- ICLRMetaHostPolicy::GetRequestedRuntime
helpviewer_keywords:
- GetRequestedRuntime method [.NET Framework hosting]
- ICLRMetaHostPolicy::GetRequestedRuntime method [.NET Framework hosting]
ms.assetid: 59ec1832-9cc1-4b5c-983d-03407e51de56
topic_type:
- apiref
caps.latest.revision: 
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 0501e104b2ed74656de125e668b7234efcbc9997
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/22/2017
---
# <a name="iclrmetahostpolicygetrequestedruntime-method"></a><span data-ttu-id="d214b-102">Método ICLRMetaHostPolicy::GetRequestedRuntime</span><span class="sxs-lookup"><span data-stu-id="d214b-102">ICLRMetaHostPolicy::GetRequestedRuntime Method</span></span>
<span data-ttu-id="d214b-103">Fornece uma interface para uma versão preferencial do common language runtime (CLR) com base em uma política de hospedagem, assembly gerenciado, cadeia de caracteres de versão e fluxo de configuração.</span><span class="sxs-lookup"><span data-stu-id="d214b-103">Provides an interface to a preferred version of the common language runtime (CLR) based on a hosting policy, managed assembly, version string, and configuration stream.</span></span> <span data-ttu-id="d214b-104">Esse método não carregar ou ativar o CLR, mas simplesmente retorna o [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface que representa o resultado da política.</span><span class="sxs-lookup"><span data-stu-id="d214b-104">This method does not actually load or activate the CLR, but simply returns the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that represents the policy result.</span></span> <span data-ttu-id="d214b-105">Esse método substitui o [GetRequestedRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md), [GetRequestedRuntimeVersion](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md), [CorBindToRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md), [CorBindToRuntimeByCfg](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md), e [GetCORRequiredVersion](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md) métodos.</span><span class="sxs-lookup"><span data-stu-id="d214b-105">This method supersedes the [GetRequestedRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeinfo-function.md), [GetRequestedRuntimeVersion](../../../../docs/framework/unmanaged-api/hosting/getrequestedruntimeversion-function.md), [CorBindToRuntimeHost](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimehost-function.md), [CorBindToRuntimeByCfg](../../../../docs/framework/unmanaged-api/hosting/corbindtoruntimebycfg-function.md), and [GetCORRequiredVersion](../../../../docs/framework/unmanaged-api/hosting/getcorrequiredversion-function.md) methods.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="d214b-106">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="d214b-106">Syntax</span></span>  
  
```  
HRESULT GetRequestedRuntime(  
    [in]  METAHOST_POLICY_FLAGS dwPolicyFlags,  
    [in]  LPCWSTR pwzBinary,  
    [in]  IStream *pCfgStream,  
    [in, out, size_is(*pcchVersion)] LPWSTR pwzVersion,  
    [in, out]  DWORD *pcchVersion,  
    [out, size_is(*pcchImageVersion)] LPWSTR pwzImageVersion,  
    [in, out]  DWORD *pcchImageVersion,  
    [out] DWORD *pdwConfigFlags,  
    [in]  REFIID  riid  
    [out, iid_is(riid), retval] LPVOID *ppRuntime);  
```  
  
#### <a name="parameters"></a><span data-ttu-id="d214b-107">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="d214b-107">Parameters</span></span>  
  
|<span data-ttu-id="d214b-108">Nome</span><span class="sxs-lookup"><span data-stu-id="d214b-108">Name</span></span>|<span data-ttu-id="d214b-109">Descrição</span><span class="sxs-lookup"><span data-stu-id="d214b-109">Description</span></span>|  
|----------|-----------------|  
|`dwPolicyFlags`|<span data-ttu-id="d214b-110">[in] Necessário.</span><span class="sxs-lookup"><span data-stu-id="d214b-110">[in] Required.</span></span> <span data-ttu-id="d214b-111">Especifica um membro do [METAHOST_POLICY_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md) enumeração, que representa uma política de vinculação e qualquer número de modificadores.</span><span class="sxs-lookup"><span data-stu-id="d214b-111">Specifies a member of the [METAHOST_POLICY_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md) enumeration, representing a binding policy, and any number of modifiers.</span></span> <span data-ttu-id="d214b-112">A única política que está disponível no momento é [METAHOST_POLICY_HIGHCOMPAT](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).</span><span class="sxs-lookup"><span data-stu-id="d214b-112">The only policy that is currently available is [METAHOST_POLICY_HIGHCOMPAT](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).</span></span><br /><br /> <span data-ttu-id="d214b-113">Modificadores de incluem [METAHOST_POLICY_EMULATE_EXE_LAUNCH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_APPLY_UPGRADE_POLICY](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_SHOW_ERROR_DIALOG](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_USE_PROCESS_IMAGE_PATH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), e [METAHOST_POLICY_ENSURE_SKU_SUPPORTED](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).</span><span class="sxs-lookup"><span data-stu-id="d214b-113">Modifiers include [METAHOST_POLICY_EMULATE_EXE_LAUNCH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_APPLY_UPGRADE_POLICY](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_SHOW_ERROR_DIALOG](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), [METAHOST_POLICY_USE_PROCESS_IMAGE_PATH](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md), and [METAHOST_POLICY_ENSURE_SKU_SUPPORTED](../../../../docs/framework/unmanaged-api/hosting/metahost-policy-flags-enumeration.md).</span></span>|  
|`pwzBinary`|<span data-ttu-id="d214b-114">[in] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-114">[in] Optional.</span></span> <span data-ttu-id="d214b-115">Especifica o caminho do arquivo de assembly.</span><span class="sxs-lookup"><span data-stu-id="d214b-115">Specifies the assembly file path.</span></span>|  
|`pCfgStream`|<span data-ttu-id="d214b-116">[in] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-116">[in] Optional.</span></span> <span data-ttu-id="d214b-117">Especifica o arquivo de configuração como um <xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d214b-117">Specifies the configuration file as a <xref:System.Runtime.InteropServices.ComTypes.IStream?displayProperty=nameWithType>.</span></span>|  
|`pwzVersion`|<span data-ttu-id="d214b-118">[out no] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-118">[in, out] Optional.</span></span> <span data-ttu-id="d214b-119">Especifica ou retorna a versão do CLR preferencial para ser carregado.</span><span class="sxs-lookup"><span data-stu-id="d214b-119">Specifies or returns the preferred CLR version to be loaded.</span></span>|  
|`pcchVersion`|<span data-ttu-id="d214b-120">[out no] Necessário.</span><span class="sxs-lookup"><span data-stu-id="d214b-120">[in, out] Required.</span></span> <span data-ttu-id="d214b-121">Especifica o tamanho esperado do `pwzVersion` como entrada, para evitar estouros de buffer.</span><span class="sxs-lookup"><span data-stu-id="d214b-121">Specifies the expected size of `pwzVersion` as input, to avoid buffer overruns.</span></span> <span data-ttu-id="d214b-122">Se `pwzVersion` for nulo, `pcchVersion` contém o tamanho esperado do `pwzVersion` quando `GetRequestedRuntime` retorna, para permitir a pré-alocação; caso contrário, `pcchVersion` contém o número de caracteres gravados `pwzVersion`.</span><span class="sxs-lookup"><span data-stu-id="d214b-122">If `pwzVersion` is null, `pcchVersion` contains the expected size of `pwzVersion` when `GetRequestedRuntime` returns, to allow pre-allocation; otherwise, `pcchVersion` contains the number of characters written to `pwzVersion`.</span></span>|  
|`pwzImageVersion`|<span data-ttu-id="d214b-123">[out] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-123">[out] Optional.</span></span> <span data-ttu-id="d214b-124">Quando `GetRequestedRuntime` retorna, contém a versão CLR correspondente para o [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface é retornada.</span><span class="sxs-lookup"><span data-stu-id="d214b-124">When `GetRequestedRuntime` returns, contains the CLR version corresponding to the [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface that is returned.</span></span>|  
|`pcchImageVersion`|<span data-ttu-id="d214b-125">[out no] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-125">[in, out] Optional.</span></span> <span data-ttu-id="d214b-126">Especifica o tamanho do `pwzImageVersion` como entrada para evitar estouros de buffer.</span><span class="sxs-lookup"><span data-stu-id="d214b-126">Specifies the size of `pwzImageVersion` as input to avoid buffer overruns.</span></span> <span data-ttu-id="d214b-127">Se `pwzImageVersion` for nulo, `pcchImageVersion` contém o tamanho necessário do `pwzImageVersion` quando `GetRequestedRuntime` retorna, para permitir a pré-alocação.</span><span class="sxs-lookup"><span data-stu-id="d214b-127">If `pwzImageVersion` is null, `pcchImageVersion` contains the required size of `pwzImageVersion` when `GetRequestedRuntime` returns, to allow pre-allocation.</span></span>|  
|`pdwConfigFlags`|<span data-ttu-id="d214b-128">[out] Opcional.</span><span class="sxs-lookup"><span data-stu-id="d214b-128">[out] Optional.</span></span> <span data-ttu-id="d214b-129">Se `GetRequestedRuntime` usa um arquivo de configuração durante o processo de associação, quando ela retorna, `pdwConfigFlags` contém um [METAHOST_CONFIG_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) valor que indica se o [ \<inicialização >](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md) elemento tem o `useLegacyV2RuntimeActivationPolicy` conjunto e o valor do atributo do atributo.</span><span class="sxs-lookup"><span data-stu-id="d214b-129">If `GetRequestedRuntime` uses a configuration file during the binding process, when it returns, `pdwConfigFlags` contains a [METAHOST_CONFIG_FLAGS](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) value that indicates whether the [\<startup>](../../../../docs/framework/configure-apps/file-schema/startup/startup-element.md) element has the `useLegacyV2RuntimeActivationPolicy` attribute set, and the value of the attribute.</span></span> <span data-ttu-id="d214b-130">Aplicar o [METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) máscara para `pdwConfigFlags` para obter os valores relevantes para `useLegacyV2RuntimeActivationPolicy`.</span><span class="sxs-lookup"><span data-stu-id="d214b-130">Apply the [METAHOST_CONFIG_FLAGS_LEGACY_V2_ACTIVATION_POLICY_MASK](../../../../docs/framework/unmanaged-api/hosting/metahost-config-flags-enumeration.md) mask to `pdwConfigFlags` to get the values relevant to `useLegacyV2RuntimeActivationPolicy`.</span></span>|  
|`riid`|<span data-ttu-id="d214b-131">[in] Especifica o identificador de interface IID_ICLRRuntimeInfo para a solicitação [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.</span><span class="sxs-lookup"><span data-stu-id="d214b-131">[in] Specifies the interface identifier IID_ICLRRuntimeInfo for the requested [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.</span></span>|  
|`ppRuntime`|<span data-ttu-id="d214b-132">[out] Quando `GetRequestedRuntime` retorna, contém um ponteiro para o correspondente [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.</span><span class="sxs-lookup"><span data-stu-id="d214b-132">[out] When `GetRequestedRuntime` returns, contains a pointer to the corresponding [ICLRRuntimeInfo](../../../../docs/framework/unmanaged-api/hosting/iclrruntimeinfo-interface.md) interface.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="d214b-133">Comentários</span><span class="sxs-lookup"><span data-stu-id="d214b-133">Remarks</span></span>  
 <span data-ttu-id="d214b-134">Quando esse método for bem-sucedido, ele tem como efeito colateral da combinação de sinalizadores adicionais com os sinalizadores de inicialização padrão atual da interface do tempo de execução retornado, se e somente se um ou mais dos seguintes elementos existem no fluxo de configuração dentro de `<configuration><runtime>` seção:</span><span class="sxs-lookup"><span data-stu-id="d214b-134">When this method succeeds, it has the side effect of combining additional flags with the current default startup flags of the returned runtime interface, if and only if one or more of the following elements exist in the configuration stream within the `<configuration><runtime>` section:</span></span>  
  
-   <span data-ttu-id="d214b-135">`<gcServer enabled="true"/>`faz com que `STARTUP_SERVER_GC` a ser definido.</span><span class="sxs-lookup"><span data-stu-id="d214b-135">`<gcServer enabled="true"/>` causes `STARTUP_SERVER_GC` to be set.</span></span>  
  
-   <span data-ttu-id="d214b-136">`<etwEnable enabled="true"/>`faz com que `STARTUP_ETW` a ser definido.</span><span class="sxs-lookup"><span data-stu-id="d214b-136">`<etwEnable enabled="true"/>` causes `STARTUP_ETW` to be set.</span></span>  
  
-   <span data-ttu-id="d214b-137">`<appDomainResourceMonitoring enabled="true"/>`faz com que `STARTUP_ARM` a ser definido.</span><span class="sxs-lookup"><span data-stu-id="d214b-137">`<appDomainResourceMonitoring enabled="true"/>` causes `STARTUP_ARM` to be set.</span></span>  
  
 <span data-ttu-id="d214b-138">O padrão resultante `STARTUP_FLAGS` valor é a combinação de OR bit a bit dos valores que são definidos na lista anterior com os sinalizadores de inicialização padrão.</span><span class="sxs-lookup"><span data-stu-id="d214b-138">The resulting default `STARTUP_FLAGS` value is the bitwise OR combination of the values that are set from the preceding list with the default startup flags.</span></span>  
  
## <a name="return-value"></a><span data-ttu-id="d214b-139">Valor de retorno</span><span class="sxs-lookup"><span data-stu-id="d214b-139">Return Value</span></span>  
 <span data-ttu-id="d214b-140">Este método retorna a seguintes HRESULTs específicos, bem como o HRESULT erros que indicam falha do método.</span><span class="sxs-lookup"><span data-stu-id="d214b-140">This method returns the following specific HRESULTs as well as HRESULT errors that indicate method failure.</span></span>  
  
|<span data-ttu-id="d214b-141">HRESULT</span><span class="sxs-lookup"><span data-stu-id="d214b-141">HRESULT</span></span>|<span data-ttu-id="d214b-142">Descrição</span><span class="sxs-lookup"><span data-stu-id="d214b-142">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="d214b-143">S_OK</span><span class="sxs-lookup"><span data-stu-id="d214b-143">S_OK</span></span>|<span data-ttu-id="d214b-144">O método foi concluído com êxito.</span><span class="sxs-lookup"><span data-stu-id="d214b-144">The method completed successfully.</span></span>|  
|<span data-ttu-id="d214b-145">E_POINTER</span><span class="sxs-lookup"><span data-stu-id="d214b-145">E_POINTER</span></span>|<span data-ttu-id="d214b-146">`pwzVersion`não é nulo e `pcchVersion` é nulo.</span><span class="sxs-lookup"><span data-stu-id="d214b-146">`pwzVersion` is not null and `pcchVersion` is null.</span></span><br /><br /> <span data-ttu-id="d214b-147">-ou-</span><span class="sxs-lookup"><span data-stu-id="d214b-147">-or-</span></span><br /><br /> <span data-ttu-id="d214b-148">`pwzImageVersion`não é nulo e `pcchImageVersion` é nulo.</span><span class="sxs-lookup"><span data-stu-id="d214b-148">`pwzImageVersion` is not null and `pcchImageVersion` is null.</span></span>|  
|<span data-ttu-id="d214b-149">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="d214b-149">E_INVALIDARG</span></span>|<span data-ttu-id="d214b-150">`dwPolicyFlags`não especifique `METAHOST_POLICY_HIGHCOMPAT`.</span><span class="sxs-lookup"><span data-stu-id="d214b-150">`dwPolicyFlags` does not specify `METAHOST_POLICY_HIGHCOMPAT`.</span></span>|  
|<span data-ttu-id="d214b-151">ERROR_INSUFFICIENT_BUFFER</span><span class="sxs-lookup"><span data-stu-id="d214b-151">ERROR_INSUFFICIENT_BUFFER</span></span>|<span data-ttu-id="d214b-152">A memória alocada para `pwzVerison` é inadequado.</span><span class="sxs-lookup"><span data-stu-id="d214b-152">The memory allocated to `pwzVerison` is inadequate.</span></span><br /><br /> <span data-ttu-id="d214b-153">-ou-</span><span class="sxs-lookup"><span data-stu-id="d214b-153">-or-</span></span><br /><br /> <span data-ttu-id="d214b-154">A memória alocada para `pwzImageVerison` é inadequado.</span><span class="sxs-lookup"><span data-stu-id="d214b-154">The memory allocated to `pwzImageVerison` is inadequate.</span></span>|  
|<span data-ttu-id="d214b-155">CLR_E_SHIM_RUNTIMELOAD</span><span class="sxs-lookup"><span data-stu-id="d214b-155">CLR_E_SHIM_RUNTIMELOAD</span></span>|<span data-ttu-id="d214b-156">`dwPolicyFlags`inclui METAHOST_POLICY_APPLY_UPGRADE_POLICY e ambos `pwzVersion` e `pcchVersion` são nulos.</span><span class="sxs-lookup"><span data-stu-id="d214b-156">`dwPolicyFlags` includes METAHOST_POLICY_APPLY_UPGRADE_POLICY, and both `pwzVersion` and `pcchVersion` are null.</span></span>|  
  
## <a name="requirements"></a><span data-ttu-id="d214b-157">Requisitos</span><span class="sxs-lookup"><span data-stu-id="d214b-157">Requirements</span></span>  
 <span data-ttu-id="d214b-158">**Plataformas:** consulte [requisitos de sistema](../../../../docs/framework/get-started/system-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="d214b-158">**Platforms:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).</span></span>  
  
 <span data-ttu-id="d214b-159">**Cabeçalho:** MetaHost.h</span><span class="sxs-lookup"><span data-stu-id="d214b-159">**Header:** MetaHost.h</span></span>  
  
 <span data-ttu-id="d214b-160">**Biblioteca:** incluído como um recurso no MSCOREE</span><span class="sxs-lookup"><span data-stu-id="d214b-160">**Library:** Included as a resource in MSCorEE.dll</span></span>  
  
 <span data-ttu-id="d214b-161">**Versões do .NET framework:**[!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</span><span class="sxs-lookup"><span data-stu-id="d214b-161">**.NET Framework Versions:** [!INCLUDE[net_current_v40plus](../../../../includes/net-current-v40plus-md.md)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d214b-162">Consulte também</span><span class="sxs-lookup"><span data-stu-id="d214b-162">See Also</span></span>  
 [<span data-ttu-id="d214b-163">Interface ICLRMetaHostPolicy</span><span class="sxs-lookup"><span data-stu-id="d214b-163">ICLRMetaHostPolicy Interface</span></span>](../../../../docs/framework/unmanaged-api/hosting/iclrmetahostpolicy-interface.md)  
 [<span data-ttu-id="d214b-164">Interfaces de hospedagem CLR adicionadas ao .NET Framework 4 e 4.5</span><span class="sxs-lookup"><span data-stu-id="d214b-164">CLR Hosting Interfaces Added in the .NET Framework 4 and 4.5</span></span>](../../../../docs/framework/unmanaged-api/hosting/clr-hosting-interfaces-added-in-the-net-framework-4-and-4-5.md)  
 [<span data-ttu-id="d214b-165">Hospedagem de Interfaces</span><span class="sxs-lookup"><span data-stu-id="d214b-165">Hosting Interfaces</span></span>](../../../../docs/framework/unmanaged-api/hosting/hosting-interfaces.md)  
 [<span data-ttu-id="d214b-166">Hospedagem</span><span class="sxs-lookup"><span data-stu-id="d214b-166">Hosting</span></span>](../../../../docs/framework/unmanaged-api/hosting/index.md)
