---
title: Importando uma biblioteca de tipos como um assembly
description: Importar uma biblioteca de tipos, que contém definições de tipo COM, como um assembly. Aprenda maneiras de criar metadados de uma biblioteca de tipos, resultando em um assembly de interoperabilidade.
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: bc1b921fea5aff086e21c046369f1d461f553bc7
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90554678"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="20e67-104">Importando uma biblioteca de tipos como um assembly</span><span class="sxs-lookup"><span data-stu-id="20e67-104">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="20e67-105">Definições de tipo COM geralmente residem em uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="20e67-105">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="20e67-106">Por outro lado, os compiladores em conformidade com CLS produzem metadados de tipo em um assembly.</span><span class="sxs-lookup"><span data-stu-id="20e67-106">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="20e67-107">As duas fontes de informações de tipo são muito diferentes.</span><span class="sxs-lookup"><span data-stu-id="20e67-107">The two sources of type information are quite different.</span></span> <span data-ttu-id="20e67-108">Este tópico descreve técnicas para a geração de metadados de uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="20e67-108">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="20e67-109">O assembly resultante é chamado de um assembly de interoperabilidade e as informações de tipo contidas nele permitem que aplicativos do .NET Framework usem tipos COM.</span><span class="sxs-lookup"><span data-stu-id="20e67-109">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="20e67-110">Há duas maneiras de disponibilizar essas informações de tipo para seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="20e67-110">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="20e67-111">Usando assemblies de interoperabilidade somente de tempo de design: começando com o .NET Framework 4, você pode instruir o compilador a inserir informações de tipo do assembly de interoperabilidade em seu executável.</span><span class="sxs-lookup"><span data-stu-id="20e67-111">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="20e67-112">O compilador insere apenas as informações de tipo usadas pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20e67-112">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="20e67-113">Não é necessário implantar o assembly de interoperabilidade com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20e67-113">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="20e67-114">Essa é a técnica recomendada.</span><span class="sxs-lookup"><span data-stu-id="20e67-114">This is the recommended technique.</span></span>

- <span data-ttu-id="20e67-115">Implantando assemblies de interoperabilidade: é possível criar uma referência padrão ao assembly de interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="20e67-115">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="20e67-116">Nesse caso, o assembly de interoperabilidade deve ser implantado com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20e67-116">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="20e67-117">Se você usar essa técnica e não estiver usando um componente COM particular, sempre referencie o PIA (assembly de interoperabilidade primário) publicado pelo autor do componente COM que você pretende incorporar no código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="20e67-117">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="20e67-118">Para obter mais informações sobre como produzir e usar assemblies de interoperabilidade primários, consulte [Assemblies de interoperabilidade primários](/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="20e67-118">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="20e67-119">Quando você usar assemblies de interoperabilidade somente em tempo de design, você pode inserir informações de tipo do assembly de interoperabilidade primário publicado pelo autor do componente COM.</span><span class="sxs-lookup"><span data-stu-id="20e67-119">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="20e67-120">No entanto, não é necessário implantar o assembly de interoperabilidade primário com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20e67-120">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="20e67-121">Usar assemblies de interoperabilidade somente em tempo de design reduz o tamanho do seu aplicativo, porque a maioria dos aplicativos não usam todos os recursos de um componente COM.</span><span class="sxs-lookup"><span data-stu-id="20e67-121">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="20e67-122">O compilador é muito eficiente quando ele insere informações de tipo. Se seu aplicativo usa apenas alguns dos métodos em uma interface COM, o compilador não insere os métodos não utilizados.</span><span class="sxs-lookup"><span data-stu-id="20e67-122">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="20e67-123">Quando um aplicativo que inseriu informações de tipo interage com outro aplicativo desse tipo ou interage com um aplicativo que usa um assembly de interoperabilidade primário, o Common Language Runtime usa regras de equivalência de tipo para determinar se dois tipos com o mesmo nome representam o mesmo tipo COM.</span><span class="sxs-lookup"><span data-stu-id="20e67-123">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="20e67-124">Você não precisa conhecer essas regras para usar objetos COM.</span><span class="sxs-lookup"><span data-stu-id="20e67-124">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="20e67-125">No entanto, se você estiver interessado nas regras, consulte [Equivalência de tipos e tipos de interoperabilidade inseridos](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="20e67-125">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="20e67-126">Geração de metadados</span><span class="sxs-lookup"><span data-stu-id="20e67-126">Generating Metadata</span></span>

<span data-ttu-id="20e67-127">Bibliotecas de tipos COM podem ser arquivos autônomos que têm uma extensão .tlb, tais como Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="20e67-127">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="20e67-128">Algumas bibliotecas de tipo são inseridas na seção de recursos de um arquivo .dll ou .exe.</span><span class="sxs-lookup"><span data-stu-id="20e67-128">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="20e67-129">Outras fontes de informações da biblioteca de tipos são arquivos .olb e .ocx.</span><span class="sxs-lookup"><span data-stu-id="20e67-129">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="20e67-130">Após você localizar a biblioteca de tipos que contém a implementação do seu tipo COM de destino, você tem as seguintes opções para a geração de um assembly de interoperabilidade contendo os metadados de tipo:</span><span class="sxs-lookup"><span data-stu-id="20e67-130">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="20e67-131">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="20e67-131">Visual Studio</span></span>

  <span data-ttu-id="20e67-132">O Visual Studio converte automaticamente os tipos COM em uma biblioteca de tipos para metadados em um assembly.</span><span class="sxs-lookup"><span data-stu-id="20e67-132">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="20e67-133">Para obter instruções, consulte [como: adicionar referências a bibliotecas de tipos](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="20e67-133">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="20e67-134">Importador de Biblioteca de Tipos (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="20e67-134">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="20e67-135">O importador da biblioteca de tipos fornece opções de linha de comando para ajustar os metadados no arquivo de interoperabilidade resultante, importa tipos de uma biblioteca de tipos existente e gera um assembly de interoperabilidade e um namespace.</span><span class="sxs-lookup"><span data-stu-id="20e67-135">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="20e67-136">Para obter instruções, consulte [Como gerar assemblies de interoperabilidade com base em bibliotecas de tipos](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="20e67-136">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="20e67-137">Classe <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="20e67-137"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="20e67-138">Essa classe fornece métodos para converter coclasses e interfaces em uma biblioteca de tipos para metadados em um assembly.</span><span class="sxs-lookup"><span data-stu-id="20e67-138">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="20e67-139">Ela produz a mesma saída de metadados que Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="20e67-139">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="20e67-140">No entanto, ao contrário de Tlbimp.exe, a classe <xref:System.Runtime.InteropServices.TypeLibConverter> pode converter uma biblioteca de tipos na memória em metadados.</span><span class="sxs-lookup"><span data-stu-id="20e67-140">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="20e67-141">Wrappers personalizados</span><span class="sxs-lookup"><span data-stu-id="20e67-141">Custom wrappers</span></span>

  <span data-ttu-id="20e67-142">Quando uma biblioteca de tipos não está disponível ou é incorreta, uma opção é criar uma definição duplicada da classe ou interface em código-fonte gerenciado.</span><span class="sxs-lookup"><span data-stu-id="20e67-142">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="20e67-143">Em seguida, você compilar o código-fonte com um compilador que tem como alvo o runtime para produzir os metadados em um assembly.</span><span class="sxs-lookup"><span data-stu-id="20e67-143">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="20e67-144">Para definir tipos COM manualmente, você deve ter acesso aos seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="20e67-144">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="20e67-145">Descrições precisas das coclasses e interfaces que estão sendo definidas.</span><span class="sxs-lookup"><span data-stu-id="20e67-145">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="20e67-146">Um compilador, assim como o compilador C#, que pode gerar as definições de classe do .NET Framework apropriadas.</span><span class="sxs-lookup"><span data-stu-id="20e67-146">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="20e67-147">Conhecimento das regras de conversão de biblioteca de tipos para assembly.</span><span class="sxs-lookup"><span data-stu-id="20e67-147">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="20e67-148">Escrever um wrapper personalizado é uma técnica avançada.</span><span class="sxs-lookup"><span data-stu-id="20e67-148">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="20e67-149">Para obter informações adicionais sobre como gerar um wrapper personalizado, consulte [Personalizando wrappers padrão](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="20e67-149">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="20e67-150">Para obter mais informações sobre o processo de importação de interoperabilidade COM, consulte [Resumo da conversão de bibliotecas de tipos em assemblies](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="20e67-150">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="20e67-151">Confira também</span><span class="sxs-lookup"><span data-stu-id="20e67-151">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="20e67-152">Expondo componentes do COM para o .NET Framework</span><span class="sxs-lookup"><span data-stu-id="20e67-152">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="20e67-153">[Resumo da conversão de bibliotecas de tipos em assemblies](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="20e67-153">[Type Library to Assembly Conversion Summary](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="20e67-154">Tlbimp.exe (tipo de importador de biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="20e67-154">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="20e67-155">[Personalizando wrappers padrão](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="20e67-155">[Customizing Standard Wrappers](/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="20e67-156">[Usando tipos COM no código gerenciado](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="20e67-156">[Using COM Types in Managed Code](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="20e67-157">Compilando um projeto de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="20e67-157">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="20e67-158">Implantando um aplicativo de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="20e67-158">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="20e67-159">Como: Adicionar referências a bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="20e67-159">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="20e67-160">Como: Gerar assemblies de interoperabilidade com base em bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="20e67-160">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
