---
title: Ativação de instância
ms.date: 03/30/2017
ms.assetid: 134c3f70-5d4e-46d0-9d49-469a6643edd8
ms.openlocfilehash: a1b78dc62fbdc6e5551addf400ceb14dc9e822f5
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33516822"
---
# <a name="instance-activation"></a><span data-ttu-id="ddb54-102">Ativação de instância</span><span class="sxs-lookup"><span data-stu-id="ddb54-102">Instance Activation</span></span>
<span data-ttu-id="ddb54-103">A instância Store de fluxo de trabalho do SQL executa uma tarefa periodicamente interna que acorde e detecte instâncias praticáveis ou activatable de fluxo de trabalho na base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="ddb54-103">The SQL Workflow Instance Store runs an internal task that periodically wakes up and detects runnable or activatable workflow instances in the persistence database.</span></span> <span data-ttu-id="ddb54-104">Se encontra uma instância viável de fluxo de trabalho, notifica o host de fluxo de trabalho que é capaz de ativar a instância.</span><span class="sxs-lookup"><span data-stu-id="ddb54-104">If it finds a runnable workflow instance, it notifies the workflow host that is capable of activating the instance.</span></span> <span data-ttu-id="ddb54-105">Se o armazenamento de instância encontra uma instância activatable de fluxo de trabalho, notifica um host genérico que ative um host de fluxo de trabalho, que executa por sua vez a instância de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ddb54-105">If the instance store finds an activatable workflow instance, it notifies a generic host that activates a workflow host, which in turn runs the workflow instance.</span></span> <span data-ttu-id="ddb54-106">As seções neste tópico explica o processo de ativação de instância em detalhes.</span><span class="sxs-lookup"><span data-stu-id="ddb54-106">The following sections in this topic explain the instance activation process in detail.</span></span>  
  
##  <a name="RunnableSection"></a> <span data-ttu-id="ddb54-107">Detecção e ativação de instâncias de fluxo de trabalho executável</span><span class="sxs-lookup"><span data-stu-id="ddb54-107">Detecting and Activating Runnable Workflow Instances</span></span>  
 <span data-ttu-id="ddb54-108">O armazenamento de instância de fluxo de trabalho do SQL considera uma instância de fluxo de trabalho *executável* se a instância não está em estado suspenso ou o estado concluído e satisfaça as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="ddb54-108">The SQL Workflow Instance Store considers a workflow instance *runnable* if the instance is not in the suspended state or the completed state and satisfies the following conditions:</span></span>  
  
-   <span data-ttu-id="ddb54-109">A instância é desbloqueada e tem um timer pendente que expirou.</span><span class="sxs-lookup"><span data-stu-id="ddb54-109">The instance is unlocked and has a pending timer that has expired.</span></span>  
  
-   <span data-ttu-id="ddb54-110">A instância tem um bloqueio expirado nele.</span><span class="sxs-lookup"><span data-stu-id="ddb54-110">The instance has an expired lock on it.</span></span>  
  
-   <span data-ttu-id="ddb54-111">A instância está desbloqueada e seu status é **executando**.</span><span class="sxs-lookup"><span data-stu-id="ddb54-111">The instance is unlocked and its status is **Executing**.</span></span>  
  
 <span data-ttu-id="ddb54-112">A instância Store de fluxo de trabalho do SQL aumenta <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> quando encontra uma instância viável.</span><span class="sxs-lookup"><span data-stu-id="ddb54-112">The SQL Workflow Instance Store raises the <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> when it finds a runnable instance.</span></span> <span data-ttu-id="ddb54-113">Após isso, o SqlWorkflowInstanceStore para monitorar de <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> até que seja chamado uma vez no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="ddb54-113">After this, the SqlWorkflowInstanceStore stops monitoring until the <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> is called once on the store.</span></span>  
  
 <span data-ttu-id="ddb54-114">Um host de fluxo de trabalho que assine para <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> e capaz de carregar a instância executa <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> contra o armazenamento de instância para carregar a instância na memória.</span><span class="sxs-lookup"><span data-stu-id="ddb54-114">A workflow host that has subscribed for the <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> and capable of loading the instance executes the <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> against the instance store to load the instance into memory.</span></span> <span data-ttu-id="ddb54-115">Um host de fluxo de trabalho é considerado capaz de carregar uma instância de fluxo de trabalho se o host e a instância tem a propriedade de metadados **WorkflowServiceType** definido como o mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="ddb54-115">A workflow host is considered capable of loading a workflow instance if the host and the instance have metadata property **WorkflowServiceType** set to the same value.</span></span>  
  
## <a name="detecting-and-activating-activatable-workflow-instances"></a><span data-ttu-id="ddb54-116">Detectando e ativando instâncias de fluxo de trabalho de Activatable</span><span class="sxs-lookup"><span data-stu-id="ddb54-116">Detecting and Activating Activatable Workflow Instances</span></span>  
 <span data-ttu-id="ddb54-117">Uma instância de fluxo de trabalho é considerada *ativável* se a instância é executável e não há nenhum host de fluxo de trabalho que é capaz de carregar a instância está em execução no computador.</span><span class="sxs-lookup"><span data-stu-id="ddb54-117">A workflow instance is considered *activatable* if the instance is runnable and there is no workflow host that is capable of loading the instance is running on the computer.</span></span> <span data-ttu-id="ddb54-118">Consulte detectar e ativar instâncias praticáveis de fluxo de trabalho anterior para a definição de uma instância viável de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ddb54-118">See Detecting and Activating Runnable Workflow Instances above for the definition of a runnable workflow instance.</span></span>  
  
 <span data-ttu-id="ddb54-119">A instância Store de fluxo de trabalho do SQL aumenta <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> quando encontra uma instância activatable de fluxo de trabalho na base de dados.</span><span class="sxs-lookup"><span data-stu-id="ddb54-119">The SQL Workflow Instance Store raises the <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> when it finds an activatable workflow instance in the database.</span></span> <span data-ttu-id="ddb54-120">Após isso, o SqlWorkflowInstanceStore para monitorar de <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> até que seja chamado uma vez no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="ddb54-120">After this, the SqlWorkflowInstanceStore stops monitoring until the <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> is called once on the store.</span></span>  
  
 <span data-ttu-id="ddb54-121">Quando um host genérico que assine para <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> recebe o evento, executa <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> contra o armazenamento de instância para obter os parâmetros de ativação necessários para criar um host de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ddb54-121">When a generic host that has subscribed for the <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent> receives the event, it executes the <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> against the instance store to obtain activation parameters required to create a workflow host.</span></span> <span data-ttu-id="ddb54-122">O host genérico usa esses parâmetros de ativação para criar um host de fluxo de trabalho, que por sua vez as carrega e as executa o serviço viável ouvinte como um exemplo.</span><span class="sxs-lookup"><span data-stu-id="ddb54-122">The generic host uses these activation parameters to create a workflow host, which in turn loads and runs the runnable service instance.</span></span>  
  
## <a name="generic-hosts"></a><span data-ttu-id="ddb54-123">Hosts genéricos</span><span class="sxs-lookup"><span data-stu-id="ddb54-123">Generic Hosts</span></span>  
 <span data-ttu-id="ddb54-124">Um host genérico é um host com o valor da propriedade de metadados **WorkflowServiceType** para hosts genéricos é definida como **WorkflowServiceType.Any** para indicar que pode lidar com qualquer tipo de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ddb54-124">A generic host is a host with the value of the metadata property **WorkflowServiceType** for generic hosts is set to **WorkflowServiceType.Any** to indicate that it can handle any workflow type.</span></span> <span data-ttu-id="ddb54-125">Um host genérico tem um parâmetro de XName chamado **ActivationType**.</span><span class="sxs-lookup"><span data-stu-id="ddb54-125">A generic host has an XName parameter named **ActivationType**.</span></span>  
  
 <span data-ttu-id="ddb54-126">Atualmente, o armazenamento de instância de fluxo de trabalho do SQL oferece suporte a genéricos hosts com o valor do parâmetro ActivationType definido como **WAS**.</span><span class="sxs-lookup"><span data-stu-id="ddb54-126">Currently, the SQL Workflow Instance Store supports generic hosts with value of the ActivationType parameter set to **WAS**.</span></span> <span data-ttu-id="ddb54-127">Se o ActivationType não é definido como WAS, a instância de fluxo de trabalho do SQL gerencie <xref:System.Runtime.DurableInstancing.InstancePersistenceException>Store.</span><span class="sxs-lookup"><span data-stu-id="ddb54-127">If the ActivationType is not set to WAS, the SQL Workflow Instance Store throws an <xref:System.Runtime.DurableInstancing.InstancePersistenceException>.</span></span> <span data-ttu-id="ddb54-128">O serviço de gerenciamento de fluxo de trabalho que acompanha o [!INCLUDE[dublin](../../../includes/dublin-md.md)] é um host genérico que tem o tipo de ativação definido como **WAS**.</span><span class="sxs-lookup"><span data-stu-id="ddb54-128">The Workflow Management Service that ships with the [!INCLUDE[dublin](../../../includes/dublin-md.md)] is a generic host that has the activation type set to **WAS**.</span></span>  
  
 <span data-ttu-id="ddb54-129">Para WAS ativação, um host genérico requer um conjunto de parâmetros de ativação derivar o endereço do ponto de extremidade em que os novos host podem ser ativados.</span><span class="sxs-lookup"><span data-stu-id="ddb54-129">For WAS activation, a generic host requires a set of activation parameters to derive the endpoint address at which new hosts can be activated.</span></span> <span data-ttu-id="ddb54-130">Os parâmetros de ativação para ativação do WAS são nome do site, caminho relativo para o aplicativo ao site, e caminho para o serviço relativo para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ddb54-130">The activation parameters for WAS activation are name of the site, path to the application relative to the site, and path to the service relative to the application.</span></span> <span data-ttu-id="ddb54-131">A instância Store de fluxo de trabalho do SQL armazena esses parâmetros de ativação durante a execução de <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.</span><span class="sxs-lookup"><span data-stu-id="ddb54-131">The SQL Workflow Instance Store stores these activation parameters during the execution of the <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.</span></span>  
  
## <a name="runnable-instances-detection-period"></a><span data-ttu-id="ddb54-132">Período viável de detecção de instâncias</span><span class="sxs-lookup"><span data-stu-id="ddb54-132">Runnable Instances Detection Period</span></span>  
 <span data-ttu-id="ddb54-133">O **período de detecção de instâncias executáveis** propriedade do repositório de instância de fluxo de trabalho SQL Especifica o período de tempo após o qual o armazenamento de instância de fluxo de trabalho do SQL executa uma tarefa de detecção para detectar qualquer fluxo de trabalho ativável ou executável instâncias do banco de dados de persistência após o ciclo de detecção anterior.</span><span class="sxs-lookup"><span data-stu-id="ddb54-133">The **Runnable Instances Detection Period** property of the SQL Workflow Instance Store specifies the time period after which the SQL Workflow Instance Store runs a detection task to detect any runnable or activatable workflow instances in the persistence database after the previous detection cycle.</span></span> <span data-ttu-id="ddb54-134">Consulte [período de detecção de instâncias executáveis](../../../docs/framework/windows-workflow-foundation/runnable-instances-detection-period.md) para obter mais detalhes sobre essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="ddb54-134">See [Runnable Instances Detection Period](../../../docs/framework/windows-workflow-foundation/runnable-instances-detection-period.md) for more details on this property.</span></span>
