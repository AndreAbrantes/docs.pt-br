---
title: Práticas recomendadas de persistência
ms.date: 03/30/2017
ms.assetid: 6974c5a4-1af8-4732-ab53-7d694608a3a0
ms.openlocfilehash: fdbf61e559efbd978df1c5a46fcbbbbc528ec98a
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "62005622"
---
# <a name="persistence-best-practices"></a><span data-ttu-id="20bdf-102">Práticas recomendadas de persistência</span><span class="sxs-lookup"><span data-stu-id="20bdf-102">Persistence Best Practices</span></span>
<span data-ttu-id="20bdf-103">Este documento aborda as práticas recomendadas para o design e a configuração de fluxo de trabalho relacionados à persistência de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-103">This document covers best practices for workflow design and configuration related to workflow persistence.</span></span>  
  
## <a name="design-and-implementation-of-durable-workflows"></a><span data-ttu-id="20bdf-104">Design e implementação de fluxos de trabalho duráveis</span><span class="sxs-lookup"><span data-stu-id="20bdf-104">Design and Implementation of Durable Workflows</span></span>  
 <span data-ttu-id="20bdf-105">Geralmente, os fluxos de trabalho executam o trabalho em curtas períodos que são intercalados com horários durante o qual o fluxo de trabalho estiver ocioso porque está aguardando um evento.</span><span class="sxs-lookup"><span data-stu-id="20bdf-105">In general, workflows perform work in short periods that are interleaved with times during which the workflow is idle because it is waiting for an event.</span></span> <span data-ttu-id="20bdf-106">Esse evento pode ser itens como uma mensagem ou um timer expira.</span><span class="sxs-lookup"><span data-stu-id="20bdf-106">This event can be such things as a message or an expiring timer.</span></span> <span data-ttu-id="20bdf-107">Para poder descarregar o fluxo de trabalho métodos como exemplo quando fica ocioso, o serviço que o host deve manter a instância de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-107">To be able to unload the workflow instance when it becomes idle, the service host must persist the workflow instance.</span></span> <span data-ttu-id="20bdf-108">Isso é possível somente se a instância de fluxo de trabalho não está em uma zona sem persistir (por exemplo, aguardando uma transação para concluir, ou aguardando um retorno de chamada assíncrona).</span><span class="sxs-lookup"><span data-stu-id="20bdf-108">This is possible only if the workflow instance is not in a no-persist zone (for example, waiting for a transaction to complete, or waiting for an asynchronous callback).</span></span> <span data-ttu-id="20bdf-109">Para permitir que uma instância ocioso de fluxo de trabalho descarregar, o autor de fluxo de trabalho deve usar escopos de transação e atividades assíncronas para uma breve ações somente.</span><span class="sxs-lookup"><span data-stu-id="20bdf-109">To allow an idle workflow instance to unload, the workflow author should use transaction scopes and asynchronous activities for short-lived actions only.</span></span> <span data-ttu-id="20bdf-110">Em particular, o autor deve manter atividades de atraso nesses sem para persistir as zonas tão curto como possível.</span><span class="sxs-lookup"><span data-stu-id="20bdf-110">In particular, the author should keep delay activities within these no-persist zones as short as possible.</span></span>  
  
 <span data-ttu-id="20bdf-111">Um fluxo de trabalho só pode ser persistido se todos os tipos de dados usados pelo fluxo de trabalho são serializados.</span><span class="sxs-lookup"><span data-stu-id="20bdf-111">A workflow can only be persisted if all of the data types used by the workflow are serializable.</span></span> <span data-ttu-id="20bdf-112">Além disso, os tipos personalizados usados em fluxos de trabalho persistentes devem ser serializáveis com <xref:System.Runtime.Serialization.NetDataContractSerializer> para ser persistido por <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span><span class="sxs-lookup"><span data-stu-id="20bdf-112">In addition, custom types used in persisted workflows must be serializable with <xref:System.Runtime.Serialization.NetDataContractSerializer> in order to be persisted by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span></span>  
  
 <span data-ttu-id="20bdf-113">Uma instância de fluxo de trabalho não pode ser recuperada em caso de uma falha de host do computador ou se não foi persistente.</span><span class="sxs-lookup"><span data-stu-id="20bdf-113">A workflow instance cannot be recovered in case of a host or computer failure if it has not been persisted.</span></span> <span data-ttu-id="20bdf-114">Em geral, recomendamos que você persistir uma instância de fluxo de trabalho no início do ciclo de vida de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-114">In general, we recommend that you persist a workflow instance early in the workflow’s life cycle.</span></span>  
  
 <span data-ttu-id="20bdf-115">Se seu fluxo de trabalho é muito ocupado por tempo, recomendamos que você persistir a instância de fluxo de trabalho regularmente ao longo do seu período ocupado.</span><span class="sxs-lookup"><span data-stu-id="20bdf-115">If your workflow is busy for a long time, we recommend that you persist the workflow instance regularly throughout its busy period.</span></span> <span data-ttu-id="20bdf-116">Você pode fazer isso adicionando atividades de <xref:System.Activities.Statements.Persist> durante a sequência de atividades que mantém a instância de fluxo de trabalho ocupado.</span><span class="sxs-lookup"><span data-stu-id="20bdf-116">You can do this by adding <xref:System.Activities.Statements.Persist> activities throughout the sequence of activities that keep the workflow instance busy.</span></span> <span data-ttu-id="20bdf-117">Assim, reciclagem do domínio de aplicativo, falhas host, ou falhas do computador não causam o sistema a ser rolado de volta para o início do período ocupado.</span><span class="sxs-lookup"><span data-stu-id="20bdf-117">In this manner, application domain recycling, host failures, or computer failures do not cause the system to be rolled back to the start of the busy period.</span></span> <span data-ttu-id="20bdf-118">Esteja ciente que adicionar atividades de <xref:System.Activities.Statements.Persist> ao fluxo de trabalho pode levar a uma degradação de desempenho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-118">Be aware that adding <xref:System.Activities.Statements.Persist> activities to your workflow could lead to a degradation of performance.</span></span>  
  
 <span data-ttu-id="20bdf-119">A tela de aplicativo Windows Server simplifica bastante a configuração e uso de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-119">Windows Server App Fabric greatly simplifies the configuration and use of persistence.</span></span> <span data-ttu-id="20bdf-120">Para obter mais informações, consulte [persistência da tela de aplicativo do Windows Server](https://go.microsoft.com/fwlink/?LinkID=201200&clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="20bdf-120">For more information, see [Windows Server App Fabric Persistence](https://go.microsoft.com/fwlink/?LinkID=201200&clcid=0x409)</span></span>  
  
## <a name="configuration-of-scalability-parameters"></a><span data-ttu-id="20bdf-121">Configuração de parâmetros de escalabilidade</span><span class="sxs-lookup"><span data-stu-id="20bdf-121">Configuration of Scalability Parameters</span></span>  
 <span data-ttu-id="20bdf-122">Os requisitos de escalabilidade e desempenho determinam as configurações dos seguintes parâmetros:</span><span class="sxs-lookup"><span data-stu-id="20bdf-122">Scalability and performance requirements determine the settings of the following parameters:</span></span>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A>  
  
- <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A>  
  
 <span data-ttu-id="20bdf-123">Esses parâmetros devem ser definidos como segue, de acordo com o cenário atual.</span><span class="sxs-lookup"><span data-stu-id="20bdf-123">These parameters should be set as follows, according to the current scenario.</span></span>  
  
### <a name="scenario-a-small-number-of-workflow-instances-that-require-optimal-response-time"></a><span data-ttu-id="20bdf-124">Cenário: Um pequeno número de instâncias de fluxo de trabalho que exigem o tempo de resposta ótimo</span><span class="sxs-lookup"><span data-stu-id="20bdf-124">Scenario: A Small Number of Workflow Instances That Require Optimal Response Time</span></span>  
 <span data-ttu-id="20bdf-125">Nesse cenário, todas as instâncias de fluxo de trabalho devem permanecer carregadas quando se tornam ociosos.</span><span class="sxs-lookup"><span data-stu-id="20bdf-125">In this scenario, all workflow instances should remain loaded when they become idle.</span></span> <span data-ttu-id="20bdf-126">Definir <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> para um valor grande.</span><span class="sxs-lookup"><span data-stu-id="20bdf-126">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to a large value.</span></span> <span data-ttu-id="20bdf-127">O uso dessa configuração impede que uma instância de fluxo de trabalho se mover entre computadores.</span><span class="sxs-lookup"><span data-stu-id="20bdf-127">The use of this setting prevents a workflow instance from moving between computers.</span></span> <span data-ttu-id="20bdf-128">Use essa configuração somente se um ou mais dos seguintes condições forem verdadeiras:</span><span class="sxs-lookup"><span data-stu-id="20bdf-128">Use this setting only if one or more of the following are true:</span></span>  
  
- <span data-ttu-id="20bdf-129">Uma instância de fluxo de trabalho recebe uma única mensagem em seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="20bdf-129">A workflow instance receives a single message throughout its lifetime.</span></span>  
  
- <span data-ttu-id="20bdf-130">Todas as instâncias de fluxo de trabalho executadas em um único computador</span><span class="sxs-lookup"><span data-stu-id="20bdf-130">All workflow instances run on a single computer</span></span>  
  
- <span data-ttu-id="20bdf-131">Todas as mensagens que são recebidas por uma instância de fluxo de trabalho são recebidas pelo mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="20bdf-131">All messages that are received by a workflow instance are received by the same computer.</span></span>  
  
 <span data-ttu-id="20bdf-132">Use atividades de <xref:System.Activities.Statements.Persist> ou <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> definido como 0 para ativar a recuperação de sua instância de fluxo de trabalho depois que falhas de host ou do computador de serviço.</span><span class="sxs-lookup"><span data-stu-id="20bdf-132">Use <xref:System.Activities.Statements.Persist> activities or set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to enable recovery of your workflow instance after service host or computer failures.</span></span>  
  
### <a name="scenario-workflow-instances-are-idle-for-long-periods-of-time"></a><span data-ttu-id="20bdf-133">Cenário: Instâncias de fluxo de trabalho são ociosos por longos períodos de tempo</span><span class="sxs-lookup"><span data-stu-id="20bdf-133">Scenario: Workflow Instances Are Idle for Long Periods of Time</span></span>  
 <span data-ttu-id="20bdf-134">Nesse cenário, defina <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> a 0 para liberar o mais rápido possível recursos.</span><span class="sxs-lookup"><span data-stu-id="20bdf-134">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0 to release resources as soon as possible.</span></span>  
  
### <a name="scenario-workflow-instances-receive-multiple-messages-in-a-short-period-of-time"></a><span data-ttu-id="20bdf-135">Cenário: Instâncias de fluxo de trabalho vários recebem mensagens em um curto período de tempo</span><span class="sxs-lookup"><span data-stu-id="20bdf-135">Scenario: Workflow Instances Receive Multiple Messages in a Short Period of Time</span></span>  
 <span data-ttu-id="20bdf-136">Nesse cenário, defina <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> como 60 segundos se essas mensagens são recebidas pelo mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="20bdf-136">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 60 seconds if these messages are received by the same computer.</span></span> <span data-ttu-id="20bdf-137">Isso evita uma sequência rápida de unload e carregar de uma instância de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-137">This prevents a rapid sequence of unloading and loading of a workflow instance.</span></span> <span data-ttu-id="20bdf-138">Isso também não mantém a instância na memória durante o suficiente tiempo.</span><span class="sxs-lookup"><span data-stu-id="20bdf-138">This also does not keep the instance in memory for too long.</span></span>  
  
 <span data-ttu-id="20bdf-139">Definir <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> a 0, e o conjunto <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> a BasicRetry ou a AggressiveRetry se essas mensagens podem ser recebidas por diferentes computadores.</span><span class="sxs-lookup"><span data-stu-id="20bdf-139">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0, and set <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if these messages may be received by different computers.</span></span> <span data-ttu-id="20bdf-140">Isso permite que a instância de fluxo de trabalho é carregada por outro computador.</span><span class="sxs-lookup"><span data-stu-id="20bdf-140">This allows the workflow instance to be loaded by another computer.</span></span>  
  
### <a name="scenario-workflow-uses-delay-activities-with-short-durations"></a><span data-ttu-id="20bdf-141">Cenário: Fluxo de trabalho usa atividades de atraso com durações curtas</span><span class="sxs-lookup"><span data-stu-id="20bdf-141">Scenario: Workflow Uses Delay Activities with Short Durations</span></span>  
 <span data-ttu-id="20bdf-142">Nesse cenário, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonda regularmente o base de dados de persistência para as instâncias que devem ser carregadas devido a uma atividade expirada de <xref:System.Activities.Statements.Delay> .</span><span class="sxs-lookup"><span data-stu-id="20bdf-142">In this scenario, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularly polls the persistence database for instances that should be loaded because of an expired <xref:System.Activities.Statements.Delay> activity.</span></span> <span data-ttu-id="20bdf-143">Se <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> encontrar um timer que expirou no intervalo de pesquisa seguir, a instância Store de fluxo de trabalho do SQL diminuirá o intervalo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="20bdf-143">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, the SQL Workflow Instance Store shortens the polling interval.</span></span> <span data-ttu-id="20bdf-144">A votação seguir ocorrerá em right após o timer expirou.</span><span class="sxs-lookup"><span data-stu-id="20bdf-144">The next poll will then occur right after the timer has expired.</span></span> <span data-ttu-id="20bdf-145">Essa maneira, a instância Store de fluxo de trabalho do SQL obtém uma alta precisão de temporizadores que executam mais tempo do intervalo de pesquisa, que é definido por <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="20bdf-145">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than the polling interval, which is set by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span> <span data-ttu-id="20bdf-146">Para ativar o processamento hábil de um atrasos mais curtas, a instância de fluxo de trabalho deve permanecer na memória pelo menos um intervalo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="20bdf-146">To enable timely processing of shorter delays, the workflow instance must remain in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="20bdf-147">Definir <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> a 0 para escrever o tempo de expiração a base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-147">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to write the expiration time to the persistence database.</span></span>  
  
 <span data-ttu-id="20bdf-148">Definir <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> mais tempo que ou igual a <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> para manter no mínimo a instância na memória um intervalo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="20bdf-148">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to longer than or equal to <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to keep the instance in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="20bdf-149">Não recomendamos reduzir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> porque isso resulta em uma carga na base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-149">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="20bdf-150">Cada host serviço que usa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonda o base de dados uma vez por período de detecção.</span><span class="sxs-lookup"><span data-stu-id="20bdf-150">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="20bdf-151">A configuração <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> a um intervalo de tempo muito pequeno pode fazer com que o desempenho do sistema diminui se o número de host serviço é grande.</span><span class="sxs-lookup"><span data-stu-id="20bdf-151">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small a time interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
## <a name="configuring-the-sql-workflow-instance-store"></a><span data-ttu-id="20bdf-152">Configurando a instância Store de fluxo de trabalho do SQL</span><span class="sxs-lookup"><span data-stu-id="20bdf-152">Configuring the SQL Workflow Instance Store</span></span>  
 <span data-ttu-id="20bdf-153">A instância Store de fluxo de trabalho do SQL possui os seguintes parâmetros de configuração:</span><span class="sxs-lookup"><span data-stu-id="20bdf-153">The SQL Workflow Instance Store has the following configuration parameters:</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceEncodingOption%2A>  
 <span data-ttu-id="20bdf-154">Este parâmetro instrui <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> para compactar o estado da instância de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-154">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to compress the workflow instance state.</span></span> <span data-ttu-id="20bdf-155">A compactação reduz a quantidade de dados que são armazenados na base de dados de persistência e reduzir o tráfego de rede no caso do base de dados de persistência reside em um servidor de base de dados dedicado.</span><span class="sxs-lookup"><span data-stu-id="20bdf-155">Compression reduces the amount of data that is stored in the persistence database and reduces network traffic in case the persistence database resides on a dedicated database server.</span></span> <span data-ttu-id="20bdf-156">Se a compactação é usado, requer recursos computacionais compactar e extrair o estado da instância.</span><span class="sxs-lookup"><span data-stu-id="20bdf-156">If compression is used, it requires computational resources to compress and extract the instance state.</span></span> <span data-ttu-id="20bdf-157">Na maioria dos casos, os passa de compactação aumentaram o desempenho.</span><span class="sxs-lookup"><span data-stu-id="20bdf-157">In most cases, compression yields increased performance.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceCompletionAction%2A>  
 <span data-ttu-id="20bdf-158">Este parâmetro instrui <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> a mantém ou exclui instâncias concluídas.</span><span class="sxs-lookup"><span data-stu-id="20bdf-158">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to either keep or delete completed instances.</span></span> <span data-ttu-id="20bdf-159">Manter instâncias concluídas aumenta os requisitos de armazenamento de base de dados de persistência e condu-los para tabelas maiores, o que aumenta tempo de pesquisa de tabela.</span><span class="sxs-lookup"><span data-stu-id="20bdf-159">Keeping completed instances increases the persistence database storage requirements and leads to larger tables, which increases table lookup times.</span></span> <span data-ttu-id="20bdf-160">A menos que as instâncias concluídas são necessárias depuração ou auditando, é melhor instruir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> para excluir instâncias concluídas.</span><span class="sxs-lookup"><span data-stu-id="20bdf-160">Unless completed instances are required for debugging or auditing, it is best to instruct the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to delete completed instances.</span></span> <span data-ttu-id="20bdf-161">As instâncias excluídas devem ser mantidas somente se o usuário estabelece um processo para eventualmente as remover.</span><span class="sxs-lookup"><span data-stu-id="20bdf-161">Deleted instances should be kept only if the user establishes a process for eventually removing them.</span></span> <span data-ttu-id="20bdf-162">Observe que as chaves de correlação não podem ser reutilizadas como a instância concluída de fluxo de trabalho reside no armazenamento de instância.</span><span class="sxs-lookup"><span data-stu-id="20bdf-162">Note that correlation keys cannot be reused as long as the completed workflow instance resides in the instance store.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>  
 <span data-ttu-id="20bdf-163">Este parâmetro define o máximo intervalo com que <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonda o base de dados de persistência para as instâncias que devem ser carregadas quando uma atividade de <xref:System.Activities.Statements.Delay> expira.</span><span class="sxs-lookup"><span data-stu-id="20bdf-163">This parameter defines the maximum interval with which the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the persistence database for instances that should be loaded when a <xref:System.Activities.Statements.Delay> activity expires.</span></span> <span data-ttu-id="20bdf-164">Se <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> encontrar um timer que expirou no intervalo de pesquisa seguir, diminuirá o intervalo de pesquisa de modo que a votação seguir ocorre direita após o timer expirou.</span><span class="sxs-lookup"><span data-stu-id="20bdf-164">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, it shortens the polling interval so that the next poll will occur right after the timer has expired.</span></span> <span data-ttu-id="20bdf-165">Essa maneira, a instância Store de fluxo de trabalho do SQL obtém uma alta precisão de temporizadores que executam mais tempo de <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="20bdf-165">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span>  
  
 <span data-ttu-id="20bdf-166">Não recomendamos reduzir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, porque isso resulta em uma carga na base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-166">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="20bdf-167">Cada host serviço que usa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sonda o base de dados uma vez por período de detecção.</span><span class="sxs-lookup"><span data-stu-id="20bdf-167">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="20bdf-168">A configuração <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> a um intervalo muito pequeno pode fazer com que o desempenho do sistema diminui se o número de host serviço é grande.</span><span class="sxs-lookup"><span data-stu-id="20bdf-168">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small an interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>  
 <span data-ttu-id="20bdf-169">Este parâmetro define o intervalo com que o host renova o bloqueio na base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-169">This parameter defines the interval with which the host renews its lock in the persistence database.</span></span> <span data-ttu-id="20bdf-170">Reduzir esse intervalo permitirá uma recuperação mais rápido de instâncias de fluxo de trabalho no caso de um host ou um computador falhará.</span><span class="sxs-lookup"><span data-stu-id="20bdf-170">Shortening this interval will enable a quicker recovery of the workflow instances in case a host or computer fails.</span></span> <span data-ttu-id="20bdf-171">Por outro lado, um período curta de renovação de bloqueio aumenta a carga na base de dados de persistência.</span><span class="sxs-lookup"><span data-stu-id="20bdf-171">On the other hand, a short lock renewal period increases the load on the persistence database.</span></span> <span data-ttu-id="20bdf-172">Cada host serviço que usa <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> atualizará os bloqueios na base de dados uma vez por período de renovação.</span><span class="sxs-lookup"><span data-stu-id="20bdf-172">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> will update its locks in the database one time per renewal period.</span></span> <span data-ttu-id="20bdf-173">Se um computador executa muitos host serviço, certifique-se de que a carga causada pela renovação de bloqueio não reduz o desempenho do sistema.</span><span class="sxs-lookup"><span data-stu-id="20bdf-173">If a computer runs many service hosts, make sure that the load caused by lock renewal does not decrease your system's performance.</span></span> <span data-ttu-id="20bdf-174">Se fizer isso, para ver aumentar <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="20bdf-174">If it does, consider increasing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>  
 <span data-ttu-id="20bdf-175">Se ativado, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> tentar de volta para carregar uma instância bloqueado para os próximos 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="20bdf-175">If enabled, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> retries to load a locked instance for the next 30 seconds.</span></span> <span data-ttu-id="20bdf-176">Definir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> a BasicRetry ou a AggressiveRetry se o fluxo de trabalho recebe mais mensagens em um curto período de tempo, e essas mensagens são recebidas por diferentes computadores.</span><span class="sxs-lookup"><span data-stu-id="20bdf-176">Set <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if the workflow receives multiple messages in a short time, and these messages are received by different computers.</span></span>  
  
 <span data-ttu-id="20bdf-177">Porque o mecanismo do tentativa de carregamento não apresenta nenhuma sobrecarga de desempenho como novas tentativas de carregamento não são tentadas, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> deve sempre ser ativado.</span><span class="sxs-lookup"><span data-stu-id="20bdf-177">Because the load retry mechanism does not introduce any performance overhead as long as load retries are not tried, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> should always be enabled.</span></span>
