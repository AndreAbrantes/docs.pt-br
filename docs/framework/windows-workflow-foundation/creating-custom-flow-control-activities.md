---
title: Criando atividades personalizados de controle de fluxo
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 27f409f6-2d1d-4cfb-9765-93eb2ad667d5
caps.latest.revision: "2"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 57c347043d1bbcf239841bc57c6a406cfc9af7f0
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/22/2017
---
# <a name="creating-custom-flow-control-activities"></a><span data-ttu-id="84c26-102">Criando atividades personalizados de controle de fluxo</span><span class="sxs-lookup"><span data-stu-id="84c26-102">Creating custom flow control activities</span></span>
<span data-ttu-id="84c26-103">. .NET Framework contém uma variedade de atividades de controle de fluxo que funcionam da mesma forma as estruturas abstratos de programação (como <xref:System.Activities.Statements.Flowchart>) ou as instruções de programação padrão (como <xref:System.Activities.Statements.If>).</span><span class="sxs-lookup"><span data-stu-id="84c26-103">The .Net Framework contains a variety of flow-control activities that function similarly to abstract programming structures (such as <xref:System.Activities.Statements.Flowchart>)   or to standard programming statements (such as <xref:System.Activities.Statements.If>).</span></span> <span data-ttu-id="84c26-104">Este tópico aborda a arquitetura de um dos projetos de exemplo, [ForEach não genéricos](../../../docs/framework/windows-workflow-foundation/samples/non-generic-foreach.md).</span><span class="sxs-lookup"><span data-stu-id="84c26-104">This topic discusses the architecture of one of the sample projects, [Non-Generic ForEach](../../../docs/framework/windows-workflow-foundation/samples/non-generic-foreach.md).</span></span>  
  
## <a name="creating-the-custom-class"></a><span data-ttu-id="84c26-105">Criando a classe personalizada</span><span class="sxs-lookup"><span data-stu-id="84c26-105">Creating the custom class</span></span>  
 <span data-ttu-id="84c26-106">Como a classe não genérico ForEach precisará agendar atividades filhos, precisará derivar de <xref:System.Activities.NativeActivity>, desde que as atividades que derivam de <xref:System.Workflow.Activities.CodeActivity> não têm essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="84c26-106">Since the Non-Generic ForEach class will need to schedule child activities, it will need to derive from <xref:System.Activities.NativeActivity>, since activities that derive from <xref:System.Workflow.Activities.CodeActivity> do not have this functionality.</span></span>  
  
```  
public sealed class ForEach : NativeActivity  
    {  
```  
  
 <span data-ttu-id="84c26-107">A classe personalizada requer vários membros armazenar os dados que estão sendo usados pela atividade, e fornecer funcionalidade para executar as atividades filhos de atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-107">The custom class requires several members to store data being used by the activity, and to provide functionality to execute the activity’s child activities.</span></span> <span data-ttu-id="84c26-108">Esses membros incluem:</span><span class="sxs-lookup"><span data-stu-id="84c26-108">These members include:</span></span>  
  
-   <span data-ttu-id="84c26-109">`valueEnumerator`: O não público <xref:System.Activities.Variable%601> de tipo <xref:System.Collections.IEnumerator> usado para iterar através da coleção de itens.</span><span class="sxs-lookup"><span data-stu-id="84c26-109">`valueEnumerator`: The non-public <xref:System.Activities.Variable%601> of type <xref:System.Collections.IEnumerator> used to iterate over the collection of items.</span></span> <span data-ttu-id="84c26-110">Esse membro é do tipo <xref:System.Activities.Variable%601> porque ele é usado internamente na atividade, em vez de um argumento ou uma propriedade pública, que são usados se este objeto não ter uma fonte fora da atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-110">This member is of type <xref:System.Activities.Variable%601> because it is used internally in the activity, rather than an argument or public property, which would be used if this object were to have an origin outside the activity.</span></span>  
  
-   <span data-ttu-id="84c26-111">`OnChildComplete`: A propriedade pública de <xref:System.Activities.CompletionCallback> que executa quando cada filho concluir a execução.</span><span class="sxs-lookup"><span data-stu-id="84c26-111">`OnChildComplete`: The public <xref:System.Activities.CompletionCallback> property that executes when each child completes execution.</span></span> <span data-ttu-id="84c26-112">Esse membro é definido como uma propriedade de CLR, desde que o valor não será alterada para instâncias diferentes de atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-112">This member is defined as a CLR property, since its value will not change for different instances of the activity.</span></span>  
  
-   <span data-ttu-id="84c26-113">`Values`: A coleção de entradas usadas para as iterações de atividade filho.</span><span class="sxs-lookup"><span data-stu-id="84c26-113">`Values`: The collection of inputs used for the iterations of the child activity.</span></span> <span data-ttu-id="84c26-114">Esse membro é do tipo <xref:System.Activities.InArgument%601>, desde que a fonte de dados está fora da atividade, mas o conteúdo da coleção não deverão ser alterado durante a execução da atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-114">This member is of type <xref:System.Activities.InArgument%601>, since the origin of the data is outside the activity, but the contents of the collection is not expected to change during the execution of the activity.</span></span> <span data-ttu-id="84c26-115">Se a atividade precisar da funcionalidade de modificar o conteúdo dessa coleção quando a atividade estava executando (para adicionar ou remover atividades, por exemplo), esse membro seria definido como <xref:System.Activities.ActivityAction>, que lhe poderiam ser avaliados em todas as vezes foram acessados, de modo que as alterações eles fiquem disponíveis para a atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-115">If the activity needed the functionality to change the contents of this collection while the activity was executing (to add or remove activities, for instance), this member would have been defined as an <xref:System.Activities.ActivityAction>, which then would have been evaluated every time it was accessed, so that changes would be available to the activity.</span></span>  
  
-   <span data-ttu-id="84c26-116">`Body`: Esse membro define a atividade a ser executada para cada item na coleção de `Values` .</span><span class="sxs-lookup"><span data-stu-id="84c26-116">`Body`: This member defines the activity to be executed for each item in the `Values` collection.</span></span> <span data-ttu-id="84c26-117">Esse membro é definido como <xref:System.Activities.ActivityAction> de modo que ela é avaliado todas as vezes é acessado.</span><span class="sxs-lookup"><span data-stu-id="84c26-117">This member is defined as an <xref:System.Activities.ActivityAction> so that it is evaluated every time it is accessed.</span></span>  
  
-   <span data-ttu-id="84c26-118">`Execute`: Este método usa `InternalExecute`, `OnForEachComplete`, e membros não-públicas de `GetStateAndExecute` para agendar a execução e atribuir o manipulador de conclusão da atividade filho definida no corpo de membro.</span><span class="sxs-lookup"><span data-stu-id="84c26-118">`Execute`: This method uses the `InternalExecute`, `OnForEachComplete`, and `GetStateAndExecute` non-public members to schedule the execution and assign the completion handler of the child activity defined in the Body member.</span></span>  
  
-   <span data-ttu-id="84c26-119">`CacheMetadata`: Esse membro fornece o tempo de execução com as informações necessárias para executar a atividade.</span><span class="sxs-lookup"><span data-stu-id="84c26-119">`CacheMetadata`: This member provides the runtime with the information it needs to execute the activity.</span></span> <span data-ttu-id="84c26-120">Por padrão, o método de `CacheMetadata` de uma atividade informará o tempo de execução de todos os membros públicos de atividade, mas como esta atividade usa membros particulares para algumas funcionalidades, precisa informar o tempo de execução de sua existência de modo que o tempo de execução pode estar ciente deless.</span><span class="sxs-lookup"><span data-stu-id="84c26-120">By default, an activity’s `CacheMetadata` method will inform the runtime of all public members of the activity, but since this activity uses private members for some functionality, it needs to inform the runtime of their existence so that the runtime can be aware of them.</span></span> <span data-ttu-id="84c26-121">Nesse caso, a função de `CacheMetadata` é substituída de modo que o membro particular de `valueEnumerator` pode ser acessado.</span><span class="sxs-lookup"><span data-stu-id="84c26-121">In this case, the `CacheMetadata` function is overridden so that the private `valueEnumerator` member can be accessed.</span></span> <span data-ttu-id="84c26-122">Esse membro também cria um argumento para os valores para atividades de modo que eles possam ser passados à atividade durante a execução.</span><span class="sxs-lookup"><span data-stu-id="84c26-122">This member also creates an argument for the values for the activity so that they can be passed in to the activity during execution.</span></span>
