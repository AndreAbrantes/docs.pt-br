---
title: Usando CancellationScope
ms.date: 03/30/2017
ms.assetid: 39c5c338-b316-43d6-b7fe-a543281dd1ec
ms.openlocfilehash: 82d44fff869f207c09dc7685fc3470630e001a59
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/05/2018
ms.locfileid: "43731515"
---
# <a name="using-cancellationscope"></a><span data-ttu-id="ff584-102">Usando CancellationScope</span><span class="sxs-lookup"><span data-stu-id="ff584-102">Using CancellationScope</span></span>
<span data-ttu-id="ff584-103">Este exemplo demonstra como usar a atividade de <xref:System.Activities.Statements.CancellationScope> para cancelar o trabalho em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ff584-103">This sample demonstrates how to use the <xref:System.Activities.Statements.CancellationScope> activity to cancel work in an application.</span></span>  
  
 <span data-ttu-id="ff584-104">Muitos componentes e serviços de camada intermediária dependem de compilação conhecido de programação de transações para manipular o cancelar para eles.</span><span class="sxs-lookup"><span data-stu-id="ff584-104">Many middle tier components and services rely on the well-known programming construct of transactions to handle cancellation for them.</span></span>  <span data-ttu-id="ff584-105">No entanto, há muitas situações em que o trabalho que não pode ser feito em uma transação deve ser cancelado.</span><span class="sxs-lookup"><span data-stu-id="ff584-105">However, there are many situations in which work that cannot be done in a transaction must be canceled.</span></span>  <span data-ttu-id="ff584-106">Usar o botão é mais difícil de usar transações, porque o trabalho que deve ser cancelado deve primeiro ser controlado.</span><span class="sxs-lookup"><span data-stu-id="ff584-106">Using cancellation is more difficult than using transactions, because work that must be canceled must first be tracked.</span></span> [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]<span data-ttu-id="ff584-107"> ajuda você com o isto fornecendo uma atividade de <xref:System.Activities.Statements.CancellationScope> .</span><span class="sxs-lookup"><span data-stu-id="ff584-107"> helps you with this by providing a <xref:System.Activities.Statements.CancellationScope> activity.</span></span>  
  
 <span data-ttu-id="ff584-108">Cancelamento pode ser disparado de uma atividade ou pai da atividade.</span><span class="sxs-lookup"><span data-stu-id="ff584-108">Cancellation can be triggered either from within an activity or from the activity's parent.</span></span>  <span data-ttu-id="ff584-109">As atividades filho são agendadas pela atividade pai (como <xref:System.Activities.Statements.Sequence>, <xref:System.Activities.Statements.Parallel>, <xref:System.Activities.Statements.Flowchart>, ou uma atividade composto personalizado).</span><span class="sxs-lookup"><span data-stu-id="ff584-109">Child activities are scheduled by their parent activity (such as a <xref:System.Activities.Statements.Sequence>, <xref:System.Activities.Statements.Parallel>, <xref:System.Activities.Statements.Flowchart>, or a custom composite activity).</span></span>  <span data-ttu-id="ff584-110">A atividade pai pode cancelar atividades filho por alguma razão.</span><span class="sxs-lookup"><span data-stu-id="ff584-110">The parent activity can cancel child activities for any reason.</span></span>  <span data-ttu-id="ff584-111">Por exemplo, uma atividade de <xref:System.Activities.Statements.Parallel> com três ramificações filhos cancelará as ramificações filhos restantes sempre que conclui uma ramificação e a expressão de <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> avalia a `true`.</span><span class="sxs-lookup"><span data-stu-id="ff584-111">For example, a <xref:System.Activities.Statements.Parallel> activity with three child branches will cancel the remaining child branches whenever it completes a branch and the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> expression evaluates to `true`.</span></span> <span data-ttu-id="ff584-112">O fluxo de trabalho também pode ser cancelado externamente pelo aplicativo host chamando <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="ff584-112">The workflow can also be canceled externally by the host application by calling <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span>  
  
 <span data-ttu-id="ff584-113">Para usar a atividade de <xref:System.Activities.Statements.CancellationScope> , coloque o trabalho que precisa ser cancelado na propriedade de <xref:System.Activities.Statements.CancellationScope.Body%2A> , e colocar o trabalho que é executado após o botão na propriedade de <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> .</span><span class="sxs-lookup"><span data-stu-id="ff584-113">To use the <xref:System.Activities.Statements.CancellationScope> activity, put the work that needs to be canceled into the <xref:System.Activities.Statements.CancellationScope.Body%2A> property, and put the work that is performed after cancellation into the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> property.</span></span>  
  
 <span data-ttu-id="ff584-114">Este exemplo demonstra cancelar uma atividade de dentro da atividade própria.</span><span class="sxs-lookup"><span data-stu-id="ff584-114">This sample demonstrates cancelling an activity from within the activity itself.</span></span>  
  
 <span data-ttu-id="ff584-115">O cenário que o exemplo usa para demonstrar a atividade de <xref:System.Activities.Statements.CancellationScope> é um cliente que deseja comprar o mais rápido possível um tíquete a Miami.</span><span class="sxs-lookup"><span data-stu-id="ff584-115">The scenario that the sample uses to demonstrate the <xref:System.Activities.Statements.CancellationScope> activity is a client wanting to buy a ticket to Miami as soon as possible.</span></span> <span data-ttu-id="ff584-116">Há duas agências de processamento que desejam o negócio.</span><span class="sxs-lookup"><span data-stu-id="ff584-116">There are two travel agencies that want the business.</span></span> <span data-ttu-id="ff584-117">O exemplo usa dois <xref:System.Activities.Statements.CancellationScope> dentro de uma atividade de <xref:System.Activities.Statements.Parallel> para modelar essa lógica comercial.</span><span class="sxs-lookup"><span data-stu-id="ff584-117">The sample uses two <xref:System.Activities.Statements.CancellationScope> within a <xref:System.Activities.Statements.Parallel> activity to model this business logic.</span></span> <span data-ttu-id="ff584-118"><xref:System.Activities.Statements.Parallel.CompletionCondition%2A> de atividade de <xref:System.Activities.Statements.Parallel> é definido como `true`; desde que <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> é verificado após qualquer ramificação concluir, isso fará com o restante a ramificação ser cancelado após o primeiro ramificação completa.</span><span class="sxs-lookup"><span data-stu-id="ff584-118">The <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> of the <xref:System.Activities.Statements.Parallel> activity is set to `true`; since the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> is checked after any branch completes, this will cause the remaining branch to be canceled after the first branch completes.</span></span> <span data-ttu-id="ff584-119">O aplicativo cliente solicita que ambas as agências comprem a permissão, e quando primeiro confirma que o tíquete foi comprado, o aplicativo cancela a ordem na outra agência.</span><span class="sxs-lookup"><span data-stu-id="ff584-119">The client application asks both agencies to buy the ticket, and when the first one confirms that the ticket has been bought, the application cancels the order at the other agency.</span></span>  
  
## <a name="to-use-this-sample"></a><span data-ttu-id="ff584-120">Para usar este exemplo</span><span class="sxs-lookup"><span data-stu-id="ff584-120">To use this sample</span></span>  
  
1.  <span data-ttu-id="ff584-121">Usando [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], abra o arquivo de solução de CancelationScopeXAML.sln.</span><span class="sxs-lookup"><span data-stu-id="ff584-121">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the CancelationScopeXAML.sln solution file.</span></span>  
  
2.  <span data-ttu-id="ff584-122">Para criar a solução, pressione CTRL+SHIFT+B.</span><span class="sxs-lookup"><span data-stu-id="ff584-122">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="ff584-123">Para executar a solução, pressione CTRL+F5.</span><span class="sxs-lookup"><span data-stu-id="ff584-123">To run the solution, press CTRL+F5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ff584-124">Os exemplos podem já estar instalados no seu computador.</span><span class="sxs-lookup"><span data-stu-id="ff584-124">The samples may already be installed on your machine.</span></span> <span data-ttu-id="ff584-125">Verifique o seguinte diretório (padrão) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="ff584-125">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="ff584-126">Se este diretório não existir, vá para [Windows Communication Foundation (WCF) e o Windows Workflow Foundation (WF) exemplos do .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para baixar todos os Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemplos.</span><span class="sxs-lookup"><span data-stu-id="ff584-126">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="ff584-127">Este exemplo está localizado no seguinte diretório.</span><span class="sxs-lookup"><span data-stu-id="ff584-127">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Built-InActivities\CancellationScope`