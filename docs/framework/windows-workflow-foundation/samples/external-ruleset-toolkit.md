---
title: Kit de ferramentas de Ruleset externo
ms.date: 03/30/2017
ms.assetid: a306d283-a031-475e-aa01-9ae86e7adcb0
ms.openlocfilehash: f545d083bb6caf9daca3ce553d0a1ee6711b0062
ms.sourcegitcommit: 69229651598b427c550223d3c58aba82e47b3f82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/04/2018
ms.locfileid: "48584254"
---
# <a name="external-ruleset-toolkit"></a><span data-ttu-id="9b42d-102">Kit de ferramentas de Ruleset externo</span><span class="sxs-lookup"><span data-stu-id="9b42d-102">External Ruleset Toolkit</span></span>
<span data-ttu-id="9b42d-103">Normalmente quando as regras são usadas em um aplicativo de fluxo de trabalho, as regras são parte do assembly.</span><span class="sxs-lookup"><span data-stu-id="9b42d-103">Normally when rules are used within a workflow application, the rules are part of the assembly.</span></span> <span data-ttu-id="9b42d-104">Em algumas situações, convém manter o RuleSets separada do assembly de modo que eles possam ser atualizados sem recriar e implantar o assembly de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9b42d-104">In some scenarios, you may want to maintain the RuleSets separately from the assembly so that they can be updated without rebuilding and deploying the workflow assembly.</span></span> <span data-ttu-id="9b42d-105">Este exemplo permite que você gerencie e edite RuleSets em uma base de dados e acesse o RuleSets de um fluxo de trabalho em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="9b42d-105">This sample allows you to manage and edit RuleSets in a database and access those RuleSets from a workflow at runtime.</span></span> <span data-ttu-id="9b42d-106">Isso permite que instâncias em execução de fluxo de trabalho para inserir automaticamente alterações de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-106">This enables running workflow instances to automatically incorporate RuleSet changes.</span></span>

 <span data-ttu-id="9b42d-107">O exemplo externo do kit de ferramentas de RuleSet contém uma ferramenta baseada em Windows que você pode usar para gerenciar e editar versões de RuleSet em uma base de dados.</span><span class="sxs-lookup"><span data-stu-id="9b42d-107">The External RuleSet Toolkit sample contains a Windows Forms-based tool that you can use to manage and edit RuleSet versions in a database.</span></span> <span data-ttu-id="9b42d-108">Ele também inclui uma atividade e um serviço de hospedagem para executar essas regras.</span><span class="sxs-lookup"><span data-stu-id="9b42d-108">It also includes an activity and a host service for executing those rules.</span></span>

> [!NOTE]
>  <span data-ttu-id="9b42d-109">Este exemplo requer [Microsoft SQL Server](https://go.microsoft.com/fwlink/?LinkId=96181).</span><span class="sxs-lookup"><span data-stu-id="9b42d-109">This sample requires [Microsoft SQL Server](https://go.microsoft.com/fwlink/?LinkId=96181).</span></span>  
  
 <span data-ttu-id="9b42d-110">Visual Studio fornece um editor de RuleSet como parte do Windows Workflow Foundation (WF).</span><span class="sxs-lookup"><span data-stu-id="9b42d-110">Visual Studio provides a RuleSet editor as part of the Windows Workflow Foundation (WF).</span></span> <span data-ttu-id="9b42d-111">Você pode iniciar o editor clicando duas vezes na atividade de `Policy` em um fluxo de trabalho; serializa o objeto definido de RuleSet para o arquivo de .rules associado com o fluxo de trabalho (uma atividade de `Policy` executa uma instância de RuleSet contra o fluxo de trabalho).</span><span class="sxs-lookup"><span data-stu-id="9b42d-111">You can start this editor by double-clicking the `Policy` activity in a workflow; it serializes the defined RuleSet object to the .rules file associated with the workflow (a `Policy` activity runs a RuleSet instance against the workflow).</span></span> <span data-ttu-id="9b42d-112">O arquivo de .rules é compilado no assembly como um recurso quando você compila o projeto de fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9b42d-112">The .rules file is compiled into the assembly as a resource when you build the workflow project.</span></span>  
  
 <span data-ttu-id="9b42d-113">Componentes deste exemplo incluem:</span><span class="sxs-lookup"><span data-stu-id="9b42d-113">The components of this sample include:</span></span>  
  
-   <span data-ttu-id="9b42d-114">Uma ferramenta de interface gráfica do usuário de RuleSet que você pode usar para editar e gerenciar versões de RuleSet na base de dados.</span><span class="sxs-lookup"><span data-stu-id="9b42d-114">A RuleSet graphical user interface tool that you can use to edit and manage RuleSet versions in the database.</span></span>  
  
-   <span data-ttu-id="9b42d-115">Um serviço de RuleSet que é configurado no aplicativo host e acesse RuleSets de base de dados.</span><span class="sxs-lookup"><span data-stu-id="9b42d-115">A RuleSet service that is configured on the host application and accesses RuleSets from the database.</span></span>  
  
-   <span data-ttu-id="9b42d-116">Uma atividade de `ExternalPolicy` que é um RuleSet de serviço de RuleSet e executa o RuleSet contra o fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9b42d-116">An `ExternalPolicy` activity that requests a RuleSet from the RuleSet service and runs the RuleSet against the workflow.</span></span>  
  
 <span data-ttu-id="9b42d-117">A interação de componentes é mostrada na figura 1.</span><span class="sxs-lookup"><span data-stu-id="9b42d-117">The interaction of the components is shown in Figure 1.</span></span> <span data-ttu-id="9b42d-118">As seções a seguir descrevem cada componente.</span><span class="sxs-lookup"><span data-stu-id="9b42d-118">The sections that follow describe each component.</span></span>  
  
 <span data-ttu-id="9b42d-119">![Visão geral conceitual de exemplo de RuleSet externo](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesettoolkitsampleoverview.gif "RuleSetToolkitSampleOverview")</span><span class="sxs-lookup"><span data-stu-id="9b42d-119">![External RuleSet Sample Conceptual Overview](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesettoolkitsampleoverview.gif "RuleSetToolkitSampleOverview")</span></span>  
  
 <span data-ttu-id="9b42d-120">Figure 1: Visão geral de exemplo</span><span class="sxs-lookup"><span data-stu-id="9b42d-120">Figure 1: Sample Overview</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="9b42d-121">Os exemplos podem já estar instalados no seu computador.</span><span class="sxs-lookup"><span data-stu-id="9b42d-121">The samples may already be installed on your machine.</span></span> <span data-ttu-id="9b42d-122">Verifique o seguinte diretório (padrão) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="9b42d-122">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="9b42d-123">Se este diretório não existir, vá para [Windows Communication Foundation (WCF) e o Windows Workflow Foundation (WF) exemplos do .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para baixar todos os Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemplos.</span><span class="sxs-lookup"><span data-stu-id="9b42d-123">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="9b42d-124">Este exemplo está localizado no seguinte diretório.</span><span class="sxs-lookup"><span data-stu-id="9b42d-124">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Scenario\ExternalRuleSetToolKit`  
  
## <a name="ruleset-tool"></a><span data-ttu-id="9b42d-125">Ferramenta de RuleSet</span><span class="sxs-lookup"><span data-stu-id="9b42d-125">RuleSet Tool</span></span>  
 <span data-ttu-id="9b42d-126">Uma tela da ferramenta de RuleSet é mostrada na figura 2.</span><span class="sxs-lookup"><span data-stu-id="9b42d-126">A screen shot of the RuleSet tool is shown in Figure 2.</span></span> <span data-ttu-id="9b42d-127">Dos **regra Store** menu, você pode carregar o RuleSets disponível do banco de dados e salvar RuleSets modificado de volta para o armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9b42d-127">From the **Rule Store** menu, you can load the available RuleSets from the database and save modified RuleSets back to the store.</span></span> <span data-ttu-id="9b42d-128">Um arquivo de configuração do aplicativo fornece uma cadeia de caracteres de conexão de base de dados para o base de dados de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-128">An application configuration file provides a database connection string for the RuleSet database.</span></span> <span data-ttu-id="9b42d-129">Quando você inicia a ferramenta, carrega automaticamente o RuleSets de base de dados configurado.</span><span class="sxs-lookup"><span data-stu-id="9b42d-129">When you start the tool, it automatically loads the RuleSets from the configured database.</span></span>  
  
 <span data-ttu-id="9b42d-130">![Saída de exemplo do Kit de ferramentas de RuleSet externa](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesetbrowser.gif "RuleSetBrowser")</span><span class="sxs-lookup"><span data-stu-id="9b42d-130">![External RuleSet Toolket Sample output](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesetbrowser.gif "RuleSetBrowser")</span></span>  
  
 <span data-ttu-id="9b42d-131">Figure 2: Navegador de RuleSet</span><span class="sxs-lookup"><span data-stu-id="9b42d-131">Figure 2: RuleSet Browser</span></span>  
  
 <span data-ttu-id="9b42d-132">A ferramenta de RuleSet aplica o versão e números de versão secundária ao RuleSets, permitindo que você mantém simultaneamente e versões de armazenamento várias (a ferramenta não fornecer nenhum bloqueio ou outros recursos de gerenciamento de configuração além do recurso de controle de versão).</span><span class="sxs-lookup"><span data-stu-id="9b42d-132">The RuleSet tool applies major and minor version numbers to the RuleSets, allowing you to simultaneously maintain and store multiple versions (the tool provides no locking or other configuration management features in addition to the versioning capability).</span></span> <span data-ttu-id="9b42d-133">Usando a ferramenta, você pode criar novas versões de RuleSet ou excluir versões existentes.</span><span class="sxs-lookup"><span data-stu-id="9b42d-133">Using the tool, you can create new RuleSet versions or delete existing versions.</span></span> <span data-ttu-id="9b42d-134">Quando você clica em **New**, a ferramenta cria um novo nome de RuleSet e aplica-se a versão 1.0.</span><span class="sxs-lookup"><span data-stu-id="9b42d-134">When you click **New**, the tool creates a new RuleSet name and applies version 1.0.</span></span> <span data-ttu-id="9b42d-135">Quando você copiar uma versão, a ferramenta cria uma cópia da versão de RuleSet selecionada, incluindo as regras contidas, e atribuir novos, números de versão exclusivos.</span><span class="sxs-lookup"><span data-stu-id="9b42d-135">When you copy a version, the tool creates a copy of the selected RuleSet version, including the contained rules, and assigns new, unique version numbers.</span></span> <span data-ttu-id="9b42d-136">Esses números de versão são baseados em números de versão de RuleSets existente.</span><span class="sxs-lookup"><span data-stu-id="9b42d-136">These version numbers are based on the version numbers of existing RuleSets.</span></span> <span data-ttu-id="9b42d-137">Você pode alterar o nome e números de versão de RuleSet usando os campos associados no formulário.</span><span class="sxs-lookup"><span data-stu-id="9b42d-137">You can change the RuleSet name and version numbers using the associated fields on the form.</span></span>  
  
 <span data-ttu-id="9b42d-138">Quando você clica em **editar regras de**, inicia o editor de RuleSet, conforme mostrado na Figura 3.</span><span class="sxs-lookup"><span data-stu-id="9b42d-138">When you click **Edit Rules**, the RuleSet editor starts, as shown in Figure 3.</span></span>  
  
 <span data-ttu-id="9b42d-139">![Saída de exemplo do Kit de ferramentas de RuleSet externo](../../../../docs/framework/windows-workflow-foundation/samples/media/ruleseteditor.gif "RuleSetEditor")</span><span class="sxs-lookup"><span data-stu-id="9b42d-139">![External RuleSet Toolkit Sample Output](../../../../docs/framework/windows-workflow-foundation/samples/media/ruleseteditor.gif "RuleSetEditor")</span></span>  
  
 <span data-ttu-id="9b42d-140">Figure 3: Editor de RuleSet</span><span class="sxs-lookup"><span data-stu-id="9b42d-140">Figure 3: RuleSet Editor</span></span>  
  
 <span data-ttu-id="9b42d-141">Isso é novamente hospedar da caixa de diálogo editor que faz parte do suplemento do Visual Studio do Windows Workflow Foundation.</span><span class="sxs-lookup"><span data-stu-id="9b42d-141">This is a re-hosting of the editor dialog that is part of the Windows Workflow Foundation Visual Studio add-in.</span></span> <span data-ttu-id="9b42d-142">Fornece a mesma funcionalidade, incluindo suporte Intellisense.</span><span class="sxs-lookup"><span data-stu-id="9b42d-142">It provides the same functionality, including Intellisense support.</span></span> <span data-ttu-id="9b42d-143">As regras são criadas em relação a um tipo de destino (por exemplo, um fluxo de trabalho) que está associado com o RuleSet na ferramenta; Quando você clica em **navegue** na caixa de diálogo de ferramentas principal, o **seletor de fluxo de trabalho/tipo** caixa de diálogo é exibida, conforme mostrado na Figura 4.</span><span class="sxs-lookup"><span data-stu-id="9b42d-143">The rules are authored against a target type (such as a workflow) that is associated with the RuleSet in the tool; when you click **Browse** in the main tool dialog, the **Workflow/Type Selector** dialog appears, as shown in Figure 4.</span></span>  
  
 <span data-ttu-id="9b42d-144">![Fluxo de trabalho &#47;tipo de seleção](../../../../docs/framework/windows-workflow-foundation/samples/media/71f08d57-e8f2-499e-8151-ece2cbdcabfd.gif "71f08d57-e8f2-499e-8151-ece2cbdcabfd")</span><span class="sxs-lookup"><span data-stu-id="9b42d-144">![Workflow &#47;Type Selection](../../../../docs/framework/windows-workflow-foundation/samples/media/71f08d57-e8f2-499e-8151-ece2cbdcabfd.gif "71f08d57-e8f2-499e-8151-ece2cbdcabfd")</span></span>  
  
 <span data-ttu-id="9b42d-145">Figure 4: Seletor de fluxo de trabalho/tipo</span><span class="sxs-lookup"><span data-stu-id="9b42d-145">Figure 4: Workflow/Type Selector</span></span>  
  
 <span data-ttu-id="9b42d-146">Você pode usar o **seletor de fluxo de trabalho/tipo** caixa de diálogo para especificar um assembly e um tipo específico dentro desse assembly.</span><span class="sxs-lookup"><span data-stu-id="9b42d-146">You can use the **Workflow/Type Selector** dialog to specify an assembly and a specific type within that assembly.</span></span> <span data-ttu-id="9b42d-147">Esse tipo é o tipo de destino com que as regras são criadas (e execução).</span><span class="sxs-lookup"><span data-stu-id="9b42d-147">This type is the target type against which the rules are authored (and run).</span></span> <span data-ttu-id="9b42d-148">Em muitos casos, o tipo de destino é um fluxo de trabalho ou qualquer outro tipo de atividade.</span><span class="sxs-lookup"><span data-stu-id="9b42d-148">In many cases, the target type is a workflow or some other activity type.</span></span> <span data-ttu-id="9b42d-149">No entanto, você pode executar um RuleSet contra qualquer tipo .NET.</span><span class="sxs-lookup"><span data-stu-id="9b42d-149">However, you can run a RuleSet against any .NET type.</span></span>  
  
 <span data-ttu-id="9b42d-150">O caminho para o arquivo do assembly e o tipo `name are stored with the` conjunto de regras no banco de dados, para que quando o conjunto de regras é recuperado do banco de dados, a ferramenta tentará carregar automaticamente o tipo de destino.</span><span class="sxs-lookup"><span data-stu-id="9b42d-150">The path to the assembly file and the type `name are stored with the` RuleSet in the database, so that when the RuleSet is retrieved from the database, the tool attempts to automatically load the target type.</span></span>  
  
 <span data-ttu-id="9b42d-151">Quando você clica em **Okey** na **seletor de fluxo de trabalho/tipo** caixa de diálogo, ele valida o tipo selecionado no RuleSet, para garantir que o tipo de destino tem todos os membros referenciados por regras.</span><span class="sxs-lookup"><span data-stu-id="9b42d-151">When you click **OK** in the **Workflow/Type Selector** dialog, it validates the selected type against the RuleSet, to ensure that the target type has all the members referenced by the rules.</span></span> <span data-ttu-id="9b42d-152">Os erros são mostrados em um **erros de validação** caixa de diálogo (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="9b42d-152">Errors are shown in a **Validation Errors** dialog (see Figure 5).</span></span> <span data-ttu-id="9b42d-153">Você pode optar por continuar com a alteração, apesar dos erros ou clique em **Cancelar**.</span><span class="sxs-lookup"><span data-stu-id="9b42d-153">You can choose to continue with the change despite the errors, or click **Cancel**.</span></span> <span data-ttu-id="9b42d-154">Dos **ferramentas** menu, na caixa de diálogo de ferramentas principal, você pode clicar em **validar** novamente para validar a versão de RuleSet contra a atividade de destino.</span><span class="sxs-lookup"><span data-stu-id="9b42d-154">From the **Tools** menu in the main tool dialog, you can click **Validate** to re-validate the RuleSet version against the target activity.</span></span>  
  
 <span data-ttu-id="9b42d-155">![Erros de validação do exemplo de RuleSet externo](../../../../docs/framework/windows-workflow-foundation/samples/media/validationerrorsruleset.png "ValidationErrorsRuleSet")</span><span class="sxs-lookup"><span data-stu-id="9b42d-155">![Validation Errors from External RuleSet Sample](../../../../docs/framework/windows-workflow-foundation/samples/media/validationerrorsruleset.png "ValidationErrorsRuleSet")</span></span>  
  
 <span data-ttu-id="9b42d-156">Figure 5: Erros de validação</span><span class="sxs-lookup"><span data-stu-id="9b42d-156">Figure 5: Validation Errors</span></span>  
  
 <span data-ttu-id="9b42d-157">Dos **dados** menu na ferramenta, você pode importar e exportar conjuntos de regras.</span><span class="sxs-lookup"><span data-stu-id="9b42d-157">From the **Data** menu in the tool, you can import and export RuleSets.</span></span> <span data-ttu-id="9b42d-158">Quando você clica em **importação**, aparece uma caixa de diálogo do seletor de arquivos, na qual você pode selecionar um arquivo. rules.</span><span class="sxs-lookup"><span data-stu-id="9b42d-158">When you click **Import**, a file-chooser dialog appears, from which you can select a .rules file.</span></span> <span data-ttu-id="9b42d-159">Isso pode ou não ser um arquivo criado inicialmente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="9b42d-159">This may or may not be a file initially created in Visual Studio.</span></span> <span data-ttu-id="9b42d-160">O arquivo de .rules deve conter uma instância serializada de `RuleDefinitions` que contém uma coleção de condições e uma coleção de RuleSets.</span><span class="sxs-lookup"><span data-stu-id="9b42d-160">The .rules file should contain a serialized `RuleDefinitions` instance that contains a collection of conditions and a collection of RuleSets.</span></span> <span data-ttu-id="9b42d-161">A ferramenta não usa a coleção de condições, mas ele usa o `RuleDefinitions` formato. rules para permitir a interação com o ambiente do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="9b42d-161">The tool does not use the conditions collection, but it does use the `RuleDefinitions` .rules format to allow interaction with the Visual Studio environment.</span></span>  
  
 <span data-ttu-id="9b42d-162">Depois de selecionar um arquivo. Rules, uma **seletor de RuleSet** caixa de diálogo aparece (veja a Figura 6).</span><span class="sxs-lookup"><span data-stu-id="9b42d-162">After selecting a .rules file, a **RuleSet Selector** dialog appears (see Figure 6).</span></span> <span data-ttu-id="9b42d-163">Você pode usar a caixa de diálogo para selecionar o RuleSets do arquivo que você deseja importar (a opção especificar qualquer RuleSets).</span><span class="sxs-lookup"><span data-stu-id="9b42d-163">You can use the dialog to select the RuleSets from the file that you want to import (the default specifies all RuleSets).</span></span> <span data-ttu-id="9b42d-164">RuleSets no arquivo de .rules não tem números de versão, porque o controle de versão em um projeto de WF é o mesmo que a versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="9b42d-164">RuleSets in the .rules file do not have version numbers, because their versioning within a WF project is the same as the version of the assembly.</span></span> <span data-ttu-id="9b42d-165">Durante o processo de importação, a ferramenta atribui automaticamente o próximo número de versão principal disponível (que pode ser alterado depois de importar); Você pode ver os números de versão atribuídos na **seletor de RuleSet** lista.</span><span class="sxs-lookup"><span data-stu-id="9b42d-165">During the importing process, the tool automatically assigns the next available major version number (which you can change after importing); you can see the assigned version numbers in the **RuleSet Selector** list.</span></span>  
  
 <span data-ttu-id="9b42d-166">Para cada RuleSet importa, tentativas da ferramenta de localizar o tipo associado bin \ debug no local do arquivo de .rules (se existir), com base nos membros usados no RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-166">For each RuleSet it imports, the tool attempts to locate the associated type from the bin\Debug folder under the location of the .rules file (if it exists), based on the members used in the RuleSet.</span></span> <span data-ttu-id="9b42d-167">Se a ferramenta encontrar vários tipos de correspondência, tentar escolha um tipo com base em uma correspondência entre o nome de arquivo .rules e o nome do tipo (por exemplo, o tipo de `Workflow1` corresponde a Workflow1.rules).</span><span class="sxs-lookup"><span data-stu-id="9b42d-167">If the tool finds multiple matching types, it attempts to choose a type based on a match between the .rules file name and the type name (for example, the `Workflow1` type corresponds to Workflow1.rules).</span></span> <span data-ttu-id="9b42d-168">Se as correspondências múltiplas existirem, você será solicitado para selecionar o tipo.</span><span class="sxs-lookup"><span data-stu-id="9b42d-168">If multiple matches exist, you are prompted to select the type.</span></span> <span data-ttu-id="9b42d-169">Se esse mecanismo de identificação automática não consegue localizar um assembly ou um tipo de correspondência, após a importação, você pode clicar **procurar** na caixa de diálogo principal ferramenta para navegar para o tipo associado.</span><span class="sxs-lookup"><span data-stu-id="9b42d-169">If this auto-identification mechanism fails to locate a matching assembly or type, then after importing you can click **Browse** on the main tool dialog to navigate to the associated type.</span></span>  
  
 <span data-ttu-id="9b42d-170">![Seletor de RuleSet](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesetselector.gif "RuleSetSelector")</span><span class="sxs-lookup"><span data-stu-id="9b42d-170">![Ruleset selector](../../../../docs/framework/windows-workflow-foundation/samples/media/rulesetselector.gif "RuleSetSelector")</span></span>  
  
 <span data-ttu-id="9b42d-171">Figure 6: Seletor de RuleSet</span><span class="sxs-lookup"><span data-stu-id="9b42d-171">Figure 6: RuleSet Selector</span></span>  
  
 <span data-ttu-id="9b42d-172">Quando você clica em **exportação de dados** no menu de ferramentas principal, o **seletor de RuleSet** caixa de diálogo será exibida novamente, do qual você pode determinar o RuleSets do banco de dados que deve ser exportado.</span><span class="sxs-lookup"><span data-stu-id="9b42d-172">When you click **Data-Export** from the main tool menu, the **RuleSet Selector** dialog appears again, from which you can determine the RuleSets from the database that should be exported.</span></span> <span data-ttu-id="9b42d-173">Quando você clica em **Okey**, um **salvar arquivo** caixa de diálogo for exibida, na qual você pode especificar o nome e local do arquivo. Rules resultante.</span><span class="sxs-lookup"><span data-stu-id="9b42d-173">When you click **OK**, a **Save File** dialog appears, in which you can specify the name and location of the resulting .rules file.</span></span> <span data-ttu-id="9b42d-174">Porque o arquivo de .rules não contém informações de versão, você pode selecionar apenas uma versão de RuleSet com um determinado nome de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-174">Because the .rules file does not contain version information, you can only select one RuleSet version with a given RuleSet name.</span></span>  
  
## <a name="policyfromservice-activity"></a><span data-ttu-id="9b42d-175">Atividade de PolicyFromService</span><span class="sxs-lookup"><span data-stu-id="9b42d-175">PolicyFromService Activity</span></span>  
 <span data-ttu-id="9b42d-176">O código para atividades de `PolicyFromService` é simples.</span><span class="sxs-lookup"><span data-stu-id="9b42d-176">The code for the `PolicyFromService` activity is straightforward.</span></span> <span data-ttu-id="9b42d-177">Funciona bem como a atividade de `Policy` fornecida com o WF, mas em vez de recuperar o destino RuleSet do arquivo de .rules, chama um serviço de hospedagem para obter a instância de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-177">It works much like the `Policy` activity provided with WF, but instead of retrieving the target RuleSet from the .rules file, it calls a host service to obtain the RuleSet instance.</span></span> <span data-ttu-id="9b42d-178">Execute o RuleSet contra a instância de atividade de fluxo de trabalho de raiz.</span><span class="sxs-lookup"><span data-stu-id="9b42d-178">It then runs the RuleSet against the root workflow activity instance.</span></span>  
  
 <span data-ttu-id="9b42d-179">Para usar a atividade em um fluxo de trabalho, adicione uma referência a `PolicyActivities` e assemblies de `RuleSetService` do fluxo de trabalho projeto.</span><span class="sxs-lookup"><span data-stu-id="9b42d-179">To use the activity in a workflow, add a reference to the `PolicyActivities` and `RuleSetService` assemblies from your workflow project.</span></span> <span data-ttu-id="9b42d-180">Consulte o procedimento no final deste tópico para uma discussão sobre como adicionar a atividade a caixa de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="9b42d-180">See the procedure at the end of this topic for a discussion of how to add the activity to the toolbox.</span></span>  
  
 <span data-ttu-id="9b42d-181">Após a atividade colocado no fluxo de trabalho, você deve fornecer o nome de RuleSet a ser executado.</span><span class="sxs-lookup"><span data-stu-id="9b42d-181">After placing the activity in your workflow, you must provide the name of the RuleSet to be run.</span></span> <span data-ttu-id="9b42d-182">Você pode inserir o nome como um valor literal, ou o associar a uma variável de fluxo de trabalho ou propriedade de outra atividade.</span><span class="sxs-lookup"><span data-stu-id="9b42d-182">You can enter the name as a literal value, or bind to a workflow variable or property of another activity.</span></span> <span data-ttu-id="9b42d-183">Opcionalmente, você pode digitar números de versão para o RuleSet específico que deve ser executado.</span><span class="sxs-lookup"><span data-stu-id="9b42d-183">Optionally, you can enter version numbers for the specific RuleSet that should be run.</span></span> <span data-ttu-id="9b42d-184">Se você deixar o valor padrão de 0 para os números de versão principal e secundário, o número de versão do último na base de dados é fornecida automaticamente para atividades.</span><span class="sxs-lookup"><span data-stu-id="9b42d-184">If you leave the default value of 0 for the major and minor version numbers, the latest version number in the database is automatically provided for the activity.</span></span>  
  
## <a name="ruleset-service"></a><span data-ttu-id="9b42d-185">Serviço de RuleSet</span><span class="sxs-lookup"><span data-stu-id="9b42d-185">RuleSet Service</span></span>  
 <span data-ttu-id="9b42d-186">O serviço é responsável por recuperar a versão especificada de RuleSet de base de dados dados e a atividade de chamada.</span><span class="sxs-lookup"><span data-stu-id="9b42d-186">The service is responsible for retrieving the specified RuleSet version from the database and returning it to the calling activity.</span></span> <span data-ttu-id="9b42d-187">Como discutido anteriormente, se os valores de versão principal e versão secundária passados na chamada de `GetRuleSet` são ambos 0, o serviço recupera a versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="9b42d-187">As previously discussed, if the major and minor version values passed in the `GetRuleSet` call are both 0, the service retrieves the latest version.</span></span> <span data-ttu-id="9b42d-188">Neste ponto, não há cachê de definições ou de instâncias de RuleSet; da mesma forma, não há nenhum recurso para marcar versões de RuleSet como “implantado para” diferenciá-las de RuleSets em andamento.</span><span class="sxs-lookup"><span data-stu-id="9b42d-188">At this point, there is no caching of RuleSet definitions or instances; similarly, there are no features for marking RuleSet versions as "deployed" to differentiate them from in-progress RuleSets.</span></span>  
  
 <span data-ttu-id="9b42d-189">O base de dados a ser acessado pelo serviço deve ser configurado no host que usa um arquivo de configuração do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9b42d-189">The database to be accessed by the service should be configured on the host using an application configuration file.</span></span>  
  
#### <a name="to-run-the-tool"></a><span data-ttu-id="9b42d-190">Para executar a ferramenta</span><span class="sxs-lookup"><span data-stu-id="9b42d-190">To run the tool</span></span>  
  
1.  <span data-ttu-id="9b42d-191">A pasta que configura a tabela de RuleSet usado pela ferramenta e o serviço contém um arquivo de Setup.sql.</span><span class="sxs-lookup"><span data-stu-id="9b42d-191">The folder that sets up the RuleSet table used by the tool and the service contains a Setup.sql file.</span></span> <span data-ttu-id="9b42d-192">Você pode executar o arquivo em lotes de Setup.cmd para criar o base de dados de regras em SQL express e configurar a tabela de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-192">You can run the Setup.cmd batch file to create the Rules database on SQL Express and to set up the RuleSet table.</span></span>  
  
2.  <span data-ttu-id="9b42d-193">Se você editar o arquivo em lotes ou o Setup.sql e os especifica para não usar o SQL express ou não coloque a tabela em uma base de dados chamado algo diferente `Rules`, os arquivos de configuração do aplicativo na ferramenta de RuleSet e projetos de `UsageSample` devem ser editados com a mesma informações.</span><span class="sxs-lookup"><span data-stu-id="9b42d-193">If you edit the batch file or Setup.sql and specify not to use SQL Express or to place the table in a database named something other than `Rules`, the application configuration files in the RuleSet tool and `UsageSample` projects should be edited with the same information.</span></span>  
  
3.  <span data-ttu-id="9b42d-194">Depois que você execute o script de Setup.sql, você pode criar a solução de `ExternalRuleSetToolkit` e em iniciar a ferramenta de RuleSet de projeto de ExternalRuleSetTool.</span><span class="sxs-lookup"><span data-stu-id="9b42d-194">After you run the Setup.sql script, you can build the `ExternalRuleSetToolkit` solution and then launch the RuleSet tool from the ExternalRuleSetTool project.</span></span>  
  
4.  <span data-ttu-id="9b42d-195">A solução sequencial do aplicativo de console do fluxo de trabalho `RuleSetToolkitUsageSample` inclui um fluxo de trabalho de exemplo.</span><span class="sxs-lookup"><span data-stu-id="9b42d-195">The `RuleSetToolkitUsageSample` Sequential Workflow Console Application solution includes a sample workflow.</span></span> <span data-ttu-id="9b42d-196">O fluxo de trabalho consiste em uma atividade de `PolicyFromService` e duas variáveis, `orderValue` e `discount`, com que o destino RuleSet executa.</span><span class="sxs-lookup"><span data-stu-id="9b42d-196">The workflow consists of a `PolicyFromService` activity and two variables, `orderValue` and `discount`, against which the target RuleSet runs.</span></span>  
  
5.  <span data-ttu-id="9b42d-197">Para usar o exemplo, crie a solução de `RuleSetToolkitUsageSample` .</span><span class="sxs-lookup"><span data-stu-id="9b42d-197">To use the sample, build the `RuleSetToolkitUsageSample` solution.</span></span> <span data-ttu-id="9b42d-198">Em seguida, no menu principal da ferramenta conjunto de regras, clique em **importação de dados** e apontar para o arquivo Discountruleset na pasta de RuleSetToolkitUsageSample.</span><span class="sxs-lookup"><span data-stu-id="9b42d-198">Then from the RuleSet tool main menu, click **Data-Import** and point to the DiscountRuleSet.rules file in the RuleSetToolkitUsageSample folder.</span></span> <span data-ttu-id="9b42d-199">Clique o **Rule Store-salvar** opção de menu para salvar o RuleSet importado para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9b42d-199">Click the **Rule Store-Save** menu option to save the imported RuleSet to the database.</span></span>  
  
6.  <span data-ttu-id="9b42d-200">Porque o assembly de `PolicyActivities` é referenciado de projeto de fluxo de trabalho de exemplo, a atividade de `PolicyFromService` aparece no fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9b42d-200">Because the `PolicyActivities` assembly is referenced from the sample workflow project, the `PolicyFromService` activity appears in the workflow.</span></span> <span data-ttu-id="9b42d-201">, No entanto, não aparece na caixa de ferramentas por padrão.</span><span class="sxs-lookup"><span data-stu-id="9b42d-201">It does not, however, appear in the toolbox by default.</span></span> <span data-ttu-id="9b42d-202">Para adicioná-lo à caixa de ferramentas, faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="9b42d-202">To add it to the toolbox, do the following:</span></span>  
  
    -   <span data-ttu-id="9b42d-203">A caixa de ferramentas com o botão direito e selecione **escolher itens** (Isso pode demorar um pouco).</span><span class="sxs-lookup"><span data-stu-id="9b42d-203">Right-click the toolbox and select **Choose Items** (this may take a while).</span></span>  
  
    -   <span data-ttu-id="9b42d-204">Quando o **Choose Toolbox Items** caixa de diálogo for exibida, clique no **atividades** guia.</span><span class="sxs-lookup"><span data-stu-id="9b42d-204">When the **Choose Toolbox Items** dialog appears, click the **Activities** tab.</span></span>  
  
    -   <span data-ttu-id="9b42d-205">Navegue até a `PolicyActivities` assembly na `ExternalRuleSetToolkit` solução e clique em **abrir**.</span><span class="sxs-lookup"><span data-stu-id="9b42d-205">Browse to the `PolicyActivities` assembly in the `ExternalRuleSetToolkit` solution and click **Open**.</span></span>  
  
    -   <span data-ttu-id="9b42d-206">Certifique-se de que o `PolicyFromService` atividade é selecionada na **Choose Toolbox Items** caixa de diálogo e depois clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="9b42d-206">Ensure that the `PolicyFromService` activity is selected in the **Choose Toolbox Items** dialog and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="9b42d-207">A atividade agora deve aparecer na caixa de ferramentas do **componentes de RuleSetToolkitUsageSample** categoria.</span><span class="sxs-lookup"><span data-stu-id="9b42d-207">The activity should now appear in the toolbox in the **RuleSetToolkitUsageSample Components** category.</span></span>  
  
7.  <span data-ttu-id="9b42d-208">O serviço de RuleSet já está configurado no host do aplicativo de console usando a seguinte declaração em Module.vb.</span><span class="sxs-lookup"><span data-stu-id="9b42d-208">The RuleSet service is already configured on the console application host using the following statement in Program.cs.</span></span>  
  
    ```  
    workflowRuntime.AddService(new RuleSetService());  
    ```  
  
8.  <span data-ttu-id="9b42d-209">Você também pode configurar o serviço no host que usa um arquivo de configuração; consulte a documentação SDK para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="9b42d-209">You can also configure the service on the host using a configuration file; see the SDK documentation for details.</span></span>  
  
9. <span data-ttu-id="9b42d-210">Um arquivo de configuração do aplicativo é adicionado ao projeto de fluxo de trabalho especificar a cadeia de conexão para o base de dados é usado pelo serviço.</span><span class="sxs-lookup"><span data-stu-id="9b42d-210">An application configuration file is added to the workflow project to specify the connection string for the database to be used by the service.</span></span> <span data-ttu-id="9b42d-211">Isso deve ser a mesma cadeia de conexão usada pela ferramenta de RuleSet, apontando para a base de dados que contém a tabela de RuleSet.</span><span class="sxs-lookup"><span data-stu-id="9b42d-211">This should be the same connection string used by the RuleSet tool, which points to the database that contains the RuleSet table.</span></span>  
  
10. <span data-ttu-id="9b42d-212">Agora você pode executar o projeto de `RuleSetToolkitUsageSample` como você faria qualquer outro aplicativo de console do fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9b42d-212">You can now run the `RuleSetToolkitUsageSample` project as you would any other workflow console application.</span></span> <span data-ttu-id="9b42d-213">Pressione F5 ou Ctrl + F5 no Visual Studio ou executar o arquivo RuleSetToolkitUsageSample.exe diretamente.</span><span class="sxs-lookup"><span data-stu-id="9b42d-213">Press F5 or Ctrl+F5 within Visual Studio or run the RuleSetToolkitUsageSample.exe file directly.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="9b42d-214">Você deve fechar a ferramenta de RuleSet para recompilar o exemplo de uso, porque a ferramenta carrega o assembly de exemplo de uso.</span><span class="sxs-lookup"><span data-stu-id="9b42d-214">You must close the RuleSet tool to recompile the usage sample, because the tool loads the usage sample assembly.</span></span>