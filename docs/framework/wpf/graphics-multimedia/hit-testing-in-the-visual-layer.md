---
title: Teste de clique na camada visual
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- hit testing functionality [WPF]
- visual layer [WPF], hit testing functionality
ms.assetid: b1a64b61-14be-4d75-b89a-5c67bebb2c7b
ms.openlocfilehash: 60da11af51722e86a61c5e3298fafba2221f000b
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33558103"
---
# <a name="hit-testing-in-the-visual-layer"></a><span data-ttu-id="3fd7c-102">Teste de clique na camada visual</span><span class="sxs-lookup"><span data-stu-id="3fd7c-102">Hit Testing in the Visual Layer</span></span>
<span data-ttu-id="3fd7c-103">Este tópico fornece uma visão geral da funcionalidade de teste de clique fornecida pela camada visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-103">This topic provides an overview of hit testing functionality provided by the visual layer.</span></span> <span data-ttu-id="3fd7c-104">Suporte a teste de clique permite que você determine se um valor de geometria ou de ponto está dentro do conteúdo renderizado de um <xref:System.Windows.Media.Visual>, permitindo que você implemente comportamento de interface do usuário, como um retângulo de seleção para selecionar vários objetos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-104">Hit testing support allows you to determine whether a geometry or point value falls within the rendered content of a <xref:System.Windows.Media.Visual>, allowing you to implement user interface behavior such as a selection rectangle to select multiple objects.</span></span>  
  
 
  
<a name="hit_testing_scenarios"></a>   
## <a name="hit-testing-scenarios"></a><span data-ttu-id="3fd7c-105">Cenários de teste de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-105">Hit Testing Scenarios</span></span>  
 <span data-ttu-id="3fd7c-106">O <xref:System.Windows.UIElement> classe fornece a <xref:System.Windows.UIElement.InputHitTest%2A> método, que permite que você teste contra um elemento usando um determinado valor de coordenada.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-106">The <xref:System.Windows.UIElement> class provides the <xref:System.Windows.UIElement.InputHitTest%2A> method, which allows you to hit test against an element using a given coordinate value.</span></span> <span data-ttu-id="3fd7c-107">Em muitos casos, o <xref:System.Windows.UIElement.InputHitTest%2A> método fornece a funcionalidade desejada para a implementação de teste de clique elementos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-107">In many cases, the <xref:System.Windows.UIElement.InputHitTest%2A> method provides the desired functionality for implementing hit testing of elements.</span></span> <span data-ttu-id="3fd7c-108">No entanto, há várias situações em que talvez seja necessário implementar o teste de clique na camada visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-108">However, there are several scenarios in which you may need to implement hit testing at the visual layer.</span></span>  
  
-   <span data-ttu-id="3fd7c-109">Testes de clique contra não<xref:System.Windows.UIElement> objetos: isso se aplica se você é testes de clique não<xref:System.Windows.UIElement> objetos, como <xref:System.Windows.Media.DrawingVisual> ou objetos gráficos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-109">Hit testing against non-<xref:System.Windows.UIElement> objects: This applies if you are hit testing non-<xref:System.Windows.UIElement> objects, such as <xref:System.Windows.Media.DrawingVisual> or graphics objects.</span></span>  
  
-   <span data-ttu-id="3fd7c-110">Testes de clique usando uma geometria: isso se aplica se você precisa realizar teste de clique usando um objeto de geometria em vez do valor de coordenada de um ponto.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-110">Hit testing using a geometry: This applies if you need to hit test using a geometry object rather than the coordinate value of a point.</span></span>  
  
-   <span data-ttu-id="3fd7c-111">Testes de clique em vários objetos: isso se aplica quando você precisa realizar teste de clique em vários objetos, como objetos sobrepostos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-111">Hit testing against multiple objects: This applies when you need to hit test against multiple objects, such as overlapping objects.</span></span> <span data-ttu-id="3fd7c-112">Você pode obter resultados para todos os elementos visuais que interceptam uma geometria ou ponto e não apenas o primeiro deles.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-112">You can get results for all visuals intersecting a geometry or point, not just the first one.</span></span>  
  
-   <span data-ttu-id="3fd7c-113">Ignorando <xref:System.Windows.UIElement> política de teste de clique: isso se aplica quando você precisa ignorar o <xref:System.Windows.UIElement> diretiva, que leva em consideração fatores como se um elemento está desativado ou invisível de teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-113">Ignoring <xref:System.Windows.UIElement> hit testing policy: This applies when you need to ignore the <xref:System.Windows.UIElement> hit testing policy, which takes into consideration such factors as whether an element is disabled or invisible.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-114">Para um exemplo de código completo ilustrando o teste de clique na camada visual, consulte [Exemplo de teste de clique usando DrawingVisuals](http://go.microsoft.com/fwlink/?LinkID=159994) e [Exemplo de teste de clique com interoperação do Win32](http://go.microsoft.com/fwlink/?LinkID=159995).</span><span class="sxs-lookup"><span data-stu-id="3fd7c-114">For a complete code sample illustrating hit testing at the visual layer, see [Hit Test Using DrawingVisuals Sample](http://go.microsoft.com/fwlink/?LinkID=159994) and [Hit Test with Win32 Interoperation Sample](http://go.microsoft.com/fwlink/?LinkID=159995).</span></span>  
  
<a name="hit_testing_support"></a>   
## <a name="hit-testing-support"></a><span data-ttu-id="3fd7c-115">Suporte de teste de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-115">Hit Testing Support</span></span>  
 <span data-ttu-id="3fd7c-116">A finalidade do <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> métodos o <xref:System.Windows.Media.VisualTreeHelper> classe é determinar se um valor da coordenada de geometria ou de ponto está dentro do conteúdo renderizado de um determinado objeto, como um controle ou um elemento gráfico.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-116">The purpose of the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class is to determine whether a geometry or point coordinate value is within the rendered content of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="3fd7c-117">Por exemplo, você poderia usar o teste de clique para determinar se um clique do mouse, dentro do retângulo delimitador de um objeto, cai dentro da geometria de um círculo.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-117">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle.</span></span> <span data-ttu-id="3fd7c-118">Você também pode optar por substituir a implementação padrão de teste de clique para realizar seus próprios cálculos personalizados de teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-118">You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="3fd7c-119">A ilustração a seguir mostra a relação entre a região não retangular de um objeto e seu retângulo delimitador.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-119">The following illustration shows the relationship between a non-rectangular object's region and its bounding rectangle.</span></span>  
  
 <span data-ttu-id="3fd7c-120">![Diagrama de região de teste de clique válida](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span><span class="sxs-lookup"><span data-stu-id="3fd7c-120">![Diagram of valid hit test region](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span></span>  
<span data-ttu-id="3fd7c-121">Diagrama de região de teste de clique válida</span><span class="sxs-lookup"><span data-stu-id="3fd7c-121">Diagram of valid hit test region</span></span>  
  
<a name="hit_testing_and_z-order"></a>   
## <a name="hit-testing-and-z-order"></a><span data-ttu-id="3fd7c-122">Teste de clique e ordem z</span><span class="sxs-lookup"><span data-stu-id="3fd7c-122">Hit Testing and Z-Order</span></span>  
 <span data-ttu-id="3fd7c-123">A camada visual do [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] oferece suporte ao teste de clique em todos os objetos sob um ponto ou geometria e não apenas no objeto mais alto.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-123">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] visual layer supports hit testing against all objects under a point or geometry, not just the top-most object.</span></span> <span data-ttu-id="3fd7c-124">Os resultados são retornados em ordem z.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-124">Results are returned in z-order.</span></span> <span data-ttu-id="3fd7c-125">No entanto, o objeto visual que você passa como parâmetro para o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método determina qual parte da árvore visual que será atingido de teste.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-125">However, the visual object that you pass as the parameter to the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method determines which portion of the visual tree that will be hit test.</span></span> <span data-ttu-id="3fd7c-126">Você pode fazer teste de clique em toda a árvore visual ou em qualquer parte dela.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-126">You can hit test against the entire visual tree, or any portion of it.</span></span>  
  
 <span data-ttu-id="3fd7c-127">Na ilustração a seguir, o objeto circular está por cima dos objetos quadrado e triângulo.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-127">In the following illustration, the circle object is on top of both the square and triangle objects.</span></span> <span data-ttu-id="3fd7c-128">Se você só está interessado no objeto visual cujo valor de ordem z é o mais alto de teste de clique, você pode definir a enumeração de teste de clique visual para retornar <xref:System.Windows.Media.HitTestResultBehavior.Stop> do <xref:System.Windows.Media.HitTestResultCallback> para parar a passagem de teste de clique após o primeiro item.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-128">If you are only interested in hit testing the visual object whose z-order value is top-most, you can set the visual hit test enumeration to return <xref:System.Windows.Media.HitTestResultBehavior.Stop> from the <xref:System.Windows.Media.HitTestResultCallback> to stop the hit test traversal after the first item.</span></span>  
  
 <span data-ttu-id="3fd7c-129">![Diagrama de a z&#45;ordem de uma árvore visual](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span><span class="sxs-lookup"><span data-stu-id="3fd7c-129">![Diagram of the z&#45;order of a visual tree](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span></span>  
<span data-ttu-id="3fd7c-130">Diagrama da ordem z- de uma árvore visual</span><span class="sxs-lookup"><span data-stu-id="3fd7c-130">Diagram of the z-order of a visual tree</span></span>  
  
 <span data-ttu-id="3fd7c-131">Se você deseja enumerar todos os objetos visuais em um ponto específico ou geometria, retorne <xref:System.Windows.Media.HitTestResultBehavior.Continue> do <xref:System.Windows.Media.HitTestResultCallback>.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-131">If you want to enumerate all visual objects under a specific point or geometry, return <xref:System.Windows.Media.HitTestResultBehavior.Continue> from the <xref:System.Windows.Media.HitTestResultCallback>.</span></span> <span data-ttu-id="3fd7c-132">Isso significa que você pode realizar teste de clique de objetos visuais que estão sob outros objetos, mesmo que eles estejam totalmente encobertos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-132">This means you can hit test for visual objects that are beneath other objects, even if they are wholly obscured.</span></span> <span data-ttu-id="3fd7c-133">Consulte o código de exemplo na seção "Usando um retorno de chamada de resultados do teste de clique" para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-133">See the sample code in the section "Using a Hit Test Results Callback" for more information.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-134">Um objeto visual que é transparente também pode passar por teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-134">A visual object that is transparent can also be hit test.</span></span>  
  
<a name="using_default_hit_testing"></a>   
## <a name="using-default-hit-testing"></a><span data-ttu-id="3fd7c-135">Usando o teste de clique padrão</span><span class="sxs-lookup"><span data-stu-id="3fd7c-135">Using Default Hit Testing</span></span>  
 <span data-ttu-id="3fd7c-136">Você pode identificar se um ponto está dentro da geometria de um objeto visual, usando o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método para especificar o objeto visual e um ponto de coordenam o valor para o teste.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-136">You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify a visual object and a point coordinate value to test against.</span></span> <span data-ttu-id="3fd7c-137">O parâmetro de objeto visual identifica o ponto de partida para a pesquisa de teste de clique na árvore visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-137">The visual object parameter identifies the starting point in the visual tree for the hit test search.</span></span> <span data-ttu-id="3fd7c-138">Se um objeto visual for encontrado na árvore visual cuja geometria contém a coordenada, ele é definido como o <xref:System.Windows.Media.HitTestResult.VisualHit%2A> propriedade de um <xref:System.Windows.Media.HitTestResult> objeto.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-138">If a visual object is found in the visual tree whose geometry contains the coordinate, it is set to the <xref:System.Windows.Media.HitTestResult.VisualHit%2A> property of a <xref:System.Windows.Media.HitTestResult> object.</span></span> <span data-ttu-id="3fd7c-139">O <xref:System.Windows.Media.HitTestResult> , em seguida, é retornado do <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-139">The <xref:System.Windows.Media.HitTestResult> is then returned from the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="3fd7c-140">Se o ponto não estiver contido na subárvore visual são atingidos de teste, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> retorna `null`.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-140">If the point is not contained with the visual sub-tree you are hit testing, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> returns `null`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-141">O teste de clique padrão sempre retorna o objeto mais alto na ordem z.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-141">Default hit testing always returns the top-most object in the z-order.</span></span> <span data-ttu-id="3fd7c-142">Para identificar todos os objetos visuais, mesmo aqueles que podem estar totalmente ou parcialmente encobertos, use um retorno de chamada de resultado do teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-142">In order to identify all visual objects, even those that may be partly or wholly obscured, use a hit test result callback.</span></span>  
  
 <span data-ttu-id="3fd7c-143">O valor da coordenada passar como o parâmetro de ponto para o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método deve ser relativo ao espaço de coordenadas do objeto visual que é testes de clique contra.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-143">The coordinate value you pass as the point parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method has to be relative to the coordinate space of the visual object you are hit testing against.</span></span> <span data-ttu-id="3fd7c-144">Por exemplo, se você tem objetos visuais aninhados definidos em (100, 100) no espaço de coordenadas do pai, o teste de clique de um objeto visual filho em (0, 0) é equivalente ao teste de clique em (100, 100) no espaço de coordenadas do pai.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-144">For example, if you have nested visual objects defined at (100, 100) in the parent's coordinate space, then hit testing a child visual at (0, 0) is equivalent to hit testing at (100, 100) in the parent's coordinate space.</span></span>  
  
 <span data-ttu-id="3fd7c-145">O código a seguir mostra como definir manipuladores de eventos de mouse para um <xref:System.Windows.UIElement> objeto que é usado para capturar eventos utilizados para teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-145">The following code shows how to set up mouse event handlers for a <xref:System.Windows.UIElement> object that is used to capture events used for hit testing.</span></span>  
  
 [!code-csharp[HitTestingOverview#100](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#100)]
 [!code-vb[HitTestingOverview#100](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#100)]  
  
### <a name="how-the-visual-tree-affects-hit-testing"></a><span data-ttu-id="3fd7c-146">Como a árvore visual afeta testes de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-146">How the Visual Tree Affects Hit Testing</span></span>  
 <span data-ttu-id="3fd7c-147">O ponto de partida na árvore visual determina quais objetos são retornados durante a enumeração de teste de clique de objetos.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-147">The starting point in the visual tree determines which objects are returned during the hit test enumeration of objects.</span></span> <span data-ttu-id="3fd7c-148">Se você tem vários objetos nos quais deseja realizar o teste de clique, o objeto visual usado como o ponto de partida na árvore visual deve ser o ancestral comum de todos os objetos de interesse.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-148">If you have multiple objects you want to hit test, the visual object used as the starting point in the visual tree must be the common ancestor of all objects of interest.</span></span> <span data-ttu-id="3fd7c-149">Por exemplo, se estiver interessado em realizar testes de clique no elemento botão e no objeto visual de desenho no diagrama a seguir, você terá que definir o ancestral comum de ambos como o ponto de partida na árvore visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-149">For example, if you were interested in hit testing both the button element and drawing visual in the following diagram, you would have to set the starting point in the visual tree to the common ancestor of both.</span></span> <span data-ttu-id="3fd7c-150">Nesse caso, o elemento tela é o ancestral comum do elemento botão e do objeto visual de desenho.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-150">In this case, the canvas element is the common ancestor of both the button element and the drawing visual.</span></span>  
  
 <span data-ttu-id="3fd7c-151">![Diagrama de uma hierarquia visual](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span><span class="sxs-lookup"><span data-stu-id="3fd7c-151">![Diagram of a visual tree hierarchy](../../../../docs/framework/wpf/graphics-multimedia/media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span></span>  
<span data-ttu-id="3fd7c-152">Diagrama de uma hierarquia de árvore visual</span><span class="sxs-lookup"><span data-stu-id="3fd7c-152">Diagram of a visual tree hierarchy</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-153">O <xref:System.Windows.UIElement.IsHitTestVisible%2A> propriedade obtém ou define um valor que declara se um <xref:System.Windows.UIElement>-objeto derivado possivelmente pode ser retornado como um resultado de teste de clique de alguma parte de seu conteúdo renderizado.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-153">The <xref:System.Windows.UIElement.IsHitTestVisible%2A> property gets or sets a value that declares whether a <xref:System.Windows.UIElement>-derived object can possibly be returned as a hit test result from some portion of its rendered content.</span></span> <span data-ttu-id="3fd7c-154">Isso permite que você altere seletivamente a árvore visual para determinar quais objetos visuais estão envolvidos em um teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-154">This allows you to selectively alter the visual tree to determine which visual objects are involved in a hit test.</span></span>  
  
<a name="using_a_hit_test_result_callback"></a>   
## <a name="using-a-hit-test-result-callback"></a><span data-ttu-id="3fd7c-155">Usando um retorno de chamada de resultado do teste de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-155">Using a Hit Test Result Callback</span></span>  
 <span data-ttu-id="3fd7c-156">Você pode enumerar todos os objetos visuais em uma árvore visual cuja geometria contém um valor de coordenada especificado.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-156">You can enumerate all visual objects in a visual tree whose geometry contains a specified coordinate value.</span></span> <span data-ttu-id="3fd7c-157">Isso permite que você identifique todos os objetos visuais, mesmo aqueles que podem estar totalmente ou parcialmente encobertos por outros objetos visuais.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-157">This allows you to identify all visual objects, even those that may be partly or wholly obscured by other visual objects.</span></span> <span data-ttu-id="3fd7c-158">Enumerar objetos visuais em uma árvore visual, use o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método com uma função de retorno de chamada de teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-158">To enumerate visual objects in a visual tree use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method with a hit test callback function.</span></span> <span data-ttu-id="3fd7c-159">A função de retorno de chamada de teste de clique é chamada pelo sistema quando o valor de coordenada especificado está contido em um objeto visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-159">The hit test callback function is called by the system when the coordinate value you specify is contained in a visual object.</span></span>  
  
 <span data-ttu-id="3fd7c-160">Durante a enumeração de resultados do teste de clique, você não deve realizar nenhuma operação que modifica a árvore visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-160">During the hit test results enumeration, you should not perform any operation that modifies the visual tree.</span></span> <span data-ttu-id="3fd7c-161">A adição ou remoção de objetos da árvore visual enquanto ela está sendo percorrida poderá resultar em comportamento imprevisível.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-161">Adding or removing an object from the visual tree while it is being traversed can result in unpredictable behavior.</span></span> <span data-ttu-id="3fd7c-162">Você pode modificar a árvore visual após com segurança o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método retorna.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-162">You can safely modify the visual tree after the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method returns.</span></span> <span data-ttu-id="3fd7c-163">Talvez você queira fornecer uma estrutura de dados, como um <xref:System.Collections.ArrayList>, para armazenar valores de durante a enumeração de resultados de teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-163">You may want to provide a data structure, such as an <xref:System.Collections.ArrayList>, to store values during the hit test results enumeration.</span></span>  
  
 [!code-csharp[HitTestingOverview#101](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[HitTestingOverview#101](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="3fd7c-164">O método do retorno de chamada do teste de clique define as ações que são realizadas quando um teste de clique é identificado em um determinado objeto visual na árvore visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-164">The hit test callback method defines the actions you perform when a hit test is identified on a particular visual object in the visual tree.</span></span> <span data-ttu-id="3fd7c-165">Depois de executar as ações, você retornar um <xref:System.Windows.Media.HitTestResultBehavior> valor que determina se deseja ou não, continuar a enumeração de quaisquer outros objetos visuais.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-165">After you perform the actions, you return a <xref:System.Windows.Media.HitTestResultBehavior> value that determines whether to continue the enumeration of any other visual objects or not.</span></span>  
  
 [!code-csharp[HitTestingOverview#102](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[HitTestingOverview#102](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#102)]  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-166">A ordem de enumeração de objetos visuais de ocorrência é pela ordem z.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-166">The order of enumeration of hit visual objects is by z-order.</span></span> <span data-ttu-id="3fd7c-167">O objeto visual no nível mais alto da ordem z é o primeiro objeto enumerado.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-167">The visual object at the top-most z-order level is the first object enumerated.</span></span> <span data-ttu-id="3fd7c-168">Quaisquer outros objetos visuais enumerados estão em níveis decrescentes da ordem z.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-168">Any other visual objects enumerated are at decreasing z-order level.</span></span> <span data-ttu-id="3fd7c-169">Esta ordem de enumeração corresponde à ordem de renderização dos elementos visuais.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-169">This order of enumeration corresponds to the rendering order of the visuals.</span></span>  
  
 <span data-ttu-id="3fd7c-170">Você pode interromper a enumeração de objetos visuais a qualquer momento em que a função de retorno de chamada de teste de clique, retornando <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-170">You can stop the enumeration of visual objects at any time in the hit test callback function by returning <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span></span>  
  
 [!code-csharp[HitTestingOverview#103](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#103)]
 [!code-vb[HitTestingOverview#103](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#103)]  
  
<a name="using_a_hit_test_filter_callback"></a>   
## <a name="using-a-hit-test-filter-callback"></a><span data-ttu-id="3fd7c-171">Usando um retorno de chamada de filtro de teste de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-171">Using a Hit Test Filter Callback</span></span>  
 <span data-ttu-id="3fd7c-172">Você pode usar um filtro de teste de clique opcional para restringir os objetos que são passados aos resultados do teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-172">You can use an optional hit test filter to restrict the objects that are passed on to the hit test results.</span></span> <span data-ttu-id="3fd7c-173">Isso permite que você ignore as partes da árvore visual que você não está interessado em processar nos seus resultados do teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-173">This allows you to ignore parts of the visual tree that you are not interested in processing in your hit test results.</span></span> <span data-ttu-id="3fd7c-174">Para implementar um filtro de teste de clique, você pode definir uma função de retorno de chamada de filtro de teste de clique e passá-lo como um valor de parâmetro ao chamar o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-174">To implement a hit test filter, you define a hit test filter callback function and pass it as a parameter value when you call the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#104](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#104)]
 [!code-vb[HitTestingOverview#104](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#104)]  
  
 <span data-ttu-id="3fd7c-175">Se você não quiser fornecer a função de retorno de chamada de filtro de teste de clique opcional, passar um `null` valor como seu parâmetro para o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-175">If you do not want to supply the optional hit test filter callback function, pass a `null` value as its parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#105](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#105)]
 [!code-vb[HitTestingOverview#105](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#105)]  
  
 <span data-ttu-id="3fd7c-176">![Remoção de uma árvore visual usando um filtro de teste de clique](../../../../docs/framework/wpf/graphics-multimedia/media/filteredvisualtree-01.png "FilteredVisualTree_01")</span><span class="sxs-lookup"><span data-stu-id="3fd7c-176">![Pruning a visual tree using a hit test filter](../../../../docs/framework/wpf/graphics-multimedia/media/filteredvisualtree-01.png "FilteredVisualTree_01")</span></span>  
<span data-ttu-id="3fd7c-177">Aparando uma árvore visual</span><span class="sxs-lookup"><span data-stu-id="3fd7c-177">Pruning a visual tree</span></span>  
  
 <span data-ttu-id="3fd7c-178">A função de retorno de chamada de filtro de teste de clique permite que você enumere através de todos os elementos visuais cujo conteúdo renderizado contém as coordenadas especificadas.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-178">The hit test filter callback function allows you to enumerate through all the visuals whose rendered content contains the coordinates you specify.</span></span> <span data-ttu-id="3fd7c-179">No entanto, você talvez queira ignorar determinadas ramificações da árvore visual, que você não está interessado em processar em sua função de retorno de chamada de resultados do teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-179">However, you may want to ignore certain branches of the visual tree that you are not interested in processing in your hit test results callback function.</span></span> <span data-ttu-id="3fd7c-180">O valor retornado da função de retorno de chamada do filtro de teste de clique determina o tipo de ação que a enumeração dos objetos visuais deve tomar.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-180">The return value of the hit test filter callback function determines what type of action the enumeration of the visual objects should take.</span></span> <span data-ttu-id="3fd7c-181">Por exemplo, se você retornar o valor <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, você pode remover o objeto visual atual e seus filhos da enumeração de resultados de teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-181">For example, if you return the value, <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, you can remove the current visual object and its children from the hit test results enumeration.</span></span> <span data-ttu-id="3fd7c-182">Isso significa que a função de retorno de chamada de resultados do teste de clique não verá esses objetos em sua enumeração.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-182">This means that the hit test results callback function will not see these objects in its enumeration.</span></span> <span data-ttu-id="3fd7c-183">Aparar a árvore visual de objetos diminui a quantidade de processamento durante a passagem da enumeração de resultados do teste de clique.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-183">Pruning the visual tree of objects decreases the amount of processing during the hit test results enumeration pass.</span></span> <span data-ttu-id="3fd7c-184">No exemplo de código a seguir, o filtro ignora os rótulos e seus descendentes e faz testes de clique de todo o resto.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-184">In the following code example, the filter skips labels and their descendants and hit tests everything else.</span></span>  
  
 [!code-csharp[HitTestingOverview#106](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#106)]
 [!code-vb[HitTestingOverview#106](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#106)]  
  
> [!NOTE]
>  <span data-ttu-id="3fd7c-185">O retorno de chamada de filtro do teste de clique às vezes será chamado em casos nos quais o retorno de chamada de resultados do teste de clique não é chamado.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-185">The hit test filter callback will sometimes be called in cases where the hit test results callback is not called.</span></span>  
  
<a name="overriding_default_hit_testing"></a>   
## <a name="overriding-default-hit-testing"></a><span data-ttu-id="3fd7c-186">Substituindo o teste de clique padrão</span><span class="sxs-lookup"><span data-stu-id="3fd7c-186">Overriding Default Hit Testing</span></span>  
 <span data-ttu-id="3fd7c-187">Você pode substituir a ocorrência de padrão de um objeto visual teste suporte por meio da substituição de <xref:System.Windows.Media.Visual.HitTestCore%2A> método.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-187">You can override a visual object’s default hit testing support by overriding the <xref:System.Windows.Media.Visual.HitTestCore%2A> method.</span></span> <span data-ttu-id="3fd7c-188">Isso significa que, quando você invoca o <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> método, sua implementação de <xref:System.Windows.Media.Visual.HitTestCore%2A> é chamado.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-188">This means that when you invoke the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method, your overridden implementation of <xref:System.Windows.Media.Visual.HitTestCore%2A> is called.</span></span> <span data-ttu-id="3fd7c-189">O método substituído é chamado quando um teste de clique cair dentro do retângulo delimitador do objeto visual, mesmo que a coordenada ficar fora do conteúdo renderizado do objeto visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-189">Your overridden method is called when a hit test falls within the bounding rectangle of the visual object, even if the coordinate falls outside the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#107](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#107)]
 [!code-vb[HitTestingOverview#107](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#107)]  
  
 <span data-ttu-id="3fd7c-190">Pode haver ocasiões em que você deseja realizar teste de clique no retângulo delimitador e no conteúdo renderizado de um objeto visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-190">There may be times when you want to hit test against both the bounding rectangle and the rendered content of a visual object.</span></span> <span data-ttu-id="3fd7c-191">Usando o `PointHitTestParameters` valor de parâmetro no seu substituído <xref:System.Windows.Media.Visual.HitTestCore%2A> método como o parâmetro para o método base <xref:System.Windows.Media.Visual.HitTestCore%2A>, você pode executar ações com base em uma ocorrência do retângulo delimitador de um objeto visual e, em seguida, executar um segundo teste de clique com o renderizado conteúdo do objeto visual.</span><span class="sxs-lookup"><span data-stu-id="3fd7c-191">By using the `PointHitTestParameters` parameter value in your overridden <xref:System.Windows.Media.Visual.HitTestCore%2A> method as the parameter to the base method <xref:System.Windows.Media.Visual.HitTestCore%2A>, you can perform actions based on a hit of the bounding rectangle of a visual object, and then perform a second hit test against the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#108](../../../../samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#108)]
 [!code-vb[HitTestingOverview#108](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#108)]  
  
## <a name="see-also"></a><span data-ttu-id="3fd7c-192">Consulte também</span><span class="sxs-lookup"><span data-stu-id="3fd7c-192">See Also</span></span>  
 <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>  
 <xref:System.Windows.Media.HitTestResult>  
 <xref:System.Windows.Media.HitTestResultCallback>  
 <xref:System.Windows.Media.HitTestFilterCallback>  
 <xref:System.Windows.UIElement.IsHitTestVisible%2A>  
 [<span data-ttu-id="3fd7c-193">Usando o exemplo de DrawingVisuals de teste de clique</span><span class="sxs-lookup"><span data-stu-id="3fd7c-193">Hit Test Using DrawingVisuals Sample</span></span>](http://go.microsoft.com/fwlink/?LinkID=159994)  
 [<span data-ttu-id="3fd7c-194">Acertos de teste com exemplo de interoperabilidade do Win32</span><span class="sxs-lookup"><span data-stu-id="3fd7c-194">Hit Test with Win32 Interoperation Sample</span></span>](http://go.microsoft.com/fwlink/?LinkID=159995)  
 [<span data-ttu-id="3fd7c-195">Teste de clique de geometria em um visual</span><span class="sxs-lookup"><span data-stu-id="3fd7c-195">Hit Test Geometry in a Visual</span></span>](../../../../docs/framework/wpf/graphics-multimedia/how-to-hit-test-geometry-in-a-visual.md)  
 [<span data-ttu-id="3fd7c-196">Teste de clique usando um contêiner de host Win32</span><span class="sxs-lookup"><span data-stu-id="3fd7c-196">Hit Test Using a Win32 Host Container</span></span>](../../../../docs/framework/wpf/graphics-multimedia/how-to-hit-test-using-a-win32-host-container.md)
