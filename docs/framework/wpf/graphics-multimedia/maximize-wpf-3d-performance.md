---
title: Maximizar o desempenho 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 3825ea8e57c6863e2ee654072efda623db21c2a8
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/21/2020
ms.locfileid: "80111992"
---
# <a name="maximize-wpf-3d-performance"></a>Maximizar desempenho 3D do WPF
Ao usar o [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] para compilar controles 3D e incluir cenas 3D em seus aplicativos, é importante considerar a otimização de desempenho. Este tópico fornece uma lista de classes 3D e propriedades que têm implicações de desempenho para o seu aplicativo, juntamente com recomendações para otimizar o desempenho ao usá-las.  
  
 Este tópico pressupõe um conhecimento avançado em recursos 3D [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]. As sugestões neste documento se aplicam à "camada de renderização 2" – que pode ser definida como um hardware que dá suporte à versão 2.0 do sombreador de pixel e à versão 2.0 do sombreador de vértice. Para mais detalhes, consulte [Camadas de renderização de gráficos](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Impacto de desempenho: alto  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Velocidade do pincel (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(cached)<br /><br /> <xref:System.Windows.Media.VisualBrush>(cached)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(sem cache)<br /><br /> <xref:System.Windows.Media.VisualBrush>(sem cache)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Definido `Viewport3D.ClipToBounds` como falso sempre que [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] você não precisar ter <xref:System.Windows.Controls.Viewport3D> clipado explicitamente o conteúdo de um no retângulo do Viewport3D. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]o recorte antialiased pode `ClipToBounds` ser muito lento e <xref:System.Windows.Controls.Viewport3D>está ativado (lento) por padrão em .|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Definir `Viewport3D.IsHitTestVisible` como falso sempre [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] que você não <xref:System.Windows.Controls.Viewport3D> precisar considerar o conteúdo de um teste de acerto de mouse.  O conteúdo em 3D do teste de clique é feito em software e pode ser lento com grandes malhas. <xref:System.Windows.UIElement.IsHitTestVisible%2A>está ativado (lento) por <xref:System.Windows.Controls.Viewport3D>padrão em .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Crie modelos diferentes somente quando eles exigirem materiais ou transformações diferentes.  Caso contrário, tente unir <xref:System.Windows.Media.Media3D.GeometryModel3D> muitas instâncias com os mesmos <xref:System.Windows.Media.Media3D.GeometryModel3D> Materiais e Transforma em alguns casos maiores e <xref:System.Windows.Media.Media3D.MeshGeometry3D> instâncias.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|A animação de malha (que altera os vértices individuais de uma malha por quadro) não é sempre eficiente no [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Para minimizar o impacto no desempenho de notificações de alteração quando cada vértice é modificado, desanexe a malha da árvore visual antes de executar a modificação por vértice.  Quando a malha tiver sido modificada, reanexe-a à árvore visual.  Além disso, tente minimizar o tamanho das malhas que serão animadas dessa maneira.|  
|Suavização 3D|Para aumentar a velocidade de renderização, desabilite a multiamostragem em a <xref:System.Windows.Controls.Viewport3D> configuração da propriedade <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> anexada a `Aliased`.  Por padrão, o antialiasing 3D é ativado no Windows com 4 amostras por pixel.|  
|Texto|Texto ao vivo em uma cena 3D <xref:System.Windows.Media.DrawingBrush> (ao vivo porque está em um ou <xref:System.Windows.Media.VisualBrush>) pode ser lento. Tente usar imagens do texto <xref:System.Windows.Media.Imaging.RenderTargetBitmap>em vez disso (via ) a menos que o texto mude.|  
|<xref:System.Windows.Media.TileBrush>|Se você deve <xref:System.Windows.Media.VisualBrush> usar <xref:System.Windows.Media.DrawingBrush> uma ou uma em uma cena 3D porque o conteúdo do pincel <xref:System.Windows.Media.RenderOptions.CachingHint%2A> não `Cache`é estático, tente cachear o pincel (definir a propriedade anexada a ).  Defina os limites mínimos e máximos de <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>invalidação (com as propriedades anexadas e ) para que os pincéis armazenados não sejam regenerados com muita freqüência, mantendo o nível de qualidade desejado.  Por <xref:System.Windows.Media.DrawingBrush> padrão, <xref:System.Windows.Media.VisualBrush> e não são armazenados em cache, o que significa que toda vez que algo pintado com o pincel tem que ser rerenderizado, todo o conteúdo do pincel deve ser rerenderizado em uma superfície intermediária.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect>força todo o conteúdo afetado a ser renderizado sem aceleração de hardware.  Para melhor desempenho, <xref:System.Windows.Media.Effects.BitmapEffect>não use .|  
  
## <a name="performance-impact-medium"></a>Impacto de desempenho: médio  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quando uma malha é definida como triângulos de abutting com vértices compartilhados e esses vértices têm as mesmas coordenadas <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>de posição, normal e textura, defina cada vértice compartilhado apenas uma vez e, em seguida, defina seus triângulos por índice com .|  
|<xref:System.Windows.Media.ImageBrush>|Tente minimizar os tamanhos de textura quando você tiver controle <xref:System.Windows.Media.Imaging.RenderTargetBitmap> explícito sobre <xref:System.Windows.Media.ImageBrush>o tamanho (quando você estiver usando um e/ou um ).  Observe que texturas de resolução inferior podem diminuir a qualidade visual, então tente determinar o equilíbrio correto entre desempenho e qualidade.|  
|Opacidade|Ao renderizar conteúdo 3D translúcido (como reflexões), use as propriedades <xref:System.Windows.Media.Brush.Opacity%2A> de <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>opacidade em pincéis ou materiais (via ou ) em vez de criar um translúcido <xref:System.Windows.Controls.Viewport3D> separado, definindo `Viewport3D.Opacity` um valor menor que 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Minimize o <xref:System.Windows.Controls.Viewport3D> número de objetos que você está usando em uma cena.  Coloque vários modelos 3D no mesmo Viewport3D em vez de criar instâncias separadas do Viewport3D para cada modelo.|  
|<xref:System.Windows.Freezable>|Normalmente é benéfico reutilizar <xref:System.Windows.Media.Media3D.MeshGeometry3D> <xref:System.Windows.Media.Media3D.GeometryModel3D>, escovas e materiais.  Todos podem ter vários pais atribuídos já que são derivados de `Freezable`.|  
|<xref:System.Windows.Freezable>|Chame <xref:System.Windows.Freezable.Freeze%2A> o método em Freezables quando suas propriedades permanecerão inalteradas em sua aplicação.  O congelamento pode diminuir o conjunto de trabalho e aumentar a velocidade.|  
|<xref:System.Windows.Media.Brush>|Use <xref:System.Windows.Media.ImageBrush> em <xref:System.Windows.Media.VisualBrush> <xref:System.Windows.Media.DrawingBrush> vez de ou quando o conteúdo do pincel não mudar.  O conteúdo 2D pode <xref:System.Windows.Controls.Image> ser <xref:System.Windows.Media.Imaging.RenderTargetBitmap> convertido em <xref:System.Windows.Media.ImageBrush>via e, em seguida, usado em um .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Não use <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> a menos que você realmente <xref:System.Windows.Media.Media3D.GeometryModel3D>precisa ver as faces traseiras de seu .|  
|<xref:System.Windows.Media.Media3D.Light>|Velocidade da luz (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Tente manter os tamanhos das malhas abaixo desses limites:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20.001 <xref:System.Windows.Media.Media3D.Point3D> instâncias<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60.003 <xref:System.Int32> instâncias|  
|<xref:System.Windows.Media.Media3D.Material>|Velocidade do material (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|O [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D não descarta pincéis invisíveis (pincéis de ambiente pretos, pincéis de limpeza, etc.) de uma maneira consistente.  Considere omiti-los da sua cena.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Cada <xref:System.Windows.Media.Media3D.Material> um <xref:System.Windows.Media.Media3D.MaterialGroup> em uma causa outro passe de renderização, então incluindo muitos materiais, mesmo materiais simples, pode aumentar drasticamente as demandas de preenchimento em sua GPU.  Minimize o número de <xref:System.Windows.Media.Media3D.MaterialGroup>materiais em seu .|  
  
## <a name="performance-impact-low"></a>Impacto de desempenho: baixo  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Quando você não precisar de animação ou vinculação de dados, em vez <xref:System.Windows.Media.Media3D.MatrixTransform3D>de usar um grupo de transformação contendo várias transformações, use um único , definindo-o como produto de todas as transformações que de outra forma existiriam independentemente no grupo de transformação.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimize o número de luzes na sua cena. Ter muitas luzes em uma cena forçará [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] a recuar para a renderização de software.  Os limites são cerca <xref:System.Windows.Media.Media3D.DirectionalLight> de 110 objetos, 70 <xref:System.Windows.Media.Media3D.PointLight> objetos ou 40 <xref:System.Windows.Media.Media3D.SpotLight> objetos.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Separe objetos móveis de objetos estáticos colocando-os em instâncias separadas. <xref:System.Windows.Media.Media3D.ModelVisual3D>  O ModelVisual3D é "mais pesado" do que <xref:System.Windows.Media.Media3D.GeometryModel3D> porque armazena limites transformados em cache.  O GeometryModel3D é otimizado para ser um modelo. O ModelVisual3D é otimizado para ser um nó da cena.  Use ModelVisual3D para colocar instâncias compartilhadas de GeometryModel3D na cena.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimize o número de vezes que você altera o número de luzes na cena.  Cada alteração da contagem de luz força uma regeneração e recompilação do sombreador, a menos que essa configuração tenha existido anteriormente (e, portanto, tenha o sombreador armazenado em cache).|  
|Leve|As luzes pretas não serão visíveis, mas aumentarão o tempo de renderização. Considere omiti-las.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Para minimizar o tempo de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]construção de grandes coleções em , <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>como <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>uma <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>MalhaGeometry3D, e , pré-dimensionar as coleções antes da população de valor. Se possível, passe as estruturas de dados pré-preenchidas dos construtores das coleções como matrizes ou listas.|  
  
## <a name="see-also"></a>Confira também

- [Visão geral de gráficos 3D](3-d-graphics-overview.md)
