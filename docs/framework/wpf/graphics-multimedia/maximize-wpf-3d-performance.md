---
title: Maximizar desempenho 3D do WPF
ms.date: 03/30/2017
helpviewer_keywords:
- 3-D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 8629748c37aae8e35bb928c5a8d5a9caa7046942
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61785678"
---
# <a name="maximize-wpf-3d-performance"></a>Maximizar desempenho 3D do WPF
Ao usar o [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] para compilar controles 3D e incluir cenas 3D em seus aplicativos, é importante considerar a otimização de desempenho. Este tópico fornece uma lista de classes 3D e propriedades que têm implicações de desempenho para o seu aplicativo, juntamente com recomendações para otimizar o desempenho ao usá-las.  
  
 Este tópico pressupõe um conhecimento avançado em recursos 3D [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]. As sugestões neste documento se aplicam à "camada de renderização 2" – que pode ser definida como um hardware que dá suporte à versão 2.0 do sombreador de pixel e à versão 2.0 do sombreador de vértice. Para mais detalhes, consulte [Camadas de renderização de gráficos](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Impacto de desempenho: Alta  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Velocidade do pincel (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (em cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (em cache)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (sem cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (sem cache)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Definir `Viewport3D.ClipToBounds` como false sempre que você não precisa ter [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] recorte explicitamente o conteúdo de um <xref:System.Windows.Controls.Viewport3D> ao retângulo do Viewport3D. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] recorte com suavização pode ser muito lento, e `ClipToBounds` está habilitado (lento) por padrão em <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Definir `Viewport3D.IsHitTestVisible` como false sempre que você não precisa [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] considere o conteúdo de um <xref:System.Windows.Controls.Viewport3D> quando o mouse executando o teste de clique.  O conteúdo em 3D do teste de clique é feito em software e pode ser lento com grandes malhas. <xref:System.Windows.UIElement.IsHitTestVisible%2A> habilitado (lento) por padrão em <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Crie modelos diferentes somente quando eles exigirem materiais ou transformações diferentes.  Caso contrário, tente unir muitas <xref:System.Windows.Media.Media3D.GeometryModel3D> instâncias com os mesmos materiais e transformações em algumas maiores <xref:System.Windows.Media.Media3D.GeometryModel3D> e <xref:System.Windows.Media.Media3D.MeshGeometry3D> instâncias.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|A animação de malha (que altera os vértices individuais de uma malha por quadro) não é sempre eficiente no [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Para minimizar o impacto no desempenho de notificações de alteração quando cada vértice é modificado, desanexe a malha da árvore visual antes de executar a modificação por vértice.  Quando a malha tiver sido modificada, reanexe-a à árvore visual.  Além disso, tente minimizar o tamanho das malhas que serão animadas dessa maneira.|  
|Suavização 3D|Para aumentar a velocidade de renderização, desabilite o multisampling em um <xref:System.Windows.Controls.Viewport3D> definindo a propriedade anexada <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> para `Aliased`.  Por padrão, a suavização 3D é desabilitada em [!INCLUDE[TLA#tla_winxp](../../../../includes/tlasharptla-winxp-md.md)] e habilitada em [!INCLUDE[TLA#tla_longhorn](../../../../includes/tlasharptla-longhorn-md.md)] com quatro amostras por pixel.|  
|Texto|Texto dinâmico em uma cena 3D (dinâmico porque ele está um <xref:System.Windows.Media.DrawingBrush> ou <xref:System.Windows.Media.VisualBrush>) pode ser lenta. Tente usar imagens do texto em vez disso (via <xref:System.Windows.Media.Imaging.RenderTargetBitmap>), a menos que o texto será alterado.|  
|<xref:System.Windows.Media.TileBrush>|Se você precisar usar um <xref:System.Windows.Media.VisualBrush> ou um <xref:System.Windows.Media.DrawingBrush> em uma cena 3D porque o conteúdo do pincel não é estático, tente fazer cache do pincel (Configurando a propriedade anexada <xref:System.Windows.Media.RenderOptions.CachingHint%2A> para `Cache`).  Definir limites de invalidação de escala mínima e máxima (com as propriedades anexadas <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> e <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>) para que os pincéis armazenados em cache não sejam regenerados com muita frequência, mantendo seu nível de qualidade desejado.  Por padrão, <xref:System.Windows.Media.DrawingBrush> e <xref:System.Windows.Media.VisualBrush> não estão em cache, que significa que sempre que algo pintado com pincel tiver que ser renderizado novamente, todo o conteúdo do pincel deve primeiro ser reprocessado para uma superfície intermediária.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect> força todo o conteúdo afetado a ser renderizado sem aceleração de hardware.  Para obter o melhor desempenho, não use <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Impacto de desempenho: Médio  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quando uma malha é definida como adjacentes com vértices compartilhados e esses vértices têm a mesma posição, normal e coordenadas de textura, defina cada vértice compartilhado somente uma vez e, em seguida, defina seus triângulos por índice com <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>.|  
|<xref:System.Windows.Media.ImageBrush>|Tente minimizar os tamanhos das texturas quando você tiver controle explícito sobre o tamanho (quando você estiver usando um <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e/ou um <xref:System.Windows.Media.ImageBrush>).  Observe que texturas de resolução inferior podem diminuir a qualidade visual, então tente determinar o equilíbrio correto entre desempenho e qualidade.|  
|Opacidade|Durante a renderização 3D translúcido conteúdo (como reflexos), use as propriedades de opacidade em pincéis ou materiais (via <xref:System.Windows.Media.Brush.Opacity%2A> ou <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>) em vez de criar um separado translúcido <xref:System.Windows.Controls.Viewport3D> definindo `Viewport3D.Opacity` como um valor menor que 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Minimizar o número de <xref:System.Windows.Controls.Viewport3D> objetos que você está usando em uma cena.  Coloque vários modelos 3D no mesmo Viewport3D em vez de criar instâncias separadas do Viewport3D para cada modelo.|  
|<xref:System.Windows.Freezable>|Geralmente é útil reutilizar <xref:System.Windows.Media.Media3D.MeshGeometry3D>, <xref:System.Windows.Media.Media3D.GeometryModel3D>, pincéis e materiais.  Todos podem ter vários pais atribuídos já que são derivados de `Freezable`.|  
|<xref:System.Windows.Freezable>|Chamar o <xref:System.Windows.Freezable.Freeze%2A> método em congeláveis quando suas propriedades forem permanecer inalteradas no seu aplicativo.  O congelamento pode diminuir o conjunto de trabalho e aumentar a velocidade.|  
|<xref:System.Windows.Media.Brush>|Use <xref:System.Windows.Media.ImageBrush> em vez de <xref:System.Windows.Media.VisualBrush> ou <xref:System.Windows.Media.DrawingBrush> quando o conteúdo do pincel não será alterado.  Conteúdo 2D pode ser convertido em um <xref:System.Windows.Controls.Image> via <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e, em seguida, usado em um <xref:System.Windows.Media.ImageBrush>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Não use <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> , a menos que você realmente precise ver as faces de trás sua <xref:System.Windows.Media.Media3D.GeometryModel3D>.|  
|<xref:System.Windows.Media.Media3D.Light>|Velocidade da luz (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Tente manter os tamanhos das malhas abaixo desses limites:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20.001 <xref:System.Windows.Media.Media3D.Point3D> instâncias<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60,003 <xref:System.Int32> instâncias|  
|<xref:System.Windows.Media.Media3D.Material>|Velocidade do material (mais rápida para mais lenta):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|O [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D não descarta pincéis invisíveis (pincéis de ambiente pretos, pincéis de limpeza, etc.) de uma maneira consistente.  Considere omiti-los da sua cena.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Cada <xref:System.Windows.Media.Media3D.Material> em um <xref:System.Windows.Media.Media3D.MaterialGroup> faz com que outra passagem de renderização, então, incluir vários materiais, até mesmo materiais simples, pode aumentar drasticamente as demandas de preenchimento na sua GPU.  Minimizar o número de materiais em seu <xref:System.Windows.Media.Media3D.MaterialGroup>.|  
  
## <a name="performance-impact-low"></a>Impacto de desempenho: Baixo  
  
|Propriedade|Recomendação|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Quando você não precisa de animação ou associação de dados, em vez de usar um grupo de transformações que contém várias transformações, usam um único <xref:System.Windows.Media.Media3D.MatrixTransform3D>, definindo-a para o produto de todas as transformações existiriam independentemente do grupo de transformação.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimize o número de luzes na sua cena. Ter muitas luzes em uma cena forçará [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] a recuar para a renderização de software.  Os limites são aproximadamente 110 <xref:System.Windows.Media.Media3D.DirectionalLight> objetos, 70 <xref:System.Windows.Media.Media3D.PointLight> objetos ou 40 <xref:System.Windows.Media.Media3D.SpotLight> objetos.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Separar mover objetos de objetos estáticos colocando-os em separado <xref:System.Windows.Media.Media3D.ModelVisual3D> instâncias.  ModelVisual3D é "mais pesado" que <xref:System.Windows.Media.Media3D.GeometryModel3D> porque ele armazena em cache os limites transformados.  O GeometryModel3D é otimizado para ser um modelo. O ModelVisual3D é otimizado para ser um nó da cena.  Use ModelVisual3D para colocar instâncias compartilhadas de GeometryModel3D na cena.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimize o número de vezes que você altera o número de luzes na cena.  Cada alteração da contagem de luz força uma regeneração e recompilação do sombreador, a menos que essa configuração tenha existido anteriormente (e, portanto, tenha o sombreador armazenado em cache).|  
|Claro|As luzes pretas não serão visíveis, mas aumentarão o tempo de renderização. Considere omiti-las.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Para minimizar o tempo de construção de grandes coleções em [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], como um MeshGeometry3D <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>, e <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, pré-dimensione as coleções antes de preencher o valor. Se possível, passe as estruturas de dados pré-preenchidas dos construtores das coleções como matrizes ou listas.|  
  
## <a name="see-also"></a>Consulte também

- [Visão geral de elementos gráficos 3D](3-d-graphics-overview.md)
