---
title: Visão geral dos suplementos do WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 2e5d133a4744124723c0373e3d5974b505936190
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/01/2018
ms.locfileid: "43402095"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="f8c58-102">Visão geral dos suplementos do WPF</span><span class="sxs-lookup"><span data-stu-id="f8c58-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="f8c58-103">O [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] inclui um modelo de suplemento que os desenvolvedores podem usar para criar aplicativos que deem suporte a extensibilidade de suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="f8c58-104">Esse modelo permite a criação de suplementos que integram e estendem a funcionalidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="f8c58-105">Em alguns cenários, os aplicativos também devem exibir [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] que são fornecidas por suplementos. Este tópico mostra como o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aumenta o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para habilitar estes cenários, a arquitetura por trás dele, seus benefícios e suas limitações.</span><span class="sxs-lookup"><span data-stu-id="f8c58-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="f8c58-106">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="f8c58-106">Prerequisites</span></span>  
 <span data-ttu-id="f8c58-107">A familiaridade com o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] é requerida.</span><span class="sxs-lookup"><span data-stu-id="f8c58-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="f8c58-108">Para obter mais informações, consulte [Suplementos e extensibilidade](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="f8c58-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="f8c58-109">Visão geral dos suplementos</span><span class="sxs-lookup"><span data-stu-id="f8c58-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="f8c58-110">Para evitar as complexidades da recompilação do aplicativo e de sua reimplantação para incorporação de uma nova funcionalidade, os aplicativos implementam mecanismos de extensibilidade que permitem aos desenvolvedores (fornecedores principais e terceiros) criar outros aplicativos que se integrem a eles.</span><span class="sxs-lookup"><span data-stu-id="f8c58-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="f8c58-111">A maneira mais comum para dar suporte a esse tipo de extensibilidade é através do uso de suplementos (também conhecidos como "complementos" e "plug-ins").</span><span class="sxs-lookup"><span data-stu-id="f8c58-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="f8c58-112">Exemplos de aplicativos reais que expõem extensibilidade com suplementos incluem:</span><span class="sxs-lookup"><span data-stu-id="f8c58-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="f8c58-113">Complementos do Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="f8c58-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="f8c58-114">Plug-ins do Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="f8c58-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="f8c58-115">Suplementos do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f8c58-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="f8c58-116">Por exemplo, o modelo de suplemento do Windows Media Player permite que desenvolvedores de terceiros implementem "plug-ins" que estendam o Windows Media Player de várias maneiras, incluindo a criação de decodificadores e codificadores para formatos de mídia que não têm suporte nativo pelo Windows Media Player (por exemplo, DVD, MP3), efeitos de áudio e capas.</span><span class="sxs-lookup"><span data-stu-id="f8c58-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="f8c58-117">Cada modelo de suplemento é desenvolvido para expor a funcionalidade que é exclusiva de um aplicativo, embora haja várias entidades e comportamentos que são comuns a todos os modelos de suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="f8c58-118">As três principais entidades das soluções típicas de extensibilidade de suplementos são *contratos*, *suplementos* e *aplicativos host*.</span><span class="sxs-lookup"><span data-stu-id="f8c58-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="f8c58-119">Contratos definem como os suplementos se integram a aplicativos host de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="f8c58-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="f8c58-120">Suplementos se integram à funcionalidade que é implementada por aplicativos host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="f8c58-121">Aplicativos host expõem a funcionalidade que os suplementos se integrem a ela.</span><span class="sxs-lookup"><span data-stu-id="f8c58-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="f8c58-122">Para que suplementos possam ser usados, é necessário que eles sejam localizados e carregados em tempo de execução pelos aplicativos host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="f8c58-123">Consequentemente, os aplicativos que dão suporte a suplementos têm as seguintes responsabilidades adicionais:</span><span class="sxs-lookup"><span data-stu-id="f8c58-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="f8c58-124">**Descoberta**: encontrar suplementos que aderem a contratos com suporte por aplicativos host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="f8c58-125">**Ativação**: carregar, executar e estabelecer comunicação com suplementos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="f8c58-126">**Isolamento**: usar domínios do aplicativo ou processos para estabelecer limites de isolamento que protegem aplicativos de possíveis problemas de execução e segurança com suplementos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="f8c58-127">**Comunicação**: permitir, por meio da chamada de métodos e transmissão de dados, que suplementos e aplicativos host se comuniquem uns com os outros através de limites de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="f8c58-128">**Gerenciamento de tempo de vida**: Carregando e descarregando domínios do aplicativo e processos de uma maneira limpa e previsível (consulte [Domínios do aplicativo](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="f8c58-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="f8c58-129">**Controle de versão**: garantir que os aplicativos host e suplementos possam se comunicar quando novas versões de qualquer um deles forem criadas.</span><span class="sxs-lookup"><span data-stu-id="f8c58-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="f8c58-130">Por fim, desenvolver um modelo de suplemento robusto é uma tarefa não trivial.</span><span class="sxs-lookup"><span data-stu-id="f8c58-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="f8c58-131">Por esse motivo, o [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] fornece uma infraestrutura para o build de modelos de suplementos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f8c58-132">Para obter informações mais detalhadas sobre suplementos, consulte [Suplementos e extensibilidade](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="f8c58-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="f8c58-133">Visão geral de modelo de suplemento do .NET Framework</span><span class="sxs-lookup"><span data-stu-id="f8c58-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="f8c58-134">O [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] suplemento do modelo, encontrado no <xref:System.AddIn> namespace, contém um conjunto de tipos que são projetados para simplificar o desenvolvimento da extensibilidade de suplementos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="f8c58-135">A unidade fundamental do modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] é o *contrato*, que define como um aplicativo host e um suplemento se comunicam um com o outro.</span><span class="sxs-lookup"><span data-stu-id="f8c58-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="f8c58-136">Um contrato é exposto a um aplicativo host utilizando uma *exibição* do contrato específica do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="f8c58-137">Da mesma forma, uma *exibição* do contrato específica do suplemento é exposta ao suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="f8c58-138">Um *adaptador* é usado para permitir que um aplicativo host e um suplemento se comuniquem entre suas respectivas exibições do contrato.</span><span class="sxs-lookup"><span data-stu-id="f8c58-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="f8c58-139">Contratos, exibições e adaptadores são referidos como segmentos, enquanto um conjunto de segmentos relacionados constitui um *pipeline*.</span><span class="sxs-lookup"><span data-stu-id="f8c58-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="f8c58-140">Pipelines são a base sobre a qual o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dá suporte à descoberta, ativação, isolamento de segurança, isolamento de execução (usando tanto processos quanto domínios do aplicativo), comunicação, gerenciamento de tempo de vida e controle de versão.</span><span class="sxs-lookup"><span data-stu-id="f8c58-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="f8c58-141">A soma desse suporte permite aos desenvolvedores compilar suplementos que se integram com a funcionalidade de um aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="f8c58-142">No entanto, alguns cenários exigem que os aplicativos host exibam [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fornecidas pelos suplementos. Já que cada tecnologia de apresentação no [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] tem seu próprio modelo para implementação de [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] não dá suporte a nenhuma tecnologia de apresentação específica.</span><span class="sxs-lookup"><span data-stu-id="f8c58-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="f8c58-143">Em vez disso, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] com suporte da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a suplementos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="f8c58-144">Suplementos do WPF</span><span class="sxs-lookup"><span data-stu-id="f8c58-144">WPF Add-Ins</span></span>  
 <span data-ttu-id="f8c58-145">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], em conjunto com o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], permite que você direcione uma ampla variedade de cenários que exigem que os aplicativos de host para exibir [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] dos suplementos. Em particular, estes cenários são endereçados pelo [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] com os dois modelos de programação a seguir:</span><span class="sxs-lookup"><span data-stu-id="f8c58-145">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="f8c58-146">**O suplemento retorna uma interface do usuário**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="f8c58-147">Um suplemento retorna uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ao aplicativo host via uma chamada de método, conforme definido pelo contrato.</span><span class="sxs-lookup"><span data-stu-id="f8c58-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="f8c58-148">Esse cenário é utilizado nos seguintes casos:</span><span class="sxs-lookup"><span data-stu-id="f8c58-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="f8c58-149">A aparência de uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que é retornada por um suplemento é dependente de dados ou condições que existem somente em tempo de execução, por exemplo, relatórios gerados dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="f8c58-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="f8c58-150">A [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] para serviços fornecidos por um suplemento difere da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dos aplicativos host que podem usar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="f8c58-151">Como funções principais, o suplemento executa um serviço para o aplicativo host e relata o status ao aplicativo host com uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="f8c58-152">**O suplemento é uma interface do usuário**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-152">**The add-in is a UI**.</span></span> <span data-ttu-id="f8c58-153">Um suplemento é uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], conforme definido pelo contrato.</span><span class="sxs-lookup"><span data-stu-id="f8c58-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="f8c58-154">Esse cenário é utilizado nos seguintes casos:</span><span class="sxs-lookup"><span data-stu-id="f8c58-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="f8c58-155">Um suplemento não fornece nenhum serviço além de ser exibido, por exemplo, um anúncio.</span><span class="sxs-lookup"><span data-stu-id="f8c58-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="f8c58-156">A [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] para serviços fornecidos por um suplemento é comum a todos os aplicativos host que podem usar esse suplemento, por exemplo, uma calculadora ou um seletor de cor.</span><span class="sxs-lookup"><span data-stu-id="f8c58-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="f8c58-157">Esses cenários exigem que objetos de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] possam ser passados entre aplicativos host e domínios do aplicativo do suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="f8c58-158">Uma vez que o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] depende da comunicação remota para a comunicação entre domínios do aplicativo, os objetos que são passados entre eles devem ser remotos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="f8c58-159">Um objeto remoto é uma instância de uma classe que satisfaz uma ou mais das condições a seguir:</span><span class="sxs-lookup"><span data-stu-id="f8c58-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="f8c58-160">Deriva o <xref:System.MarshalByRefObject> classe.</span><span class="sxs-lookup"><span data-stu-id="f8c58-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="f8c58-161">Implementa a interface <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="f8c58-162">Tem o <xref:System.SerializableAttribute> atributo aplicado.</span><span class="sxs-lookup"><span data-stu-id="f8c58-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f8c58-163">Para obter mais informações sobre a criação de objetos [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] remotos, consulte [Transformar os objetos em remotos](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="f8c58-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="f8c58-164">Os tipos de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] não são remotos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="f8c58-165">Para resolver o problema, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para habilitar uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] criada pelos suplementos para ser exibida de aplicativos host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="f8c58-166">Esse suporte é fornecido por [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] por dois tipos: o <xref:System.AddIn.Contract.INativeHandleContract> interface e dois métodos estáticos implementados pela <xref:System.AddIn.Pipeline.FrameworkElementAdapters> classe: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="f8c58-167">Em um nível elevado, esses tipos e métodos são usados da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="f8c58-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="f8c58-168"> requer que [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fornecidos por suplementos são classes que derivam direta ou indiretamente de <xref:System.Windows.FrameworkElement>, como formas, controles, controles de usuário, painéis de layout e páginas.</span><span class="sxs-lookup"><span data-stu-id="f8c58-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="f8c58-169">Aonde o contrato declarar que uma interface do usuário será transmitida entre o suplemento e o aplicativo host, ele deve ser declarado como um <xref:System.AddIn.Contract.INativeHandleContract> (não um <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> é uma representação remota do suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que pode ser passada entre limites de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="f8c58-170">Antes de ser transmitido do domínio de aplicativo do suplemento, um <xref:System.Windows.FrameworkElement> é empacotado como um <xref:System.AddIn.Contract.INativeHandleContract> chamando <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="f8c58-171">Após ser transmitido ao domínio de aplicativo do aplicativo host, o <xref:System.AddIn.Contract.INativeHandleContract> deve ser reempacotado como um <xref:System.Windows.FrameworkElement> chamando <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="f8c58-172">Como <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> são usados dependendo do cenário específico.</span><span class="sxs-lookup"><span data-stu-id="f8c58-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="f8c58-173">As seções a seguir fornecem detalhes para cada modelo de programação.</span><span class="sxs-lookup"><span data-stu-id="f8c58-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="f8c58-174">O suplemento retorna uma interface do usuário</span><span class="sxs-lookup"><span data-stu-id="f8c58-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="f8c58-175">Para um suplemento retornar uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] para um aplicativo host, é necessário o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="f8c58-176">O aplicativo host, o suplemento e o pipeline devem ser criados, conforme descrito pela documentação [Suplementos e extensibilidade](../../../../docs/framework/add-ins/index.md) do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="f8c58-177">O contrato deve implementar <xref:System.AddIn.Contract.IContract> e, para retornar um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], o contrato deve declarar um método com um valor de retorno do tipo <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="f8c58-178">O [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que é passado entre o suplemento e o host de aplicativo deve derivar direta ou indiretamente de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="f8c58-179">O [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que é retornado pelo suplemento deve ser convertido de um <xref:System.Windows.FrameworkElement> para um <xref:System.AddIn.Contract.INativeHandleContract> antes de cruzar o limite de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="f8c58-180">O [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que é retornado deve ser convertido de um <xref:System.AddIn.Contract.INativeHandleContract> para um <xref:System.Windows.FrameworkElement> depois de cruzar o limite de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="f8c58-181">O aplicativo host exibe retornado <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="f8c58-182">Para obter um exemplo que demonstra como implementar um suplemento que retorna um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], consulte [Criar um suplemento que retorna uma interface do usuário](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="f8c58-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="f8c58-183">O suplemento é uma interface do usuário</span><span class="sxs-lookup"><span data-stu-id="f8c58-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="f8c58-184">Quando um suplemento é uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], há os requisitos a seguir:</span><span class="sxs-lookup"><span data-stu-id="f8c58-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="f8c58-185">O aplicativo host, o suplemento e o pipeline devem ser criados, conforme descrito pela documentação [Suplementos e extensibilidade](../../../../docs/framework/add-ins/index.md) do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="f8c58-186">A interface de contrato para o suplemento deve implementar <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="f8c58-187">O suplemento que é passado para o aplicativo host deve derivar direta ou indiretamente de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="f8c58-188">O suplemento deve ser convertido de um <xref:System.Windows.FrameworkElement> para um <xref:System.AddIn.Contract.INativeHandleContract> antes de cruzar o limite de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="f8c58-189">O suplemento deve ser convertido de um <xref:System.AddIn.Contract.INativeHandleContract> para um <xref:System.Windows.FrameworkElement> depois de cruzar o limite de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="f8c58-190">O aplicativo host exibe retornado <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="f8c58-191">Para obter um exemplo que demonstra como implementar um suplemento que é uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], consulte [Criar um suplemento que é uma interface do usuário](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="f8c58-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="f8c58-192">Retornando múltiplas interfaces do usuário de um suplemento</span><span class="sxs-lookup"><span data-stu-id="f8c58-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="f8c58-193">Suplementos muitas vezes fornecem várias [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] para serem exibidas por aplicativos de host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="f8c58-194">Por exemplo, considere um suplemento que é uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que também fornece informações de status ao aplicativo host, também como uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="f8c58-195">Um suplemento como esse pode ser implementado pelo uso de uma combinação de técnicas de ambos os modelos [O suplemento retorna uma interface do usuário](#ReturnUIFromAddInContract) e [O suplemento é uma interface do usuário](#AddInIsAUI).</span><span class="sxs-lookup"><span data-stu-id="f8c58-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="f8c58-196">Suplementos e aplicativos de navegação XAML</span><span class="sxs-lookup"><span data-stu-id="f8c58-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="f8c58-197">Nos exemplos até agora, o aplicativo host tem sido um aplicativo autônomo instalado.</span><span class="sxs-lookup"><span data-stu-id="f8c58-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="f8c58-198">Mas [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] também podem hospedar suplementos, embora com os seguintes requisitos adicionais de build e implementação:</span><span class="sxs-lookup"><span data-stu-id="f8c58-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="f8c58-199">O manifesto do aplicativo [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deve ser configurado especialmente para baixar o pipeline (pastas e assemblies) e o assembly do suplemento para o cache do aplicativo [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] no computador cliente, na mesma pasta que o [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="f8c58-200">O código do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] para descobrir e carregar suplementos deve usar o cache de aplicativo [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] para o [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] como o local do pipeline e do suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="f8c58-201">O [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deverá carregar o suplemento em um contexto de segurança especial se o suplemento fizer referência a arquivos flexíveis localizados no site de origem; quando hospedados por [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], suplementos poderão referenciar apenas arquivos flexíveis localizados no site de origem do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="f8c58-202">Essas tarefas são descritas detalhadamente nas subseções a seguir.</span><span class="sxs-lookup"><span data-stu-id="f8c58-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="f8c58-203">Configurar o pipeline e o suplemento para a implantação do ClickOnce</span><span class="sxs-lookup"><span data-stu-id="f8c58-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="f8c58-204"> são baixados e executados de uma pasta segura no cache de implantação do [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="f8c58-205">Para que um [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] hospede um suplemento, o assembly do suplemento e do pipeline também devem ser baixados para a pasta segura.</span><span class="sxs-lookup"><span data-stu-id="f8c58-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="f8c58-206">Para fazer isso, você precisa configurar o manifesto do aplicativo para incluir ambos o assembly do suplemento e do pipeline para baixar.</span><span class="sxs-lookup"><span data-stu-id="f8c58-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="f8c58-207">Isso é feito com mais facilidade no [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], embora o assembly do suplemento e o do pipeline precisem estar na pasta raiz do projeto do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] host para que [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] detecte os assemblies do pipeline.</span><span class="sxs-lookup"><span data-stu-id="f8c58-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="f8c58-208">Consequentemente, a primeira etapa é compilar o assembly do suplemento e do pipeline para a raiz do projeto do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], definindo a saída de build de cada projeto de assembly do pipeline e do suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="f8c58-209">A tabela a seguir mostra os caminhos de saída de build para projetos de assembly do pipeline e projetos de assembly do suplemento que estão na mesma solução e pasta raiz que o projeto do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="f8c58-210">Tabela 1: caminhos de saída de build para os assemblies do pipeline hospedados por um XBAP</span><span class="sxs-lookup"><span data-stu-id="f8c58-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="f8c58-211">Projeto de assembly do pipeline</span><span class="sxs-lookup"><span data-stu-id="f8c58-211">Pipeline assembly project</span></span>|<span data-ttu-id="f8c58-212">Caminho de saída de build</span><span class="sxs-lookup"><span data-stu-id="f8c58-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="f8c58-213">Contrato</span><span class="sxs-lookup"><span data-stu-id="f8c58-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="f8c58-214">Exibição do suplemento</span><span class="sxs-lookup"><span data-stu-id="f8c58-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="f8c58-215">Adaptador no lado do suplemento</span><span class="sxs-lookup"><span data-stu-id="f8c58-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="f8c58-216">Adaptador no lado do host</span><span class="sxs-lookup"><span data-stu-id="f8c58-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="f8c58-217">Suplemento</span><span class="sxs-lookup"><span data-stu-id="f8c58-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="f8c58-218">A próxima etapa é especificar os assemblies de pipeline e o assembly do suplemento como os arquivos de conteúdo do [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] em [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], fazendo o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="f8c58-219">Incluindo o assembly do pipeline e do suplemento no projeto clicando com o botão direito do mouse em cada pasta de pipeline no Gerenciador de Soluções e escolhendo **Incluir no Projeto**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="f8c58-220">Definindo a **Ação de Build** de cada assembly do pipeline e assembly do suplemento para **Conteúdo** da janela **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="f8c58-221">A etapa final é configurar o manifesto do aplicativo para incluir os arquivos do assembly do pipeline e o arquivo do assembly do suplemento para download.</span><span class="sxs-lookup"><span data-stu-id="f8c58-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="f8c58-222">Os arquivos devem estar localizados em pastas na raiz da pasta no cache do [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] que o aplicativo [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] ocupa.</span><span class="sxs-lookup"><span data-stu-id="f8c58-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="f8c58-223">A configuração pode ser obtida em [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], fazendo o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="f8c58-224">Clique com o botão direito do mouse no projeto do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], clique em **Propriedades**, clique em **Publicar** e, em seguida, clique no botão **Arquivos de Aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="f8c58-225">Na caixa de diálogo **Arquivos de Aplicativo**, defina o **Status da Publicação** de cada DLL de suplemento e de pipeline a **Incluir (Auto)** e defina o **Grupo de Download** para cada DLL de pipeline e de suplemento para **(Obrigatório)**.</span><span class="sxs-lookup"><span data-stu-id="f8c58-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="f8c58-226">Usando o pipeline e o suplemento da base de aplicativo</span><span class="sxs-lookup"><span data-stu-id="f8c58-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="f8c58-227">Quando o pipeline e o suplemento são configurados para a implantação do [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], eles são baixados para a mesma pasta de cache do [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] que o [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="f8c58-228">Para usar o pipeline e o suplemento por meio do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], o código do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] deve obtê-los da base de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="f8c58-229">Os diversos tipos e membros do modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para usar pipelines e suplementos dão suporte especial para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="f8c58-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="f8c58-230">Em primeiro lugar, o caminho é identificado pelo <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> valor de enumeração.</span><span class="sxs-lookup"><span data-stu-id="f8c58-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="f8c58-231">Você pode usar esse valor com sobrecargas de membros de suplemento pertinentes para usar pipelines que incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="f8c58-232">Acessar o site de origem do host</span><span class="sxs-lookup"><span data-stu-id="f8c58-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="f8c58-233">Para garantir que um suplemento possa referenciar arquivos do site de origem, o suplemento deve ser carregado com isolamento de segurança que é equivalente ao do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="f8c58-234">Esse nível de segurança é identificado pelo <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> valor de enumeração e passado para o <xref:System.AddIn.Hosting.AddInToken.Activate%2A> método quando um suplemento é ativado.</span><span class="sxs-lookup"><span data-stu-id="f8c58-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="f8c58-235">Arquitetura de suplemento do WPF</span><span class="sxs-lookup"><span data-stu-id="f8c58-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="f8c58-236">O nível mais alto, como vimos, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] habilita [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] suplementos para implementar [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (que derivam direta ou indiretamente <xref:System.Windows.FrameworkElement>) usando <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="f8c58-237">O resultado é que o aplicativo host é retornado um <xref:System.Windows.FrameworkElement> que é exibido da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] no aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="f8c58-238">Para cenários de suplemento de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] simples, isso é o máximo de detalhamento de que um desenvolvedor precisa.</span><span class="sxs-lookup"><span data-stu-id="f8c58-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="f8c58-239">Para cenários mais complexos, especialmente aqueles que tentam utilizar serviços [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adicionais como o layout, recursos e associação de dados, um conhecimento mais detalhado de como o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] com suporte à [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] é necessário para entender seus benefícios e limitações.</span><span class="sxs-lookup"><span data-stu-id="f8c58-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="f8c58-240">Fundamentalmente, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] não transmite uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de um suplemento para um aplicativo host; em vez disso, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passa o identificador de janela do Win32 para a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] usando a interoperabilidade do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="f8c58-241">Assim, quando uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de um suplemento é transmitida ao aplicativo host, ocorre o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="f8c58-242">No lado do suplemento, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adquire um identificador de janela para a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que será exibida pelo aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="f8c58-243">O identificador de janela é encapsulado por interno [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe que deriva <xref:System.Windows.Interop.HwndSource> e implementa <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="f8c58-244">Uma instância dessa classe é retornada por <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> e é empacotada do domínio de aplicativo do suplemento ao domínio de aplicativo do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="f8c58-245">No lado do aplicativo de host [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] reempacota o <xref:System.Windows.Interop.HwndSource> como interno [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe que deriva de <xref:System.Windows.Interop.HwndHost> e consome <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="f8c58-246">Uma instância dessa classe é retornada por <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> para o aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="f8c58-247"><xref:System.Windows.Interop.HwndHost> existe para exibir [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identificadas por identificadores de janela de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="f8c58-248">Para obter mais informações, consulte [Interoperação Win32 e WPF](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="f8c58-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="f8c58-249">Em resumo, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, e <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> existem para permitir que o identificador de janela para um [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] seja transmitido de um suplemento para um aplicativo host, onde ele é encapsulado por um <xref:System.Windows.Interop.HwndHost> e exibido o host aplicativo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f8c58-250">Como o aplicativo host recebe um <xref:System.Windows.Interop.HwndHost>, o aplicativo host não é possível converter o objeto que é retornado por <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> para o tipo é implementado pelo suplemento (por exemplo, um <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="f8c58-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="f8c58-251">Por sua natureza, <xref:System.Windows.Interop.HwndHost> tem certas limitações que afetam como aplicativos host podem utilizá-los.</span><span class="sxs-lookup"><span data-stu-id="f8c58-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="f8c58-252">No entanto, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estende <xref:System.Windows.Interop.HwndHost> com vários recursos para cenários de suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="f8c58-253">Essas limitações e benefícios são descritos abaixo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="f8c58-254">Benefícios de suplementos do WPF</span><span class="sxs-lookup"><span data-stu-id="f8c58-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="f8c58-255">Porque [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] suplemento [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] são exibidas em aplicativos host usando uma classe interna que deriva <xref:System.Windows.Interop.HwndHost>, aqueles [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] são limitadas pelas funcionalidades da <xref:System.Windows.Interop.HwndHost> com relação ao [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] serviços como o layout, renderização, vinculação de dados, estilos, modelos e recursos.</span><span class="sxs-lookup"><span data-stu-id="f8c58-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="f8c58-256">No entanto, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aumenta sua interno <xref:System.Windows.Interop.HwndHost> subclasse com recursos adicionais que incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f8c58-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="f8c58-257">Navegar com a tecla tab entre a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de um aplicativo host e a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de um suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="f8c58-258">Observe que o "suplemento é um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" modelo de programação requer que o adaptador do lado do suplemento substituir <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> para habilitar tabulações, seja o suplemento é totalmente confiável ou parcialmente confiável.</span><span class="sxs-lookup"><span data-stu-id="f8c58-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="f8c58-259">Respeitar requisitos de acessibilidade para [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de suplemento que são exibidas em [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="f8c58-260">Habilitar a execução segura dos aplicativos [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] em vários cenários de domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="f8c58-261">Impedir o acesso a identificadores de janela da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do suplemento quando os suplementos são executados com isolamento de segurança (ou seja, uma área restrita de confiança parcial).</span><span class="sxs-lookup"><span data-stu-id="f8c58-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="f8c58-262">Chamar <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> garante essa segurança:</span><span class="sxs-lookup"><span data-stu-id="f8c58-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="f8c58-263">Para o "suplemento retorna uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" modelo de programação, a única maneira de passar o identificador de janela para um suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] entre o isolamento de limite é chamar <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="f8c58-264">Para o "suplemento é um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" de programação de modelo, substituindo <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> no adaptador do lado do suplemento e chamar <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (conforme mostrado nos exemplos anteriores) é necessária, como é chamar o adaptador lado do suplemento `QueryContract` implementação do adaptador do host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="f8c58-265">Fornecer proteção contra múltiplas execuções de domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="f8c58-266">Devido a limitações com domínios do aplicativo, as exceções sem tratamento que forem lançadas em domínios do aplicativo do suplemento fazem com que todo o aplicativo falhe, mesmo com a existência do limite de isolamento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="f8c58-267">No entanto, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] e o modelo de suplemento do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] oferecem uma forma simples de solucionar esse problema e melhorar a estabilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="f8c58-268">Um [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] suplemento que exibe uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cria um <xref:System.Windows.Threading.Dispatcher> para o thread que o domínio de aplicativo é executado, se o aplicativo host é um [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="f8c58-269">Você pode detectar exceções sem tratamento que ocorrem no domínio do aplicativo manipulando o <xref:System.Windows.Threading.Dispatcher.UnhandledException> eventos do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] suplemento <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="f8c58-270">Você pode obter o <xref:System.Windows.Threading.Dispatcher> do <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="f8c58-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="f8c58-271">Limitações de suplementos WPF</span><span class="sxs-lookup"><span data-stu-id="f8c58-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="f8c58-272">Além dos benefícios que [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adiciona os comportamentos padrão fornecidos pelo <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>e identificadores de janela, também há limitações para suplemento [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] que são exibidas em aplicativos host:</span><span class="sxs-lookup"><span data-stu-id="f8c58-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="f8c58-273">As [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de suplemento exibidas de um aplicativo host não respeitam o comportamento de recorte do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="f8c58-274">O conceito de *espaço aéreo* em cenários de interoperabilidade também se aplica a suplementos (consulte [Visão geral das regiões de tecnologia](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="f8c58-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="f8c58-275">Os serviços de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de um aplicativo host, tais como herança de recursos, associação de dados e comandos, não estão automaticamente disponíveis para [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="f8c58-276">Para fornecer esses serviços para o suplemento, você precisa atualizar o pipeline.</span><span class="sxs-lookup"><span data-stu-id="f8c58-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="f8c58-277">Uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento não pode ser girada, dimensionada, distorcida e nem ser afetada de nenhuma outra forma por uma transformação (consulte [Visão geral de transformações](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="f8c58-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="f8c58-278">Conteúdo dentro do suplemento [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] que é renderizado por operações de desenho a <xref:System.Drawing> namespace pode incluir combinação alfa.</span><span class="sxs-lookup"><span data-stu-id="f8c58-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="f8c58-279">No entanto, tanto uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento quanto a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do aplicativo host que o contém devem ser 100% opacas; em outras palavras, a propriedade `Opacity` em ambas deve ser definida como 1.</span><span class="sxs-lookup"><span data-stu-id="f8c58-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="f8c58-280">Se o <xref:System.Windows.Window.AllowsTransparency%2A> propriedade de uma janela no aplicativo host que contém um suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] é definido como `true`, o suplemento é invisível.</span><span class="sxs-lookup"><span data-stu-id="f8c58-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="f8c58-281">Isso será verdadeiro mesmo se a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do suplemento for 100% opaca (ou seja, se a propriedade `Opacity` tiver um valor de 1).</span><span class="sxs-lookup"><span data-stu-id="f8c58-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="f8c58-282">Uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento deve aparecer sobre outros elementos do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] na mesma janela de nível superior.</span><span class="sxs-lookup"><span data-stu-id="f8c58-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="f8c58-283">Nenhuma parte de um suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pode ser renderizado usando um <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="f8c58-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="f8c58-284">Em vez disso, o suplemento poderá tirar um instantâneo da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] gerada para criar um bitmap que poderá ser passado para o aplicativo host usando métodos definidos pelo contrato.</span><span class="sxs-lookup"><span data-stu-id="f8c58-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="f8c58-285">Arquivos de mídia não podem ser executados de um <xref:System.Windows.Controls.MediaElement> em um suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8c58-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="f8c58-286">Eventos do mouse gerados para a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento não são recebidos nem gerados pelo aplicativo host e a propriedade `IsMouseOver` da [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do aplicativo host tem um valor de `false`.</span><span class="sxs-lookup"><span data-stu-id="f8c58-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="f8c58-287">Quando o foco alterna entre os controles em uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento, os eventos `GotFocus` e `LostFocus` não são recebidos nem acionados pelo aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="f8c58-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="f8c58-288">A parte de um aplicativo host que contém uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de suplemento aparece em branco quando impressa.</span><span class="sxs-lookup"><span data-stu-id="f8c58-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="f8c58-289">Todos os dispatchers (consulte <xref:System.Windows.Threading.Dispatcher>) criado pelo suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] devem ser desligados manualmente antes que o suplemento proprietário seja descarregado se o aplicativo host continua a execução.</span><span class="sxs-lookup"><span data-stu-id="f8c58-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="f8c58-290">O contrato pode implementar métodos que permitam que o aplicativo host sinalize o suplemento antes que este seja descarregado, permitindo assim que a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] do suplemento desligue seus dispatchers.</span><span class="sxs-lookup"><span data-stu-id="f8c58-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="f8c58-291">Se um suplemento [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] é um <xref:System.Windows.Controls.InkCanvas> ou contém um <xref:System.Windows.Controls.InkCanvas>, é possível descarregar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="f8c58-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="f8c58-292">Otimização do desempenho</span><span class="sxs-lookup"><span data-stu-id="f8c58-292">Performance Optimization</span></span>  
 <span data-ttu-id="f8c58-293">Por padrão, quando vários domínios do aplicativo são usados, os diversos assemblies do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] exigidos por cada aplicativo são todos carregados nesse domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8c58-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="f8c58-294">Como resultado, o tempo necessário para criar novos domínios de aplicativo e iniciar aplicativos neles pode afetar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="f8c58-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="f8c58-295">No entanto, o [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] fornece uma maneira de reduzir os tempos de inicialização instruindo os aplicativos a compartilhar assemblies entre domínios do aplicativo se eles já estão carregados.</span><span class="sxs-lookup"><span data-stu-id="f8c58-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="f8c58-296">Você pode fazer isso usando o <xref:System.LoaderOptimizationAttribute> atributo, que deve ser aplicado ao método de ponto de entrada (`Main`).</span><span class="sxs-lookup"><span data-stu-id="f8c58-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="f8c58-297">Nesse caso, você deve usar apenas código para implementar sua definição de aplicativo (consulte [Visão geral de gerenciamento do aplicativo](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="f8c58-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8c58-298">Consulte também</span><span class="sxs-lookup"><span data-stu-id="f8c58-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="f8c58-299">Suplementos e extensibilidade</span><span class="sxs-lookup"><span data-stu-id="f8c58-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="f8c58-300">Domínios do aplicativo</span><span class="sxs-lookup"><span data-stu-id="f8c58-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="f8c58-301">Visão geral de comunicação remota do .NET framework</span><span class="sxs-lookup"><span data-stu-id="f8c58-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="f8c58-302">Tornando os objetos em remotos</span><span class="sxs-lookup"><span data-stu-id="f8c58-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="f8c58-303">Tópicos de instruções</span><span class="sxs-lookup"><span data-stu-id="f8c58-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
