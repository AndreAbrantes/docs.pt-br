---
title: Interoperação Win32 e WPF
ms.date: 03/30/2017
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
ms.openlocfilehash: 997ea7bd1c18d3817457ad109cd611c989f50d8a
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64650727"
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="d4f40-102">Interoperação Win32 e WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-102">WPF and Win32 Interoperation</span></span>
<span data-ttu-id="d4f40-103">Este tópico fornece uma visão geral de como interoperar o código do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span> <span data-ttu-id="d4f40-104">O [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] fornece um ambiente sofisticado para criação de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d4f40-104">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications.</span></span> <span data-ttu-id="d4f40-105">No entanto, quando você tem um investimento significativo em código do [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)], pode ser mais eficiente reutilizar parte desse código.</span><span class="sxs-lookup"><span data-stu-id="d4f40-105">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to reuse some of that code.</span></span>  

<a name="basics"></a>   
## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="d4f40-106">Noções básicas de interoperação entre o Win32 e o WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-106">WPF and Win32 Interoperation Basics</span></span>  
 <span data-ttu-id="d4f40-107">Há duas técnicas básicas de interoperação entre o código do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
- <span data-ttu-id="d4f40-108">Hospedar conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] em uma janela do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="d4f40-109">Com essa técnica, você pode usar as capacidades gráficas avançadas do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dentro da estrutura de uma janela e de um aplicativo padrão do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window and application.</span></span>  
  
- <span data-ttu-id="d4f40-110">Hospedar uma janela do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] no conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-110">Host a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="d4f40-111">Com essa técnica, você pode usar um controle do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] personalizado no contexto de outro conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e passar dados entre os limites.</span><span class="sxs-lookup"><span data-stu-id="d4f40-111">With this technique, you can use an existing custom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>  
  
 <span data-ttu-id="d4f40-112">Essas duas técnicas são apresentadas conceitualmente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="d4f40-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="d4f40-113">Para obter uma ilustração mais orientada a código de hospedagem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] na [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], consulte [passo a passo: Hospedando conteúdo do WPF no Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], see [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="d4f40-114">Para obter uma ilustração mais orientada a código de hospedagem [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], consulte [passo a passo: Hospedando um controle Win32 no WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-114">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
<a name="projects"></a>   
## <a name="wpf-interoperation-projects"></a><span data-ttu-id="d4f40-115">Projetos de interoperação do WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-115">WPF Interoperation Projects</span></span>  
 <span data-ttu-id="d4f40-116">As [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] são códigos gerenciados, mas a maioria dos programas do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] existentes são gravados em [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="d4f40-116">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] are managed code, but most existing [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programs are written in unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="d4f40-117">Não é possível chamar [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de um programa realmente não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="d4f40-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] from a true unmanaged program.</span></span> <span data-ttu-id="d4f40-118">No entanto, usando a opção `/clr` com o compilador [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)], você pode criar um programa misto gerenciado e não gerenciado no qual pode misturar perfeitamente chamadas de [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] gerenciadas e não gerenciadas.</span><span class="sxs-lookup"><span data-stu-id="d4f40-118">However, by using the `/clr` option with the [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] calls.</span></span>  
  
 <span data-ttu-id="d4f40-119">Uma complicação no nível do projeto é que você não pode compilar arquivos [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] em um projeto [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] project.</span></span>  <span data-ttu-id="d4f40-120">Há várias técnicas de divisão de projeto para compensar isso.</span><span class="sxs-lookup"><span data-stu-id="d4f40-120">There are several project division techniques to compensate for this.</span></span>  
  
- <span data-ttu-id="d4f40-121">Criar uma DLL do c# que contém todos os seus [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] páginas como um assembly compilado e, em seguida, ter seu [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] executável incluem que [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] como uma referência.</span><span class="sxs-lookup"><span data-stu-id="d4f40-121">Create a C# DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] executable include that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] as a reference.</span></span>  
  
- <span data-ttu-id="d4f40-122">Criar um c# executável para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de conteúdo e a fazer referência a um [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] que contém o [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d4f40-122">Create a C# executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] that contains the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
- <span data-ttu-id="d4f40-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> para carregar qualquer [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] em tempo de execução, em vez de compilar seu [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>  
  
- <span data-ttu-id="d4f40-124">Não use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] e gravar todos os seus [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] no código, construindo a árvore de elementos de <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>  
  
 <span data-ttu-id="d4f40-125">Use a abordagem que funcionar melhor para você.</span><span class="sxs-lookup"><span data-stu-id="d4f40-125">Use whatever approach works best for you.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d4f40-126">Se você nunca usou [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], poderá notar algumas palavras-chave "novas", como `gcnew` e `nullptr` nos exemplos de código de interoperação.</span><span class="sxs-lookup"><span data-stu-id="d4f40-126">If you have not used [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="d4f40-127">Essas palavras-chave substituem a antiga sintaxe com sublinhado duplo (`__gc`) e fornecem uma sintaxe mais natural para o código gerenciado em [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="d4f40-128">Para saber mais sobre as funcionalidades gerenciadas [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], consulte [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms) (Extensões de componente para plataformas de tempo de execução) e [Hello, C++/CLI](https://go.microsoft.com/fwlink/?LinkId=98739) (Olá, C++/CLI).</span><span class="sxs-lookup"><span data-stu-id="d4f40-128">To learn more about the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms) and [Hello, C++/CLI](https://go.microsoft.com/fwlink/?LinkId=98739).</span></span>  
  
<a name="hwnds"></a>   
## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="d4f40-129">Como o WPF usa Hwnds</span><span class="sxs-lookup"><span data-stu-id="d4f40-129">How WPF Uses Hwnds</span></span>  
 <span data-ttu-id="d4f40-130">Para aproveitar ao máximo a "Interoperabilidade de HWND" do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], você precisa entender como o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usa HWNDs.</span><span class="sxs-lookup"><span data-stu-id="d4f40-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="d4f40-131">Para qualquer HWND, você não pode combinar a renderização do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] com a renderização do [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] ou a renderização do [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] / [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] rendering or [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] / [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)] rendering.</span></span> <span data-ttu-id="d4f40-132">Isso tem várias implicações.</span><span class="sxs-lookup"><span data-stu-id="d4f40-132">This has a number of implications.</span></span> <span data-ttu-id="d4f40-133">Basicamente, para combinar esses modelos de renderização, você deve criar uma solução de interoperabilidade e usar segmentos de interoperação designados para cada modelo de renderização que optar usar.</span><span class="sxs-lookup"><span data-stu-id="d4f40-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="d4f40-134">Além disso, o comportamento de renderização cria uma restrição de "espaço aéreo" para o que sua solução de interoperação pode realizar.</span><span class="sxs-lookup"><span data-stu-id="d4f40-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="d4f40-135">O conceito de "espaço aéreo" é explicado com mais detalhes no tópico [Visão geral das regiões de tecnologia](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>  
  
 <span data-ttu-id="d4f40-136">Todos os elementos do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] na tela, por fim, contam com um HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="d4f40-137">Quando você cria um [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] cria um HWND de alto nível e usa um <xref:System.Windows.Interop.HwndSource> colocar o <xref:System.Windows.Window> e sua [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo dentro do HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="d4f40-138">O restante do seu conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] no aplicativo compartilha aquele único HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="d4f40-139">Uma exceção são menus, caixas de combinação suspensas e outros pop-ups.</span><span class="sxs-lookup"><span data-stu-id="d4f40-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="d4f40-140">Esses elementos criam sua própria janela de nível superior, razão pela qual um menu do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pode passar da borda do HWND da janela que o contém.</span><span class="sxs-lookup"><span data-stu-id="d4f40-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="d4f40-141">Quando você usa <xref:System.Windows.Interop.HwndHost> para colocar um HWND dentro [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informa [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] como posicionar o novo HWND filho em relação para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>  
  
 <span data-ttu-id="d4f40-142">Um conceito relacionado a HWND é a transparência dentro e entre cada HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="d4f40-143">Isso também é discutido no tópico [Visão geral das regiões de tecnologia](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-143">This is also discussed in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>  
  
<a name="hosting_a_wpf_page"></a>   
## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="d4f40-144">Hospedando conteúdo do WPF em uma janela do Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="d4f40-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>  
 <span data-ttu-id="d4f40-145">A chave para hospedar uma [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela é o <xref:System.Windows.Interop.HwndSource> classe.</span><span class="sxs-lookup"><span data-stu-id="d4f40-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="d4f40-146">Essa classe encapsula o conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] em uma janela do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], para que o conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] possa ser incorporado na [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] como uma janela filho.</span><span class="sxs-lookup"><span data-stu-id="d4f40-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="d4f40-147">A abordagem a seguir combina o [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] em um único aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d4f40-147">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="d4f40-148">Implemente o conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (o elemento de conteúdo raiz) como uma classe gerenciada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="d4f40-149">Normalmente, a classe herda de uma das classes que podem conter vários elementos filho e/ou usado como um elemento raiz, como <xref:System.Windows.Controls.DockPanel> ou <xref:System.Windows.Controls.Page>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="d4f40-150">Nas próximas etapas, essa classe será mencionada como classe de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e as instâncias da classe serão mencionadas como objetos de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>  
  
2. <span data-ttu-id="d4f40-151">Implementar um aplicativo [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] com [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-151">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span></span> <span data-ttu-id="d4f40-152">Se você está começando com um aplicativo [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] não gerenciado existente, normalmente, é possível habilitá-lo para chamar o código gerenciado alterando as configurações do projeto para incluir o sinalizador do compilador `/clr` (o escopo completo do que pode ser necessário para dar suporte à compilação `/clr` não está descrita neste tópico).</span><span class="sxs-lookup"><span data-stu-id="d4f40-152">If you are starting with an existing unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>  
  
3. <span data-ttu-id="d4f40-153">Defina o modelo de threading para STA (Single-Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="d4f40-153">Set the threading model to Single Threaded Apartment (STA).</span></span> <span data-ttu-id="d4f40-154">O [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usa esse modelo de threading.</span><span class="sxs-lookup"><span data-stu-id="d4f40-154">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses this threading model.</span></span>  
  
4. <span data-ttu-id="d4f40-155">Identifique a notificação WM_CREATE no seu procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="d4f40-155">Handle the WM_CREATE notification in your window procedure.</span></span>  
  
5. <span data-ttu-id="d4f40-156">Dentro do manipulador (ou de uma função que o manipulador chama), faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="d4f40-156">Within the handler (or a function that the handler calls), do the following:</span></span>  
  
    1. <span data-ttu-id="d4f40-157">Criar um novo <xref:System.Windows.Interop.HwndSource> objeto com o HWND da janela pai como seu `parent` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="d4f40-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="d4f40-158">Crie uma instância da sua classe de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="d4f40-159">Atribua uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] o objeto de conteúdo para o <xref:System.Windows.Interop.HwndSource> objeto <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="d4f40-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>  
  
    4. <span data-ttu-id="d4f40-160">O <xref:System.Windows.Interop.HwndSource> objeto <xref:System.Windows.Interop.HwndSource.Handle%2A> propriedade contém o identificador de janela (HWND).</span><span class="sxs-lookup"><span data-stu-id="d4f40-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="d4f40-161">Para obter um HWND que você possa usar na parte não gerenciada de seu aplicativo, transmita `Handle.ToPointer()` para um HWND.</span><span class="sxs-lookup"><span data-stu-id="d4f40-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
6. <span data-ttu-id="d4f40-162">Implemente uma classe gerenciada que contenha um campo estático contendo uma referência ao seu objeto de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="d4f40-163">Essa classe permite que você obtenha uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objeto de conteúdo do seu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] código, mas mais importante, impede que seu <xref:System.Windows.Interop.HwndSource> sejam inadvertidamente coletados pelo lixo.</span><span class="sxs-lookup"><span data-stu-id="d4f40-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>  
  
7. <span data-ttu-id="d4f40-164">Receba notificações do objeto de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], anexando um manipulador a um ou mais eventos de objeto de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>  
  
8. <span data-ttu-id="d4f40-165">Comunique-se com o objeto de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usando a referência que você armazenou no campo estático para definir propriedades, chamar métodos, etc.</span><span class="sxs-lookup"><span data-stu-id="d4f40-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d4f40-166">Você pode fazer algumas ou todas as definições de classe de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] da Etapa Um em [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] usando a classe parcial padrão da classe de conteúdo, se você gerar um assembly separado e, em seguida, referenciá-lo.</span><span class="sxs-lookup"><span data-stu-id="d4f40-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="d4f40-167">Embora você normalmente inclua um <xref:System.Windows.Application> objeto como parte da compilação a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] em um assembly, você acaba não usando essa <xref:System.Windows.Application> como parte da interoperação, você apenas use um ou mais das classes raiz para [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] arquivos conhecidos para o aplicativo e referencia suas classes parciais.</span><span class="sxs-lookup"><span data-stu-id="d4f40-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="d4f40-168">O restante do procedimento é basicamente semelhante ao descrito acima.</span><span class="sxs-lookup"><span data-stu-id="d4f40-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>  
>   
>  <span data-ttu-id="d4f40-169">Cada uma dessas etapas é ilustrada por meio de código no tópico [passo a passo: Hospedando conteúdo do WPF no Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span>  
  
<a name="hosting_an_hwnd"></a>   
## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="d4f40-170">Hospedando uma janela do Microsoft Win32 no WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-170">Hosting a Microsoft Win32 Window in WPF</span></span>  
 <span data-ttu-id="d4f40-171">A chave para hospedar uma [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela dentro de outras [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo é o <xref:System.Windows.Interop.HwndHost> classe.</span><span class="sxs-lookup"><span data-stu-id="d4f40-171">The key to hosting a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="d4f40-172">Essa classe encapsula a janela em um elemento do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] que pode ser adicionado a uma árvore de elementos do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="d4f40-173"><xref:System.Windows.Interop.HwndHost> também dá suporte a [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] que permitem executar tarefas, como processar as mensagens para a janela hospedada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-173"><xref:System.Windows.Interop.HwndHost> also supports [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="d4f40-174">O procedimento básico é:</span><span class="sxs-lookup"><span data-stu-id="d4f40-174">The basic procedure is:</span></span>  
  
1. <span data-ttu-id="d4f40-175">Crie uma árvore de elementos para um aplicativo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (pode ser por meio de código ou marcação).</span><span class="sxs-lookup"><span data-stu-id="d4f40-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="d4f40-176">Localize um ponto adequado e permitido na árvore de elementos em que o <xref:System.Windows.Interop.HwndHost> implementação pode ser adicionada como um elemento filho.</span><span class="sxs-lookup"><span data-stu-id="d4f40-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="d4f40-177">No restante dessas etapas, esse elemento será referenciado como elemento de reserva.</span><span class="sxs-lookup"><span data-stu-id="d4f40-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>  
  
2. <span data-ttu-id="d4f40-178">Derivam <xref:System.Windows.Interop.HwndHost> para criar um objeto que contém seu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d4f40-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
3. <span data-ttu-id="d4f40-179">Na classe host, substituir os <xref:System.Windows.Interop.HwndHost> método <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="d4f40-180">Retorne o HWND da janela hospedada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="d4f40-181">Talvez convenha encapsular os controles reais como uma janela filha da janela retornada. Encapsular os controles em uma janela host fornece uma maneira simples para que o conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] receba notificações dos controles.</span><span class="sxs-lookup"><span data-stu-id="d4f40-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="d4f40-182">Essa técnica ajuda a corrigir alguns problemas do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] em relação à manipulação de mensagens no limite do controle hospedado.</span><span class="sxs-lookup"><span data-stu-id="d4f40-182">This technique helps correct for some [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] issues regarding message handling at the hosted control boundary.</span></span>  
  
4. <span data-ttu-id="d4f40-183">Substituir a <xref:System.Windows.Interop.HwndHost> métodos <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> e <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="d4f40-184">A intenção aqui é processar a limpeza e remover as referências ao conteúdo hospedado, principalmente se você tiver criado referências a objetos não gerenciados.</span><span class="sxs-lookup"><span data-stu-id="d4f40-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>  
  
5. <span data-ttu-id="d4f40-185">No seu arquivo code-behind, crie uma instância da classe que hospeda controles e torne-a filha do elemento de reserva.</span><span class="sxs-lookup"><span data-stu-id="d4f40-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="d4f40-186">Normalmente você usaria um manipulador de eventos, como <xref:System.Windows.FrameworkElement.Loaded>, ou usar o construtor de classe parcial.</span><span class="sxs-lookup"><span data-stu-id="d4f40-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="d4f40-187">Mas você também pode adicionar o conteúdo de interoperação por meio de um comportamento de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="d4f40-187">But you could also add the interoperation content through a runtime behavior.</span></span>  
  
6. <span data-ttu-id="d4f40-188">Processe mensagens de janela selecionadas, como notificações de controle.</span><span class="sxs-lookup"><span data-stu-id="d4f40-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="d4f40-189">Há duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="d4f40-189">There are two approaches.</span></span> <span data-ttu-id="d4f40-190">Ambos fornecem acesso idêntico ao fluxo de mensagens, portanto sua escolha é principalmente uma questão de conveniência de programação.</span><span class="sxs-lookup"><span data-stu-id="d4f40-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>  
  
    - <span data-ttu-id="d4f40-191">Processamento de todas as mensagens (não apenas mensagens de desligamento) em seu substituto de mensagens de implementar o <xref:System.Windows.Interop.HwndHost> método <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
    - <span data-ttu-id="d4f40-192">Ter a hospedagem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elemento processar as mensagens manipulando o <xref:System.Windows.Interop.HwndHost.MessageHook> eventos.</span><span class="sxs-lookup"><span data-stu-id="d4f40-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="d4f40-193">Esse evento é gerado para cada mensagem que é enviada ao procedimento de janela principal da janela hospedada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>  
  
    - <span data-ttu-id="d4f40-194">Você não pode processar as mensagens de janelas que estão fora do processo usando <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
7. <span data-ttu-id="d4f40-195">Comunique-se com a janela hospedada usando a invocação de plataforma para chamar função `SendMessage` não gerenciada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>  
  
 <span data-ttu-id="d4f40-196">Seguir essas cria um aplicativo que funciona com a entrada do mouse.</span><span class="sxs-lookup"><span data-stu-id="d4f40-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="d4f40-197">Você pode adicionar suporte a TAB para sua janela hospedada Implementando a <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span><span class="sxs-lookup"><span data-stu-id="d4f40-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>  
  
 <span data-ttu-id="d4f40-198">Cada uma dessas etapas é ilustrada por meio de código no tópico [passo a passo: Hospedando um controle Win32 no WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="d4f40-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
### <a name="hwnds-inside-wpf"></a><span data-ttu-id="d4f40-199">Hwnds dentro do WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-199">Hwnds Inside WPF</span></span>  
 <span data-ttu-id="d4f40-200">Você pode pensar <xref:System.Windows.Interop.HwndHost> como um controle especial.</span><span class="sxs-lookup"><span data-stu-id="d4f40-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="d4f40-201">(Tecnicamente, <xref:System.Windows.Interop.HwndHost> é um <xref:System.Windows.FrameworkElement> derivado de classe, não um <xref:System.Windows.Controls.Control> classe derivada, mas ele pode ser considerado um controle para fins de interoperação.) <xref:System.Windows.Interop.HwndHost> abstrai a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] natureza do conteúdo hospedado, de modo que o restante do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considera o conteúdo hospedado como outro objeto do tipo controle, que deve renderizar e processar a entrada.</span><span class="sxs-lookup"><span data-stu-id="d4f40-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="d4f40-202"><xref:System.Windows.Interop.HwndHost> geralmente se comporta como qualquer outro [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, embora há algumas diferenças importantes em torno de saída (desenho e gráficos) e pode dar suporte a entrada (mouse e teclado) com base nas limitações de que os HWNDs subjacentes.</span><span class="sxs-lookup"><span data-stu-id="d4f40-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>  
  
#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="d4f40-203">Diferenças notáveis no comportamento de saída</span><span class="sxs-lookup"><span data-stu-id="d4f40-203">Notable Differences in Output Behavior</span></span>  
  
- <span data-ttu-id="d4f40-204"><xref:System.Windows.FrameworkElement>, que é o <xref:System.Windows.Interop.HwndHost> classe base, tem muito poucas propriedades que implicam alterações na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="d4f40-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="d4f40-205">Estas incluem propriedades como <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, que altera o layout dos elementos dentro desse elemento como um pai.</span><span class="sxs-lookup"><span data-stu-id="d4f40-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="d4f40-206">No entanto, a maioria dessas propriedades não é mapeada para possíveis equivalentes do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], mesmo que tais equivalentes possam existir.</span><span class="sxs-lookup"><span data-stu-id="d4f40-206">However, most of these properties are not mapped to possible [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="d4f40-207">Muitas dessas propriedades e seus significados são tão específicas da tecnologia de processamento para mapeamentos que não são práticas.</span><span class="sxs-lookup"><span data-stu-id="d4f40-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="d4f40-208">Portanto, definir propriedades como <xref:System.Windows.FrameworkElement.FlowDirection%2A> em <xref:System.Windows.Interop.HwndHost> não tem nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="d4f40-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>  
  
- <span data-ttu-id="d4f40-209"><xref:System.Windows.Interop.HwndHost> não pode ser girada, dimensionada, distorcida ou caso contrário, afetadas por uma transformação.</span><span class="sxs-lookup"><span data-stu-id="d4f40-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>  
  
- <span data-ttu-id="d4f40-210"><xref:System.Windows.Interop.HwndHost> não oferece suporte a <xref:System.Windows.UIElement.Opacity%2A> propriedade (a combinação alfa).</span><span class="sxs-lookup"><span data-stu-id="d4f40-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="d4f40-211">Se o conteúdo dentro do <xref:System.Windows.Interop.HwndHost> executa <xref:System.Drawing> operações que incluem informações de alfa, que em si não é uma violação, mas o <xref:System.Windows.Interop.HwndHost> como um todo somente dá suporte à opacidade = 1.0 (100%).</span><span class="sxs-lookup"><span data-stu-id="d4f40-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>  
  
- <span data-ttu-id="d4f40-212"><xref:System.Windows.Interop.HwndHost> aparecerá acima dos outros [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementos na mesma janela de nível superior.</span><span class="sxs-lookup"><span data-stu-id="d4f40-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="d4f40-213">No entanto, uma <xref:System.Windows.Controls.ToolTip> ou <xref:System.Windows.Controls.ContextMenu> menu gerado é uma janela de nível superior separada e então se comportará corretamente com <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
- <span data-ttu-id="d4f40-214"><xref:System.Windows.Interop.HwndHost> não respeita a região de recorte de seu pai <xref:System.Windows.UIElement>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="d4f40-215">É possível que haja um problema se você tentar colocar uma <xref:System.Windows.Interop.HwndHost> classe dentro de uma região de rolagem ou <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>  
  
#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="d4f40-216">Diferenças notáveis no comportamento de entrada</span><span class="sxs-lookup"><span data-stu-id="d4f40-216">Notable Differences in Input Behavior</span></span>  
  
- <span data-ttu-id="d4f40-217">Em geral, enquanto os dispositivos de entrada tem escopo dentro de <xref:System.Windows.Interop.HwndHost> hospedados [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] região, eventos de entrada vão diretamente para [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, input events go directly to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span></span>  
  
- <span data-ttu-id="d4f40-218">Enquanto o mouse está sobre o <xref:System.Windows.Interop.HwndHost>, seu aplicativo não receberá [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventos de mouse e o valor da [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedade <xref:System.Windows.UIElement.IsMouseOver%2A> será `false`.</span><span class="sxs-lookup"><span data-stu-id="d4f40-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>  
  
- <span data-ttu-id="d4f40-219">Enquanto o <xref:System.Windows.Interop.HwndHost> tem o foco do teclado, seu aplicativo não receberá [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventos e o valor de teclado a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedade <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> será `false`.</span><span class="sxs-lookup"><span data-stu-id="d4f40-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>  
  
- <span data-ttu-id="d4f40-220">Quando o foco estiver dentro a <xref:System.Windows.Interop.HwndHost> e as alterações para outro controle dentro a <xref:System.Windows.Interop.HwndHost>, seu aplicativo não receberá a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventos <xref:System.Windows.UIElement.GotFocus> ou <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>  
  
- <span data-ttu-id="d4f40-221">Caneta propriedades e eventos são análogos e não relatam informações enquanto a caneta está sobre relacionados <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="d4f40-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
<a name="tabbing_mnemonics_accelerators"></a>   
## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="d4f40-222">Uso da tecla TAB, mnemônicos e aceleradores</span><span class="sxs-lookup"><span data-stu-id="d4f40-222">Tabbing, Mnemonics, and Accelerators</span></span>  
 <span data-ttu-id="d4f40-223">O <xref:System.Windows.Interop.IKeyboardInputSink> e <xref:System.Windows.Interop.IKeyboardInputSite> interfaces permitem que você crie uma experiência de teclado perfeita para misto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativos:</span><span class="sxs-lookup"><span data-stu-id="d4f40-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications:</span></span>  
  
- <span data-ttu-id="d4f40-224">Uso da tecla TAB entre componentes do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="d4f40-224">Tabbing between [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>  
  
- <span data-ttu-id="d4f40-225">Mnemônicos e aceleradores que funcionam quando o foco está em um componente do Win32 e quando está em um componente do WPF.</span><span class="sxs-lookup"><span data-stu-id="d4f40-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>  
  
 <span data-ttu-id="d4f40-226">O <xref:System.Windows.Interop.HwndHost> e <xref:System.Windows.Interop.HwndSource> classes fornecem implementações de <xref:System.Windows.Interop.IKeyboardInputSink>, mas elas não podem tratar todas as mensagens de entrada que você deseja para cenários mais avançados.</span><span class="sxs-lookup"><span data-stu-id="d4f40-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="d4f40-227">Substitua os métodos apropriados para obter o comportamento de teclado desejado.</span><span class="sxs-lookup"><span data-stu-id="d4f40-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>  
  
 <span data-ttu-id="d4f40-228">As interfaces somente dão suporte para o que acontece na transição entre as regiões do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d4f40-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regions.</span></span> <span data-ttu-id="d4f40-229">Dentro da região do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], o comportamento de uso da tecla TAB é totalmente controlado pela lógica implementada do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], caso haja alguma.</span><span class="sxs-lookup"><span data-stu-id="d4f40-229">Within the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, tabbing behavior is entirely controlled by the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implemented logic for tabbing, if any.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d4f40-230">Consulte também</span><span class="sxs-lookup"><span data-stu-id="d4f40-230">See also</span></span>

- <xref:System.Windows.Interop.HwndHost>
- <xref:System.Windows.Interop.HwndSource>
- <xref:System.Windows.Interop>
- [<span data-ttu-id="d4f40-231">Passo a passo: Hospedando um controle Win32 no WPF</span><span class="sxs-lookup"><span data-stu-id="d4f40-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](walkthrough-hosting-a-win32-control-in-wpf.md)
- [<span data-ttu-id="d4f40-232">Passo a passo: Hospedando conteúdo do WPF no Win32</span><span class="sxs-lookup"><span data-stu-id="d4f40-232">Walkthrough: Hosting WPF Content in Win32</span></span>](walkthrough-hosting-wpf-content-in-win32.md)
