---
title: 'Instruções passo a passo: hospedando conteúdo do WPF em Win32'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 2a2be40195bf3afaadfc92c5f2983452a6f8568c
ms.sourcegitcommit: fe02afbc39e78afd78cc6050e4a9c12a75f579f8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/30/2018
ms.locfileid: "43254887"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="dfd55-102">Instruções passo a passo: hospedando conteúdo do WPF em Win32</span><span class="sxs-lookup"><span data-stu-id="dfd55-102">Walkthrough: Hosting WPF Content in Win32</span></span>
<span data-ttu-id="dfd55-103">O [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] fornece um ambiente avançado para a criação de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-103">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] provides a rich environment for creating applications.</span></span> <span data-ttu-id="dfd55-104">No entanto, quando você tem um investimento substancial em [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] código, ele pode ser mais eficiente adicionar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funcionalidade ao seu aplicativo em vez de reescrever o código original.</span><span class="sxs-lookup"><span data-stu-id="dfd55-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="dfd55-105"> Fornece um mecanismo simples para hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="dfd55-106">Este tutorial descreve como escrever um aplicativo de exemplo [hospedando conteúdo do WPF em uma amostra de janela Win32](http://go.microsoft.com/fwlink/?LinkID=160004), que hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="dfd55-107">Você pode estender este exemplo para hospedar qualquer [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="dfd55-108">Porque envolve a mistura de código gerenciado e não gerenciado, o aplicativo é escrito em [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="dfd55-109">Requisitos</span><span class="sxs-lookup"><span data-stu-id="dfd55-109">Requirements</span></span>  
 <span data-ttu-id="dfd55-110">Este tutorial pressupõe uma familiaridade básica com ambos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] de programação.</span><span class="sxs-lookup"><span data-stu-id="dfd55-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="dfd55-111">Para obter uma introdução básica [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de programação, consulte [Introdução](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="dfd55-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="dfd55-112">Para obter uma introdução [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] de programação, você deve fazer referência a qualquer um dos vários livros sobre o assunto, em particular *Programming Windows* por Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="dfd55-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="dfd55-113">Como a amostra que acompanha este tutorial é implementada no [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], este tutorial pressupõe uma familiaridade com o uso de [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] ao programa o [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] mais um conhecimento de programação de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="dfd55-114">Familiaridade com [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] é útil, mas não são essenciais.</span><span class="sxs-lookup"><span data-stu-id="dfd55-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="dfd55-115">Este tutorial inclui vários exemplos de código da amostra associada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="dfd55-116">No entanto, para facilitar a leitura, não inclui o código de exemplo completo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="dfd55-117">Para o código de exemplo completo, consulte [hospedando conteúdo do WPF em uma amostra de janela Win32](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="dfd55-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="dfd55-118">O procedimento básico</span><span class="sxs-lookup"><span data-stu-id="dfd55-118">The Basic Procedure</span></span>  
 <span data-ttu-id="dfd55-119">Esta seção descreve o procedimento básico para host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="dfd55-120">As outras seções explicam os detalhes de cada etapa.</span><span class="sxs-lookup"><span data-stu-id="dfd55-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="dfd55-121">A chave para hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela é o <xref:System.Windows.Interop.HwndSource> classe.</span><span class="sxs-lookup"><span data-stu-id="dfd55-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="dfd55-122">Essa classe encapsula o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela, permitindo que ele seja incorporado a seu [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] como uma janela filho.</span><span class="sxs-lookup"><span data-stu-id="dfd55-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="dfd55-123">A abordagem a seguir combina o [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] em um único aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="dfd55-124">Implemente sua [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo como uma classe gerenciada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="dfd55-125">Implementar um aplicativo [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] com [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="dfd55-126">Se você estiver começando com um aplicativo existente e não gerenciados [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] código, você poderá geralmente habilitá-lo chamar código gerenciado alterando as configurações de projeto para incluir o `/clr` sinalizador do compilador.</span><span class="sxs-lookup"><span data-stu-id="dfd55-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="dfd55-127">Defina o modelo de threading como STA (Single-Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="dfd55-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="dfd55-128">Lidar com o [WM_CREATE](/windows/desktop/winmsg/wm-create)notificação no seu procedimento de janela e faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="dfd55-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="dfd55-129">Criar um novo <xref:System.Windows.Interop.HwndSource> objeto com a janela pai como seu `parent` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="dfd55-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="dfd55-130">Crie uma instância da sua classe de conteúdo do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="dfd55-131">Atribua uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objeto de conteúdo para o <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriedade do <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="dfd55-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="dfd55-132">Obtenha o HWND do conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-132">Get the HWND for the content.</span></span> <span data-ttu-id="dfd55-133">O <xref:System.Windows.Interop.HwndSource.Handle%2A> propriedade do <xref:System.Windows.Interop.HwndSource> objeto contém o identificador de janela (HWND).</span><span class="sxs-lookup"><span data-stu-id="dfd55-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="dfd55-134">Para obter um HWND que você possa usar na parte não gerenciada de seu aplicativo, transmita `Handle.ToPointer()` para um HWND.</span><span class="sxs-lookup"><span data-stu-id="dfd55-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="dfd55-135">Implemente uma classe gerenciada que contém um campo estático para manter uma referência ao seu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-136">Essa classe permite que você obtenha uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo do seu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] código.</span><span class="sxs-lookup"><span data-stu-id="dfd55-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="dfd55-137">Atribuir o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo ao campo estático.</span><span class="sxs-lookup"><span data-stu-id="dfd55-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="dfd55-138">Receber notificações do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo anexando um manipulador para um ou mais do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="dfd55-139">Se comunicar com o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo usando a referência que você armazenou no campo estático para definir propriedades e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dfd55-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="dfd55-140">Você também pode usar [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] para implementar seu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-141">No entanto, você precisará compilá-lo separadamente como um [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] e fazer referência a ele [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] de seu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="dfd55-142">O restante do procedimento é semelhante ao descrito acima.</span><span class="sxs-lookup"><span data-stu-id="dfd55-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="dfd55-143">Implementando o aplicativo host</span><span class="sxs-lookup"><span data-stu-id="dfd55-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="dfd55-144">Esta seção descreve como hospedar [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo em um basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="dfd55-145">O conteúdo em si é implementado em [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] como uma classe gerenciada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="dfd55-146">Geralmente, é simples [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de programação.</span><span class="sxs-lookup"><span data-stu-id="dfd55-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="dfd55-147">Os principais aspectos da implementação de conteúdo são discutidos [Implementando o conteúdo do WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="dfd55-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="dfd55-148">O aplicativo básico</span><span class="sxs-lookup"><span data-stu-id="dfd55-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="dfd55-149">Hospedando o conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="dfd55-150">Mantendo uma referência ao conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="dfd55-151">Comunicando com o conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="dfd55-152">O aplicativo básico</span><span class="sxs-lookup"><span data-stu-id="dfd55-152">The Basic Application</span></span>  
 <span data-ttu-id="dfd55-153">O ponto de partida para o aplicativo host era criar um [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] modelo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="dfd55-154">Abra [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)]e selecione **novo projeto** da **arquivo** menu.</span><span class="sxs-lookup"><span data-stu-id="dfd55-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="dfd55-155">Selecione **Win32** na lista de [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] tipos de projeto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="dfd55-156">Se o idioma padrão não for [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], você encontrará esses tipos de projeto sob **outras linguagens**.</span><span class="sxs-lookup"><span data-stu-id="dfd55-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="dfd55-157">Selecione uma **projeto Win32** modelo, atribua um nome ao projeto e clique em **Okey** para iniciar o **Assistente de aplicativo Win32**.</span><span class="sxs-lookup"><span data-stu-id="dfd55-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="dfd55-158">Aceite as configurações padrão do assistente e clique em **concluir** para iniciar o projeto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="dfd55-159">O modelo cria um basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativo, incluindo:</span><span class="sxs-lookup"><span data-stu-id="dfd55-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="dfd55-160">Um ponto de entrada do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="dfd55-161">Uma janela, com um procedimento de janela associado (WndProc).</span><span class="sxs-lookup"><span data-stu-id="dfd55-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="dfd55-162">Um menu com **arquivo** e **ajudar** títulos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="dfd55-163">O **arquivo** menu tem um **sair** item que fecha o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="dfd55-164">O **ajudar** menu tem um **sobre** item que inicia uma caixa de diálogo simples.</span><span class="sxs-lookup"><span data-stu-id="dfd55-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="dfd55-165">Antes de começar a escrever código para hospedar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo, você precisa fazer duas modificações no modelo básico.</span><span class="sxs-lookup"><span data-stu-id="dfd55-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="dfd55-166">A primeira é compilar o projeto como um código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="dfd55-167">Por padrão, o projeto é compilado como um código não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="dfd55-168">No entanto, porque [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] é implementado no código gerenciado, o projeto deve ser compilado de acordo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="dfd55-169">Clique com botão direito no nome do projeto no **Gerenciador de soluções** e selecione **propriedades** no menu de contexto para iniciar o **páginas de propriedade** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="dfd55-170">Selecione **propriedades de configuração** da exibição em árvore no painel esquerdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="dfd55-171">Selecione **Common Language Runtime** suporte das **padrões de projeto** lista no painel direito.</span><span class="sxs-lookup"><span data-stu-id="dfd55-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="dfd55-172">Selecione **Common Language Runtime Support (/ clr)** na caixa de listagem suspensa.</span><span class="sxs-lookup"><span data-stu-id="dfd55-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="dfd55-173">Esse sinalizador de compilação permite que você use um código gerenciado no aplicativo, mas o código não gerenciado continuará sendo compilado como antes.</span><span class="sxs-lookup"><span data-stu-id="dfd55-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 <span data-ttu-id="dfd55-174">O [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usa o modelo de threading STA (Single-Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="dfd55-174">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="dfd55-175">Para funcionar adequadamente com o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] código de conteúdo, você deve definir o modelo de threading do aplicativo como STA aplicando um atributo para o ponto de entrada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="dfd55-176">Hospedando o conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="dfd55-177">O [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo é um aplicativo de entrada de endereço simples.</span><span class="sxs-lookup"><span data-stu-id="dfd55-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="dfd55-178">Ele consiste em vários <xref:System.Windows.Controls.TextBox> controles para levar o nome de usuário, endereço e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="dfd55-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="dfd55-179">Também há dois <xref:System.Windows.Controls.Button> controles **Okey** e **Cancelar**.</span><span class="sxs-lookup"><span data-stu-id="dfd55-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="dfd55-180">Quando o usuário clica **Okey**, o botão <xref:System.Windows.Controls.Primitives.ButtonBase.Click> manipulador de eventos coleta os dados das <xref:System.Windows.Controls.TextBox> controla, atribui a propriedades correspondentes e aciona um evento personalizado, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="dfd55-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="dfd55-181">Quando o usuário clica **cancele**, o manipulador apenas aciona `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="dfd55-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="dfd55-182">O objeto de argumento de evento para `OnButtonClicked` contém um campo booleano que indica qual botão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="dfd55-183">O código para hospedar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo é implementado em um manipulador para o [WM_CREATE](/windows/desktop/winmsg/wm-create) notificação na janela do host.</span><span class="sxs-lookup"><span data-stu-id="dfd55-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="dfd55-184">O `GetHwnd` método usa as informações de tamanho e posição mais pai identificador de janela e retorna o identificador de janela de hospedado [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="dfd55-185">Não é possível usar um `#using` diretiva para o `System::Windows::Interop` namespace.</span><span class="sxs-lookup"><span data-stu-id="dfd55-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="dfd55-186">Isso cria uma colisão de nomes entre o <xref:System.Windows.Interop.MSG> nesse namespace e a estrutura MSG declarada em winuser. h.</span><span class="sxs-lookup"><span data-stu-id="dfd55-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="dfd55-187">Em vez disso, use nomes totalmente qualificados para acessar o conteúdo desse namespace.</span><span class="sxs-lookup"><span data-stu-id="dfd55-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="dfd55-188">Você não pode hospedar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo diretamente na janela do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="dfd55-189">Em vez disso, primeiro crie uma <xref:System.Windows.Interop.HwndSource> objeto para encapsular o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-190">Este objeto é basicamente uma janela projetada para hospedar um [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-191">Você hospedar o <xref:System.Windows.Interop.HwndSource> objeto na janela pai criando-o como um filho de um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela que é parte do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="dfd55-192">O <xref:System.Windows.Interop.HwndSource> parâmetros do construtor contêm basicamente as mesmas informações que você passaria para CreateWindow ao criar um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] janela filho.</span><span class="sxs-lookup"><span data-stu-id="dfd55-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="dfd55-193">Depois que você cria uma instância da [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objeto de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="dfd55-194">Nesse caso, o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo é implementado como uma classe separada, `WPFPage`, usando [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="dfd55-195">Você também pode implementar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo com [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="dfd55-196">No entanto, para fazer isso você precisa configurar um projeto separado e construir o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo como um [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfd55-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="dfd55-197">Você pode adicionar uma referência a esse [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] ao seu projeto e usá-la para criar uma instância da [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="dfd55-198">Você exibir o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo na sua janela filho atribuindo uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo para o <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriedade do <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="dfd55-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="dfd55-199">A próxima linha de código anexa um manipulador de eventos `WPFButtonClicked`, para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo `OnButtonClicked` eventos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="dfd55-200">Esse manipulador é chamado quando o usuário clica o **Okey** ou **Cancelar** botão.</span><span class="sxs-lookup"><span data-stu-id="dfd55-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="dfd55-201">Ver [conteúdo do communicating_with_the_WPF](#communicating_with_the_page) para mais informações sobre esse manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="dfd55-202">A linha final do código mostrado retorna o identificador de janela (HWND) que está associado com o <xref:System.Windows.Interop.HwndSource> objeto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="dfd55-203">Você pode usar este identificador de seu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] código para enviar mensagens para a janela hospedada, embora o exemplo não fazê-lo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="dfd55-204">O <xref:System.Windows.Interop.HwndSource> objeto gera um evento sempre que receber uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="dfd55-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="dfd55-205">Para processar as mensagens, chame o <xref:System.Windows.Interop.HwndSource.AddHook%2A> método anexar um manipulador de mensagens e, em seguida, processar as mensagens no manipulador.</span><span class="sxs-lookup"><span data-stu-id="dfd55-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="dfd55-206">Mantendo uma referência ao conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="dfd55-207">Para muitos aplicativos, você desejará se comunicar com o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de conteúdo mais tarde.</span><span class="sxs-lookup"><span data-stu-id="dfd55-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="dfd55-208">Por exemplo, você talvez queira modificar os [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedades do conteúdo ou fazer com que o <xref:System.Windows.Interop.HwndSource> host de objeto diferente [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-209">Para fazer isso, você precisa de uma referência para o <xref:System.Windows.Interop.HwndSource> objeto ou o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-210">O <xref:System.Windows.Interop.HwndSource> objeto e seus respectivos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo permanecer na memória até que você destrua o identificador de janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="dfd55-211">No entanto, a variável que você atribuir ao <xref:System.Windows.Interop.HwndSource> objeto sairá do escopo assim que você retornar do procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="dfd55-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="dfd55-212">A maneira habitual de resolver esse problema com [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativos é usar uma variável global ou estática.</span><span class="sxs-lookup"><span data-stu-id="dfd55-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="dfd55-213">Infelizmente, não é possível atribuir um objeto gerenciado a esses tipos de variáveis.</span><span class="sxs-lookup"><span data-stu-id="dfd55-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="dfd55-214">Você pode atribuir um identificador de janela associado <xref:System.Windows.Interop.HwndSource> do objeto a uma variável global ou estática, mas que não fornece acesso ao próprio objeto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="dfd55-215">A solução mais simples para esse problema é implementar uma classe gerenciada que contém um conjunto de campos estáticos para manter referências a todos os objetos gerenciados aos quais você precisa ter acesso.</span><span class="sxs-lookup"><span data-stu-id="dfd55-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="dfd55-216">O exemplo usa o `WPFPageHost` classe para manter uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo, mais os valores iniciais de um número de suas propriedades que podem ser alteradas posteriormente pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="dfd55-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="dfd55-217">Isso é definido no cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="dfd55-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="dfd55-218">A última parte do `GetHwnd` função atribui valores a esses campos para uso posterior, enquanto `myPage` ainda está no escopo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="dfd55-219">Comunicando com o conteúdo do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="dfd55-220">Há dois tipos de comunicação com o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-221">O aplicativo recebe informações do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de conteúdo quando o usuário clica o **Okey** ou **Cancelar** botões.</span><span class="sxs-lookup"><span data-stu-id="dfd55-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="dfd55-222">O aplicativo também possui um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] que permite ao usuário alterar várias [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedades, tais como o tamanho de fonte de cor ou padrão do plano de fundo do conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="dfd55-223">Conforme mencionado acima, quando o usuário clica em um dos botões do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo gera um `OnButtonClicked` eventos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="dfd55-224">O aplicativo anexa um manipulador a esse evento para receber essas notificações.</span><span class="sxs-lookup"><span data-stu-id="dfd55-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="dfd55-225">Se o **Okey** botão foi clicado, o manipulador obterá as informações do usuário a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de conteúdo e o exibe em um conjunto de controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="dfd55-226">O manipulador recebe um objeto de argumento de evento personalizado do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo, `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="dfd55-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="dfd55-227">O objeto `IsOK` estiver definida como `true` se o **Okey** botão foi clicado, e `false` se a **Cancelar** botão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="dfd55-228">Se o **Okey** botão foi clicado, o manipulador obterá uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo da classe de contêiner.</span><span class="sxs-lookup"><span data-stu-id="dfd55-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="dfd55-229">Depois, ele coletará as informações do usuário que são mantidas pelo associado [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedades de conteúdo e usará controles estáticos para exibir as informações na janela pai.</span><span class="sxs-lookup"><span data-stu-id="dfd55-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="dfd55-230">Porque o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dados de conteúdo estão na forma de uma cadeia de caracteres gerenciada, ele deve ser empacotado para uso por um [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] controle.</span><span class="sxs-lookup"><span data-stu-id="dfd55-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="dfd55-231">Se o **Cancelar** botão foi clicado, o manipulador limpará os dados dos controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="dfd55-232">O aplicativo [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] fornece um conjunto de botões de opção que permitem ao usuário modificar a cor de fundo a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo e várias propriedades relacionadas a fonte.</span><span class="sxs-lookup"><span data-stu-id="dfd55-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="dfd55-233">O exemplo a seguir é um trecho do procedimento de janela (WndProc) do aplicativo e sua manipulação de mensagens que define várias propriedades em diferentes mensagens, incluindo a cor da tela de fundo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="dfd55-234">As outras são semelhantes e não são mostradas.</span><span class="sxs-lookup"><span data-stu-id="dfd55-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="dfd55-235">Consulte a amostra completa para obter detalhes e o contexto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="dfd55-236">Para definir a cor do plano de fundo, obtenha uma referência para o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo (`hostedPage`) de `WPFPageHost` e defina a propriedade de cor do plano de fundo para a cor apropriada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="dfd55-237">A amostra usa três opções de cores: a cor original, verde-claro e salmão-claro.</span><span class="sxs-lookup"><span data-stu-id="dfd55-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="dfd55-238">A cor de plano de fundo original é armazenada como um campo estático no `WPFPageHost` classe.</span><span class="sxs-lookup"><span data-stu-id="dfd55-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="dfd55-239">Para ver as outras duas, crie um novo <xref:System.Windows.Media.SolidColorBrush> do objeto e passar um valor de cor estática para o construtor de <xref:System.Windows.Media.Colors> objeto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="dfd55-240">Implementando a página do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="dfd55-241">Você pode hospedar e usar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo sem qualquer conhecimento da implementação real.</span><span class="sxs-lookup"><span data-stu-id="dfd55-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="dfd55-242">Se o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo tiver sido empacotado em um separado [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], poderá ter sido criado em qualquer [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] idioma.</span><span class="sxs-lookup"><span data-stu-id="dfd55-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="dfd55-243">A seguir está um breve passo a passo o [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementação que é usada no exemplo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="dfd55-244">Esta seção contém as subseções a seguir.</span><span class="sxs-lookup"><span data-stu-id="dfd55-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="dfd55-245">Layout</span><span class="sxs-lookup"><span data-stu-id="dfd55-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="dfd55-246">Retornando os dados à janela do host</span><span class="sxs-lookup"><span data-stu-id="dfd55-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="dfd55-247">Definindo as propriedades do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="dfd55-248">Layout</span><span class="sxs-lookup"><span data-stu-id="dfd55-248">Layout</span></span>  
 <span data-ttu-id="dfd55-249">O [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementos em de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo consistem em cinco <xref:System.Windows.Controls.TextBox> controla, às associada <xref:System.Windows.Controls.Label> controles: nome, endereço, cidade, estado e CEP.</span><span class="sxs-lookup"><span data-stu-id="dfd55-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="dfd55-250">Também há dois <xref:System.Windows.Controls.Button> controles **Okey** e **Cancelar**</span><span class="sxs-lookup"><span data-stu-id="dfd55-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="dfd55-251">O [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo é implementado de `WPFPage` classe.</span><span class="sxs-lookup"><span data-stu-id="dfd55-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="dfd55-252">Layout é tratado com um <xref:System.Windows.Controls.Grid> elemento de layout.</span><span class="sxs-lookup"><span data-stu-id="dfd55-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="dfd55-253">A classe herda de <xref:System.Windows.Controls.Grid>, que torna o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elemento raiz do conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="dfd55-254">O [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo construtor usa a largura e altura e tamanhos a <xref:System.Windows.Controls.Grid> adequadamente.</span><span class="sxs-lookup"><span data-stu-id="dfd55-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="dfd55-255">Em seguida, define o layout básico criando um conjunto de <xref:System.Windows.Controls.ColumnDefinition> e <xref:System.Windows.Controls.RowDefinition> objetos e adicioná-los para o <xref:System.Windows.Controls.Grid> objeto base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> e <xref:System.Windows.Controls.Grid.RowDefinitions%2A> coleções, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="dfd55-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="dfd55-256">Isso define uma grade de cinco linhas e sete colunas, com as dimensões determinadas pelo conteúdo das células.</span><span class="sxs-lookup"><span data-stu-id="dfd55-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="dfd55-257">Em seguida, o construtor adiciona os [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementos para o <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="dfd55-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="dfd55-258">O primeiro elemento é o texto do título, que é um <xref:System.Windows.Controls.Label> controle centralizado na primeira linha da grade.</span><span class="sxs-lookup"><span data-stu-id="dfd55-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="dfd55-259">A próxima linha contém o nome <xref:System.Windows.Controls.Label> controle e seus respectivos <xref:System.Windows.Controls.TextBox> controle.</span><span class="sxs-lookup"><span data-stu-id="dfd55-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="dfd55-260">Como o mesmo código é usado para cada par rótulo/caixa de texto, ele é colocado em um par de métodos particulares e usado para todos os cinco pares de rótulo/caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="dfd55-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="dfd55-261">Os métodos criam apropriado de controle e, em seguida, chamar o <xref:System.Windows.Controls.Grid> classe estática <xref:System.Windows.Controls.Grid.SetColumn%2A> e <xref:System.Windows.Controls.Grid.SetRow%2A> métodos para colocar os controles na célula apropriada.</span><span class="sxs-lookup"><span data-stu-id="dfd55-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="dfd55-262">Depois que o controle é criado, o exemplo chama o <xref:System.Windows.Controls.UIElementCollection.Add%2A> método em de <xref:System.Windows.Controls.Panel.Children%2A> propriedade do <xref:System.Windows.Controls.Grid> para adicionar o controle à grade.</span><span class="sxs-lookup"><span data-stu-id="dfd55-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="dfd55-263">O código para adicionar os pares de rótulo/caixa de texto restantes é semelhante.</span><span class="sxs-lookup"><span data-stu-id="dfd55-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="dfd55-264">Consulte o código de exemplo para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="dfd55-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="dfd55-265">A implementação dos dois métodos ocorre da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="dfd55-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="dfd55-266">Por fim, o exemplo adiciona o **Okey** e **Cancelar** botões e anexa um manipulador de eventos para seus <xref:System.Windows.Controls.Primitives.ButtonBase.Click> eventos.</span><span class="sxs-lookup"><span data-stu-id="dfd55-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="dfd55-267">Retornando os dados à janela do host</span><span class="sxs-lookup"><span data-stu-id="dfd55-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="dfd55-268">Quando qualquer botão é clicado, seu <xref:System.Windows.Controls.Primitives.ButtonBase.Click> é gerado.</span><span class="sxs-lookup"><span data-stu-id="dfd55-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="dfd55-269">A janela de host poderia simplesmente anexar manipuladores para esses eventos e obter os dados diretamente a partir de <xref:System.Windows.Controls.TextBox> controles.</span><span class="sxs-lookup"><span data-stu-id="dfd55-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="dfd55-270">O exemplo usa uma abordagem um pouco menos direta.</span><span class="sxs-lookup"><span data-stu-id="dfd55-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="dfd55-271">Ele lida com o <xref:System.Windows.Controls.Primitives.ButtonBase.Click> dentro de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , conteúdo e, em seguida, gera um evento personalizado `OnButtonClicked`, para notificar o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="dfd55-272">Isso permite que o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] conteúdo fazer alguma validação de parâmetro antes de notificar o host.</span><span class="sxs-lookup"><span data-stu-id="dfd55-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="dfd55-273">O manipulador obtém o texto do <xref:System.Windows.Controls.TextBox> controla e o atribui a propriedades públicas, do qual o host pode recuperar as informações.</span><span class="sxs-lookup"><span data-stu-id="dfd55-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="dfd55-274">A declaração de evento, em WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="dfd55-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="dfd55-275">O <xref:System.Windows.Controls.Primitives.ButtonBase.Click> manipulador de eventos, em WPFPage. cpp:</span><span class="sxs-lookup"><span data-stu-id="dfd55-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="dfd55-276">Definindo as propriedades do WPF</span><span class="sxs-lookup"><span data-stu-id="dfd55-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="dfd55-277">O [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host permite ao usuário alterar várias [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriedades do conteúdo.</span><span class="sxs-lookup"><span data-stu-id="dfd55-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="dfd55-278">Do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] lado, é simplesmente uma questão de alterar as propriedades.</span><span class="sxs-lookup"><span data-stu-id="dfd55-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="dfd55-279">A implementação no [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classe de conteúdo é um pouco mais complicado, porque não há nenhuma propriedade global que controla as fontes para todos os controles.</span><span class="sxs-lookup"><span data-stu-id="dfd55-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="dfd55-280">Em vez disso, a propriedade apropriada de cada controle é alterada nos acessadores set das propriedades.</span><span class="sxs-lookup"><span data-stu-id="dfd55-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="dfd55-281">O exemplo a seguir mostra o código para o `DefaultFontFamily` propriedade.</span><span class="sxs-lookup"><span data-stu-id="dfd55-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="dfd55-282">Definindo a propriedade chama um método particular que por sua vez define o <xref:System.Windows.Controls.Control.FontFamily%2A> propriedades de vários controles.</span><span class="sxs-lookup"><span data-stu-id="dfd55-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="dfd55-283">Em WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="dfd55-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="dfd55-284">Em WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="dfd55-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="dfd55-285">Consulte também</span><span class="sxs-lookup"><span data-stu-id="dfd55-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="dfd55-286">Interoperação do WPF e do Win32</span><span class="sxs-lookup"><span data-stu-id="dfd55-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
