---
title: "Recursos e código"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
caps.latest.revision: "14"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 772c44b63627204da7056a5707f2840a82053f11
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/22/2017
---
# <a name="resources-and-code"></a><span data-ttu-id="8e302-102">Recursos e código</span><span class="sxs-lookup"><span data-stu-id="8e302-102">Resources and Code</span></span>
<span data-ttu-id="8e302-103">Esta visão geral se concentra em como recursos de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] podem ser acessados ou criados usando o código em vez da sintaxe [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8e302-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="8e302-104">Para obter mais informações sobre o uso geral de recursos e sobre os recursos da perspectiva da sintaxe [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], consulte [Recursos XAML](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="8e302-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span></span>  
  
  
  
<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="8e302-105">Acessando recursos do código</span><span class="sxs-lookup"><span data-stu-id="8e302-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="8e302-106">As chaves que identificam os recursos se eles forem definidos pelo [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] também serão usadas para recuperar recursos específicos se você solicitá-los no código.</span><span class="sxs-lookup"><span data-stu-id="8e302-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="8e302-107">É a maneira mais simples para recuperar um recurso de código chamar o <xref:System.Windows.FrameworkElement.FindResource%2A> ou o <xref:System.Windows.FrameworkElement.TryFindResource%2A> método do nível da estrutura de objetos em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e302-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="8e302-108">A diferença comportamental entre esses métodos é o que acontece caso a chave solicitada não seja encontrada.</span><span class="sxs-lookup"><span data-stu-id="8e302-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="8e302-109"><xref:System.Windows.FrameworkElement.FindResource%2A>gera uma exceção; <xref:System.Windows.FrameworkElement.TryFindResource%2A> não gerará uma exceção, mas retorna `null`.</span><span class="sxs-lookup"><span data-stu-id="8e302-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="8e302-110">Cada método usa a chave do recurso como um parâmetro de entrada e retorna um objeto que não é fortemente tipado.</span><span class="sxs-lookup"><span data-stu-id="8e302-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="8e302-111">Normalmente, uma chave de recurso é uma cadeia de caracteres, mas há usos ocasionais em que esse não é o caso. Consulte a seção [Usando objetos como chaves](#objectaskey) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="8e302-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="8e302-112">Normalmente, você converteria o objeto retornado para o tipo exigido pela propriedade que você está definindo ao solicitar o recurso.</span><span class="sxs-lookup"><span data-stu-id="8e302-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="8e302-113">A lógica de pesquisa para resolução de recurso do código é a mesma que no caso [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] da referência de recurso dinâmico.</span><span class="sxs-lookup"><span data-stu-id="8e302-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="8e302-114">A pesquisa por recursos é iniciada do elemento de chamada e continua para os elementos pai sucessivos na árvore lógica.</span><span class="sxs-lookup"><span data-stu-id="8e302-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="8e302-115">A pesquisa segue adiante para os recursos de aplicativo, temas e recursos de sistema, se necessário.</span><span class="sxs-lookup"><span data-stu-id="8e302-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="8e302-116">Uma solicitação de código para um recurso considerará as alterações em tempo de execução nos dicionários de recursos que podem ter sido feitos após o dicionário de recursos ter sido carregado do [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], e também alterações de recursos de sistema em tempo real.</span><span class="sxs-lookup"><span data-stu-id="8e302-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="8e302-117">A seguir está um exemplo de código breve que encontra um recurso por chave e usa o valor retornado para definir uma propriedade, implementada como um <xref:System.Windows.Controls.Primitives.ButtonBase.Click> manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="8e302-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="8e302-118">Um método alternativo para atribuir uma referência de recurso é <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="8e302-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="8e302-119">Este método utiliza dois parâmetros: a chave do recurso e o identificador de uma determinada propriedade de dependência que está presente na instância do elemento a que o valor do recurso deve ser atribuído.</span><span class="sxs-lookup"><span data-stu-id="8e302-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="8e302-120">Funcionalmente, esse método é igual e tem a vantagem de não exigir nenhuma conversão de valores retornados.</span><span class="sxs-lookup"><span data-stu-id="8e302-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="8e302-121">Ainda outra maneira de acessar recursos de forma programática é acessar o conteúdo do <xref:System.Windows.FrameworkElement.Resources%2A> a propriedade como um dicionário.</span><span class="sxs-lookup"><span data-stu-id="8e302-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="8e302-122">Acessando o dicionário contido por esta propriedade, você também pode adicionar novos recursos a coleções existentes, verificar se um nome de chave já existe na coleção e outras operações de dicionário/coleção.</span><span class="sxs-lookup"><span data-stu-id="8e302-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="8e302-123">Se você estiver escrevendo um [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplicativo inteiramente em código, você pode também criar toda a coleção no código, atribuir as chaves a ele e, em seguida, atribua a coleção concluída para o <xref:System.Windows.FrameworkElement.Resources%2A> propriedade de um elemento estabelecida.</span><span class="sxs-lookup"><span data-stu-id="8e302-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="8e302-124">Isso será descrito na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="8e302-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="8e302-125">Você pode indexar em qualquer <xref:System.Windows.FrameworkElement.Resources%2A> coleção, usando uma chave específica como o índice, mas você deve estar ciente de acessar o recurso desse modo não segue as regras normais de tempo de execução da resolução de recursos.</span><span class="sxs-lookup"><span data-stu-id="8e302-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="8e302-126">Você está acessando apenas aquela coleção em particular.</span><span class="sxs-lookup"><span data-stu-id="8e302-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="8e302-127">A pesquisa de recursos não percorrerá o escopo até a raiz ou o aplicativo se nenhum objeto válido tiver sido encontrado na chave solicitada.</span><span class="sxs-lookup"><span data-stu-id="8e302-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="8e302-128">No entanto, essa abordagem pode ter vantagens de desempenho em alguns casos, precisamente porque o escopo da pesquisa no caso da chave é mais restrito.</span><span class="sxs-lookup"><span data-stu-id="8e302-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="8e302-129">Consulte o <xref:System.Windows.ResourceDictionary> classe para obter mais detalhes sobre como trabalhar com o dicionário de recurso diretamente.</span><span class="sxs-lookup"><span data-stu-id="8e302-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="8e302-130">Criando recursos com código</span><span class="sxs-lookup"><span data-stu-id="8e302-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="8e302-131">Se quiser criar um aplicativo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] inteiro em código, você também poderá querer criar todos os recursos do aplicativo em código.</span><span class="sxs-lookup"><span data-stu-id="8e302-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="8e302-132">Para fazer isso, crie um novo <xref:System.Windows.ResourceDictionary> instância e, em seguida, adicionar todos os recursos ao dicionário usando sucessivas chamadas para <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8e302-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8e302-133">Em seguida, use o <xref:System.Windows.ResourceDictionary> assim criado para definir a <xref:System.Windows.FrameworkElement.Resources%2A> propriedade em um elemento que está presente no escopo de página, ou o <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8e302-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8e302-134">Você também pode manter o <xref:System.Windows.ResourceDictionary> como um objeto autônomo sem adicionar um elemento.</span><span class="sxs-lookup"><span data-stu-id="8e302-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="8e302-135">No entanto, se fizer isso, você precisará acessar os recursos dentro pela chave do item, como se ele fosse um dicionário genérico.</span><span class="sxs-lookup"><span data-stu-id="8e302-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="8e302-136">Um <xref:System.Windows.ResourceDictionary> que não está anexado a um elemento `Resources` não existirá como parte da árvore de elemento de propriedade e não tem nenhum escopo em uma sequência de pesquisa que pode ser usado por <xref:System.Windows.FrameworkElement.FindResource%2A> e métodos relacionados.</span><span class="sxs-lookup"><span data-stu-id="8e302-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="8e302-137">Usando objetos como chaves</span><span class="sxs-lookup"><span data-stu-id="8e302-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="8e302-138">A maioria dos usos do recurso definirá a chave de recurso como uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="8e302-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="8e302-139">No entanto, vários recursos de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] deliberadamente não usam um tipo de cadeia de caracteres para especificar chaves, em vez disso, este parâmetro é um objeto.</span><span class="sxs-lookup"><span data-stu-id="8e302-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="8e302-140">A capacidade de ter recursos cujas chaves são objetos é usada pelo suporte a estilos e temas de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8e302-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="8e302-141">Os estilos de temas que tornam-se o estilo padrão para um controle não estilizado caso contrário, são chaveados pelo <xref:System.Type> do controle que eles devem ser aplicados.</span><span class="sxs-lookup"><span data-stu-id="8e302-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="8e302-142">Ter como chave um tipo fornece um mecanismo de pesquisa confiável que funciona em instâncias padrão de cada tipo de controle, e o tipo pode ser detectado por reflexão e usado para estilizar classes derivadas mesmo que o tipo derivado não tenha nenhum estilo padrão.</span><span class="sxs-lookup"><span data-stu-id="8e302-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="8e302-143">Você pode especificar um <xref:System.Type> chave para um recurso definido em [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] usando o [x: tipo de extensão de marcação](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="8e302-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="8e302-144">Extensões semelhantes existem para outros usos de chave diferentes de cadeias de caracteres que dão suporte a recursos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], como a [Extensão de marcação ComponentResourceKey](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="8e302-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8e302-145">Consulte também</span><span class="sxs-lookup"><span data-stu-id="8e302-145">See Also</span></span>  
 [<span data-ttu-id="8e302-146">Recursos XAML</span><span class="sxs-lookup"><span data-stu-id="8e302-146">XAML Resources</span></span>](../../../../docs/framework/wpf/advanced/xaml-resources.md)  
 [<span data-ttu-id="8e302-147">Estilo e modelagem</span><span class="sxs-lookup"><span data-stu-id="8e302-147">Styling and Templating</span></span>](../../../../docs/framework/wpf/controls/styling-and-templating.md)
