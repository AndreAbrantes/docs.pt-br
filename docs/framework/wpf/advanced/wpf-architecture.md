---
title: Arquitetura do WPF
ms.date: 03/30/2017
helpviewer_keywords:
- properties [WPF], attached
- attached properties [WPF]
- architecture [WPF]
- unmanaged components [WPF]
- affinity thread [WPF]
- Storyboards [WPF]
- milcore [WPF]
- components [WPF], unmanaged
- painter's algorithm
- interfaces [WPF], INotifyPropertyChange
- CommandBindings [WPF]
- data templates [WPF]
- thread [WPF], affinity
ms.assetid: 8579c10b-76ab-4c52-9691-195ce02333c8
ms.openlocfilehash: 02a70e65cd53a8998395987770cd32efc82293d0
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/03/2019
ms.locfileid: "73459600"
---
# <a name="wpf-architecture"></a><span data-ttu-id="4a61d-102">Arquitetura do WPF</span><span class="sxs-lookup"><span data-stu-id="4a61d-102">WPF Architecture</span></span>
<span data-ttu-id="4a61d-103">Este tópico fornece um tour guiado pela hierarquia de classes do Windows Presentation Foundation (WPF).</span><span class="sxs-lookup"><span data-stu-id="4a61d-103">This topic provides a guided tour of the Windows Presentation Foundation (WPF) class hierarchy.</span></span> <span data-ttu-id="4a61d-104">Ele aborda a maioria dos subsistemas principais do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] e descreve como eles interagem.</span><span class="sxs-lookup"><span data-stu-id="4a61d-104">It covers most of the major subsystems of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], and describes how they interact.</span></span> <span data-ttu-id="4a61d-105">Ele também detalha algumas das escolhas feitas pelos arquitetos do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-105">It also details some of the choices made by the architects of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span>  

<a name="System_Object"></a>   
## <a name="systemobject"></a><span data-ttu-id="4a61d-106">System.Object</span><span class="sxs-lookup"><span data-stu-id="4a61d-106">System.Object</span></span>  
 <span data-ttu-id="4a61d-107">O modelo de programação principal do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é exposto por meio de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-107">The primary [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] programming model is exposed through managed code.</span></span> <span data-ttu-id="4a61d-108">No início da fase de projeto do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], houve um número de debates sobre qual deveria ser o limite determinado entre os componentes gerenciados e os não gerenciados do sistema.</span><span class="sxs-lookup"><span data-stu-id="4a61d-108">Early in the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] there were a number of debates about where the line should be drawn between the managed components of the system and the unmanaged ones.</span></span> <span data-ttu-id="4a61d-109">O CLR fornece vários recursos que tornam o desenvolvimento mais produtivo e robusto (incluindo gerenciamento de memória, tratamento de erros, Common Type System, etc.), mas eles chegam a um custo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-109">The CLR provides a number of features that make development more productive and robust (including memory management, error handling, common type system, etc.) but they come at a cost.</span></span>  
  
 <span data-ttu-id="4a61d-110">Os principais componentes do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] estão ilustrados na figura abaixo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-110">The major components of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are illustrated in the figure below.</span></span> <span data-ttu-id="4a61d-111">As seções em vermelho do diagrama (PresentationFramework, PresentationCore e milcore) são as principais partes de código do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-111">The red sections of the diagram (PresentationFramework, PresentationCore, and milcore) are the major code portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="4a61d-112">Dessas, somente uma é um componente não gerenciado – milcore.</span><span class="sxs-lookup"><span data-stu-id="4a61d-112">Of these, only one is an unmanaged component – milcore.</span></span> <span data-ttu-id="4a61d-113">O milcore é escrito em código não gerenciado a fim de habilitar a integração estreita com o DirectX.</span><span class="sxs-lookup"><span data-stu-id="4a61d-113">Milcore is written in unmanaged code in order to enable tight integration with DirectX.</span></span> <span data-ttu-id="4a61d-114">Todas as exibições no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] são feitas por meio do mecanismo do DirectX, permitindo uma renderização de hardware e software eficiente.</span><span class="sxs-lookup"><span data-stu-id="4a61d-114">All display in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is done through the DirectX engine, allowing for efficient hardware and software rendering.</span></span> <span data-ttu-id="4a61d-115">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] também exigiu controle detalhado de memória e execução.</span><span class="sxs-lookup"><span data-stu-id="4a61d-115">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] also required fine control over memory and execution.</span></span> <span data-ttu-id="4a61d-116">O mecanismo de composição no milcore é extremamente sensível ao desempenho e é necessário desistir de muitas vantagens do CLR para obter desempenho.</span><span class="sxs-lookup"><span data-stu-id="4a61d-116">The composition engine in milcore is extremely performance sensitive, and required giving up many advantages of the CLR to gain performance.</span></span>  
  
 <span data-ttu-id="4a61d-117">![A posição do WPF dentro do .NET Framework.](./media/wpf-architect1.PNG "wpf_architect1")</span><span class="sxs-lookup"><span data-stu-id="4a61d-117">![The position of WPF within the .NET Framework.](./media/wpf-architect1.PNG "wpf_architect1")</span></span>  
  
 <span data-ttu-id="4a61d-118">Comunicação entre as partes gerenciadas e não gerenciadas do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é discutida posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="4a61d-118">Communication between the managed and unmanaged portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is discussed later in this topic.</span></span> <span data-ttu-id="4a61d-119">O restante do modelo de programação gerenciado é descrito abaixo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-119">The remainder of the managed programming model is described below.</span></span>  
  
<a name="System_Threading_DispatcherObject"></a>   
## <a name="systemthreadingdispatcherobject"></a><span data-ttu-id="4a61d-120">System.Threading.DispatcherObject</span><span class="sxs-lookup"><span data-stu-id="4a61d-120">System.Threading.DispatcherObject</span></span>  
 <span data-ttu-id="4a61d-121">A maioria dos objetos no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] deriva de <xref:System.Windows.Threading.DispatcherObject>, que fornece as construções básicas para lidar com a simultaneidade e a Threading.</span><span class="sxs-lookup"><span data-stu-id="4a61d-121">Most objects in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] derive from <xref:System.Windows.Threading.DispatcherObject>, which provides the basic constructs for dealing with concurrency and threading.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="4a61d-122">se baseia em um sistema de mensagens implementado pelo dispatcher.</span><span class="sxs-lookup"><span data-stu-id="4a61d-122">is based on a messaging system implemented by the dispatcher.</span></span> <span data-ttu-id="4a61d-123">Isso funciona de maneira muito semelhante ao já familiar aumento de mensagens do [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]; na verdade, o dispatcher do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] usa mensagens User32 para realizar chamadas entre threads.</span><span class="sxs-lookup"><span data-stu-id="4a61d-123">This works much like the familiar [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] message pump; in fact, the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dispatcher uses User32 messages for performing cross thread calls.</span></span>  
  
 <span data-ttu-id="4a61d-124">Há na verdade dois conceitos principais a serem entendidos ao discutir a simultaneidade no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – o dispatcher e afinidade de thread.</span><span class="sxs-lookup"><span data-stu-id="4a61d-124">There are really two core concepts to understand when discussing concurrency in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – the dispatcher and thread affinity.</span></span>  
  
 <span data-ttu-id="4a61d-125">Durante a fase de design do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a meta era mudar para um único thread de execução, mas um modelo não sujeito à afinidade de thread.</span><span class="sxs-lookup"><span data-stu-id="4a61d-125">During the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the goal was to move to a single thread of execution, but a non-thread "affinitized" model.</span></span> <span data-ttu-id="4a61d-126">A afinidade de thread ocorre quando um componente usa a identidade do thread em execução para armazenar algum tipo de estado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-126">Thread affinity happens when a component uses the identity of the executing thread to store some type of state.</span></span> <span data-ttu-id="4a61d-127">A forma mais comum disso é usar o armazenamento local de thread (TLS) para armazenar o estado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-127">The most common form of this is to use the thread local store (TLS) to store state.</span></span> <span data-ttu-id="4a61d-128">Afinidade de threads requer que cada thread lógica de execução pertença a apenas um thread físico no sistema operacional, que pode passar a fazer uso intensivo de memória.</span><span class="sxs-lookup"><span data-stu-id="4a61d-128">Thread affinity requires that each logical thread of execution be owned by only one physical thread in the operating system, which can become memory intensive.</span></span> <span data-ttu-id="4a61d-129">No final, o modelo de threading do WPF foi mantido em sincronização com o modelo de threading User32 existente, de execução em thread único com afinidade de thread.</span><span class="sxs-lookup"><span data-stu-id="4a61d-129">In the end, WPF’s threading model was kept in sync with the existing User32 threading model of single threaded execution with thread affinity.</span></span> <span data-ttu-id="4a61d-130">O principal motivo para isso foi interoperabilidade – sistemas como [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], a área de transferência e o Internet Explorer exigem, todos, execução STA (afinidade de thread único).</span><span class="sxs-lookup"><span data-stu-id="4a61d-130">The primary reason for this was interoperability – systems like [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], the clipboard, and Internet Explorer all require single thread affinity (STA) execution.</span></span>  
  
 <span data-ttu-id="4a61d-131">Considerando que você tem objetos com threading STA, você precisa de uma maneira para se comunicar entre threads e validar que você está no thread correto.</span><span class="sxs-lookup"><span data-stu-id="4a61d-131">Given that you have objects with STA threading, you need a way to communicate between threads, and validate that you are on the correct thread.</span></span> <span data-ttu-id="4a61d-132">Eis aí a função do dispatcher.</span><span class="sxs-lookup"><span data-stu-id="4a61d-132">Herein lies the role of the dispatcher.</span></span> <span data-ttu-id="4a61d-133">O dispatcher é um sistema básico de despacho de mensagens, com várias filas priorizadas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-133">The dispatcher is a basic message dispatching system, with multiple prioritized queues.</span></span> <span data-ttu-id="4a61d-134">Exemplos de mensagens incluem notificações de entrada bruta (o mouse foi movido), funções de estrutura (layout) ou comandos do usuário (executar este método).</span><span class="sxs-lookup"><span data-stu-id="4a61d-134">Examples of messages include raw input notifications (mouse moved), framework functions (layout), or user commands (execute this method).</span></span> <span data-ttu-id="4a61d-135">Derivando de <xref:System.Windows.Threading.DispatcherObject>, você cria um objeto CLR com comportamento STA e receberá um ponteiro para um Dispatcher no momento da criação.</span><span class="sxs-lookup"><span data-stu-id="4a61d-135">By deriving from <xref:System.Windows.Threading.DispatcherObject>, you create a CLR object that has STA behavior, and will be given a pointer to a dispatcher at creation time.</span></span>  
  
<a name="System_Windows_DependencyObject"></a>   
## <a name="systemwindowsdependencyobject"></a><span data-ttu-id="4a61d-136">System.Windows.DependencyObject</span><span class="sxs-lookup"><span data-stu-id="4a61d-136">System.Windows.DependencyObject</span></span>  
 <span data-ttu-id="4a61d-137">Uma das principais filosofias da arquitetura usadas ao compilar [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] foi a preferência por propriedades sobre métodos ou eventos.</span><span class="sxs-lookup"><span data-stu-id="4a61d-137">One of the primary architectural philosophies used in building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] was a preference for properties over methods or events.</span></span> <span data-ttu-id="4a61d-138">Propriedades são declarativas e permitem que você especifique mais facilmente a intenção em vez de ação.</span><span class="sxs-lookup"><span data-stu-id="4a61d-138">Properties are declarative and allow you to more easily specify intent instead of action.</span></span> <span data-ttu-id="4a61d-139">Isso também deu suporte para um sistema controlado por modelo ou por dados para exibição do conteúdo de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="4a61d-139">This also supported a model driven, or data driven, system for displaying user interface content.</span></span> <span data-ttu-id="4a61d-140">Essa filosofia tinha o efeito desejado de criar mais propriedades do que o número ao qual você era capaz de se associar, de modo a controlar melhor o comportamento de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-140">This philosophy had the intended effect of creating more properties that you could bind to, in order to better control the behavior of an application.</span></span>  
  
 <span data-ttu-id="4a61d-141">Para ter mais sistemas controlados por propriedades, um sistema de propriedades mais avançado do que o que o CLR fornece era necessário.</span><span class="sxs-lookup"><span data-stu-id="4a61d-141">In order to have more of the system driven by properties, a richer property system than what the CLR provides was needed.</span></span> <span data-ttu-id="4a61d-142">Um exemplo simples desta sofisticação é encontrado nas notificações de alteração.</span><span class="sxs-lookup"><span data-stu-id="4a61d-142">A simple example of this richness is change notifications.</span></span> <span data-ttu-id="4a61d-143">Para habilitar a associação bidirecional, você precisa que ambos os lados da associação deem suporte à notificação de alteração.</span><span class="sxs-lookup"><span data-stu-id="4a61d-143">In order to enable two way binding, you need both sides of the bind to support change notification.</span></span> <span data-ttu-id="4a61d-144">Para ter comportamento ligado aos valores de propriedade, você precisa ser notificado quando o valor da propriedade é alterado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-144">In order to have behavior tied to property values, you need to be notified when the property value changes.</span></span> <span data-ttu-id="4a61d-145">O Microsoft .NET Framework tem uma interface, **INotifyPropertyChange**, que permite que um objeto publique notificações de alteração, no entanto, é opcional.</span><span class="sxs-lookup"><span data-stu-id="4a61d-145">The Microsoft .NET Framework has an interface, **INotifyPropertyChange**, which allows an object to publish change notifications, however it is optional.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="4a61d-146">fornece um sistema de propriedades mais avançado, derivado do tipo <xref:System.Windows.DependencyObject>.</span><span class="sxs-lookup"><span data-stu-id="4a61d-146">provides a richer property system, derived from the <xref:System.Windows.DependencyObject> type.</span></span> <span data-ttu-id="4a61d-147">O sistema de propriedades é realmente um sistema de propriedade de "dependência", que controla as dependências entre expressões de propriedade e revalida automaticamente valores de propriedade quando as dependências são alteradas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-147">The property system is truly a "dependency" property system in that it tracks dependencies between property expressions and automatically revalidates property values when dependencies change.</span></span> <span data-ttu-id="4a61d-148">Por exemplo, se você tiver uma propriedade que herda (como <xref:System.Windows.Controls.Control.FontSize%2A>), o sistema será atualizado automaticamente se a propriedade for alterada em um pai de um elemento que herda o valor.</span><span class="sxs-lookup"><span data-stu-id="4a61d-148">For example, if you have a property that inherits (like <xref:System.Windows.Controls.Control.FontSize%2A>), the system is automatically updated if the property changes on a parent of an element that inherits the value.</span></span>  
  
 <span data-ttu-id="4a61d-149">A base do sistema de propriedades do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é o conceito de uma expressão de propriedade.</span><span class="sxs-lookup"><span data-stu-id="4a61d-149">The foundation of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] property system is the concept of a property expression.</span></span> <span data-ttu-id="4a61d-150">Nesta primeira versão do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], o sistema de expressão de propriedade é fechado e as expressões são fornecidas como parte da estrutura.</span><span class="sxs-lookup"><span data-stu-id="4a61d-150">In this first release of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the property expression system is closed, and the expressions are all provided as part of the framework.</span></span> <span data-ttu-id="4a61d-151">As expressões são o motivo pelo qual o sistema de propriedades não tem associação de dados, definição de estilo ou herança fixados no código, mas sim fornecidos por camadas posteriores dentro do framework.</span><span class="sxs-lookup"><span data-stu-id="4a61d-151">Expressions are why the property system doesn’t have data binding, styling, or inheritance hard coded, but rather provided by later layers within the framework.</span></span>  
  
 <span data-ttu-id="4a61d-152">O sistema de propriedades também fornece armazenamento esparso de valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="4a61d-152">The property system also provides for sparse storage of property values.</span></span> <span data-ttu-id="4a61d-153">Já que os objetos podem ter dezenas (se não centenas) de propriedades e a maioria dos valores estão em seu estado padrão (herdado, definido por estilos, etc.), nem toda instância de um objeto precisa ter o peso total de todas as propriedades definidas nele.</span><span class="sxs-lookup"><span data-stu-id="4a61d-153">Because objects can have dozens (if not hundreds) of properties, and most of the values are in their default state (inherited, set by styles, etc.), not every instance of an object needs to have the full weight of every property defined on it.</span></span>  
  
 <span data-ttu-id="4a61d-154">O último novo recurso do sistema de propriedades é o conceito de propriedades anexadas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-154">The final new feature of the property system is the notion of attached properties.</span></span> <span data-ttu-id="4a61d-155">Elementos [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] são criados sobre o princípio de composição e reutilização de componente.</span><span class="sxs-lookup"><span data-stu-id="4a61d-155">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements are built on the principle of composition and component reuse.</span></span> <span data-ttu-id="4a61d-156">Geralmente, o caso de algum elemento contendo (como um <xref:System.Windows.Controls.Grid> elemento de layout) precisa de dados adicionais em elementos filho para controlar seu comportamento (como as informações de linha/coluna).</span><span class="sxs-lookup"><span data-stu-id="4a61d-156">It is often the case that some containing element (like a <xref:System.Windows.Controls.Grid> layout element) needs additional data on child elements to control its behavior (like the Row/Column information).</span></span> <span data-ttu-id="4a61d-157">Em vez de associar todas essas propriedades com cada elemento, qualquer objeto tem permissão para fornecer definições de propriedade para qualquer outro objeto.</span><span class="sxs-lookup"><span data-stu-id="4a61d-157">Instead of associating all of these properties with every element, any object is allowed to provide property definitions for any other object.</span></span> <span data-ttu-id="4a61d-158">Isso é semelhante aos recursos "expando" do JavaScript.</span><span class="sxs-lookup"><span data-stu-id="4a61d-158">This is similar to the "expando" features of JavaScript.</span></span>  
  
<a name="System_Windows_Media_Visual"></a>   
## <a name="systemwindowsmediavisual"></a><span data-ttu-id="4a61d-159">System.Windows.Media.Visual</span><span class="sxs-lookup"><span data-stu-id="4a61d-159">System.Windows.Media.Visual</span></span>  
 <span data-ttu-id="4a61d-160">Com um sistema definido, a próxima etapa é fazer com que pixels sejam desenhados na tela.</span><span class="sxs-lookup"><span data-stu-id="4a61d-160">With a system defined, the next step is getting pixels drawn to the screen.</span></span> <span data-ttu-id="4a61d-161">A classe <xref:System.Windows.Media.Visual> fornece a criação de uma árvore de objetos visuais, cada um opcionalmente contendo instruções de desenho e metadados sobre como renderizar essas instruções (recorte, transformação, etc.).</span><span class="sxs-lookup"><span data-stu-id="4a61d-161">The <xref:System.Windows.Media.Visual> class provides for building a tree of visual objects, each optionally containing drawing instructions and metadata about how to render those instructions (clipping, transformation, etc.).</span></span> <span data-ttu-id="4a61d-162">a <xref:System.Windows.Media.Visual> foi projetada para ser extremamente leve e flexível, portanto, a maioria dos recursos não tem exposição à API pública e depende muito das funções de retorno de chamada protegidas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-162"><xref:System.Windows.Media.Visual> is designed to be extremely lightweight and flexible, so most of the features have no public API exposure and rely heavily on protected callback functions.</span></span>  
  
 <span data-ttu-id="4a61d-163"><xref:System.Windows.Media.Visual> é realmente o ponto de entrada para o sistema de composição de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-163"><xref:System.Windows.Media.Visual> is really the entry point to the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] composition system.</span></span> <span data-ttu-id="4a61d-164"><xref:System.Windows.Media.Visual> é o ponto de conexão entre esses dois subsistemas, a API gerenciada e o milcore não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-164"><xref:System.Windows.Media.Visual> is the point of connection between these two subsystems, the managed API and the unmanaged milcore.</span></span>  
  
 <span data-ttu-id="4a61d-165">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] exibe dados percorrendo as estruturas de dados não gerenciados gerenciadas pelo milcore.</span><span class="sxs-lookup"><span data-stu-id="4a61d-165">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] displays data by traversing the unmanaged data structures managed by the milcore.</span></span> <span data-ttu-id="4a61d-166">Essas estruturas, chamadas nós de composição, representam uma árvore de exibição hierárquica com instruções de renderização em cada nó.</span><span class="sxs-lookup"><span data-stu-id="4a61d-166">These structures, called composition nodes, represent a hierarchical display tree with rendering instructions at each node.</span></span> <span data-ttu-id="4a61d-167">Essa árvore, ilustrada no lado direito da figura abaixo, só é acessível por meio de um protocolo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="4a61d-167">This tree, illustrated on the right hand side of the figure below, is only accessible through a messaging protocol.</span></span>  
  
 <span data-ttu-id="4a61d-168">Ao programar [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], você cria elementos de <xref:System.Windows.Media.Visual> e tipos derivados, que se comunicam internamente com a árvore de composição por meio desse protocolo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="4a61d-168">When programming [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you create <xref:System.Windows.Media.Visual> elements, and derived types, which internally communicate to the composition tree through this messaging protocol.</span></span> <span data-ttu-id="4a61d-169">Cada <xref:System.Windows.Media.Visual> no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] pode criar um, nenhum ou vários nós de composição.</span><span class="sxs-lookup"><span data-stu-id="4a61d-169">Each <xref:System.Windows.Media.Visual> in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] may create one, none, or several composition nodes.</span></span>  
  
 <span data-ttu-id="4a61d-170">![A árvore Visual Windows Presentation Foundation.](./media/wpf-architecture2.PNG "wpf_architecture2")</span><span class="sxs-lookup"><span data-stu-id="4a61d-170">![The Windows Presentation Foundation Visual Tree.](./media/wpf-architecture2.PNG "wpf_architecture2")</span></span>  
  
 <span data-ttu-id="4a61d-171">Há um detalhe arquitetural muito importante a observar aqui – toda a árvore de elementos visuais e instruções de desenho é armazenada em cache.</span><span class="sxs-lookup"><span data-stu-id="4a61d-171">There is a very important architectural detail to notice here – the entire tree of visuals and drawing instructions is cached.</span></span> <span data-ttu-id="4a61d-172">Em termos gráficos, o [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] usa um sistema de renderização retido.</span><span class="sxs-lookup"><span data-stu-id="4a61d-172">In graphics terms, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uses a retained rendering system.</span></span> <span data-ttu-id="4a61d-173">Isso permite ao sistema redesenhar com altas taxas de atualização sem o bloqueio do sistema de composição em retornos de chamada para o código do usuário.</span><span class="sxs-lookup"><span data-stu-id="4a61d-173">This enables the system to repaint at high refresh rates without the composition system blocking on callbacks to user code.</span></span> <span data-ttu-id="4a61d-174">Isso ajuda a impedir o surgimento de um aplicativo que não responde.</span><span class="sxs-lookup"><span data-stu-id="4a61d-174">This helps prevent the appearance of an unresponsive application.</span></span>  
  
 <span data-ttu-id="4a61d-175">Outro detalhe importante que não é realmente perceptível no diagrama é o modo como o sistema realmente executa a composição.</span><span class="sxs-lookup"><span data-stu-id="4a61d-175">Another important detail that isn’t really noticeable in the diagram is how the system actually performs composition.</span></span>  
  
 <span data-ttu-id="4a61d-176">No User32 e no GDI, o sistema funciona em um sistema de recorte de modo imediato.</span><span class="sxs-lookup"><span data-stu-id="4a61d-176">In User32 and GDI, the system works on an immediate mode clipping system.</span></span> <span data-ttu-id="4a61d-177">Quando um componente precisa ser renderizado, o sistema estabelece os limites de recorte fora dos quais o componente não tem permissão para tocar nos pixels e, em seguida, é solicitado ao componente que ele pinte os pixels dentro dessa caixa.</span><span class="sxs-lookup"><span data-stu-id="4a61d-177">When a component needs to be rendered, the system establishes a clipping bounds outside of which the component isn’t allowed to touch the pixels, and then the component is asked to paint pixels in that box.</span></span> <span data-ttu-id="4a61d-178">Este sistema funciona muito bem em sistemas com restrição de memória porque quando algo é alterado, você só tem que tocar o componente afetado – não há jamais dois componentes que contribuam para a cor de um único pixel.</span><span class="sxs-lookup"><span data-stu-id="4a61d-178">This system works very well in memory constrained systems because when something changes you only have to touch the affected component – no two components ever contribute to the color of a single pixel.</span></span>  
  
 <span data-ttu-id="4a61d-179">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] usa um modelo de pintura de "algoritmo de pincel".</span><span class="sxs-lookup"><span data-stu-id="4a61d-179">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uses a "painter's algorithm" painting model.</span></span> <span data-ttu-id="4a61d-180">Isso significa que, em vez de cortar cada componente, é solicitado a cada componente que renderize da parte de trás da exibição para a parte da frente.</span><span class="sxs-lookup"><span data-stu-id="4a61d-180">This means that instead of clipping each component, each component is asked to render from the back to the front of the display.</span></span> <span data-ttu-id="4a61d-181">Isso permite que cada componente pinte sobre a exibição do componente anterior.</span><span class="sxs-lookup"><span data-stu-id="4a61d-181">This allows each component to paint over the previous component's display.</span></span> <span data-ttu-id="4a61d-182">A vantagem desse modelo é que você pode ter formas complexas, parcialmente transparentes.</span><span class="sxs-lookup"><span data-stu-id="4a61d-182">The advantage of this model is that you can have complex, partially transparent shapes.</span></span> <span data-ttu-id="4a61d-183">Com o hardware de gráficos moderno de hoje, esse modelo é relativamente rápido (que não era o caso quando user32/GDI foram criados).</span><span class="sxs-lookup"><span data-stu-id="4a61d-183">With today’s modern graphics hardware, this model is relatively fast (which wasn’t the case when User32/ GDI were created).</span></span>  
  
 <span data-ttu-id="4a61d-184">Conforme mencionado anteriormente, uma filosofia central do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é mover para um modelo de programação mais declarativo, "centrado em propriedades".</span><span class="sxs-lookup"><span data-stu-id="4a61d-184">As mentioned previously, a core philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is to move to a more declarative, "property centric" model of programming.</span></span> <span data-ttu-id="4a61d-185">No sistema visual, isso aparece em alguns locais interessantes.</span><span class="sxs-lookup"><span data-stu-id="4a61d-185">In the visual system, this shows up in a couple of interesting places.</span></span>  
  
 <span data-ttu-id="4a61d-186">Primeiro, se você pensar sobre o sistema gráfico de modo retido, isso estará realmente se movendo de um modelo de tipo DrawLine/DrawLine imperativo para um modelo orientado a dados – new Line()/new Line().</span><span class="sxs-lookup"><span data-stu-id="4a61d-186">First, if you think about the retained mode graphic system, this is really moving away from an imperative DrawLine/DrawLine type model, to a data oriented model – new Line()/new Line().</span></span> <span data-ttu-id="4a61d-187">A mudança para a renderização controlada por dados permite que operações complexas nas instruções de desenho sejam expressas usando propriedades.</span><span class="sxs-lookup"><span data-stu-id="4a61d-187">This move to data driven rendering allows complex operations on the drawing instructions to be expressed using properties.</span></span> <span data-ttu-id="4a61d-188">Os tipos derivados de <xref:System.Windows.Media.Drawing> são efetivamente o modelo de objeto para renderização.</span><span class="sxs-lookup"><span data-stu-id="4a61d-188">The types deriving from <xref:System.Windows.Media.Drawing> are effectively the object model for rendering.</span></span>  
  
 <span data-ttu-id="4a61d-189">Em segundo lugar, se você avaliar o sistema de animação, verá que ele é quase completamente declarativo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-189">Second, if you evaluate the animation system, you'll see that it is almost completely declarative.</span></span> <span data-ttu-id="4a61d-190">Em vez de exigir que um desenvolvedor calcule o próximo local, ou a próxima cor, você pode expressar animações como um conjunto de propriedades em um objeto de animação.</span><span class="sxs-lookup"><span data-stu-id="4a61d-190">Instead of requiring a developer to compute the next location, or next color, you can express animations as a set of properties on an animation object.</span></span> <span data-ttu-id="4a61d-191">Essas animações podem expressar a intenção do desenvolvedor ou designer (mover esse botão daqui para lá em 5 segundos), e o sistema pode determinar a maneira mais eficiente de fazer isso.</span><span class="sxs-lookup"><span data-stu-id="4a61d-191">These animations can then express the intent of the developer or designer (move this button from here to there in 5 seconds), and the system can determine the most efficient way to accomplish that.</span></span>  
  
<a name="System_Windows_UIElement"></a>   
## <a name="systemwindowsuielement"></a><span data-ttu-id="4a61d-192">System.Windows.UIElement</span><span class="sxs-lookup"><span data-stu-id="4a61d-192">System.Windows.UIElement</span></span>  
 <span data-ttu-id="4a61d-193"><xref:System.Windows.UIElement> define subsistemas principais, incluindo layout, entrada e eventos.</span><span class="sxs-lookup"><span data-stu-id="4a61d-193"><xref:System.Windows.UIElement> defines core subsystems including Layout, Input, and Events.</span></span>  
  
 <span data-ttu-id="4a61d-194">Layout é um conceito central no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-194">Layout is a core concept in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="4a61d-195">Em muitos sistemas, há um conjunto fixo de modelos de layout (o HTML dá suporte a três modelos de layout; fluxo, absoluto e tabelas) ou nenhum modelo de layout (o User32 dá suporte somente a posicionamento absoluto).</span><span class="sxs-lookup"><span data-stu-id="4a61d-195">In many systems there is either a fixed set of layout models (HTML supports three models for layout; flow, absolute, and tables) or no model for layout (User32 really only supports absolute positioning).</span></span> <span data-ttu-id="4a61d-196">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] começou com a suposição de que os desenvolvedores e designers queriam um modelo de layout flexível e extensível, que pudesse ser controlado por valores de propriedade em vez de lógica imperativa.</span><span class="sxs-lookup"><span data-stu-id="4a61d-196">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] started with the assumption that developers and designers wanted a flexible, extensible layout model, which could be driven by property values rather than imperative logic.</span></span> <span data-ttu-id="4a61d-197">No nível de <xref:System.Windows.UIElement>, o contrato básico de layout é introduzido – um modelo de duas fases com <xref:System.Windows.UIElement.Measure%2A> e <xref:System.Windows.UIElement.Arrange%2A> passa.</span><span class="sxs-lookup"><span data-stu-id="4a61d-197">At the <xref:System.Windows.UIElement> level, the basic contract for layout is introduced – a two phase model with <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> passes.</span></span>  
  
 <span data-ttu-id="4a61d-198"><xref:System.Windows.UIElement.Measure%2A> permite que um componente determine a quantidade de tamanho que gostaria de tomar.</span><span class="sxs-lookup"><span data-stu-id="4a61d-198"><xref:System.Windows.UIElement.Measure%2A> allows a component to determine how much size it would like to take.</span></span> <span data-ttu-id="4a61d-199">Essa é uma fase separada da <xref:System.Windows.UIElement.Arrange%2A> porque há muitas situações em que um elemento pai solicitará que um filho meça várias vezes para determinar a posição e o tamanho ideais.</span><span class="sxs-lookup"><span data-stu-id="4a61d-199">This is a separate phase from <xref:System.Windows.UIElement.Arrange%2A> because there are many situations where a parent element will ask a child to measure several times to determine its optimal position and size.</span></span> <span data-ttu-id="4a61d-200">O fato de que os elementos pai pedem a elementos filho para se medirem demonstra outra filosofia chave do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – dimensionar para o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-200">The fact that parent elements ask child elements to measure demonstrates another key philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – size to content.</span></span> <span data-ttu-id="4a61d-201">Todos os controles em [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dão suporte à capacidade de dimensionar para o tamanho natural de seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-201">All controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] support the ability to size to the natural size of their content.</span></span> <span data-ttu-id="4a61d-202">Isso torna a localização muito mais fácil e permite layout dinâmico dos elementos conforme as coisas são redimensionadas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-202">This makes localization much easier, and allows for dynamic layout of elements as things resize.</span></span> <span data-ttu-id="4a61d-203">A fase de <xref:System.Windows.UIElement.Arrange%2A> permite que um pai Posicione e determine o tamanho final de cada filho.</span><span class="sxs-lookup"><span data-stu-id="4a61d-203">The <xref:System.Windows.UIElement.Arrange%2A> phase allows a parent to position and determine the final size of each child.</span></span>  
  
 <span data-ttu-id="4a61d-204">Muito tempo, muitas vezes, é gasto falando sobre o lado de saída de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – <xref:System.Windows.Media.Visual> e objetos relacionados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-204">A lot of time is often spent talking about the output side of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – <xref:System.Windows.Media.Visual> and related objects.</span></span> <span data-ttu-id="4a61d-205">No entanto, também há um tremendo montante de inovação no lado de entrada.</span><span class="sxs-lookup"><span data-stu-id="4a61d-205">However there is a tremendous amount of innovation on the input side as well.</span></span> <span data-ttu-id="4a61d-206">Provavelmente, a alteração mais fundamental no modelo de entrada para [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é o modelo consistente pelo qual os eventos de entrada são roteados através do sistema.</span><span class="sxs-lookup"><span data-stu-id="4a61d-206">Probably the most fundamental change in the input model for [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the consistent model by which input events are routed through the system.</span></span>  
  
 <span data-ttu-id="4a61d-207">A entrada se origina como um sinal em um driver de dispositivo de modo kernel e é roteada para o processo e thread corretos por um processo intrincado, que envolve o kernel do Windows e o User32.</span><span class="sxs-lookup"><span data-stu-id="4a61d-207">Input originates as a signal on a kernel mode device driver and gets routed to the correct process and thread through an intricate process involving the Windows kernel and User32.</span></span> <span data-ttu-id="4a61d-208">Depois que a mensagem User32 correspondente à entrada é roteada para [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], ela será convertida em uma mensagem de entrada bruta do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] e enviada para o dispatcher.</span><span class="sxs-lookup"><span data-stu-id="4a61d-208">Once the User32 message corresponding to the input is routed to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], it is converted into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] raw input message and sent to the dispatcher.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="4a61d-209">permite que eventos de entrada brutos sejam convertidos em vários eventos reais, permitindo que recursos como "MouseEnter" sejam implementados em um nível baixo do sistema com entrega garantida.</span><span class="sxs-lookup"><span data-stu-id="4a61d-209">allows for raw input events to be converted to multiple actual events, enabling features like "MouseEnter" to be implemented at a low level of the system with guaranteed delivery.</span></span>  
  
 <span data-ttu-id="4a61d-210">Cada evento de entrada é convertido em pelo menos dois eventos – um evento de "visualização" e o evento real.</span><span class="sxs-lookup"><span data-stu-id="4a61d-210">Each input event is converted to at least two events – a "preview" event and the actual event.</span></span> <span data-ttu-id="4a61d-211">Todos os eventos no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] têm uma noção de roteamento através da árvore de elementos.</span><span class="sxs-lookup"><span data-stu-id="4a61d-211">All events in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] have a notion of routing through the element tree.</span></span> <span data-ttu-id="4a61d-212">Os eventos são considerados "bolha" se percorrerem de um destino na árvore até a raiz e forem considerados "túnel" se começarem na raiz e percorrerem para um destino.</span><span class="sxs-lookup"><span data-stu-id="4a61d-212">Events are said to "bubble" if they traverse from a target up the tree to the root, and are said to "tunnel" if they start at the root and traverse down to a target.</span></span> <span data-ttu-id="4a61d-213">Eventos de visualização de entrada são roteados por túnel, permitindo que qualquer elemento na árvore tenha uma oportunidade de filtrar ou executar uma ação no evento.</span><span class="sxs-lookup"><span data-stu-id="4a61d-213">Input preview events tunnel, enabling any element in the tree an opportunity to filter or take action on the event.</span></span> <span data-ttu-id="4a61d-214">Os eventos regulares (não visualização) são então roteados por propagação do destino até a raiz.</span><span class="sxs-lookup"><span data-stu-id="4a61d-214">The regular (non-preview) events then bubble from the target up to the root.</span></span>  
  
 <span data-ttu-id="4a61d-215">Essa divisão entre as fases de túnel e de propagação torna a implementação de recursos como aceleradores de teclado funcionar de forma consistente em um mundo composto.</span><span class="sxs-lookup"><span data-stu-id="4a61d-215">This split between the tunnel and bubble phase makes implementation of features like keyboard accelerators work in a consistent fashion in a composite world.</span></span> <span data-ttu-id="4a61d-216">No User32, você poderia implementar aceleradores de teclado tendo uma única tabela global contendo todos os aceleradores aos quais que você quisesse dar suporte (Ctrl + N mapeando para "New").</span><span class="sxs-lookup"><span data-stu-id="4a61d-216">In User32 you would implement keyboard accelerators by having a single global table containing all the accelerators you wanted to support (Ctrl+N mapping to "New").</span></span> <span data-ttu-id="4a61d-217">No dispatcher para seu aplicativo, você chamaria **TranslateAccelerator**, que rastrearia as mensagens de entrada no User32 e determinaria se havia correspondência entre alguma delas e um acelerador registrado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-217">In the dispatcher for your application you would call **TranslateAccelerator** which would sniff the input messages in User32 and determine if any matched a registered accelerator.</span></span> <span data-ttu-id="4a61d-218">Em [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] isso não funcionaria, pois o sistema é totalmente "passível de composição" – qualquer elemento pode manipular e usar qualquer acelerador de teclado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-218">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] this wouldn’t work because the system is fully "composable" – any element can handle and use any keyboard accelerator.</span></span> <span data-ttu-id="4a61d-219">Esse modelo de duas fases para a entrada permite que os componentes implementem seu próprio "TranslateAccelerator".</span><span class="sxs-lookup"><span data-stu-id="4a61d-219">Having this two phase model for input allows components to implement their own "TranslateAccelerator".</span></span>  
  
 <span data-ttu-id="4a61d-220">Para levar isso um passo além, <xref:System.Windows.UIElement> também apresenta a noção de CommandBindings.</span><span class="sxs-lookup"><span data-stu-id="4a61d-220">To take this one step further, <xref:System.Windows.UIElement> also introduces the notion of CommandBindings.</span></span> <span data-ttu-id="4a61d-221">O sistema de comandos [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] permite que os desenvolvedores definam a funcionalidade em termos de um ponto de extremidade de comando – algo que implementa <xref:System.Windows.Input.ICommand>.</span><span class="sxs-lookup"><span data-stu-id="4a61d-221">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] command system allows developers to define functionality in terms of a command end point – something that implements <xref:System.Windows.Input.ICommand>.</span></span> <span data-ttu-id="4a61d-222">Associações de comando permitem a um elemento definir um mapeamento entre um gesto de entrada (Ctrl + N) e um comando (New).</span><span class="sxs-lookup"><span data-stu-id="4a61d-222">Command bindings enable an element to define a mapping between an input gesture (Ctrl+N) and a command (New).</span></span> <span data-ttu-id="4a61d-223">Tanto os gestos de entrada quanto as definições de comando são extensíveis e podem ser ligados juntos durante o tempo de uso.</span><span class="sxs-lookup"><span data-stu-id="4a61d-223">Both the input gestures and command definitions are extensible, and can be wired together at usage time.</span></span> <span data-ttu-id="4a61d-224">Isso torna trivial, por exemplo, permitir que um usuário final personalize as associações de teclas que deseja usar em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-224">This makes it trivial, for example, to allow an end user to customize the key bindings that they want to use within an application.</span></span>  
  
 <span data-ttu-id="4a61d-225">Até esse ponto nesse tópico, os recursos "principais" do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – recursos implementados no assembly PresentationCore – têm sido o foco.</span><span class="sxs-lookup"><span data-stu-id="4a61d-225">To this point in the topic, "core" features of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – features implemented in the PresentationCore assembly, have been the focus.</span></span> <span data-ttu-id="4a61d-226">Ao criar [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], uma separação clara entre as partes fundamentais (como o contrato de layout com **medida** e **organização**) e as partes da estrutura (como a implementação de um layout específico, como <xref:System.Windows.Controls.Grid>) foi o resultado desejado.</span><span class="sxs-lookup"><span data-stu-id="4a61d-226">When building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a clean separation between foundational pieces (like the contract for layout with **Measure** and **Arrange**) and framework pieces (like the implementation of a specific layout like <xref:System.Windows.Controls.Grid>) was the desired outcome.</span></span> <span data-ttu-id="4a61d-227">A meta era fornecer um ponto de extensibilidade baixo na pilha que permitisse aos desenvolvedores externos criar suas próprias estruturas, se necessário.</span><span class="sxs-lookup"><span data-stu-id="4a61d-227">The goal was to provide an extensibility point low in the stack that would allow external developers to create their own frameworks if needed.</span></span>  
  
<a name="System_Windows_FrameworkElement"></a>   
## <a name="systemwindowsframeworkelement"></a><span data-ttu-id="4a61d-228">System.Windows.FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="4a61d-228">System.Windows.FrameworkElement</span></span>  
 <span data-ttu-id="4a61d-229"><xref:System.Windows.FrameworkElement> pode ser examinada de duas maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="4a61d-229"><xref:System.Windows.FrameworkElement> can be looked at in two different ways.</span></span> <span data-ttu-id="4a61d-230">Ele introduz um conjunto de políticas e personalizações dos subsistemas introduzidos nas camadas inferiores do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-230">It introduces a set of policies and customizations on the subsystems introduced in lower layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="4a61d-231">Ele também introduz um conjunto de novos subsistemas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-231">It also introduces a set of new subsystems.</span></span>  
  
 <span data-ttu-id="4a61d-232">A política principal introduzida pelo <xref:System.Windows.FrameworkElement> está em volta do layout do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-232">The primary policy introduced by <xref:System.Windows.FrameworkElement> is around application layout.</span></span> <span data-ttu-id="4a61d-233"><xref:System.Windows.FrameworkElement> baseia-se no contrato de layout básico introduzido pela <xref:System.Windows.UIElement> e adiciona a noção de um "slot" de layout que torna mais fácil para os autores de layout ter um conjunto consistente de semânticas de layout controlado por propriedade.</span><span class="sxs-lookup"><span data-stu-id="4a61d-233"><xref:System.Windows.FrameworkElement> builds on the basic layout contract introduced by <xref:System.Windows.UIElement> and adds the notion of a layout "slot" that makes it easier for layout authors to have a consistent set of property driven layout semantics.</span></span> <span data-ttu-id="4a61d-234">Propriedades como <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>, <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>, <xref:System.Windows.FrameworkElement.MinWidth%2A>e <xref:System.Windows.FrameworkElement.Margin%2A> (para citar alguns) fornecem a todos os componentes derivados de <xref:System.Windows.FrameworkElement> comportamento consistente dentro dos contêineres de layout.</span><span class="sxs-lookup"><span data-stu-id="4a61d-234">Properties like <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>, <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>, <xref:System.Windows.FrameworkElement.MinWidth%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A> (to name a few) give all components derived from <xref:System.Windows.FrameworkElement> consistent behavior inside of layout containers.</span></span>  
  
 <span data-ttu-id="4a61d-235"><xref:System.Windows.FrameworkElement> também fornece uma exposição mais fácil da API a muitos recursos encontrados nas camadas principais do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-235"><xref:System.Windows.FrameworkElement> also provides easier API exposure to many features found in the core layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="4a61d-236">Por exemplo, <xref:System.Windows.FrameworkElement> fornece acesso direto à animação por meio do método <xref:System.Windows.FrameworkElement.BeginStoryboard%2A>.</span><span class="sxs-lookup"><span data-stu-id="4a61d-236">For example, <xref:System.Windows.FrameworkElement> provides direct access to animation through the <xref:System.Windows.FrameworkElement.BeginStoryboard%2A> method.</span></span> <span data-ttu-id="4a61d-237">Uma <xref:System.Windows.Media.Animation.Storyboard> fornece uma maneira de gerar um script de várias animações em um conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="4a61d-237">A <xref:System.Windows.Media.Animation.Storyboard> provides a way to script multiple animations against a set of properties.</span></span>  
  
 <span data-ttu-id="4a61d-238">As duas coisas mais importantes que <xref:System.Windows.FrameworkElement> introduz são vinculação de dados e estilos.</span><span class="sxs-lookup"><span data-stu-id="4a61d-238">The two most critical things that <xref:System.Windows.FrameworkElement> introduces are data binding and styles.</span></span>  
  
 <span data-ttu-id="4a61d-239">O subsistema de ligação de dados no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] deve ser relativamente familiar para qualquer pessoa que tenha usado [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] ou ASP.NET para criar um aplicativo [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4a61d-239">The data binding subsystem in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] should be relatively familiar to anyone that has used [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or ASP.NET for creating an application [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="4a61d-240">Em cada um desses sistemas, há uma maneira simples de expressar se você deseja que uma ou mais propriedades de um determinado elemento seja associada a uma parte dos dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-240">In each of these systems, there is a simple way to express that you want one or more properties from a given element to be bound to a piece of data.</span></span> <span data-ttu-id="4a61d-241">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] tem suporte completo para associação de propriedades, transformações e associação de listas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-241">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] has full support for property binding, transformation, and list binding.</span></span>  
  
 <span data-ttu-id="4a61d-242">Um dos recursos mais interessantes de associação de dados no [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] é a introdução de modelos de dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-242">One of the most interesting features of data binding in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the introduction of data templates.</span></span> <span data-ttu-id="4a61d-243">Modelos de dados permitem que você especifique declarativamente como uma parte dos dados deve ser visualizada.</span><span class="sxs-lookup"><span data-stu-id="4a61d-243">Data templates allow you to declaratively specify how a piece of data should be visualized.</span></span> <span data-ttu-id="4a61d-244">Em vez de criar uma interface do usuário personalizada que pode ser associada a dados, você pode inverter o problema e permitir que os dados determinem a exibição que será criada.</span><span class="sxs-lookup"><span data-stu-id="4a61d-244">Instead of creating a custom user interface that can be bound to data, you can instead turn the problem around and let the data determine the display that will be created.</span></span>  
  
 <span data-ttu-id="4a61d-245">Definição de estilo é na verdade uma forma leve de associação de dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-245">Styling is really a lightweight form of data binding.</span></span> <span data-ttu-id="4a61d-246">Usando estilização, você pode associar um conjunto de propriedades de uma definição compartilhada a uma ou mais instâncias de um elemento.</span><span class="sxs-lookup"><span data-stu-id="4a61d-246">Using styling you can bind a set of properties from a shared definition to one or more instances of an element.</span></span> <span data-ttu-id="4a61d-247">Os estilos são aplicados a um elemento por referência explícita (definindo a propriedade <xref:System.Windows.FrameworkElement.Style%2A>) ou implicitamente associando um estilo ao tipo CLR do elemento.</span><span class="sxs-lookup"><span data-stu-id="4a61d-247">Styles get applied to an element either by explicit reference (by setting the <xref:System.Windows.FrameworkElement.Style%2A> property) or implicitly by associating a style with the CLR type of the element.</span></span>  
  
<a name="System_Windows_Controls_Control"></a>   
## <a name="systemwindowscontrolscontrol"></a><span data-ttu-id="4a61d-248">System.Windows.Controls.Control</span><span class="sxs-lookup"><span data-stu-id="4a61d-248">System.Windows.Controls.Control</span></span>  
 <span data-ttu-id="4a61d-249">O recurso mais significativo do controle é a modelagem.</span><span class="sxs-lookup"><span data-stu-id="4a61d-249">Control’s most significant feature is templating.</span></span> <span data-ttu-id="4a61d-250">Se você pensar sobre o sistema de composição do WPF como um sistema de renderização de modo retido, a modelagem permitirá que um controle descreva sua renderização de maneira declarativa e parametrizada.</span><span class="sxs-lookup"><span data-stu-id="4a61d-250">If you think about WPF’s composition system as a retained mode rendering system, templating allows a control to describe its rendering in a parameterized, declarative manner.</span></span> <span data-ttu-id="4a61d-251">Uma <xref:System.Windows.Controls.ControlTemplate>, na verdade, não é nada mais do que um script para criar um conjunto de elementos filho, com associações a Propriedades oferecidas pelo controle.</span><span class="sxs-lookup"><span data-stu-id="4a61d-251">A <xref:System.Windows.Controls.ControlTemplate> is really nothing more than a script to create a set of child elements, with bindings to properties offered by the control.</span></span>  
  
 <span data-ttu-id="4a61d-252"><xref:System.Windows.Controls.Control> fornece um conjunto de propriedades de ações, <xref:System.Windows.Controls.Control.Foreground%2A>, <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Padding%2A>, para citar alguns, que os autores de modelo podem usar para personalizar a exibição de um controle.</span><span class="sxs-lookup"><span data-stu-id="4a61d-252"><xref:System.Windows.Controls.Control> provides a set of stock properties, <xref:System.Windows.Controls.Control.Foreground%2A>, <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Padding%2A>, to name a few, which template authors can then use to customize the display of a control.</span></span> <span data-ttu-id="4a61d-253">A implementação de um controle oferece um modelo de dados e um modelo de interação.</span><span class="sxs-lookup"><span data-stu-id="4a61d-253">The implementation of a control provides a data model and interaction model.</span></span> <span data-ttu-id="4a61d-254">O modelo de interação define um conjunto de comandos (como Close para uma janela) e associações para gestos de entrada (como clicar no X vermelho no canto superior da janela).</span><span class="sxs-lookup"><span data-stu-id="4a61d-254">The interaction model defines a set of commands (like Close for a window) and bindings to input gestures (like clicking the red X in the upper corner of the window).</span></span> <span data-ttu-id="4a61d-255">O modelo de dados fornece um conjunto de propriedades para personalizar o modelo de interação ou então personalizar a exibição (determinado pelo modelo).</span><span class="sxs-lookup"><span data-stu-id="4a61d-255">The data model provides a set of properties to either customize the interaction model or customize the display (determined by the template).</span></span>  
  
 <span data-ttu-id="4a61d-256">Essa divisão entre o modelo de dados (propriedades), o modelo de interação (comandos e eventos) e o modelo de exibição (modelos) permite a completa personalização da aparência e comportamento de um controle.</span><span class="sxs-lookup"><span data-stu-id="4a61d-256">This split between the data model (properties), interaction model (commands and events), and display model (templates) enables complete customization of a control’s look and behavior.</span></span>  
  
 <span data-ttu-id="4a61d-257">Um aspecto comum do modelo de dados dos controles é o modelo de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-257">A common aspect of the data model of controls is the content model.</span></span> <span data-ttu-id="4a61d-258">Se você examinar um controle como <xref:System.Windows.Controls.Button>, verá que ele tem uma propriedade chamada "content" do tipo <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="4a61d-258">If you look at a control like <xref:System.Windows.Controls.Button>, you will see that it has a property named "Content" of type <xref:System.Object>.</span></span> <span data-ttu-id="4a61d-259">Em [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] e ASP.NET, essa propriedade normalmente seria uma cadeia de caracteres – no entanto, isso limita o tipo de conteúdo que você pode colocar em um botão.</span><span class="sxs-lookup"><span data-stu-id="4a61d-259">In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] and ASP.NET, this property would typically be a string – however that limits the type of content you can put in a button.</span></span> <span data-ttu-id="4a61d-260">O conteúdo de um botão pode ser uma cadeia de caracteres simples, um objeto de dados complexo ou uma árvore de elementos inteira.</span><span class="sxs-lookup"><span data-stu-id="4a61d-260">Content for a button can either be a simple string, a complex data object, or an entire element tree.</span></span> <span data-ttu-id="4a61d-261">No caso de um objeto de dados, o modelo de dados é usado para construir uma exibição.</span><span class="sxs-lookup"><span data-stu-id="4a61d-261">In the case of a data object, the data template is used to construct a display.</span></span>  
  
<a name="Summary"></a>   
## <a name="summary"></a><span data-ttu-id="4a61d-262">Resumo</span><span class="sxs-lookup"><span data-stu-id="4a61d-262">Summary</span></span>  
 <span data-ttu-id="4a61d-263">O [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] foi projetado para permitir que você crie sistemas de apresentação dinâmicos, controlados por dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-263">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is designed to allow you to create dynamic, data driven presentation systems.</span></span> <span data-ttu-id="4a61d-264">Cada parte do sistema foi projetada para criar objetos através de conjuntos de propriedades que controlam o comportamento.</span><span class="sxs-lookup"><span data-stu-id="4a61d-264">Every part of the system is designed to create objects through property sets that drive behavior.</span></span> <span data-ttu-id="4a61d-265">A associação de dados é uma parte fundamental do sistema e está integrada em todas as camadas.</span><span class="sxs-lookup"><span data-stu-id="4a61d-265">Data binding is a fundamental part of the system, and is integrated at every layer.</span></span>  
  
 <span data-ttu-id="4a61d-266">Aplicativos tradicionais criam uma exibição e, em seguida, associam a alguns dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-266">Traditional applications create a display and then bind to some data.</span></span> <span data-ttu-id="4a61d-267">Em [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], tudo que se relaciona ao controle e todos os aspectos da exibição são gerados por algum tipo de associação de dados.</span><span class="sxs-lookup"><span data-stu-id="4a61d-267">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], everything about the control, every aspect of the display, is generated by some type of data binding.</span></span> <span data-ttu-id="4a61d-268">O texto encontrado em um botão é exibido por meio da criação de um controle composto dentro do botão e da associação de sua exibição à propriedade de conteúdo do botão.</span><span class="sxs-lookup"><span data-stu-id="4a61d-268">The text found inside a button is displayed by creating a composed control inside of the button and binding its display to the button’s content property.</span></span>  
  
 <span data-ttu-id="4a61d-269">Quando você começar a desenvolver aplicativos com base em [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], isso deverá se tornar muito familiar.</span><span class="sxs-lookup"><span data-stu-id="4a61d-269">When you begin developing [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] based applications, it should feel very familiar.</span></span> <span data-ttu-id="4a61d-270">Você pode definir propriedades, usar objetos e associar dados da mesma maneira que você pode usar [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] ou ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4a61d-270">You can set properties, use objects, and data bind in much the same way that you can using [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or ASP.NET.</span></span> <span data-ttu-id="4a61d-271">Com uma investigação mais profunda da arquitetura do [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], você descobrirá que existe a possibilidade de criar aplicativos muito mais sofisticados que, fundamentalmente, tratem os dados como o controlador principal do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a61d-271">With a deeper investigation into the architecture of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you'll find that the possibility exists for creating much richer applications that fundamentally treat data as the core driver of the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4a61d-272">Consulte também</span><span class="sxs-lookup"><span data-stu-id="4a61d-272">See also</span></span>

- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.UIElement>
- <xref:System.Windows.Input.ICommand>
- <xref:System.Windows.FrameworkElement>
- <xref:System.Windows.Threading.DispatcherObject>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Controls.Control>
- [<span data-ttu-id="4a61d-273">Visão geral da vinculação de dados</span><span class="sxs-lookup"><span data-stu-id="4a61d-273">Data Binding Overview</span></span>](../../../desktop-wpf/data/data-binding-overview.md)
- [<span data-ttu-id="4a61d-274">Layout</span><span class="sxs-lookup"><span data-stu-id="4a61d-274">Layout</span></span>](layout.md)
- [<span data-ttu-id="4a61d-275">Visão geral da animação</span><span class="sxs-lookup"><span data-stu-id="4a61d-275">Animation Overview</span></span>](../graphics-multimedia/animation-overview.md)
