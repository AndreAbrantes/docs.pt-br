---
title: "Visual Basic e manipulação de eventos WPF"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
caps.latest.revision: "12"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: ca55e31060388012e6bb94e40159c2e602484911
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/21/2017
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="38a5d-102">Visual Basic e manipulação de eventos WPF</span><span class="sxs-lookup"><span data-stu-id="38a5d-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="38a5d-103">Para o [!INCLUDE[TLA#tla_visualbnet](../../../../includes/tlasharptla-visualbnet-md.md)] idioma especificamente, você pode usar o idioma específico `Handles` palavra-chave para associar manipuladores de eventos com instâncias, em vez de anexar os manipuladores de eventos com atributos ou usando o <xref:System.Windows.UIElement.AddHandler%2A> método.</span><span class="sxs-lookup"><span data-stu-id="38a5d-103">For the [!INCLUDE[TLA#tla_visualbnet](../../../../includes/tlasharptla-visualbnet-md.md)] language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="38a5d-104">No entanto, a técnica `Handles` para anexar manipuladores às instâncias tem algumas limitações, uma vez que a sintaxe `Handles` não dá suporte a alguns dos recursos específicos de evento roteado do sistema de eventos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38a5d-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="38a5d-105">Usando "manipuladores" em um aplicativo WPF</span><span class="sxs-lookup"><span data-stu-id="38a5d-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="38a5d-106">Os manipuladores de eventos que estão conectados às instâncias e aos eventos com `Handles` devem ser definidos na declaração de classe parcial da instância, que também é um requisito para os manipuladores de eventos que são atribuídos por meio de valores de atributos nos elementos.</span><span class="sxs-lookup"><span data-stu-id="38a5d-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="38a5d-107">Você só pode especificar `Handles` para um elemento na página que tem um <xref:System.Windows.FrameworkContentElement.Name%2A> o valor da propriedade (ou [diretiva X:Name](../../../../docs/framework/xaml-services/x-name-directive.md) declarado).</span><span class="sxs-lookup"><span data-stu-id="38a5d-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="38a5d-108">Isso ocorre porque o <xref:System.Windows.FrameworkContentElement.Name%2A> na [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] cria a referência de instância é necessária para dar suporte a *Instance* formato de referência necessário para o `Handles` sintaxe.</span><span class="sxs-lookup"><span data-stu-id="38a5d-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="38a5d-109">O único elemento que pode ser usado para `Handles` sem um <xref:System.Windows.FrameworkContentElement.Name%2A> referência é a instância do elemento raiz que define a classe parcial.</span><span class="sxs-lookup"><span data-stu-id="38a5d-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="38a5d-110">Você pode atribuir o mesmo manipulador para vários elementos, separando as referências *Instance.Event* depois de `Handles` com vírgulas.</span><span class="sxs-lookup"><span data-stu-id="38a5d-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="38a5d-111">Você pode usar `Handles` para atribuir mais de um manipulador à mesma referência *Instance.Event*.</span><span class="sxs-lookup"><span data-stu-id="38a5d-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="38a5d-112">Não atribua nenhuma importância para a ordem na qual os manipuladores são fornecidos na referência `Handles`. Você deve presumir que os manipuladores que operam o mesmo evento podem ser invocados em qualquer ordem.</span><span class="sxs-lookup"><span data-stu-id="38a5d-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="38a5d-113">Para remover um manipulador que tenha sido adicionado com `Handles` na declaração, você pode chamar <xref:System.Windows.UIElement.RemoveHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="38a5d-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="38a5d-114">Você pode usar `Handles` para anexar manipuladores em eventos roteados, desde que anexe os manipuladores às instâncias que definem o evento que está sendo manipulado nas suas tabelas de membros.</span><span class="sxs-lookup"><span data-stu-id="38a5d-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="38a5d-115">Para eventos roteados, manipuladores anexados com `Handles` seguem as mesmas regras de roteamentos que os tratadores que estão anexados como [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] atributos, ou com a assinatura comum de <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="38a5d-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="38a5d-116">Isso significa que, se o evento já estiver marcado como tratado (o <xref:System.Windows.RoutedEventArgs.Handled%2A> propriedade nos dados do evento é `True`), em seguida, com os manipuladores anexados `Handles` não são invocados em resposta a essa instância do evento.</span><span class="sxs-lookup"><span data-stu-id="38a5d-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="38a5d-117">O evento poderia ser marcado como manipulado pelos manipuladores de instância em outro elemento da rota, ou pela manipulação de classe no elemento atual ou nos elementos anteriores ao longo da rota.</span><span class="sxs-lookup"><span data-stu-id="38a5d-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="38a5d-118">Nos eventos de entrada que dão suporte ao túnel emparelhado/eventos de bolha, a rota de túnel pode ter marcado o par de eventos manipulado.</span><span class="sxs-lookup"><span data-stu-id="38a5d-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="38a5d-119">Para obter mais informações sobre os eventos roteados, consulte [Visão geral de eventos roteados](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="38a5d-119">For more information about routed events, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="38a5d-120">Limitações de "Identificadores" para adicionar manipuladores</span><span class="sxs-lookup"><span data-stu-id="38a5d-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="38a5d-121">Os `Handles` não podem referenciar manipuladores para eventos anexados.</span><span class="sxs-lookup"><span data-stu-id="38a5d-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="38a5d-122">Você deve usar o método de acesso `add` para esse evento anexado, ou os atributos de evento *typename.eventname* em [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38a5d-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="38a5d-123">Para obter os detalhes, consulte [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md) (Visão geral dos eventos roteados).</span><span class="sxs-lookup"><span data-stu-id="38a5d-123">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="38a5d-124">Para eventos roteados, você só pode usar `Handles` para atribuir manipuladores nas instâncias em que esse evento existir na tabela de membros da instância.</span><span class="sxs-lookup"><span data-stu-id="38a5d-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="38a5d-125">No entanto, nos eventos roteados em geral, um elemento pai poderá ser um ouvinte para um evento de elementos filho, mesmo se o elemento pai não tiver esse evento em sua tabela de membros.</span><span class="sxs-lookup"><span data-stu-id="38a5d-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="38a5d-126">Na sintaxe de atributo, você pode especificar essa opção por meio de um formulário de atributos *typename.membername*, que qualifica qual tipo realmente define o evento que você deseja manipular.</span><span class="sxs-lookup"><span data-stu-id="38a5d-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="38a5d-127">Por exemplo, um pai `Page` (sem nenhum `Click` evento definido) pode escutar eventos de clique do botão atribuindo um manipulador de atributo na forma `Button.Click`.</span><span class="sxs-lookup"><span data-stu-id="38a5d-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="38a5d-128">No entanto, `Handles` não dá suporte ao formulário *typename.membername*, uma vez que ele deve dar suporte a um formulário *Instance.Event* conflitante.</span><span class="sxs-lookup"><span data-stu-id="38a5d-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="38a5d-129">Para obter os detalhes, consulte [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md) (Visão geral dos eventos roteados).</span><span class="sxs-lookup"><span data-stu-id="38a5d-129">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="38a5d-130">Os `Handles` não podem anexar manipuladores que são invocados para eventos que já estão marcados como manipulados.</span><span class="sxs-lookup"><span data-stu-id="38a5d-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="38a5d-131">Em vez disso, você deve usar código e chamar o `handledEventsToo` de sobrecarga de <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="38a5d-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="38a5d-132">Não use a sintaxe `Handles` no código [!INCLUDE[vb_current_short](../../../../includes/vb-current-short-md.md)] quando você especificar um manipulador de eventos para o mesmo evento na linguagem XAML.</span><span class="sxs-lookup"><span data-stu-id="38a5d-132">Do not use the `Handles` syntax in [!INCLUDE[vb_current_short](../../../../includes/vb-current-short-md.md)] code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="38a5d-133">Nesse caso, o manipulador de eventos é chamado duas vezes.</span><span class="sxs-lookup"><span data-stu-id="38a5d-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="38a5d-134">Como o WPF implementa a funcionalidade "Identificadores"</span><span class="sxs-lookup"><span data-stu-id="38a5d-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="38a5d-135">Quando um [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] página é compilada, o arquivo intermediário declara `Friend` `WithEvents` referências para cada elemento na página que possui um <xref:System.Windows.FrameworkContentElement.Name%2A> conjunto de propriedades (ou [diretiva X:Name](../../../../docs/framework/xaml-services/x-name-directive.md) declarado).</span><span class="sxs-lookup"><span data-stu-id="38a5d-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="38a5d-136">Cada instância nomeada é potencialmente um elemento que pode ser atribuído a um manipulador por meio de `Handles`.</span><span class="sxs-lookup"><span data-stu-id="38a5d-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="38a5d-137">Com o [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], o [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] pode mostrar a conclusão de quais elementos estão disponíveis para uma referência `Handles` em uma página.</span><span class="sxs-lookup"><span data-stu-id="38a5d-137">Within [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="38a5d-138">No entanto, isso pode fazer com que uma compilação seja transmitida, de modo que o arquivo intermediário possa preencher todas as referências `Friends`.</span><span class="sxs-lookup"><span data-stu-id="38a5d-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38a5d-139">Consulte também</span><span class="sxs-lookup"><span data-stu-id="38a5d-139">See Also</span></span>  
 <xref:System.Windows.UIElement.AddHandler%2A>  
 [<span data-ttu-id="38a5d-140">Marcando eventos roteados como manipulados e tratamento de classes</span><span class="sxs-lookup"><span data-stu-id="38a5d-140">Marking Routed Events as Handled, and Class Handling</span></span>](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md)  
 [<span data-ttu-id="38a5d-141">Visão geral de eventos roteados</span><span class="sxs-lookup"><span data-stu-id="38a5d-141">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [<span data-ttu-id="38a5d-142">Visão geral de XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="38a5d-142">XAML Overview (WPF)</span></span>](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)
