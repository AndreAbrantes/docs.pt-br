---
title: Visão geral da impressão
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 5204165370459466b1258897e72c488ab7e7fadb
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/12/2019
ms.locfileid: "73975775"
---
# <a name="printing-overview"></a><span data-ttu-id="1571d-102">Visão geral da impressão</span><span class="sxs-lookup"><span data-stu-id="1571d-102">Printing Overview</span></span>
<span data-ttu-id="1571d-103">Com o Microsoft .NET Framework, os desenvolvedores de aplicativos que usam o Windows Presentation Foundation (WPF) têm um novo conjunto avançado de APIs de gerenciamento do sistema de impressão e impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="1571d-104">Com o Windows Vista, alguns desses aprimoramentos do sistema de impressão também estão disponíveis para desenvolvedores que criam [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] aplicativos e desenvolvedores usando código não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="1571d-104">With Windows Vista, some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="1571d-105">No núcleo dessa nova funcionalidade está o novo formato de arquivo XPS (XML Paper Specification) e o caminho de impressão XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="1571d-106">Este tópico contém as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="1571d-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="1571d-107">Sobre XPS</span><span class="sxs-lookup"><span data-stu-id="1571d-107">About XPS</span></span>  
 <span data-ttu-id="1571d-108">XPS é um formato de documento eletrônico, um formato de arquivo de spool e uma linguagem de descrição de página.</span><span class="sxs-lookup"><span data-stu-id="1571d-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="1571d-109">É um formato de documento aberto que usa XML, OPC (Open Packaging Conventions) e outros padrões do setor para criar documentos de plataforma cruzada.</span><span class="sxs-lookup"><span data-stu-id="1571d-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="1571d-110">O XPS simplifica o processo pelo qual documentos digitais são criados, compartilhados, impressos, exibidos e arquivados.</span><span class="sxs-lookup"><span data-stu-id="1571d-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="1571d-111">Para obter informações adicionais sobre o XPS, consulte [XPS Documents](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="1571d-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="1571d-112">Várias técnicas para imprimir conteúdo baseado em XPS usando [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] são demonstradas em [arquivos XPS de impressão programaticamente](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="1571d-112">Several techniques for printing XPS-based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="1571d-113">Talvez seja útil consultar esses exemplos durante o exame do conteúdo contido neste tópico.</span><span class="sxs-lookup"><span data-stu-id="1571d-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="1571d-114">(Os desenvolvedores de código não gerenciado devem ver a documentação para a [função MXDC_ESCAPE](/windows/desktop/printdocs/mxdc-escape).</span><span class="sxs-lookup"><span data-stu-id="1571d-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="1571d-115">Windows Forms os desenvolvedores devem usar a API no namespace <xref:System.Drawing.Printing>, que não oferece suporte ao caminho completo de impressão XPS, mas dá suporte a um caminho de impressão híbrido para XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="1571d-116">Consulte **Arquitetura de caminho de impressão** abaixo).</span><span class="sxs-lookup"><span data-stu-id="1571d-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="1571d-117">Caminho de impressão XPS</span><span class="sxs-lookup"><span data-stu-id="1571d-117">XPS Print Path</span></span>  
 <span data-ttu-id="1571d-118">O caminho de impressão do XML Paper Specification (XPS) é um novo recurso do Windows que redefine como a impressão é tratada em aplicativos do Windows.</span><span class="sxs-lookup"><span data-stu-id="1571d-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="1571d-119">Como o XPS pode substituir uma linguagem de apresentação de documento (como RTF), um formato de spooler de impressão (como WMF) e uma linguagem de descrição de página (como PCL ou PostScript); o novo caminho de impressão mantém o formato XPS da publicação do aplicativo para o processamento final no driver ou dispositivo de impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="1571d-120">O caminho de impressão XPS é criado sobre o modelo de driver de impressora XPS (XPSDrv), que fornece vários benefícios para desenvolvedores como "o que você vê é o que você obtém" (WYSIWYG), suporte a cores aprimorado e melhor desempenho de impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="1571d-121">(Para obter mais informações sobre XPSDrv, consulte a [documentação do kit de driver do Windows](/windows-hardware/drivers/).)</span><span class="sxs-lookup"><span data-stu-id="1571d-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="1571d-122">A operação do spooler de impressão para documentos XPS é essencialmente a mesma das versões anteriores do Windows.</span><span class="sxs-lookup"><span data-stu-id="1571d-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="1571d-123">No entanto, ele foi aprimorado para dar suporte ao caminho de impressão XPS além do caminho de impressão GDI existente.</span><span class="sxs-lookup"><span data-stu-id="1571d-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="1571d-124">O novo caminho de impressão consome nativamente um arquivo de spool XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="1571d-125">Embora os drivers de impressora do modo de usuário escritos para versões anteriores do Windows continuem a funcionar, um driver de impressora XPS (XPSDrv) é necessário para usar o caminho de impressão XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="1571d-126">Os benefícios do caminho de impressão XPS são significativos e incluem:</span><span class="sxs-lookup"><span data-stu-id="1571d-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="1571d-127">Suporte de impressão WYSIWYG</span><span class="sxs-lookup"><span data-stu-id="1571d-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="1571d-128">Suporte nativo a perfis de cores avançados, que incluem 32 bits por canal (bpc), CMYK, cores nomeadas, n-inks e suporte nativo à transparência e gradientes.</span><span class="sxs-lookup"><span data-stu-id="1571d-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="1571d-129">Melhor desempenho de impressão para aplicativos baseados em .NET Framework e [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1571d-129">Improved print performance for both .NET Framework and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.</span></span>  
  
- <span data-ttu-id="1571d-130">Formato XPS padrão do setor.</span><span class="sxs-lookup"><span data-stu-id="1571d-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="1571d-131">Para cenários de impressão básicos, uma API simples e intuitiva está disponível com um único ponto de entrada para a interface do usuário, configuração e envio de trabalhos.</span><span class="sxs-lookup"><span data-stu-id="1571d-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="1571d-132">Para cenários avançados, foi adicionado um suporte extra para a personalização de [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] (ou mesmo para nenhuma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]), para a impressão síncrona ou assíncrona e recursos de impressão de lote.</span><span class="sxs-lookup"><span data-stu-id="1571d-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="1571d-133">As duas opções fornecem suporte de impressão no modo de confiança total ou parcial.</span><span class="sxs-lookup"><span data-stu-id="1571d-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="1571d-134">O XPS foi projetado tendo em mente a extensibilidade.</span><span class="sxs-lookup"><span data-stu-id="1571d-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="1571d-135">Usando a estrutura de extensibilidade, recursos e funcionalidades podem ser adicionados ao XPS de maneira modular.</span><span class="sxs-lookup"><span data-stu-id="1571d-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="1571d-136">Os recursos de extensibilidade incluem:</span><span class="sxs-lookup"><span data-stu-id="1571d-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="1571d-137">Esquema de Impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-137">Print Schema.</span></span> <span data-ttu-id="1571d-138">O esquema público é atualizado regularmente e permite a rápida extensão de recursos do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="1571d-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="1571d-139">(Consulte **PrintTicket e PrintCapabilities** abaixo).</span><span class="sxs-lookup"><span data-stu-id="1571d-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="1571d-140">Pipeline de filtro extensível.</span><span class="sxs-lookup"><span data-stu-id="1571d-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="1571d-141">O pipeline de filtro do driver de impressora XPS (XPSDrv) foi projetado para permitir a impressão direta e escalonável de documentos XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="1571d-142">Para obter mais informações, consulte [XPSDrv Printer drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="1571d-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="1571d-143">Arquitetura de caminho de impressão</span><span class="sxs-lookup"><span data-stu-id="1571d-143">Print Path Architecture</span></span>  
 <span data-ttu-id="1571d-144">Embora os aplicativos [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e .NET Framework ofereçam suporte a XPS, os aplicativos [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e Windows Forms usam uma conversão de GDI para XPS para criar conteúdo em formato XPS para o driver de impressora XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="1571d-144">While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and .NET Framework applications support XPS, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="1571d-145">Esses aplicativos não são obrigados a usar o caminho de impressão XPS e podem continuar a usar a impressão baseada em metarquivos avançados (EMF).</span><span class="sxs-lookup"><span data-stu-id="1571d-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="1571d-146">No entanto, a maioria dos recursos e aprimoramentos do XPS só está disponível para aplicativos direcionados ao caminho de impressão XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="1571d-147">Para habilitar o uso de impressoras baseadas em XPSDrv por [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e Windows Forms aplicativos, o driver de impressora XPS (XPSDrv) dá suporte à conversão do formato GDI para XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-147">To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="1571d-148">O modelo XPSDrv também fornece um conversor para o formato XPS para GDI para que [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplicativos possam imprimir documentos XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-148">The XPSDrv model also provides a converter for XPS to GDI format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print XPS Documents.</span></span> <span data-ttu-id="1571d-149">Para aplicativos [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a conversão do formato XPS para GDI é feita automaticamente pelo <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> e <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> métodos da classe <xref:System.Windows.Xps.XpsDocumentWriter> sempre que a fila de impressão de destino da operação de gravação não tem um driver XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="1571d-149">For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="1571d-150">(Windows Forms aplicativos não podem imprimir documentos XPS.)</span><span class="sxs-lookup"><span data-stu-id="1571d-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="1571d-151">A ilustração a seguir descreve o subsistema de impressão e define as partes fornecidas pela Microsoft e as partes definidas por fornecedores de software e hardware:</span><span class="sxs-lookup"><span data-stu-id="1571d-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Captura de tela mostra o sistema de impressão XPS.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="1571d-153">Impressão XPS básica</span><span class="sxs-lookup"><span data-stu-id="1571d-153">Basic XPS Printing</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="1571d-154">define uma API básica e avançada.</span><span class="sxs-lookup"><span data-stu-id="1571d-154">defines both a basic and advanced API.</span></span> <span data-ttu-id="1571d-155">Para os aplicativos que não exigem ampla personalização de impressão ou acesso ao conjunto completo de recursos XPS, o suporte a impressão básica está disponível.</span><span class="sxs-lookup"><span data-stu-id="1571d-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="1571d-156">O suporte básico de impressão é exposto por meio de um controle de caixa de diálogo de impressão que exige configuração mínima e apresenta uma [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] familiar.</span><span class="sxs-lookup"><span data-stu-id="1571d-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="1571d-157">Muitos recursos do XPS estão disponíveis usando esse modelo de impressão simplificado.</span><span class="sxs-lookup"><span data-stu-id="1571d-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="1571d-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="1571d-158">PrintDialog</span></span>  
 <span data-ttu-id="1571d-159">O controle de <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> fornece um único ponto de entrada para envio de trabalho de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuração e XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="1571d-160">Para obter informações sobre como criar uma instância e usar o controle, consulte [Invocar uma caixa de diálogo de impressão](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="1571d-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="1571d-161">Impressão XPS avançada</span><span class="sxs-lookup"><span data-stu-id="1571d-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="1571d-162">Para acessar o conjunto completo de recursos do XPS, a API de impressão avançada deve ser usada.</span><span class="sxs-lookup"><span data-stu-id="1571d-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="1571d-163">Várias APIs relevantes são descritas mais detalhadamente abaixo.</span><span class="sxs-lookup"><span data-stu-id="1571d-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="1571d-164">Para obter uma lista completa de APIs de caminho de impressão XPS, consulte as referências de namespace <xref:System.Windows.Xps> e <xref:System.Printing>.</span><span class="sxs-lookup"><span data-stu-id="1571d-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="1571d-165">PrintTicket e PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="1571d-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="1571d-166">As classes <xref:System.Printing.PrintTicket> e <xref:System.Printing.PrintCapabilities> são a base dos recursos avançados do XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="1571d-167">Os dois tipos de objetos são estruturas formatadas em XML de recursos orientados para impressão, como agrupamento, impressão em duas laterais, grampeamento etc. Essas estruturas são definidas pelo esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="1571d-168">Um <xref:System.Printing.PrintTicket> instrui uma impressora a processar um trabalho de impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="1571d-169">A classe <xref:System.Printing.PrintCapabilities> define os recursos de uma impressora.</span><span class="sxs-lookup"><span data-stu-id="1571d-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="1571d-170">Ao consultar os recursos de uma impressora, um <xref:System.Printing.PrintTicket> pode ser criado para aproveitar ao máximo os recursos com suporte de uma impressora.</span><span class="sxs-lookup"><span data-stu-id="1571d-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="1571d-171">Da mesma forma, os recursos sem suporte podem ser evitados.</span><span class="sxs-lookup"><span data-stu-id="1571d-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="1571d-172">O exemplo a seguir demonstra como consultar a <xref:System.Printing.PrintCapabilities> de uma impressora e criar uma <xref:System.Printing.PrintTicket> usando código.</span><span class="sxs-lookup"><span data-stu-id="1571d-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="1571d-173">PrintServer e PrintQueue</span><span class="sxs-lookup"><span data-stu-id="1571d-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="1571d-174">A classe <xref:System.Printing.PrintServer> representa um servidor de impressão de rede e a classe <xref:System.Printing.PrintQueue> representa uma impressora e a fila de trabalhos de saída associada a ela.</span><span class="sxs-lookup"><span data-stu-id="1571d-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="1571d-175">Juntas, essas APIs permitem o gerenciamento avançado de trabalhos de impressão de um servidor.</span><span class="sxs-lookup"><span data-stu-id="1571d-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="1571d-176">Uma <xref:System.Printing.PrintServer>, ou uma de suas classes derivadas, é usada para gerenciar um <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="1571d-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="1571d-177">O método <xref:System.Printing.PrintQueue.AddJob%2A> é usado para inserir um novo trabalho de impressão na fila.</span><span class="sxs-lookup"><span data-stu-id="1571d-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="1571d-178">O exemplo a seguir demonstra como criar um <xref:System.Printing.LocalPrintServer> e acessar seu <xref:System.Printing.PrintQueue> padrão usando código.</span><span class="sxs-lookup"><span data-stu-id="1571d-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="1571d-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="1571d-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="1571d-180">Um <xref:System.Windows.Xps.XpsDocumentWriter>, com seus muitos métodos <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> e <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>, é usado para gravar documentos XPS em um <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="1571d-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="1571d-181">Por exemplo, o método <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> é usado para gerar um documento XPS e <xref:System.Printing.PrintTicket> de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="1571d-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="1571d-182">O método <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> é usado para gerar um documento XPS e <xref:System.Printing.PrintTicket> de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="1571d-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="1571d-183">O exemplo a seguir demonstra como criar um <xref:System.Windows.Xps.XpsDocumentWriter> usando código.</span><span class="sxs-lookup"><span data-stu-id="1571d-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="1571d-184">Os métodos de <xref:System.Printing.PrintQueue.AddJob%2A> também fornecem maneiras de imprimir.</span><span class="sxs-lookup"><span data-stu-id="1571d-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="1571d-185">Consulte [Imprimir arquivos XPS de forma programática](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="1571d-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="1571d-186">para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="1571d-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="1571d-187">Caminho de impressão GDI</span><span class="sxs-lookup"><span data-stu-id="1571d-187">GDI Print Path</span></span>  
 <span data-ttu-id="1571d-188">Embora [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aplicativos ofereçam suporte nativo ao caminho de impressão XPS, os aplicativos [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e Windows Forms também podem aproveitar alguns recursos do XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-188">While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the XPS print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="1571d-189">O driver de impressora XPS (XPSDrv) pode converter a saída baseada em GDI para o formato XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="1571d-190">Para cenários avançados, há suporte para a conversão personalizada de conteúdo usando o [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span><span class="sxs-lookup"><span data-stu-id="1571d-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="1571d-191">Da mesma forma, os aplicativos [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] também podem gerar saída para o caminho de impressão GDI chamando um dos métodos <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> ou <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> da classe <xref:System.Windows.Xps.XpsDocumentWriter> e designando uma impressora não XpsDrv como a fila de impressão de destino.</span><span class="sxs-lookup"><span data-stu-id="1571d-191">Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="1571d-192">Para aplicativos que não exigem suporte ou funcionalidade XPS, o caminho de impressão GDI atual permanece inalterado.</span><span class="sxs-lookup"><span data-stu-id="1571d-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="1571d-193">Para obter material de referência adicional sobre o caminho de impressão GDI e as várias opções de conversão de XPS, consulte [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) e [drivers de impressora XPSDrv](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="1571d-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="1571d-194">Modelo de driver XPSDrv</span><span class="sxs-lookup"><span data-stu-id="1571d-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="1571d-195">O caminho de impressão XPS melhora a eficiência do spooler usando XPS como o formato de spool de impressão nativo ao imprimir em uma impressora ou driver habilitado para XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="1571d-196">O processo de spool simplificado elimina a necessidade de gerar um arquivo de spool intermediário, como um arquivo de dados EMF, antes de o documento ser colocado em spool.</span><span class="sxs-lookup"><span data-stu-id="1571d-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="1571d-197">Por meio de tamanhos de arquivo de spool menores, o caminho de impressão XPS pode reduzir o tráfego de rede e melhorar o desempenho de impressão.</span><span class="sxs-lookup"><span data-stu-id="1571d-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="1571d-198">EMF é um formato fechado que representa a saída do aplicativo como uma série de chamadas em GDI para serviços de renderização.</span><span class="sxs-lookup"><span data-stu-id="1571d-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="1571d-199">Diferentemente do EMF, o formato de spool XPS representa o documento real sem a necessidade de mais interpretação quando a saída para um driver de impressora baseado em XPS (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="1571d-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="1571d-200">Os drivers podem operar diretamente nos dados no formato.</span><span class="sxs-lookup"><span data-stu-id="1571d-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="1571d-201">Esse recurso elimina as conversões de dados e de espaço de cores necessárias ao usar arquivos EMF e drivers de impressão baseados em GDI.</span><span class="sxs-lookup"><span data-stu-id="1571d-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="1571d-202">Os tamanhos de arquivo de spool geralmente são reduzidos quando você usa documentos XPS destinados a um driver de impressora XPS (XPSDrv) em comparação com seus equivalentes EMF; no entanto, há exceções:</span><span class="sxs-lookup"><span data-stu-id="1571d-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="1571d-203">Um gráfico vetorial que é muito complexo, multi-camadas ou que foi escrito de forma ineficiente, pode ser maior que uma versão em bitmap do mesmo elemento gráfico.</span><span class="sxs-lookup"><span data-stu-id="1571d-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="1571d-204">Para fins de exibição em tela, os arquivos XPS inserem fontes de dispositivo, bem como fontes baseadas em computador, enquanto que arquivos de spool GDI não inserem fontes de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="1571d-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="1571d-205">Mas os dois tipos de fontes são subdivididas (veja abaixo) e os drivers de impressora podem remover as fontes de dispositivo antes de transmitir o arquivo para a impressora.</span><span class="sxs-lookup"><span data-stu-id="1571d-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="1571d-206">A redução de tamanho do spool é executada através de vários mecanismos:</span><span class="sxs-lookup"><span data-stu-id="1571d-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="1571d-207">**Subdivisão de fonte**.</span><span class="sxs-lookup"><span data-stu-id="1571d-207">**Font subsetting**.</span></span> <span data-ttu-id="1571d-208">Somente os caracteres usados no documento real são armazenados no arquivo XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="1571d-209">**Suporte avançado a elementos gráficos**.</span><span class="sxs-lookup"><span data-stu-id="1571d-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="1571d-210">O suporte nativo para primitivas de transparência e gradiente evita a rasterização do conteúdo no documento XPS.</span><span class="sxs-lookup"><span data-stu-id="1571d-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="1571d-211">**Identificação de recursos comuns**.</span><span class="sxs-lookup"><span data-stu-id="1571d-211">**Identification of common resources**.</span></span> <span data-ttu-id="1571d-212">Os recursos que são usados várias vezes (como uma imagem que representa um logotipo corporativo) são tratados como recursos compartilhados e são carregados apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="1571d-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="1571d-213">**Compactação ZIP**.</span><span class="sxs-lookup"><span data-stu-id="1571d-213">**ZIP compression**.</span></span> <span data-ttu-id="1571d-214">Todos os documentos XPS usam compactação ZIP.</span><span class="sxs-lookup"><span data-stu-id="1571d-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1571d-215">Consulte também</span><span class="sxs-lookup"><span data-stu-id="1571d-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="1571d-216">Tópicos explicativos</span><span class="sxs-lookup"><span data-stu-id="1571d-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="1571d-217">Documentos no WPF</span><span class="sxs-lookup"><span data-stu-id="1571d-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="1571d-218">Documentos XPS</span><span class="sxs-lookup"><span data-stu-id="1571d-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="1571d-219">Serialização e armazenamento de documentos</span><span class="sxs-lookup"><span data-stu-id="1571d-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="1571d-220">Conversor de documento XPS da Microsoft (MXDC)</span><span class="sxs-lookup"><span data-stu-id="1571d-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
