---
title: 'Como: Descobrir se um trabalho de impressão pode ser impresso a esta hora do dia'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: 859dc75169e443d07361951692a428507886fa2e
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/22/2019
ms.locfileid: "69947805"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="d0ee8-102">Como: Descobrir se um trabalho de impressão pode ser impresso a esta hora do dia</span><span class="sxs-lookup"><span data-stu-id="d0ee8-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="d0ee8-103">Filas de impressão não estão sempre disponíveis 24 horas por dia.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="d0ee8-104">Eles têm propriedades de tempo de início e término que podem ser definidas para torná-las indisponíveis em determinados momentos do dia.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="d0ee8-105">Esse recurso pode ser usado, por exemplo, para reservar uma impressora para uso exclusivo de um determinado departamento após as 17h.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="d0ee8-106">Esse departamento teria uma fila diferente na impressora do que a que outros departamentos usam.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="d0ee8-107">A fila para os outros departamentos seria definida como indisponível após as 17h, enquanto a fila para o departamento favorecido poderia ser definida para estar sempre disponível.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="d0ee8-108">Além disso, os próprios trabalhos de impressão podem ser definidos para serem impressos apenas dentro de um período especificado.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="d0ee8-109">As <xref:System.Printing.PrintQueue> classes <xref:System.Printing.PrintSystemJobInfo> e expostas nas APIs do Microsoft .NET Framework fornecem um meio para verificar remotamente se um determinado trabalho de impressão pode imprimir em uma determinada fila na hora atual.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the APIs of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="d0ee8-110">Exemplo</span><span class="sxs-lookup"><span data-stu-id="d0ee8-110">Example</span></span>  
 <span data-ttu-id="d0ee8-111">O exemplo a seguir é um exemplo que pode diagnosticar problemas com um trabalho de impressão.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="d0ee8-112">Há duas etapas principais para esse tipo de função, da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-112">There are two major steps for this kind of function as follows.</span></span>  
  
1. <span data-ttu-id="d0ee8-113">Leia as <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> propriedades <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> e de <xref:System.Printing.PrintQueue> para determinar se a hora atual está entre elas.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2. <span data-ttu-id="d0ee8-114">Leia as <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> propriedades <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> e de <xref:System.Printing.PrintSystemJobInfo> para determinar se a hora atual está entre elas.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="d0ee8-115">Mas complicações surgem do fato de que essas propriedades não <xref:System.DateTime> são objetos.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="d0ee8-116">Em vez disso <xref:System.Int32> , eles são objetos que expressam a hora do dia como o número de minutos desde a meia-noite.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="d0ee8-117">Além disso, não se trata de meia-noite no fuso horário atual, mas meia-noite no UTC (Tempo Universal Coordenado).</span><span class="sxs-lookup"><span data-stu-id="d0ee8-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="d0ee8-118">O primeiro exemplo de código apresenta o método estático **ReportQueueAndJobAvailability**, que é passado <xref:System.Printing.PrintSystemJobInfo> a e chama métodos auxiliares para determinar se o trabalho pode ser impresso na hora atual e, se não, quando ele pode ser impresso.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="d0ee8-119">Observe que um <xref:System.Printing.PrintQueue> não é passado para o método.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="d0ee8-120">Isso ocorre porque o <xref:System.Printing.PrintSystemJobInfo> inclui uma referência à fila em sua <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="d0ee8-121">Os métodos subordinados incluem o método **ReportAvailabilityAtThisTime** sobrecarregado que pode usar um <xref:System.Printing.PrintQueue> ou um <xref:System.Printing.PrintSystemJobInfo> parâmetro.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="d0ee8-122">Também há um **TimeConverter.ConvertToLocalHumanReadableTime**.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="d0ee8-123">Todos esses métodos são discutidos abaixo.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="d0ee8-124">O método **ReportQueueAndJobAvailability** começa verificando se a fila ou o trabalho de impressão está indisponível no momento.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="d0ee8-125">Se um deles estiver indisponível, ele verificará se a fila está indisponível.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="d0ee8-126">Se ela não estiver disponível, o método relatará esse fato e a hora em que a fila estará disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="d0ee8-127">Em seguida, ele verifica o trabalho e, se ele estiver indisponível, relatará o próximo intervalo em que ela pode ser impressa.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="d0ee8-128">Por fim, o método relata o horário mais próximo em que o trabalho pode ser impresso.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="d0ee8-129">Ele é o segundo dos dois horários a seguir.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-129">This is the later of following two times.</span></span>  
  
- <span data-ttu-id="d0ee8-130">A hora em que a fila de impressão ficará disponível.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-130">The time when the print queue is next available.</span></span>  
  
- <span data-ttu-id="d0ee8-131">A hora em que o trabalho de impressão ficará disponível.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="d0ee8-132">Ao relatar horas do dia, o <xref:System.DateTime.ToShortTimeString%2A> método também é chamado porque esse método suprime os anos, os meses e os dias da saída.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="d0ee8-133">Você não pode restringir a disponibilidade de uma fila de impressão ou de um trabalho de impressão para dias, meses ou anos específicos.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="d0ee8-134">As duas sobrecargas do método **ReportAvailabilityAtThisTime** são idênticas, exceto pelo tipo passado para elas, de modo que <xref:System.Printing.PrintQueue> apenas a versão seja apresentada abaixo.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="d0ee8-135">O fato de que os métodos são idênticos exceto pelo tipo levanta a questão de por que o exemplo não cria um método genérico **ReportAvailabilityAtThisTime\<T>** .</span><span class="sxs-lookup"><span data-stu-id="d0ee8-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="d0ee8-136">O motivo é que tal método teria que ser restrito a uma classe que tem as propriedades **StartTimeOfDay** e **UntilTimeOfDay** que o método chama, mas um método genérico só pode ser restrito a uma única classe e à única classe comum para ambos e na árvore de herança é <xref:System.Printing.PrintSystemObject> que não tem essas propriedades. <xref:System.Printing.PrintSystemJobInfo> <xref:System.Printing.PrintQueue></span><span class="sxs-lookup"><span data-stu-id="d0ee8-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="d0ee8-137">O método **ReportAvailabilityAtThisTime** (apresentado no exemplo de código abaixo) começa inicializando uma <xref:System.Boolean> variável Sentinel para `true`.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="d0ee8-138">Ele será redefinido para `false` se a fila não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="d0ee8-139">Em seguida, o método verifica se as horas de início e "até" são idênticas.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="d0ee8-140">Se forem, a fila sempre estará disponível, então o método retornará `true`.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="d0ee8-141">Se a fila não estiver disponível o tempo todo, o método usará a <xref:System.DateTime.UtcNow%2A> propriedade estática para obter a hora atual como <xref:System.DateTime> um objeto.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="d0ee8-142">(Não precisamos do horário local porque as <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> Propriedades e <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> estão em hora UTC.)</span><span class="sxs-lookup"><span data-stu-id="d0ee8-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="d0ee8-143">No entanto, essas duas propriedades <xref:System.DateTime> não são objetos.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="d0ee8-144">Eles estão <xref:System.Int32>expressando o tempo como o número de minutos após-UTC-meia-noite.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="d0ee8-145">Então, precisamos converter nosso <xref:System.DateTime> objeto em minutos após a meia-noite.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="d0ee8-146">Quando isso é feito, o método simplesmente verifica se "agora" está entre as horas de início da fila e "até", define a sentinela como falsa caso "agora" não esteja entre as duas horas e retorna a sentinela.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="d0ee8-147">O método **TimeConverter. ConvertToLocalHumanReadableTime** (apresentado no exemplo de código abaixo) não usa nenhum método introduzido com Microsoft .NET Framework, portanto, a discussão é breve.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="d0ee8-148">O método tem uma tarefa de conversão dupla: ele deve receber um inteiro expressando minutos após a meia-noite e convertê-lo em um horário legível, e precisa convertê-lo no horário local.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="d0ee8-149">Ele realiza isso primeiro criando um <xref:System.DateTime> objeto que é definido como meia-noite UTC e, em seguida, usa o <xref:System.DateTime.AddMinutes%2A> método para adicionar os minutos que foram passados para o método.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="d0ee8-150">Isso retorna uma nova <xref:System.DateTime> expressar a hora original que foi passada para o método.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="d0ee8-151">Em <xref:System.DateTime.ToLocalTime%2A> seguida, o método o converte para a hora local.</span><span class="sxs-lookup"><span data-stu-id="d0ee8-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="d0ee8-152">Consulte também</span><span class="sxs-lookup"><span data-stu-id="d0ee8-152">See also</span></span>

- <xref:System.DateTime>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="d0ee8-153">Documentos no WPF</span><span class="sxs-lookup"><span data-stu-id="d0ee8-153">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="d0ee8-154">Visão Geral da Impressão</span><span class="sxs-lookup"><span data-stu-id="d0ee8-154">Printing Overview</span></span>](printing-overview.md)
