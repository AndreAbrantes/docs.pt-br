---
title: Níveis de confiança de segurança ao acessar recursos
description: Entenda os níveis de confiança de segurança para acessar recursos no .NET. Há três níveis principais de confiança para System. Transactions.
ms.date: 03/30/2017
ms.assetid: fb5be924-317d-4d69-b33a-3d18ecfb9d6e
ms.openlocfilehash: 64f298460bde99181ab8dc8be13ae95aaa846299
ms.sourcegitcommit: 6219b1e1feccb16d88656444210fed3297f5611e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/22/2020
ms.locfileid: "85141946"
---
# <a name="security-trust-levels-in-accessing-resources"></a><span data-ttu-id="52d6b-104">Níveis de confiança de segurança ao acessar recursos</span><span class="sxs-lookup"><span data-stu-id="52d6b-104">Security Trust Levels in Accessing Resources</span></span>
<span data-ttu-id="52d6b-105">Este tópico discute como o acesso está restrito a tipos de recursos que <xref:System.Transactions> expõe.</span><span class="sxs-lookup"><span data-stu-id="52d6b-105">This topic discusses how access is restricted on the types of resources that <xref:System.Transactions> exposes.</span></span>  
  
 <span data-ttu-id="52d6b-106">Há três principais níveis de confiança para <xref:System.Transactions>.</span><span class="sxs-lookup"><span data-stu-id="52d6b-106">There are three main levels of trust for <xref:System.Transactions>.</span></span> <span data-ttu-id="52d6b-107">Os níveis de confiança são definidos com base nos tipos de recursos que <xref:System.Transactions> expõe e o nível de confiança deve ser necessária para acessar esses recursos.</span><span class="sxs-lookup"><span data-stu-id="52d6b-107">The trust levels are defined based on the types of resources that <xref:System.Transactions> exposes, and the level of trust that should be required to access those resources.</span></span> <span data-ttu-id="52d6b-108">Os recursos que <xref:System.Transactions> fornece acesso a são recursos ampla do sistema, recursos ampla do processo compartilhado e memória do sistema.</span><span class="sxs-lookup"><span data-stu-id="52d6b-108">The resources that <xref:System.Transactions> provides access to are system memory, shared process wide resources, and system wide resources.</span></span> <span data-ttu-id="52d6b-109">Os níveis são:</span><span class="sxs-lookup"><span data-stu-id="52d6b-109">The levels are:</span></span>  
  
- <span data-ttu-id="52d6b-110">**AllowPartiallyTrustedCallers** (APTCA) para aplicativos que usam transações em um único domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="52d6b-110">**AllowPartiallyTrustedCallers** (APTCA) for applications using transactions within a single application domain.</span></span>  
  
- <span data-ttu-id="52d6b-111">**DistributedTransactionPermission** (DTP) para aplicativos que usam transações distribuídas.</span><span class="sxs-lookup"><span data-stu-id="52d6b-111">**DistributedTransactionPermission** (DTP) for applications using distributed transactions.</span></span>  
  
- <span data-ttu-id="52d6b-112">Confiança total para recursos duráveis, aplicativos de gerenciamento de configuração e os aplicativos herdados de interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="52d6b-112">Full trust for durable resources, configuration management applications, and legacy interop applications.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="52d6b-113">Você não deve chamar qualquer uma das interfaces de inscrição com contextos representados.</span><span class="sxs-lookup"><span data-stu-id="52d6b-113">You should not call any of the enlistment interfaces with impersonated contexts.</span></span>  
  
## <a name="trust-levels"></a><span data-ttu-id="52d6b-114">Níveis de confiança</span><span class="sxs-lookup"><span data-stu-id="52d6b-114">Trust Levels</span></span>  
  
### <a name="aptca-partial-trust"></a><span data-ttu-id="52d6b-115">APTCA (confiança parcial)</span><span class="sxs-lookup"><span data-stu-id="52d6b-115">APTCA (Partial Trust)</span></span>  
 <span data-ttu-id="52d6b-116">O <xref:System.Transactions> assembly pode ser chamado por código parcialmente confiável porque foi marcado com o atributo **ALLOWPARTIALLYTRUSTEDCALLERS** (APTCA).</span><span class="sxs-lookup"><span data-stu-id="52d6b-116">The <xref:System.Transactions> assembly can be called by partially trusted code because it has been marked with the **AllowPartiallyTrustedCallers** attribute (APTCA).</span></span> <span data-ttu-id="52d6b-117">Esse atributo basicamente remove o implícito <xref:System.Security.Permissions.SecurityAction.LinkDemand> para o conjunto de permissões **FullTrust** que, de outra forma, é colocado automaticamente em cada método acessível publicamente em cada tipo.</span><span class="sxs-lookup"><span data-stu-id="52d6b-117">This attribute essentially removes the implicit <xref:System.Security.Permissions.SecurityAction.LinkDemand> for the **FullTrust** permission set that is otherwise automatically placed on each publicly accessible method in each type.</span></span> <span data-ttu-id="52d6b-118">No entanto, alguns tipos e membros ainda requerem permissões mais fortes.</span><span class="sxs-lookup"><span data-stu-id="52d6b-118">However, some types and members still require stronger permissions.</span></span>  
  
 <span data-ttu-id="52d6b-119">O atributo APTCA permite que aplicativos usem as transações em confiança parcial em um único domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="52d6b-119">The APTCA attribute enables applications to use transactions in partial trust within a single application domain.</span></span> <span data-ttu-id="52d6b-120">Isso permite que as transações não escalonados e inscrições voláteis que podem ser usadas para tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="52d6b-120">This enables non-escalated transactions and volatile enlistments that can be used for error handling.</span></span> <span data-ttu-id="52d6b-121">Um exemplo disso é uma tabela de hash transacionado e um aplicativo que utiliza.</span><span class="sxs-lookup"><span data-stu-id="52d6b-121">One example of this is a transacted hash table and an application that uses it.</span></span> <span data-ttu-id="52d6b-122">Dados podem ser adicionados ao e removidos da tabela de hash em uma única transação.</span><span class="sxs-lookup"><span data-stu-id="52d6b-122">Data can be added to and removed from the hash table under a single transaction.</span></span> <span data-ttu-id="52d6b-123">Se a transação é posteriormente revertida, todas as alterações feitas na tabela de hash em transação podem ser desfeitas.</span><span class="sxs-lookup"><span data-stu-id="52d6b-123">If the transaction is later rolled back, all of the changes made to the hash table under that transaction can be undone.</span></span>  
  
### <a name="distributedtransactionpermission-dtp"></a><span data-ttu-id="52d6b-124">DistributedTransactionPermission (DTP)</span><span class="sxs-lookup"><span data-stu-id="52d6b-124">DistributedTransactionPermission (DTP)</span></span>  
 <span data-ttu-id="52d6b-125">Quando um <xref:System.Transactions> transação será escalada para ser gerenciado pelo MSDTC, <xref:System.Transactions> demandas de <xref:System.Transactions.DistributedTransactionPermission> (DTP) para criar a transação distribuída.</span><span class="sxs-lookup"><span data-stu-id="52d6b-125">When a <xref:System.Transactions> transaction is escalated to be managed by MSDTC, <xref:System.Transactions> demands the <xref:System.Transactions.DistributedTransactionPermission> (DTP) to create the distributed transaction.</span></span> <span data-ttu-id="52d6b-126">Isso significa que o código que faz com que a transação ser escalados (como por meio de serialização ou mais inscrições duráveis) precisa ser concedida DTP.</span><span class="sxs-lookup"><span data-stu-id="52d6b-126">This means that the code that causes the transaction to be escalated (such as through serialization or additional durable enlistments) would need to be granted DTP.</span></span> <span data-ttu-id="52d6b-127">O código que criou o <xref:System.Transactions> transação não necessariamente precisa ter essa permissão.</span><span class="sxs-lookup"><span data-stu-id="52d6b-127">The code that originally created the <xref:System.Transactions> transaction does not necessarily need to possess this permission.</span></span>  
  
### <a name="fulltrust-link-demands"></a><span data-ttu-id="52d6b-128">Demandas de Link FullTrust</span><span class="sxs-lookup"><span data-stu-id="52d6b-128">FullTrust Link Demands</span></span>  
 <span data-ttu-id="52d6b-129">Esse nível de permissão destina-se para restringir os aplicativos que gravam dados Recursos duráveis.</span><span class="sxs-lookup"><span data-stu-id="52d6b-129">This permission level is intended to restrict applications that are writing to durable resources.</span></span> <span data-ttu-id="52d6b-130">Em caso de falha, o aplicativo precisa ser capaz de recuperar-se com o Gerenciador de transações para determinar o resultado final da transação, para que ele possa atualizar dados permanente.</span><span class="sxs-lookup"><span data-stu-id="52d6b-130">Upon failure, the application needs to be able to recover with the transaction manager to determine the final outcome of the transaction, so that it can update permanent data.</span></span> <span data-ttu-id="52d6b-131">Esse tipo de aplicativo é conhecido como um Gerenciador de fonte durável.</span><span class="sxs-lookup"><span data-stu-id="52d6b-131">This type of application is known as a durable source manager.</span></span> <span data-ttu-id="52d6b-132">Um exemplo clássico desse tipo de aplicativo é SQL.</span><span class="sxs-lookup"><span data-stu-id="52d6b-132">A classic example of this type of application is SQL.</span></span>  
  
 <span data-ttu-id="52d6b-133">Para habilitar a recuperação, esse tipo de aplicativo tem a capacidade de consumir permanentemente os recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="52d6b-133">To enable recovery, this type of application has the ability to permanently consume system resources.</span></span> <span data-ttu-id="52d6b-134">Isso ocorre porque o Gerenciador de transações recuperável deve se lembrar de transações que foram confirmadas até que ele possa confirmar que todos os gerenciadores de recursos duráveis que participam da transação tem recebido o resultado.</span><span class="sxs-lookup"><span data-stu-id="52d6b-134">This is because the recoverable transaction manager must remember transactions that have committed until it can confirm that all durable resource managers that are participating in the transaction have received the outcome.</span></span> <span data-ttu-id="52d6b-135">Portanto, esse tipo de aplicativo requer confiança total e não deve ser executado, a menos que nível de confiança recebeu.</span><span class="sxs-lookup"><span data-stu-id="52d6b-135">Therefore, this type of application requires full trust and should not be run unless that level of trust has been granted.</span></span>  
  
 <span data-ttu-id="52d6b-136">Para obter mais informações sobre inlistagens duráveis e recuperação, consulte os tópicos [Inscrevendo recursos como participantes em uma transação](enlisting-resources-as-participants-in-a-transaction.md) e [executando a recuperação](performing-recovery.md) .</span><span class="sxs-lookup"><span data-stu-id="52d6b-136">For more information on durable enlistments and recovery, see the [Enlisting Resources as Participants in a Transaction](enlisting-resources-as-participants-in-a-transaction.md) and [Performing Recovery](performing-recovery.md) topics.</span></span>  
  
 <span data-ttu-id="52d6b-137">Aplicativos que executam o trabalho com herdado interoperabilidade com COM+ também precisam ter confiança total.</span><span class="sxs-lookup"><span data-stu-id="52d6b-137">Applications that perform legacy interop work with COM+ are also required to have full trust.</span></span>  
  
 <span data-ttu-id="52d6b-138">Veja a seguir uma lista de tipos e membros que não podem ser chamados por código parcialmente confiável, pois eles são decorados com o atributo de segurança declarativa **FullTrust** :</span><span class="sxs-lookup"><span data-stu-id="52d6b-138">The following is a list of types and members that are not callable by partially trusted code because they are decorated with the **FullTrust** declarative security attribute:</span></span>  
  
 `PermissionSetAttribute(SecurityAction.LinkDemand, Name := "FullTrust")`  
  
- <xref:System.Transactions.Transaction.EnlistDurable%2A?displayProperty=nameWithType>  
  
- <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A>  
  
- <xref:System.Transactions.TransactionInterop>  
  
- <xref:System.Transactions.TransactionManager.DistributedTransactionStarted>  
  
- <xref:System.Transactions.HostCurrentTransactionCallback>  
  
- <xref:System.Transactions.TransactionManager.Reenlist%2A>  
  
- <xref:System.Transactions.TransactionManager.RecoveryComplete%2A>  
  
- <xref:System.Transactions.TransactionScope.%23ctor%28System.Transactions.TransactionScopeOption%2CSystem.Transactions.TransactionOptions%2CSystem.Transactions.EnterpriseServicesInteropOption%29>  
  
 <span data-ttu-id="52d6b-139">Somente o chamador imediato precisa ter o conjunto de permissões **FullTrust** para usar os tipos ou métodos acima.</span><span class="sxs-lookup"><span data-stu-id="52d6b-139">Only the immediate caller is required to possess the **FullTrust** permission set to use the above types or methods.</span></span>
