---
title: OLE DB, ODBC e pool de conexões Oracle
ms.date: 03/30/2017
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
ms.openlocfilehash: b83b53550964b3149f3bc711eaf119e749d1834b
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/07/2019
ms.locfileid: "70794700"
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="1e657-102">OLE DB, ODBC e pool de conexões Oracle</span><span class="sxs-lookup"><span data-stu-id="1e657-102">OLE DB, ODBC, and Oracle Connection Pooling</span></span>
<span data-ttu-id="1e657-103">O pooling de conexões pode melhorar significativamente o desempenho e a escalabilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1e657-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="1e657-104">Esta seção discute o pooling de conexões para provedores de dados .NET Framework para OLE DB, ODBC e Oracle.</span><span class="sxs-lookup"><span data-stu-id="1e657-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC and Oracle.</span></span>  
  
## <a name="connection-pooling-for-oledb"></a><span data-ttu-id="1e657-105">Pooling de conexões para OleDb</span><span class="sxs-lookup"><span data-stu-id="1e657-105">Connection Pooling for OleDb</span></span>  
 <span data-ttu-id="1e657-106">O Provedor de Dados do .NET Framework para OLE DB agrupa automaticamente conexões usando o pooling de sessão do OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1e657-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="1e657-107">Argumentos de cadeia de conexão podem ser usados para habilitar ou desabilitar os serviços do OLE DB que incluem pooling.</span><span class="sxs-lookup"><span data-stu-id="1e657-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="1e657-108">Por exemplo, a cadeia de conexão a seguir desabilita o pooling de sessão do OLE DB e a inscrição automática de transação.</span><span class="sxs-lookup"><span data-stu-id="1e657-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>  
  
```  
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;  
```  
  
 <span data-ttu-id="1e657-109">É recomendável sempre fechar ou encerrar uma conexão quando você terminar de usá-la para retornar a conexão ao pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="1e657-110">As conexões que não são fechadas explicitamente não podem ser retornadas ao pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="1e657-111">Por exemplo, uma conexão que sai de escopo, mas que não foi fechada explicitamente será retornada somente para o pool de conexões se o tamanho do máximo tiver sido atingido e a conexão ainda estiver válida.</span><span class="sxs-lookup"><span data-stu-id="1e657-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>  
  
 <span data-ttu-id="1e657-112">Para obter mais informações sobre OLE DB pooling de sessão ou de recursos, além de como desabilitar o pooling substituindo os padrões de serviço do provedor de OLE DB, consulte o [Guia do programador do OLE DB](https://go.microsoft.com/fwlink/?linkid=45232).</span><span class="sxs-lookup"><span data-stu-id="1e657-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](https://go.microsoft.com/fwlink/?linkid=45232).</span></span>  
  
## <a name="connection-pooling-for-odbc"></a><span data-ttu-id="1e657-113">Pooling de conexões para Odbc</span><span class="sxs-lookup"><span data-stu-id="1e657-113">Connection Pooling for Odbc</span></span>  
 <span data-ttu-id="1e657-114">O pooling de conexões para o provedor de dados .NET Framework para ODBC é gerenciado pelo ODBC Driver Manager que é usado para a conexão, e não é afetado pelo provedor de dados .NET Framework para ODBC.</span><span class="sxs-lookup"><span data-stu-id="1e657-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>  
  
 <span data-ttu-id="1e657-115">Para habilitar ou desabilitar o pool de conexões, abra o **administrador de fonte de dados ODBC** na pasta Ferramentas administrativas do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="1e657-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="1e657-116">A guia **pooling de conexão** permite especificar parâmetros de pool de conexões para cada driver ODBC instalado.</span><span class="sxs-lookup"><span data-stu-id="1e657-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="1e657-117">Observe que as alterações do pooling de conexões para um driver ODBC específico afetam todos os aplicativos que usam o driver ODBC.</span><span class="sxs-lookup"><span data-stu-id="1e657-117">Note that connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>  
  
## <a name="connection-pooling-for-oracleclient"></a><span data-ttu-id="1e657-118">Pooling de conexões para OracleClient</span><span class="sxs-lookup"><span data-stu-id="1e657-118">Connection Pooling for OracleClient</span></span>  
 <span data-ttu-id="1e657-119">O provedor de dados .NET Framework para Oracle fornece o pooling de conexões automaticamente para o aplicativo cliente do ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="1e657-119">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="1e657-120">Você também pode fornecer vários modificadores de cadeia de conexão para controlar o comportamento do pooling de conexões (consulte "Controlando o pooling de conexões com palavras-chave de cadeia de conexão", posteriormente neste tópico).</span><span class="sxs-lookup"><span data-stu-id="1e657-120">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>  
  
### <a name="pool-creation-and-assignment"></a><span data-ttu-id="1e657-121">Criação e atribuição de pools</span><span class="sxs-lookup"><span data-stu-id="1e657-121">Pool Creation and Assignment</span></span>  
 <span data-ttu-id="1e657-122">Quando uma conexão é aberta, um pool de conexões é criado com base em um algoritmo compatível exato que associa o pool à cadeia de conexão na conexão.</span><span class="sxs-lookup"><span data-stu-id="1e657-122">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="1e657-123">Cada pool de conexões é associado a uma cadeia de conexão distinta.</span><span class="sxs-lookup"><span data-stu-id="1e657-123">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="1e657-124">Se a cadeia de conexão não for uma correspondência exata de um pool existente, quando uma nova conexão for aberta, um novo pool será criado.</span><span class="sxs-lookup"><span data-stu-id="1e657-124">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>  
  
 <span data-ttu-id="1e657-125">Quando são criados, os pools de conexão não são destruídos até que o processo ativo termine.</span><span class="sxs-lookup"><span data-stu-id="1e657-125">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="1e657-126">Manter pools inativos ou vazios usa muito poucos recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="1e657-126">Maintaining inactive or empty pools uses very few system resources.</span></span>  
  
### <a name="connection-addition"></a><span data-ttu-id="1e657-127">Adição de conexão</span><span class="sxs-lookup"><span data-stu-id="1e657-127">Connection Addition</span></span>  
 <span data-ttu-id="1e657-128">Um pool de conexões é criado para cada cadeia de conexão exclusiva.</span><span class="sxs-lookup"><span data-stu-id="1e657-128">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="1e657-129">Quando um pool é criado, vários objetos de conexão são criados e adicionados ao pool para que o requisito de tamanho mínimo de pool seja atendido.</span><span class="sxs-lookup"><span data-stu-id="1e657-129">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="1e657-130">As conexões são adicionadas ao pool quando necessário, até o tamanho máximo de pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-130">Connections are added to the pool as needed, up to the maximum pool size.</span></span>  
  
 <span data-ttu-id="1e657-131">Quando um objeto <xref:System.Data.OracleClient.OracleConnection> é solicitado, ele é obtido do pool caso haja uma conexão útil disponível.</span><span class="sxs-lookup"><span data-stu-id="1e657-131">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="1e657-132">Para ser útil, a conexão não deve estar em uso no momento, deve ter um contexto de transação correspondente (ou não deve estar associada a nenhum contexto de transação) e deve ter um vínculo válido com o servidor.</span><span class="sxs-lookup"><span data-stu-id="1e657-132">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>  
  
 <span data-ttu-id="1e657-133">Se o tamanho máximo de pool for atingido e nenhuma conexão útil estiver disponível, a solicitação será colocada na fila.</span><span class="sxs-lookup"><span data-stu-id="1e657-133">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="1e657-134">O pool de conexões atende a essas solicitações realocando-as à medida que são retornadas ao pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-134">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="1e657-135">As conexões são retornadas para o pool quando fechadas ou descartadas.</span><span class="sxs-lookup"><span data-stu-id="1e657-135">Connections are released back into the pool when they are closed or disposed.</span></span>  
  
### <a name="connection-removal"></a><span data-ttu-id="1e657-136">Remoção de conexão</span><span class="sxs-lookup"><span data-stu-id="1e657-136">Connection Removal</span></span>  
 <span data-ttu-id="1e657-137">O pooler de conexões remove uma conexão do pool depois que ela estiver ociosa por um período de tempo estendido ou caso detecte que a conexão com o servidor foi interrompida.</span><span class="sxs-lookup"><span data-stu-id="1e657-137">The connection pooler removes a connection from the pool after it has been idle for an extended period of time, or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="1e657-138">Observe que isso pode ser detectado somente após uma tentativa de comunicação com o servidor.</span><span class="sxs-lookup"><span data-stu-id="1e657-138">Note that this can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="1e657-139">Se for encontrada uma conexão que não esteja mais conectada ao servidor, ela será marcada como inválida.</span><span class="sxs-lookup"><span data-stu-id="1e657-139">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="1e657-140">O pooler de conexão verifica periodicamente os pools de conexão que procuram os objetos que foram lançados para o pool e que estão marcados como inválidos.</span><span class="sxs-lookup"><span data-stu-id="1e657-140">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="1e657-141">Essas conexões são então removidas permanentemente.</span><span class="sxs-lookup"><span data-stu-id="1e657-141">These connections are then permanently removed.</span></span>  
  
 <span data-ttu-id="1e657-142">Se uma conexão com um servidor desapareceu, ela pode ser removida do pool se o pooler de conexões não tiver detectado a conexão interrompida e a marcado como inválida.</span><span class="sxs-lookup"><span data-stu-id="1e657-142">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="1e657-143">Quando isso ocorrer, uma exceção será gerada.</span><span class="sxs-lookup"><span data-stu-id="1e657-143">When this occurs, an exception is generated.</span></span> <span data-ttu-id="1e657-144">No entanto, você ainda deverá fechar a conexão para liberá-la de volta para o pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-144">However, you must still close the connection in order to release it back into the pool.</span></span>  
  
 <span data-ttu-id="1e657-145">Não chame `Close` nem `Dispose` em um objeto `Connection`, em um `DataReader` nem em nenhum outro objeto gerenciado no método `Finalize` de sua classe.</span><span class="sxs-lookup"><span data-stu-id="1e657-145">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="1e657-146">Em um finalizador, libere somente recursos não gerenciados que sua classe possui diretamente.</span><span class="sxs-lookup"><span data-stu-id="1e657-146">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="1e657-147">Se a classe não tiver nenhum recurso não gerenciado, não inclua um método `Finalize` em sua definição de classe.</span><span class="sxs-lookup"><span data-stu-id="1e657-147">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="1e657-148">Para obter mais informações, consulte [coleta de lixo](../../../standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="1e657-148">For more information, see [Garbage Collection](../../../standard/garbage-collection/index.md).</span></span>  
  
### <a name="transaction-support"></a><span data-ttu-id="1e657-149">Suporte a transações</span><span class="sxs-lookup"><span data-stu-id="1e657-149">Transaction Support</span></span>  
 <span data-ttu-id="1e657-150">As conexões são removidas do pool e atribuídas com base no contexto de transação.</span><span class="sxs-lookup"><span data-stu-id="1e657-150">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="1e657-151">O contexto do thread de solicitação e da conexão atribuída devem coincidir.</span><span class="sxs-lookup"><span data-stu-id="1e657-151">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="1e657-152">Portanto, cada pool de conexões é, na verdade, subdividido em conexões sem nenhum contexto de transação associado a eles e em *N* subdivisãos que contêm conexões com um contexto de transação específico.</span><span class="sxs-lookup"><span data-stu-id="1e657-152">Therefore, each connection pool is actually subdivided into connections with no transaction context associated with them, and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>  
  
 <span data-ttu-id="1e657-153">Quando uma conexão for fechada, ela será retornada ao pool e à subdivisão apropriada com base no contexto de transação.</span><span class="sxs-lookup"><span data-stu-id="1e657-153">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="1e657-154">Portanto, é possível fechar a conexão sem gerar erros, mesmo que uma transação distribuída ainda esteja pendente.</span><span class="sxs-lookup"><span data-stu-id="1e657-154">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="1e657-155">Isso permite confirmar ou anular a transação distribuída posteriormente.</span><span class="sxs-lookup"><span data-stu-id="1e657-155">This allows you to commit or abort the distributed transaction at a later time.</span></span>  
  
### <a name="controlling-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="1e657-156">Controlando o pool de conexões com palavras-chave de cadeias de conexão</span><span class="sxs-lookup"><span data-stu-id="1e657-156">Controlling Connection Pooling with Connection String Keywords</span></span>  
 <span data-ttu-id="1e657-157">A propriedade <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> do objeto <xref:System.Data.OracleClient.OracleConnection> dá suporte a pares chave-valor de cadeias de conexão que podem ser usados para ajustar o comportamento da lógica do pool de conexões.</span><span class="sxs-lookup"><span data-stu-id="1e657-157">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>  
  
 <span data-ttu-id="1e657-158">A tabela a seguir descreve os valores de <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> que você pode usar para ajustar o comportamento do pooling de conexões.</span><span class="sxs-lookup"><span data-stu-id="1e657-158">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>  
  
|<span data-ttu-id="1e657-159">Nome</span><span class="sxs-lookup"><span data-stu-id="1e657-159">Name</span></span>|<span data-ttu-id="1e657-160">Padrão</span><span class="sxs-lookup"><span data-stu-id="1e657-160">Default</span></span>|<span data-ttu-id="1e657-161">Descrição</span><span class="sxs-lookup"><span data-stu-id="1e657-161">Description</span></span>|  
|----------|-------------|-----------------|  
|`Connection Lifetime`|<span data-ttu-id="1e657-162">0</span><span class="sxs-lookup"><span data-stu-id="1e657-162">0</span></span>|<span data-ttu-id="1e657-163">Quando uma conexão é retornada para o pool, seu tempo de criação é comparado com a hora atual e a conexão será destruída se esse intervalo de tempo (em segundos) exceder o valor especificado por `Connection Lifetime`.</span><span class="sxs-lookup"><span data-stu-id="1e657-163">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="1e657-164">Isso é útil nas configurações clusterizadas para forçar o balanceamento de carga entre um servidor em execução e um servidor que acabou de ficar online.</span><span class="sxs-lookup"><span data-stu-id="1e657-164">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="1e657-165">Um valor de 0 (zero) fará as conexões com pool excederem o tempo limite máximo.</span><span class="sxs-lookup"><span data-stu-id="1e657-165">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|  
|`Enlist`|<span data-ttu-id="1e657-166">'true'</span><span class="sxs-lookup"><span data-stu-id="1e657-166">'true'</span></span>|<span data-ttu-id="1e657-167">Quando for `true`, o pooler automaticamente inserirá a conexão no contexto de transação atual do thread de criação se um contexto de transação existir.</span><span class="sxs-lookup"><span data-stu-id="1e657-167">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|  
|`Max Pool Size`|<span data-ttu-id="1e657-168">100</span><span class="sxs-lookup"><span data-stu-id="1e657-168">100</span></span>|<span data-ttu-id="1e657-169">O número máximo de conexões permitidas no pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-169">The maximum number of connections allowed in the pool.</span></span>|  
|`Min Pool Size`|<span data-ttu-id="1e657-170">0</span><span class="sxs-lookup"><span data-stu-id="1e657-170">0</span></span>|<span data-ttu-id="1e657-171">O número mínimo de conexões mantidas no pool.</span><span class="sxs-lookup"><span data-stu-id="1e657-171">The minimum number of connections maintained in the pool.</span></span>|  
|`Pooling`|<span data-ttu-id="1e657-172">'true'</span><span class="sxs-lookup"><span data-stu-id="1e657-172">'true'</span></span>|<span data-ttu-id="1e657-173">Quando for `true`, o objeto de conexão será obtido do pool apropriado ou, se necessário, será criado e adicionado ao pool apropriado.</span><span class="sxs-lookup"><span data-stu-id="1e657-173">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="1e657-174">Consulte também</span><span class="sxs-lookup"><span data-stu-id="1e657-174">See also</span></span>

- [<span data-ttu-id="1e657-175">Pooling de Conexão</span><span class="sxs-lookup"><span data-stu-id="1e657-175">Connection Pooling</span></span>](connection-pooling.md)
- [<span data-ttu-id="1e657-176">Contadores de desempenho</span><span class="sxs-lookup"><span data-stu-id="1e657-176">Performance Counters</span></span>](performance-counters.md)
- <span data-ttu-id="1e657-177">[ADO.NET Overview](ado-net-overview.md) (Visão geral do ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="1e657-177">[ADO.NET Overview](ado-net-overview.md)</span></span>
