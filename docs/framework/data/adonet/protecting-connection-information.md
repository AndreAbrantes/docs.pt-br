---
title: Protegendo informações de conexão
description: Saiba mais sobre vulnerabilidades de segurança em cadeias de conexão, que podem surgir devido à forma como as cadeias de conexão são construídas e persistentes e o tipo de autenticação.
ms.date: 03/30/2017
ms.assetid: 1471f580-bcd4-4046-bdaf-d2541ecda2f4
ms.openlocfilehash: 0e693fd99384a2808a621b358f8e70c6777c3930
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/02/2020
ms.locfileid: "84286644"
---
# <a name="protecting-connection-information"></a><span data-ttu-id="61991-103">Protegendo informações de conexão</span><span class="sxs-lookup"><span data-stu-id="61991-103">Protecting Connection Information</span></span>
<span data-ttu-id="61991-104">A proteção do acesso à fonte de dados é essencial para a segurança do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="61991-104">Protecting access to your data source is one of the most important goals when securing an application.</span></span> <span data-ttu-id="61991-105">Uma cadeia de conexão apresenta uma vulnerabilidade potencial se não estiver protegida.</span><span class="sxs-lookup"><span data-stu-id="61991-105">A connection string presents a potential vulnerability if it is not secured.</span></span> <span data-ttu-id="61991-106">Armazenar as informações de conexão em texto sem formatação ou persistir-la na memória pode comprometer seu sistema inteiro.</span><span class="sxs-lookup"><span data-stu-id="61991-106">Storing connection information in plain text or persisting it in memory risks compromising your entire system.</span></span> <span data-ttu-id="61991-107">As cadeias de conexão inseridas em seu código-fonte podem ser lidas usando o [ILDASM. exe (desmontador de Il)](../../tools/ildasm-exe-il-disassembler.md) para exibir o MSIL (Microsoft intermediator Language) em um assembly compilado.</span><span class="sxs-lookup"><span data-stu-id="61991-107">Connection strings embedded in your source code can be read using the [Ildasm.exe (IL Disassembler)](../../tools/ildasm-exe-il-disassembler.md) to view Microsoft intermediate language (MSIL) in a compiled assembly.</span></span>  
  
 <span data-ttu-id="61991-108">As vulnerabilidades de segurança envolvendo cadeias de conexão podem surgir com base no tipo de autenticação usado, em como as cadeias de conexão são persistidas na memória e no disco e nas técnicas usadas para construí-los em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="61991-108">Security vulnerabilities involving connection strings can arise based on the type of authentication used, how connection strings are persisted in memory and on disk, and the techniques used to construct them at run time.</span></span>  
  
## <a name="use-windows-authentication"></a><span data-ttu-id="61991-109">Usar Autenticação do Windows</span><span class="sxs-lookup"><span data-stu-id="61991-109">Use Windows Authentication</span></span>  
 <span data-ttu-id="61991-110">Para ajudar a limitar o acesso a sua fonte de dados, você deverá proteger as informações de conexão como a identificação do usuário, senha e nome da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="61991-110">To help limit access to your data source, you must secure connection information such as user ID, password, and data source name.</span></span> <span data-ttu-id="61991-111">Para evitar a exposição de informações do usuário, é recomendável usar a autenticação do Windows (às vezes conhecida como *segurança integrada*) sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="61991-111">In order to avoid exposing user information, we recommend using Windows authentication (sometimes referred to as *integrated security*) wherever possible.</span></span> <span data-ttu-id="61991-112">A autenticação do Windows é especificada em uma cadeia de conexão usando as palavras-chave `Integrated Security` ou `Trusted_Connection`, eliminando a necessidade de usar uma identificação de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="61991-112">Windows authentication is specified in a connection string by using the `Integrated Security` or `Trusted_Connection` keywords, eliminating the need to use a user ID and password.</span></span> <span data-ttu-id="61991-113">Ao usar a autenticação do Windows, os usuários são autenticados pelo Windows e o acesso ao servidor e os recursos de banco de dados são determinados concedendo permissões a usuários e grupos do Windows.</span><span class="sxs-lookup"><span data-stu-id="61991-113">When using Windows authentication, users are authenticated by Windows, and access to server and database resources is determined by granting permissions to Windows users and groups.</span></span>  
  
 <span data-ttu-id="61991-114">Para situações onde não é possível usar a autenticação do Windows, você deverá ter cuidado adicional porque as credenciais do usuário são expostas na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="61991-114">For situations where it is not possible to use Windows authentication, you must use extra care because user credentials are exposed in the connection string.</span></span> <span data-ttu-id="61991-115">Em um aplicativo do ASP.NET, você pode configurar uma conta do Windows como uma identidade fixa que é usada para se conectar a bancos de dados e outros recursos de rede.</span><span class="sxs-lookup"><span data-stu-id="61991-115">In an ASP.NET application, you can configure a Windows account as a fixed identity that is used to connect to databases and other network resources.</span></span> <span data-ttu-id="61991-116">Você habilita a representação no elemento Identity no arquivo **Web. config** e especifica um nome de usuário e uma senha.</span><span class="sxs-lookup"><span data-stu-id="61991-116">You enable impersonation in the identity element in the **web.config** file and specify a user name and password.</span></span>  
  
```xml  
<identity impersonate="true"
        userName="MyDomain\UserAccount"
        password="*****" />  
```  
  
 <span data-ttu-id="61991-117">A conta de identidade fixa deve ser uma conta de privilégios baixos que tem concedidas somente as permissões necessárias no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="61991-117">The fixed identity account should be a low-privilege account that has been granted only necessary permissions in the database.</span></span> <span data-ttu-id="61991-118">Além disso, você deve criptografar o arquivo de configuração de modo que o nome de usuário e a senha não sejam expostos em texto não criptografado.</span><span class="sxs-lookup"><span data-stu-id="61991-118">In addition, you should encrypt the configuration file so that the user name and password are not exposed in clear text.</span></span>  
  
## <a name="do-not-use-universal-data-link-udl-files"></a><span data-ttu-id="61991-119">Não use arquivos UDL (Universal Data Link)</span><span class="sxs-lookup"><span data-stu-id="61991-119">Do Not Use Universal Data Link (UDL) files</span></span>  
 <span data-ttu-id="61991-120">Evite armazenar cadeias de conexão para um <xref:System.Data.OleDb.OleDbConnection> em um arquivo UDL (Universal Data Link).</span><span class="sxs-lookup"><span data-stu-id="61991-120">Avoid storing connection strings for an <xref:System.Data.OleDb.OleDbConnection> in a Universal Data Link (UDL) file.</span></span> <span data-ttu-id="61991-121">UDLs são armazenados em texto não criptografado e não podem ser criptografados.</span><span class="sxs-lookup"><span data-stu-id="61991-121">UDLs are stored in clear text and cannot be encrypted.</span></span> <span data-ttu-id="61991-122">Um arquivo UDL é um recurso externo com base em arquivo para o seu aplicativo e ele não poderá ser protegido ou criptografado usando o .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="61991-122">A UDL file is an external file-based resource to your application, and it cannot be secured or encrypted using the .NET Framework.</span></span>  
  
## <a name="avoid-injection-attacks-with-connection-string-builders"></a><span data-ttu-id="61991-123">Evite ataques de injeção com construtores de cadeia de conexão</span><span class="sxs-lookup"><span data-stu-id="61991-123">Avoid Injection Attacks with Connection String Builders</span></span>  
 <span data-ttu-id="61991-124">Um ataque de injeção de cadeia de conexão pode ocorrer quando a concatenação dinâmica de cadeia de caracteres é usada para criar cadeias de conexão com base na entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="61991-124">A connection string injection attack can occur when dynamic string concatenation is used to build connection strings based on user input.</span></span> <span data-ttu-id="61991-125">Se a entrada do usuário não for validada e o texto mal-intencionado ou caracteres não forem escapados, um invasor poderá acessar dados confidenciais ou outros recursos no servidor.</span><span class="sxs-lookup"><span data-stu-id="61991-125">If the user input is not validated and malicious text or characters not escaped, an attacker can potentially access sensitive data or other resources on the server.</span></span> <span data-ttu-id="61991-126">Para resolver esse problema, o ADO.NET 2.0 introduziu novas classes de construtor de cadeia de conexão para validar a sintaxe da cadeia de conexão e garantir que os parâmetros adicionais não sejam introduzidos.</span><span class="sxs-lookup"><span data-stu-id="61991-126">To address this problem, ADO.NET 2.0 introduced new connection string builder classes to validate connection string syntax and ensure that additional parameters are not introduced.</span></span> <span data-ttu-id="61991-127">Para obter mais informações, confira [Construtores de cadeias de conexão](connection-string-builders.md).</span><span class="sxs-lookup"><span data-stu-id="61991-127">For more information, see [Connection String Builders](connection-string-builders.md).</span></span>  
  
## <a name="use-persist-security-infofalse"></a><span data-ttu-id="61991-128">Use segurança de persistência Info=False</span><span class="sxs-lookup"><span data-stu-id="61991-128">Use Persist Security Info=False</span></span>  
 <span data-ttu-id="61991-129">O valor padrão para `Persist Security Info` é falso; nós recomendamos usar esta opção em todas as cadeias de conexão.</span><span class="sxs-lookup"><span data-stu-id="61991-129">The default value for `Persist Security Info` is false; we recommend using this default in all connection strings.</span></span> <span data-ttu-id="61991-130">Configurar `Persist Security Info` como `true` ou `yes` permite informações confidenciais de segurança, incluindo a identificação de usuário e a senha, para serem obtidas de uma conexão depois que ela tiver sido aberta.</span><span class="sxs-lookup"><span data-stu-id="61991-130">Setting `Persist Security Info` to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from a connection after it has been opened.</span></span> <span data-ttu-id="61991-131">Quando `Persist Security Info` for definido como `false` ou `no`, as informações de segurança serão descartadas após serem usadas para abrir a conexão, garantindo que uma fonte não confiável não tenha acesso a informações confidenciais de segurança.</span><span class="sxs-lookup"><span data-stu-id="61991-131">When `Persist Security Info` is set to `false` or `no`, security information is discarded after it is used to open the connection, ensuring that an untrusted source does not have access to security-sensitive information.</span></span>  
  
## <a name="encrypt-configuration-files"></a><span data-ttu-id="61991-132">Criptografe arquivos de configuração</span><span class="sxs-lookup"><span data-stu-id="61991-132">Encrypt Configuration Files</span></span>  
 <span data-ttu-id="61991-133">Você também pode armazenar cadeias de conexão em arquivos de configuração, o que elimina a necessidade de inseri-las no código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="61991-133">You can also store connection strings in configuration files, which eliminates the need to embed them in your application's code.</span></span> <span data-ttu-id="61991-134">Os arquivos de configuração são arquivos XML padrão para os quais o .NET Framework definiu um conjunto comum de elementos.</span><span class="sxs-lookup"><span data-stu-id="61991-134">Configuration files are standard XML files for which the .NET Framework has defined a common set of elements.</span></span> <span data-ttu-id="61991-135">As cadeias de conexão em arquivos de configuração normalmente são armazenadas dentro do **\<connectionStrings>** elemento no **app. config** de um aplicativo do Windows ou no arquivo **Web. config** de um aplicativo ASP.net.</span><span class="sxs-lookup"><span data-stu-id="61991-135">Connection strings in configuration files are typically stored inside the **\<connectionStrings>** element in the **app.config** for a Windows application, or the **web.config** file for an ASP.NET application.</span></span> <span data-ttu-id="61991-136">Para obter mais informações sobre as noções básicas de armazenamento, recuperação e criptografia de cadeias de conexão de arquivos de configuração, consulte [cadeias de conexão e arquivos de configuração](connection-strings-and-configuration-files.md).</span><span class="sxs-lookup"><span data-stu-id="61991-136">For more information on the basics of storing, retrieving and encrypting connection strings from configuration files, see [Connection Strings and Configuration Files](connection-strings-and-configuration-files.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="61991-137">Veja também</span><span class="sxs-lookup"><span data-stu-id="61991-137">See also</span></span>

- [<span data-ttu-id="61991-138">Protegendo aplicativos ADO.NET</span><span class="sxs-lookup"><span data-stu-id="61991-138">Securing ADO.NET Applications</span></span>](securing-ado-net-applications.md)
- <span data-ttu-id="61991-139">[Criptografando informações de configuração usando a configuração protegida](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="61991-139">[Encrypting Configuration Information Using Protected Configuration](https://docs.microsoft.com/previous-versions/aspnet/53tyfkaw(v=vs.100))</span></span>
- [<span data-ttu-id="61991-140">Segurança no .NET</span><span class="sxs-lookup"><span data-stu-id="61991-140">Security in .NET</span></span>](../../../standard/security/index.md)
- [<span data-ttu-id="61991-141">Visão geral do ADO.NET</span><span class="sxs-lookup"><span data-stu-id="61991-141">ADO.NET Overview</span></span>](ado-net-overview.md)
