---
title: Consultas de tabela única (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 1f4462f617eb81d30f893b52bdc674e1eee8961c
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/03/2020
ms.locfileid: "75634762"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="1e10f-102">Consultas de tabela única (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="1e10f-102">Single-Table Queries (LINQ to DataSet)</span></span>
<span data-ttu-id="1e10f-103">As consultas de LINQ (consulta integrada à linguagem) funcionam em fontes de dados que implementam a interface <xref:System.Collections.Generic.IEnumerable%601> ou a interface <xref:System.Linq.IQueryable%601>.</span><span class="sxs-lookup"><span data-stu-id="1e10f-103">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="1e10f-104">A classe <xref:System.Data.DataTable> não implementa nenhuma interface, portanto, você deve chamar o método <xref:System.Data.DataTableExtensions.AsEnumerable%2A> se quiser usar o <xref:System.Data.DataTable> como uma origem na cláusula `From` de uma consulta LINQ.</span><span class="sxs-lookup"><span data-stu-id="1e10f-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="1e10f-105">O exemplo a seguir obtém todos os pedidos online da tabela SalesOrderHeader e gera a identificação do pedido, a data do pedido e o número de ordem para o console.</span><span class="sxs-lookup"><span data-stu-id="1e10f-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)] 
  
 <span data-ttu-id="1e10f-106">A consulta de variável local é inicializada com uma expressão de consulta, que opera em uma ou mais fontes de informações aplicando um ou mais operadores de consulta dos operadores de consulta padrão ou, no caso de LINQ to DataSet, operadores específicos para a classe <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="1e10f-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="1e10f-107">A expressão de consulta no exemplo anterior usa dois dos operadores de consulta padrão: `Where` e `Select`.</span><span class="sxs-lookup"><span data-stu-id="1e10f-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="1e10f-108">A cláusula `Where` filtra a sequência com base em uma condição, nesse caso de que `OnlineOrderFlag` seja definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="1e10f-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="1e10f-109">O operador `Select` aloca e retorna um objeto enumerável que captura os argumentos passados para o operador.</span><span class="sxs-lookup"><span data-stu-id="1e10f-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="1e10f-110">Nesse exemplo acima, um tipo anônimo é criado com três propriedades: `SalesOrderID`, `OrderDate` e `SalesOrderNumber`.</span><span class="sxs-lookup"><span data-stu-id="1e10f-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="1e10f-111">Os valores dessas três propriedades são definidos como os valores das colunas `SalesOrderID`, `OrderDate` e `SalesOrderNumber` da tabela `SalesOrderHeader`.</span><span class="sxs-lookup"><span data-stu-id="1e10f-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="1e10f-112">O loop `foreach` em seguida enumera o objeto enumerável retornado por `Select` e produz os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="1e10f-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="1e10f-113">Como a consulta é um tipo <xref:System.Linq.Enumerable>, que implementa <xref:System.Collections.Generic.IEnumerable%601>, a avaliação da consulta é adiada até que a variável de consulta seja iterada usando o loop `foreach`.</span><span class="sxs-lookup"><span data-stu-id="1e10f-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="1e10f-114">A avaliação da consulta adiada permite que as consultas sejam mantidas como valores que podem ser avaliados várias vezes, cada vez rendendo resultados potencialmente diferentes.</span><span class="sxs-lookup"><span data-stu-id="1e10f-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="1e10f-115">O método <xref:System.Data.DataRowExtensions.Field%2A> fornece acesso aos valores de coluna de um <xref:System.Data.DataRow> e o <xref:System.Data.DataRowExtensions.SetField%2A> (não mostrado no exemplo anterior) define valores de coluna em um <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="1e10f-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="1e10f-116">Os métodos <xref:System.Data.DataRowExtensions.Field%2A> e <xref:System.Data.DataRowExtensions.SetField%2A> lidam com tipos anuláveis, para você não precise verificar valores nulos explicitamente.</span><span class="sxs-lookup"><span data-stu-id="1e10f-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="1e10f-117">Ambos os métodos também são genéricos, o que significa que você não tem que converter o tipo de retorno.</span><span class="sxs-lookup"><span data-stu-id="1e10f-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="1e10f-118">Você pode usar o acessador pré-existente de coluna em <xref:System.Data.DataRow> (por exemplo, `o["OrderDate"]`), mas fazer isso exige que você converta o objeto de retorno para o tipo apropriado.</span><span class="sxs-lookup"><span data-stu-id="1e10f-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="1e10f-119">Se a coluna for anulável, você precisará verificar se o valor é nulo usando o método <xref:System.Data.DataRow.IsNull%2A>.</span><span class="sxs-lookup"><span data-stu-id="1e10f-119">If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="1e10f-120">Para obter mais informações, consulte [Generic Field e métodos SetField](generic-field-and-setfield-methods-linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="1e10f-120">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="1e10f-121">Observe que o tipo de dados especificado no parâmetro genérico `T` dos métodos <xref:System.Data.DataRowExtensions.Field%2A> e <xref:System.Data.DataRowExtensions.SetField%2A> deve corresponder ao tipo do valor subjacente ou <xref:System.InvalidCastException> será gerado.</span><span class="sxs-lookup"><span data-stu-id="1e10f-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="1e10f-122">O nome da coluna especificado também deve corresponder ao nome de uma coluna no <xref:System.Data.DataSet> ou <xref:System.ArgumentException> será gerado.</span><span class="sxs-lookup"><span data-stu-id="1e10f-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="1e10f-123">Em ambos os casos, a exceção é gerada na enumeração de dados em tempo de execução quando a consulta é executada.</span><span class="sxs-lookup"><span data-stu-id="1e10f-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1e10f-124">Veja também</span><span class="sxs-lookup"><span data-stu-id="1e10f-124">See also</span></span>

- [<span data-ttu-id="1e10f-125">Consultas de tabela cruzada</span><span class="sxs-lookup"><span data-stu-id="1e10f-125">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="1e10f-126">Consultando DataSets tipados</span><span class="sxs-lookup"><span data-stu-id="1e10f-126">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="1e10f-127">Campo genérico e métodos de SetField</span><span class="sxs-lookup"><span data-stu-id="1e10f-127">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
