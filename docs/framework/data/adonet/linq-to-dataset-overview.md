---
title: LINQ para visão geral do DataSet
ms.date: 03/30/2017
ms.assetid: dc20a8fb-03f6-4b68-9c2b-7f7299e3070b
ms.openlocfilehash: f7659d03005df69d7debe604581ce49973f938cc
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91200609"
---
# <a name="linq-to-dataset-overview"></a><span data-ttu-id="0ef41-102">LINQ para visão geral do DataSet</span><span class="sxs-lookup"><span data-stu-id="0ef41-102">LINQ to DataSet Overview</span></span>

<span data-ttu-id="0ef41-103">O <xref:System.Data.DataSet> é um dos componentes mais amplamente usados do ADO.net.</span><span class="sxs-lookup"><span data-stu-id="0ef41-103">The <xref:System.Data.DataSet> is one of the more widely used components of ADO.NET.</span></span> <span data-ttu-id="0ef41-104">É um elemento-chave do modelo de programação desconectado no qual o ADO.NET se baseia e permite que você armazene explicitamente os dados de diferentes fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-104">It is a key element of the disconnected programming model that ADO.NET is based on, and it enables you to explicitly cache data from different data sources.</span></span> <span data-ttu-id="0ef41-105">Para a camada de apresentação, o <xref:System.Data.DataSet> é totalmente integrado com controles de GUI para vinculação de dados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-105">For the presentation tier, the <xref:System.Data.DataSet> is tightly integrated with GUI controls for data-binding.</span></span> <span data-ttu-id="0ef41-106">Para a camada intermediária, ele fornece um cache que preserva a forma relacional dos dados e inclui serviços rápidos de navegação de hierarquia e consulta simples.</span><span class="sxs-lookup"><span data-stu-id="0ef41-106">For the middle-tier, it provides a cache that preserves the relational shape of data, and includes fast simple query and hierarchy navigation services.</span></span> <span data-ttu-id="0ef41-107">Uma técnica comum usada para reduzir o número de solicitações em um banco de dados é usar o <xref:System.Data.DataSet> para caching na camada intermediária.</span><span class="sxs-lookup"><span data-stu-id="0ef41-107">A common technique used to lower the number of requests on a database is to use the <xref:System.Data.DataSet> for caching in the middle-tier.</span></span> <span data-ttu-id="0ef41-108">Por exemplo, considere um aplicativo Web ASP.NET controlado por dados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-108">For example, consider a data-driven ASP.NET Web application.</span></span> <span data-ttu-id="0ef41-109">Geralmente, uma parte significativa de dados do aplicativo não muda com frequência e é comum em sessões ou usuários.</span><span class="sxs-lookup"><span data-stu-id="0ef41-109">Often, a significant portion of the application data does not change frequently and is common across sessions or users.</span></span> <span data-ttu-id="0ef41-110">Esses dados podem ser mantidos na memória no servidor Web, reduzindo o número de solicitações no banco de dados e acelerando as interações do usuário.</span><span class="sxs-lookup"><span data-stu-id="0ef41-110">This data can be kept in memory on the Web server, which reduces the number of requests against the database and speeds up the user’s interactions.</span></span> <span data-ttu-id="0ef41-111">Outro aspecto útil do <xref:System.Data.DataSet> é que ele permite que um aplicativo traga subconjuntos de dados de uma ou mais fontes de dados para o espaço do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0ef41-111">Another useful aspect of the <xref:System.Data.DataSet> is that it allows an application to bring subsets of data from one or more data source into the application space.</span></span> <span data-ttu-id="0ef41-112">O aplicativo pode manipular os dados na memória, mantendo sua forma relacional.</span><span class="sxs-lookup"><span data-stu-id="0ef41-112">The application can then manipulate the data in-memory, while retaining its relational shape.</span></span>  
  
 <span data-ttu-id="0ef41-113">Apesar de sua importância, o <xref:System.Data.DataSet> limitou os recursos de consulta.</span><span class="sxs-lookup"><span data-stu-id="0ef41-113">Despite its prominence, the <xref:System.Data.DataSet> has limited query capabilities.</span></span> <span data-ttu-id="0ef41-114">O método <xref:System.Data.DataTable.Select%2A> pode ser usado para filtrar e classificar, e os métodos <xref:System.Data.DataRow.GetChildRows%2A> e <xref:System.Data.DataRow.GetParentRow%2A> podem ser usados para navegação a hierarquia.</span><span class="sxs-lookup"><span data-stu-id="0ef41-114">The <xref:System.Data.DataTable.Select%2A> method can be used for filtering and sorting, and the <xref:System.Data.DataRow.GetChildRows%2A> and <xref:System.Data.DataRow.GetParentRow%2A> methods can be used for hierarchy navigation.</span></span> <span data-ttu-id="0ef41-115">Para algo mais complexo, no entanto, o desenvolvedor precisa escrever uma consulta personalizada.</span><span class="sxs-lookup"><span data-stu-id="0ef41-115">For anything more complex, however, the developer must write a custom query.</span></span> <span data-ttu-id="0ef41-116">Isso pode resultar em aplicativos com baixo desempenho e de difícil manutenção.</span><span class="sxs-lookup"><span data-stu-id="0ef41-116">This can result in applications that perform poorly and are difficult to maintain.</span></span>  
  
 <span data-ttu-id="0ef41-117">LINQ to DataSet torna mais fácil e rápido a consulta sobre dados armazenados em cache em um <xref:System.Data.DataSet> objeto.</span><span class="sxs-lookup"><span data-stu-id="0ef41-117">LINQ to DataSet makes it easier and faster to query over data cached in a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="0ef41-118">Essas consultas são expressas na própria linguagem de programação, e não como os literais de cadeia de caracteres inseridos no código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0ef41-118">These queries are expressed in the programming language itself, rather than as string literals embedded in the application code.</span></span> <span data-ttu-id="0ef41-119">Isso significa que os desenvolvedores não precisam aprender uma linguagem de consulta separada.</span><span class="sxs-lookup"><span data-stu-id="0ef41-119">This means that developers do not have to learn a separate query language.</span></span> <span data-ttu-id="0ef41-120">Além disso, o LINQ to DataSet permite que os desenvolvedores do Visual Studio trabalhem de forma mais produtiva, porque o IDE do Visual Studio fornece verificação de sintaxe de tempo de compilação, digitação estática e suporte do IntelliSense para LINQ.</span><span class="sxs-lookup"><span data-stu-id="0ef41-120">Additionally, LINQ to DataSet enables Visual Studio developers to work more productively, because the Visual Studio IDE provides compile-time syntax checking, static typing, and IntelliSense support for LINQ.</span></span> <span data-ttu-id="0ef41-121">LINQ to DataSet também pode ser usado para consultar dados que foram consolidados de uma ou mais fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-121">LINQ to DataSet can also be used to query over data that has been consolidated from one or more data sources.</span></span> <span data-ttu-id="0ef41-122">Isso habilita vários cenários que exigem flexibilidade na maneira como dados são representados e tratados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-122">This enables many scenarios that require flexibility in how data is represented and handled.</span></span> <span data-ttu-id="0ef41-123">Em particular, os aplicativos genéricos de relatório, análise e business intelligence requerem esse método de manipulação.</span><span class="sxs-lookup"><span data-stu-id="0ef41-123">In particular, generic reporting, analysis, and business intelligence applications require this method of manipulation.</span></span>  
  
## <a name="querying-datasets-using-linq-to-dataset"></a><span data-ttu-id="0ef41-124">Consultando DataSets usando o LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="0ef41-124">Querying DataSets Using LINQ to DataSet</span></span>  

 <span data-ttu-id="0ef41-125">Antes de começar a consultar um <xref:System.Data.DataSet> objeto usando LINQ to DataSet, você deve preencher o <xref:System.Data.DataSet> .</span><span class="sxs-lookup"><span data-stu-id="0ef41-125">Before you can begin querying a <xref:System.Data.DataSet> object using LINQ to DataSet, you must populate the <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="0ef41-126">Há várias maneiras de carregar dados em um <xref:System.Data.DataSet> , como usar a <xref:System.Data.Common.DataAdapter> classe ou [LINQ to SQL](./sql/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="0ef41-126">There are several ways to load data into a <xref:System.Data.DataSet>, such as using the <xref:System.Data.Common.DataAdapter> class or [LINQ to SQL](./sql/linq/index.md).</span></span> <span data-ttu-id="0ef41-127">Depois que os dados tiverem sido carregados em um <xref:System.Data.DataSet> objeto, você poderá começar a consultá-los.</span><span class="sxs-lookup"><span data-stu-id="0ef41-127">After the data has been loaded into a <xref:System.Data.DataSet> object, you can begin to query it.</span></span> <span data-ttu-id="0ef41-128">As consultas do formular usando LINQ to DataSet é semelhante ao uso de LINQ (consulta integrada à linguagem) em relação a outras fontes de dados habilitadas para LINQ.</span><span class="sxs-lookup"><span data-stu-id="0ef41-128">Formulating queries using LINQ to DataSet is similar to using Language-Integrated Query (LINQ) against other LINQ-enabled data sources.</span></span> <span data-ttu-id="0ef41-129">Consultas LINQ podem ser executadas em tabelas únicas em uma <xref:System.Data.DataSet> ou em mais de uma tabela usando os <xref:System.Linq.Enumerable.Join%2A> operadores de <xref:System.Linq.Enumerable.GroupJoin%2A> consulta e padrão.</span><span class="sxs-lookup"><span data-stu-id="0ef41-129">LINQ queries can be performed against single tables in a <xref:System.Data.DataSet> or against more than one table by using the <xref:System.Linq.Enumerable.Join%2A> and <xref:System.Linq.Enumerable.GroupJoin%2A> standard query operators.</span></span>  
  
 <span data-ttu-id="0ef41-130">Há suporte para consultas LINQ em objetos digitados e não tipados <xref:System.Data.DataSet> .</span><span class="sxs-lookup"><span data-stu-id="0ef41-130">LINQ queries are supported against both typed and untyped <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="0ef41-131">Se o esquema do <xref:System.Data.DataSet> for conhecido no momento do design do aplicativo, um tipo <xref:System.Data.DataSet> será recomendado.</span><span class="sxs-lookup"><span data-stu-id="0ef41-131">If the schema of the <xref:System.Data.DataSet> is known at application design time, a typed <xref:System.Data.DataSet> is recommended.</span></span> <span data-ttu-id="0ef41-132">Em um tipo <xref:System.Data.DataSet> , as tabelas e linhas têm Membros digitados para cada uma das colunas, o que torna as consultas mais simples e legíveis.</span><span class="sxs-lookup"><span data-stu-id="0ef41-132">In a typed <xref:System.Data.DataSet>, the tables and rows have typed members for each of the columns, which makes queries simpler and more readable.</span></span>  
  
 <span data-ttu-id="0ef41-133">Além dos operadores de consulta padrão implementados no System.Core.dll, o LINQ to DataSet adiciona várias <xref:System.Data.DataSet> extensões específicas que facilitam a consulta em um conjunto de <xref:System.Data.DataRow> objetos.</span><span class="sxs-lookup"><span data-stu-id="0ef41-133">In addition to the standard query operators implemented in System.Core.dll, LINQ to DataSet adds several <xref:System.Data.DataSet>-specific extensions that make it easier to query over a set of <xref:System.Data.DataRow> objects.</span></span> <span data-ttu-id="0ef41-134">Essas extensões específicas de <xref:System.Data.DataSet> incluem operadores para comparar sequências de linhas, bem como métodos que fornecem acesso aos valores de coluna de <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="0ef41-134">These <xref:System.Data.DataSet>-specific extensions include operators for comparing sequences of rows, as well as methods that provide access to the column values of a <xref:System.Data.DataRow>.</span></span>  
  
## <a name="n-tier-applications-and-linq-to-dataset"></a><span data-ttu-id="0ef41-135">Aplicativos de n camadas e LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="0ef41-135">N-tier Applications and LINQ to DataSet</span></span>  

 <span data-ttu-id="0ef41-136">Aplicativos de dados de n camadas são aplicativos centrados em dados que são separados em várias camadas lógicas (ou camadas).</span><span class="sxs-lookup"><span data-stu-id="0ef41-136">N-tier data applications are data-centric applications that are separated into multiple logical layers (or tiers).</span></span> <span data-ttu-id="0ef41-137">Um aplicativo de n camadas típico inclui uma camada de apresentação, uma camada intermediária e uma camada de dados.</span><span class="sxs-lookup"><span data-stu-id="0ef41-137">A typical N-tier application includes a presentation tier, a middle tier, and a data tier.</span></span> <span data-ttu-id="0ef41-138">Dividir componentes do aplicativo em camadas separadas aumenta a facilidade de manutenção e a escalabilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0ef41-138">Separating application components into separate tiers increases the maintainability and scalability of the application.</span></span> <span data-ttu-id="0ef41-139">Para obter mais informações sobre aplicativos de dados de N camadas, consulte [trabalhar com conjuntos de dados em aplicativos de n camadas](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span><span class="sxs-lookup"><span data-stu-id="0ef41-139">For more information about N-tier data applications, see [Work with datasets in n-tier applications](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span></span>  
  
 <span data-ttu-id="0ef41-140">Em aplicativos de n camadas, o <xref:System.Data.DataSet> costuma ser usado na camada intermediária para armazenar em cache informações para um aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="0ef41-140">In N-tier applications, the <xref:System.Data.DataSet> is often used in the middle-tier to cache information for a Web application.</span></span> <span data-ttu-id="0ef41-141">A funcionalidade de consulta de LINQ to DataSet é implementada por meio de métodos de extensão e estende o ADO.NET 2,0 existente <xref:System.Data.DataSet> .</span><span class="sxs-lookup"><span data-stu-id="0ef41-141">The LINQ to DataSet querying functionality is implemented through extension methods and extends the existing ADO.NET 2.0 <xref:System.Data.DataSet>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0ef41-142">Veja também</span><span class="sxs-lookup"><span data-stu-id="0ef41-142">See also</span></span>

- [<span data-ttu-id="0ef41-143">Consultar DataSets</span><span class="sxs-lookup"><span data-stu-id="0ef41-143">Querying DataSets</span></span>](querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="0ef41-144">LINQ (consulta integrada à linguagem) – C#</span><span class="sxs-lookup"><span data-stu-id="0ef41-144">Language-Integrated Query (LINQ) - C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="0ef41-145">LINQ (consulta integrada à linguagem) – Visual Basic</span><span class="sxs-lookup"><span data-stu-id="0ef41-145">Language-Integrated Query (LINQ) - Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="0ef41-146">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="0ef41-146">LINQ to SQL</span></span>](./sql/linq/index.md)
