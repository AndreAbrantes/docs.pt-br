---
title: "Considerações sobre desempenho (Entity Framework)"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 61913f3b-4f42-4d9b-810f-2a13c2388a4a
caps.latest.revision: "6"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: e27d6ec040557d682082a6fb5a05677ad52afae9
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/19/2018
---
# <a name="performance-considerations-entity-framework"></a><span data-ttu-id="bb6c2-102">Considerações sobre desempenho (Entity Framework)</span><span class="sxs-lookup"><span data-stu-id="bb6c2-102">Performance Considerations (Entity Framework)</span></span>
<span data-ttu-id="bb6c2-103">Este tópico descreve as características de desempenho do ADO.NET Entity Framework e fornece algumas considerações para ajudar a melhorar o desempenho de aplicativos do Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-103">This topic describes performance characteristics of the ADO.NET Entity Framework and provides some considerations to help improve the performance of Entity Framework applications.</span></span>  
  
## <a name="stages-of-query-execution"></a><span data-ttu-id="bb6c2-104">Fases da execução da consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-104">Stages of Query Execution</span></span>  
 <span data-ttu-id="bb6c2-105">Para compreender melhor o desempenho de consultas no Entity Framework, é útil entender as operações que ocorrem quando uma consulta é executada em um modelo conceitual e retorna dados como objetos.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-105">In order to better understand the performance of queries in the Entity Framework, it is helpful to understand the operations that occur when a query executes against a conceptual model and returns data as objects.</span></span> <span data-ttu-id="bb6c2-106">A tabela a seguir descreve esta série de operações.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-106">The following table describes this series of operations.</span></span>  
  
|<span data-ttu-id="bb6c2-107">Operação</span><span class="sxs-lookup"><span data-stu-id="bb6c2-107">Operation</span></span>|<span data-ttu-id="bb6c2-108">Custo relativo</span><span class="sxs-lookup"><span data-stu-id="bb6c2-108">Relative Cost</span></span>|<span data-ttu-id="bb6c2-109">Frequência</span><span class="sxs-lookup"><span data-stu-id="bb6c2-109">Frequency</span></span>|<span data-ttu-id="bb6c2-110">Comentários</span><span class="sxs-lookup"><span data-stu-id="bb6c2-110">Comments</span></span>|  
|---------------|-------------------|---------------|--------------|  
|<span data-ttu-id="bb6c2-111">Carregando metadados</span><span class="sxs-lookup"><span data-stu-id="bb6c2-111">Loading metadata</span></span>|<span data-ttu-id="bb6c2-112">Moderado</span><span class="sxs-lookup"><span data-stu-id="bb6c2-112">Moderate</span></span>|<span data-ttu-id="bb6c2-113">Uma vez em cada domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-113">Once in each application domain.</span></span>|<span data-ttu-id="bb6c2-114">Os metadados de modelo e de mapeamento usados pelo Entity Framework são carregados em uma <xref:System.Data.Metadata.Edm.MetadataWorkspace>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-114">Model and mapping metadata used by the Entity Framework is loaded into a <xref:System.Data.Metadata.Edm.MetadataWorkspace>.</span></span> <span data-ttu-id="bb6c2-115">Esses metadados são armazenados em cache globalmente e estão disponíveis para outras instâncias do <xref:System.Data.Objects.ObjectContext> no mesmo domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-115">This metadata is cached globally and is available to other instances of <xref:System.Data.Objects.ObjectContext> in the same application domain.</span></span>|  
|<span data-ttu-id="bb6c2-116">Abrindo a conexão de banco de dados</span><span class="sxs-lookup"><span data-stu-id="bb6c2-116">Opening the database connection</span></span>|<span data-ttu-id="bb6c2-117">Moderada<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-117">Moderate<sup>1</sup></span></span>|<span data-ttu-id="bb6c2-118">Conforme o necessário.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-118">As needed.</span></span>|<span data-ttu-id="bb6c2-119">Como uma conexão aberta ao banco de dados consome um recurso valioso, o [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] abre e fecha a conexão de banco de dados conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-119">Because an open connection to the database consumes a valuable resource, the [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] opens and closes the database connection only as needed.</span></span> <span data-ttu-id="bb6c2-120">Você também pode explicitamente abrir a conexão.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-120">You can also explicitly open the connection.</span></span> <span data-ttu-id="bb6c2-121">Para obter mais informações, consulte [Gerenciando conexões e transações](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-121">For more information, see [Managing Connections and Transactions](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span></span>|  
|<span data-ttu-id="bb6c2-122">Gerando exibições</span><span class="sxs-lookup"><span data-stu-id="bb6c2-122">Generating views</span></span>|<span data-ttu-id="bb6c2-123">Alta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-123">High</span></span>|<span data-ttu-id="bb6c2-124">Uma vez em cada domínio de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-124">Once in each application domain.</span></span> <span data-ttu-id="bb6c2-125">(Pode ser pré-gerado.)</span><span class="sxs-lookup"><span data-stu-id="bb6c2-125">(Can be pre-generated.)</span></span>|<span data-ttu-id="bb6c2-126">Antes que o Entity Framework possa executar uma consulta em um modelo conceitual ou salvar alterações na fonte de dados, ele deverá gerar um conjunto de exibições de consultas locais para acessar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-126">Before the Entity Framework can execute a query against a conceptual model or save changes to the data source, it must generate a set of local query views to access the database.</span></span> <span data-ttu-id="bb6c2-127">Devido a custo alto de gerar essas exibições, você poderá pré-gerar as exibições e adicioná-las ao projeto em tempo de design.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-127">Because of the high cost of generating these views, you can pre-generate the views and add them to the project at design-time.</span></span> <span data-ttu-id="bb6c2-128">Para obter mais informações, consulte [como: Pre-Generate exibições para melhorar o desempenho da consulta](http://msdn.microsoft.com/library/b18a9d16-e10b-4043-ba91-b632f85a2579).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-128">For more information, see [How to: Pre-Generate Views to Improve Query Performance](http://msdn.microsoft.com/library/b18a9d16-e10b-4043-ba91-b632f85a2579).</span></span>|  
|<span data-ttu-id="bb6c2-129">Preparando a consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-129">Preparing the query</span></span>|<span data-ttu-id="bb6c2-130">Moderada<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-130">Moderate<sup>2</sup></span></span>|<span data-ttu-id="bb6c2-131">Uma vez para cada consulta exclusiva.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-131">Once for each unique query.</span></span>|<span data-ttu-id="bb6c2-132">Inclui o custo para compor o comando de consulta, gerar uma árvore de comando com base em metadados de modelo e mapeamento, e definir o formato dos dados retornados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-132">Includes the costs to compose the query command, generate a command tree based on model and mapping metadata, and define the shape of the returned data.</span></span> <span data-ttu-id="bb6c2-133">Como agora os comandos de consulta Entity SQL e as consultas LINQ são armazenados em cache, as execuções posteriores da mesma consulta são realizadas em menos tempo.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-133">Because now both Entity SQL query commands and LINQ queries are cached, later executions of the same query take less time.</span></span> <span data-ttu-id="bb6c2-134">Você ainda pode usar consultas LINQ para reduzir esse custo em execuções posteriores e consultas compiladas podem ser mais eficientes que consultas LINQ que são automaticamente armazenadas em cache.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-134">You can still use compiled LINQ queries to reduce this cost in later executions and compiled queries can be more efficient than LINQ queries that are automatically cached.</span></span> <span data-ttu-id="bb6c2-135">Para obter mais informações, consulte [consultas compiladas (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/compiled-queries-linq-to-entities.md).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-135">For more information, see [Compiled Queries  (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/compiled-queries-linq-to-entities.md).</span></span> <span data-ttu-id="bb6c2-136">Para obter informações gerais sobre a execução de consulta LINQ, consulte [LINQ to Entities](../../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-136">For general information about LINQ query execution, see [LINQ to Entities](../../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md).</span></span> <span data-ttu-id="bb6c2-137">**Observação:** consultas LINQ to Entities que se aplicam a `Enumerable.Contains` operador coleções na memória não estão em cache automaticamente.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-137">**Note:**  LINQ to Entities queries that apply the `Enumerable.Contains` operator to in-memory collections are not automatically cached.</span></span> <span data-ttu-id="bb6c2-138">Além disso, não é permitido parametrizar coleções na memória em consultas LINQ compiladas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-138">Also parameterizing in-memory collections in compiled LINQ queries is not allowed.</span></span>|  
|<span data-ttu-id="bb6c2-139">Executando a consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-139">Executing the query</span></span>|<span data-ttu-id="bb6c2-140">Baixo<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-140">Low<sup>2</sup></span></span>|<span data-ttu-id="bb6c2-141">Uma vez para cada consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-141">Once for each query.</span></span>|<span data-ttu-id="bb6c2-142">O custo de executar o comando na fonte de dados usando o provedor de dados do ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-142">The cost of executing the command against the data source by using the ADO.NET data provider.</span></span> <span data-ttu-id="bb6c2-143">Como a maioria das fontes de dados armazenam em cache os planos de consulta, as executa posteriores da mesma consulta podem levar ainda menos tempo.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-143">Because most data sources cache query plans, later executions of the same query may take even less time.</span></span>|  
|<span data-ttu-id="bb6c2-144">Carregando e validando tipos</span><span class="sxs-lookup"><span data-stu-id="bb6c2-144">Loading and validating types</span></span>|<span data-ttu-id="bb6c2-145">Baixo<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-145">Low<sup>3</sup></span></span>|<span data-ttu-id="bb6c2-146">Uma vez para cada instância <xref:System.Data.Objects.ObjectContext>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-146">Once for each <xref:System.Data.Objects.ObjectContext> instance.</span></span>|<span data-ttu-id="bb6c2-147">Os tipos são carregados e validados nos tipos que o modelo conceitual define.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-147">Types are loaded and validated against the types that the conceptual model defines.</span></span>|  
|<span data-ttu-id="bb6c2-148">Acompanhamento</span><span class="sxs-lookup"><span data-stu-id="bb6c2-148">Tracking</span></span>|<span data-ttu-id="bb6c2-149">Baixo<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-149">Low<sup>3</sup></span></span>|<span data-ttu-id="bb6c2-150">Uma vez para cada objeto que uma consulta retorna.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-150">Once for each object that a query returns.</span></span> <span data-ttu-id="bb6c2-151"><sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-151"><sup>4</sup></span></span>|<span data-ttu-id="bb6c2-152">Se uma consulta usa a opção de mesclagem <xref:System.Data.Objects.MergeOption.NoTracking>, essa fase não afetará o desempenho.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-152">If a query uses the <xref:System.Data.Objects.MergeOption.NoTracking> merge option, this stage does not affect performance.</span></span><br /><br /> <span data-ttu-id="bb6c2-153">Se a consulta usa a opção de mesclagem <xref:System.Data.Objects.MergeOption.AppendOnly>, <xref:System.Data.Objects.MergeOption.PreserveChanges> ou <xref:System.Data.Objects.MergeOption.OverwriteChanges>, os resultados da consulta são controlados no <xref:System.Data.Objects.ObjectStateManager>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-153">If the query uses the <xref:System.Data.Objects.MergeOption.AppendOnly>, <xref:System.Data.Objects.MergeOption.PreserveChanges>, or <xref:System.Data.Objects.MergeOption.OverwriteChanges> merge option, query results are tracked in the <xref:System.Data.Objects.ObjectStateManager>.</span></span> <span data-ttu-id="bb6c2-154">Um <xref:System.Data.EntityKey> é gerado para cada objeto controlado que a consulta retorna e é usado para criar <xref:System.Data.Objects.ObjectStateEntry> no <xref:System.Data.Objects.ObjectStateManager>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-154">An <xref:System.Data.EntityKey> is generated for each tracked object that the query returns and is used to create an <xref:System.Data.Objects.ObjectStateEntry> in the <xref:System.Data.Objects.ObjectStateManager>.</span></span> <span data-ttu-id="bb6c2-155">Se um <xref:System.Data.Objects.ObjectStateEntry> existente pode ser encontrado para o <xref:System.Data.EntityKey>, o objeto existente é retornado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-155">If an existing <xref:System.Data.Objects.ObjectStateEntry> can be found for the <xref:System.Data.EntityKey>, the existing object is returned.</span></span> <span data-ttu-id="bb6c2-156">Se a opção <xref:System.Data.Objects.MergeOption.PreserveChanges> ou <xref:System.Data.Objects.MergeOption.OverwriteChanges> for usada, o objeto será atualizado antes de ser retornado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-156">If the <xref:System.Data.Objects.MergeOption.PreserveChanges>, or <xref:System.Data.Objects.MergeOption.OverwriteChanges> option is used, the object is updated before it is returned.</span></span><br /><br /> <span data-ttu-id="bb6c2-157">Para obter mais informações, consulte [resolução de identidade, gerenciamento de estado e controle de alterações](http://msdn.microsoft.com/library/3bd49311-0e72-4ea4-8355-38fe57036ba0).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-157">For more information, see [Identity Resolution, State Management, and Change Tracking](http://msdn.microsoft.com/library/3bd49311-0e72-4ea4-8355-38fe57036ba0).</span></span>|  
|<span data-ttu-id="bb6c2-158">Materializando os objetos</span><span class="sxs-lookup"><span data-stu-id="bb6c2-158">Materializing the objects</span></span>|<span data-ttu-id="bb6c2-159">Moderada<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-159">Moderate<sup>3</sup></span></span>|<span data-ttu-id="bb6c2-160">Uma vez para cada objeto que uma consulta retorna.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-160">Once for each object that a query returns.</span></span> <span data-ttu-id="bb6c2-161"><sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="bb6c2-161"><sup>4</sup></span></span>|<span data-ttu-id="bb6c2-162">O processo de ler o objeto retornado <xref:System.Data.Common.DbDataReader>, criar objetos e definir valores de propriedades que são baseados nos valores em cada instância da classe <xref:System.Data.Common.DbDataRecord>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-162">The process of reading the returned <xref:System.Data.Common.DbDataReader> object and creating objects and setting property values that are based on the values in each instance of the <xref:System.Data.Common.DbDataRecord> class.</span></span> <span data-ttu-id="bb6c2-163">Se o objeto já existir no <xref:System.Data.Objects.ObjectContext> e a consulta usar as opções de mesclagem <xref:System.Data.Objects.MergeOption.AppendOnly> ou <xref:System.Data.Objects.MergeOption.PreserveChanges>, essa fase não afetará o desempenho.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-163">If the object already exists in the <xref:System.Data.Objects.ObjectContext> and the query uses the <xref:System.Data.Objects.MergeOption.AppendOnly> or <xref:System.Data.Objects.MergeOption.PreserveChanges> merge options, this stage does not affect performance.</span></span> <span data-ttu-id="bb6c2-164">Para obter mais informações, consulte [resolução de identidade, gerenciamento de estado e controle de alterações](http://msdn.microsoft.com/library/3bd49311-0e72-4ea4-8355-38fe57036ba0).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-164">For more information, see [Identity Resolution, State Management, and Change Tracking](http://msdn.microsoft.com/library/3bd49311-0e72-4ea4-8355-38fe57036ba0).</span></span>|  
  
 <span data-ttu-id="bb6c2-165"><sup>1</sup> quando um provedor de fonte de dados implementa o pooling de conexão, o custo de abrir uma conexão é distribuído entre o pool.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-165"><sup>1</sup> When a data source provider implements connection pooling, the cost of opening a connection is distributed across the pool.</span></span> <span data-ttu-id="bb6c2-166">O provedor do .NET para o SQL Server dá suporte ao pool de conexões.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-166">The .NET Provider for SQL Server supports connection pooling.</span></span>  
  
 <span data-ttu-id="bb6c2-167"><sup>2</sup> custo aumenta a complexidade da consulta maior.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-167"><sup>2</sup> Cost increases with increased query complexity.</span></span>  
  
 <span data-ttu-id="bb6c2-168"><sup>3</sup> custo total aumenta proporcional ao número de objetos retornados pela consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-168"><sup>3</sup> Total cost increases proportional to the number of objects returned by the query.</span></span>  
  
 <span data-ttu-id="bb6c2-169"><sup>4</sup> essa sobrecarga não é necessária para consultas de EntityClient porque EntityClient consulta retornar um <xref:System.Data.EntityClient.EntityDataReader> em vez de objetos.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-169"><sup>4</sup> This overhead is not required for EntityClient queries because EntityClient queries return an <xref:System.Data.EntityClient.EntityDataReader> instead of objects.</span></span> <span data-ttu-id="bb6c2-170">Para obter mais informações, consulte [provedor EntityClient para Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-170">For more information, see [EntityClient Provider for the Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md).</span></span>  
  
## <a name="additional-considerations"></a><span data-ttu-id="bb6c2-171">Considerações adicionais</span><span class="sxs-lookup"><span data-stu-id="bb6c2-171">Additional Considerations</span></span>  
 <span data-ttu-id="bb6c2-172">Veja a seguir as outras considerações que podem afetar o desempenho de aplicativos do Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-172">The following are other considerations that may affect the performance of Entity Framework applications.</span></span>  
  
### <a name="query-execution"></a><span data-ttu-id="bb6c2-173">Execução da Consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-173">Query Execution</span></span>  
 <span data-ttu-id="bb6c2-174">Como as consultas podem consumir recursos intensivamente, considere em qual ponto no seu código e em qual computador a consulta será executada.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-174">Because queries can be resource intensive, consider at what point in your code and on what computer a query is executed.</span></span>  
  
#### <a name="deferred-versus-immediate-execution"></a><span data-ttu-id="bb6c2-175">Execução adiada versus imediata</span><span class="sxs-lookup"><span data-stu-id="bb6c2-175">Deferred versus immediate execution</span></span>  
 <span data-ttu-id="bb6c2-176">Quando você cria uma consulta <xref:System.Data.Objects.ObjectQuery%601> ou LINQ, a consulta pode não ser executada imediatamente.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-176">When you create an <xref:System.Data.Objects.ObjectQuery%601> or LINQ query, the query may not be executed immediately.</span></span> <span data-ttu-id="bb6c2-177">A execução da consulta é adiada até que os resultados sejam necessários, como durante uma enumeração `foreach` (C#) ou `For Each` (Visual Basic) ou quando ela é atribuída para preencher uma coleção de <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-177">Query execution is deferred until the results are needed, such as during a `foreach` (C#) or `For Each` (Visual Basic) enumeration or when it is assigned to fill a <xref:System.Collections.Generic.List%601> collection.</span></span> <span data-ttu-id="bb6c2-178">A execução da consulta começa imediatamente quando você chama o método <xref:System.Data.Objects.ObjectQuery%601.Execute%2A> em um <xref:System.Data.Objects.ObjectQuery%601> ou quando você chama um método LINQ que retorna uma consulta singleton, como <xref:System.Linq.Enumerable.First%2A> ou <xref:System.Linq.Enumerable.Any%2A>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-178">Query execution begins immediately when you call the <xref:System.Data.Objects.ObjectQuery%601.Execute%2A> method on an <xref:System.Data.Objects.ObjectQuery%601> or when you call a LINQ method that returns a singleton query, such as <xref:System.Linq.Enumerable.First%2A> or <xref:System.Linq.Enumerable.Any%2A>.</span></span> <span data-ttu-id="bb6c2-179">Para obter mais informações, consulte [objeto consultas](http://msdn.microsoft.com/library/0768033c-876f-471d-85d5-264884349276) e [a execução da consulta (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/query-execution.md).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-179">For more information, see [Object Queries](http://msdn.microsoft.com/library/0768033c-876f-471d-85d5-264884349276) and [Query Execution (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/query-execution.md).</span></span>  
  
#### <a name="client-side-execution-of-linq-queries"></a><span data-ttu-id="bb6c2-180">Execução do lado do cliente de consultas LINQ</span><span class="sxs-lookup"><span data-stu-id="bb6c2-180">Client-side execution of LINQ queries</span></span>  
 <span data-ttu-id="bb6c2-181">Embora a execução de uma consulta LINQ ocorra no computador que hospeda a fonte de dados, algumas partes de uma consulta LINQ podem ser avaliadas no computador cliente.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-181">Although the execution of a LINQ query occurs on the computer that hosts the data source, some parts of a LINQ query may be evaluated on the client computer.</span></span> <span data-ttu-id="bb6c2-182">Para obter mais informações, consulte a seção de execução do repositório de [a execução da consulta (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/query-execution.md).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-182">For more information, see the Store Execution section of [Query Execution (LINQ to Entities)](../../../../../docs/framework/data/adonet/ef/language-reference/query-execution.md).</span></span>  
  
### <a name="query-and-mapping-complexity"></a><span data-ttu-id="bb6c2-183">Complexidade da consulta e de mapeamento</span><span class="sxs-lookup"><span data-stu-id="bb6c2-183">Query and Mapping Complexity</span></span>  
 <span data-ttu-id="bb6c2-184">A complexidade de consultas individuais e de mapeamento no modelo de entidade terá um efeito significativo no desempenho da consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-184">The complexity of individual queries and of the mapping in the entity model will have a significant effect on query performance.</span></span>  
  
#### <a name="mapping-complexity"></a><span data-ttu-id="bb6c2-185">Complexidade de mapeamento</span><span class="sxs-lookup"><span data-stu-id="bb6c2-185">Mapping complexity</span></span>  
 <span data-ttu-id="bb6c2-186">Os modelos que são mais complexos do que um mapeamento de um-para-um simples entre entidades no modelo conceitual e as tabelas no modelo de armazenamento geram comandos mais complexos que modelos que têm um mapeamento um-para-um.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-186">Models that are more complex than a simple one-to-one mapping between entities in the conceptual model and tables in the storage model generate more complex commands than models that have a one-to-one mapping.</span></span>  
  
#### <a name="query-complexity"></a><span data-ttu-id="bb6c2-187">Complexidade da consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-187">Query complexity</span></span>  
 <span data-ttu-id="bb6c2-188">As consultas que exigem um grande número junções nos comandos que são executados na fonte de dados ou que retornam uma grande quantidade de dados podem afetar o desempenho das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="bb6c2-188">Queries that require a large number of joins in the commands that are executed against the data source or that return a large amount of data may affect performance in the following ways:</span></span>  
  
-   <span data-ttu-id="bb6c2-189">As consulta em um modelo conceitual que parecem simples podem resultar na execução de consultas mais complexas na fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-189">Queries against a conceptual model that seem simple may result in the execution of more complex queries against the data source.</span></span> <span data-ttu-id="bb6c2-190">Isso pode ocorrer porque o Entity Framework converte uma consulta em um modelo conceitual em uma consulta equivalente na fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-190">This can occur because the Entity Framework translates a query against a conceptual model into an equivalent query against the data source.</span></span> <span data-ttu-id="bb6c2-191">Quando um único conjunto de entidades no modelo conceitual mapeia para mais de uma tabela na fonte de dados, ou quando uma relação entre entidades é mapeada para uma tabela de junção, o comando de consulta executado na consulta da fonte de dados pode exigir um ou mais junções.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-191">When a single entity set in the conceptual model maps to more than one table in the data source, or when a relationship between entities is mapped to a join table, the query command executed against the data source query may require one or more joins.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="bb6c2-192">Use o método <xref:System.Data.Objects.ObjectQuery.ToTraceString%2A> das classes <xref:System.Data.Objects.ObjectQuery%601> ou <xref:System.Data.EntityClient.EntityCommand> para exibir os comandos que são executados na fonte de dados para uma determinada consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-192">Use the <xref:System.Data.Objects.ObjectQuery.ToTraceString%2A> method of the <xref:System.Data.Objects.ObjectQuery%601> or <xref:System.Data.EntityClient.EntityCommand> classes to view the commands that are executed against the data source for a given query.</span></span> <span data-ttu-id="bb6c2-193">Para obter mais informações, consulte [como: exibir os comandos de armazenamento](http://msdn.microsoft.com/library/f9771c6e-3b62-4b24-a5d4-55d68e14fa79).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-193">For more information, see [How to: View the Store Commands](http://msdn.microsoft.com/library/f9771c6e-3b62-4b24-a5d4-55d68e14fa79).</span></span>  
  
-   <span data-ttu-id="bb6c2-194">As consultas aninhadas do Entity SQL podem criar junções no servidor e podem retornar um grande número de linhas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-194">Nested Entity SQL queries may create joins on the server and can return a large number of rows.</span></span>  
  
     <span data-ttu-id="bb6c2-195">Veja a seguir um exemplo de uma consulta aninhada em uma cláusula de projeção:</span><span class="sxs-lookup"><span data-stu-id="bb6c2-195">The following is an example of a nested query in a projection clause:</span></span>  
  
    ```  
    SELECT c, (SELECT c, (SELECT c FROM AdventureWorksModel.Vendor AS c  ) As Inner2   
        FROM AdventureWorksModel.JobCandidate AS c  ) As Inner1   
        FROM AdventureWorksModel.EmployeeDepartmentHistory AS c  
    ```  
  
     <span data-ttu-id="bb6c2-196">Além disso, essas consultas fazem o pipeline de consulta gerar uma única consulta com duplicação de objetos nas consultas aninhadas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-196">In addition, such queries cause the query pipeline to generate a single query with duplication of objects across nested queries.</span></span> <span data-ttu-id="bb6c2-197">Devido a isso, uma única coluna pode ser duplicada várias vezes.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-197">Because of this, a single column may be duplicated multiple times.</span></span> <span data-ttu-id="bb6c2-198">Em alguns bancos de dados, incluindo o SQL Server, isso pode fazer a tabela TempDB aumentar muito, o que pode diminuir o desempenho do servidor.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-198">On some databases, including SQL Server, this can cause the TempDB table to grow very large, which can decrease server performance.</span></span> <span data-ttu-id="bb6c2-199">Tome cuidado ao executar consultas aninhadas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-199">Care should be taken when you execute nested queries.</span></span>  
  
-   <span data-ttu-id="bb6c2-200">Todas as consultas que retornam uma grande quantidade de dados podem diminuir o desempenho se o cliente estiver executando operações que consomem recursos de uma maneira que seja proporcional ao tamanho do conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-200">Any queries that return a large amount of data can cause decreased performance if the client is performing operations that consume resources in a way that is proportional to the size of the result set.</span></span> <span data-ttu-id="bb6c2-201">Nesses casos, você deve limitar a quantidade de dados retornados pela consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-201">In such cases, you should consider limiting the amount of data returned by the query.</span></span> <span data-ttu-id="bb6c2-202">Para obter mais informações, consulte [como: página por meio de resultados da consulta](http://msdn.microsoft.com/library/ffc0f920-e7de-42e0-9b12-ef356421d030).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-202">For more information, see [How to: Page Through Query Results](http://msdn.microsoft.com/library/ffc0f920-e7de-42e0-9b12-ef356421d030).</span></span>  
  
 <span data-ttu-id="bb6c2-203">Todos os comandos gerados automaticamente pelo Entity Framework podem ser mais complexos que os comandos semelhantes escritos explicitamente por um desenvolvedor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-203">Any commands automatically generated by the Entity Framework may be more complex than similar commands written explicitly by a database developer.</span></span> <span data-ttu-id="bb6c2-204">Se você precisar de um controle explícito sobre os comandos executados em sua fonte de dados, defina um mapeamento para uma função de valores de tabela ou procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-204">If you need explicit control over the commands executed against your data source, consider defining a mapping to a table-valued function or stored procedure.</span></span>  
  
#### <a name="relationships"></a><span data-ttu-id="bb6c2-205">Relações</span><span class="sxs-lookup"><span data-stu-id="bb6c2-205">Relationships</span></span>  
 <span data-ttu-id="bb6c2-206">Para obter um desempenho otimizado da consulta, você deverá definir relacionamentos entre as entidades como associações no modelo de entidade e como relacionamentos lógicos na fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-206">For optimal query performance, you must define relationships between entities both as associations in the entity model and as logical relationships in the data source.</span></span>  
  
### <a name="query-paths"></a><span data-ttu-id="bb6c2-207">Caminhos de consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-207">Query Paths</span></span>  
 <span data-ttu-id="bb6c2-208">Por padrão, quando você executa um <xref:System.Data.Objects.ObjectQuery%601>, os objetos relacionados não são retornados (embora os objetos que representam as próprias relações sejam).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-208">By default, when you execute an <xref:System.Data.Objects.ObjectQuery%601>, related objects are not returned (although objects that represent the relationships themselves are).</span></span> <span data-ttu-id="bb6c2-209">Você pode carregar os objetos relacionados de uma das três maneiras:</span><span class="sxs-lookup"><span data-stu-id="bb6c2-209">You can load related objects in one of three ways:</span></span>  
  
1.  <span data-ttu-id="bb6c2-210">Defina o caminho de consulta antes que <xref:System.Data.Objects.ObjectQuery%601> seja executado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-210">Set the query path before the <xref:System.Data.Objects.ObjectQuery%601> is executed.</span></span>  
  
2.  <span data-ttu-id="bb6c2-211">Chame o método `Load` na propriedade de navegação que o objeto expõe.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-211">Call the `Load` method on the navigation property that the object exposes.</span></span>  
  
3.  <span data-ttu-id="bb6c2-212">Defina a opção <xref:System.Data.Objects.ObjectContextOptions.LazyLoadingEnabled%2A> no <xref:System.Data.Objects.ObjectContext> como `true`.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-212">Set the <xref:System.Data.Objects.ObjectContextOptions.LazyLoadingEnabled%2A> option on the <xref:System.Data.Objects.ObjectContext> to `true`.</span></span> <span data-ttu-id="bb6c2-213">Observe que isso é feito automaticamente quando você gera o código da camada de objeto com o [Entity Data Model Designer](http://msdn.microsoft.com/library/4ccd7ad6-b934-4f7c-82a0-cfd2d4a95faf).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-213">Note that this is done automatically when you generate object-layer code with the [Entity Data Model Designer](http://msdn.microsoft.com/library/4ccd7ad6-b934-4f7c-82a0-cfd2d4a95faf).</span></span> <span data-ttu-id="bb6c2-214">Para obter mais informações, consulte [visão geral de código gerado](http://msdn.microsoft.com/library/6a88ea38-6a90-4107-bc33-531b79ce5b6a).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-214">For more information see [Generated Code Overview](http://msdn.microsoft.com/library/6a88ea38-6a90-4107-bc33-531b79ce5b6a).</span></span>  
  
 <span data-ttu-id="bb6c2-215">Quando você considera qual opção usar, esteja ciente de que há uma escolha entre o número de solicitações no banco de dados e a quantidade de dados retornados em uma única consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-215">When you consider which option to use, be aware that there is a tradeoff between the number of requests against the database and the amount of data returned in a single query.</span></span> <span data-ttu-id="bb6c2-216">Para obter mais informações, consulte [objetos relacionados ao carregar](http://msdn.microsoft.com/library/452347d2-7b3b-44cd-9001-231299a28cb1).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-216">For more information, see [Loading Related Objects](http://msdn.microsoft.com/library/452347d2-7b3b-44cd-9001-231299a28cb1).</span></span>  
  
#### <a name="using-query-paths"></a><span data-ttu-id="bb6c2-217">Usando caminhos de consulta</span><span class="sxs-lookup"><span data-stu-id="bb6c2-217">Using query paths</span></span>  
 <span data-ttu-id="bb6c2-218">Os caminhos de consulta definem o gráfico de objetos que uma consulta retorna.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-218">Query paths define the graph of objects that a query returns.</span></span> <span data-ttu-id="bb6c2-219">Quando você define um caminho de consulta, somente uma única solicitação no banco de dados é necessária para retornar todos os objetos que o caminho define.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-219">When you define a query path, only a single request against the database is required to return all objects that the path defines.</span></span> <span data-ttu-id="bb6c2-220">Usar caminhos de consulta pode fazer comandos complexos serem executados na fonte de dados de consultas de objetos aparentemente simples.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-220">Using query paths can result in complex commands being executed against the data source from seemingly simple object queries.</span></span> <span data-ttu-id="bb6c2-221">Isso ocorre porque uma ou mais junções são necessárias para retornar objetos relacionados em uma única consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-221">This occurs because one or more joins are required to return related objects in a single query.</span></span> <span data-ttu-id="bb6c2-222">Esta complexidade é maior em consultas em um modelo complexo de entidade, como uma entidade com herança ou um caminho que inclui relações muitos-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-222">This complexity is greater in queries against a complex entity model, such as an entity with inheritance or a path that includes many-to-many relationships.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bb6c2-223">Use o método <xref:System.Data.Objects.ObjectQuery.ToTraceString%2A> para ver o comando que será gerado por um <xref:System.Data.Objects.ObjectQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-223">Use the <xref:System.Data.Objects.ObjectQuery.ToTraceString%2A> method to see the command that will be generated by an <xref:System.Data.Objects.ObjectQuery%601>.</span></span> <span data-ttu-id="bb6c2-224">Para obter mais informações, consulte [como: exibir os comandos de armazenamento](http://msdn.microsoft.com/library/f9771c6e-3b62-4b24-a5d4-55d68e14fa79).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-224">For more information, see [How to: View the Store Commands](http://msdn.microsoft.com/library/f9771c6e-3b62-4b24-a5d4-55d68e14fa79).</span></span>  
  
 <span data-ttu-id="bb6c2-225">Quando um caminho de consulta inclui muitos objetos relacionados ou os objetos contêm muitos dados de linha, a fonte de dados pode ser incapaz de concluir a consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-225">When a query path includes too many related objects or the objects contain too much row data, the data source might be unable to complete the query.</span></span> <span data-ttu-id="bb6c2-226">Isso ocorre se a consulta exigir um armazenamento temporário intermediário que excede os recursos da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-226">This occurs if the query requires intermediate temporary storage that exceeds the capabilities of the data source.</span></span> <span data-ttu-id="bb6c2-227">Quando isso ocorre, você pode reduzir a complexidade da consulta da fonte de dados explicitamente carregando objetos relacionados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-227">When this occurs, you can reduce the complexity of the data source query by explicitly loading related objects.</span></span>  
  
#### <a name="explicitly-loading-related-objects"></a><span data-ttu-id="bb6c2-228">Carregando objetos relacionados explicitamente</span><span class="sxs-lookup"><span data-stu-id="bb6c2-228">Explicitly loading related objects</span></span>  
 <span data-ttu-id="bb6c2-229">Você pode carregar objetos relacionados explicitamente chamando o método `Load` em uma propriedade de navegação que retorna um <xref:System.Data.Objects.DataClasses.EntityCollection%601> ou <xref:System.Data.Objects.DataClasses.EntityReference%601>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-229">You can explicitly load related objects by calling the `Load` method on a navigation property that returns an <xref:System.Data.Objects.DataClasses.EntityCollection%601> or <xref:System.Data.Objects.DataClasses.EntityReference%601>.</span></span> <span data-ttu-id="bb6c2-230">Carregar objetos explicitamente exige uma viagem de ida e volta ao banco de dados toda vez que `Load` é chamado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-230">Explicitly loading objects requires a round-trip to the database every time `Load` is called.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bb6c2-231">Se você chamar `Load` enquanto está executando um loop em uma coleção de objetos retornados, como quando você usar a instrução `foreach` (`For Each` no Visual Basic), o provedor específico da fonte de dados deverá dar suporte a vários conjuntos de resultados ativos em uma única conexão.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-231">if you call `Load` while looping through a collection of returned objects, such as when you use the `foreach` statement (`For Each` in Visual Basic), the data source-specific provider must support multiple active results sets on a single connection.</span></span> <span data-ttu-id="bb6c2-232">Para um banco de dados do SQL Server, você deverá especificar um valor `MultipleActiveResultSets = true` na cadeia de conexão do provedor.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-232">For a SQL Server database, you must specify a value of `MultipleActiveResultSets = true` in the provider connection string.</span></span>  
  
 <span data-ttu-id="bb6c2-233">Você também pode usar o método <xref:System.Data.Objects.ObjectContext.LoadProperty%2A> quando não há nenhuma propriedade <xref:System.Data.Objects.DataClasses.EntityCollection%601> ou <xref:System.Data.Objects.DataClasses.EntityReference%601> em entidades.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-233">You can also use the <xref:System.Data.Objects.ObjectContext.LoadProperty%2A> method when there is no <xref:System.Data.Objects.DataClasses.EntityCollection%601> or <xref:System.Data.Objects.DataClasses.EntityReference%601> properties on entities.</span></span> <span data-ttu-id="bb6c2-234">Isso é útil quando você está usando as entidades de POCO.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-234">This is useful when you are using POCO entities.</span></span>  
  
 <span data-ttu-id="bb6c2-235">Embora carregar objetos relacionados explicitamente reduza o número de junções e diminua a quantidade de dados redundantes, `Load` exige conexões repetidas ao banco de dados, o que podem se tornar caro ao carregar explicitamente um grande número de objetos.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-235">Although explicitly loading related objects will reduce the number of joins and reduced the amount of redundant data, `Load` requires repeated connections to the database, which can become costly when explicitly loading a large number of objects.</span></span>  
  
### <a name="saving-changes"></a><span data-ttu-id="bb6c2-236">Salvando alterações</span><span class="sxs-lookup"><span data-stu-id="bb6c2-236">Saving Changes</span></span>  
 <span data-ttu-id="bb6c2-237">Quando você chama o método <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> em um <xref:System.Data.Objects.ObjectContext>, um comando create, update ou delete é gerado para cada objeto adicionado, atualizado ou excluído no contexto.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-237">When you call the <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> method on an <xref:System.Data.Objects.ObjectContext>, a separate create, update, or delete command is generated for every added, updated, or deleted object in the context.</span></span> <span data-ttu-id="bb6c2-238">Esses comandos são executados na fonte de dados em uma única transação.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-238">These commands are executed on the data source in a single transaction.</span></span> <span data-ttu-id="bb6c2-239">Assim como ocorre com as consultas, o desempenho de operações create, update e delete dependem da complexidade do mapeamento no modelo conceitual.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-239">As with queries, the performance of create, update, and delete operations depends on the complexity of the mapping in the conceptual model.</span></span>  
  
### <a name="distributed-transactions"></a><span data-ttu-id="bb6c2-240">Transações distribuídas</span><span class="sxs-lookup"><span data-stu-id="bb6c2-240">Distributed Transactions</span></span>  
 <span data-ttu-id="bb6c2-241">As operações em uma transação explícita que exigem recursos que são gerenciados pelo coordenador de transações distribuídas (DTC) serão muito mais caras que uma operação semelhante que não exige DTC.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-241">Operations in an explicit transaction that require resources that are managed by the distributed transaction coordinator (DTC) will be much more expensive than a similar operation that does not require the DTC.</span></span> <span data-ttu-id="bb6c2-242">A promoção para o DTC ocorrerá nas seguintes situações:</span><span class="sxs-lookup"><span data-stu-id="bb6c2-242">Promotion to the DTC will occur in the following situations:</span></span>  
  
-   <span data-ttu-id="bb6c2-243">Uma transação explícita com uma operação em um banco de dados do SQL Server 2000 ou outra fonte de dados que sempre promova transações explícitas para o DTC.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-243">An explicit transaction with an operation against a SQL Server 2000 database or other data source that always promote explicit transactions to the DTC.</span></span>  
  
-   <span data-ttu-id="bb6c2-244">Uma transação explícita com uma operação no SQL Server 2005 quando a conexão é gerenciada pelo [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bb6c2-244">An explicit transaction with an operation against SQL Server 2005 when the connection is managed by the [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].</span></span> <span data-ttu-id="bb6c2-245">Isso ocorre porque o SQL Server 2005 promove para um DTC sempre que uma conexão é fechada e reaberta dentro de uma única transação, que é o comportamento padrão do [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bb6c2-245">This occurs because SQL Server 2005 promotes to a DTC whenever a connection is closed and reopened within a single transaction, which is the default behavior of the [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].</span></span> <span data-ttu-id="bb6c2-246">Esta promoção de DTC não ocorrer ao usar o SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-246">This DTC promotion does not occur when using SQL Server 2008.</span></span> <span data-ttu-id="bb6c2-247">Para evitar esta promoção ao usar o SQL Server 2005, você deve explicitamente abrir e fechar a conexão na transação.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-247">To avoid this promotion when using SQL Server 2005, you must explicitly open and close the connection within the transaction.</span></span> <span data-ttu-id="bb6c2-248">Para obter mais informações, consulte [Gerenciando conexões e transações](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-248">For more information, see [Managing Connections and Transactions](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span></span>  
  
 <span data-ttu-id="bb6c2-249">Uma transação explícita é usada quando uma ou mais operações são executadas dentro de uma transação <xref:System.Transactions>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-249">An explicit transaction is used when one or more operations are executed inside a <xref:System.Transactions> transaction.</span></span> <span data-ttu-id="bb6c2-250">Para obter mais informações, consulte [Gerenciando conexões e transações](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-250">For more information, see [Managing Connections and Transactions](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span></span>  
  
## <a name="strategies-for-improving-performance"></a><span data-ttu-id="bb6c2-251">Estratégias para melhorar o desempenho</span><span class="sxs-lookup"><span data-stu-id="bb6c2-251">Strategies for Improving Performance</span></span>  
 <span data-ttu-id="bb6c2-252">Você pode melhorar o desempenho geral das consultas no Entity Framework usando as seguintes estratégias.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-252">You can improve the overall performance of queries in the Entity Framework by using the following strategies.</span></span>  
  
#### <a name="pre-generate-views"></a><span data-ttu-id="bb6c2-253">Pré-gerar exibições</span><span class="sxs-lookup"><span data-stu-id="bb6c2-253">Pre-generate views</span></span>  
 <span data-ttu-id="bb6c2-254">Gerar exibições com base em um modelo de entidade é um custo significativo na primeira vez que um aplicativo executa uma consulta.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-254">Generating views based on an entity model is a significant cost the first time that an application executes a query.</span></span> <span data-ttu-id="bb6c2-255">Use o utilitário EdmGen.exe para pré-gerar exibições como um arquivo de código do Visual Basic ou C# que pode ser adicionado ao projeto durante o design.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-255">Use the EdmGen.exe utility to pre-generate views as a Visual Basic or C# code file that can be added to the project during design.</span></span> <span data-ttu-id="bb6c2-256">Você também pode usar o Kit de ferramentas de transformação do modelo de texto para gerar exibições pré-compiladas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-256">You could also use the Text Template Transformation Toolkit to generate pre-compiled views.</span></span> <span data-ttu-id="bb6c2-257">Exibições pré-geradas são validadas em tempo de execução para garantir que sejam consistentes com a versão atual do modelo de entidade especificado.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-257">Pre-generated views are validated at runtime to ensure that they are consistent with the current version of the specified entity model.</span></span> <span data-ttu-id="bb6c2-258">Para obter mais informações, consulte [como: Pre-Generate exibições para melhorar o desempenho da consulta](http://msdn.microsoft.com/library/b18a9d16-e10b-4043-ba91-b632f85a2579) e [isolamento de desempenho com pré-compilado/pré-generated exibições no Entity Framework 4](http://go.microsoft.com/fwlink/?LinkID=201337&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-258">For more information, see [How to: Pre-Generate Views to Improve Query Performance](http://msdn.microsoft.com/library/b18a9d16-e10b-4043-ba91-b632f85a2579) and [Isolating Performance with Precompiled/Pre-generated Views in the Entity Framework 4](http://go.microsoft.com/fwlink/?LinkID=201337&clcid=0x409).</span></span>  
  
 <span data-ttu-id="bb6c2-259">Ao trabalhar com modelos muito grandes, a consideração a seguir se aplica:</span><span class="sxs-lookup"><span data-stu-id="bb6c2-259">When working with very large models, the following consideration applies:</span></span>  
  
 <span data-ttu-id="bb6c2-260">O formato de metadados do .NET limita o número de caracteres de uma cadeia de caracteres de usuário em um determinado binário a 16.777.215 (0xFFFFFF).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-260">The .NET metadata format limits the number of user string characters in a given binary to 16,777,215 (0xFFFFFF).</span></span> <span data-ttu-id="bb6c2-261">Se você estiver gerando modos de exibição para um modelo muito grande e o arquivo de exibição atingir esse limite de tamanho, você obterá a "nenhum espaço lógico deixado para criar mais cadeias de caracteres do usuário."</span><span class="sxs-lookup"><span data-stu-id="bb6c2-261">If you are generating views for a very large model and the view file reaches this size limit, you will get the "No logical space left to create more user strings."</span></span> <span data-ttu-id="bb6c2-262">Erro de compilação.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-262">compile error.</span></span> <span data-ttu-id="bb6c2-263">Essa limitação de tamanho aplica-se a todos os binários gerenciados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-263">This size limitation applies to all managed binaries.</span></span> <span data-ttu-id="bb6c2-264">Para obter mais informações, consulte o [blog](http://go.microsoft.com/fwlink/?LinkId=201476) que demonstra como evitar o erro ao trabalhar com modelos grandes e complexos.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-264">For more information see the [blog](http://go.microsoft.com/fwlink/?LinkId=201476) that demonstrates how to avoid the error when working with large and complex models.</span></span>  
  
#### <a name="consider-using-the-notracking-merge-option-for-queries"></a><span data-ttu-id="bb6c2-265">Use a opção de mesclagem NoTracking para consultas</span><span class="sxs-lookup"><span data-stu-id="bb6c2-265">Consider using the NoTracking merge option for queries</span></span>  
 <span data-ttu-id="bb6c2-266">Há um custo necessário para controlar objetos retornados no contexto do objeto.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-266">There is a cost required to track returned objects in the object context.</span></span> <span data-ttu-id="bb6c2-267">Detectar alterações aos objetos e garantir que as várias solicitações para a mesma entidade lógica retorne a mesma instância de objeto exige que os objetos sejam anexados a uma instância <xref:System.Data.Objects.ObjectContext>.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-267">Detecting changes to objects and ensuring that multiple requests for the same logical entity return the same object instance requires that objects be attached to an <xref:System.Data.Objects.ObjectContext> instance.</span></span> <span data-ttu-id="bb6c2-268">Se você não pretende fazer atualizações ou exclusões em objetos e não exige o gerenciamento de identidade, use as opções de mesclagem <xref:System.Data.Objects.MergeOption.NoTracking> ao executar consultas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-268">If you do not plan to make updates or deletes to objects and do not require identity management , consider using the <xref:System.Data.Objects.MergeOption.NoTracking> merge options when you execute queries.</span></span>  
  
#### <a name="return-the-correct-amount-of-data"></a><span data-ttu-id="bb6c2-269">Retornar a quantidade correta de dados</span><span class="sxs-lookup"><span data-stu-id="bb6c2-269">Return the correct amount of data</span></span>  
 <span data-ttu-id="bb6c2-270">Em alguns cenários, especificar um caminho de consulta usando o método <xref:System.Data.Objects.ObjectQuery%601.Include%2A> é muito mais rápido porque exige menos viagens de ida e volta para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-270">In some scenarios, specifying a query path using the <xref:System.Data.Objects.ObjectQuery%601.Include%2A> method is much faster because it requires fewer round trips to the database.</span></span> <span data-ttu-id="bb6c2-271">No entanto, em outros cenários, as viagens de ida e volta adicionais ao banco de dados para carregar objetos relacionados podem ser mais rápidas porque as consultas mais simples com menos junções resultam em menos redundância de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-271">However, in other scenarios, additional round trips to the database to load related objects may be faster because the simpler queries with fewer joins result in less redundancy of data.</span></span> <span data-ttu-id="bb6c2-272">Por causa disso, recomendamos que você testar o desempenho de várias maneiras para recuperar objetos relacionados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-272">Because of this, we recommend that you test the performance of various ways to retrieve related objects.</span></span> <span data-ttu-id="bb6c2-273">Para obter mais informações, consulte [objetos relacionados ao carregar](http://msdn.microsoft.com/library/452347d2-7b3b-44cd-9001-231299a28cb1).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-273">For more information, see [Loading Related Objects](http://msdn.microsoft.com/library/452347d2-7b3b-44cd-9001-231299a28cb1).</span></span>  
  
 <span data-ttu-id="bb6c2-274">Para evitar retornar dados demais em uma única consulta, pagine os resultados da consulta em grupos mais gerenciáveis.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-274">To avoid returning too much data in a single query, consider paging the results of the query into more manageable groups.</span></span> <span data-ttu-id="bb6c2-275">Para obter mais informações, consulte [como: página por meio de resultados da consulta](http://msdn.microsoft.com/library/ffc0f920-e7de-42e0-9b12-ef356421d030).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-275">For more information, see [How to: Page Through Query Results](http://msdn.microsoft.com/library/ffc0f920-e7de-42e0-9b12-ef356421d030).</span></span>  
  
#### <a name="limit-the-scope-of-the-objectcontext"></a><span data-ttu-id="bb6c2-276">Limitar o escopo do ObjectContext</span><span class="sxs-lookup"><span data-stu-id="bb6c2-276">Limit the scope of the ObjectContext</span></span>  
 <span data-ttu-id="bb6c2-277">Na maioria dos casos, você deverá criar uma instância <xref:System.Data.Objects.ObjectContext> dentro de uma instrução `using` (`Using…End Using` no Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-277">In most cases, you should create an <xref:System.Data.Objects.ObjectContext> instance within a `using` statement (`Using…End Using` in Visual Basic).</span></span> <span data-ttu-id="bb6c2-278">Isso poderá aumentar o desempenho garantindo que os recursos associados com o contexto do objeto sejam descartados automaticamente quando o código sair do bloco de instruções.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-278">This can increase performance by ensuring that the resources associated with the object context are disposed automatically when the code exits the statement block.</span></span> <span data-ttu-id="bb6c2-279">No entanto, quando os controles estão associados a objetos gerenciados pelo contexto do objeto, a instância <xref:System.Data.Objects.ObjectContext> deve ser mantida contanto que a associação seja necessária e descartada manualmente.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-279">However, when controls are bound to objects managed by the object context, the <xref:System.Data.Objects.ObjectContext> instance should be maintained as long as the binding is needed and disposed of manually.</span></span> <span data-ttu-id="bb6c2-280">Para obter mais informações, consulte [Gerenciando conexões e transações](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-280">For more information, see [Managing Connections and Transactions](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span></span>  
  
#### <a name="consider-opening-the-database-connection-manually"></a><span data-ttu-id="bb6c2-281">Abrir a conexão de banco de dados manualmente</span><span class="sxs-lookup"><span data-stu-id="bb6c2-281">Consider opening the database connection manually</span></span>  
 <span data-ttu-id="bb6c2-282">Quando seu aplicativo executa uma série de consultas de objeto ou frequentemente chama <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> para manter criar, atualizar e excluir operações para a fonte de dados, o [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] continuamente deve abrir e fechar a conexão à fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-282">When your application executes a series of object queries or frequently calls <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> to persist create, update, and delete operations to the data source, the [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] must continuously open and close the connection to the data source.</span></span> <span data-ttu-id="bb6c2-283">Nessas situações, abra manualmente a conexão no início dessas operações e feche ou descarte a conexão quando as operações estiverem concluídas.</span><span class="sxs-lookup"><span data-stu-id="bb6c2-283">In these situations, consider manually opening the connection at the start of these operations and either closing or disposing of the connection when the operations are complete.</span></span> <span data-ttu-id="bb6c2-284">Para obter mais informações, consulte [Gerenciando conexões e transações](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span><span class="sxs-lookup"><span data-stu-id="bb6c2-284">For more information, see [Managing Connections and Transactions](http://msdn.microsoft.com/library/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).</span></span>  
  
## <a name="performance-data"></a><span data-ttu-id="bb6c2-285">Dados de Desempenho</span><span class="sxs-lookup"><span data-stu-id="bb6c2-285">Performance Data</span></span>  
 <span data-ttu-id="bb6c2-286">Alguns dados de desempenho para o Entity Framework são publicados no seguintes postagens no [blog da equipe do ADO.NET](http://go.microsoft.com/fwlink/?LinkId=91905):</span><span class="sxs-lookup"><span data-stu-id="bb6c2-286">Some performance data for the Entity Framework is published in the following posts on the [ADO.NET team blog](http://go.microsoft.com/fwlink/?LinkId=91905):</span></span>  
  
-   [<span data-ttu-id="bb6c2-287">Explorando o desempenho do ADO.NET Entity Framework - parte 1</span><span class="sxs-lookup"><span data-stu-id="bb6c2-287">Exploring the Performance of the ADO.NET Entity Framework - Part 1</span></span>](http://go.microsoft.com/fwlink/?LinkId=123907)  
  
-   [<span data-ttu-id="bb6c2-288">Explorando o desempenho do ADO.NET Entity Framework – parte 2</span><span class="sxs-lookup"><span data-stu-id="bb6c2-288">Exploring the Performance of the ADO.NET Entity Framework – Part 2</span></span>](http://go.microsoft.com/fwlink/?LinkId=123909)  
  
-   [<span data-ttu-id="bb6c2-289">Comparação de desempenho do ADO.NET Entity Framework</span><span class="sxs-lookup"><span data-stu-id="bb6c2-289">ADO.NET Entity Framework Performance Comparison</span></span>](http://go.microsoft.com/fwlink/?LinkID=123913)  
  
## <a name="see-also"></a><span data-ttu-id="bb6c2-290">Consulte também</span><span class="sxs-lookup"><span data-stu-id="bb6c2-290">See Also</span></span>  
 [<span data-ttu-id="bb6c2-291">Considerações de desenvolvimento e implantação</span><span class="sxs-lookup"><span data-stu-id="bb6c2-291">Development and Deployment Considerations</span></span>](../../../../../docs/framework/data/adonet/ef/development-and-deployment-considerations.md)
