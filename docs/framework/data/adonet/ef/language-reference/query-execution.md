---
title: Execução da Consulta
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: c0e6cf23-63ac-47dd-bfe9-d5bdca826fac
ms.openlocfilehash: f152146e7483c6b3c162fd81f20f359e6c82123a
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/07/2018
ms.locfileid: "33804814"
---
# <a name="query-execution"></a><span data-ttu-id="a1d57-102">Execução da Consulta</span><span class="sxs-lookup"><span data-stu-id="a1d57-102">Query Execution</span></span>
<span data-ttu-id="a1d57-103">Depois de ser criada por um usuário, uma consulta LINQ é convertida em uma árvore de comando.</span><span class="sxs-lookup"><span data-stu-id="a1d57-103">After a LINQ query is created by a user, it is converted to a command tree.</span></span> <span data-ttu-id="a1d57-104">Uma árvore de comando é uma representação de uma consulta compatível com o Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a1d57-104">A command tree is a representation of a query that is compatible with the Entity Framework.</span></span> <span data-ttu-id="a1d57-105">Em seguida, a árvore de comando é executada na fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a1d57-105">The command tree is then executed against the data source.</span></span> <span data-ttu-id="a1d57-106">Em tempo de execução de consulta, todas as expressões e consulta (isto é, todos os componentes da consulta) são avaliados, incluindo essas expressões usadas na materialização do resultado.</span><span class="sxs-lookup"><span data-stu-id="a1d57-106">At query execution time, all query expressions (that is, all components of the query) are evaluated, including those expressions that are used in result materialization.</span></span>  
  
 <span data-ttu-id="a1d57-107">O ponto onde as expressões de consulta são executadas pode variar.</span><span class="sxs-lookup"><span data-stu-id="a1d57-107">At what point query expressions are executed can vary.</span></span> <span data-ttu-id="a1d57-108">As consultas LINQ são sempre executadas quando a variável de consulta é iterada sobre, não quando a variável de consulta é criada.</span><span class="sxs-lookup"><span data-stu-id="a1d57-108">LINQ queries are always executed when the query variable is iterated over, not when the query variable is created.</span></span> <span data-ttu-id="a1d57-109">Isso é chamado de *execução diferida*.</span><span class="sxs-lookup"><span data-stu-id="a1d57-109">This is called *deferred execution*.</span></span> <span data-ttu-id="a1d57-110">Você também pode forçar a execução imediata de uma consulta, o que é útil para armazenar os resultados da consulta em cache.</span><span class="sxs-lookup"><span data-stu-id="a1d57-110">You can also force a query to execute immediately, which is useful for caching query results.</span></span> <span data-ttu-id="a1d57-111">Isso é descrito mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="a1d57-111">This is described later in this topic.</span></span>  
  
 <span data-ttu-id="a1d57-112">Quando uma consulta LINQ to Entities é executada, algumas expressões da consulta podem ser executadas no servidor e algumas partes podem ser executadas localmente no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-112">When a LINQ to Entities query is executed, some expressions in the query might be executed on the server and some parts might be executed locally on the client.</span></span> <span data-ttu-id="a1d57-113">A avaliação de uma expressão do lado do cliente ocorre antes de a consulta ser executada no servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-113">Client-side evaluation of an expression takes place before the query is executed on the server.</span></span> <span data-ttu-id="a1d57-114">Se uma expressão for avaliada no cliente, o resultado da avaliação será substituído para a expressão na consulta, e a consulta será executada no servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-114">If an expression is evaluated on the client, the result of that evaluation is substituted for the expression in the query, and the query is then executed on the server.</span></span> <span data-ttu-id="a1d57-115">Como as consultas são executadas na fonte de dados, a configuração da fonte de dados substitui o comportamento especificado no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-115">Because queries are executed on the data source, the data source configuration overrides the behavior specified in the client.</span></span> <span data-ttu-id="a1d57-116">Por exemplo, manipulação de valor nulo e a precisão numérica dependem das configurações do servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-116">For example, null value handling and numerical precision depend on the server settings.</span></span> <span data-ttu-id="a1d57-117">Todas as exceções geradas durante a execução da consulta no servidor são passadas diretamente até o cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-117">Any exceptions thrown during query execution on the server are passed directly up to the client.</span></span>  
 
> [!TIP]
> <span data-ttu-id="a1d57-118">Para obter um resumo conveniente de operadores de consulta em formato de tabela, que permite que você identifique rapidamente o comportamento de execução de um operador, consulte [classificação de operadores de consulta padrão por modo de execução (c#)](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span><span class="sxs-lookup"><span data-stu-id="a1d57-118">For a convenient summary of query operators in table format, which lets you quickly identify an operator's execution behavior, see [Classification of Standard Query Operators by Manner of Execution (C#)](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span></span>

## <a name="deferred-query-execution"></a><span data-ttu-id="a1d57-119">Execução de consulta adiada</span><span class="sxs-lookup"><span data-stu-id="a1d57-119">Deferred query execution</span></span>  
 <span data-ttu-id="a1d57-120">Em uma consulta, que retorna uma sequência de valores, a variável de consulta nunca contém os resultados da consulta e armazena somente os comandos da consulta.</span><span class="sxs-lookup"><span data-stu-id="a1d57-120">In a query that returns a sequence of values, the query variable itself never holds the query results and only stores the query commands.</span></span> <span data-ttu-id="a1d57-121">A execução da consulta é adiada até que a variável da consulta seja iterada em um loop `foreach` ou `For Each`.</span><span class="sxs-lookup"><span data-stu-id="a1d57-121">Execution of the query is deferred until the query variable is iterated over in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="a1d57-122">Isso é conhecido como *execução diferida*; ou seja, a consulta a execução ocorre algum tempo depois que a consulta é construída.</span><span class="sxs-lookup"><span data-stu-id="a1d57-122">This is known as *deferred execution*; that is, query execution occurs some time after the query is constructed.</span></span> <span data-ttu-id="a1d57-123">Isso significa que você pode executar uma consulta com a frequência que desejar.</span><span class="sxs-lookup"><span data-stu-id="a1d57-123">This means that you can execute a query as frequently as you want to.</span></span> <span data-ttu-id="a1d57-124">Isso é útil quando, por exemplo, você tem um banco de dados que está sendo atualizado por outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="a1d57-124">This is useful when, for example, you have a database that is being updated by other applications.</span></span> <span data-ttu-id="a1d57-125">Em seu aplicativo, você pode criar uma consulta para recuperar as informações mais recentes e executar a consulta repetidamente, retornando informações atualizadas sempre.</span><span class="sxs-lookup"><span data-stu-id="a1d57-125">In your application, you can create a query to retrieve the latest information and repeatedly execute the query, returning the updated information every time.</span></span>  
  
 <span data-ttu-id="a1d57-126">A execução adiada permite que várias consultas sejam combinadas ou que uma consulta seja estendida.</span><span class="sxs-lookup"><span data-stu-id="a1d57-126">Deferred execution enables multiple queries to be combined or a query to be extended.</span></span> <span data-ttu-id="a1d57-127">Quando é estendida, a consulta é modificada para incluir as novas operações, e a execução eventual refletirá as alterações.</span><span class="sxs-lookup"><span data-stu-id="a1d57-127">When a query is extended, it is modified to include the new operations, and the eventual execution will reflect the changes.</span></span> <span data-ttu-id="a1d57-128">No exemplo a seguir, a primeira consulta retorna todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="a1d57-128">In the following example, the first query returns all the products.</span></span> <span data-ttu-id="a1d57-129">A segunda consulta estende a primeira usando `Where` para retornar todos os produtos de tamanho “L”:</span><span class="sxs-lookup"><span data-stu-id="a1d57-129">The second query extends the first by using `Where` to return all the products of size "L":</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#composing1)]
 [!code-vb[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#composing1)]  
  
 <span data-ttu-id="a1d57-130">Depois que uma consulta foi executada, todas as consultas sucessivas usarão os operadores LINQ na memória.</span><span class="sxs-lookup"><span data-stu-id="a1d57-130">After a query has been executed all successive queries will use the in-memory LINQ operators.</span></span> <span data-ttu-id="a1d57-131">Iterar sobre a variável de consulta usando uma instrução `foreach` ou `For Each` ou chamando um dos operadores de conversão LINQ fará com que a execução seja imediata.</span><span class="sxs-lookup"><span data-stu-id="a1d57-131">Iterating over the query variable by using a `foreach` or `For Each` statement or by calling one of the LINQ conversion operators will cause immediate execution.</span></span> <span data-ttu-id="a1d57-132">Esses operadores de conversão incluem: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A> e <xref:System.Linq.Enumerable.ToDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="a1d57-132">These conversion operators include the following: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A>, and <xref:System.Linq.Enumerable.ToDictionary%2A>.</span></span>  
  
## <a name="immediate-query-execution"></a><span data-ttu-id="a1d57-133">Execução imediata de consulta</span><span class="sxs-lookup"><span data-stu-id="a1d57-133">Immediate Query Execution</span></span>  
 <span data-ttu-id="a1d57-134">Em comparação com a execução adiada de consultas que geram uma sequência de valores, as consultas que retornam um valor singleton são executadas imediatamente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-134">In contrast to the deferred execution of queries that produce a sequence of values, queries that return a singleton value are executed immediately.</span></span> <span data-ttu-id="a1d57-135">Alguns exemplos de consultas singleton são <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A> e <xref:System.Linq.Enumerable.Max%2A>.</span><span class="sxs-lookup"><span data-stu-id="a1d57-135">Some examples of singleton queries are <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A>, and <xref:System.Linq.Enumerable.Max%2A>.</span></span> <span data-ttu-id="a1d57-136">Essas consultas são executadas imediatamente porque a consulta deve gerar uma sequência para calcular o resultado singleton.</span><span class="sxs-lookup"><span data-stu-id="a1d57-136">These execute immediately because the query must produce a sequence to calculate the singleton result.</span></span> <span data-ttu-id="a1d57-137">Você também pode forçar a execução imediata.</span><span class="sxs-lookup"><span data-stu-id="a1d57-137">You can also force immediate execution.</span></span> <span data-ttu-id="a1d57-138">Isso é útil quando você deseja armazenar os resultados de uma consulta em cache.</span><span class="sxs-lookup"><span data-stu-id="a1d57-138">This is useful when you want to cache the results of a query.</span></span> <span data-ttu-id="a1d57-139">Para forçar a execução imediata de uma consulta que não produz um valor singleton, você pode chamar o método <xref:System.Linq.Enumerable.ToList%2A>, o método <xref:System.Linq.Enumerable.ToDictionary%2A> ou o método <xref:System.Linq.Enumerable.ToArray%2A> em uma consulta ou em uma variável de consulta.</span><span class="sxs-lookup"><span data-stu-id="a1d57-139">To force immediate execution of a query that does not produce a singleton value, you can call the <xref:System.Linq.Enumerable.ToList%2A> method, the <xref:System.Linq.Enumerable.ToDictionary%2A> method, or the <xref:System.Linq.Enumerable.ToArray%2A> method on a query or query variable.</span></span> <span data-ttu-id="a1d57-140">O exemplo a seguir usa o método <xref:System.Linq.Enumerable.ToArray%2A> para avaliar imediatamente uma sequência em uma matriz.</span><span class="sxs-lookup"><span data-stu-id="a1d57-140">The following example uses the <xref:System.Linq.Enumerable.ToArray%2A> method to immediately evaluate a sequence into an array.</span></span>  
  
 [!code-csharp[DP L2E Examples#ToArray](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#toarray)]
 [!code-vb[DP L2E Examples#ToArray](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#toarray)]  
  
 <span data-ttu-id="a1d57-141">Você também pode forçar a execução colocando o loop `foreach` ou `For Each` imediatamente após a expressão da consulta, mas chamando <xref:System.Linq.Enumerable.ToList%2A> ou <xref:System.Linq.Enumerable.ToArray%2A> você armazena em cache todos os dados em um único objeto de coleção.</span><span class="sxs-lookup"><span data-stu-id="a1d57-141">You could also force execution by putting the `foreach` or `For Each` loop immediately after the query expression, but by calling <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> you cache all the data in a single collection object.</span></span>  
  
## <a name="store-execution"></a><span data-ttu-id="a1d57-142">Execução de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a1d57-142">Store Execution</span></span>  
 <span data-ttu-id="a1d57-143">Em geral, as expressões no LINQ to Entities são avaliadas no servidor, e não se deve esperar que o comportamento da expressão siga a semântica do CLR (Common Language Runtime), mas sim a da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a1d57-143">In general, expressions in LINQ to Entities are evaluated on the server, and the behavior of the expression should not be expected to follow common language runtime (CLR) semantics, but those of the data source.</span></span> <span data-ttu-id="a1d57-144">No entanto, existem exceções, como quando a expressão é executada no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-144">There are exceptions to this, however, such as when the expression is executed on the client.</span></span> <span data-ttu-id="a1d57-145">Isso pode provocar resultados inesperados, por exemplo, quando o servidor e o cliente estão em fusos horários diferentes.</span><span class="sxs-lookup"><span data-stu-id="a1d57-145">This could cause unexpected results, for example when the server and client are in different time zones.</span></span>  
  
 <span data-ttu-id="a1d57-146">Algumas expressões da consulta podem ser executadas no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-146">Some expressions in the query might be executed on the client.</span></span> <span data-ttu-id="a1d57-147">Em geral, espera-se que a maior parte da execução da consulta ocorra no servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-147">In general, most query execution is expected to occur on the server.</span></span> <span data-ttu-id="a1d57-148">Com exceção dos métodos executados em elementos de consulta mapeados para a fonte de dados, frequentemente há expressões na consulta que podem ser executadas localmente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-148">Aside from methods executed against query elements mapped to the data source, there are often expressions in the query that can be executed locally.</span></span> <span data-ttu-id="a1d57-149">A execução local de uma expressão de consulta produz um valor que pode ser usado na execução da consulta ou na construção do resultado.</span><span class="sxs-lookup"><span data-stu-id="a1d57-149">Local execution of a query expression yields a value that can be used in the query execution or result construction.</span></span>  
  
 <span data-ttu-id="a1d57-150">Determinadas operações são sempre executadas no cliente, como a associação de valores, as subexpressões, as subconsultas de fechamentos e a materialização de objetos nos resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="a1d57-150">Certain operations are always executed on the client, such as binding of values, sub expressions, sub queries from closures, and materialization of objects into query results.</span></span> <span data-ttu-id="a1d57-151">O efeito líquido disso é que esses elementos (por exemplo, valores de parâmetros) não podem ser atualizados durante a execução.</span><span class="sxs-lookup"><span data-stu-id="a1d57-151">The net effect of this is that these elements (for example, parameter values) cannot be updated during the execution.</span></span> <span data-ttu-id="a1d57-152">Tipos anônimos também podem ser construídos embutidos na fonte de dados, mas não devem ser supostos a fazer isso.</span><span class="sxs-lookup"><span data-stu-id="a1d57-152">Anonymous types can be constructed inline on the data source, but should not be assumed to do so.</span></span> <span data-ttu-id="a1d57-153">Os agrupamentos embutidos podem ser construídos na fonte de dados, também, mas isso não deve ser suposto em cada instância.</span><span class="sxs-lookup"><span data-stu-id="a1d57-153">Inline groupings can be constructed in the data source, as well, but this should not be assumed in every instance.</span></span> <span data-ttu-id="a1d57-154">Em geral, é melhor não fazer nenhuma suposição sobre o que é construído no servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-154">In general, it is best not to make any assumptions about what is constructed on the server.</span></span>  
  
 <span data-ttu-id="a1d57-155">Esta seção descreve os cenários em que o código é executado localmente no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-155">This section describes the scenarios in which code is executed locally on the client.</span></span> <span data-ttu-id="a1d57-156">Para obter mais informações sobre quais tipos de expressões são executados localmente, consulte [expressões em consultas LINQ to Entities](../../../../../../docs/framework/data/adonet/ef/language-reference/expressions-in-linq-to-entities-queries.md).</span><span class="sxs-lookup"><span data-stu-id="a1d57-156">For more information about which types of expressions are executed locally, see [Expressions in LINQ to Entities Queries](../../../../../../docs/framework/data/adonet/ef/language-reference/expressions-in-linq-to-entities-queries.md).</span></span>  
  
### <a name="literals-and-parameters"></a><span data-ttu-id="a1d57-157">Literais e parâmetros</span><span class="sxs-lookup"><span data-stu-id="a1d57-157">Literals and Parameters</span></span>  
 <span data-ttu-id="a1d57-158">Variáveis locais, como a variável `orderID` no exemplo a seguir, são avaliadas no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-158">Local variables, such as the `orderID` variable in the following example, are evaluated on the client.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#literalparameter1)]
 [!code-vb[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#literalparameter1)]  
  
 <span data-ttu-id="a1d57-159">Os parâmetros do método também são avaliados no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-159">Method parameters are also evaluated on the client.</span></span> <span data-ttu-id="a1d57-160">O parâmetro `orderID` passado para o método `MethodParameterExample`, abaixo, é um exemplo.</span><span class="sxs-lookup"><span data-stu-id="a1d57-160">The `orderID` parameter passed into the `MethodParameterExample` method, below, is an example.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#methodparameterexample)]
 [!code-vb[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#methodparameterexample)]  
  
### <a name="casting-literals-on-the-client"></a><span data-ttu-id="a1d57-161">Literais de conversão no cliente</span><span class="sxs-lookup"><span data-stu-id="a1d57-161">Casting Literals on the Client</span></span>  
 <span data-ttu-id="a1d57-162">A conversão de `null` em um tipo CLR é executada no cliente:</span><span class="sxs-lookup"><span data-stu-id="a1d57-162">Casting from `null` to a CLR type is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#nullcasttostring)]
 [!code-vb[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#nullcasttostring)]  
  
 <span data-ttu-id="a1d57-163">A conversão em um tipo, como <xref:System.Decimal> anulável, é executada no cliente:</span><span class="sxs-lookup"><span data-stu-id="a1d57-163">Casting to a type, such as a nullable <xref:System.Decimal>, is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#casttonullable)]
 [!code-vb[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#casttonullable)]  
  
### <a name="constructors-for-literals"></a><span data-ttu-id="a1d57-164">Construtores de literais</span><span class="sxs-lookup"><span data-stu-id="a1d57-164">Constructors for Literals</span></span>  
 <span data-ttu-id="a1d57-165">Os novos tipos CLR que podem ser mapeados para os tipos de modelo conceitual são executados no cliente:</span><span class="sxs-lookup"><span data-stu-id="a1d57-165">New CLR types that can be mapped to conceptual model types are executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#constructorforliteral)]
 [!code-vb[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#constructorforliteral)]  
  
 <span data-ttu-id="a1d57-166">As novas matrizes também são executadas no cliente.</span><span class="sxs-lookup"><span data-stu-id="a1d57-166">New arrays are also executed on the client.</span></span>  
  
## <a name="store-exceptions"></a><span data-ttu-id="a1d57-167">Exceções de armazenamento</span><span class="sxs-lookup"><span data-stu-id="a1d57-167">Store Exceptions</span></span>  
 <span data-ttu-id="a1d57-168">Todos os erros de armazenamento encontrados durante a execução da consulta são passados até o cliente e não são mapeados ou tratados.</span><span class="sxs-lookup"><span data-stu-id="a1d57-168">Any store errors that are encountered during query execution are passed up to the client, and are not mapped or handled.</span></span>  
  
## <a name="store-configuration"></a><span data-ttu-id="a1d57-169">Configuração do repositório</span><span class="sxs-lookup"><span data-stu-id="a1d57-169">Store Configuration</span></span>  
 <span data-ttu-id="a1d57-170">Quando a consulta é executada no repositório, a configuração do repositório substitui todos os comportamentos do cliente e a semântica do repositório é expressa para todas as operações e expressões.</span><span class="sxs-lookup"><span data-stu-id="a1d57-170">When the query executes on the store, the store configuration overrides all client behaviors, and store semantics are expressed for all operations and expressions.</span></span> <span data-ttu-id="a1d57-171">Isso pode resultar em uma diferença no comportamento entre a execução no CLR e no repositório em áreas como comparações nulas, pedidos de GUID, precisão de operações que envolvem tipos de dados não precisos (como tipos de ponto de flutuação ou <xref:System.DateTime>) e operações de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="a1d57-171">This can result in a difference in behavior between CLR and store execution in areas such as null comparisons, GUID ordering, precision and accuracy of operations involving non-precise data types (such as floating point types or <xref:System.DateTime>), and string operations.</span></span> <span data-ttu-id="a1d57-172">É importante lembrar-se disso ao examinar os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="a1d57-172">It is important to keep this in mind when examining query results.</span></span>  
  
 <span data-ttu-id="a1d57-173">Por exemplo, a seguir estão algumas diferenças de comportamento entre o CLR e o SQL Server:</span><span class="sxs-lookup"><span data-stu-id="a1d57-173">For example, the following are some differences in behavior between the CLR and SQL Server:</span></span>  
  
-   <span data-ttu-id="a1d57-174">O SQL Server pede GUIDs de maneira diferente do CLR.</span><span class="sxs-lookup"><span data-stu-id="a1d57-174">SQL Server orders GUIDs differently than the CLR.</span></span>  
  
-   <span data-ttu-id="a1d57-175">Também pode haver diferenças na precisão do resultado ao manipular o tipo decimal no SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a1d57-175">There can also be differences in result precision when dealing with the Decimal type on SQL Server.</span></span> <span data-ttu-id="a1d57-176">Isso é devido aos requisitos fixos de precisão do tipo decimal do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a1d57-176">This is due to the fixed precision requirements of the SQL Server decimal type.</span></span> <span data-ttu-id="a1d57-177">Por exemplo, a média dos valores <xref:System.Decimal> 0,0, 0,0, e 1,0 é 0,3333333333333333333333333333 na memória no cliente, mas é 0,333333 no repositório (baseado na precisão padrão do tipo decimal do SQL Server).</span><span class="sxs-lookup"><span data-stu-id="a1d57-177">For example, the average of <xref:System.Decimal> values 0.0, 0.0, and 1.0 is 0.3333333333333333333333333333 in memory on the client, but 0.333333 in the store (based on the default precision for SQL Server’s decimal type).</span></span>  
  
-   <span data-ttu-id="a1d57-178">Algumas operações de comparação de cadeia de caracteres também são manipuladas de maneira diferente no SQL Server em relação ao CLR.</span><span class="sxs-lookup"><span data-stu-id="a1d57-178">Some string comparison operations are also handled differently in SQL Server than in the CLR.</span></span> <span data-ttu-id="a1d57-179">O comportamento de comparação de cadeia de caracteres depende das configurações de agrupamento no servidor.</span><span class="sxs-lookup"><span data-stu-id="a1d57-179">String comparison behavior depends on the collation settings on the server.</span></span>  
  
-   <span data-ttu-id="a1d57-180">Chamadas de função ou de método, quando incluídas em uma consulta LINQ to Entities, são mapeadas para funções canônicas no Entity Framework, que são então convertidas em Transact-SQL e executadas no banco de dados SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a1d57-180">Function or method calls, when included in a LINQ to Entities query, are mapped to canonical functions in the Entity Framework, which are then translated to Transact-SQL and executed on the SQL Server database.</span></span> <span data-ttu-id="a1d57-181">Há casos em que o comportamento que essas funções mapeadas exibem pode diferir na implementação nas bibliotecas de classes base.</span><span class="sxs-lookup"><span data-stu-id="a1d57-181">There are cases when the behavior these mapped functions exhibit might differ from the implementation in the base class libraries.</span></span> <span data-ttu-id="a1d57-182">Por exemplo, a chamada dos métodos <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A> e <xref:System.String.EndsWith%2A> com uma cadeia de caracteres vazia como um parâmetro retornará `true` quando executada no CLR, mas retornará `false` quando executada no SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a1d57-182">For example, calling the <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A>, and <xref:System.String.EndsWith%2A> methods with an empty string as a parameter will return `true` when executed in the CLR, but will return `false` when executed in SQL Server.</span></span> <span data-ttu-id="a1d57-183">O método <xref:System.String.EndsWith%2A> também pode retornar resultados diferentes porque o SQL Server considera que duas cadeias de caracteres serão iguais se diferirem apenas no espaço em branco à direita, enquanto o CLR não as considera iguais.</span><span class="sxs-lookup"><span data-stu-id="a1d57-183">The <xref:System.String.EndsWith%2A> method can also return different results because SQL Server considers two strings to be equal if they only differ in trailing white space, whereas the CLR considers them to be not equal.</span></span> <span data-ttu-id="a1d57-184">Isso é ilustrado pelo exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="a1d57-184">This is illustrated by the following example:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#canonicalfuncvsclrbasetype)]
 [!code-vb[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#canonicalfuncvsclrbasetype)]
