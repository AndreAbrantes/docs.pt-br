---
title: Notificações de consulta no SQL Server
description: Saiba como usar as notificações de consulta para notificar aplicativos quando os dados forem alterados em um banco de dado SQL Server, por exemplo, para atualizar as exibições do aplicativo.
ms.date: 03/30/2017
ms.assetid: 0f0ba1a1-3180-4af8-87f7-c795dc8f8f55
ms.openlocfilehash: 1351c83b6cc5837115321d53e8779c0f364c3099
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/02/2020
ms.locfileid: "84286217"
---
# <a name="query-notifications-in-sql-server"></a><span data-ttu-id="b909d-103">Notificações de consulta no SQL Server</span><span class="sxs-lookup"><span data-stu-id="b909d-103">Query Notifications in SQL Server</span></span>
<span data-ttu-id="b909d-104">Com base na infraestrutura do Service Broker, as notificações de consulta permitem que os aplicativos sejam notificados em caso de alteração nos dados.</span><span class="sxs-lookup"><span data-stu-id="b909d-104">Built upon the Service Broker infrastructure, query notifications allow applications to be notified when data has changed.</span></span> <span data-ttu-id="b909d-105">Esse recurso é particularmente útil para aplicativos que fornecem um cache de informações de um banco de dados, como um aplicativo da Web, e precisam ser notificados quando os dados de origem são alterados.</span><span class="sxs-lookup"><span data-stu-id="b909d-105">This feature is particularly useful for applications that provide a cache of information from a database, such as a Web application, and need to be notified when the source data is changed.</span></span>  
  
 <span data-ttu-id="b909d-106">Há três maneiras pelas quais você pode implementar notificações de consulta usando o ADO.NET:</span><span class="sxs-lookup"><span data-stu-id="b909d-106">There are three ways you can implement query notifications using ADO.NET:</span></span>  
  
1. <span data-ttu-id="b909d-107">A implementação de nível baixo é fornecida pela classe `SqlNotificationRequest`, que expõe a funcionalidade do lado do servidor, permitindo que você execute um comando com uma solicitação de notificação.</span><span class="sxs-lookup"><span data-stu-id="b909d-107">The low-level implementation is provided by the `SqlNotificationRequest` class that exposes server-side functionality, enabling you to execute a command with a notification request.</span></span>  
  
2. <span data-ttu-id="b909d-108">A implementação de alto nível é fornecida pela classe `SqlDependency`, que é uma classe que fornece uma abstração de alto nível da funcionalidade de notificação entre o aplicativo de origem e o SQL Server, permitindo que você use uma dependência para detectar alterações no servidor.</span><span class="sxs-lookup"><span data-stu-id="b909d-108">The high-level implementation is provided by the `SqlDependency` class, which is a class that provides a high-level abstraction of notification functionality between the source application and SQL Server, enabling you to use a dependency to detect changes in the server.</span></span> <span data-ttu-id="b909d-109">Na maioria dos casos, esse é o modo mais simples e mais eficiente de aproveitar o recurso de notificações do SQL Server por aplicativos cliente gerenciados usando o provedor de dados .NET Framework para SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b909d-109">In most cases, this is the simplest and most effective way to leverage SQL Server notifications capability by managed client applications using the .NET Framework Data Provider for SQL Server.</span></span>  
  
3. <span data-ttu-id="b909d-110">Além disso, os aplicativos Web criados usando o ASP.NET 2.0 ou posterior podem usar as classes auxiliares `SqlCacheDependency`.</span><span class="sxs-lookup"><span data-stu-id="b909d-110">In addition, Web applications built using ASP.NET 2.0 or later can use the `SqlCacheDependency` helper classes.</span></span>  
  
 <span data-ttu-id="b909d-111">As notificações de consulta são usadas para aplicativos que precisam atualizar exibições ou caches em resposta a alterações nos dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="b909d-111">Query notifications are used for applications that need to refresh displays or caches in response to changes in underlying data.</span></span> <span data-ttu-id="b909d-112">O Microsoft SQL Server permite que aplicativos do .NET Framework enviem um comando ao SQL Server e solicitem a notificação se executar o mesmo comando produzir conjuntos de resultados diferentes dos recuperados inicialmente.</span><span class="sxs-lookup"><span data-stu-id="b909d-112">Microsoft SQL Server allows .NET Framework applications to send a command to SQL Server and request notification if executing the same command would produce result sets different from those initially retrieved.</span></span> <span data-ttu-id="b909d-113">As notificações geradas no servidor são enviadas pelas filas para serem processadas posteriormente.</span><span class="sxs-lookup"><span data-stu-id="b909d-113">Notifications generated at the server are sent through queues to be processed later.</span></span>  
  
 <span data-ttu-id="b909d-114">Você pode configurar notificações para as instruções SELECT e EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="b909d-114">You can set up notifications for SELECT and EXECUTE statements.</span></span> <span data-ttu-id="b909d-115">Ao usar uma instrução EXECUTE, o SQL Server registra uma notificação para o comando executado e não a própria instrução EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="b909d-115">When using an EXECUTE statement, SQL Server registers a notification for the command executed rather than the EXECUTE statement itself.</span></span> <span data-ttu-id="b909d-116">O comando deve atender os requisitos e as limitações de uma instrução SELECT.</span><span class="sxs-lookup"><span data-stu-id="b909d-116">The command must meet the requirements and limitations for a SELECT statement.</span></span> <span data-ttu-id="b909d-117">Quando um comando que registra uma notificação contiver mais de uma instrução, o Mecanismo de Banco de Dados criará uma notificação para cada instrução no lote.</span><span class="sxs-lookup"><span data-stu-id="b909d-117">When a command that registers a notification contains more than one statement, the Database Engine creates a notification for each statement in the batch.</span></span>  
  
 <span data-ttu-id="b909d-118">Se você estiver desenvolvendo um aplicativo onde precisa de notificações de subsegundo confiáveis quando os dados forem alterados, examine as seções **planejando uma estratégia de notificações de consulta eficiente** e **alternativas para notificações de consulta** no artigo [planejamento de notificações](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms187528(v=sql.105)) .</span><span class="sxs-lookup"><span data-stu-id="b909d-118">If you are developing an application where you need reliable sub-second notifications when data changes, review the sections **Planning an Efficient Query Notifications Strategy** and **Alternatives to Query Notifications** in the [Planning for Notifications](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms187528(v=sql.105)) article.</span></span> <span data-ttu-id="b909d-119">Para obter mais informações sobre notificações de consulta e SQL Server Service Broker, consulte os seguintes links para artigos na documentação do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b909d-119">For more information about Query Notifications and SQL Server Service Broker, see the following links to articles in the SQL Server documentation.</span></span>  
  
 <span data-ttu-id="b909d-120">**Documentação do SQL Server**</span><span class="sxs-lookup"><span data-stu-id="b909d-120">**SQL Server documentation**</span></span>  
  
- <span data-ttu-id="b909d-121">[Usando notificações de consulta](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms175110(v=sql.105))</span><span class="sxs-lookup"><span data-stu-id="b909d-121">[Using Query Notifications](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms175110(v=sql.105))</span></span>  
  
- <span data-ttu-id="b909d-122">[Criando uma consulta para notificação](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms181122(v=sql.105))</span><span class="sxs-lookup"><span data-stu-id="b909d-122">[Creating a Query for Notification](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms181122(v=sql.105))</span></span>  
  
- <span data-ttu-id="b909d-123">[Desenvolvimento (Service Broker)](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/bb522889(v=sql.105))</span><span class="sxs-lookup"><span data-stu-id="b909d-123">[Development (Service Broker)](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/bb522889(v=sql.105))</span></span>  
  
- <span data-ttu-id="b909d-124">[Service Broker Developer InfoCenter](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms166100(v=sql.105))</span><span class="sxs-lookup"><span data-stu-id="b909d-124">[Service Broker Developer InfoCenter](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms166100(v=sql.105))</span></span>  
  
- <span data-ttu-id="b909d-125">[Guia do desenvolvedor (Service Broker)](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/bb522908(v=sql.105))</span><span class="sxs-lookup"><span data-stu-id="b909d-125">[Developer's Guide (Service Broker)](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/bb522908(v=sql.105))</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="b909d-126">Nesta seção</span><span class="sxs-lookup"><span data-stu-id="b909d-126">In This Section</span></span>  
 [<span data-ttu-id="b909d-127">Habilitando notificações de consulta</span><span class="sxs-lookup"><span data-stu-id="b909d-127">Enabling Query Notifications</span></span>](enabling-query-notifications.md)  
 <span data-ttu-id="b909d-128">Discute como usar notificações de consulta, incluindo os requisitos para habilitá-las e usá-las.</span><span class="sxs-lookup"><span data-stu-id="b909d-128">Discusses how to use query notifications, including the requirements for enabling and using them.</span></span>  
  
 [<span data-ttu-id="b909d-129">SqlDependency em um aplicativo ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b909d-129">SqlDependency in an ASP.NET Application</span></span>](sqldependency-in-an-aspnet-app.md)  
 <span data-ttu-id="b909d-130">Demonstra como usar notificações de consulta em um aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b909d-130">Demonstrates how to use query notifications from an ASP.NET application.</span></span>  
  
 [<span data-ttu-id="b909d-131">Detectando alterações com SqlDependency</span><span class="sxs-lookup"><span data-stu-id="b909d-131">Detecting Changes with SqlDependency</span></span>](detecting-changes-with-sqldependency.md)  
 <span data-ttu-id="b909d-132">Demonstra como detectar quando os resultados da consulta serão diferentes daqueles recebidos originalmente.</span><span class="sxs-lookup"><span data-stu-id="b909d-132">Demonstrates how to detect when query results will be different from those originally received.</span></span>  
  
 [<span data-ttu-id="b909d-133">Execução de SqlCommand com um SqlNotificationRequest</span><span class="sxs-lookup"><span data-stu-id="b909d-133">SqlCommand Execution with a SqlNotificationRequest</span></span>](sqlcommand-execution-with-a-sqlnotificationrequest.md)  
 <span data-ttu-id="b909d-134">Demonstra como configurar um objeto <xref:System.Data.SqlClient.SqlCommand> para trabalhar com uma notificação de consulta.</span><span class="sxs-lookup"><span data-stu-id="b909d-134">Demonstrates configuring a <xref:System.Data.SqlClient.SqlCommand> object to work with a query notification.</span></span>  
  
## <a name="reference"></a><span data-ttu-id="b909d-135">Referência</span><span class="sxs-lookup"><span data-stu-id="b909d-135">Reference</span></span>  
 <xref:System.Data.Sql.SqlNotificationRequest>  
 <span data-ttu-id="b909d-136">Descreve a classe <xref:System.Data.Sql.SqlNotificationRequest> e todos os membros dela.</span><span class="sxs-lookup"><span data-stu-id="b909d-136">Describes the <xref:System.Data.Sql.SqlNotificationRequest> class and all of its members.</span></span>  
  
 <xref:System.Data.SqlClient.SqlDependency>  
 <span data-ttu-id="b909d-137">Descreve a classe <xref:System.Data.SqlClient.SqlDependency> e todos os membros dela.</span><span class="sxs-lookup"><span data-stu-id="b909d-137">Describes the <xref:System.Data.SqlClient.SqlDependency> class and all of its members.</span></span>  
  
 <xref:System.Web.Caching.SqlCacheDependency>  
 <span data-ttu-id="b909d-138">Descreve a classe <xref:System.Web.Caching.SqlCacheDependency> e todos os membros dela.</span><span class="sxs-lookup"><span data-stu-id="b909d-138">Describes the <xref:System.Web.Caching.SqlCacheDependency> class and all of its members.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b909d-139">Veja também</span><span class="sxs-lookup"><span data-stu-id="b909d-139">See also</span></span>

- [<span data-ttu-id="b909d-140">SQL Server e ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b909d-140">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="b909d-141">Visão geral do ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b909d-141">ADO.NET Overview</span></span>](../ado-net-overview.md)
