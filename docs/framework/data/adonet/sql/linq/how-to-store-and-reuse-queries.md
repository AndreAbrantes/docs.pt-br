---
title: 'Como: armazenar e reutilizar consultas'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: 1aac20c3f9c421d353938a83b9e321d35abd244e
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59084187"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="c9568-102">Como: armazenar e reutilizar consultas</span><span class="sxs-lookup"><span data-stu-id="c9568-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="c9568-103">Quando você tiver um aplicativo que executa consultas estrutural semelhantes muitas vezes, você geralmente pode aumentar o desempenho criando a consulta uma hora e executando a várias vezes com parâmetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="c9568-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="c9568-104">Por exemplo, um aplicativo pode precisar recuperar todos os clientes que estão em uma cidade específica, onde cidade é especificada em tempo de execução pelo usuário em um formulário.</span><span class="sxs-lookup"><span data-stu-id="c9568-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="c9568-105">suporta o uso de *consultas compiladas* para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="c9568-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9568-106">Esse padrão de uso representa o uso mais comum para consultas compilados.</span><span class="sxs-lookup"><span data-stu-id="c9568-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="c9568-107">Outras abordagens são possíveis.</span><span class="sxs-lookup"><span data-stu-id="c9568-107">Other approaches are possible.</span></span> <span data-ttu-id="c9568-108">Por exemplo, consultas compiladas podem ser armazenadas como membros estáticos em uma classe parcial que estende o código gerado pelo designer.</span><span class="sxs-lookup"><span data-stu-id="c9568-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="c9568-109">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c9568-109">Example</span></span>  
 <span data-ttu-id="c9568-110">Em muitos cenários talvez queira reutilizar as consultas através dos limites de segmento.</span><span class="sxs-lookup"><span data-stu-id="c9568-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="c9568-111">Nesses casos, armazenar as consultas compilados em variáveis estáticas é muito eficiente.</span><span class="sxs-lookup"><span data-stu-id="c9568-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="c9568-112">O exemplo de código a seguir pressupõe uma classe de `Queries` projetada para armazenar consultas compilados, e pressupõe uma classe Northwind que representa <xref:System.Data.Linq.DataContext>fortemente tipado.</span><span class="sxs-lookup"><span data-stu-id="c9568-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="c9568-113">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c9568-113">Example</span></span>  
 <span data-ttu-id="c9568-114">Não é possível no momento, as consultas de armazenamento (em variáveis estáticas) que retornam um *tipo anônimo*, porque o tipo não tem nenhum nome para fornecer como um argumento genérico.</span><span class="sxs-lookup"><span data-stu-id="c9568-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="c9568-115">O exemplo a seguir mostra como você pode contornar do problema criando um tipo que pode representar o resultado, e o usar como um argumento genérico.</span><span class="sxs-lookup"><span data-stu-id="c9568-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="c9568-116">Consulte também</span><span class="sxs-lookup"><span data-stu-id="c9568-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="c9568-117">Conceitos de consulta</span><span class="sxs-lookup"><span data-stu-id="c9568-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="c9568-118">Consultando o banco de dados</span><span class="sxs-lookup"><span data-stu-id="c9568-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
