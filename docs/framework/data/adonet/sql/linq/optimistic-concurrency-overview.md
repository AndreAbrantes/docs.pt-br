---
title: "Concorrência otimista: Visão geral"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694
caps.latest.revision: "2"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 616b035096dd636c65dba65bfe6b371db75bec8e
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/17/2018
---
# <a name="optimistic-concurrency-overview"></a><span data-ttu-id="b5e6c-102">Concorrência otimista: Visão geral</span><span class="sxs-lookup"><span data-stu-id="b5e6c-102">Optimistic Concurrency: Overview</span></span>
<span data-ttu-id="b5e6c-103">controle de simultaneidade otimista de suporte de[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b5e6c-103">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports optimistic concurrency control.</span></span> <span data-ttu-id="b5e6c-104">A tabela a seguir descreve os termos que se aplicam a simultaneidade otimista na [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentação:</span><span class="sxs-lookup"><span data-stu-id="b5e6c-104">The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:</span></span>  
  
|<span data-ttu-id="b5e6c-105">Termos</span><span class="sxs-lookup"><span data-stu-id="b5e6c-105">Terms</span></span>|<span data-ttu-id="b5e6c-106">Descrição</span><span class="sxs-lookup"><span data-stu-id="b5e6c-106">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="b5e6c-107">simultaneidade</span><span class="sxs-lookup"><span data-stu-id="b5e6c-107">concurrency</span></span>|<span data-ttu-id="b5e6c-108">A situação em que dois ou mais usuários tentarem ao mesmo tempo atualizar a mesma linha de base de dados.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-108">The situation in which two or more users at the same time try to update the same database row.</span></span>|  
|<span data-ttu-id="b5e6c-109">conflito de concorrência</span><span class="sxs-lookup"><span data-stu-id="b5e6c-109">concurrency conflict</span></span>|<span data-ttu-id="b5e6c-110">A situação em que dois ou mais usuários tentarem ao mesmo tempo enviar conflitar valores em uma ou mais colunas de uma linha.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-110">The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.</span></span>|  
|<span data-ttu-id="b5e6c-111">controle de simultaneidade</span><span class="sxs-lookup"><span data-stu-id="b5e6c-111">concurrency control</span></span>|<span data-ttu-id="b5e6c-112">A técnica usada para resolver conflitos de simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-112">The technique used to resolve concurrency conflicts.</span></span>|  
|<span data-ttu-id="b5e6c-113">controle de simultaneidade otimista</span><span class="sxs-lookup"><span data-stu-id="b5e6c-113">optimistic concurrency control</span></span>|<span data-ttu-id="b5e6c-114">A técnica que investiga primeiro se outras transações alterados valores em uma linha antes de permitir alterações para ser enviada.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-114">The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.</span></span><br /><br /> <span data-ttu-id="b5e6c-115">Compare com *controle de simultaneidade pessimista*, que bloqueia o registro para evitar conflitos de simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-115">Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.</span></span><br /><br /> <span data-ttu-id="b5e6c-116">*Otimista* controle é então chamado porque considera a possibilidade de interferir com outra seja improvável de uma transação.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-116">*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.</span></span>|  
|<span data-ttu-id="b5e6c-117">resolução de conflitos</span><span class="sxs-lookup"><span data-stu-id="b5e6c-117">conflict resolution</span></span>|<span data-ttu-id="b5e6c-118">O processo de atualizar um item conflitante ver o base de dados novamente e depois reconciliar diferenças.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-118">The process of refreshing a conflicting item by querying the database again and then reconciling differences.</span></span><br /><br /> <span data-ttu-id="b5e6c-119">Quando um objeto é atualizado, o perseguidor de alteração de [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] contém os seguintes dados:</span><span class="sxs-lookup"><span data-stu-id="b5e6c-119">When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:</span></span><br /><br /> <span data-ttu-id="b5e6c-120">-Verifique os valores originalmente obtidas do banco de dados e usado para a atualização.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-120">-   The values originally taken from the database and used for the update check.</span></span><br /><span data-ttu-id="b5e6c-121">-Os novos valores de banco de dados da consulta subsequente.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-121">-   The new database values from the subsequent query.</span></span><br /><br /> <span data-ttu-id="b5e6c-122">em[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] determina se o objeto está em conflito (isto é, se um ou mais de seus valores de membros foram alterados).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-122">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] then determines whether the object is in conflict (that is, whether one or more of its member values has changed).</span></span> <span data-ttu-id="b5e6c-123">Se o objeto está em conflito, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] lado determina quais dos seus membros estão em conflito.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-123">If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.</span></span><br /><br /> <span data-ttu-id="b5e6c-124">Qualquer conflito do membro que [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] descobrir é adicionado a uma lista de conflito.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-124">Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.</span></span>|  
  
 <span data-ttu-id="b5e6c-125">No [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] modelo de objeto, um *conflito de simultaneidade otimista* ocorre quando as seguintes condições forem verdadeiras:</span><span class="sxs-lookup"><span data-stu-id="b5e6c-125">In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:</span></span>  
  
-   <span data-ttu-id="b5e6c-126">Tentativas de cliente para enviar alterações para o base de dados.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-126">The client tries to submit changes to the database.</span></span>  
  
-   <span data-ttu-id="b5e6c-127">Um ou mais valores de atualização- verificação foram atualizados na base de dados como o último de cliente os ler.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-127">One or more update-check values have been updated in the database since the client last read them.</span></span>  
  
 <span data-ttu-id="b5e6c-128">A resolução desse conflito inclui a descoberta de membros do objeto estão em conflito, e então decidir o que você deseja fazer sobre ele.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-128">Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b5e6c-129">Somente os membros mapeados como <xref:System.Data.Linq.Mapping.UpdateCheck.Always> ou <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participam de verificação de simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-129">Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks.</span></span> <span data-ttu-id="b5e6c-130">Nenhuma verificação é executada para <xref:System.Data.Linq.Mapping.UpdateCheck.Never>marcado membros.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-130">No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span></span> <span data-ttu-id="b5e6c-131">Para obter mais informações, consulte <xref:System.Data.Linq.Mapping.UpdateCheck>.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-131">For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.</span></span>  
  
## <a name="example"></a><span data-ttu-id="b5e6c-132">Exemplo</span><span class="sxs-lookup"><span data-stu-id="b5e6c-132">Example</span></span>  
 <span data-ttu-id="b5e6c-133">Por exemplo, o seguinte cenário, inicia User1 para preparar uma atualização ver o base de dados para uma linha.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-133">For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.</span></span> <span data-ttu-id="b5e6c-134">User1 recebe uma linha com valores de Alfreds, de Maria, e de vendas.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-134">User1 receives a row with values of Alfreds, Maria, and Sales.</span></span>  
  
 <span data-ttu-id="b5e6c-135">User1 deseja alterar o valor da coluna do gerenciador Alfred e o valor da coluna de departamento ao mercado.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-135">User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.</span></span> <span data-ttu-id="b5e6c-136">Antes que User1 pode enviar as alterações, Usuário2 alterações enviadas a base de dados.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-136">Before User1 can submit those changes, User2 has submitted changes to the database.</span></span> <span data-ttu-id="b5e6c-137">O valor da coluna assistente já foi alterado isso agora a Mary e o valor da coluna de departamento para atender.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-137">So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.</span></span>  
  
 <span data-ttu-id="b5e6c-138">Quando User1 agora tenta enviar alterações, o envio falha e de <xref:System.Data.Linq.ChangeConflictException> uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-138">When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown.</span></span> <span data-ttu-id="b5e6c-139">Este resultado ocorre porque os valores de base de dados para a coluna assistente e a coluna de departamento não são aqueles que foram esperadas.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-139">This result occurs because the database values for the Assistant column and the Department column are not those that were expected.</span></span> <span data-ttu-id="b5e6c-140">Os membros que representam as colunas do assistente e departamento estão em conflito.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-140">Members representing the Assistant and Department columns are in conflict.</span></span> <span data-ttu-id="b5e6c-141">A tabela a seguir resume a situação.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-141">The following table summarizes the situation.</span></span>  
  
||<span data-ttu-id="b5e6c-142">Manager</span><span class="sxs-lookup"><span data-stu-id="b5e6c-142">Manager</span></span>|<span data-ttu-id="b5e6c-143">Assistente</span><span class="sxs-lookup"><span data-stu-id="b5e6c-143">Assistant</span></span>|<span data-ttu-id="b5e6c-144">Departamento</span><span class="sxs-lookup"><span data-stu-id="b5e6c-144">Department</span></span>|  
|------|-------------|---------------|----------------|  
|<span data-ttu-id="b5e6c-145">Estado original</span><span class="sxs-lookup"><span data-stu-id="b5e6c-145">Original state</span></span>|<span data-ttu-id="b5e6c-146">Alfreds</span><span class="sxs-lookup"><span data-stu-id="b5e6c-146">Alfreds</span></span>|<span data-ttu-id="b5e6c-147">Maria</span><span class="sxs-lookup"><span data-stu-id="b5e6c-147">Maria</span></span>|<span data-ttu-id="b5e6c-148">Vendas</span><span class="sxs-lookup"><span data-stu-id="b5e6c-148">Sales</span></span>|  
|<span data-ttu-id="b5e6c-149">User1</span><span class="sxs-lookup"><span data-stu-id="b5e6c-149">User1</span></span>|<span data-ttu-id="b5e6c-150">Alfred</span><span class="sxs-lookup"><span data-stu-id="b5e6c-150">Alfred</span></span>||<span data-ttu-id="b5e6c-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="b5e6c-151">Marketing</span></span>|  
|<span data-ttu-id="b5e6c-152">Usuário2</span><span class="sxs-lookup"><span data-stu-id="b5e6c-152">User2</span></span>||<span data-ttu-id="b5e6c-153">Mary</span><span class="sxs-lookup"><span data-stu-id="b5e6c-153">Mary</span></span>|<span data-ttu-id="b5e6c-154">Serviço</span><span class="sxs-lookup"><span data-stu-id="b5e6c-154">Service</span></span>|  
  
 <span data-ttu-id="b5e6c-155">Você pode resolver conflitos como este de maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-155">You can resolve conflicts such as this in different ways.</span></span> <span data-ttu-id="b5e6c-156">Para obter mais informações, consulte [como: gerenciar conflitos de alteração](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-156">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
## <a name="conflict-detection-and-resolution-checklist"></a><span data-ttu-id="b5e6c-157">Lista de verificação de detecção e de resolução de conflitos</span><span class="sxs-lookup"><span data-stu-id="b5e6c-157">Conflict Detection and Resolution Checklist</span></span>  
 <span data-ttu-id="b5e6c-158">Você pode detectar e resolver conflitos em qualquer nível de detalhe.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-158">You can detect and resolve conflicts at any level of detail.</span></span> <span data-ttu-id="b5e6c-159">Em um extremo, você pode resolver todos os conflitos em uma das três maneiras (consulte <xref:System.Data.Linq.RefreshMode>) sem consideração adicional.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-159">At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration.</span></span> <span data-ttu-id="b5e6c-160">No extremo outro, você pode designar uma ação específica para cada tipo de conflito em cada membro em conflito.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-160">At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.</span></span>  
  
-   <span data-ttu-id="b5e6c-161">Especificar ou revise as opções de <xref:System.Data.Linq.Mapping.UpdateCheck> no seu modelo de objeto.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-161">Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.</span></span>  
  
     <span data-ttu-id="b5e6c-162">Para obter mais informações, consulte [como: especificar quais membros são testados para conflitos de simultaneidade](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-162">For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span></span>  
  
-   <span data-ttu-id="b5e6c-163">Em bloco try/catch de sua chamada a <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, especifique ponto em que você deseja exceções seja lançada.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-163">In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.</span></span>  
  
     <span data-ttu-id="b5e6c-164">Para obter mais informações, consulte [como: especificar quando as exceções concorrentes são geradas](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-164">For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span></span>  
  
-   <span data-ttu-id="b5e6c-165">Determine quanto detalhes de conflito você deseja recuperar, e inclua código em seus bloco try/catch de acordo.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-165">Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.</span></span>  
  
     <span data-ttu-id="b5e6c-166">Para obter mais informações, consulte [como: recuperar informações de conflito de entidade](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) e [como: recuperar informações de conflito de membro](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-166">For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span></span>  
  
-   <span data-ttu-id="b5e6c-167">Incluir em seu `try` / `catch` como você deseja resolver os conflitos vários descobrir de código.</span><span class="sxs-lookup"><span data-stu-id="b5e6c-167">Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.</span></span>  
  
     <span data-ttu-id="b5e6c-168">Para obter mais informações, consulte [como: resolver conflitos mantendo valores de banco de dados](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [como: resolver conflitos substituindo valores de banco de dados](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), e [como: resolver conflitos, mesclando com valores do banco de dados](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span><span class="sxs-lookup"><span data-stu-id="b5e6c-168">For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span></span>  
  
## <a name="linq-to-sql-types-that-support-conflict-discovery-and-resolution"></a><span data-ttu-id="b5e6c-169">Tipos LINQ to SQL que oferecem suporte a descoberta e a resolução de conflitos</span><span class="sxs-lookup"><span data-stu-id="b5e6c-169">LINQ to SQL Types That Support Conflict Discovery and Resolution</span></span>  
 <span data-ttu-id="b5e6c-170">As classes e os recursos para oferecer suporte a resolução de conflitos em concorrência otimista em [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="b5e6c-170">Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:</span></span>  
  
-   <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  
  
-   <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  
  
## <a name="see-also"></a><span data-ttu-id="b5e6c-171">Consulte também</span><span class="sxs-lookup"><span data-stu-id="b5e6c-171">See Also</span></span>  
 [<span data-ttu-id="b5e6c-172">Como gerenciar conflitos de alteração</span><span class="sxs-lookup"><span data-stu-id="b5e6c-172">How to: Manage Change Conflicts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)
