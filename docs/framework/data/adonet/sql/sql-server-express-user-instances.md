---
title: "Instâncias de usuário do SQL Server Express"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
caps.latest.revision: "5"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 55f3393c84ec08d3c3944552ac2bed7d15dd025f
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/17/2018
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="1c6ea-102">Instâncias de usuário do SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="1c6ea-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="1c6ea-103">O Microsoft SQL Server Express Edition (SQL Server Express) dá suporte ao recurso de instância de usuário, que somente está disponível quando é usado o Provedor de Dados .NET Framework para SQL Server (`SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="1c6ea-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="1c6ea-104">Uma instância de usuário é uma instância separada do Mecanismo de Banco de Dados SQL Server Express que é gerado por uma instância pai.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="1c6ea-105">As instâncias de usuário permitem que usuários que não são administradores em seus computadores locais anexem e conectem-se aos bancos de dados SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="1c6ea-106">Cada instância é executada no contexto de segurança do usuário individual, uma instância por usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="1c6ea-107">Recursos de instância de usuário</span><span class="sxs-lookup"><span data-stu-id="1c6ea-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="1c6ea-108">As instâncias de usuário são úteis para os usuários que estão executando o Windows com uma conta de usuário de privilégios mínimos (LUA), pois cada usuário tem privilégios de administrador do sistema do SQL Server (`sysadmin`) na instância em execução em seu computador sem precisar ser também administrador do Windows.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA) because each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on her computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="1c6ea-109">O software que é executado em uma instância de usuário com permissões limitadas não pode fazer alterações em todo o sistema porque a instância do SQL Server Express está sendo executada na conta do usuário do Windows que não é administrador, não como um serviço.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-109">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="1c6ea-110">Cada instância de usuário é isolada de sua instância pai e de todas as outras instâncias de usuário que são executadas no mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-110">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="1c6ea-111">Os bancos de dados que são executados em uma instância de usuário são abertos somente no modo de usuário único, e não é possível para vários usuários se conectarem a bancos de dados que são executados em uma instância de usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-111">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="1c6ea-112">A replicação e as consultas distribuídas também são desativadas para instâncias de usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-112">Replication and distributed queries are also disabled for user instances.</span></span>  
  
 <span data-ttu-id="1c6ea-113">Para obter mais informações, consulte “Instâncias de usuário” nos Manuais Online do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-113">For more information, see "User Instances" in SQL Server Books Online.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-114">As instâncias de usuário não são necessárias para os usuários que já são administradores em seus próprios computadores ou para cenários que envolvem vários usuários do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="1c6ea-115">Habilitando instâncias de usuário</span><span class="sxs-lookup"><span data-stu-id="1c6ea-115">Enabling User Instances</span></span>  
 <span data-ttu-id="1c6ea-116">Para gerar instâncias de usuário, uma instância pai do SQL Server Express deve estar em execução.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="1c6ea-117">Instâncias de usuário são habilitadas por padrão quando o SQL Server Express está instalado, e podem ser explicitamente habilitados ou desabilitados por um administrador de sistema executar o **sp_configure** procedimento armazenado do sistema na instância pai.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```  
-- Enable user instances.  
sp_configure 'user instances enabled','1'   
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="1c6ea-118">O protocolo de rede para instâncias de usuário deve ser o Pipes Nomeados local.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="1c6ea-119">Uma instância de usuário não pode ser iniciada em uma instância remota do SQL Server e os logons do SQL Server não são permitidos.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="1c6ea-120">Conectando-se a uma instância de usuário</span><span class="sxs-lookup"><span data-stu-id="1c6ea-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="1c6ea-121">O `User Instance` e `AttachDBFilename` <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> palavras-chave permitem um <xref:System.Data.SqlClient.SqlConnection> para se conectar a uma instância de usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="1c6ea-122">As instâncias de usuário também têm o suporte das propriedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` e `AttachDBFilename`.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="1c6ea-123">Observe o seguinte sobre a cadeia de conexão no exemplo mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="1c6ea-123">Note the following about the sample connection string shown below:</span></span>  
  
-   <span data-ttu-id="1c6ea-124">A palavra-chave `Data Source` refere-se à instância pai do SQL Server Express que está gerando a instância do usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="1c6ea-125">A instância padrão é. \sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-125">The default instance is .\sqlexpress.</span></span>  
  
-   <span data-ttu-id="1c6ea-126">`Integrated Security` é definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="1c6ea-127">Para se conectar a uma instância de usuário, a Autenticação do Windows é necessária; os logons do SQL Server não têm suporte.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
-   <span data-ttu-id="1c6ea-128">A `User Instance` é definida como `true`, o que invoca uma instância de usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="1c6ea-129">(O padrão é `false`.)</span><span class="sxs-lookup"><span data-stu-id="1c6ea-129">(The default is `false`.)</span></span>  
  
-   <span data-ttu-id="1c6ea-130">A palavra-chave de cadeia de conexão `AttachDbFileName` é usada para anexar o arquivo de banco de dados primário (.mdf), que deve incluir o nome do caminho completo.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="1c6ea-131">`AttachDbFileName` também corresponde às chaves "extended properties" e "initial file name" dentro de uma cadeia de conexão <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
-   <span data-ttu-id="1c6ea-132">A cadeia de caracteres de substituição `|DataDirectory|` incluída nos símbolos pipe refere-se ao diretório de dados do aplicativo que abre a conexão e fornece um caminho relativo que indica o local do banco de dados .mdf e .ldf e dos arquivos de log.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="1c6ea-133">Se você deseja localizar esses arquivos em outro lugar, deverá fornecer o caminho completo para os arquivos.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-134">Você também pode usar as propriedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> e <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> para compilar uma cadeia de conexão em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="1c6ea-135">Usando o &#124; DataDirectory &#124; Cadeia de caracteres de substituição</span><span class="sxs-lookup"><span data-stu-id="1c6ea-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="1c6ea-136">`AttachDbFileName` foi ampliado no ADO.NET 2.0 com a introdução da cadeia de caracteres de substituição `|DataDirectory|` (entre barras verticais).</span><span class="sxs-lookup"><span data-stu-id="1c6ea-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="1c6ea-137">`DataDirectory` é usado em conjunto com `AttachDbFileName` para indicar um caminho relativo para um arquivo de dados, permitindo que os desenvolvedores criem cadeias de conexão que são baseadas em um caminho relativo para a fonte de dados em vez de precisarem especificar um caminho completo.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="1c6ea-138">A localização física para a qual o `DataDirectory` aponta depende do tipo de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="1c6ea-139">Nesse exemplo, o arquivo Northwind.mdf a ser anexado está localizado na pasta \app_data do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="1c6ea-140">Quando `DataDirectory` é usado, o caminho do arquivo resultante não pode ser mais alto na estrutura de diretórios que o diretório apontado pela cadeia de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="1c6ea-141">Por exemplo, se `DataDirectory` totalmente expandido for C:\AppDirectory\app_data, a cadeia de conexão de exemplo mostrada acima funcionará porque está abaixo de c:\AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="1c6ea-142">No entanto, tentar especificar `DataDirectory` como `|DataDirectory|\..\data` resultará em erro porque \data não é um subdiretório do \AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="1c6ea-143">Se a cadeia de conexão tiver uma cadeia de caracteres de substituição formatada incorretamente, uma <xref:System.ArgumentException> será gerada.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-144"><xref:System.Data.SqlClient> resolve as cadeias de caracteres de substituição em caminhos completos no sistema de arquivos do computador local.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="1c6ea-145">Portanto, os nomes do servidor remoto, de HTTP e do caminho UNC não têm suporte.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="1c6ea-146">Uma exceção será gerada quando a conexão for aberta se o servidor não estiver localizado no computador local.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="1c6ea-147">Quando <xref:System.Data.SqlClient.SqlConnection> estiver aberto, ele será redirecionado da instância padrão do SQL Server Express para uma instância iniciada em tempo de execução que é executada na conta do chamador.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-148">Pode ser necessário aumentar o valor de <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> porque as instâncias de usuários podem levar mais tempo para carregar que instâncias normais.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="1c6ea-149">O fragmento de código a seguir abre uma nova `SqlConnection`, exibe a cadeia de conexão na janela do console e, em seguida, fecha a conexão ao sair do bloco de código `using`.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =   
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",   
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-150">As instâncias de usuário não têm suporte no código CLR (Common Language Runtime) que está sendo executado dentro do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="1c6ea-151">Uma <xref:System.InvalidOperationException> é gerada se `Open` é chamado em um <xref:System.Data.SqlClient.SqlConnection> que tem `User Instance=true` na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="1c6ea-152">Tempo de vida de uma conexão de instância de usuário</span><span class="sxs-lookup"><span data-stu-id="1c6ea-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="1c6ea-153">Ao contrário das versões do SQL Server que são executadas como um serviço, as instâncias do SQL Server Express não precisam ser iniciadas e interrompidas manualmente.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="1c6ea-154">Cada vez que um usuário faz logon e se conecta a uma instância de usuário, a instância do usuário é iniciada se já não estiver em execução.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="1c6ea-155">Os bancos de dados de instância de usuário têm a opção `AutoClose` definida de modo que o banco de dados seja fechado automaticamente após um período de inatividade.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="1c6ea-156">O processo do sqlservr.exe que é iniciado permanece em execução por um período limitado depois que a última conexão à instância é fechada, para que ele não precisa ser reiniciado se outra conexão for aberta antes de o tempo limite expirar.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="1c6ea-157">A instância do usuário será encerrada automaticamente se nenhuma nova conexão for aberta antes de o período de tempo limite expirar.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="1c6ea-158">Um administrador de sistema na instância pai pode definir a duração do período de tempo limite para uma instância de usuário usando **sp_configure** para alterar o **tempo limite de instância de usuário** opção.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="1c6ea-159">O padrão é 60 minutos.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-160">Se `Min Pool Size` for usado na cadeia de conexão com um valor maior que zero, o pooler de conexão sempre manterá algumas conexões abertas e a instância do usuário não será fechada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="1c6ea-161">Como as instâncias de usuário funcionam</span><span class="sxs-lookup"><span data-stu-id="1c6ea-161">How User Instances Work</span></span>  
 <span data-ttu-id="1c6ea-162">Na primeira vez que uma instância de usuário é gerada para cada usuário, o **mestre** e **msdb** bancos de dados do sistema são copiados da pasta de dados de modelo para um caminho no repositório de dados de aplicativo local do usuário diretório para uso exclusivo pela instância de usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="1c6ea-163">Esse caminho é normalmente `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="1c6ea-164">Quando uma instância de usuário é inicializado, o **tempdb**, log e rastreamento arquivos também são gravados nesse diretório.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="1c6ea-165">Um nome é gerado para a instância, que deve ser exclusiva para cada usuário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="1c6ea-166">Por padrão, todos os membros do grupo Builtin\Users do Windows têm permissões para se conectarem à instância local bem como ler e executar permissões nos binários do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="1c6ea-167">Depois de as credenciais do usuário de chamada que hospeda a instância de usuário tiverem sido verificadas, o usuário torna-se `sysadmin` nessa instância.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="1c6ea-168">Somente a memória compartilhada é habilitada para instâncias de usuário, o que significa que somente operações no computador local são possíveis.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="1c6ea-169">Os usuários devem ter permissões de leitura e gravação nos arquivos .mdf e .ldf especificados na cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1c6ea-170">Os arquivos .mdf e .ldf representam o banco de dados e os arquivos de log, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="1c6ea-171">Esses dois arquivos são um conjunto correspondente, portanto tome cuidado durante operações de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="1c6ea-172">O arquivo de banco de dados contém informações sobre a versão exata do arquivo de log, e o banco de dados não será aberto se estiver agrupado com o arquivo de log incorreto.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="1c6ea-173">Para evitar a corrupção de dados, um banco de dados na instância do usuário é aberto com acesso exclusivo.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="1c6ea-174">Se duas instâncias de usuário diferentes compartilharem o mesmo banco de dados no mesmo computador, o usuário na primeira instância deverá fechar o banco de dados antes de ser aberto em uma segunda instância.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="1c6ea-175">Cenários de instância de usuário</span><span class="sxs-lookup"><span data-stu-id="1c6ea-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="1c6ea-176">As instâncias de usuários fornecem aos desenvolvedores de aplicativos de banco de dados um armazenamento de dados do SQL Server que não depende de os desenvolvedores terem contas administrativas em seus computadores de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="1c6ea-177">As instâncias de usuário são baseadas no modelo Access/Jet, onde o aplicativo de banco de dados simplesmente se conecta a um arquivo, e o usuário automaticamente tem permissões completas em todos os objetos de banco de dados sem precisar da intervenção de um administrador do sistema para conceder permissões.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="1c6ea-178">Ele destina-se a funcionar em situações onde o usuário está executando em uma conta de usuário de privilégios mínimos (LUA) e não tem privilégios administrativos no servidor ou no computador local, mas precisa criar objetos de banco de dados e aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="1c6ea-179">As instâncias de usuário permitem que os usuários criem as instâncias em tempo de execução que são executadas no próprio contexto de segurança do usuário, e não no contexto de segurança de um serviço do sistema mais privilegiado.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="1c6ea-180">As instâncias de usuário devem ser utilizadas somente em situações onde todos os aplicativos que as usam são totalmente confiáveis.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="1c6ea-181">Os cenários de instância de usuário incluem:</span><span class="sxs-lookup"><span data-stu-id="1c6ea-181">User instance scenarios include:</span></span>  
  
-   <span data-ttu-id="1c6ea-182">Qualquer aplicativo de usuário único onde compartilhar dados não é necessário.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-182">Any single-user application where sharing data is not required.</span></span>  
  
-   <span data-ttu-id="1c6ea-183">Implantação do ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-183">ClickOnce deployment.</span></span> <span data-ttu-id="1c6ea-184">Se o .NET Framework 2.0 (ou posterior) e o SQL Server Express já estiver instalado no computador de destino, o pacote de instalação baixado como resultado de uma ação de ClickOnce poderá ser instalado e usado por usuários não administrativos.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-184">If the .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="1c6ea-185">Observe que um administrador deve instalar o SQL Server Express se isso for parte da instalação.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="1c6ea-186">Para obter mais informações, consulte [ClickOnce implantação para aplicativos do Windows Forms](http://msdn.microsoft.com/en-us/34d8c770-48f2-460c-8d67-4ea5684511df).</span><span class="sxs-lookup"><span data-stu-id="1c6ea-186">For more information, see [ClickOnce Deployment for Windows Forms Applications](http://msdn.microsoft.com/en-us/34d8c770-48f2-460c-8d67-4ea5684511df).</span></span>  
  
-   <span data-ttu-id="1c6ea-187">ASP.NET dedicado hospedado usando a Autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="1c6ea-188">Uma única instância do SQL Server Express pode ser hospedada em uma intranet.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="1c6ea-189">O aplicativo conecta-se usando a conta ASPNET do Windows, não usando representação.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="1c6ea-190">As instâncias de usuário não devem ser usadas para os cenários de hospedagem compartilhados ou de terceiros onde todos os aplicativos compartilhariam a mesma instância de usuário e não permanecessem isolados entre si.</span><span class="sxs-lookup"><span data-stu-id="1c6ea-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1c6ea-191">Consulte também</span><span class="sxs-lookup"><span data-stu-id="1c6ea-191">See Also</span></span>  
 <span data-ttu-id="1c6ea-192">[SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md) (SQL Server e ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="1c6ea-192">[SQL Server and ADO.NET](../../../../../docs/framework/data/adonet/sql/index.md)</span></span>  
 [<span data-ttu-id="1c6ea-193">Cadeia de Conexão</span><span class="sxs-lookup"><span data-stu-id="1c6ea-193">Connection Strings</span></span>](../../../../../docs/framework/data/adonet/connection-strings.md)  
 [<span data-ttu-id="1c6ea-194">Conectando a uma fonte de dados</span><span class="sxs-lookup"><span data-stu-id="1c6ea-194">Connecting to a Data Source</span></span>](../../../../../docs/framework/data/adonet/connecting-to-a-data-source.md)  
 <span data-ttu-id="1c6ea-195">[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917) (Central de desenvolvedores do DataSet e de provedores gerenciados do ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="1c6ea-195">[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)</span></span>
