---
title: Autorização e permissões no SQL Server
ms.date: 03/30/2017
ms.assetid: d340405c-91f4-4837-a3cc-a238ee89888a
ms.openlocfilehash: bdf5112e3f0e2cada4885b0b66adf248f0ffe808
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43661928"
---
# <a name="authorization-and-permissions-in-sql-server"></a><span data-ttu-id="d1b3d-102">Autorização e permissões no SQL Server</span><span class="sxs-lookup"><span data-stu-id="d1b3d-102">Authorization and Permissions in SQL Server</span></span>
<span data-ttu-id="d1b3d-103">Ao criar objetos de banco de dados, você deve conceder permissões explicitamente para torná-los acessíveis aos usuários.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-103">When you create database objects, you must explicitly grant permissions to make them accessible to users.</span></span> <span data-ttu-id="d1b3d-104">Cada objeto protegível tem permissões que podem ser concedidas a uma entidade de segurança usando declarações de permissão.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-104">Every securable object has permissions that can be granted to a principal using permission statements.</span></span>  
  
## <a name="the-principle-of-least-privilege"></a><span data-ttu-id="d1b3d-105">O princípio de privilégios mínimos</span><span class="sxs-lookup"><span data-stu-id="d1b3d-105">The Principle of Least Privilege</span></span>  
 <span data-ttu-id="d1b3d-106">Desenvolver um aplicativo usando uma abordagem LUA (conta de usuário com privilégios mínimos) é uma parte importante de uma estratégia detalhada defensiva para combater ameaças de segurança.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-106">Developing an application using a least-privileged user account (LUA) approach is an important part of a defensive, in-depth strategy for countering security threats.</span></span> <span data-ttu-id="d1b3d-107">A abordagem LUA garante que os usuários sigam o princípio de privilégios mínimos e sempre façam logon com contas de usuário limitadas.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-107">The LUA approach ensures that users follow the principle of least privilege and always log on with limited user accounts.</span></span> <span data-ttu-id="d1b3d-108">As tarefas administrativas são divididas usando funções de servidor fixas, e o uso da função de servidor fixa `sysadmin` é rigorosamente restrito.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-108">Administrative tasks are broken out using fixed server roles, and the use of the `sysadmin` fixed server role is severely restricted.</span></span>  
  
 <span data-ttu-id="d1b3d-109">Siga sempre o princípio de privilégios mínimos para conceder permissões aos usuários do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-109">Always follow the principle of least privilege when granting permissions to database users.</span></span> <span data-ttu-id="d1b3d-110">Conceda as permissões mínimas necessárias a um usuário ou a uma função para realizar uma determinada tarefa.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-110">Grant the minimum permissions necessary to a user or role to accomplish a given task.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="d1b3d-111">O desenvolvimento e o teste de um aplicativo usando a abordagem LUA adiciona um grau de dificuldade ao processo de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-111">Developing and testing an application using the LUA approach adds a degree of difficulty to the development process.</span></span> <span data-ttu-id="d1b3d-112">É mais fácil criar objetos e escrever código quando conectado como um administrador do sistema ou proprietário do banco de dados do que usando uma conta com LUA.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-112">It is easier to create objects and write code while logged on as a system administrator or database owner than it is using a LUA account.</span></span> <span data-ttu-id="d1b3d-113">No entanto, o desenvolvimento de aplicativos usando uma conta altamente privilegiada pode ofuscar o impacto da funcionalidade reduzida quando usuários com privilégios mínimos tentarem executar um aplicativo que exija permissões elevadas para funcionar corretamente.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-113">However, developing applications using a highly privileged account can obfuscate the impact of reduced functionality when least privileged users attempt to run an application that requires elevated permissions in order to function correctly.</span></span> <span data-ttu-id="d1b3d-114">Conceder permissões excessivas aos usuários para readquirir funcionalidade perdida pode deixar seu aplicativo vulnerável a ataque.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-114">Granting excessive permissions to users in order to reacquire lost functionality can leave your application vulnerable to attack.</span></span> <span data-ttu-id="d1b3d-115">A criação, o desenvolvimento e o teste de seu aplicativo conectado com uma conta com LUA impõe uma abordagem disciplinada ao planejamento de segurança, que elimina surpresas desagradáveis e a tentação de conceder privilégios elevados como uma solução rápida.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-115">Designing, developing and testing your application logged on with a LUA account enforces a disciplined approach to security planning that eliminates unpleasant surprises and the temptation to grant elevated privileges as a quick fix.</span></span> <span data-ttu-id="d1b3d-116">Você pode usar um logon do SQL Server para testar mesmo que seu aplicativo esteja destinado a ser implantado usando a autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-116">You can use a SQL Server login for testing even if your application is intended to deploy using Windows authentication.</span></span>  
  
## <a name="role-based-permissions"></a><span data-ttu-id="d1b3d-117">Permissões baseadas em função</span><span class="sxs-lookup"><span data-stu-id="d1b3d-117">Role-Based Permissions</span></span>  
 <span data-ttu-id="d1b3d-118">Conceder permissões a funções em vez de aos usuários simplifica a administração de segurança.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-118">Granting permissions to roles rather than to users simplifies security administration.</span></span> <span data-ttu-id="d1b3d-119">Os conjuntos de permissões que são atribuídos às funções são herdados por todos os membros da função.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-119">Permission sets that are assigned to roles are inherited by all members of the role.</span></span> <span data-ttu-id="d1b3d-120">É mais fácil adicionar ou remover usuários de uma função do que recriar conjuntos de permissões separados para usuários individuais.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-120">It is easier to add or remove users from a role than it is to recreate separate permission sets for individual users.</span></span> <span data-ttu-id="d1b3d-121">As funções podem ser aninhadas. No entanto, níveis de aninhamento excessivos podem prejudicar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-121">Roles can be nested; however, too many levels of nesting can degrade performance.</span></span> <span data-ttu-id="d1b3d-122">Você também pode adicionar usuários a funções de banco de dados fixas para simplificar a atribuição de permissões.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-122">You can also add users to fixed database roles to simplify assigning permissions.</span></span>  
  
 <span data-ttu-id="d1b3d-123">Você pode conceder permissões no nível de esquema.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-123">You can grant permissions at the schema level.</span></span> <span data-ttu-id="d1b3d-124">Os usuários herdam automaticamente permissões em todos os novos objetos criados no esquema. Você não precisa conceder permissões à medida que novos objetos são criados.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-124">Users automatically inherit permissions on all new objects created in the schema; you do not need to grant permissions as new objects are created.</span></span>  
  
## <a name="permissions-through-procedural-code"></a><span data-ttu-id="d1b3d-125">Permissões por meio de código procedural</span><span class="sxs-lookup"><span data-stu-id="d1b3d-125">Permissions Through Procedural Code</span></span>  
 <span data-ttu-id="d1b3d-126">O encapsulamento do acesso a dados por meio de módulos, como procedimentos armazenados e funções definidas pelo usuário, fornece uma camada adicional de proteção em torno do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-126">Encapsulating data access through modules such as stored procedures and user-defined functions provides an additional layer of protection around your application.</span></span> <span data-ttu-id="d1b3d-127">Você pode impedir que os usuários interajam diretamente com os objetos do banco de dados concedendo permissões somente a procedimentos armazenados ou funções e negando permissões para objetos subjacentes, como tabelas.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-127">You can prevent users from directly interacting with database objects by granting permissions only to stored procedures or functions while denying permissions to underlying objects such as tables.</span></span> <span data-ttu-id="d1b3d-128">O SQL Server obtém isso por meio do encadeamento de propriedade.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-128">SQL Server achieves this by ownership chaining.</span></span>  
  
## <a name="permission-statements"></a><span data-ttu-id="d1b3d-129">Instruções de permissão</span><span class="sxs-lookup"><span data-stu-id="d1b3d-129">Permission Statements</span></span>  
 <span data-ttu-id="d1b3d-130">As três instruções de permissão Transact-SQL são descritas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-130">The three Transact-SQL permission statements are described in the following table.</span></span>  
  
|<span data-ttu-id="d1b3d-131">Instrução de permissão</span><span class="sxs-lookup"><span data-stu-id="d1b3d-131">Permission Statement</span></span>|<span data-ttu-id="d1b3d-132">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1b3d-132">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="d1b3d-133">GRANT</span><span class="sxs-lookup"><span data-stu-id="d1b3d-133">GRANT</span></span>|<span data-ttu-id="d1b3d-134">Concede uma permissão.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-134">Grants a permission.</span></span>|  
|<span data-ttu-id="d1b3d-135">REVOKE</span><span class="sxs-lookup"><span data-stu-id="d1b3d-135">REVOKE</span></span>|<span data-ttu-id="d1b3d-136">Revoga uma permissão.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-136">Revokes a permission.</span></span> <span data-ttu-id="d1b3d-137">Esse é o estado padrão de um novo objeto.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-137">This is the default state of a new object.</span></span> <span data-ttu-id="d1b3d-138">Uma permissão revogada de um usuário ou de uma função ainda pode ser herdada de outros grupos ou funções aos quais a entidade de segurança está atribuída.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-138">A permission revoked from a user or role can still be inherited from other groups or roles to which the principal is assigned.</span></span>|  
|<span data-ttu-id="d1b3d-139">DENY</span><span class="sxs-lookup"><span data-stu-id="d1b3d-139">DENY</span></span>|<span data-ttu-id="d1b3d-140">DENY revoga uma permissão de modo que não possa ser herdada.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-140">DENY revokes a permission so that it cannot be inherited.</span></span> <span data-ttu-id="d1b3d-141">DENY tem precedência sobre todas as permissões, com a exceção de que DENY não se aplica a proprietários de objetos ou membros de `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-141">DENY takes precedence over all permissions, except DENY does not apply to object owners or members of `sysadmin`.</span></span> <span data-ttu-id="d1b3d-142">Se você NEGAR permissões em um objeto à função `public` ela será negada a todos os usuários e funções com exceção dos proprietários de objetos e membros de `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-142">If you DENY permissions on an object to the `public` role it is denied to all users and roles except for object owners and `sysadmin` members.</span></span>|  
  
-   <span data-ttu-id="d1b3d-143">A instrução GRANT pode atribuir permissões a um grupo ou a uma função, que podem ser herdadas por usuários do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-143">The GRANT statement can assign permissions to a group or role that can be inherited by database users.</span></span> <span data-ttu-id="d1b3d-144">No entanto, a instrução DENY tem precedência sobre quaisquer outras instruções de permissão.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-144">However, the DENY statement takes precedence over all other permission statements.</span></span> <span data-ttu-id="d1b3d-145">Portanto, um usuário para o qual uma permissão é negada não pode herdá-la de outra função.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-145">Therefore, a user who has been denied a permission cannot inherit it from another role.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d1b3d-146">As permissões não podem ser negadas para membros da função de servidor fixa `sysadmin` e proprietários de objetos.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-146">Members of the `sysadmin` fixed server role and object owners cannot be denied permissions.</span></span>  
  
## <a name="ownership-chains"></a><span data-ttu-id="d1b3d-147">Cadeias de propriedade</span><span class="sxs-lookup"><span data-stu-id="d1b3d-147">Ownership Chains</span></span>  
 <span data-ttu-id="d1b3d-148">O SQL Server garante que somente as entidades de segurança que receberam permissão podem acessar objetos.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-148">SQL Server ensures that only principals that have been granted permission can access objects.</span></span> <span data-ttu-id="d1b3d-149">Quando vários objetos de banco de dados acessam um ao outro, a sequência é conhecida como uma cadeia.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-149">When multiple database objects access each other, the sequence is known as a chain.</span></span> <span data-ttu-id="d1b3d-150">Quando o SQL Server está atravessando os links na cadeia, ele avalia as permissões de maneira diferente do que avaliaria se estivesse acessando cada item separadamente.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-150">When SQL Server is traversing the links in the chain, it evaluates permissions differently than it would if it were accessing each item separately.</span></span> <span data-ttu-id="d1b3d-151">Quando um objeto é acessado por meio de uma cadeia, o SQL Server primeiro compara o proprietário do objeto com o proprietário do objeto de chamada (o link anterior na cadeia).</span><span class="sxs-lookup"><span data-stu-id="d1b3d-151">When an object is accessed through a chain, SQL Server first compares the object's owner to the owner of the calling object (the previous link in the chain).</span></span> <span data-ttu-id="d1b3d-152">Se os dois objetos tiverem o mesmo proprietário, as permissões do objeto referenciado não serão verificadas.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-152">If both objects have the same owner, permissions on the referenced object are not checked.</span></span> <span data-ttu-id="d1b3d-153">Sempre que um objeto acessa outro objeto que tem um proprietário diferente, a cadeia de propriedade é interrompida e o SQL Server deve verificar o contexto de segurança do chamador.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-153">Whenever an object accesses another object that has a different owner, the ownership chain is broken and SQL Server must check the caller's security context.</span></span>  
  
## <a name="procedural-code-and-ownership-chaining"></a><span data-ttu-id="d1b3d-154">Código procedural e encadeamento de propriedade</span><span class="sxs-lookup"><span data-stu-id="d1b3d-154">Procedural Code and Ownership Chaining</span></span>  
 <span data-ttu-id="d1b3d-155">Suponha que um usuário receba permissões de execução em um procedimento armazenado que seleciona dados de uma tabela.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-155">Suppose that a user is granted execute permissions on a stored procedure that selects data from a table.</span></span> <span data-ttu-id="d1b3d-156">Se o procedimento armazenado e a tabela tiverem o mesmo proprietário, o usuário não precisará receber nenhuma permissão na tabela e pode até ter permissões negadas.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-156">If the stored procedure and the table have the same owner, the user doesn't need to be granted any permissions on the table and can even be denied permissions.</span></span> <span data-ttu-id="d1b3d-157">Entretanto, se o procedimento armazenado e a tabela tiverem proprietários diferentes, o SQL Server deverá verificar as permissões do usuário na tabela antes de permitir acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-157">However, if the stored procedure and the table have different owners, SQL Server must check the user's permissions on the table before allowing access to the data.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d1b3d-158">O encadeamento de propriedade não se aplica no caso de instruções SQL dinâmicas.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-158">Ownership chaining does not apply in the case of dynamic SQL statements.</span></span> <span data-ttu-id="d1b3d-159">Para chamar um procedimento que executa uma instrução SQL, o chamador deve ter recebido permissões nas tabelas subjacentes, deixando seu aplicativo vulnerável ao ataque de injeção de SQL.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-159">To call a procedure that executes an SQL statement, the caller must be granted permissions on the underlying tables, leaving your application vulnerable to SQL Injection attack.</span></span> <span data-ttu-id="d1b3d-160">O SQL Server fornece novos mecanismos, como a representação e módulos de assinatura com certificados, que não requerem a concessão de permissões nas tabelas subjacentes.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-160">SQL Server provides new mechanisms, such as impersonation and signing modules with certificates, that do not require granting permissions on the underlying tables.</span></span> <span data-ttu-id="d1b3d-161">Eles também podem ser usados com procedimentos armazenados CLR.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-161">These can also be used with CLR stored procedures.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="d1b3d-162">Recursos externos</span><span class="sxs-lookup"><span data-stu-id="d1b3d-162">External Resources</span></span>  
 <span data-ttu-id="d1b3d-163">Para obter mais informações, consulte os seguintes recursos.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-163">For more information, see the following resources.</span></span>  
  
|<span data-ttu-id="d1b3d-164">Recurso</span><span class="sxs-lookup"><span data-stu-id="d1b3d-164">Resource</span></span>|<span data-ttu-id="d1b3d-165">Descrição</span><span class="sxs-lookup"><span data-stu-id="d1b3d-165">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="d1b3d-166">Permissões</span><span class="sxs-lookup"><span data-stu-id="d1b3d-166">Permissions</span></span>](/sql/relational-databases/security/permissions-database-engine)|<span data-ttu-id="d1b3d-167">Contém tópicos que descrevem a hierarquia de permissões, os modos de exibição do catálogo e as permissões de funções fixas do servidor e do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="d1b3d-167">Contains topics describing permissions hierarchy, catalog views, and permissions of fixed server and database roles.</span></span>|
  
## <a name="see-also"></a><span data-ttu-id="d1b3d-168">Consulte também</span><span class="sxs-lookup"><span data-stu-id="d1b3d-168">See Also</span></span>  
 <span data-ttu-id="d1b3d-169">[Securing ADO.NET Applications](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md) (Protegendo aplicativos ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="d1b3d-169">[Securing ADO.NET Applications](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)</span></span>  
 [<span data-ttu-id="d1b3d-170">Cenários de segurança do aplicativo no SQL Server</span><span class="sxs-lookup"><span data-stu-id="d1b3d-170">Application Security Scenarios in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/application-security-scenarios-in-sql-server.md)  
 [<span data-ttu-id="d1b3d-171">Autenticação no SQL Server</span><span class="sxs-lookup"><span data-stu-id="d1b3d-171">Authentication in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/authentication-in-sql-server.md)  
 [<span data-ttu-id="d1b3d-172">Servidor e funções de banco de dados no SQL Server</span><span class="sxs-lookup"><span data-stu-id="d1b3d-172">Server and Database Roles in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/server-and-database-roles-in-sql-server.md)  
 [<span data-ttu-id="d1b3d-173">Propriedade e separação do esquema de usuário no SQL Server</span><span class="sxs-lookup"><span data-stu-id="d1b3d-173">Ownership and User-Schema Separation in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/ownership-and-user-schema-separation-in-sql-server.md)  
 <span data-ttu-id="d1b3d-174">[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917) (Central de desenvolvedores do DataSet e de provedores gerenciados do ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="d1b3d-174">[ADO.NET Managed Providers and DataSet Developer Center](https://go.microsoft.com/fwlink/?LinkId=217917)</span></span>
