---
title: "Configurando parâmetros e tipos de dados de parâmetro"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: "6"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: a71ba7ed12196184b7e826ed70c92a9873efdb0c
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/17/2018
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="c24bc-102">Configurando parâmetros e tipos de dados de parâmetro</span><span class="sxs-lookup"><span data-stu-id="c24bc-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="c24bc-103">Objetos de comando usam parâmetros para passar valores para instruções SQL ou procedimentos armazenados, fornecendo verificação de tipo e validação.</span><span class="sxs-lookup"><span data-stu-id="c24bc-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="c24bc-104">Diferentemente do texto de comando, o parâmetro de entrada é tratado como um valor literal, não como código executável.</span><span class="sxs-lookup"><span data-stu-id="c24bc-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="c24bc-105">Isso ajuda a proteger contra ataques de "Injeção de SQL", em que um invasor insere um comando que compromete a segurança no servidor em uma instrução SQL.</span><span class="sxs-lookup"><span data-stu-id="c24bc-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="c24bc-106">Os comandos parametrizados também podem melhorar o desempenho de execução da consulta, porque ajudam o servidor de banco de dados a corresponder exatamente ao comando de entrada com um plano de consulta em cache apropriado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="c24bc-107">Para obter mais informações, consulte [cache de plano de execução e reutilização](http://go.microsoft.com/fwlink/?LinkId=120424) e [parâmetros e reutilizar o plano de execução](http://go.microsoft.com/fwlink/?LinkId=120423) nos Manuais Online do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c24bc-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="c24bc-108">Além dos benefícios de segurança e desempenho, os comandos parametrizados fornecem um método conveniente para organizar os valores passados para uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c24bc-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="c24bc-109">Um objeto <xref:System.Data.Common.DbParameter> pode ser criado usando o construtor ou adicionando-o ao <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> chamando o método `Add` da coleção <xref:System.Data.Common.DbParameterCollection>.</span><span class="sxs-lookup"><span data-stu-id="c24bc-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="c24bc-110">O método `Add` utilizará como entrada argumentos de construtor ou um objeto de parâmetro existente, dependendo do provedor de dados.</span><span class="sxs-lookup"><span data-stu-id="c24bc-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="c24bc-111">Fornecendo a propriedade ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="c24bc-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="c24bc-112">Ao adicionar parâmetros, você deverá fornecer uma propriedade <xref:System.Data.ParameterDirection> para parâmetros diferentes dos parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="c24bc-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="c24bc-113">A tabela a seguir mostra os valores `ParameterDirection` que você pode usar com a enumeração <xref:System.Data.ParameterDirection>.</span><span class="sxs-lookup"><span data-stu-id="c24bc-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="c24bc-114">Nome do membro</span><span class="sxs-lookup"><span data-stu-id="c24bc-114">Member name</span></span>|<span data-ttu-id="c24bc-115">Descrição</span><span class="sxs-lookup"><span data-stu-id="c24bc-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="c24bc-116">O parâmetro é um parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="c24bc-116">The parameter is an input parameter.</span></span> <span data-ttu-id="c24bc-117">Esse é o padrão.</span><span class="sxs-lookup"><span data-stu-id="c24bc-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="c24bc-118">O parâmetro pode executar entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="c24bc-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="c24bc-119">O parâmetro é um parâmetro de saída.</span><span class="sxs-lookup"><span data-stu-id="c24bc-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="c24bc-120">O parâmetro representa um valor de retorno de uma operação como um procedimento armazenado, uma função interna ou uma função definida pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="c24bc-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="c24bc-121">Trabalhando com espaços reservados de parâmetro</span><span class="sxs-lookup"><span data-stu-id="c24bc-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="c24bc-122">A sintaxe para espaços reservados de parâmetro depende da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c24bc-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="c24bc-123">Os provedores de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] manipulam a nomeação e a especificação de parâmetros e de espaços reservados de parâmetros de maneira diferente.</span><span class="sxs-lookup"><span data-stu-id="c24bc-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="c24bc-124">Essa sintaxe é personalizada para uma fonte de dados específica, conforme descrito na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="c24bc-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="c24bc-125">Provedor de dados</span><span class="sxs-lookup"><span data-stu-id="c24bc-125">Data provider</span></span>|<span data-ttu-id="c24bc-126">Sintaxe de nomeação de parâmetro</span><span class="sxs-lookup"><span data-stu-id="c24bc-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="c24bc-127">Usa parâmetros nomeados em formato `@` *parametername*.</span><span class="sxs-lookup"><span data-stu-id="c24bc-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="c24bc-128">Usa os marcadores de parâmetros posicionais indicados por um ponto de interrogação (`?`).</span><span class="sxs-lookup"><span data-stu-id="c24bc-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="c24bc-129">Usa os marcadores de parâmetros posicionais indicados por um ponto de interrogação (`?`).</span><span class="sxs-lookup"><span data-stu-id="c24bc-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="c24bc-130">Usa parâmetros nomeados em formato `:` *parmname* (ou *parmname*).</span><span class="sxs-lookup"><span data-stu-id="c24bc-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="c24bc-131">Especificando tipos de dados do parâmetro</span><span class="sxs-lookup"><span data-stu-id="c24bc-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="c24bc-132">O tipo de dados de um parâmetro é específico para o provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c24bc-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="c24bc-133">Especificar o tipo converte o valor do `Parameter` para o tipo de provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] antes de passar o valor para a fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="c24bc-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="c24bc-134">Você também pode especificar o tipo de um `Parameter` genericamente definindo a propriedade `DbType` de um objeto `Parameter` para um <xref:System.Data.DbType> específico.</span><span class="sxs-lookup"><span data-stu-id="c24bc-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="c24bc-135">O tipo do provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] de um objeto `Parameter` é inferido do tipo do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] do `Value` do objeto de `Parameter` ou do `DbType` do objeto de `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="c24bc-136">A tabela a seguir mostra o tipo inferido de `Parameter` baseado no objeto passado como o valor do `Parameter` ou `DbType` especificado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="c24bc-137">Tipo do .NET Framework</span><span class="sxs-lookup"><span data-stu-id="c24bc-137">.NET Framework type</span></span>|<span data-ttu-id="c24bc-138">DbType</span><span class="sxs-lookup"><span data-stu-id="c24bc-138">DbType</span></span>|<span data-ttu-id="c24bc-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="c24bc-139">SqlDbType</span></span>|<span data-ttu-id="c24bc-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="c24bc-140">OleDbType</span></span>|<span data-ttu-id="c24bc-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="c24bc-141">OdbcType</span></span>|<span data-ttu-id="c24bc-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="c24bc-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="c24bc-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="c24bc-143">Boolean</span></span>|<span data-ttu-id="c24bc-144">Bit</span><span class="sxs-lookup"><span data-stu-id="c24bc-144">Bit</span></span>|<span data-ttu-id="c24bc-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="c24bc-145">Boolean</span></span>|<span data-ttu-id="c24bc-146">Bit</span><span class="sxs-lookup"><span data-stu-id="c24bc-146">Bit</span></span>|<span data-ttu-id="c24bc-147">Byte</span><span class="sxs-lookup"><span data-stu-id="c24bc-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="c24bc-148">Byte</span><span class="sxs-lookup"><span data-stu-id="c24bc-148">Byte</span></span>|<span data-ttu-id="c24bc-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-149">TinyInt</span></span>|<span data-ttu-id="c24bc-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-150">UnsignedTinyInt</span></span>|<span data-ttu-id="c24bc-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-151">TinyInt</span></span>|<span data-ttu-id="c24bc-152">Byte</span><span class="sxs-lookup"><span data-stu-id="c24bc-152">Byte</span></span>|  
|<span data-ttu-id="c24bc-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="c24bc-153">byte[]</span></span>|<span data-ttu-id="c24bc-154">Binário</span><span class="sxs-lookup"><span data-stu-id="c24bc-154">Binary</span></span>|<span data-ttu-id="c24bc-155">VarBinary`.` essa conversão implícita falhará se a matriz de bytes for maior que o tamanho máximo de um VarBinary, que é de 8000 bytes. Para matrizes de bytes maiores que 8000 bytes, defina explicitamente o <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="c24bc-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="c24bc-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="c24bc-156">VarBinary</span></span>|<span data-ttu-id="c24bc-157">Binário</span><span class="sxs-lookup"><span data-stu-id="c24bc-157">Binary</span></span>|<span data-ttu-id="c24bc-158">Raw</span><span class="sxs-lookup"><span data-stu-id="c24bc-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="c24bc-159">Inferir um <xref:System.Data.SqlDbType> do char não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="c24bc-160">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-160">Char</span></span>|<span data-ttu-id="c24bc-161">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-161">Char</span></span>|<span data-ttu-id="c24bc-162">Byte</span><span class="sxs-lookup"><span data-stu-id="c24bc-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="c24bc-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-163">DateTime</span></span>|<span data-ttu-id="c24bc-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-164">DateTime</span></span>|<span data-ttu-id="c24bc-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="c24bc-165">DBTimeStamp</span></span>|<span data-ttu-id="c24bc-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-166">DateTime</span></span>|<span data-ttu-id="c24bc-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="c24bc-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c24bc-168">DateTimeOffset</span></span>|<span data-ttu-id="c24bc-169">DateTimeOffset no SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="c24bc-170">Inferir um <xref:System.Data.SqlDbType> de DateTimeOffset não tem suporte em versões do SQL Server anteriores ao SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="c24bc-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="c24bc-172">Decimal</span><span class="sxs-lookup"><span data-stu-id="c24bc-172">Decimal</span></span>|<span data-ttu-id="c24bc-173">Decimal</span><span class="sxs-lookup"><span data-stu-id="c24bc-173">Decimal</span></span>|<span data-ttu-id="c24bc-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="c24bc-174">Decimal</span></span>|<span data-ttu-id="c24bc-175">Numeric</span><span class="sxs-lookup"><span data-stu-id="c24bc-175">Numeric</span></span>|<span data-ttu-id="c24bc-176">Número</span><span class="sxs-lookup"><span data-stu-id="c24bc-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="c24bc-177">Duplo</span><span class="sxs-lookup"><span data-stu-id="c24bc-177">Double</span></span>|<span data-ttu-id="c24bc-178">Float</span><span class="sxs-lookup"><span data-stu-id="c24bc-178">Float</span></span>|<span data-ttu-id="c24bc-179">Duplo</span><span class="sxs-lookup"><span data-stu-id="c24bc-179">Double</span></span>|<span data-ttu-id="c24bc-180">Duplo</span><span class="sxs-lookup"><span data-stu-id="c24bc-180">Double</span></span>|<span data-ttu-id="c24bc-181">Duplo</span><span class="sxs-lookup"><span data-stu-id="c24bc-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="c24bc-182">Simples</span><span class="sxs-lookup"><span data-stu-id="c24bc-182">Single</span></span>|<span data-ttu-id="c24bc-183">Real</span><span class="sxs-lookup"><span data-stu-id="c24bc-183">Real</span></span>|<span data-ttu-id="c24bc-184">Simples</span><span class="sxs-lookup"><span data-stu-id="c24bc-184">Single</span></span>|<span data-ttu-id="c24bc-185">Real</span><span class="sxs-lookup"><span data-stu-id="c24bc-185">Real</span></span>|<span data-ttu-id="c24bc-186">Float</span><span class="sxs-lookup"><span data-stu-id="c24bc-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="c24bc-187">Guid</span><span class="sxs-lookup"><span data-stu-id="c24bc-187">Guid</span></span>|<span data-ttu-id="c24bc-188">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="c24bc-188">UniqueIdentifier</span></span>|<span data-ttu-id="c24bc-189">Guid</span><span class="sxs-lookup"><span data-stu-id="c24bc-189">Guid</span></span>|<span data-ttu-id="c24bc-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="c24bc-190">UniqueIdentifier</span></span>|<span data-ttu-id="c24bc-191">Raw</span><span class="sxs-lookup"><span data-stu-id="c24bc-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="c24bc-192">Int16</span><span class="sxs-lookup"><span data-stu-id="c24bc-192">Int16</span></span>|<span data-ttu-id="c24bc-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-193">SmallInt</span></span>|<span data-ttu-id="c24bc-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-194">SmallInt</span></span>|<span data-ttu-id="c24bc-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-195">SmallInt</span></span>|<span data-ttu-id="c24bc-196">Int16</span><span class="sxs-lookup"><span data-stu-id="c24bc-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="c24bc-197">Int32</span><span class="sxs-lookup"><span data-stu-id="c24bc-197">Int32</span></span>|<span data-ttu-id="c24bc-198">int</span><span class="sxs-lookup"><span data-stu-id="c24bc-198">Int</span></span>|<span data-ttu-id="c24bc-199">int</span><span class="sxs-lookup"><span data-stu-id="c24bc-199">Int</span></span>|<span data-ttu-id="c24bc-200">int</span><span class="sxs-lookup"><span data-stu-id="c24bc-200">Int</span></span>|<span data-ttu-id="c24bc-201">Int32</span><span class="sxs-lookup"><span data-stu-id="c24bc-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="c24bc-202">Int64</span><span class="sxs-lookup"><span data-stu-id="c24bc-202">Int64</span></span>|<span data-ttu-id="c24bc-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-203">BigInt</span></span>|<span data-ttu-id="c24bc-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-204">BigInt</span></span>|<span data-ttu-id="c24bc-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-205">BigInt</span></span>|<span data-ttu-id="c24bc-206">Número</span><span class="sxs-lookup"><span data-stu-id="c24bc-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="c24bc-207">Objeto</span><span class="sxs-lookup"><span data-stu-id="c24bc-207">Object</span></span>|<span data-ttu-id="c24bc-208">Variante</span><span class="sxs-lookup"><span data-stu-id="c24bc-208">Variant</span></span>|<span data-ttu-id="c24bc-209">Variante</span><span class="sxs-lookup"><span data-stu-id="c24bc-209">Variant</span></span>|<span data-ttu-id="c24bc-210">Inferir um OdbcType de objeto não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="c24bc-211">Blob</span><span class="sxs-lookup"><span data-stu-id="c24bc-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="c24bc-212">Cadeia de Caracteres</span><span class="sxs-lookup"><span data-stu-id="c24bc-212">String</span></span>|<span data-ttu-id="c24bc-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="c24bc-213">NVarChar.</span></span> <span data-ttu-id="c24bc-214">Essa conversão implícita falhará se a cadeia de caracteres for maior do que o tamanho máximo de um NVarChar, que é 4000 caracteres.</span><span class="sxs-lookup"><span data-stu-id="c24bc-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="c24bc-215">Para cadeias de caracteres maiores que 4000 caracteres, defina explicitamente o <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="c24bc-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="c24bc-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-216">VarWChar</span></span>|<span data-ttu-id="c24bc-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-217">NVarChar</span></span>|<span data-ttu-id="c24bc-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="c24bc-219">Hora</span><span class="sxs-lookup"><span data-stu-id="c24bc-219">Time</span></span>|<span data-ttu-id="c24bc-220">Hora no SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="c24bc-221">Inferir um <xref:System.Data.SqlDbType> de TimeSpan não tem suporte em versões do SQL Server anteriores ao SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c24bc-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-222">DBTime</span></span>|<span data-ttu-id="c24bc-223">Hora</span><span class="sxs-lookup"><span data-stu-id="c24bc-223">Time</span></span>|<span data-ttu-id="c24bc-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="c24bc-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="c24bc-225">UInt16</span></span>|<span data-ttu-id="c24bc-226">Inferir um <xref:System.Data.SqlDbType> do UInt16 não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="c24bc-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-227">UnsignedSmallInt</span></span>|<span data-ttu-id="c24bc-228">int</span><span class="sxs-lookup"><span data-stu-id="c24bc-228">Int</span></span>|<span data-ttu-id="c24bc-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="c24bc-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="c24bc-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="c24bc-230">UInt32</span></span>|<span data-ttu-id="c24bc-231">Inferir um <xref:System.Data.SqlDbType> do UInt32 não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="c24bc-232">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-232">UnsignedInt</span></span>|<span data-ttu-id="c24bc-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-233">BigInt</span></span>|<span data-ttu-id="c24bc-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="c24bc-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="c24bc-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="c24bc-235">UInt64</span></span>|<span data-ttu-id="c24bc-236">Inferir um <xref:System.Data.SqlDbType> do UInt64 não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="c24bc-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-237">UnsignedBigInt</span></span>|<span data-ttu-id="c24bc-238">Numeric</span><span class="sxs-lookup"><span data-stu-id="c24bc-238">Numeric</span></span>|<span data-ttu-id="c24bc-239">Número</span><span class="sxs-lookup"><span data-stu-id="c24bc-239">Number</span></span>|  
||<span data-ttu-id="c24bc-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="c24bc-240">AnsiString</span></span>|<span data-ttu-id="c24bc-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-241">VarChar</span></span>|<span data-ttu-id="c24bc-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-242">VarChar</span></span>|<span data-ttu-id="c24bc-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-243">VarChar</span></span>|<span data-ttu-id="c24bc-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-244">VarChar</span></span>|  
||<span data-ttu-id="c24bc-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="c24bc-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="c24bc-246">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-246">Char</span></span>|<span data-ttu-id="c24bc-247">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-247">Char</span></span>|<span data-ttu-id="c24bc-248">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-248">Char</span></span>|<span data-ttu-id="c24bc-249">Char</span><span class="sxs-lookup"><span data-stu-id="c24bc-249">Char</span></span>|  
|``|<span data-ttu-id="c24bc-250">Moeda</span><span class="sxs-lookup"><span data-stu-id="c24bc-250">Currency</span></span>|<span data-ttu-id="c24bc-251">Money</span><span class="sxs-lookup"><span data-stu-id="c24bc-251">Money</span></span>|<span data-ttu-id="c24bc-252">Moeda</span><span class="sxs-lookup"><span data-stu-id="c24bc-252">Currency</span></span>|<span data-ttu-id="c24bc-253">Inferir um `OdbcType` de `Currency` não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="c24bc-254">Número</span><span class="sxs-lookup"><span data-stu-id="c24bc-254">Number</span></span>|  
|``|<span data-ttu-id="c24bc-255">Date</span><span class="sxs-lookup"><span data-stu-id="c24bc-255">Date</span></span>|<span data-ttu-id="c24bc-256">Data no SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="c24bc-257">Inferir um <xref:System.Data.SqlDbType> de Date não tem suporte em versões do SQL Server anteriores ao SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c24bc-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="c24bc-258">DBDate</span></span>|<span data-ttu-id="c24bc-259">Date</span><span class="sxs-lookup"><span data-stu-id="c24bc-259">Date</span></span>|<span data-ttu-id="c24bc-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-260">DateTime</span></span>|  
|``|<span data-ttu-id="c24bc-261">SByte</span><span class="sxs-lookup"><span data-stu-id="c24bc-261">SByte</span></span>|<span data-ttu-id="c24bc-262">Inferir um <xref:System.Data.SqlDbType> do SByte não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="c24bc-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c24bc-263">TinyInt</span></span>|<span data-ttu-id="c24bc-264">Inferir um `OdbcType` do SByte não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="c24bc-265">SByte</span><span class="sxs-lookup"><span data-stu-id="c24bc-265">SByte</span></span>|  
||<span data-ttu-id="c24bc-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="c24bc-266">StringFixedLength</span></span>|<span data-ttu-id="c24bc-267">NChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-267">NChar</span></span>|<span data-ttu-id="c24bc-268">WChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-268">WChar</span></span>|<span data-ttu-id="c24bc-269">NChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-269">NChar</span></span>|<span data-ttu-id="c24bc-270">NChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-270">NChar</span></span>|  
||<span data-ttu-id="c24bc-271">Hora</span><span class="sxs-lookup"><span data-stu-id="c24bc-271">Time</span></span>|<span data-ttu-id="c24bc-272">Hora no SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="c24bc-273">Inferir um <xref:System.Data.SqlDbType> de Time não tem suporte em versões do SQL Server anteriores ao SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c24bc-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c24bc-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-274">DBTime</span></span>|<span data-ttu-id="c24bc-275">Hora</span><span class="sxs-lookup"><span data-stu-id="c24bc-275">Time</span></span>|<span data-ttu-id="c24bc-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="c24bc-276">DateTime</span></span>|  
||<span data-ttu-id="c24bc-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="c24bc-277">VarNumeric</span></span>|<span data-ttu-id="c24bc-278">Inferir um <xref:System.Data.SqlDbType> do VarNumeric não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="c24bc-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="c24bc-279">VarNumeric</span></span>|<span data-ttu-id="c24bc-280">Inferir um `OdbcType` do VarNumeric não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="c24bc-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="c24bc-281">Número</span><span class="sxs-lookup"><span data-stu-id="c24bc-281">Number</span></span>|  
|<span data-ttu-id="c24bc-282">tipo definido pelo usuário (um objeto com <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="c24bc-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="c24bc-283">Objeto ou cadeia de caracteres, dependendo do provedor (SqlClient sempre retorna um objeto, ODBC sempre retorna uma cadeia de caracteres e o provedor de dados gerenciados OleDb pode ver se</span><span class="sxs-lookup"><span data-stu-id="c24bc-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="c24bc-284">SqlDbType.Udt se <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> está presente, caso contrário Variant</span><span class="sxs-lookup"><span data-stu-id="c24bc-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="c24bc-285">OleDbType.VarWChar (se o valor for nulo); caso contrário OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="c24bc-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="c24bc-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="c24bc-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="c24bc-287">sem suporte</span><span class="sxs-lookup"><span data-stu-id="c24bc-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="c24bc-288">Conversões de decimal para outros tipos são conversões de limitação que arredondam o valor decimal para o valor inteiro mais próximo de zero.</span><span class="sxs-lookup"><span data-stu-id="c24bc-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="c24bc-289">Se o resultado da conversão não for representável no tipo de destino, um <xref:System.OverflowException> será gerado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c24bc-290">Quando você envia um valor do parâmetro nulo para o servidor, deve especificar <xref:System.DBNull>, não `null` (`Nothing` no [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="c24bc-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="c24bc-291">O valor nulo no sistema é um objeto vazio que não tem nenhum valor.</span><span class="sxs-lookup"><span data-stu-id="c24bc-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="c24bc-292"><xref:System.DBNull> é usado para representar valores nulos.</span><span class="sxs-lookup"><span data-stu-id="c24bc-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="c24bc-293">Para obter mais informações sobre valores nulos de banco de dados, consulte [tratar valores nulos](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="c24bc-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="c24bc-294">Derivando informações de parâmetro</span><span class="sxs-lookup"><span data-stu-id="c24bc-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="c24bc-295">Os parâmetros também podem ser derivados de um procedimento armazenado usando a classe `DbCommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="c24bc-296">As classes `SqlCommandBuilder` e `OleDbCommandBuilder` fornecem um método estático, `DeriveParameters`, que preenche automaticamente a coleção de parâmetros de um objeto de comando que usa informações de parâmetro de um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="c24bc-297">Observe que `DeriveParameters` substitui quaisquer informações de parâmetro existente para o comando.</span><span class="sxs-lookup"><span data-stu-id="c24bc-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c24bc-298">Derivar informações de parâmetro provoca uma penalidade de desempenho porque exige ida e volta adicional à fonte de dados para recuperar as informações.</span><span class="sxs-lookup"><span data-stu-id="c24bc-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="c24bc-299">Se as informações de parâmetro forem conhecidas em tempo de design, você poderá melhorar o desempenho do seu aplicativo definindo os parâmetros explicitamente.</span><span class="sxs-lookup"><span data-stu-id="c24bc-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="c24bc-300">Para obter mais informações, consulte [gerar comandos com CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="c24bc-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="c24bc-301">Usando parâmetros com um SqlCommand e um procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="c24bc-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="c24bc-302">Os procedimentos armazenados oferecem várias vantagens em aplicativos orientados a dados.</span><span class="sxs-lookup"><span data-stu-id="c24bc-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="c24bc-303">Ao usar procedimentos armazenados, as operações de banco de dados podem ser encapsuladas em um único comando, otimizadas para melhor desempenho e aprimoradas com segurança adicional.</span><span class="sxs-lookup"><span data-stu-id="c24bc-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="c24bc-304">Embora um procedimento armazenado pode ser chamado, passando o nome do procedimento armazenado seguido por argumentos de parâmetro como uma instrução SQL, usando o <xref:System.Data.Common.DbCommand.Parameters%2A> coleção do [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> objeto permite que você definir explicitamente mais armazenado parâmetros de procedimento e para acessar parâmetros de saída e valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="c24bc-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c24bc-305">As instruções parametrizadas são executadas no servidor usando `sp_executesql,` que permite a reutilização do plano de consulta.</span><span class="sxs-lookup"><span data-stu-id="c24bc-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="c24bc-306">Os cursores locais ou variáveis no lote `sp_executesql` não são visíveis para os lotes que chamam `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="c24bc-307">As alterações no contexto de banco de dados duram somente até o final da instrução `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="c24bc-308">Para obter mais informações, consulte os Manuais Online do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c24bc-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="c24bc-309">Ao usar parâmetros com um <xref:System.Data.SqlClient.SqlCommand> para executar um procedimento armazenado do SQL Server, os nomes dos parâmetros adicionados à coleção de <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> devem coincidir com os nomes dos marcadores de parâmetros no procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="c24bc-310">O provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para o SQL Server não oferece suporte ao espaço reservado de ponto de interrogação (?) para passar parâmetros para uma instrução SQL ou procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="c24bc-311">Ele trata parâmetros no procedimento armazenado como parâmetros nomeados e procura marcadores de parâmetro compatíveis.</span><span class="sxs-lookup"><span data-stu-id="c24bc-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="c24bc-312">Por exemplo, o procedimento armazenado `CustOrderHist` é definido usando um parâmetro chamado `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="c24bc-313">Quando o código executar o procedimento armazenado, também deverá usar um parâmetro chamado `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="c24bc-314">Exemplo</span><span class="sxs-lookup"><span data-stu-id="c24bc-314">Example</span></span>  
 <span data-ttu-id="c24bc-315">Este exemplo demonstra como chamar um procedimento armazenado do SQL Server no banco de dados de exemplo `Northwind`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="c24bc-316">O nome do procedimento armazenado é `dbo.SalesByCategory` e tem um parâmetro de entrada chamado `@CategoryName` com um tipo de dados de `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="c24bc-317">O código cria um novo <xref:System.Data.SqlClient.SqlConnection> dentro de um bloco using para que a conexão seja descartada quando o procedimento terminar.</span><span class="sxs-lookup"><span data-stu-id="c24bc-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="c24bc-318">Os objetos <xref:System.Data.SqlClient.SqlCommand> e <xref:System.Data.SqlClient.SqlParameter> são criados e suas propriedades são definidas.</span><span class="sxs-lookup"><span data-stu-id="c24bc-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="c24bc-319">Um <xref:System.Data.SqlClient.SqlDataReader> executa o `SqlCommand` e retorna o conjunto de resultados do procedimento armazenado, exibindo a saída na janela do console.</span><span class="sxs-lookup"><span data-stu-id="c24bc-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c24bc-320">Em vez de criar objetos `SqlCommand` e `SqlParameter` e depois definir as propriedades em instruções separadas, você poderá eleger usar um dos construtores sobrecarregados para definir várias propriedades em uma única instrução.</span><span class="sxs-lookup"><span data-stu-id="c24bc-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="c24bc-321">Usando parâmetros com um OleDbCommand ou um OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="c24bc-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="c24bc-322">Ao usar parâmetros com um <xref:System.Data.OleDb.OleDbCommand> ou <xref:System.Data.Odbc.OdbcCommand>, a ordem dos parâmetros adicionados à coleção de `Parameters` deve coincidir com a ordem dos parâmetros definidos no procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="c24bc-323">O Provedor de Dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para OLE DB e o provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para ODBC lidam com parâmetros em um procedimento armazenado como espaços reservados e aplicam valores de parâmetro na ordem.</span><span class="sxs-lookup"><span data-stu-id="c24bc-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="c24bc-324">Além disso, os parâmetros do valor de retorno devem ser os primeiros parâmetros adicionados à coleção de `Parameters`.</span><span class="sxs-lookup"><span data-stu-id="c24bc-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="c24bc-325">O provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para OLE DB e o provedor de dados do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para ODBC não oferecem suporte aos parâmetros nomeados para passar parâmetros para uma instrução SQL ou procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="c24bc-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="c24bc-326">Nesse caso, você deverá usar o espaço reservado de ponto de interrogação (?), como no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="c24bc-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="c24bc-327">Como resultado, a ordem na qual os objetos `Parameter` são adicionados à coleção de `Parameters` deve corresponder diretamente à posição do espaço reservado do ?</span><span class="sxs-lookup"><span data-stu-id="c24bc-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="c24bc-328">para o parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c24bc-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="c24bc-329">Exemplo de OleDb</span><span class="sxs-lookup"><span data-stu-id="c24bc-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="c24bc-330">Exemplo de ODBC</span><span class="sxs-lookup"><span data-stu-id="c24bc-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="c24bc-331">Consulte também</span><span class="sxs-lookup"><span data-stu-id="c24bc-331">See Also</span></span>  
 [<span data-ttu-id="c24bc-332">Comandos e parâmetros</span><span class="sxs-lookup"><span data-stu-id="c24bc-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="c24bc-333">Parâmetros DataAdapter</span><span class="sxs-lookup"><span data-stu-id="c24bc-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 <span data-ttu-id="c24bc-334">[Data Type Mappings in ADO.NET](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md) (Mapeamentos de tipo de dados no ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="c24bc-334">[Data Type Mappings in ADO.NET](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)</span></span>  
 <span data-ttu-id="c24bc-335">[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917) (Central de desenvolvedores do DataSet e de provedores gerenciados do ADO.NET)</span><span class="sxs-lookup"><span data-stu-id="c24bc-335">[ADO.NET Managed Providers and DataSet Developer Center](http://go.microsoft.com/fwlink/?LinkId=217917)</span></span>
