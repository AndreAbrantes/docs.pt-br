---
title: Carregamento adiado conteúdo (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, deferred content
- WCF Data Services, loading data
ms.assetid: 32f9b588-c832-44c4-a7e0-fcce635df59a
ms.openlocfilehash: 8ab4dea9e4f687f9548bb2b46a8f6baf428e29af
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33365196"
---
# <a name="loading-deferred-content-wcf-data-services"></a><span data-ttu-id="0fdc8-102">Carregamento adiado conteúdo (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="0fdc8-102">Loading Deferred Content (WCF Data Services)</span></span>
<span data-ttu-id="0fdc8-103">Por padrão, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limita a quantidade de dados retornados por uma consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-103">By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limits the amount of data that a query returns.</span></span> <span data-ttu-id="0fdc8-104">No entanto, você pode carregar explicitamente os dados adicionais, inclusive entidades relacionadas, dados de resposta paginada e fluxos de dados binários do serviço de dados quando ele é necessário.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-104">However, you can explicitly load additional data, including related entities, paged response data, and binary data streams, from the data service when it is needed.</span></span> <span data-ttu-id="0fdc8-105">Este tópico descreve como carregar conteúdo adiado para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-105">This topic describes how to load such deferred content into your application.</span></span>  
  
## <a name="related-entities"></a><span data-ttu-id="0fdc8-106">Entidades relacionadas</span><span class="sxs-lookup"><span data-stu-id="0fdc8-106">Related Entities</span></span>  
 <span data-ttu-id="0fdc8-107">Quando você executa uma consulta, apenas as entidades no conjunto de entidades endereçado são retornadas.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-107">When you execute a query, only entities in the addressed entity set are returned.</span></span> <span data-ttu-id="0fdc8-108">Por exemplo, quando uma consulta em relação ao serviço de dados Northwind retorna `Customers` entidades, por padrão, relacionado `Orders` entidades não são retornadas, mesmo que haja uma relação entre `Customers` e `Orders`.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-108">For example, when a query against the Northwind data service returns `Customers` entities, by default the related `Orders` entities are not returned, even though there is a relationship between `Customers` and `Orders`.</span></span> <span data-ttu-id="0fdc8-109">Além disso, quando a paginação está habilitada no serviço de dados, você deverá carregar explicitamente as páginas de dados subsequentes do serviço.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-109">Also, when paging is enabled in the data service, you must explicitly load subsequent data pages from the service.</span></span> <span data-ttu-id="0fdc8-110">Há duas maneiras de carregar as entidades relacionadas:</span><span class="sxs-lookup"><span data-stu-id="0fdc8-110">There are two ways to load related entities:</span></span>  
  
-   <span data-ttu-id="0fdc8-111">**Carregamento adiantado**: você pode usar o `$expand` opção de consulta para solicitar que a consulta retornar entidades relacionadas por uma associação para a entidade definida que a consulta solicitada.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-111">**Eager loading**: You can use the `$expand` query option to request that the query return entities that are related by an association to the entity set that the query requested.</span></span> <span data-ttu-id="0fdc8-112">Use o <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> método o <xref:System.Data.Services.Client.DataServiceQuery%601> para adicionar o `$expand` opção para a consulta que é enviada para o serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-112">Use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to add the `$expand` option to the query that is sent to the data service.</span></span> <span data-ttu-id="0fdc8-113">Você pode solicitar a que conjuntos de várias entidades relacionadas, separando-os por uma vírgula, como no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-113">You can request multiple related entity sets by separating them by a comma, as in the following example.</span></span> <span data-ttu-id="0fdc8-114">Todas as entidades solicitadas pela consulta são retornadas em uma única resposta.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-114">All entities requested by the query are returned in a single response.</span></span> <span data-ttu-id="0fdc8-115">O exemplo a seguir retorna `Order_Details` e `Customers` junto com o `Orders` conjunto de entidades:</span><span class="sxs-lookup"><span data-stu-id="0fdc8-115">The following example returns `Order_Details` and `Customers` together with the `Orders` entity set:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#expandorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#expandorderdetailsspecific)]  
  
     [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="0fdc8-116"> limita a 12 o número de conjuntos de entidades que podem ser incluídos em uma única consulta usando o `$expand` opção de consulta.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-116"> limits to 12 the number of entity sets that can be included in a single query by using the `$expand` query option.</span></span>  
  
-   <span data-ttu-id="0fdc8-117">**Carregamento explícito**: você pode chamar o <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> método o <xref:System.Data.Services.Client.DataServiceContext> instância para carregar explicitamente entidades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-117">**Explicit loading**: You can call the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance to explicitly load related entities.</span></span> <span data-ttu-id="0fdc8-118">Cada chamada para o <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> método cria uma solicitação separada para o serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-118">Each call to the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method creates a separate request to the data service.</span></span> <span data-ttu-id="0fdc8-119">O exemplo a seguir carrega explicitamente `Order_Details` para um `Orders` entidade:</span><span class="sxs-lookup"><span data-stu-id="0fdc8-119">The following example explicitly loads `Order_Details` for an `Orders` entity:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadrelatedorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadrelatedorderdetailsspecific)]  
  
 <span data-ttu-id="0fdc8-120">Ao considerar qual opção usar, observe que há um equilíbrio entre o número de solicitações para o serviço de dados e a quantidade de dados que são retornados em uma única resposta.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-120">When you consider which option to use, realize that there is a tradeoff between the number of requests to the data service and the amount of data that is returned in a single response.</span></span> <span data-ttu-id="0fdc8-121">Use o carregamento adiantado quando seu aplicativo requer que objetos associados e para evitar a latência de solicitações adicionais para recuperá-las explicitamente.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-121">Use eager loading when your application requires associated objects and you want to avoid the added latency of additional requests to explicitly retrieve them.</span></span> <span data-ttu-id="0fdc8-122">No entanto, se há casos em que o aplicativo precisa apenas os dados para instâncias específicas de entidade relacionada, você deve considerar carregar essas entidades explicitamente chamando o <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> método.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-122">However, if there are cases when the application only needs the data for specific related entity instances, you should consider explicitly loading those entities by calling the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method.</span></span> <span data-ttu-id="0fdc8-123">Para obter mais informações, consulte [como: entidades relacionadas carga](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0fdc8-123">For more information, see [How to: Load Related Entities](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span></span>  
  
## <a name="paged-content"></a><span data-ttu-id="0fdc8-124">Páginas de conteúdo</span><span class="sxs-lookup"><span data-stu-id="0fdc8-124">Paged Content</span></span>  
 <span data-ttu-id="0fdc8-125">Quando a paginação está habilitada no serviço de dados, o número de entradas no feed que o serviço de dados retorna é limitado pela configuração do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-125">When paging is enabled in the data service, the number of entries in the feed that the data service returns is limited by the configuration of the data service.</span></span> <span data-ttu-id="0fdc8-126">Limites de página podem ser definidos separadamente para cada conjunto de entidades.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-126">Page limits can be set separately for each entity set.</span></span> <span data-ttu-id="0fdc8-127">Para obter mais informações, consulte [Configurando o serviço de dados](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0fdc8-127">For more information, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="0fdc8-128">Quando a paginação estiver habilitada, a entrada final no feed contém um link para a próxima página de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-128">When paging is enabled, the final entry in the feed contains a link to the next page of data.</span></span> <span data-ttu-id="0fdc8-129">Este link está contido em um <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> objeto.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-129">This link is contained in a <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object.</span></span> <span data-ttu-id="0fdc8-130">Obter o URI para a próxima página de dados chamando o <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> método o <xref:System.Data.Services.Client.QueryOperationResponse%601> retornado quando o <xref:System.Data.Services.Client.DataServiceQuery%601> é executado.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-130">You obtain the URI to the next page of data by calling the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method on the <xref:System.Data.Services.Client.QueryOperationResponse%601> returned when the <xref:System.Data.Services.Client.DataServiceQuery%601> is executed.</span></span> <span data-ttu-id="0fdc8-131">Retornado <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> objeto é usado para carregar a próxima página de resultados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-131">The returned <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object is then used to load the next page of results.</span></span> <span data-ttu-id="0fdc8-132">Você deve enumerar o resultado da consulta antes de chamar o <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> método.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-132">You must enumerate the query result before you call the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method.</span></span> <span data-ttu-id="0fdc8-133">Considere o uso de um `do…while` loop para enumerar primeiro o resultado da consulta e, em seguida, verificar um `non-null` valor do próximo link.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-133">Consider using a `do…while` loop to first enumerate the query result and then check for a `non-null` next link value.</span></span> <span data-ttu-id="0fdc8-134">Quando o <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> método `null` (`Nothing` no Visual Basic), não existem páginas resultados adicionais para a consulta original.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-134">When the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method returns `null` (`Nothing` in Visual Basic), there are no additional result pages for the original query.</span></span> <span data-ttu-id="0fdc8-135">A exemplo a seguir mostra um `do…while` paginável de loop que carrega os dados do cliente do serviço de dados de exemplo Northwind.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-135">The following example shows a `do…while` loop that loads paged customer data from the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextlink)]
 [!code-vb[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextlink)]  
  
 <span data-ttu-id="0fdc8-136">Quando as solicitações de uma consulta que entidades relacionadas ao são retornados em uma única resposta junto com o conjunto de entidades solicitada, limites de paginação podem afetar feeds aninhados que são incluídos em linha com a resposta.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-136">When a query requests that related entities are returned in a single response together with the requested entity set, paging limits may affect nested feeds that are included inline with the response.</span></span> <span data-ttu-id="0fdc8-137">Por exemplo, quando um limite de paginação é definido no serviço de dados de exemplo Northwind para a `Customers` conjunto de entidades, também pode ser definido um limite de paginação independente para relacionado `Orders` entidade definida, como no exemplo a seguir do Northwind.svc.cs arquivo Define o serviço de dados de exemplo Northwind.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-137">For example, when a paging limit is set in the Northwind sample data service for the `Customers` entity set, an independent paging limit can also be set for the related `Orders` entity set, as in the following example from the Northwind.svc.cs file that defines the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind.svc.cs#dataserviceconfigpaging)]
 [!code-vb[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind.svc.vb#dataserviceconfigpaging)]  
  
 <span data-ttu-id="0fdc8-138">Nesse caso, você deve implementar paginação para ambos os de nível superior `Customers` e aninhada `Orders` feeds de entidade.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-138">In this case, you must implement paging for both the top-level `Customers` and the nested `Orders` entity feeds.</span></span> <span data-ttu-id="0fdc8-139">A exemplo a seguir mostra o `while` loop usado para carregar as páginas de `Orders` entidades relacionadas a um selecionado `Customers` entidade.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-139">The following example shows the `while` loop used to load pages of `Orders` entities related to a selected `Customers` entity.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextorderslink)]
 [!code-vb[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextorderslink)]  
  
 <span data-ttu-id="0fdc8-140">Para obter mais informações, consulte [como: carga paginável resultados](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0fdc8-140">For more information, see [How to: Load Paged Results](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>  
  
## <a name="binary-data-streams"></a><span data-ttu-id="0fdc8-141">Fluxos de dados binários</span><span class="sxs-lookup"><span data-stu-id="0fdc8-141">Binary Data Streams</span></span>  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="0fdc8-142"> permite que você acesse dados de objeto binário grande (BLOB) como um fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-142"> enables you to access binary large object (BLOB) data as a data stream.</span></span> <span data-ttu-id="0fdc8-143">Streaming adia o carregamento de dados binários, até que ela é necessária e o cliente com mais eficiência pode processar esses dados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-143">Streaming defers the loading of binary data until it is needed, and the client can more efficiently process this data.</span></span> <span data-ttu-id="0fdc8-144">Para tirar proveito dessa funcionalidade, o serviço de dados deve implementar o <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provedor.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-144">In order to take advantage of this functionality, the data service must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider.</span></span> <span data-ttu-id="0fdc8-145">Para obter mais informações, consulte [provedor Streaming](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0fdc8-145">For more information, see [Streaming Provider](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span></span> <span data-ttu-id="0fdc8-146">Quando o fluxo está habilitado, os tipos de entidade são retornados sem os dados binários relacionados.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-146">When streaming is enabled, entity types are returned without the related binary data.</span></span> <span data-ttu-id="0fdc8-147">Nesse caso, você deve usar o <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> método o <xref:System.Data.Services.Client.DataServiceContext> classe para acessar o fluxo de dados para os dados binários do serviço.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-147">In this case, you must use the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method of the <xref:System.Data.Services.Client.DataServiceContext> class to access the data stream for the binary data from the service.</span></span> <span data-ttu-id="0fdc8-148">Da mesma forma, use o <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> método para adicionar ou alterar dados binários de uma entidade como um fluxo.</span><span class="sxs-lookup"><span data-stu-id="0fdc8-148">Similarly, use the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to add or change binary data for an entity as a stream.</span></span> <span data-ttu-id="0fdc8-149">Para obter mais informações, consulte [trabalhando com dados binários](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="0fdc8-149">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0fdc8-150">Consulte também</span><span class="sxs-lookup"><span data-stu-id="0fdc8-150">See Also</span></span>  
 <span data-ttu-id="0fdc8-151">[WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md) (Biblioteca de clientes do WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="0fdc8-151">[WCF Data Services Client Library](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)</span></span>  
 <span data-ttu-id="0fdc8-152">[Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md) (Consultando o serviço de dados)</span><span class="sxs-lookup"><span data-stu-id="0fdc8-152">[Querying the Data Service](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)</span></span>
