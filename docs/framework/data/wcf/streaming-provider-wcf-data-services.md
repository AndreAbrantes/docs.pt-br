---
title: Provedor de streaming (WCF Data Services)
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework-oob
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
caps.latest.revision: 8
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: bc66d4154f60e46e53de8ca72596e133dc84eb97
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/26/2018
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="293a3-102">Provedor de streaming (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="293a3-102">Streaming Provider (WCF Data Services)</span></span>
<span data-ttu-id="293a3-103">Um serviço de dados pode expor dados de objeto binário grande.</span><span class="sxs-lookup"><span data-stu-id="293a3-103">A data service can expose large object binary data.</span></span> <span data-ttu-id="293a3-104">Esses dados binários podem representar fluxos de vídeo e áudio, imagens, arquivos de documento ou outros tipos de mídia binária.</span><span class="sxs-lookup"><span data-stu-id="293a3-104">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="293a3-105">Quando uma entidade no modelo de dados inclui uma ou mais propriedades binárias, o serviço de dados retorna esses dados binários codificados como base 64 no feed de resposta.</span><span class="sxs-lookup"><span data-stu-id="293a3-105">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="293a3-106">Como carregar e serializar os dados binários longos dessa maneira podem afetar o desempenho, o [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] define um mecanismo para recuperar dados binários independentes da entidade à qual ela pertence.</span><span class="sxs-lookup"><span data-stu-id="293a3-106">Because loading and serializing large binary data in this manner can affect performance, the [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="293a3-107">Isso é feito separando os dados binários da entidade em um ou mais fluxos de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-107">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>  
  
-   <span data-ttu-id="293a3-108">Recurso de mídia - dados binários que pertencem a uma entidade, como vídeo, áudio, imagem ou outro tipo de fluxo de recurso de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-108">Media resource - binary data that belongs to an entity, such as a video, audio, image or other type of media resource stream.</span></span>  
  
-   <span data-ttu-id="293a3-109">Entrada de link de mídia - uma entidade que tem uma referência a um fluxo de recurso de mídia relacionado.</span><span class="sxs-lookup"><span data-stu-id="293a3-109">Media link entry - an entity that has a reference to a related media resource stream.</span></span>  
  
 <span data-ttu-id="293a3-110">Com o [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], você define um fluxo de recurso binário implementando um provedor de dados de streaming.</span><span class="sxs-lookup"><span data-stu-id="293a3-110">With [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="293a3-111">A implementação de provedor de streaming fornece o serviço de dados com o fluxo de recurso de mídia associado a uma entidade específica como um <xref:System.IO.Stream> objeto.</span><span class="sxs-lookup"><span data-stu-id="293a3-111">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="293a3-112">Essa implementação permite que o serviço de dados aceite e retorne recursos de mídia sobre HTTP como fluxos de dados binários de um tipo MIME especificado.</span><span class="sxs-lookup"><span data-stu-id="293a3-112">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>  
  
 <span data-ttu-id="293a3-113">A configuração de um serviço de dados para oferecer suporte ao streaming de dados binários requer as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="293a3-113">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>  
  
1.  <span data-ttu-id="293a3-114">Atribua uma ou mais entidades no modelo de dados como uma entrada de link de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-114">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="293a3-115">Essas entidades não devem incluir os dados binários a serem transmitidos.</span><span class="sxs-lookup"><span data-stu-id="293a3-115">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="293a3-116">Todas as propriedades binárias de uma entidade sempre são retornadas na entrada como binário codificado na base 64.</span><span class="sxs-lookup"><span data-stu-id="293a3-116">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>  
  
2.  <span data-ttu-id="293a3-117">Implemente a interface T:System.Data.Services.Providers.IDataServiceStreamProvider.</span><span class="sxs-lookup"><span data-stu-id="293a3-117">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>  
  
3.  <span data-ttu-id="293a3-118">Defina um serviço de dados que implemente a interface <xref:System.IServiceProvider>.</span><span class="sxs-lookup"><span data-stu-id="293a3-118">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="293a3-119">O serviço de dados usa a implementação de <xref:System.IServiceProvider.GetService%2A> para acessar a implementação do provedor de dados de streaming.</span><span class="sxs-lookup"><span data-stu-id="293a3-119">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="293a3-120">Esse método retorna a implementação de provedor de streaming apropriada.</span><span class="sxs-lookup"><span data-stu-id="293a3-120">This method returns the appropriate streaming provider implementation.</span></span>  
  
4.  <span data-ttu-id="293a3-121">Ative fluxos de mensagem grandes na configuração de aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="293a3-121">Enable large message streams in the Web application configuration.</span></span>  
  
5.  <span data-ttu-id="293a3-122">Habilitar o acesso aos recursos binários no servidor ou em uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-122">Enable access to binary resources on the server or in a data source.</span></span>  
  
 <span data-ttu-id="293a3-123">Os exemplos neste tópico se baseiam em uma amostra de streaming de serviço de fotos, que é discutido em detalhes na postagem do [Streaming série de provedor de serviços de dados: Implementando um provedor de Streaming (parte 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="293a3-123">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span></span> <span data-ttu-id="293a3-124">O código-fonte para esse serviço de exemplo está disponível na [página de exemplo de serviço de dados de foto Streaming](http://go.microsoft.com/fwlink/?LinkID=198988) na Galeria de códigos do MSDN.</span><span class="sxs-lookup"><span data-stu-id="293a3-124">The source code for this sample service is available on the [Streaming Photo Data Service Sample page](http://go.microsoft.com/fwlink/?LinkID=198988) on MSDN Code Gallery.</span></span>  
  
## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="293a3-125">Definindo uma entrada de link de mídia no modelo de dados</span><span class="sxs-lookup"><span data-stu-id="293a3-125">Defining a Media Link Entry in the Data Model</span></span>  
 <span data-ttu-id="293a3-126">O provedor de fonte de dados determina a maneira que uma entidade é definida como uma entrada de link de mídia no modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-126">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>  
  
 <span data-ttu-id="293a3-127">**Entity Framework Provider** (Provedor de Entity Framework)</span><span class="sxs-lookup"><span data-stu-id="293a3-127">**Entity Framework Provider**</span></span>  
 <span data-ttu-id="293a3-128">Para indicar que uma entidade é uma entrada de link de mídia, adicione o atributo `HasStream` à definição de tipo de entidade no modelo conceitual, como no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="293a3-128">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>  
  
 [!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria photo streaming service/xml/photodata.edmx#hasstream)]  
  
 <span data-ttu-id="293a3-129">Você também deve adicionar o namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` à entidade ou à raiz do arquivo .edmx ou .csdl que define o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-129">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>  
  
 <span data-ttu-id="293a3-130">Para obter um exemplo de um serviço de dados que usa o [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] provedor e expõe um recurso de mídia, consulte a postagem [Streaming série de provedor de serviços de dados: Implementando um provedor de Streaming (parte 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span><span class="sxs-lookup"><span data-stu-id="293a3-130">For an example of a data service that uses the [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](http://go.microsoft.com/fwlink/?LinkID=198989).</span></span>  
  
 <span data-ttu-id="293a3-131">**Provedor de reflexão**</span><span class="sxs-lookup"><span data-stu-id="293a3-131">**Reflection Provider**</span></span>  
 <span data-ttu-id="293a3-132">Para indicar que uma entidade é uma entrada de link de mídia, adicione o <xref:System.Data.Services.Common.HasStreamAttribute> à classe que define o tipo de entidade no provedor de reflexão.</span><span class="sxs-lookup"><span data-stu-id="293a3-132">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>  
  
 <span data-ttu-id="293a3-133">**Provedor de serviços de dados personalizados**</span><span class="sxs-lookup"><span data-stu-id="293a3-133">**Custom Data Service Provider**</span></span>  
 <span data-ttu-id="293a3-134">Ao usar provedores de serviços personalizados, você implementa a interface <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> para definir os metadados do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-134">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="293a3-135">Para obter mais informações, consulte [provedores de serviço de dados personalizados](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="293a3-135">For more information, see [Custom Data Service Providers](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="293a3-136">Você indica que um fluxo de recurso binário pertence a um <xref:System.Data.Services.Providers.ResourceType> definindo a propriedade <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> para `true` no <xref:System.Data.Services.Providers.ResourceType> que representa o tipo de entidade, que é uma entrada de link de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-136">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>  
  
## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="293a3-137">Implementando a interface IDataServiceStreamProvider</span><span class="sxs-lookup"><span data-stu-id="293a3-137">Implementing the IDataServiceStreamProvider Interface</span></span>  
 <span data-ttu-id="293a3-138">Para criar um serviço de dados que oferece suporte a fluxos de dados binários, você deve implementar a interface <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="293a3-138">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="293a3-139">Essa implementação permite que o serviço de dados retorne dados binários como um fluxo para o cliente e consuma dados binários como um fluxo enviado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="293a3-139">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="293a3-140">O serviço de dados cria uma instância dessa interface sempre que precisa acessar dados binários como um fluxo.</span><span class="sxs-lookup"><span data-stu-id="293a3-140">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="293a3-141">A interface <xref:System.Data.Services.Providers.IDataServiceStreamProvider> especifica os seguintes membros:</span><span class="sxs-lookup"><span data-stu-id="293a3-141">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>  
  
|<span data-ttu-id="293a3-142">Nome do membro</span><span class="sxs-lookup"><span data-stu-id="293a3-142">Member name</span></span>|<span data-ttu-id="293a3-143">Descrição</span><span class="sxs-lookup"><span data-stu-id="293a3-143">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="293a3-144">Este método é chamado pelo serviço de dados para excluir o recurso de mídia correspondente quando sua entrada de link de mídia é excluída.</span><span class="sxs-lookup"><span data-stu-id="293a3-144">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="293a3-145">Quando você implementa o <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, este método contém o código que exclui o recurso de mídia associado à entrada de link de mídia fornecida.</span><span class="sxs-lookup"><span data-stu-id="293a3-145">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="293a3-146">Este método é chamado pelo serviço de dados para retornar um recurso de mídia como um fluxo.</span><span class="sxs-lookup"><span data-stu-id="293a3-146">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="293a3-147">Quando você implementa o <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, este método contém o código que fornece um fluxo usado pelo serviço de dados ao recurso de mídia de retorno que está associado à entrada de link de mídia fornecida.</span><span class="sxs-lookup"><span data-stu-id="293a3-147">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="293a3-148">Este método é chamado pelo serviço de dados para retornar o URI usado para solicitar o recurso de mídia da entrada de link de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-148">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="293a3-149">Esse valor é usado para criar o atributo `src` no elemento de conteúdo da entrada de link de mídia que é usado para solicitar o fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-149">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="293a3-150">Quando este método retorna `null`, o serviço de dados determina automaticamente o URI.</span><span class="sxs-lookup"><span data-stu-id="293a3-150">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="293a3-151">Use este método quando precisar fornecer aos clientes acesso direto aos dados binários sem usar o provedor de streaming.</span><span class="sxs-lookup"><span data-stu-id="293a3-151">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="293a3-152">Este método é chamado pelo serviço de dados para retornar o valor Content-Type do recurso de mídia associado à entrada de link de mídia especificada.</span><span class="sxs-lookup"><span data-stu-id="293a3-152">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="293a3-153">Este método é chamado pelo serviço de dados para retornar o eTag do fluxo de dados associado à entidade especificada.</span><span class="sxs-lookup"><span data-stu-id="293a3-153">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="293a3-154">Este método é usado quando você gerencia a simultaneidade dos dados binários.</span><span class="sxs-lookup"><span data-stu-id="293a3-154">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="293a3-155">Quando este método retorna um valor nulo, o serviço de dados não rastreia a simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="293a3-155">When this method returns null, the data service does not track concurrency.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="293a3-156">Este método é chamado pelo serviço de dados para obter o fluxo usado durante o recebimento do fluxo enviado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="293a3-156">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="293a3-157">Quando você implementar o <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, deverá retornar um fluxo gravável no qual o serviço de dados grava os dados de fluxo recebidos.</span><span class="sxs-lookup"><span data-stu-id="293a3-157">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|  
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="293a3-158">Retorna um nome de tipo qualificado para namespace que representa o tipo que o tempo de execução do serviço de dados deve criar para a entrada de link de mídia associada ao fluxo de dados do recurso de mídia que está sendo inserido.</span><span class="sxs-lookup"><span data-stu-id="293a3-158">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|  
  
## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="293a3-159">Criando o serviço de dados de streaming</span><span class="sxs-lookup"><span data-stu-id="293a3-159">Creating the Streaming Data Service</span></span>  
 <span data-ttu-id="293a3-160">Para fornecer o tempo de execução do [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] com acesso à implementação do <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, o serviço de dados que você cria também deve implementar a interface <xref:System.IServiceProvider>.</span><span class="sxs-lookup"><span data-stu-id="293a3-160">To provide the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="293a3-161">O exemplo a seguir mostra como implementar o método <xref:System.IServiceProvider.GetService%2A> para retornar uma instância da classe `PhotoServiceStreamProvider` que implementa o <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="293a3-161">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>  
  
 [!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria photo streaming service/cs/photodata.svc.cs#photoservicestreamingprovider)]
 [!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria photo streaming service/vb/photodata.svc.vb#photoservicestreamingprovider)]  
  
 <span data-ttu-id="293a3-162">Para obter informações gerais sobre como criar um serviço de dados, consulte [Configurando o serviço de dados](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="293a3-162">For general information about how to create a data service, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span>  
  
## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="293a3-163">Ativando os fluxos de binário grandes no ambiente de hospedagem</span><span class="sxs-lookup"><span data-stu-id="293a3-163">Enabling Large Binary Streams in the Hosting Environment</span></span>  
 <span data-ttu-id="293a3-164">Quando você cria um serviço de dados em um [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] aplicativo Web, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] é usado para fornecer a implementação do protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="293a3-164">When you create a data service in an [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="293a3-165">Por padrão, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] limita o tamanho de mensagens HTTP para apenas 65 mil bytes.</span><span class="sxs-lookup"><span data-stu-id="293a3-165">By default, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] limits the size of HTTP messages to only 65K bytes.</span></span> <span data-ttu-id="293a3-166">Para transmitir dados binários grandes para e do serviço de dados, você também deve configurar o aplicativo Web para ativar arquivos binários grandes e usar fluxos de transferência.</span><span class="sxs-lookup"><span data-stu-id="293a3-166">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="293a3-167">Para fazer isso, adicione o seguinte ao elemento `<configuration />` do arquivo Web.config do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="293a3-167">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>  
  
  
  
> [!NOTE]
>  <span data-ttu-id="293a3-168">Você deve usar um modo de transferência <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> para garantir que os dados binários nas mensagens de resposta e de solicitação sejam transmitidos e não armazenados em buffer pelo [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="293a3-168">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span></span>  
  
 <span data-ttu-id="293a3-169">Para obter mais informações, consulte [Streaming de transferência de mensagens](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) e [cotas de transporte](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="293a3-169">For more information, see [Streaming Message Transfer](../../../../docs/framework/wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>  
  
 <span data-ttu-id="293a3-170">Por padrão, os Serviços de Informações da Internet (IIS) também limita o tamanho das solicitações a 4 MB.</span><span class="sxs-lookup"><span data-stu-id="293a3-170">By default, Internet Information Services (IIS) also limits the size of requests to 4MB.</span></span> <span data-ttu-id="293a3-171">Para habilitar o serviço de dados receber mais de 4MB de fluxos quando em execução no IIS, você também deve definir o `maxRequestLength` atributo do [httpRuntime Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) no `<system.web />` seção de configuração, como como mostrado no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="293a3-171">To enable your data service to receive streams larger than 4MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](http://msdn.microsoft.com/library/e9b81350-8aaf-47cc-9843-5f7d0c59f369) in the `<system.web />` configuration section, as shown in the following example:</span></span>  
  
  
  
## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="293a3-172">Usando fluxos de dados em um aplicativo cliente</span><span class="sxs-lookup"><span data-stu-id="293a3-172">Using Data Streams in a Client Application</span></span>  
 <span data-ttu-id="293a3-173">A biblioteca de cliente do [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] permite a recuperação e a atualização desses recursos expostos como fluxos binários no cliente.</span><span class="sxs-lookup"><span data-stu-id="293a3-173">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="293a3-174">Para obter mais informações, consulte [trabalhando com dados binários](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="293a3-174">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="293a3-175">Considerações para trabalhar com um provedor de streaming</span><span class="sxs-lookup"><span data-stu-id="293a3-175">Considerations for Working with a Streaming Provider</span></span>  
 <span data-ttu-id="293a3-176">Considere o seguinte ao implementar um provedor de streaming e acessar recursos de mídia de um serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-176">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>  
  
-   <span data-ttu-id="293a3-177">Não há suporte para solicitações MERGE nos recursos de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-177">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="293a3-178">Use uma solicitação PUT para alterar o recurso de mídia de uma entidade existente.</span><span class="sxs-lookup"><span data-stu-id="293a3-178">Use a PUT request to change the media resource of an existing entity.</span></span>  
  
-   <span data-ttu-id="293a3-179">Uma solicitação POST não pode ser usada para criar uma nova entrada de link de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-179">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="293a3-180">Em vez disso, você deve emitir uma solicitação POST para criar um novo recurso de mídia, e o serviço de dados cria uma nova entrada de link de mídia com os valores padrão.</span><span class="sxs-lookup"><span data-stu-id="293a3-180">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="293a3-181">Essa nova entidade pode ser atualizada por uma solicitação MERGE ou PUT subsequente.</span><span class="sxs-lookup"><span data-stu-id="293a3-181">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="293a3-182">Você também pode considerar o armazenamento em cache e fazer atualizações na área de descarte, como definir o valor da propriedade para o valor do cabeçalho de campo de dados dinâmico na solicitação POST.</span><span class="sxs-lookup"><span data-stu-id="293a3-182">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>  
  
-   <span data-ttu-id="293a3-183">Quando uma solicitação POST for recebida, o serviço de dados chamará o <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> para criar o recurso de mídia antes que ele chame <xref:System.Data.Services.IUpdatable.SaveChanges%2A> para criar a entrada de link de mídia.</span><span class="sxs-lookup"><span data-stu-id="293a3-183">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>  
  
-   <span data-ttu-id="293a3-184">Uma implementação do <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> não deve retornar um objeto <xref:System.IO.MemoryStream>.</span><span class="sxs-lookup"><span data-stu-id="293a3-184">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="293a3-185">Quando você usar esse tipo de fluxo, os problemas de recurso de memória ocorrerão quando o serviço receber fluxos de dados muito grandes.</span><span class="sxs-lookup"><span data-stu-id="293a3-185">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>  
  
-   <span data-ttu-id="293a3-186">Considere o seguinte ao armazenar recursos de mídia em um banco de dados:</span><span class="sxs-lookup"><span data-stu-id="293a3-186">The following are things to consider when storing media resources in a database:</span></span>  
  
    -   <span data-ttu-id="293a3-187">Uma propriedade binária que é um recurso de mídia não deve ser incluída no modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-187">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="293a3-188">Todas as propriedades expostas em um modelo de dados são retornadas na entrada em um feed de resposta.</span><span class="sxs-lookup"><span data-stu-id="293a3-188">All properties exposed in a data model are returned in the entry in a response feed.</span></span>  
  
    -   <span data-ttu-id="293a3-189">Para melhorar o desempenho com um fluxo binário grande, é recomendável que você crie uma classe de fluxo personalizada para armazenar dados binários no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-189">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="293a3-190">Essa classe é retornado pela implementação do <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> e envia os dados binários ao banco de dados em partes.</span><span class="sxs-lookup"><span data-stu-id="293a3-190">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="293a3-191">Para um banco de dados do SQL Server, recomendamos que você use um FILESTREAM para o fluxo de dados no banco de dados quando os dados binários são maiores que 1MB.</span><span class="sxs-lookup"><span data-stu-id="293a3-191">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1MB.</span></span>  
  
    -   <span data-ttu-id="293a3-192">Verifique se o banco de dados foi projetado para armazenar os fluxos binários grandes que serão recebidos pelo serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-192">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>  
  
    -   <span data-ttu-id="293a3-193">Quando um cliente enviar uma solicitação POST para inserir uma entrada de link de mídia com um recurso de mídia em uma única solicitação, o <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> será chamado para obter o fluxo antes que o serviço de dados insira a nova entidade no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-193">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="293a3-194">Uma implementação de provedor de streaming deve ser capaz de manipular esse comportamento do serviço de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-194">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="293a3-195">É recomendável usar uma tabela de dados separada para armazenar os dados binários ou para armazenar o fluxo de dados em um arquivo até depois da inserção da entidade no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="293a3-195">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>  
  
-   <span data-ttu-id="293a3-196">Ao implementar os métodos <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, o <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A> ou o <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>, você deve usar os valores eTag e Content-Type fornecidos como parâmetros do método.</span><span class="sxs-lookup"><span data-stu-id="293a3-196">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="293a3-197">Não defina cabeçalhos eTag ou Content-Type na implementação do provedor <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="293a3-197">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>  
  
-   <span data-ttu-id="293a3-198">Por padrão, o cliente envia fluxos binários grandes usando uma codificação de transferência HTTP em partes.</span><span class="sxs-lookup"><span data-stu-id="293a3-198">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="293a3-199">Porque o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server não dá suporte a esse tipo de codificação, você não pode usar esse servidor Web para hospedar um serviço de dados de transmissão que deve aceitar fluxos binários grandes.</span><span class="sxs-lookup"><span data-stu-id="293a3-199">Because the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="293a3-200">Para obter mais informações sobre [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, consulte [servidores Web no Visual Studio para projetos Web ASP.NET](http://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span><span class="sxs-lookup"><span data-stu-id="293a3-200">For more information on [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](http://msdn.microsoft.com/library/31d4f588-df59-4b7e-b9ea-e1f2dd204328).</span></span>  
  
<a name="versioning"></a>   
## <a name="versioning-requirements"></a><span data-ttu-id="293a3-201">Requisitos de controle de versão</span><span class="sxs-lookup"><span data-stu-id="293a3-201">Versioning Requirements</span></span>  
 <span data-ttu-id="293a3-202">O provedor de streaming tem os seguintes requisitos de controle de versão do protocolo [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="293a3-202">The streaming provider has the following [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol versioning requirements:</span></span>  
  
-   <span data-ttu-id="293a3-203">O provedor de streaming requer que o serviço de dados ofereça suporte à versão 2.0 do protocolo [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] e às versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="293a3-203">The streaming provider requires that the data service support version 2.0 of the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] protocol and later versions.</span></span>  
  
 <span data-ttu-id="293a3-204">Para obter mais informações, consulte [controle de versão de serviço de dados](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="293a3-204">For more information, see [Data Service Versioning](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="293a3-205">Consulte também</span><span class="sxs-lookup"><span data-stu-id="293a3-205">See Also</span></span>  
 [<span data-ttu-id="293a3-206">Provedores de Serviços de Dados</span><span class="sxs-lookup"><span data-stu-id="293a3-206">Data Services Providers</span></span>](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md)  
 [<span data-ttu-id="293a3-207">Provedores de serviços de dados personalizados</span><span class="sxs-lookup"><span data-stu-id="293a3-207">Custom Data Service Providers</span></span>](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md)  
 [<span data-ttu-id="293a3-208">Trabalhando com os dados binários</span><span class="sxs-lookup"><span data-stu-id="293a3-208">Working with Binary Data</span></span>](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md)
