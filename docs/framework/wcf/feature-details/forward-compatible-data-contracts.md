---
title: Contratos de dados compatíveis por encaminhamento
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data contracts [WCF], forward compatibility
ms.assetid: 413c9044-26f8-4ecb-968c-18495ea52cd9
ms.openlocfilehash: 34bde56b78ec0148cf6b924f8edd29343b97faa4
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84597378"
---
# <a name="forward-compatible-data-contracts"></a><span data-ttu-id="1cb65-102">Contratos de dados compatíveis por encaminhamento</span><span class="sxs-lookup"><span data-stu-id="1cb65-102">Forward-Compatible Data Contracts</span></span>
<span data-ttu-id="1cb65-103">Um recurso do sistema de contrato de dados do Windows Communication Foundation (WCF) é que os contratos podem evoluir ao longo do tempo de maneiras não separáveis.</span><span class="sxs-lookup"><span data-stu-id="1cb65-103">A feature of the Windows Communication Foundation (WCF) data contract system is that contracts can evolve over time in nonbreaking ways.</span></span> <span data-ttu-id="1cb65-104">Ou seja, um cliente com uma versão mais antiga de um contrato de dados pode se comunicar com um serviço com uma versão mais recente do mesmo contrato de dados ou um cliente com uma versão mais recente de um contrato de dados pode se comunicar com uma versão mais antiga do mesmo contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="1cb65-104">That is, a client with an older version of a data contract can communicate with a service with a newer version of the same data contract, or a client with a newer version of a data contract can communicate with an older version of the same data contract.</span></span> <span data-ttu-id="1cb65-105">Para obter mais informações, consulte [práticas recomendadas: controle de versão de contrato de dados](../best-practices-data-contract-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="1cb65-105">For more information, see [Best Practices: Data Contract Versioning](../best-practices-data-contract-versioning.md).</span></span>  
  
 <span data-ttu-id="1cb65-106">Você pode aplicar a maioria dos recursos de controle de versão de acordo com a necessidade quando novas versões de um contrato de dados existente são criadas.</span><span class="sxs-lookup"><span data-stu-id="1cb65-106">You can apply most of the versioning features on an as-needed basis when new versions of an existing data contract are created.</span></span> <span data-ttu-id="1cb65-107">No entanto, um recurso de controle de versão, ida e *volta*, deve ser incorporado ao tipo da primeira versão para funcionar corretamente.</span><span class="sxs-lookup"><span data-stu-id="1cb65-107">However, one versioning feature, *round-tripping*, must be built into the type from the first version in order to work properly.</span></span>  
  
## <a name="round-tripping"></a><span data-ttu-id="1cb65-108">Ida e volta</span><span class="sxs-lookup"><span data-stu-id="1cb65-108">Round-Tripping</span></span>  
 <span data-ttu-id="1cb65-109">A viagem de ida e volta ocorre quando os dados passam de uma nova versão para uma versão antiga e para a nova versão de um contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="1cb65-109">Round-tripping occurs when data passes from a new version to an old version and back to the new version of a data contract.</span></span> <span data-ttu-id="1cb65-110">A ida e volta garante que nenhum dado seja perdido.</span><span class="sxs-lookup"><span data-stu-id="1cb65-110">Round-tripping guarantees that no data is lost.</span></span> <span data-ttu-id="1cb65-111">Habilitar a ida e volta torna o tipo compatível com as alterações futuras com suporte do modelo de controle de versão do contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="1cb65-111">Enabling round-tripping makes the type forward-compatible with any future changes supported by the data contract versioning model.</span></span>  
  
 <span data-ttu-id="1cb65-112">Para habilitar a ida e volta para um tipo específico, o tipo deve implementar a <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span><span class="sxs-lookup"><span data-stu-id="1cb65-112">To enable round-tripping for a particular type, the type must implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span> <span data-ttu-id="1cb65-113">A interface contém uma propriedade <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> (retornando o <xref:System.Runtime.Serialization.ExtensionDataObject> tipo).</span><span class="sxs-lookup"><span data-stu-id="1cb65-113">The interface contains one property, <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> (returning the <xref:System.Runtime.Serialization.ExtensionDataObject> type).</span></span> <span data-ttu-id="1cb65-114">A propriedade armazena todos os dados de versões futuras do contrato de dados que são desconhecidos para a versão atual.</span><span class="sxs-lookup"><span data-stu-id="1cb65-114">The property stores any data from future versions of the data contract that is unknown to the current version.</span></span>  
  
### <a name="example"></a><span data-ttu-id="1cb65-115">Exemplo</span><span class="sxs-lookup"><span data-stu-id="1cb65-115">Example</span></span>  
 <span data-ttu-id="1cb65-116">O contrato de dados a seguir não é compatível com o encaminhamento com alterações futuras.</span><span class="sxs-lookup"><span data-stu-id="1cb65-116">The following data contract is not forward-compatible with future changes.</span></span>  
  
 [!code-csharp[C_DataContract#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontract/cs/source.cs#7)]
 [!code-vb[C_DataContract#7](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontract/vb/source.vb#7)]  
  
 <span data-ttu-id="1cb65-117">Para tornar o tipo compatível com alterações futuras (como adicionar um novo membro de dados chamado "phoneNumber"), implemente a <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span><span class="sxs-lookup"><span data-stu-id="1cb65-117">To make the type compatible with future changes (such as adding a new data member named "phoneNumber"), implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span>  
  
 [!code-csharp[C_DataContract#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_datacontract/cs/source.cs#8)]
 [!code-vb[C_DataContract#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_datacontract/vb/source.vb#8)]  
  
 <span data-ttu-id="1cb65-118">Quando a infraestrutura do WCF encontra dados que não fazem parte do contrato de dados original, os dados são armazenados na propriedade e preservados.</span><span class="sxs-lookup"><span data-stu-id="1cb65-118">When the WCF infrastructure encounters data that is not part of the original data contract, the data is stored in the property and preserved.</span></span> <span data-ttu-id="1cb65-119">Ele não é processado de nenhuma outra forma, exceto o armazenamento temporário.</span><span class="sxs-lookup"><span data-stu-id="1cb65-119">It is not processed in any other way except for temporary storage.</span></span> <span data-ttu-id="1cb65-120">Se o objeto for retornado de volta para onde foi originado, os dados originais (desconhecidos) também serão retornados.</span><span class="sxs-lookup"><span data-stu-id="1cb65-120">If the object is returned back to where it originated, the original (unknown) data is also returned.</span></span> <span data-ttu-id="1cb65-121">Portanto, os dados fizeram uma viagem de ida e volta para o ponto de extremidade de origem sem perda.</span><span class="sxs-lookup"><span data-stu-id="1cb65-121">Therefore, the data has made a round trip to and from the originating endpoint without loss.</span></span> <span data-ttu-id="1cb65-122">Observe, no entanto, que se o ponto de extremidade de origem exigir que os dados sejam processados, essa expectativa será não atendida e o ponto de extremidade deverá, de alguma forma, detectar e acomodar a alteração.</span><span class="sxs-lookup"><span data-stu-id="1cb65-122">Note, however, that if the originating endpoint required the data to be processed, that expectation is unmet, and the endpoint must somehow detect and accommodate the change.</span></span>  
  
 <span data-ttu-id="1cb65-123">O <xref:System.Runtime.Serialization.ExtensionDataObject> tipo não contém propriedades ou métodos públicos.</span><span class="sxs-lookup"><span data-stu-id="1cb65-123">The <xref:System.Runtime.Serialization.ExtensionDataObject> type contains no public methods or properties.</span></span> <span data-ttu-id="1cb65-124">Portanto, é impossível obter acesso direto aos dados armazenados dentro da <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="1cb65-124">Thus, it is impossible to get direct access to the data stored inside the <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> property.</span></span>  
  
 <span data-ttu-id="1cb65-125">O recurso de ida e volta pode ser desativado, seja definindo `ignoreExtensionDataObject` `true` no <xref:System.Runtime.Serialization.DataContractSerializer> Construtor ou definindo a <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> propriedade como `true` no <xref:System.ServiceModel.ServiceBehaviorAttribute> .</span><span class="sxs-lookup"><span data-stu-id="1cb65-125">The round-tripping feature may be turned off, either by setting `ignoreExtensionDataObject` to `true` in the <xref:System.Runtime.Serialization.DataContractSerializer> constructor or by setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.IgnoreExtensionDataObject%2A> property to `true` on the <xref:System.ServiceModel.ServiceBehaviorAttribute>.</span></span> <span data-ttu-id="1cb65-126">Quando esse recurso estiver desativado, o desserializador não preencherá a <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> propriedade e o serializador não emitirá o conteúdo da propriedade.</span><span class="sxs-lookup"><span data-stu-id="1cb65-126">When this feature is off, the deserializer will not populate the <xref:System.Runtime.Serialization.IExtensibleDataObject.ExtensionData%2A> property, and the serializer will not emit the contents of the property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cb65-127">Consulte também</span><span class="sxs-lookup"><span data-stu-id="1cb65-127">See also</span></span>

- <xref:System.Runtime.Serialization.IExtensibleDataObject>
- <xref:System.Runtime.Serialization.ExtensionDataObject>
- [<span data-ttu-id="1cb65-128">Controle de versão de contrato de dados</span><span class="sxs-lookup"><span data-stu-id="1cb65-128">Data Contract Versioning</span></span>](data-contract-versioning.md)
- [<span data-ttu-id="1cb65-129">Práticas recomendadas: controle de versão de contrato de dados</span><span class="sxs-lookup"><span data-stu-id="1cb65-129">Best Practices: Data Contract Versioning</span></span>](../best-practices-data-contract-versioning.md)
