---
title: "Transmissão de transferência de mensagem"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 72a47a51-e5e7-4b76-b24a-299d51e0ae5a
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: a751245f0a933fda649d5919bab86abf2969dbf6
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/22/2017
---
# <a name="streaming-message-transfer"></a><span data-ttu-id="afe3a-102">Transmissão de transferência de mensagem</span><span class="sxs-lookup"><span data-stu-id="afe3a-102">Streaming Message Transfer</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="afe3a-103">transportes oferecem suporte a dois modos de transferência de mensagens:</span><span class="sxs-lookup"><span data-stu-id="afe3a-103"> transports support two modes for transferring messages:</span></span>  
  
-   <span data-ttu-id="afe3a-104">Transferências em buffer armazenar a mensagem inteira em um buffer de memória até que a transferência for concluída.</span><span class="sxs-lookup"><span data-stu-id="afe3a-104">Buffered transfers hold the entire message in a memory buffer until the transfer is complete.</span></span> <span data-ttu-id="afe3a-105">Uma mensagem em buffer deve ser entregue completamente antes de um destinatário possa lê-lo.</span><span class="sxs-lookup"><span data-stu-id="afe3a-105">A buffered message must be completely delivered before a receiver can read it.</span></span>  
  
-   <span data-ttu-id="afe3a-106">Transferências em fluxo expõem a mensagem como um fluxo.</span><span class="sxs-lookup"><span data-stu-id="afe3a-106">Streamed transfers expose the message as a stream.</span></span> <span data-ttu-id="afe3a-107">O receptor inicia o processamento da mensagem antes de entregar completamente.</span><span class="sxs-lookup"><span data-stu-id="afe3a-107">The receiver starts processing the message before it is completely delivered.</span></span>  
  
-   <span data-ttu-id="afe3a-108">Transferências em fluxo podem melhorar a escalabilidade de um serviço, eliminando a necessidade de buffers de memória grandes.</span><span class="sxs-lookup"><span data-stu-id="afe3a-108">Streamed transfers can improve the scalability of a service by eliminating the requirement for large memory buffers.</span></span> <span data-ttu-id="afe3a-109">Se alterar o modo de transferência melhora a escalabilidade depende do tamanho das mensagens que estão sendo transferidos.</span><span class="sxs-lookup"><span data-stu-id="afe3a-109">Whether changing the transfer mode improves scalability depends on the size of the messages being transferred.</span></span> <span data-ttu-id="afe3a-110">Tamanhos de mensagem grande favorecerem usando transferências em fluxo.</span><span class="sxs-lookup"><span data-stu-id="afe3a-110">Large message sizes favor using streamed transfers.</span></span>  
  
 <span data-ttu-id="afe3a-111">Por padrão, o HTTP, TCP/IP e transportes de pipe nomeado usam transferências em buffer.</span><span class="sxs-lookup"><span data-stu-id="afe3a-111">By default, the HTTP, TCP/IP, and named pipe transports use buffered transfers.</span></span> <span data-ttu-id="afe3a-112">Este documento descreve como alternar esses transportes de um buffer para o modo de transferência em fluxo e as consequências de fazer isso.</span><span class="sxs-lookup"><span data-stu-id="afe3a-112">This document describes how to switch these transports from a buffered to streamed transfer mode and the consequences of doing so.</span></span>  
  
## <a name="enabling-streamed-transfers"></a><span data-ttu-id="afe3a-113">Habilitar transferências em fluxo</span><span class="sxs-lookup"><span data-stu-id="afe3a-113">Enabling Streamed Transfers</span></span>  
 <span data-ttu-id="afe3a-114">Selecionando entre os modos de transferência em buffer e transmitida é feito no elemento de associação de transporte.</span><span class="sxs-lookup"><span data-stu-id="afe3a-114">Selecting between buffered and streamed transfer modes is done on the binding element of the transport.</span></span> <span data-ttu-id="afe3a-115">O elemento de associação tem um <xref:System.ServiceModel.TransferMode> propriedade que pode ser definida como `Buffered`, `Streamed`, `StreamedRequest`, ou `StreamedResponse`.</span><span class="sxs-lookup"><span data-stu-id="afe3a-115">The binding element has a <xref:System.ServiceModel.TransferMode> property that can be set to `Buffered`, `Streamed`, `StreamedRequest`, or `StreamedResponse`.</span></span> <span data-ttu-id="afe3a-116">Definir o modo de transferência para `Streamed` permite transmitir comunicação nas duas direções.</span><span class="sxs-lookup"><span data-stu-id="afe3a-116">Setting the transfer mode to `Streamed` enables streaming communication in both directions.</span></span> <span data-ttu-id="afe3a-117">Definir o modo de transferência para `StreamedRequest` ou `StreamedResponse` permite transmitir comunicação na direção indicada.</span><span class="sxs-lookup"><span data-stu-id="afe3a-117">Setting the transfer mode to `StreamedRequest` or `StreamedResponse` enables streaming communication in the indicated direction only.</span></span>  
  
 <span data-ttu-id="afe3a-118">O <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, e <xref:System.ServiceModel.NetNamedPipeBinding> associações exponha o <xref:System.ServiceModel.TransferMode> propriedade.</span><span class="sxs-lookup"><span data-stu-id="afe3a-118">The <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, and <xref:System.ServiceModel.NetNamedPipeBinding> bindings expose the <xref:System.ServiceModel.TransferMode> property.</span></span> <span data-ttu-id="afe3a-119">Para outros transportes, você deve criar uma associação personalizada para definir o modo de transferência.</span><span class="sxs-lookup"><span data-stu-id="afe3a-119">For other transports, you must create a custom binding to set the transfer mode.</span></span>  
  
 <span data-ttu-id="afe3a-120">A decisão de usar transferência em buffer ou em streaming é uma decisão local do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="afe3a-120">The decision to use either buffered or streamed transfers is a local decision of the endpoint.</span></span> <span data-ttu-id="afe3a-121">Para os transportes HTTP, o modo de transferência não se propaga por uma conexão, ou para servidores e outros intermediários.</span><span class="sxs-lookup"><span data-stu-id="afe3a-121">For HTTP transports, the transfer mode does not propagate across a connection, or to servers and other intermediaries.</span></span> <span data-ttu-id="afe3a-122">A definição do modo de transferência não é refletida na descrição da interface de serviço.</span><span class="sxs-lookup"><span data-stu-id="afe3a-122">Setting the transfer mode is not reflected in the description of the service interface.</span></span> <span data-ttu-id="afe3a-123">Depois de gerar uma classe de cliente para um serviço, você deve editar o arquivo de configuração para serviços que se destina a ser usado com transferências em fluxo para definir o modo.</span><span class="sxs-lookup"><span data-stu-id="afe3a-123">After generating a client class for a service, you must edit the configuration file for services intended to be used with streamed transfers to set the mode.</span></span> <span data-ttu-id="afe3a-124">Para transportes TCP e pipe nomeado, o modo de transferência é propagado como uma declaração de política.</span><span class="sxs-lookup"><span data-stu-id="afe3a-124">For TCP and named pipe transports, the transfer mode is propagated as a policy assertion.</span></span>  
  
 <span data-ttu-id="afe3a-125">Para obter exemplos de código, consulte [como: habilitar o Streaming](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="afe3a-125">For code samples, see [How to: Enable Streaming](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md).</span></span>  
  
## <a name="enabling-asynchronous-streaming"></a><span data-ttu-id="afe3a-126">Habilitando o streaming assíncrono</span><span class="sxs-lookup"><span data-stu-id="afe3a-126">Enabling Asynchronous Streaming</span></span>  
 <span data-ttu-id="afe3a-127">Para habilitar o streaming assíncrono, adicione o comportamento do ponto de extremidade <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> ao host de serviço e defina sua propriedade <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> como `true`.</span><span class="sxs-lookup"><span data-stu-id="afe3a-127">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="afe3a-128">Esta versão do WCF também adde a capacidade de streaming assíncrona verdadeiro no lado de envio.</span><span class="sxs-lookup"><span data-stu-id="afe3a-128">This version of WCF also adde the capability of true asynchronous streaming on the send side.</span></span> <span data-ttu-id="afe3a-129">Isso melhora a escalabilidade do serviço em cenários onde ele está transmitindo mensagens a vários clientes, alguns dos quais estão lentos na leitura; possivelmente devido a congestionamento da rede ou estão não ler nenhum.</span><span class="sxs-lookup"><span data-stu-id="afe3a-129">This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading; possibly due to network congestion or are not reading at all.</span></span> <span data-ttu-id="afe3a-130">Nesses cenários WCF não bloqueia segmentos individuais no serviço por cliente.</span><span class="sxs-lookup"><span data-stu-id="afe3a-130">In these scenarios WCF no longer blocks individual threads on the service per client.</span></span> <span data-ttu-id="afe3a-131">Isso garante que o serviço possa processar muito mais clientes, melhorando dessa forma a escalabilidade do serviço.</span><span class="sxs-lookup"><span data-stu-id="afe3a-131">This ensures that the service is able to process many more clients thereby improving the scalability of the service.</span></span>  
  
## <a name="restrictions-on-streamed-transfers"></a><span data-ttu-id="afe3a-132">Restrições em transferências em fluxo</span><span class="sxs-lookup"><span data-stu-id="afe3a-132">Restrictions on Streamed Transfers</span></span>  
 <span data-ttu-id="afe3a-133">Usar o modo de transferência em fluxo faz com que o tempo de execução para impor restrições adicionais.</span><span class="sxs-lookup"><span data-stu-id="afe3a-133">Using the streamed transfer mode causes the run time to enforce additional restrictions.</span></span>  
  
 <span data-ttu-id="afe3a-134">As operações que ocorrem em um transporte em fluxo podem ter um contrato com no máximo uma entrada ou saído parâmetro.</span><span class="sxs-lookup"><span data-stu-id="afe3a-134">Operations that occur across a streamed transport can have a contract with at most one input or output parameter.</span></span> <span data-ttu-id="afe3a-135">Esse parâmetro corresponde a todo o corpo da mensagem e deve ser um <xref:System.ServiceModel.Channels.Message>, um derivado do tipo de <xref:System.IO.Stream>, ou um <xref:System.Xml.Serialization.IXmlSerializable> implementação.</span><span class="sxs-lookup"><span data-stu-id="afe3a-135">That parameter corresponds to the entire body of the message and must be a <xref:System.ServiceModel.Channels.Message>, a derived type of <xref:System.IO.Stream>, or an <xref:System.Xml.Serialization.IXmlSerializable> implementation.</span></span> <span data-ttu-id="afe3a-136">Ter um valor de retorno para uma operação é equivalente a ter um parâmetro de saída.</span><span class="sxs-lookup"><span data-stu-id="afe3a-136">Having a return value for an operation is equivalent to having an output parameter.</span></span>  
  
 <span data-ttu-id="afe3a-137">Alguns [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] recursos, como mensagens confiáveis, transações e segurança em nível de mensagem SOAP, dependem de mensagens para as transmissões de buffer.</span><span class="sxs-lookup"><span data-stu-id="afe3a-137">Some [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] features, such as reliable messaging, transactions, and SOAP message-level security, rely on buffering messages for transmissions.</span></span> <span data-ttu-id="afe3a-138">Usando esses recursos pode reduzir ou eliminar os benefícios de desempenho obtidos usando streaming.</span><span class="sxs-lookup"><span data-stu-id="afe3a-138">Using these features may reduce or eliminate the performance benefits gained by using streaming.</span></span> <span data-ttu-id="afe3a-139">Para proteger um transporte em fluxo, use apenas a segurança de nível de transporte ou usar segurança em nível de transporte e segurança de mensagem somente autenticação.</span><span class="sxs-lookup"><span data-stu-id="afe3a-139">To secure a streamed transport, use transport-level security only or use transport-level security plus authentication-only message security.</span></span>  
  
 <span data-ttu-id="afe3a-140">Cabeçalhos SOAP são sempre armazenados em buffer, mesmo quando o modo de transferência é definido como em fluxo.</span><span class="sxs-lookup"><span data-stu-id="afe3a-140">SOAP headers are always buffered, even when the transfer mode is set to streamed.</span></span> <span data-ttu-id="afe3a-141">Os cabeçalhos para uma mensagem não devem exceder o tamanho do `MaxBufferSize` cota de transporte.</span><span class="sxs-lookup"><span data-stu-id="afe3a-141">The headers for a message must not exceed the size of the `MaxBufferSize` transport quota.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="afe3a-142">Essa configuração, consulte [cotas de transporte](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="afe3a-142"> this setting, see [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>  
  
## <a name="differences-between-buffered-and-streamed-transfers"></a><span data-ttu-id="afe3a-143">Diferenças entre as transferências em buffer e em fluxo</span><span class="sxs-lookup"><span data-stu-id="afe3a-143">Differences Between Buffered and Streamed Transfers</span></span>  
 <span data-ttu-id="afe3a-144">Alterar o modo de transferência do buffer transmitido também altera a forma de canal nativo do TCP e transportes de pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="afe3a-144">Changing the transfer mode from buffered to streamed also changes the native channel shape of the TCP and named pipe transports.</span></span> <span data-ttu-id="afe3a-145">Para transferências em buffer, a forma de canal nativo é <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="afe3a-145">For buffered transfers, the native channel shape is <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span> <span data-ttu-id="afe3a-146">Para transferências em fluxo, os canais nativo são <xref:System.ServiceModel.Channels.IRequestChannel> e <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="afe3a-146">For streamed transfers, the native channels are <xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span> <span data-ttu-id="afe3a-147">Alterar o modo de transferência em um aplicativo existente que usa estes transporta diretamente (ou seja, não por meio de um contrato de serviço) requer a alteração da forma de canal esperado para fábricas de canais e ouvintes.</span><span class="sxs-lookup"><span data-stu-id="afe3a-147">Changing the transfer mode in an existing application that uses these transports directly (that is, not through a service contract) requires changing the expected channel shape for channel factories and listeners.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="afe3a-148">Consulte também</span><span class="sxs-lookup"><span data-stu-id="afe3a-148">See Also</span></span>  
 [<span data-ttu-id="afe3a-149">Como habilitar o streaming</span><span class="sxs-lookup"><span data-stu-id="afe3a-149">How to: Enable Streaming</span></span>](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md)
