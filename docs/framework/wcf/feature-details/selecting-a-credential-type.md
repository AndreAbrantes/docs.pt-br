---
title: Selecionando um tipo de credencial
ms.date: 03/30/2017
ms.assetid: bf707063-3f30-4304-ab53-0e63413728a8
ms.openlocfilehash: 8aa959aa952e839039bebffddddd951fbc1eb0d4
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61748793"
---
# <a name="selecting-a-credential-type"></a><span data-ttu-id="b482c-102">Selecionando um tipo de credencial</span><span class="sxs-lookup"><span data-stu-id="b482c-102">Selecting a Credential Type</span></span>
<span data-ttu-id="b482c-103">*Credenciais* são os dados que usa o Windows Communication Foundation (WCF) para estabelecer uma identidade reivindicada ou recursos.</span><span class="sxs-lookup"><span data-stu-id="b482c-103">*Credentials* are the data Windows Communication Foundation (WCF) uses to establish either a claimed identity or capabilities.</span></span> <span data-ttu-id="b482c-104">Por exemplo, o passport é uma credencial que um governo emite para provar cidadania em um país ou região.</span><span class="sxs-lookup"><span data-stu-id="b482c-104">For example, a passport is a credential a government issues to prove citizenship in a country or region.</span></span> <span data-ttu-id="b482c-105">No WCF, as credenciais podem assumir várias formas, como tokens de nome de usuário e certificados x. 509.</span><span class="sxs-lookup"><span data-stu-id="b482c-105">In WCF, credentials can take many forms, such as user name tokens and X.509 certificates.</span></span> <span data-ttu-id="b482c-106">Este tópico discute como selecionar o credencial correto para seu aplicativo, como eles são usados no WCF e credenciais.</span><span class="sxs-lookup"><span data-stu-id="b482c-106">This topic discusses credentials, how they are used in WCF, and how to select the right credential for your application.</span></span>  
  
 <span data-ttu-id="b482c-107">Em muitos países e regiões, de motorista uma carteira é um exemplo de uma credencial.</span><span class="sxs-lookup"><span data-stu-id="b482c-107">In many countries and regions, a driver’s license is an example of a credential.</span></span> <span data-ttu-id="b482c-108">Uma licença contém dados que representa os recursos e a identidade de uma pessoa.</span><span class="sxs-lookup"><span data-stu-id="b482c-108">A license contains data that represents a person's identity and capabilities.</span></span> <span data-ttu-id="b482c-109">Ele contém uma prova de posse na forma de imagem do detentor.</span><span class="sxs-lookup"><span data-stu-id="b482c-109">It contains proof of possession in the form of the possessor's picture.</span></span> <span data-ttu-id="b482c-110">A licença é emitida por uma autoridade confiável, normalmente, um departamento governamental de licenciamento.</span><span class="sxs-lookup"><span data-stu-id="b482c-110">The license is issued by a trusted authority, usually a governmental department of licensing.</span></span> <span data-ttu-id="b482c-111">A licença é lacrada e pode conter um holograma, mostrando que ele não foi adulterado ou falsificado.</span><span class="sxs-lookup"><span data-stu-id="b482c-111">The license is sealed, and can contain a hologram, showing that it has not been tampered with or counterfeited.</span></span>  
  
 <span data-ttu-id="b482c-112">Apresentar uma credencial envolve a apresentar os dados e a prova de posse dos dados.</span><span class="sxs-lookup"><span data-stu-id="b482c-112">Presenting a credential involves presenting both the data and proof of possession of the data.</span></span> <span data-ttu-id="b482c-113">O WCF oferece suporte a uma variedade de tipos de credenciais nos níveis de segurança de transporte e de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b482c-113">WCF supports a variety of credential types at both the transport and message security levels.</span></span> <span data-ttu-id="b482c-114">Por exemplo, considere dois tipos de credenciais com suporte no WCF: credenciais de certificado de nome de usuário e (x. 509).</span><span class="sxs-lookup"><span data-stu-id="b482c-114">For example, consider two types of credentials supported in WCF: user name and (X.509) certificate credentials.</span></span>  
  
 <span data-ttu-id="b482c-115">Para a credencial de nome de usuário, o nome de usuário representa a identidade reivindicada e a senha fornece a prova de posse.</span><span class="sxs-lookup"><span data-stu-id="b482c-115">For the user name credential, the user name represents the claimed identity and the password provides proof of possession.</span></span> <span data-ttu-id="b482c-116">Nesse caso, a autoridade confiável é o sistema que valida o nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="b482c-116">The trusted authority in this case is the system that validates the user name and password.</span></span>  
  
 <span data-ttu-id="b482c-117">Com uma credencial de certificado x. 509, o nome da entidade, o nome alternativo da entidade ou a campos específicos no certificado podem ser usados como declarações de identidade, enquanto outros campos, tais como o `Valid From` e `Valid To` campos, especifique a validade das certificado.</span><span class="sxs-lookup"><span data-stu-id="b482c-117">With an X.509 certificate credential, the subject name, subject alternative name or specific fields within the certificate can be used as claims of identity, while other fields, such as the `Valid From` and `Valid To` fields, specify the validity of the certificate.</span></span>  
  
## <a name="transport-credential-types"></a><span data-ttu-id="b482c-118">Tipos de credenciais de transporte</span><span class="sxs-lookup"><span data-stu-id="b482c-118">Transport Credential Types</span></span>  
 <span data-ttu-id="b482c-119">A tabela a seguir mostra os possíveis tipos de credenciais do cliente que podem ser usados por uma associação no modo de segurança de transporte.</span><span class="sxs-lookup"><span data-stu-id="b482c-119">The following table shows the possible types of client credentials that can be used by a binding in transport security mode.</span></span> <span data-ttu-id="b482c-120">Ao criar um serviço, defina o `ClientCredentialType` propriedade a ser um destes valores para especificar o tipo de credencial que o cliente deve fornecer para se comunicar com seu serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-120">When creating a service, set the `ClientCredentialType` property to one of these values to specify the type of credential that the client must supply to communicate with your service.</span></span> <span data-ttu-id="b482c-121">Você pode definir os tipos nos arquivos de configuração ou código.</span><span class="sxs-lookup"><span data-stu-id="b482c-121">You can set the types in either code or configuration files.</span></span>  
  
|<span data-ttu-id="b482c-122">Configuração</span><span class="sxs-lookup"><span data-stu-id="b482c-122">Setting</span></span>|<span data-ttu-id="b482c-123">Descrição</span><span class="sxs-lookup"><span data-stu-id="b482c-123">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b482c-124">Nenhum</span><span class="sxs-lookup"><span data-stu-id="b482c-124">None</span></span>|<span data-ttu-id="b482c-125">Especifica que o cliente não precisa apresentar nenhuma credencial.</span><span class="sxs-lookup"><span data-stu-id="b482c-125">Specifies that the client does not need to present any credential.</span></span> <span data-ttu-id="b482c-126">Isso se traduz em um cliente anônimo.</span><span class="sxs-lookup"><span data-stu-id="b482c-126">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="b482c-127">Basic</span><span class="sxs-lookup"><span data-stu-id="b482c-127">Basic</span></span>|<span data-ttu-id="b482c-128">Especifica a autenticação básica para o cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-128">Specifies basic authentication for the client.</span></span> <span data-ttu-id="b482c-129">Para obter mais informações, consulte o RFC2617 –[autenticação HTTP: Autenticação Básica e Digest](https://go.microsoft.com/fwlink/?LinkID=88313).</span><span class="sxs-lookup"><span data-stu-id="b482c-129">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](https://go.microsoft.com/fwlink/?LinkID=88313).</span></span>|  
|<span data-ttu-id="b482c-130">Digest</span><span class="sxs-lookup"><span data-stu-id="b482c-130">Digest</span></span>|<span data-ttu-id="b482c-131">Especifica a autenticação digest para o cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-131">Specifies digest authentication for the client.</span></span> <span data-ttu-id="b482c-132">Para obter mais informações, consulte o RFC2617 –[autenticação HTTP: Autenticação Básica e Digest](https://go.microsoft.com/fwlink/?LinkID=88313).</span><span class="sxs-lookup"><span data-stu-id="b482c-132">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](https://go.microsoft.com/fwlink/?LinkID=88313).</span></span>|  
|<span data-ttu-id="b482c-133">NTLM</span><span class="sxs-lookup"><span data-stu-id="b482c-133">Ntlm</span></span>|<span data-ttu-id="b482c-134">Especifica a autenticação NT LAN Manager (NTLM).</span><span class="sxs-lookup"><span data-stu-id="b482c-134">Specifies NT LAN Manager (NTLM) authentication.</span></span> <span data-ttu-id="b482c-135">Isso é usado quando você não pode usar a autenticação Kerberos por algum motivo.</span><span class="sxs-lookup"><span data-stu-id="b482c-135">This is used when you cannot use Kerberos authentication for some reason.</span></span> <span data-ttu-id="b482c-136">Você também pode desabilitar seu uso como um fallback definindo a <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> propriedade para `false`, que faz com que o WCF fazer um esforço para lançar uma exceção se NTLM for usado.</span><span class="sxs-lookup"><span data-stu-id="b482c-136">You can also disable its use as a fallback by setting the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false`, which causes WCF to make a best-effort to throw an exception if NTLM is used.</span></span> <span data-ttu-id="b482c-137">Observe que a definição dessa propriedade `false` talvez não impeçam que as credenciais do NTLM sejam enviados durante a transmissão.</span><span class="sxs-lookup"><span data-stu-id="b482c-137">Note that setting this property to `false` may not prevent NTLM credentials from being sent over the wire.</span></span>|  
|<span data-ttu-id="b482c-138">Windows</span><span class="sxs-lookup"><span data-stu-id="b482c-138">Windows</span></span>|<span data-ttu-id="b482c-139">Especifica autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="b482c-139">Specifies Windows authentication.</span></span> <span data-ttu-id="b482c-140">Para especificar apenas o protocolo Kerberos em um domínio do Windows, defina as <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> propriedade para `false` (o padrão é `true`).</span><span class="sxs-lookup"><span data-stu-id="b482c-140">To specify only the Kerberos protocol on a Windows domain, set the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false` (the default is `true`).</span></span>|  
|<span data-ttu-id="b482c-141">Certificado</span><span class="sxs-lookup"><span data-stu-id="b482c-141">Certificate</span></span>|<span data-ttu-id="b482c-142">Executa a autenticação de cliente usando um certificado X.509.</span><span class="sxs-lookup"><span data-stu-id="b482c-142">Performs client authentication using an X.509 certificate.</span></span>|  
|<span data-ttu-id="b482c-143">Senha</span><span class="sxs-lookup"><span data-stu-id="b482c-143">Password</span></span>|<span data-ttu-id="b482c-144">Usuário deve fornecer um nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="b482c-144">User must supply a user name and password.</span></span> <span data-ttu-id="b482c-145">Valide o par de nome/senha de usuário usando a autenticação do Windows ou outra solução personalizada.</span><span class="sxs-lookup"><span data-stu-id="b482c-145">Validate the user name/password pair using Windows authentication or another custom solution.</span></span>|  
  
### <a name="message-client-credential-types"></a><span data-ttu-id="b482c-146">Tipos de credencial de cliente de mensagem</span><span class="sxs-lookup"><span data-stu-id="b482c-146">Message Client Credential Types</span></span>  
 <span data-ttu-id="b482c-147">A tabela a seguir mostra os tipos de credencial possíveis que você pode usar ao criar um aplicativo que usa a segurança de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b482c-147">The following table shows the possible credential types that you can use when creating an application that uses message security.</span></span> <span data-ttu-id="b482c-148">Você pode usar esses valores em arquivos de configuração ou código.</span><span class="sxs-lookup"><span data-stu-id="b482c-148">You can use these values in either code or configuration files.</span></span>  
  
|<span data-ttu-id="b482c-149">Configuração</span><span class="sxs-lookup"><span data-stu-id="b482c-149">Setting</span></span>|<span data-ttu-id="b482c-150">Descrição</span><span class="sxs-lookup"><span data-stu-id="b482c-150">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="b482c-151">Nenhum</span><span class="sxs-lookup"><span data-stu-id="b482c-151">None</span></span>|<span data-ttu-id="b482c-152">Especifica que o cliente não precisa apresentar uma credencial.</span><span class="sxs-lookup"><span data-stu-id="b482c-152">Specifies that the client does not need to present a credential.</span></span> <span data-ttu-id="b482c-153">Isso se traduz em um cliente anônimo.</span><span class="sxs-lookup"><span data-stu-id="b482c-153">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="b482c-154">Windows</span><span class="sxs-lookup"><span data-stu-id="b482c-154">Windows</span></span>|<span data-ttu-id="b482c-155">Permite que as trocas de mensagens SOAP ocorrer sob o contexto de segurança estabelecido com uma credencial do Windows.</span><span class="sxs-lookup"><span data-stu-id="b482c-155">Allows SOAP message exchanges to occur under the security context established with a Windows credential.</span></span>|  
|<span data-ttu-id="b482c-156">Nome de usuário</span><span class="sxs-lookup"><span data-stu-id="b482c-156">Username</span></span>|<span data-ttu-id="b482c-157">Permite que o serviço exigir que o cliente seja autenticado com uma credencial de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="b482c-157">Allows the service to require that the client be authenticated with a user name credential.</span></span> <span data-ttu-id="b482c-158">Observe que o WCF não permite todas as operações criptográficas com nomes de usuário, como gerar uma assinatura ou criptografia de dados.</span><span class="sxs-lookup"><span data-stu-id="b482c-158">Note that WCF does not allow any cryptographic operations with user names, such as generating a signature or encrypting data.</span></span> <span data-ttu-id="b482c-159">WCF garante que o transporte é protegido ao usar as credenciais de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="b482c-159">WCF ensures that the transport is secured when using user name credentials.</span></span>|  
|<span data-ttu-id="b482c-160">Certificado</span><span class="sxs-lookup"><span data-stu-id="b482c-160">Certificate</span></span>|<span data-ttu-id="b482c-161">Permite que o serviço exigir que o cliente seja autenticado usando um certificado X.509.</span><span class="sxs-lookup"><span data-stu-id="b482c-161">Allows the service to require that the client be authenticated using an X.509 certificate.</span></span>|  
|<span data-ttu-id="b482c-162">Emitido de Token</span><span class="sxs-lookup"><span data-stu-id="b482c-162">Issued Token</span></span>|<span data-ttu-id="b482c-163">Um tipo de token personalizado configurado de acordo com uma política de segurança.</span><span class="sxs-lookup"><span data-stu-id="b482c-163">A custom token type configured according to a security policy.</span></span> <span data-ttu-id="b482c-164">O tipo de token padrão é asserções marcação linguagem SAML (Security).</span><span class="sxs-lookup"><span data-stu-id="b482c-164">The default token type is Security Assertions Markup Language (SAML).</span></span> <span data-ttu-id="b482c-165">O token é emitido por um serviço de token seguro.</span><span class="sxs-lookup"><span data-stu-id="b482c-165">The token is issued by a secure token service.</span></span> <span data-ttu-id="b482c-166">Para obter mais informações, consulte [federação e Tokens emitidos](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="b482c-166">For more information, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span></span>|  
  
### <a name="negotiation-model-of-service-credentials"></a><span data-ttu-id="b482c-167">Modelo de negociação de credenciais de serviço</span><span class="sxs-lookup"><span data-stu-id="b482c-167">Negotiation Model of Service Credentials</span></span>  
 <span data-ttu-id="b482c-168">*Negociação* é o processo de estabelecer a relação de confiança entre um cliente e um serviço por meio da troca as credenciais.</span><span class="sxs-lookup"><span data-stu-id="b482c-168">*Negotiation* is the process of establishing trust between a client and a service by exchanging credentials.</span></span> <span data-ttu-id="b482c-169">O processo é executado de forma iterativa entre o cliente e o serviço de modo a divulgar apenas as informações necessárias para a próxima etapa no processo de negociação.</span><span class="sxs-lookup"><span data-stu-id="b482c-169">The process is performed iteratively between the client and the service, so as to disclose only the information necessary for the next step in the negotiation process.</span></span> <span data-ttu-id="b482c-170">Na prática, o resultado final é o fornecimento de credenciais do serviço para o cliente a ser usado em operações subsequentes.</span><span class="sxs-lookup"><span data-stu-id="b482c-170">In practice, the end result is the delivery of a service's credential to the client to be used in subsequent operations.</span></span>  
  
 <span data-ttu-id="b482c-171">Com uma exceção, por padrão as associações fornecidas pelo sistema no WCF negociam a credencial de serviço automaticamente ao usar a segurança de nível de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b482c-171">With one exception, by default the system-provided bindings in WCF negotiate the service credential automatically when using message-level security.</span></span> <span data-ttu-id="b482c-172">(A exceção é o <xref:System.ServiceModel.BasicHttpBinding>, que não permite segurança por padrão.) Para desabilitar esse comportamento, consulte o <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> e <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> propriedades.</span><span class="sxs-lookup"><span data-stu-id="b482c-172">(The exception is the <xref:System.ServiceModel.BasicHttpBinding>, which does not enable security by default.) To disable this behavior, see the <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> and <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b482c-173">Quando segurança SSL é usada com o .NET Framework 3.5 e posterior, um cliente WCF usa tanto os certificados intermediários em seu repositório de certificados e os certificados intermediários recebidos durante a negociação SSL para executar a validação da cadeia de certificado do serviço certificado.</span><span class="sxs-lookup"><span data-stu-id="b482c-173">When SSL security is used with .NET Framework 3.5 and later, a WCF client uses both the intermediate certificates in its certificate store and the intermediate certificates received during SSL negotiation to perform certificate chain validation on the service's certificate.</span></span> <span data-ttu-id="b482c-174">.NET framework 3.0 usa apenas os certificados intermediários instalados no repositório de certificados local.</span><span class="sxs-lookup"><span data-stu-id="b482c-174">.NET Framework 3.0 only uses the intermediate certificates installed in the local certificate store.</span></span>  
  
#### <a name="out-of-band-negotiation"></a><span data-ttu-id="b482c-175">Negociação de out-of-Band</span><span class="sxs-lookup"><span data-stu-id="b482c-175">Out-of-Band Negotiation</span></span>  
 <span data-ttu-id="b482c-176">Se a negociação automática estiver desabilitada, a credencial de serviço deve ser provisionada no cliente antes de enviar todas as mensagens para o serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-176">If automatic negotiation is disabled, the service credential must be provisioned at the client prior to sending any messages to the service.</span></span> <span data-ttu-id="b482c-177">Isso também é conhecido como um *out-of-band* provisionamento.</span><span class="sxs-lookup"><span data-stu-id="b482c-177">This is also known as an *out-of-band* provisioning.</span></span> <span data-ttu-id="b482c-178">Por exemplo, se o tipo de credencial especificado é um certificado e negociação automática está desabilitada, o cliente deverá contatar o proprietário do serviço para receber e instalar o certificado no computador que executa o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-178">For example, if the specified credential type is a certificate, and automatic negotiation is disabled, the client must contact the service owner to receive and install the certificate on the computer running the client application.</span></span> <span data-ttu-id="b482c-179">Isso pode ser feito, por exemplo, quando você deseja controlar rigidamente quais clientes podem acessar um serviço em um cenário de business-to-business.</span><span class="sxs-lookup"><span data-stu-id="b482c-179">This can be done, for example, when you want to strictly control which clients can access a service in a business-to-business scenario.</span></span> <span data-ttu-id="b482c-180">Essa fora-de-band-negociação pode ser feito no email e o certificado X.509 é armazenado no repositório de certificados do Windows, usando uma ferramenta como o snap-in de certificados do Microsoft Management Console (MMC).</span><span class="sxs-lookup"><span data-stu-id="b482c-180">This out-of-band-negotiation can be done in email, and the X.509 certificate is stored in Windows certificate store, using a tool such as the Microsoft Management Console (MMC) Certificates snap-in.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b482c-181">O <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade é usada para fornecer o serviço com um certificado que foi obtido por meio de negociação de out-of-band.</span><span class="sxs-lookup"><span data-stu-id="b482c-181">The <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property is used to provide the service with a certificate that was attained through out-of-band negotiation.</span></span> <span data-ttu-id="b482c-182">Isso é necessário ao usar o <xref:System.ServiceModel.BasicHttpBinding> classe porque a associação não permite negociação automatizada.</span><span class="sxs-lookup"><span data-stu-id="b482c-182">This is necessary when using the <xref:System.ServiceModel.BasicHttpBinding> class because the binding does not allow automated negotiation.</span></span> <span data-ttu-id="b482c-183">A propriedade também é usada em um cenário de duplex não correlacionado.</span><span class="sxs-lookup"><span data-stu-id="b482c-183">The property is also used in an uncorrelated duplex scenario.</span></span> <span data-ttu-id="b482c-184">Isso é um cenário em que um servidor envia uma mensagem para o cliente sem a necessidade do cliente enviar uma solicitação ao servidor pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="b482c-184">This is a scenario where a server sends a message to the client without requiring the client to send a request to the server first.</span></span> <span data-ttu-id="b482c-185">Porque o servidor não tem uma solicitação do cliente, ele deve usar o certificado do cliente para criptografar a mensagem ao cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-185">Because the server does not have a request from the client, it must use the client's certificate to encrypt the message to the client.</span></span>  
  
## <a name="setting-credential-values"></a><span data-ttu-id="b482c-186">Definindo valores de credencial</span><span class="sxs-lookup"><span data-stu-id="b482c-186">Setting Credential Values</span></span>  
 <span data-ttu-id="b482c-187">Depois de selecionar um modo de segurança, você deve especificar as credenciais reais.</span><span class="sxs-lookup"><span data-stu-id="b482c-187">Once you select a security mode, you must specify the actual credentials.</span></span> <span data-ttu-id="b482c-188">Por exemplo, se o tipo de credencial é definido como "certificado", você deve associar uma credencial específica (por exemplo, um certificado x. 509 específico) com o serviço ou cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-188">For example, if the credential type is set to "certificate," then you must associate a specific credential (such as a specific X.509 certificate) with the service or client.</span></span>  
  
 <span data-ttu-id="b482c-189">Dependendo se você estiver programando um cliente ou um serviço, o método para definir o valor de credencial é ligeiramente diferente.</span><span class="sxs-lookup"><span data-stu-id="b482c-189">Depending on whether you are programming a service or a client, the method for setting the credential value differs slightly.</span></span>  
  
### <a name="setting-service-credentials"></a><span data-ttu-id="b482c-190">Credenciais do serviço de configuração</span><span class="sxs-lookup"><span data-stu-id="b482c-190">Setting Service Credentials</span></span>  
 <span data-ttu-id="b482c-191">Se você estiver usando o modo de transporte e você estiver usando HTTP como o transporte, você deve usar qualquer um dos serviços de informações da Internet (IIS) ou configurar a porta com um certificado.</span><span class="sxs-lookup"><span data-stu-id="b482c-191">If you are using transport mode, and you are using HTTP as the transport, you must use either Internet Information Services (IIS) or configure the port with a certificate.</span></span> <span data-ttu-id="b482c-192">Para obter mais informações, consulte [visão geral da segurança de transporte](../../../../docs/framework/wcf/feature-details/transport-security-overview.md) e [segurança de transporte HTTP](../../../../docs/framework/wcf/feature-details/http-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="b482c-192">For more information, see [Transport Security Overview](../../../../docs/framework/wcf/feature-details/transport-security-overview.md) and [HTTP Transport Security](../../../../docs/framework/wcf/feature-details/http-transport-security.md).</span></span>  
  
 <span data-ttu-id="b482c-193">Para provisionar um serviço com credenciais no código, crie uma instância do <xref:System.ServiceModel.ServiceHost> de classe e especificar as credenciais apropriadas usando o <xref:System.ServiceModel.Description.ServiceCredentials> classe, acessado por meio de <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b482c-193">To provision a service with credentials in code, create an instance of the <xref:System.ServiceModel.ServiceHost> class and specify the appropriate credential using the <xref:System.ServiceModel.Description.ServiceCredentials> class, accessed through the <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> property.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="b482c-194">Configurar um certificado</span><span class="sxs-lookup"><span data-stu-id="b482c-194">Setting a Certificate</span></span>  
 <span data-ttu-id="b482c-195">Para provisionar um serviço com um certificado X.509 a ser usado para autenticar o serviço aos clientes, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="b482c-195">To provision a service with an X.509 certificate to be used to authenticate the service to clients, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential> class.</span></span>  
  
 <span data-ttu-id="b482c-196">Para provisionar um serviço com um certificado de cliente, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="b482c-196">To provision a service with a client certificate, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential> class.</span></span>  
  
#### <a name="setting-windows-credentials"></a><span data-ttu-id="b482c-197">Configurar as credenciais do Windows</span><span class="sxs-lookup"><span data-stu-id="b482c-197">Setting Windows Credentials</span></span>  
 <span data-ttu-id="b482c-198">Se o cliente especificar um nome de usuário válido e uma senha, essa credencial é usada para autenticar o cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-198">If the client specifies a valid user name and password, that credential is used to authenticate the client.</span></span> <span data-ttu-id="b482c-199">Caso contrário, as credenciais de logon do usuário atual são usadas.</span><span class="sxs-lookup"><span data-stu-id="b482c-199">Otherwise, the current logged-on user's credentials are used.</span></span>  
  
### <a name="setting-client-credentials"></a><span data-ttu-id="b482c-200">Configurar as credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="b482c-200">Setting Client Credentials</span></span>  
 <span data-ttu-id="b482c-201">No WCF, os aplicativos cliente usar um cliente WCF para se conectar aos serviços.</span><span class="sxs-lookup"><span data-stu-id="b482c-201">In WCF, client applications use a WCF client to connect to services.</span></span> <span data-ttu-id="b482c-202">Deriva de todos os clientes a <xref:System.ServiceModel.ClientBase%601> classe e o <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade no cliente permite a especificação de vários valores de credenciais de cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-202">Every client derives from the <xref:System.ServiceModel.ClientBase%601> class, and the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property on the client allows the specification of various values of client credentials.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="b482c-203">Configurar um certificado</span><span class="sxs-lookup"><span data-stu-id="b482c-203">Setting a Certificate</span></span>  
 <span data-ttu-id="b482c-204">Para provisionar um serviço com um certificado X.509 que é usado para autenticar o cliente para um serviço, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="b482c-204">To provision a service with an X.509 certificate that is used to authenticate the client to a service, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential> class.</span></span>  
  
## <a name="how-client-credentials-are-used-to-authenticate-a-client-to-the-service"></a><span data-ttu-id="b482c-205">Como as credenciais do cliente são usadas para autenticar um cliente para o serviço</span><span class="sxs-lookup"><span data-stu-id="b482c-205">How Client Credentials Are Used to Authenticate a Client to the Service</span></span>  
 <span data-ttu-id="b482c-206">Informações de credenciais de cliente necessárias para se comunicar com um serviço são fornecidas usando o <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade ou o <xref:System.ServiceModel.ChannelFactory.Credentials%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b482c-206">Client credential information required to communicate with a service is provided using either the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property or the <xref:System.ServiceModel.ChannelFactory.Credentials%2A> property.</span></span> <span data-ttu-id="b482c-207">O canal de segurança usa essas informações para autenticar o cliente para o serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-207">The security channel uses this information to authenticate the client to the service.</span></span> <span data-ttu-id="b482c-208">A autenticação é realizada por meio de um dos dois modos:</span><span class="sxs-lookup"><span data-stu-id="b482c-208">Authentication is accomplished through one of two modes:</span></span>  
  
- <span data-ttu-id="b482c-209">As credenciais do cliente são usadas de uma vez antes da primeira mensagem é enviada usando a instância do cliente WCF para estabelecer um contexto de segurança.</span><span class="sxs-lookup"><span data-stu-id="b482c-209">The client credentials are used once before the first message is sent, using the WCF client instance to establish a security context.</span></span> <span data-ttu-id="b482c-210">Todas as mensagens de aplicativo, em seguida, são protegidas por meio do contexto de segurança.</span><span class="sxs-lookup"><span data-stu-id="b482c-210">All application messages are then secured through the security context.</span></span>  
  
- <span data-ttu-id="b482c-211">As credenciais do cliente são usadas para autenticar cada mensagem de aplicativo enviada para o serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-211">The client credentials are used to authenticate every application message sent to the service.</span></span> <span data-ttu-id="b482c-212">Nesse caso, nenhum contexto é estabelecido entre o cliente e o serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-212">In this case, no context is established between the client and the service.</span></span>  
  
### <a name="established-identities-cannot-be-changed"></a><span data-ttu-id="b482c-213">Identidades estabelecidas não podem ser alteradas.</span><span class="sxs-lookup"><span data-stu-id="b482c-213">Established Identities Cannot Be Changed</span></span>  
 <span data-ttu-id="b482c-214">Quando o primeiro método é usado, o contexto estabelecido é permanentemente associado com a identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="b482c-214">When the first method is used, the established context is permanently associated with the client identity.</span></span> <span data-ttu-id="b482c-215">Ou seja, quando o contexto de segurança tiver sido estabelecido, a identidade associada com o cliente não pode ser alterada.</span><span class="sxs-lookup"><span data-stu-id="b482c-215">That is, once the security context has been established, the identity associated with the client cannot be changed.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="b482c-216">Há uma situação de estar ciente de quando a identidade não pode ser alternada (ou seja, quando estabelecer a segurança contexto estiver ativado, o comportamento padrão).</span><span class="sxs-lookup"><span data-stu-id="b482c-216">There is a situation to be aware of when the identity cannot be switched (that is, when establish security context is on, the default behavior).</span></span> <span data-ttu-id="b482c-217">Se você criar um serviço que se comunica com um segundo serviço, a identidade usada para abrir o cliente do WCF para o segundo serviço não pode ser alterada.</span><span class="sxs-lookup"><span data-stu-id="b482c-217">If you create a service that communicates with a second service, the identity used to open the WCF client to the second service cannot be changed.</span></span> <span data-ttu-id="b482c-218">Isso se torna um problema se vários clientes têm permissão para usar o primeiro serviço e o serviço representa os clientes ao acessar o serviço de segundo.</span><span class="sxs-lookup"><span data-stu-id="b482c-218">This becomes a problem if multiple clients are allowed to use the first service and the service impersonates the clients when accessing the second service.</span></span> <span data-ttu-id="b482c-219">Se o serviço reutiliza o mesmo cliente para todos os chamadores, todas as chamadas para o segundo serviço são realizadas sob a identidade do chamador primeiro que foi usado para abrir o cliente para o serviço de segundo.</span><span class="sxs-lookup"><span data-stu-id="b482c-219">If the service reuses the same client for all callers, all calls to the second service are done under the identity of the first caller that was used to open the client to the second service.</span></span> <span data-ttu-id="b482c-220">Em outras palavras, o serviço usa a identidade do cliente de primeira para todos os seus clientes para se comunicar com o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-220">In other words, the service uses the identity of the first client for all its clients to communicate with the second service.</span></span> <span data-ttu-id="b482c-221">Isso pode levar à elevação de privilégio.</span><span class="sxs-lookup"><span data-stu-id="b482c-221">This can lead to the elevation of privilege.</span></span> <span data-ttu-id="b482c-222">Se isso não é o comportamento desejado do seu serviço, acompanhar cada chamador e criar um novo cliente para o serviço de segundo para todos os chamadores distintos e certifique-se de que o serviço usa somente o cliente correto para o chamador certo para se comunicar com o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="b482c-222">If this is not the desired behavior of your service, you must track each caller and create a new client to the second service for every distinct caller, and ensure that the service uses only the right client for the right caller to communicate with the second service.</span></span>  
  
 <span data-ttu-id="b482c-223">Para obter mais informações sobre credenciais e sessões seguras, consulte [considerações sobre segurança para sessões seguras](../../../../docs/framework/wcf/feature-details/security-considerations-for-secure-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="b482c-223">For more information about credentials and secure sessions, see [Security Considerations for Secure Sessions](../../../../docs/framework/wcf/feature-details/security-considerations-for-secure-sessions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b482c-224">Consulte também</span><span class="sxs-lookup"><span data-stu-id="b482c-224">See also</span></span>

- <xref:System.ServiceModel.ClientBase%601?displayProperty=nameWithType>
- <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Description.ClientCredentials.ClientCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.BasicHttpMessageSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.HttpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverMsmq.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverTcp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.TcpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A?displayProperty=nameWithType>
- [<span data-ttu-id="b482c-225">Conceitos de segurança</span><span class="sxs-lookup"><span data-stu-id="b482c-225">Security Concepts</span></span>](../../../../docs/framework/wcf/feature-details/security-concepts.md)
- [<span data-ttu-id="b482c-226">Protegendo serviços e clientes</span><span class="sxs-lookup"><span data-stu-id="b482c-226">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
- [<span data-ttu-id="b482c-227">Programação de segurança do WCF</span><span class="sxs-lookup"><span data-stu-id="b482c-227">Programming WCF Security</span></span>](../../../../docs/framework/wcf/feature-details/programming-wcf-security.md)
- [<span data-ttu-id="b482c-228">Segurança de transporte de HTTP</span><span class="sxs-lookup"><span data-stu-id="b482c-228">HTTP Transport Security</span></span>](../../../../docs/framework/wcf/feature-details/http-transport-security.md)
