---
title: Selecionando um tipo de credencial
description: Saiba mais sobre as credenciais, como elas são usadas no WCF e como selecionar a credencial correta para seu aplicativo estabelecer uma identidade ou recursos reivindicados.
ms.date: 03/30/2017
ms.assetid: bf707063-3f30-4304-ab53-0e63413728a8
ms.openlocfilehash: c5a47bf95ab8e22cda1beb7eeca7cb77bfc2a169
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96253967"
---
# <a name="selecting-a-credential-type"></a><span data-ttu-id="dbd9f-103">Selecionando um tipo de credencial</span><span class="sxs-lookup"><span data-stu-id="dbd9f-103">Selecting a Credential Type</span></span>

<span data-ttu-id="dbd9f-104">As *credenciais* são o uso de Windows Communication Foundation de dados (WCF) para estabelecer uma identidade ou recursos reivindicados.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-104">*Credentials* are the data Windows Communication Foundation (WCF) uses to establish either a claimed identity or capabilities.</span></span> <span data-ttu-id="dbd9f-105">Por exemplo, um passaporte é uma credencial que um governo emite para provar a cidadania em um país ou região.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-105">For example, a passport is a credential a government issues to prove citizenship in a country or region.</span></span> <span data-ttu-id="dbd9f-106">No WCF, as credenciais podem ter muitas formas, como tokens de nome de usuário e certificados X. 509.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-106">In WCF, credentials can take many forms, such as user name tokens and X.509 certificates.</span></span> <span data-ttu-id="dbd9f-107">Este tópico discute as credenciais, como elas são usadas no WCF e como selecionar a credencial correta para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-107">This topic discusses credentials, how they are used in WCF, and how to select the right credential for your application.</span></span>  
  
 <span data-ttu-id="dbd9f-108">Em muitos países e regiões, a licença de um driver é um exemplo de uma credencial.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-108">In many countries and regions, a driver’s license is an example of a credential.</span></span> <span data-ttu-id="dbd9f-109">Uma licença contém dados que representam a identidade e os recursos de uma pessoa.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-109">A license contains data that represents a person's identity and capabilities.</span></span> <span data-ttu-id="dbd9f-110">Ele contém a prova de posse na forma da imagem do possessor.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-110">It contains proof of possession in the form of the possessor's picture.</span></span> <span data-ttu-id="dbd9f-111">A licença é emitida por uma autoridade confiável, geralmente um departamento governamental de licenciamento.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-111">The license is issued by a trusted authority, usually a governmental department of licensing.</span></span> <span data-ttu-id="dbd9f-112">A licença é selada e pode conter um holograma, mostrando que ela não foi violada ou falsificada.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-112">The license is sealed, and can contain a hologram, showing that it has not been tampered with or counterfeited.</span></span>  
  
 <span data-ttu-id="dbd9f-113">A apresentação de uma credencial envolve a apresentação dos dados e a prova de posse dos dados.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-113">Presenting a credential involves presenting both the data and proof of possession of the data.</span></span> <span data-ttu-id="dbd9f-114">O WCF dá suporte a uma variedade de tipos de credencial nos níveis de segurança de transporte e de mensagem.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-114">WCF supports a variety of credential types at both the transport and message security levels.</span></span> <span data-ttu-id="dbd9f-115">Por exemplo, considere dois tipos de credenciais com suporte no WCF: nome de usuário e credenciais de certificado (X. 509).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-115">For example, consider two types of credentials supported in WCF: user name and (X.509) certificate credentials.</span></span>  
  
 <span data-ttu-id="dbd9f-116">Para a credencial de nome de usuário, o nome de usuário representa a identidade solicitada e a senha fornece uma prova de posse.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-116">For the user name credential, the user name represents the claimed identity and the password provides proof of possession.</span></span> <span data-ttu-id="dbd9f-117">Nesse caso, a autoridade confiável é o sistema que valida o nome de usuário e a senha.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-117">The trusted authority in this case is the system that validates the user name and password.</span></span>  
  
 <span data-ttu-id="dbd9f-118">Com uma credencial de certificado X. 509, o nome da entidade, o nome alternativo da entidade ou campos específicos dentro do certificado podem ser usados como declarações de identidade, enquanto outros campos, como os `Valid From` `Valid To` campos e, especificam a validade do certificado.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-118">With an X.509 certificate credential, the subject name, subject alternative name or specific fields within the certificate can be used as claims of identity, while other fields, such as the `Valid From` and `Valid To` fields, specify the validity of the certificate.</span></span>  
  
## <a name="transport-credential-types"></a><span data-ttu-id="dbd9f-119">Tipos de credencial de transporte</span><span class="sxs-lookup"><span data-stu-id="dbd9f-119">Transport Credential Types</span></span>  

 <span data-ttu-id="dbd9f-120">A tabela a seguir mostra os possíveis tipos de credenciais de cliente que podem ser usadas por uma associação no modo de segurança de transporte.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-120">The following table shows the possible types of client credentials that can be used by a binding in transport security mode.</span></span> <span data-ttu-id="dbd9f-121">Ao criar um serviço, defina a `ClientCredentialType` propriedade como um desses valores para especificar o tipo de credencial que o cliente deve fornecer para se comunicar com o serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-121">When creating a service, set the `ClientCredentialType` property to one of these values to specify the type of credential that the client must supply to communicate with your service.</span></span> <span data-ttu-id="dbd9f-122">Você pode definir os tipos no código ou nos arquivos de configuração.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-122">You can set the types in either code or configuration files.</span></span>  
  
|<span data-ttu-id="dbd9f-123">Setting</span><span class="sxs-lookup"><span data-stu-id="dbd9f-123">Setting</span></span>|<span data-ttu-id="dbd9f-124">Descrição</span><span class="sxs-lookup"><span data-stu-id="dbd9f-124">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="dbd9f-125">Nenhum</span><span class="sxs-lookup"><span data-stu-id="dbd9f-125">None</span></span>|<span data-ttu-id="dbd9f-126">Especifica que o cliente não precisa apresentar nenhuma credencial.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-126">Specifies that the client does not need to present any credential.</span></span> <span data-ttu-id="dbd9f-127">Isso se traduz em um cliente anônimo.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-127">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="dbd9f-128">Básico</span><span class="sxs-lookup"><span data-stu-id="dbd9f-128">Basic</span></span>|<span data-ttu-id="dbd9f-129">Especifica a autenticação básica para o cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-129">Specifies basic authentication for the client.</span></span> <span data-ttu-id="dbd9f-130">Para obter informações adicionais, consulte RFC2617 –[autenticação http: autenticação básica e resumida](ftp://ftp.rfc-editor.org/in-notes/rfc2617.txt).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-130">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](ftp://ftp.rfc-editor.org/in-notes/rfc2617.txt).</span></span>|  
|<span data-ttu-id="dbd9f-131">Digest</span><span class="sxs-lookup"><span data-stu-id="dbd9f-131">Digest</span></span>|<span data-ttu-id="dbd9f-132">Especifica a autenticação Digest para o cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-132">Specifies digest authentication for the client.</span></span> <span data-ttu-id="dbd9f-133">Para obter informações adicionais, consulte RFC2617 –[autenticação http: autenticação básica e resumida](ftp://ftp.rfc-editor.org/in-notes/rfc2617.txt).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-133">For additional information, see RFC2617—[HTTP Authentication: Basic and Digest Authentication](ftp://ftp.rfc-editor.org/in-notes/rfc2617.txt).</span></span>|  
|<span data-ttu-id="dbd9f-134">Ntlm</span><span class="sxs-lookup"><span data-stu-id="dbd9f-134">Ntlm</span></span>|<span data-ttu-id="dbd9f-135">Especifica a autenticação NTLM (NT LAN Manager).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-135">Specifies NT LAN Manager (NTLM) authentication.</span></span> <span data-ttu-id="dbd9f-136">Isso é usado quando você não pode usar a autenticação Kerberos por algum motivo.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-136">This is used when you cannot use Kerberos authentication for some reason.</span></span> <span data-ttu-id="dbd9f-137">Você também pode desabilitar seu uso como um fallback definindo a <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> propriedade como `false` , o que faz com que o WCF faça um melhor esforço para gerar uma exceção se o NTLM for usado.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-137">You can also disable its use as a fallback by setting the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false`, which causes WCF to make a best-effort to throw an exception if NTLM is used.</span></span> <span data-ttu-id="dbd9f-138">Observe que a definição dessa propriedade como `false` pode não impedir que credenciais NTLM sejam enviadas pela conexão.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-138">Note that setting this property to `false` may not prevent NTLM credentials from being sent over the wire.</span></span>|  
|<span data-ttu-id="dbd9f-139">Windows</span><span class="sxs-lookup"><span data-stu-id="dbd9f-139">Windows</span></span>|<span data-ttu-id="dbd9f-140">Especifica autenticação do Windows.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-140">Specifies Windows authentication.</span></span> <span data-ttu-id="dbd9f-141">Para especificar apenas o protocolo Kerberos em um domínio do Windows, defina a <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> propriedade como `false` (o padrão é `true` ).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-141">To specify only the Kerberos protocol on a Windows domain, set the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowNtlm%2A> property to `false` (the default is `true`).</span></span>|  
|<span data-ttu-id="dbd9f-142">Certificado</span><span class="sxs-lookup"><span data-stu-id="dbd9f-142">Certificate</span></span>|<span data-ttu-id="dbd9f-143">Executa a autenticação de cliente usando um certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-143">Performs client authentication using an X.509 certificate.</span></span>|  
|<span data-ttu-id="dbd9f-144">Senha</span><span class="sxs-lookup"><span data-stu-id="dbd9f-144">Password</span></span>|<span data-ttu-id="dbd9f-145">O usuário deve fornecer um nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-145">User must supply a user name and password.</span></span> <span data-ttu-id="dbd9f-146">Valide o par de nome de usuário/senha usando a autenticação do Windows ou outra solução personalizada.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-146">Validate the user name/password pair using Windows authentication or another custom solution.</span></span>|  
  
### <a name="message-client-credential-types"></a><span data-ttu-id="dbd9f-147">Tipos de credencial do cliente da mensagem</span><span class="sxs-lookup"><span data-stu-id="dbd9f-147">Message Client Credential Types</span></span>  

 <span data-ttu-id="dbd9f-148">A tabela a seguir mostra os possíveis tipos de credencial que você pode usar ao criar um aplicativo que usa a segurança de mensagem.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-148">The following table shows the possible credential types that you can use when creating an application that uses message security.</span></span> <span data-ttu-id="dbd9f-149">Você pode usar esses valores no código ou nos arquivos de configuração.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-149">You can use these values in either code or configuration files.</span></span>  
  
|<span data-ttu-id="dbd9f-150">Setting</span><span class="sxs-lookup"><span data-stu-id="dbd9f-150">Setting</span></span>|<span data-ttu-id="dbd9f-151">Descrição</span><span class="sxs-lookup"><span data-stu-id="dbd9f-151">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="dbd9f-152">Nenhum</span><span class="sxs-lookup"><span data-stu-id="dbd9f-152">None</span></span>|<span data-ttu-id="dbd9f-153">Especifica que o cliente não precisa apresentar uma credencial.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-153">Specifies that the client does not need to present a credential.</span></span> <span data-ttu-id="dbd9f-154">Isso se traduz em um cliente anônimo.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-154">This translates to an anonymous client.</span></span>|  
|<span data-ttu-id="dbd9f-155">Windows</span><span class="sxs-lookup"><span data-stu-id="dbd9f-155">Windows</span></span>|<span data-ttu-id="dbd9f-156">Permite que as trocas de mensagens SOAP ocorram sob o contexto de segurança estabelecido com uma credencial do Windows.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-156">Allows SOAP message exchanges to occur under the security context established with a Windows credential.</span></span>|  
|<span data-ttu-id="dbd9f-157">Nome de usuário</span><span class="sxs-lookup"><span data-stu-id="dbd9f-157">Username</span></span>|<span data-ttu-id="dbd9f-158">Permite que o serviço exija que o cliente seja autenticado com uma credencial de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-158">Allows the service to require that the client be authenticated with a user name credential.</span></span> <span data-ttu-id="dbd9f-159">Observe que o WCF não permite nenhuma operação criptográfica com nomes de usuário, como gerar uma assinatura ou criptografar dados.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-159">Note that WCF does not allow any cryptographic operations with user names, such as generating a signature or encrypting data.</span></span> <span data-ttu-id="dbd9f-160">O WCF garante que o transporte seja protegido ao usar credenciais de nome de usuário.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-160">WCF ensures that the transport is secured when using user name credentials.</span></span>|  
|<span data-ttu-id="dbd9f-161">Certificado</span><span class="sxs-lookup"><span data-stu-id="dbd9f-161">Certificate</span></span>|<span data-ttu-id="dbd9f-162">Permite que o serviço exija que o cliente seja autenticado usando um certificado X. 509.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-162">Allows the service to require that the client be authenticated using an X.509 certificate.</span></span>|  
|<span data-ttu-id="dbd9f-163">Token emitido</span><span class="sxs-lookup"><span data-stu-id="dbd9f-163">Issued Token</span></span>|<span data-ttu-id="dbd9f-164">Um tipo de token personalizado configurado de acordo com uma política de segurança.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-164">A custom token type configured according to a security policy.</span></span> <span data-ttu-id="dbd9f-165">O tipo de token padrão é SAML (Security Asserties Markup Language).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-165">The default token type is Security Assertions Markup Language (SAML).</span></span> <span data-ttu-id="dbd9f-166">O token é emitido por um serviço de token seguro.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-166">The token is issued by a secure token service.</span></span> <span data-ttu-id="dbd9f-167">Para obter mais informações, consulte [Federação e tokens emitidos](federation-and-issued-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-167">For more information, see [Federation and Issued Tokens](federation-and-issued-tokens.md).</span></span>|  
  
### <a name="negotiation-model-of-service-credentials"></a><span data-ttu-id="dbd9f-168">Modelo de negociação de credenciais de serviço</span><span class="sxs-lookup"><span data-stu-id="dbd9f-168">Negotiation Model of Service Credentials</span></span>  

 <span data-ttu-id="dbd9f-169">*Negociação* é o processo de estabelecer confiança entre um cliente e um serviço por meio da troca de credenciais.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-169">*Negotiation* is the process of establishing trust between a client and a service by exchanging credentials.</span></span> <span data-ttu-id="dbd9f-170">O processo é executado iterativamente entre o cliente e o serviço, portanto, para divulgar apenas as informações necessárias para a próxima etapa no processo de negociação.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-170">The process is performed iteratively between the client and the service, so as to disclose only the information necessary for the next step in the negotiation process.</span></span> <span data-ttu-id="dbd9f-171">Na prática, o resultado final é a entrega da credencial de um serviço para o cliente a ser usada em operações subsequentes.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-171">In practice, the end result is the delivery of a service's credential to the client to be used in subsequent operations.</span></span>  
  
 <span data-ttu-id="dbd9f-172">Com uma exceção, por padrão, as associações fornecidas pelo sistema no WCF negociam automaticamente a credencial de serviço ao usar a segurança em nível de mensagem.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-172">With one exception, by default the system-provided bindings in WCF negotiate the service credential automatically when using message-level security.</span></span> <span data-ttu-id="dbd9f-173">(A exceção é o <xref:System.ServiceModel.BasicHttpBinding> , que não habilita a segurança por padrão.) Para desabilitar esse comportamento, consulte as <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> Propriedades e.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-173">(The exception is the <xref:System.ServiceModel.BasicHttpBinding>, which does not enable security by default.) To disable this behavior, see the <xref:System.ServiceModel.MessageSecurityOverHttp.NegotiateServiceCredential%2A> and <xref:System.ServiceModel.FederatedMessageSecurityOverHttp.NegotiateServiceCredential%2A> properties.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="dbd9f-174">Quando a segurança SSL é usada com o .NET Framework 3,5 e posterior, um cliente WCF usa os certificados intermediários em seu repositório de certificados e os certificados intermediários recebidos durante a negociação SSL para executar a validação da cadeia de certificados no certificado do serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-174">When SSL security is used with .NET Framework 3.5 and later, a WCF client uses both the intermediate certificates in its certificate store and the intermediate certificates received during SSL negotiation to perform certificate chain validation on the service's certificate.</span></span> <span data-ttu-id="dbd9f-175">.NET Framework 3,0 usa apenas os certificados intermediários instalados no repositório de certificados local.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-175">.NET Framework 3.0 only uses the intermediate certificates installed in the local certificate store.</span></span>  
  
#### <a name="out-of-band-negotiation"></a><span data-ttu-id="dbd9f-176">Negociação fora de banda</span><span class="sxs-lookup"><span data-stu-id="dbd9f-176">Out-of-Band Negotiation</span></span>  

 <span data-ttu-id="dbd9f-177">Se a negociação automática estiver desabilitada, a credencial de serviço deverá ser provisionada no cliente antes do envio de qualquer mensagem para o serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-177">If automatic negotiation is disabled, the service credential must be provisioned at the client prior to sending any messages to the service.</span></span> <span data-ttu-id="dbd9f-178">Isso também é conhecido como provisionamento *fora de banda* .</span><span class="sxs-lookup"><span data-stu-id="dbd9f-178">This is also known as an *out-of-band* provisioning.</span></span> <span data-ttu-id="dbd9f-179">Por exemplo, se o tipo de credencial especificado for um certificado e a negociação automática estiver desabilitada, o cliente deverá entrar em contato com o proprietário do serviço para receber e instalar o certificado no computador que executa o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-179">For example, if the specified credential type is a certificate, and automatic negotiation is disabled, the client must contact the service owner to receive and install the certificate on the computer running the client application.</span></span> <span data-ttu-id="dbd9f-180">Isso pode ser feito, por exemplo, quando você deseja controlar estritamente quais clientes podem acessar um serviço em um cenário entre empresas.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-180">This can be done, for example, when you want to strictly control which clients can access a service in a business-to-business scenario.</span></span> <span data-ttu-id="dbd9f-181">Essa negociação fora de banda pode ser feita por email, e o certificado X. 509 é armazenado no repositório de certificados do Windows, usando uma ferramenta como o snap-in de certificados do MMC (console de gerenciamento Microsoft).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-181">This out-of-band-negotiation can be done in email, and the X.509 certificate is stored in Windows certificate store, using a tool such as the Microsoft Management Console (MMC) Certificates snap-in.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="dbd9f-182">A <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade é usada para fornecer o serviço com um certificado que foi obtido por meio da negociação fora de banda.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-182">The <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property is used to provide the service with a certificate that was attained through out-of-band negotiation.</span></span> <span data-ttu-id="dbd9f-183">Isso é necessário ao usar a <xref:System.ServiceModel.BasicHttpBinding> classe porque a associação não permite a negociação automatizada.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-183">This is necessary when using the <xref:System.ServiceModel.BasicHttpBinding> class because the binding does not allow automated negotiation.</span></span> <span data-ttu-id="dbd9f-184">A propriedade também é usada em um cenário duplex não correlacionado.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-184">The property is also used in an uncorrelated duplex scenario.</span></span> <span data-ttu-id="dbd9f-185">Esse é um cenário em que um servidor envia uma mensagem ao cliente sem exigir que o cliente envie uma solicitação ao servidor primeiro.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-185">This is a scenario where a server sends a message to the client without requiring the client to send a request to the server first.</span></span> <span data-ttu-id="dbd9f-186">Como o servidor não tem uma solicitação do cliente, ele deve usar o certificado do cliente para criptografar a mensagem para o cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-186">Because the server does not have a request from the client, it must use the client's certificate to encrypt the message to the client.</span></span>  
  
## <a name="setting-credential-values"></a><span data-ttu-id="dbd9f-187">Definindo valores de credenciais</span><span class="sxs-lookup"><span data-stu-id="dbd9f-187">Setting Credential Values</span></span>  

 <span data-ttu-id="dbd9f-188">Depois de selecionar um modo de segurança, você deve especificar as credenciais reais.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-188">Once you select a security mode, you must specify the actual credentials.</span></span> <span data-ttu-id="dbd9f-189">Por exemplo, se o tipo de credencial for definido como "certificado", você deverá associar uma credencial específica (como um certificado X. 509 específico) ao serviço ou cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-189">For example, if the credential type is set to "certificate," then you must associate a specific credential (such as a specific X.509 certificate) with the service or client.</span></span>  
  
 <span data-ttu-id="dbd9f-190">Dependendo se você estiver programando um serviço ou um cliente, o método para definir o valor da credencial difere ligeiramente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-190">Depending on whether you are programming a service or a client, the method for setting the credential value differs slightly.</span></span>  
  
### <a name="setting-service-credentials"></a><span data-ttu-id="dbd9f-191">Definindo credenciais de serviço</span><span class="sxs-lookup"><span data-stu-id="dbd9f-191">Setting Service Credentials</span></span>  

 <span data-ttu-id="dbd9f-192">Se você estiver usando o modo de transporte e estiver usando HTTP como transporte, deverá usar Serviços de Informações da Internet (IIS) ou configurar a porta com um certificado.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-192">If you are using transport mode, and you are using HTTP as the transport, you must use either Internet Information Services (IIS) or configure the port with a certificate.</span></span> <span data-ttu-id="dbd9f-193">Para obter mais informações, consulte [visão geral de segurança de transporte](transport-security-overview.md) e segurança de [transporte http](http-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-193">For more information, see [Transport Security Overview](transport-security-overview.md) and [HTTP Transport Security](http-transport-security.md).</span></span>  
  
 <span data-ttu-id="dbd9f-194">Para provisionar um serviço com credenciais no código, crie uma instância da <xref:System.ServiceModel.ServiceHost> classe e especifique a credencial apropriada usando a <xref:System.ServiceModel.Description.ServiceCredentials> classe, acessada por meio da <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-194">To provision a service with credentials in code, create an instance of the <xref:System.ServiceModel.ServiceHost> class and specify the appropriate credential using the <xref:System.ServiceModel.Description.ServiceCredentials> class, accessed through the <xref:System.ServiceModel.ServiceHostBase.Credentials%2A> property.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="dbd9f-195">Configurando um certificado</span><span class="sxs-lookup"><span data-stu-id="dbd9f-195">Setting a Certificate</span></span>  

 <span data-ttu-id="dbd9f-196">Para provisionar um serviço com um certificado X. 509 a ser usado para autenticar o serviço para clientes, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-196">To provision a service with an X.509 certificate to be used to authenticate the service to clients, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential> class.</span></span>  
  
 <span data-ttu-id="dbd9f-197">Para provisionar um serviço com um certificado de cliente, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-197">To provision a service with a client certificate, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential> class.</span></span>  
  
#### <a name="setting-windows-credentials"></a><span data-ttu-id="dbd9f-198">Configurando credenciais do Windows</span><span class="sxs-lookup"><span data-stu-id="dbd9f-198">Setting Windows Credentials</span></span>  

 <span data-ttu-id="dbd9f-199">Se o cliente especificar um nome de usuário e senha válidos, essa credencial será usada para autenticar o cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-199">If the client specifies a valid user name and password, that credential is used to authenticate the client.</span></span> <span data-ttu-id="dbd9f-200">Caso contrário, as credenciais do usuário conectado no momento serão usadas.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-200">Otherwise, the current logged-on user's credentials are used.</span></span>  
  
### <a name="setting-client-credentials"></a><span data-ttu-id="dbd9f-201">Definindo as credenciais do cliente</span><span class="sxs-lookup"><span data-stu-id="dbd9f-201">Setting Client Credentials</span></span>  

 <span data-ttu-id="dbd9f-202">No WCF, os aplicativos cliente usam um cliente WCF para se conectar aos serviços.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-202">In WCF, client applications use a WCF client to connect to services.</span></span> <span data-ttu-id="dbd9f-203">Cada cliente deriva da <xref:System.ServiceModel.ClientBase%601> classe e a <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade no cliente permite a especificação de vários valores de credenciais do cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-203">Every client derives from the <xref:System.ServiceModel.ClientBase%601> class, and the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property on the client allows the specification of various values of client credentials.</span></span>  
  
#### <a name="setting-a-certificate"></a><span data-ttu-id="dbd9f-204">Configurando um certificado</span><span class="sxs-lookup"><span data-stu-id="dbd9f-204">Setting a Certificate</span></span>  

 <span data-ttu-id="dbd9f-205">Para provisionar um serviço com um certificado X. 509 que é usado para autenticar o cliente para um serviço, use o <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> método da <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential> classe.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-205">To provision a service with an X.509 certificate that is used to authenticate the client to a service, use the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A> method of the <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential> class.</span></span>  
  
## <a name="how-client-credentials-are-used-to-authenticate-a-client-to-the-service"></a><span data-ttu-id="dbd9f-206">Como as credenciais do cliente são usadas para autenticar um cliente para o serviço</span><span class="sxs-lookup"><span data-stu-id="dbd9f-206">How Client Credentials Are Used to Authenticate a Client to the Service</span></span>  

 <span data-ttu-id="dbd9f-207">As informações de credenciais de cliente necessárias para se comunicar com um serviço são fornecidas usando a <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> propriedade ou a <xref:System.ServiceModel.ChannelFactory.Credentials%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-207">Client credential information required to communicate with a service is provided using either the <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A> property or the <xref:System.ServiceModel.ChannelFactory.Credentials%2A> property.</span></span> <span data-ttu-id="dbd9f-208">O canal de segurança usa essas informações para autenticar o cliente para o serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-208">The security channel uses this information to authenticate the client to the service.</span></span> <span data-ttu-id="dbd9f-209">A autenticação é realizada por meio de um dos dois modos:</span><span class="sxs-lookup"><span data-stu-id="dbd9f-209">Authentication is accomplished through one of two modes:</span></span>  
  
- <span data-ttu-id="dbd9f-210">As credenciais do cliente são usadas uma vez antes que a primeira mensagem seja enviada, usando a instância do cliente WCF para estabelecer um contexto de segurança.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-210">The client credentials are used once before the first message is sent, using the WCF client instance to establish a security context.</span></span> <span data-ttu-id="dbd9f-211">Todas as mensagens de aplicativo são então protegidas por meio do contexto de segurança.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-211">All application messages are then secured through the security context.</span></span>  
  
- <span data-ttu-id="dbd9f-212">As credenciais do cliente são usadas para autenticar cada mensagem de aplicativo enviada ao serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-212">The client credentials are used to authenticate every application message sent to the service.</span></span> <span data-ttu-id="dbd9f-213">Nesse caso, nenhum contexto é estabelecido entre o cliente e o serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-213">In this case, no context is established between the client and the service.</span></span>  
  
### <a name="established-identities-cannot-be-changed"></a><span data-ttu-id="dbd9f-214">Não é possível alterar as identidades estabelecidas</span><span class="sxs-lookup"><span data-stu-id="dbd9f-214">Established Identities Cannot Be Changed</span></span>  

 <span data-ttu-id="dbd9f-215">Quando o primeiro método é usado, o contexto estabelecido é permanentemente associado à identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-215">When the first method is used, the established context is permanently associated with the client identity.</span></span> <span data-ttu-id="dbd9f-216">Ou seja, depois que o contexto de segurança tiver sido estabelecido, a identidade associada ao cliente não poderá ser alterada.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-216">That is, once the security context has been established, the identity associated with the client cannot be changed.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="dbd9f-217">Há uma situação em que você deve estar atento quando a identidade não pode ser alternada (ou seja, quando estabelecer o contexto de segurança é on, o comportamento padrão).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-217">There is a situation to be aware of when the identity cannot be switched (that is, when establish security context is on, the default behavior).</span></span> <span data-ttu-id="dbd9f-218">Se você criar um serviço que se comunique com um segundo serviço, a identidade usada para abrir o cliente WCF para o segundo serviço não poderá ser alterada.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-218">If you create a service that communicates with a second service, the identity used to open the WCF client to the second service cannot be changed.</span></span> <span data-ttu-id="dbd9f-219">Isso se tornará um problema se vários clientes tiverem permissão para usar o primeiro serviço e o serviço representar os clientes ao acessar o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-219">This becomes a problem if multiple clients are allowed to use the first service and the service impersonates the clients when accessing the second service.</span></span> <span data-ttu-id="dbd9f-220">Se o serviço reutiliza o mesmo cliente para todos os chamadores, todas as chamadas para o segundo serviço são feitas sob a identidade do primeiro chamador que foi usado para abrir o cliente para o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-220">If the service reuses the same client for all callers, all calls to the second service are done under the identity of the first caller that was used to open the client to the second service.</span></span> <span data-ttu-id="dbd9f-221">Em outras palavras, o serviço usa a identidade do primeiro cliente para que todos os seus clientes se comuniquem com o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-221">In other words, the service uses the identity of the first client for all its clients to communicate with the second service.</span></span> <span data-ttu-id="dbd9f-222">Isso pode levar à elevação de privilégio.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-222">This can lead to the elevation of privilege.</span></span> <span data-ttu-id="dbd9f-223">Se esse não for o comportamento desejado do seu serviço, você deverá acompanhar cada chamador e criar um novo cliente para o segundo serviço para cada chamador distinto e garantir que o serviço use apenas o cliente correto para que o chamador correto se comunique com o segundo serviço.</span><span class="sxs-lookup"><span data-stu-id="dbd9f-223">If this is not the desired behavior of your service, you must track each caller and create a new client to the second service for every distinct caller, and ensure that the service uses only the right client for the right caller to communicate with the second service.</span></span>  
  
 <span data-ttu-id="dbd9f-224">Para obter mais informações sobre credenciais e sessões seguras, consulte [considerações de segurança para sessões seguras](security-considerations-for-secure-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="dbd9f-224">For more information about credentials and secure sessions, see [Security Considerations for Secure Sessions](security-considerations-for-secure-sessions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dbd9f-225">Veja também</span><span class="sxs-lookup"><span data-stu-id="dbd9f-225">See also</span></span>

- <xref:System.ServiceModel.ClientBase%601?displayProperty=nameWithType>
- <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Description.ClientCredentials.ClientCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.BasicHttpMessageSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.HttpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverHttp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverMsmq.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.MessageSecurityOverTcp.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.TcpTransportSecurity.ClientCredentialType%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A?displayProperty=nameWithType>
- <xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A?displayProperty=nameWithType>
- [<span data-ttu-id="dbd9f-226">Conceitos de segurança</span><span class="sxs-lookup"><span data-stu-id="dbd9f-226">Security Concepts</span></span>](security-concepts.md)
- [<span data-ttu-id="dbd9f-227">Protegendo serviços e clientes</span><span class="sxs-lookup"><span data-stu-id="dbd9f-227">Securing Services and Clients</span></span>](securing-services-and-clients.md)
- [<span data-ttu-id="dbd9f-228">Programação de segurança do WCF</span><span class="sxs-lookup"><span data-stu-id="dbd9f-228">Programming WCF Security</span></span>](programming-wcf-security.md)
- [<span data-ttu-id="dbd9f-229">Segurança de transporte de HTTP</span><span class="sxs-lookup"><span data-stu-id="dbd9f-229">HTTP Transport Security</span></span>](http-transport-security.md)
