---
title: Utilizando Personificação com segurança de transporte
ms.date: 03/30/2017
ms.assetid: 426df8cb-6337-4262-b2c0-b96c2edf21a9
ms.openlocfilehash: 6209007b60effe5403caf3db8855f029d0c47a0e
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59151431"
---
# <a name="using-impersonation-with-transport-security"></a><span data-ttu-id="14dcf-102">Utilizando Personificação com segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="14dcf-102">Using Impersonation with Transport Security</span></span>
<span data-ttu-id="14dcf-103">*Representação* é a capacidade de um aplicativo de servidor para assumir a identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-103">*Impersonation* is the ability of a server application to take on the identity of the client.</span></span> <span data-ttu-id="14dcf-104">É comum para os serviços usam a representação ao validar o acesso aos recursos.</span><span class="sxs-lookup"><span data-stu-id="14dcf-104">It is common for services to use impersonation when validating access to resources.</span></span> <span data-ttu-id="14dcf-105">O aplicativo de servidor é executado usando uma conta de serviço, mas quando o servidor aceita uma conexão de cliente, ele representa o cliente para que as verificações de acesso são executadas usando as credenciais do cliente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-105">The server application runs using a service account, but when the server accepts a client connection, it impersonates the client so that access checks are performed using the client's credentials.</span></span> <span data-ttu-id="14dcf-106">Segurança de transporte é um mecanismo para passar as credenciais e proteger a comunicação usando essas credenciais.</span><span class="sxs-lookup"><span data-stu-id="14dcf-106">Transport security is a mechanism both for passing credentials and securing communication using those credentials.</span></span> <span data-ttu-id="14dcf-107">Este tópico descreve como usar a segurança de transporte no Windows Communication Foundation (WCF) com o recurso de representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-107">This topic describes using transport security in Windows Communication Foundation (WCF) with the impersonation feature.</span></span> <span data-ttu-id="14dcf-108">Para obter mais informações sobre representação usando a segurança de mensagem, consulte [delegação e representação](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="14dcf-108">For more information about impersonation using message security, see [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="five-impersonation-levels"></a><span data-ttu-id="14dcf-109">Cinco níveis de representação</span><span class="sxs-lookup"><span data-stu-id="14dcf-109">Five Impersonation Levels</span></span>  
 <span data-ttu-id="14dcf-110">Segurança de transporte faz uso de cinco níveis de representação, conforme descrito na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="14dcf-110">Transport security makes use of five levels of impersonation, as described in the following table.</span></span>  
  
|<span data-ttu-id="14dcf-111">Nível de representação</span><span class="sxs-lookup"><span data-stu-id="14dcf-111">Impersonation level</span></span>|<span data-ttu-id="14dcf-112">Descrição</span><span class="sxs-lookup"><span data-stu-id="14dcf-112">Description</span></span>|  
|-------------------------|-----------------|  
|<span data-ttu-id="14dcf-113">Nenhum</span><span class="sxs-lookup"><span data-stu-id="14dcf-113">None</span></span>|<span data-ttu-id="14dcf-114">O aplicativo de servidor não tenta representar o cliente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-114">The server application does not attempt to impersonate the client.</span></span>|  
|<span data-ttu-id="14dcf-115">Anônimo</span><span class="sxs-lookup"><span data-stu-id="14dcf-115">Anonymous</span></span>|<span data-ttu-id="14dcf-116">O aplicativo de servidor pode executar verificações de acesso em relação às credenciais do cliente, mas não recebeu nenhuma informação sobre a identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-116">The server application can perform access checks against the client's credentials, but does not receive any information about the client's identity.</span></span> <span data-ttu-id="14dcf-117">Esse nível de representação é significativo apenas para comunicação na máquina, como pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="14dcf-117">This impersonation level is meaningful only for on-machine communication, such as named pipes.</span></span> <span data-ttu-id="14dcf-118">Usando `Anonymous` com uma conexão remota promove o nível de representação como identificar.</span><span class="sxs-lookup"><span data-stu-id="14dcf-118">Using `Anonymous` with a remote connection promotes the impersonation level to Identify.</span></span>|  
|<span data-ttu-id="14dcf-119">Identificar</span><span class="sxs-lookup"><span data-stu-id="14dcf-119">Identify</span></span>|<span data-ttu-id="14dcf-120">O aplicativo de servidor sabe a identidade do cliente e pode executar a validação de acesso em relação às credenciais do cliente, mas não pode representar o cliente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-120">The server application knows the client's identity and can perform access validation against the client's credentials, but cannot impersonate the client.</span></span> <span data-ttu-id="14dcf-121">Identificar é o nível de representação padrão usado com as credenciais SSPI no WCF, a menos que o provedor de token fornece um nível de representação diferente.</span><span class="sxs-lookup"><span data-stu-id="14dcf-121">Identify is the default impersonation level used with SSPI credentials in WCF unless the token provider provides a different impersonation level.</span></span>|  
|<span data-ttu-id="14dcf-122">Impersonate</span><span class="sxs-lookup"><span data-stu-id="14dcf-122">Impersonate</span></span>|<span data-ttu-id="14dcf-123">O aplicativo de servidor pode acessar recursos na máquina do servidor como o cliente, além de realizar verificações de acesso.</span><span class="sxs-lookup"><span data-stu-id="14dcf-123">The server application can access resources on the server machine as the client in addition to performing access checks.</span></span> <span data-ttu-id="14dcf-124">O aplicativo de servidor não pode acessar recursos em computadores remotos usando a identidade do cliente porque o token de representação não tem credenciais de rede</span><span class="sxs-lookup"><span data-stu-id="14dcf-124">The server application cannot access resources on remote machines using the client's identity because the impersonated token does not have network credentials</span></span>|  
|<span data-ttu-id="14dcf-125">delegado</span><span class="sxs-lookup"><span data-stu-id="14dcf-125">Delegate</span></span>|<span data-ttu-id="14dcf-126">Além de ter os mesmos recursos que `Impersonate`, o nível de representação de delegado também permite que o aplicativo de servidor para acessar os recursos em computadores remotos usando a identidade do cliente e para passar a identidade para outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="14dcf-126">In addition to having the same capabilities as `Impersonate`, the Delegate impersonation level also enables the server application to access resources on remote machines using the client's identity and to pass the identity to other applications.</span></span><br /><br /> <span data-ttu-id="14dcf-127">**Importante** a conta de domínio do servidor deve ser marcada como confiáveis para delegação no controlador de domínio para usar esses recursos adicionais.</span><span class="sxs-lookup"><span data-stu-id="14dcf-127">**Important** The server domain account must be marked as trusted for delegation on the domain controller to use these additional features.</span></span> <span data-ttu-id="14dcf-128">Esse nível de representação não pode ser usado com contas de domínio do cliente marcadas como confidenciais.</span><span class="sxs-lookup"><span data-stu-id="14dcf-128">This level of impersonation cannot be used with client domain accounts marked as sensitive.</span></span>|  
  
 <span data-ttu-id="14dcf-129">Os níveis mais comumente usados com segurança de transporte estão `Identify` e `Impersonate`.</span><span class="sxs-lookup"><span data-stu-id="14dcf-129">The levels most commonly used with transport security are `Identify` and `Impersonate`.</span></span> <span data-ttu-id="14dcf-130">Os níveis `None` e `Anonymous` não são recomendados para uso normal, e vários transportes não permitem o uso desses níveis com a autenticação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-130">The levels `None` and `Anonymous` are not recommended for typical use, and many transports do not support using those levels with authentication.</span></span> <span data-ttu-id="14dcf-131">O `Delegate` nível é um recurso avançado que deve ser usado com cuidado.</span><span class="sxs-lookup"><span data-stu-id="14dcf-131">The `Delegate` level is a powerful feature that should be used with care.</span></span> <span data-ttu-id="14dcf-132">Somente aplicativos de servidores confiáveis deverá receber a permissão para delegar credenciais.</span><span class="sxs-lookup"><span data-stu-id="14dcf-132">Only trusted server applications should be given the permission to delegate credentials.</span></span>  
  
 <span data-ttu-id="14dcf-133">Usando a representação na `Impersonate` ou `Delegate` níveis requer que o aplicativo de servidor ter o `SeImpersonatePrivilege` privilégio.</span><span class="sxs-lookup"><span data-stu-id="14dcf-133">Using impersonation at the `Impersonate` or `Delegate` levels requires the server application to have the `SeImpersonatePrivilege` privilege.</span></span> <span data-ttu-id="14dcf-134">Um aplicativo tem esse privilégio por padrão, se ele estiver em execução em uma conta no grupo de administradores ou em uma conta com um SID de serviço (serviço de rede, serviço Local ou sistema Local).</span><span class="sxs-lookup"><span data-stu-id="14dcf-134">An application has this privilege by default if it is running on an account in the Administrators group or on an account with a Service SID (Network Service, Local Service, or Local System).</span></span> <span data-ttu-id="14dcf-135">Representação não exige a autenticação mútua do cliente e servidor.</span><span class="sxs-lookup"><span data-stu-id="14dcf-135">Impersonation does not require mutual authentication of the client and server.</span></span> <span data-ttu-id="14dcf-136">Alguns esquemas de autenticação que dão suporte a representação, como o NTLM, não podem ser usadas com a autenticação mútua.</span><span class="sxs-lookup"><span data-stu-id="14dcf-136">Some authentication schemes that support impersonation, such as NTLM, cannot be used with mutual authentication.</span></span>  
  
## <a name="transport-specific-issues-with-impersonation"></a><span data-ttu-id="14dcf-137">Problemas de transporte específicos com a representação</span><span class="sxs-lookup"><span data-stu-id="14dcf-137">Transport-Specific Issues with Impersonation</span></span>  
 <span data-ttu-id="14dcf-138">A escolha de um transporte no WCF afeta as opções possíveis para a representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-138">The choice of a transport in WCF affects the possible choices for impersonation.</span></span> <span data-ttu-id="14dcf-139">Esta seção descreve problemas que afetam o HTTP padrão e nomeado transportes de pipe no WCF.</span><span class="sxs-lookup"><span data-stu-id="14dcf-139">This section describes issues affecting the standard HTTP and named pipe transports in WCF.</span></span> <span data-ttu-id="14dcf-140">Transportes personalizados têm suas próprias restrições sobre o suporte para a representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-140">Custom transports have their own restrictions on support for impersonation.</span></span>  
  
### <a name="named-pipe-transport"></a><span data-ttu-id="14dcf-141">Chamada de transporte de Pipe</span><span class="sxs-lookup"><span data-stu-id="14dcf-141">Named Pipe Transport</span></span>  
 <span data-ttu-id="14dcf-142">Os itens a seguir são usados com o transporte de pipe nomeado:</span><span class="sxs-lookup"><span data-stu-id="14dcf-142">The following items are used with the named pipe transport:</span></span>  
  
-   <span data-ttu-id="14dcf-143">O transporte de pipe nomeado é destinado a uso somente no computador local.</span><span class="sxs-lookup"><span data-stu-id="14dcf-143">The named pipe transport is intended for use only on the local machine.</span></span> <span data-ttu-id="14dcf-144">O transporte de pipe nomeado no WCF explicitamente não permite conexões entre computadores.</span><span class="sxs-lookup"><span data-stu-id="14dcf-144">The named pipe transport in WCF explicitly disallows cross-machine connections.</span></span>  
  
-   <span data-ttu-id="14dcf-145">Pipes nomeados não podem ser usados com o `Impersonate` ou `Delegate` nível de representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-145">Named pipes cannot be used with the `Impersonate` or `Delegate` impersonation level.</span></span> <span data-ttu-id="14dcf-146">O pipe nomeado não pode impor a garantia na máquina nesses níveis de representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-146">The named pipe cannot enforce the on-machine guarantee at these impersonation levels.</span></span>  
  
 <span data-ttu-id="14dcf-147">Para obter mais informações sobre pipes nomeados, consulte [escolhendo um transporte](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="14dcf-147">For more information about named pipes, see [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
### <a name="http-transport"></a><span data-ttu-id="14dcf-148">Transporte de HTTP</span><span class="sxs-lookup"><span data-stu-id="14dcf-148">HTTP Transport</span></span>  
 <span data-ttu-id="14dcf-149">As associações que usam o transporte HTTP (<xref:System.ServiceModel.WSHttpBinding> e <xref:System.ServiceModel.BasicHttpBinding>) dão suporte a vários esquemas de autenticação, conforme explicado nas [Noções básicas sobre a autenticação HTTP](../../../../docs/framework/wcf/feature-details/understanding-http-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="14dcf-149">The bindings that use the HTTP transport (<xref:System.ServiceModel.WSHttpBinding> and <xref:System.ServiceModel.BasicHttpBinding>) support several authentication schemes, as explained in [Understanding HTTP Authentication](../../../../docs/framework/wcf/feature-details/understanding-http-authentication.md).</span></span> <span data-ttu-id="14dcf-150">A suporte de nível de representação depende do esquema de autenticação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-150">The impersonation level supported depends on the authentication scheme.</span></span> <span data-ttu-id="14dcf-151">Os itens a seguir são usados com o transporte HTTP:</span><span class="sxs-lookup"><span data-stu-id="14dcf-151">The following items are used with the HTTP transport:</span></span>  
  
-   <span data-ttu-id="14dcf-152">O `Anonymous` ignora de esquema de autenticação de representação.</span><span class="sxs-lookup"><span data-stu-id="14dcf-152">The `Anonymous` authentication scheme ignores impersonation.</span></span>  
  
-   <span data-ttu-id="14dcf-153">O `Basic` esquema de autenticação dá suporte apenas a `Delegate` nível.</span><span class="sxs-lookup"><span data-stu-id="14dcf-153">The `Basic` authentication scheme supports only the `Delegate` level.</span></span> <span data-ttu-id="14dcf-154">Todos os níveis inferiores de representação são atualizados.</span><span class="sxs-lookup"><span data-stu-id="14dcf-154">All lower impersonation levels are upgraded.</span></span>  
  
-   <span data-ttu-id="14dcf-155">O `Digest` esquema de autenticação dá suporte apenas a `Impersonate` e `Delegate` níveis.</span><span class="sxs-lookup"><span data-stu-id="14dcf-155">The `Digest` authentication scheme supports only the `Impersonate` and `Delegate` levels.</span></span>  
  
-   <span data-ttu-id="14dcf-156">O `NTLM` esquema de autenticação, selecionável diretamente ou através de negociação, dá suporte apenas a `Delegate` nível no computador local.</span><span class="sxs-lookup"><span data-stu-id="14dcf-156">The `NTLM` authentication scheme, selectable either directly or through negotiation, supports only the `Delegate` level on the local machine.</span></span>  
  
-   <span data-ttu-id="14dcf-157">O esquema de autenticação Kerberos, que só pode ser selecionado por meio de negociação, pode ser usado com qualquer nível de representação com suporte.</span><span class="sxs-lookup"><span data-stu-id="14dcf-157">The Kerberos authentication scheme, which can only be selected through negotiation, can be used with any supported impersonation level.</span></span>  
  
 <span data-ttu-id="14dcf-158">Para obter mais informações sobre o transporte HTTP, consulte [escolhendo um transporte](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="14dcf-158">For more information about the HTTP transport, see [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="14dcf-159">Consulte também</span><span class="sxs-lookup"><span data-stu-id="14dcf-159">See also</span></span>

- [<span data-ttu-id="14dcf-160">Delegação e representação</span><span class="sxs-lookup"><span data-stu-id="14dcf-160">Delegation and Impersonation</span></span>](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md)
- [<span data-ttu-id="14dcf-161">Autorização</span><span class="sxs-lookup"><span data-stu-id="14dcf-161">Authorization</span></span>](../../../../docs/framework/wcf/feature-details/authorization-in-wcf.md)
- [<span data-ttu-id="14dcf-162">Como: Representar um cliente em um serviço</span><span class="sxs-lookup"><span data-stu-id="14dcf-162">How to: Impersonate a Client on a Service</span></span>](../../../../docs/framework/wcf/how-to-impersonate-a-client-on-a-service.md)
- [<span data-ttu-id="14dcf-163">Entendendo a autenticação HTTP</span><span class="sxs-lookup"><span data-stu-id="14dcf-163">Understanding HTTP Authentication</span></span>](../../../../docs/framework/wcf/feature-details/understanding-http-authentication.md)
