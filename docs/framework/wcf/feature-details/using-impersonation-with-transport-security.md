---
title: Utilizando Personificação com segurança de transporte
ms.date: 03/30/2017
ms.assetid: 426df8cb-6337-4262-b2c0-b96c2edf21a9
ms.openlocfilehash: 14914bc65d5033c54640e06b79713ea1871daf18
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96289497"
---
# <a name="using-impersonation-with-transport-security"></a><span data-ttu-id="142e2-102">Utilizando Personificação com segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="142e2-102">Using Impersonation with Transport Security</span></span>

<span data-ttu-id="142e2-103">*Representação* é a capacidade de um aplicativo de servidor assumir a identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="142e2-103">*Impersonation* is the ability of a server application to take on the identity of the client.</span></span> <span data-ttu-id="142e2-104">É comum que os serviços usem a representação ao validar o acesso aos recursos.</span><span class="sxs-lookup"><span data-stu-id="142e2-104">It is common for services to use impersonation when validating access to resources.</span></span> <span data-ttu-id="142e2-105">O aplicativo de servidor é executado usando uma conta de serviço, mas quando o servidor aceita uma conexão de cliente, ele representa o cliente para que as verificações de acesso sejam executadas usando as credenciais do cliente.</span><span class="sxs-lookup"><span data-stu-id="142e2-105">The server application runs using a service account, but when the server accepts a client connection, it impersonates the client so that access checks are performed using the client's credentials.</span></span> <span data-ttu-id="142e2-106">A segurança de transporte é um mecanismo para transmitir credenciais e proteger a comunicação usando essas credenciais.</span><span class="sxs-lookup"><span data-stu-id="142e2-106">Transport security is a mechanism both for passing credentials and securing communication using those credentials.</span></span> <span data-ttu-id="142e2-107">Este tópico descreve como usar a segurança de transporte no Windows Communication Foundation (WCF) com o recurso de representação.</span><span class="sxs-lookup"><span data-stu-id="142e2-107">This topic describes using transport security in Windows Communication Foundation (WCF) with the impersonation feature.</span></span> <span data-ttu-id="142e2-108">Para obter mais informações sobre a representação usando a segurança da mensagem, consulte [delegação e representação](delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="142e2-108">For more information about impersonation using message security, see [Delegation and Impersonation](delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="five-impersonation-levels"></a><span data-ttu-id="142e2-109">Cinco níveis de representação</span><span class="sxs-lookup"><span data-stu-id="142e2-109">Five Impersonation Levels</span></span>  

 <span data-ttu-id="142e2-110">A segurança de transporte usa cinco níveis de representação, conforme descrito na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="142e2-110">Transport security makes use of five levels of impersonation, as described in the following table.</span></span>  
  
|<span data-ttu-id="142e2-111">Nível de representação</span><span class="sxs-lookup"><span data-stu-id="142e2-111">Impersonation level</span></span>|<span data-ttu-id="142e2-112">Descrição</span><span class="sxs-lookup"><span data-stu-id="142e2-112">Description</span></span>|  
|-------------------------|-----------------|  
|<span data-ttu-id="142e2-113">Nenhum</span><span class="sxs-lookup"><span data-stu-id="142e2-113">None</span></span>|<span data-ttu-id="142e2-114">O aplicativo de servidor não tenta representar o cliente.</span><span class="sxs-lookup"><span data-stu-id="142e2-114">The server application does not attempt to impersonate the client.</span></span>|  
|<span data-ttu-id="142e2-115">Anônima</span><span class="sxs-lookup"><span data-stu-id="142e2-115">Anonymous</span></span>|<span data-ttu-id="142e2-116">O aplicativo de servidor pode executar verificações de acesso nas credenciais do cliente, mas não recebe nenhuma informação sobre a identidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="142e2-116">The server application can perform access checks against the client's credentials, but does not receive any information about the client's identity.</span></span> <span data-ttu-id="142e2-117">Esse nível de representação é significativo apenas para comunicação no computador, como pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="142e2-117">This impersonation level is meaningful only for on-machine communication, such as named pipes.</span></span> <span data-ttu-id="142e2-118">O uso de `Anonymous` com uma conexão remota promove o nível de representação para identificar.</span><span class="sxs-lookup"><span data-stu-id="142e2-118">Using `Anonymous` with a remote connection promotes the impersonation level to Identify.</span></span>|  
|<span data-ttu-id="142e2-119">Identificar</span><span class="sxs-lookup"><span data-stu-id="142e2-119">Identify</span></span>|<span data-ttu-id="142e2-120">O aplicativo de servidor conhece a identidade do cliente e pode executar a validação de acesso em relação às credenciais do cliente, mas não pode representar o cliente.</span><span class="sxs-lookup"><span data-stu-id="142e2-120">The server application knows the client's identity and can perform access validation against the client's credentials, but cannot impersonate the client.</span></span> <span data-ttu-id="142e2-121">Identificar é o nível de representação padrão usado com credenciais SSPI no WCF, a menos que o provedor de token forneça um nível de representação diferente.</span><span class="sxs-lookup"><span data-stu-id="142e2-121">Identify is the default impersonation level used with SSPI credentials in WCF unless the token provider provides a different impersonation level.</span></span>|  
|<span data-ttu-id="142e2-122">Impersonate</span><span class="sxs-lookup"><span data-stu-id="142e2-122">Impersonate</span></span>|<span data-ttu-id="142e2-123">O aplicativo de servidor pode acessar recursos no computador do servidor como o cliente, além de executar verificações de acesso.</span><span class="sxs-lookup"><span data-stu-id="142e2-123">The server application can access resources on the server machine as the client in addition to performing access checks.</span></span> <span data-ttu-id="142e2-124">O aplicativo de servidor não pode acessar recursos em computadores remotos usando a identidade do cliente porque o token representado não tem credenciais de rede</span><span class="sxs-lookup"><span data-stu-id="142e2-124">The server application cannot access resources on remote machines using the client's identity because the impersonated token does not have network credentials</span></span>|  
|<span data-ttu-id="142e2-125">Delegar</span><span class="sxs-lookup"><span data-stu-id="142e2-125">Delegate</span></span>|<span data-ttu-id="142e2-126">Além de ter os mesmos recursos que `Impersonate` o, o nível de representação de delegado também permite que o aplicativo de servidor acesse recursos em computadores remotos usando a identidade do cliente e passe a identidade para outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="142e2-126">In addition to having the same capabilities as `Impersonate`, the Delegate impersonation level also enables the server application to access resources on remote machines using the client's identity and to pass the identity to other applications.</span></span><br /><br /> <span data-ttu-id="142e2-127">**Importante** A conta de domínio do servidor deve ser marcada como confiável para delegação no controlador de domínio para usar esses recursos adicionais.</span><span class="sxs-lookup"><span data-stu-id="142e2-127">**Important** The server domain account must be marked as trusted for delegation on the domain controller to use these additional features.</span></span> <span data-ttu-id="142e2-128">Esse nível de representação não pode ser usado com contas de domínio de cliente marcadas como confidenciais.</span><span class="sxs-lookup"><span data-stu-id="142e2-128">This level of impersonation cannot be used with client domain accounts marked as sensitive.</span></span>|  
  
 <span data-ttu-id="142e2-129">Os níveis mais comumente usados com segurança de transporte são `Identify` e `Impersonate` .</span><span class="sxs-lookup"><span data-stu-id="142e2-129">The levels most commonly used with transport security are `Identify` and `Impersonate`.</span></span> <span data-ttu-id="142e2-130">Os níveis `None` e `Anonymous` não são recomendados para uso típico, e muitos transportes não dão suporte ao uso desses níveis com autenticação.</span><span class="sxs-lookup"><span data-stu-id="142e2-130">The levels `None` and `Anonymous` are not recommended for typical use, and many transports do not support using those levels with authentication.</span></span> <span data-ttu-id="142e2-131">O `Delegate` nível é um recurso poderoso que deve ser usado com cuidado.</span><span class="sxs-lookup"><span data-stu-id="142e2-131">The `Delegate` level is a powerful feature that should be used with care.</span></span> <span data-ttu-id="142e2-132">Somente aplicativos de servidor confiáveis devem receber a permissão para delegar credenciais.</span><span class="sxs-lookup"><span data-stu-id="142e2-132">Only trusted server applications should be given the permission to delegate credentials.</span></span>  
  
 <span data-ttu-id="142e2-133">Usar a representação nos `Impersonate` `Delegate` níveis ou exige que o aplicativo de servidor tenha o `SeImpersonatePrivilege` privilégio.</span><span class="sxs-lookup"><span data-stu-id="142e2-133">Using impersonation at the `Impersonate` or `Delegate` levels requires the server application to have the `SeImpersonatePrivilege` privilege.</span></span> <span data-ttu-id="142e2-134">Por padrão, um aplicativo tem esse privilégio se estiver sendo executado em uma conta no grupo Administradores ou em uma conta com um SID de serviço (serviço de rede, serviço local ou sistema local).</span><span class="sxs-lookup"><span data-stu-id="142e2-134">An application has this privilege by default if it is running on an account in the Administrators group or on an account with a Service SID (Network Service, Local Service, or Local System).</span></span> <span data-ttu-id="142e2-135">A representação não requer autenticação mútua do cliente e do servidor.</span><span class="sxs-lookup"><span data-stu-id="142e2-135">Impersonation does not require mutual authentication of the client and server.</span></span> <span data-ttu-id="142e2-136">Alguns esquemas de autenticação que dão suporte à representação, como NTLM, não podem ser usados com autenticação mútua.</span><span class="sxs-lookup"><span data-stu-id="142e2-136">Some authentication schemes that support impersonation, such as NTLM, cannot be used with mutual authentication.</span></span>  
  
## <a name="transport-specific-issues-with-impersonation"></a><span data-ttu-id="142e2-137">Problemas de Transport-Specific com representação</span><span class="sxs-lookup"><span data-stu-id="142e2-137">Transport-Specific Issues with Impersonation</span></span>  

 <span data-ttu-id="142e2-138">A escolha de um transporte no WCF afeta as possíveis opções de representação.</span><span class="sxs-lookup"><span data-stu-id="142e2-138">The choice of a transport in WCF affects the possible choices for impersonation.</span></span> <span data-ttu-id="142e2-139">Esta seção descreve os problemas que afetam os transportes padrão HTTP e pipe nomeado no WCF.</span><span class="sxs-lookup"><span data-stu-id="142e2-139">This section describes issues affecting the standard HTTP and named pipe transports in WCF.</span></span> <span data-ttu-id="142e2-140">Os transportes personalizados têm suas próprias restrições quanto ao suporte para representação.</span><span class="sxs-lookup"><span data-stu-id="142e2-140">Custom transports have their own restrictions on support for impersonation.</span></span>  
  
### <a name="named-pipe-transport"></a><span data-ttu-id="142e2-141">Transporte de pipe nomeado</span><span class="sxs-lookup"><span data-stu-id="142e2-141">Named Pipe Transport</span></span>  

 <span data-ttu-id="142e2-142">Os seguintes itens são usados com o transporte de pipe nomeado:</span><span class="sxs-lookup"><span data-stu-id="142e2-142">The following items are used with the named pipe transport:</span></span>  
  
- <span data-ttu-id="142e2-143">O transporte de pipe nomeado destina-se somente ao uso no computador local.</span><span class="sxs-lookup"><span data-stu-id="142e2-143">The named pipe transport is intended for use only on the local machine.</span></span> <span data-ttu-id="142e2-144">O transporte de pipe nomeado no WCF explicitamente não permite conexões entre computadores.</span><span class="sxs-lookup"><span data-stu-id="142e2-144">The named pipe transport in WCF explicitly disallows cross-machine connections.</span></span>  
  
- <span data-ttu-id="142e2-145">Pipes nomeados não podem ser usados com o `Impersonate` `Delegate` nível de representação ou.</span><span class="sxs-lookup"><span data-stu-id="142e2-145">Named pipes cannot be used with the `Impersonate` or `Delegate` impersonation level.</span></span> <span data-ttu-id="142e2-146">O pipe nomeado não pode impor a garantia no computador nesses níveis de representação.</span><span class="sxs-lookup"><span data-stu-id="142e2-146">The named pipe cannot enforce the on-machine guarantee at these impersonation levels.</span></span>  
  
 <span data-ttu-id="142e2-147">Para obter mais informações sobre pipes nomeados, consulte [escolhendo um transporte](choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="142e2-147">For more information about named pipes, see [Choosing a Transport](choosing-a-transport.md).</span></span>  
  
### <a name="http-transport"></a><span data-ttu-id="142e2-148">Transporte HTTP</span><span class="sxs-lookup"><span data-stu-id="142e2-148">HTTP Transport</span></span>  

 <span data-ttu-id="142e2-149">As associações que usam o transporte HTTP ( <xref:System.ServiceModel.WSHttpBinding> e <xref:System.ServiceModel.BasicHttpBinding> ) dão suporte a vários esquemas de autenticação, conforme explicado em [noções básicas sobre a autenticação http](understanding-http-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="142e2-149">The bindings that use the HTTP transport (<xref:System.ServiceModel.WSHttpBinding> and <xref:System.ServiceModel.BasicHttpBinding>) support several authentication schemes, as explained in [Understanding HTTP Authentication](understanding-http-authentication.md).</span></span> <span data-ttu-id="142e2-150">O nível de representação com suporte depende do esquema de autenticação.</span><span class="sxs-lookup"><span data-stu-id="142e2-150">The impersonation level supported depends on the authentication scheme.</span></span> <span data-ttu-id="142e2-151">Os seguintes itens são usados com o transporte HTTP:</span><span class="sxs-lookup"><span data-stu-id="142e2-151">The following items are used with the HTTP transport:</span></span>  
  
- <span data-ttu-id="142e2-152">O `Anonymous` esquema de autenticação ignora a representação.</span><span class="sxs-lookup"><span data-stu-id="142e2-152">The `Anonymous` authentication scheme ignores impersonation.</span></span>  
  
- <span data-ttu-id="142e2-153">O `Basic` esquema de autenticação dá suporte apenas ao `Delegate` nível.</span><span class="sxs-lookup"><span data-stu-id="142e2-153">The `Basic` authentication scheme supports only the `Delegate` level.</span></span> <span data-ttu-id="142e2-154">Todos os níveis de representação inferiores são atualizados.</span><span class="sxs-lookup"><span data-stu-id="142e2-154">All lower impersonation levels are upgraded.</span></span>  
  
- <span data-ttu-id="142e2-155">O `Digest` esquema de autenticação dá suporte apenas aos `Impersonate` `Delegate` níveis e.</span><span class="sxs-lookup"><span data-stu-id="142e2-155">The `Digest` authentication scheme supports only the `Impersonate` and `Delegate` levels.</span></span>  
  
- <span data-ttu-id="142e2-156">O `NTLM` esquema de autenticação, selecionável diretamente ou por meio da negociação, dá suporte apenas ao `Delegate` nível no computador local.</span><span class="sxs-lookup"><span data-stu-id="142e2-156">The `NTLM` authentication scheme, selectable either directly or through negotiation, supports only the `Delegate` level on the local machine.</span></span>  
  
- <span data-ttu-id="142e2-157">O esquema de autenticação Kerberos, que só pode ser selecionado por meio de negociação, pode ser usado com qualquer nível de representação com suporte.</span><span class="sxs-lookup"><span data-stu-id="142e2-157">The Kerberos authentication scheme, which can only be selected through negotiation, can be used with any supported impersonation level.</span></span>  
  
 <span data-ttu-id="142e2-158">Para obter mais informações sobre o transporte HTTP, consulte [escolhendo um transporte](choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="142e2-158">For more information about the HTTP transport, see [Choosing a Transport](choosing-a-transport.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="142e2-159">Veja também</span><span class="sxs-lookup"><span data-stu-id="142e2-159">See also</span></span>

- [<span data-ttu-id="142e2-160">Delegação e representação</span><span class="sxs-lookup"><span data-stu-id="142e2-160">Delegation and Impersonation</span></span>](delegation-and-impersonation-with-wcf.md)
- [<span data-ttu-id="142e2-161">Autorização</span><span class="sxs-lookup"><span data-stu-id="142e2-161">Authorization</span></span>](authorization-in-wcf.md)
- [<span data-ttu-id="142e2-162">Como: representar um cliente em um serviço</span><span class="sxs-lookup"><span data-stu-id="142e2-162">How to: Impersonate a Client on a Service</span></span>](../how-to-impersonate-a-client-on-a-service.md)
- [<span data-ttu-id="142e2-163">Noções básicas de autenticação HTTP</span><span class="sxs-lookup"><span data-stu-id="142e2-163">Understanding HTTP Authentication</span></span>](understanding-http-authentication.md)
