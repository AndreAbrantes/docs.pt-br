---
title: Serviços unidirecionais
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Communication Foundation [WCF], one-way service contracts
- WCF [WCF], one-way service contracts
- service contracts [WCF], defining one-way
ms.assetid: 19053a36-4492-45a3-bfe6-0365ee0205a3
ms.openlocfilehash: 03efc27f2ba54ca22f03e3ece84770fe0dcadbb3
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33494368"
---
# <a name="one-way-services"></a><span data-ttu-id="c0ffb-102">Serviços unidirecionais</span><span class="sxs-lookup"><span data-stu-id="c0ffb-102">One-Way Services</span></span>
<span data-ttu-id="c0ffb-103">O comportamento padrão de uma operação de serviço é o padrão de solicitação-resposta.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-103">The default behavior of a service operation is the request-reply pattern.</span></span> <span data-ttu-id="c0ffb-104">Em um padrão de solicitação-resposta, o cliente aguarda a mensagem de resposta, mesmo se a operação de serviço é representada no código como um `void` método.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-104">In a request-reply pattern, the client waits for the reply message, even if the service operation is represented in code as a `void` method.</span></span> <span data-ttu-id="c0ffb-105">Com uma operação unidirecional, somente uma mensagem é transmitida.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-105">With a one-way operation, only one message is transmitted.</span></span> <span data-ttu-id="c0ffb-106">O receptor não envia uma mensagem de resposta, nem o remetente esperado um.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-106">The receiver does not send a reply message, nor does the sender expect one.</span></span>  
  
 <span data-ttu-id="c0ffb-107">Use o padrão de design unidirecional:</span><span class="sxs-lookup"><span data-stu-id="c0ffb-107">Use the one-way design pattern:</span></span>  
  
-   <span data-ttu-id="c0ffb-108">Quando o cliente deve chamar as operações e não é afetado pelo resultado da operação no nível da operação.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-108">When the client must call operations and is not affected by the result of the operation at the operation level.</span></span>  
  
-   <span data-ttu-id="c0ffb-109">Ao usar o <xref:System.ServiceModel.NetMsmqBinding> ou <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> classe.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-109">When using the <xref:System.ServiceModel.NetMsmqBinding> or the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> class.</span></span> <span data-ttu-id="c0ffb-110">(Para obter mais informações sobre esse cenário, consulte [filas no WCF](../../../../docs/framework/wcf/feature-details/queues-in-wcf.md).)</span><span class="sxs-lookup"><span data-stu-id="c0ffb-110">(For more information about this scenario, see [Queues in WCF](../../../../docs/framework/wcf/feature-details/queues-in-wcf.md).)</span></span>  
  
 <span data-ttu-id="c0ffb-111">Quando uma operação é unidirecional, não há nenhuma mensagem de resposta para transmitir informações de erro para o cliente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-111">When an operation is one-way, there is no response message to carry error information back to the client.</span></span> <span data-ttu-id="c0ffb-112">Você pode detectar condições de erro usando recursos de associação subjacente, como sessões confiáveis, ou criando um contrato de serviço duplex que usa duas operações unidirecionais — um contrato unidirecional do cliente para o serviço para chamar a operação de serviço e outro unidirecional entre o cliente e o serviço de contrato de forma que o serviço pode enviar falhas de backup para o cliente usando um retorno de chamada que implementa o cliente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-112">You can detect error conditions by using features of the underlying binding, such as reliable sessions, or by designing a duplex service contract that uses two one-way operations—a one-way contract from the client to the service to call service operation and another one-way contract between the service and the client so that the service can send back faults to the client using a callback that the client implements.</span></span>  
  
 <span data-ttu-id="c0ffb-113">Para criar um contrato de serviço unidirecional, definir o contrato de serviço, aplicar o <xref:System.ServiceModel.OperationContractAttribute> de classe para cada operação e defina o <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> propriedade `true`, conforme mostrado no código de exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-113">To create a one-way service contract, define your service contract, apply the <xref:System.ServiceModel.OperationContractAttribute> class to each operation, and set the <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> property to `true`, as shown in the following sample code.</span></span>  
  
```  
[ServiceContract(Namespace="http://Microsoft.ServiceModel.Samples")]  
public interface IOneWayCalculator  
{  
    [OperationContract(IsOneWay=true)]  
    void Add(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Subtract(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Multiply(double n1, double n2);  
    [OperationContract(IsOneWay = true)]  
    void Divide(double n1, double n2);  
}  
```  
  
 <span data-ttu-id="c0ffb-114">Para obter um exemplo completo, consulte o [unidirecional](../../../../docs/framework/wcf/samples/one-way.md) exemplo.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-114">For a complete example, see the [One-Way](../../../../docs/framework/wcf/samples/one-way.md) sample.</span></span>  
  
## <a name="clients-blocking-with-one-way-operations"></a><span data-ttu-id="c0ffb-115">Clientes de bloqueio com operações unidirecionais</span><span class="sxs-lookup"><span data-stu-id="c0ffb-115">Clients Blocking with One-Way Operations</span></span>  
 <span data-ttu-id="c0ffb-116">É importante observar que embora alguns aplicativos unidirecionais retornam assim que os dados de saída são gravados para a conexão de rede, em diversos cenários de implementação de uma associação ou de um serviço pode causar um cliente WCF bloquear usando operações unidirecionais.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-116">It is important to realize that while some one-way applications return as soon as the outbound data is written to the network connection, in several scenarios the implementation of a binding or of a service can cause a WCF client to block using one-way operations.</span></span> <span data-ttu-id="c0ffb-117">Em aplicativos de cliente do WCF, o objeto de cliente do WCF não retorna até que os dados de saída foram gravados para a conexão de rede.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-117">In WCF client applications, the WCF client object does not return until the outbound data has been written to the network connection.</span></span> <span data-ttu-id="c0ffb-118">Isso é verdadeiro para todos os padrões de troca de mensagens, incluindo operações unidirecionais; Isso significa que qualquer problema ao gravar que os dados para o transporte impede que o cliente retornando.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-118">This is true for all message exchange patterns, including one-way operations; this means that any problem writing the data to the transport prevents the client from returning.</span></span> <span data-ttu-id="c0ffb-119">Dependendo do problema, o resultado seria uma exceção ou um atraso no envio de mensagens para o serviço.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-119">Depending upon the problem, the result could be an exception or a delay in sending messages to the service.</span></span>  
  
 <span data-ttu-id="c0ffb-120">Por exemplo, se o transporte não é possível localizar o ponto de extremidade, um <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> exceção sem muito atraso.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-120">For example, if the transport cannot find the endpoint, a <xref:System.ServiceModel.EndpointNotFoundException?displayProperty=nameWithType> exception is thrown without much delay.</span></span> <span data-ttu-id="c0ffb-121">No entanto, também é possível que o serviço é não é possível ler os dados na rede por algum motivo, o que impede que o transporte de cliente a operação de envio de retorno.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-121">However, it is also possible that the service is unable to read the data off the wire for some reason, which prevents the client transport send operation from returning.</span></span> <span data-ttu-id="c0ffb-122">Nesses casos, se o <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> período em que o transporte de cliente associação for excedida, um <xref:System.TimeoutException?displayProperty=nameWithType> é lançada, mas não até que o período de tempo limite foi excedido.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-122">In these cases, if the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A?displayProperty=nameWithType> period on the client transport binding is exceeded, a <xref:System.TimeoutException?displayProperty=nameWithType> is thrown—but not until the timeout period has been exceeded.</span></span> <span data-ttu-id="c0ffb-123">Também é possível acionar muitas mensagens em um serviço que o serviço não pode processá-las após um certo ponto.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-123">It is also possible to fire so many messages at a service that the service cannot process them past a certain point.</span></span> <span data-ttu-id="c0ffb-124">Nesse caso, também, os blocos de cliente unidirecional até que o serviço pode processar as mensagens ou até que uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-124">In this case, too, the one-way client blocks until the service can process the messages or until an exception is thrown.</span></span>  
  
 <span data-ttu-id="c0ffb-125">Outra variação é a situação na qual o serviço <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> está definida como <xref:System.ServiceModel.ConcurrencyMode.Single> e a associação usa sessões.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-125">Another variation is the situation in which the service <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ConcurrencyMode.Single> and the binding uses sessions.</span></span> <span data-ttu-id="c0ffb-126">Nesse caso, o dispatcher impõe ordenação de mensagens de entrada (um requisito de sessões), que impede que as mensagens subsequentes sejam lidas fora da rede até que o serviço processou a mensagem anterior para a sessão.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-126">In this case, the dispatcher enforces ordering on the incoming messages (a requirement of sessions), which prevents subsequent messages from being read off the network until the service has processed the preceding message for that session.</span></span> <span data-ttu-id="c0ffb-127">Novamente, os blocos de cliente, mas se uma exceção ocorre depende se o serviço é capaz de processar os dados de espera antes das configurações de tempo limite no cliente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-127">Again, the client blocks, but whether an exception occurs depends upon whether the service is able to process the waiting data prior to the timeout settings on the client.</span></span>  
  
 <span data-ttu-id="c0ffb-128">Você pode reduzir alguns desse problema, inserindo um buffer entre o objeto de cliente e a operação de envio de transporte de cliente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-128">You can mitigate some of this problem by inserting a buffer between the client object and the client transport's send operation.</span></span> <span data-ttu-id="c0ffb-129">Por exemplo, usando chamadas assíncronas ou uma fila de mensagens na memória pode habilitar o objeto cliente retornar rapidamente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-129">For example, using asynchronous calls or using an in-memory message queue can enable the client object to return quickly.</span></span> <span data-ttu-id="c0ffb-130">Ambas as abordagens podem aumentar a funcionalidade, mas o tamanho do pool de threads e a fila de mensagens ainda Imponha limites.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-130">Both approaches may increase functionality, but the size of the thread pool and the message queue still enforce limits.</span></span>  
  
 <span data-ttu-id="c0ffb-131">É recomendável, em vez disso, que você examine os vários controles no serviço, bem como no cliente e, em seguida, testar os cenários de aplicativo para determinar a melhor configuração em ambos os lados.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-131">It is recommended, instead, that you examine the various controls on the service as well as on the client, and then test your application scenarios to determine the best configuration on either side.</span></span> <span data-ttu-id="c0ffb-132">Por exemplo, se o uso de sessões está bloqueando o processamento de mensagens em seu serviço, você pode definir o <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade <xref:System.ServiceModel.InstanceContextMode.PerCall> para que cada mensagem pode ser processada por uma instância de serviço diferente e definir o <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> para <xref:System.ServiceModel.ConcurrencyMode.Multiple> para permitir que mais de um thread enviar mensagens de cada vez.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-132">For example, if the use of sessions is blocking the processing of messages on your service, you can set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.PerCall> so that each message can be processed by a different service instance, and set the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> to <xref:System.ServiceModel.ConcurrencyMode.Multiple> in order to allow more than one thread to dispatch messages at a time.</span></span> <span data-ttu-id="c0ffb-133">Outra abordagem é aumentar as cotas de leitura das ligações de serviço e cliente.</span><span class="sxs-lookup"><span data-stu-id="c0ffb-133">Another approach is to increase the read quotas of the service and client bindings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c0ffb-134">Consulte também</span><span class="sxs-lookup"><span data-stu-id="c0ffb-134">See Also</span></span>  
 [<span data-ttu-id="c0ffb-135">Unidirecional</span><span class="sxs-lookup"><span data-stu-id="c0ffb-135">One-Way</span></span>](../../../../docs/framework/wcf/samples/one-way.md)
