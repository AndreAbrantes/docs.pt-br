---
title: Ativando o fluxo de transações
ms.date: 03/30/2017
helpviewer_keywords:
- transactions [WCF], enabling flow
ms.assetid: a03f5041-5049-43f4-897c-e0292d4718f7
ms.openlocfilehash: 8aff6afb09c97d7d01f5e7b7f1b92ae24bb99fb7
ms.sourcegitcommit: fbb8a593a511ce667992502a3ce6d8f65c594edf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/16/2019
ms.locfileid: "74141758"
---
# <a name="enabling-transaction-flow"></a><span data-ttu-id="7a0b8-102">Ativando o fluxo de transações</span><span class="sxs-lookup"><span data-stu-id="7a0b8-102">Enabling Transaction Flow</span></span>
<span data-ttu-id="7a0b8-103">O Windows Communication Foundation (WCF) fornece opções altamente flexíveis para controlar o fluxo de transações.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-103">Windows Communication Foundation (WCF) provides highly flexible options for controlling transaction flow.</span></span> <span data-ttu-id="7a0b8-104">As configurações de fluxo de transações de um serviço podem ser expressas usando uma combinação de atributos e configuração.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-104">A service's transaction flow settings can be expressed using a combination of attributes and configuration.</span></span>  
  
## <a name="transaction-flow-settings"></a><span data-ttu-id="7a0b8-105">Configurações de fluxo de transações</span><span class="sxs-lookup"><span data-stu-id="7a0b8-105">Transaction Flow Settings</span></span>  
 <span data-ttu-id="7a0b8-106">As configurações de fluxo de transações são geradas para um ponto de extremidade de serviço como resultado da interseção dos três valores a seguir:</span><span class="sxs-lookup"><span data-stu-id="7a0b8-106">Transaction flow settings are generated for a service endpoint as a result of the intersection of the following three values:</span></span>  
  
- <span data-ttu-id="7a0b8-107">O atributo <xref:System.ServiceModel.TransactionFlowAttribute> especificado para cada método no contrato de serviço.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-107">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specified for each method in the service contract.</span></span>  
  
- <span data-ttu-id="7a0b8-108">A propriedade de associação de `TransactionFlow` na associação específica.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-108">The `TransactionFlow` binding property in the specific binding.</span></span>  
  
- <span data-ttu-id="7a0b8-109">A propriedade de associação de `TransactionFlowProtocol` na associação específica.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-109">The `TransactionFlowProtocol` binding property in the specific binding.</span></span> <span data-ttu-id="7a0b8-110">A propriedade de associação `TransactionFlowProtocol` permite que você escolha entre dois protocolos de transação diferentes que você pode usar para fluir uma transação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-110">The `TransactionFlowProtocol` binding property enables you to choose among two different transaction protocols that you can use to flow a transaction.</span></span> <span data-ttu-id="7a0b8-111">As seções a seguir descrevem brevemente cada uma delas.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-111">The following sections briefly describe each of them.</span></span>  
  
### <a name="ws-atomictransaction-protocol"></a><span data-ttu-id="7a0b8-112">Protocolo WS-AtomicTransaction</span><span class="sxs-lookup"><span data-stu-id="7a0b8-112">WS-AtomicTransaction Protocol</span></span>  
 <span data-ttu-id="7a0b8-113">O protocolo WS-AtomicTransaction (WS-AT) é útil para cenários em que a interoperabilidade com pilhas de protocolos de terceiros é necessária.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-113">The WS-AtomicTransaction (WS-AT) protocol is useful for scenarios when interoperability with third-party protocol stacks is required.</span></span>  
  
### <a name="oletransactions-protocol"></a><span data-ttu-id="7a0b8-114">Protocolo OleTransactions</span><span class="sxs-lookup"><span data-stu-id="7a0b8-114">OleTransactions Protocol</span></span>  
 <span data-ttu-id="7a0b8-115">O protocolo OleTransactions é útil para cenários em que a interoperabilidade com pilhas de protocolo de terceiros não é necessária e o implantador de um serviço sabe antecipadamente que o serviço de protocolo WS-AT está desabilitado localmente ou a topologia de rede existente não favorecer o uso de WS-AT.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-115">The OleTransactions protocol is useful for scenarios when interoperability with third-party protocol stacks is not required, and the deployer of a service knows in advance that the WS-AT protocol service is disabled locally or the existing network topology does not favor the usage of WS-AT.</span></span>  
  
 <span data-ttu-id="7a0b8-116">A tabela a seguir mostra os diferentes tipos de fluxos de transação que podem ser gerados usando essas várias combinações.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-116">The following table shows the different types of transaction flows that can be generated using these various combinations.</span></span>  
  
|<span data-ttu-id="7a0b8-117">TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="7a0b8-117">TransactionFlow</span></span><br /><br /> <span data-ttu-id="7a0b8-118">associação</span><span class="sxs-lookup"><span data-stu-id="7a0b8-118">binding</span></span>|<span data-ttu-id="7a0b8-119">Propriedade de associação TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="7a0b8-119">TransactionFlow binding property</span></span>|<span data-ttu-id="7a0b8-120">Protocolo de associação TransactionFlowProtocol</span><span class="sxs-lookup"><span data-stu-id="7a0b8-120">TransactionFlowProtocol binding protocol</span></span>|<span data-ttu-id="7a0b8-121">Tipo de fluxo de transações</span><span class="sxs-lookup"><span data-stu-id="7a0b8-121">Type of transaction flow</span></span>|  
|---------------------------------|--------------------------------------|----------------------------------------------|------------------------------|  
|<span data-ttu-id="7a0b8-122">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-122">Mandatory</span></span>|<span data-ttu-id="7a0b8-123">true</span><span class="sxs-lookup"><span data-stu-id="7a0b8-123">true</span></span>|<span data-ttu-id="7a0b8-124">WS-AT</span><span class="sxs-lookup"><span data-stu-id="7a0b8-124">WS-AT</span></span>|<span data-ttu-id="7a0b8-125">A transação deve ser fluida no formato interoperável WS-AT.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-125">Transaction must be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="7a0b8-126">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-126">Mandatory</span></span>|<span data-ttu-id="7a0b8-127">true</span><span class="sxs-lookup"><span data-stu-id="7a0b8-127">true</span></span>|<span data-ttu-id="7a0b8-128">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="7a0b8-128">OleTransactions</span></span>|<span data-ttu-id="7a0b8-129">A transação deve ser fluida no formato WCF OleTransactions.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-129">Transaction must be flowed in the WCF OleTransactions format.</span></span>|  
|<span data-ttu-id="7a0b8-130">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-130">Mandatory</span></span>|<span data-ttu-id="7a0b8-131">false</span><span class="sxs-lookup"><span data-stu-id="7a0b8-131">false</span></span>|<span data-ttu-id="7a0b8-132">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="7a0b8-132">Not applicable</span></span>|<span data-ttu-id="7a0b8-133">Não aplicável porque esta é uma configuração inválida.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-133">Not applicable because this is an invalid configuration.</span></span>|  
|<span data-ttu-id="7a0b8-134">Permitidos</span><span class="sxs-lookup"><span data-stu-id="7a0b8-134">Allowed</span></span>|<span data-ttu-id="7a0b8-135">true</span><span class="sxs-lookup"><span data-stu-id="7a0b8-135">true</span></span>|<span data-ttu-id="7a0b8-136">WS-AT</span><span class="sxs-lookup"><span data-stu-id="7a0b8-136">WS-AT</span></span>|<span data-ttu-id="7a0b8-137">A transação pode estar fluindo no formato interoperável WS-AT.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-137">Transaction may be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="7a0b8-138">Permitidos</span><span class="sxs-lookup"><span data-stu-id="7a0b8-138">Allowed</span></span>|<span data-ttu-id="7a0b8-139">true</span><span class="sxs-lookup"><span data-stu-id="7a0b8-139">true</span></span>|<span data-ttu-id="7a0b8-140">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="7a0b8-140">OleTransactions</span></span>|<span data-ttu-id="7a0b8-141">A transação pode estar fluindo no formato WCF OleTransactions.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-141">Transaction may be flowed in the WCF OleTransactions format.</span></span>|  
|<span data-ttu-id="7a0b8-142">Permitidos</span><span class="sxs-lookup"><span data-stu-id="7a0b8-142">Allowed</span></span>|<span data-ttu-id="7a0b8-143">false</span><span class="sxs-lookup"><span data-stu-id="7a0b8-143">false</span></span>|<span data-ttu-id="7a0b8-144">Qualquer valor</span><span class="sxs-lookup"><span data-stu-id="7a0b8-144">Any value</span></span>|<span data-ttu-id="7a0b8-145">Uma transação não está fluindo.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-145">A transaction is not flowed.</span></span>|  
|<span data-ttu-id="7a0b8-146">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="7a0b8-146">NotAllowed</span></span>|<span data-ttu-id="7a0b8-147">Qualquer valor</span><span class="sxs-lookup"><span data-stu-id="7a0b8-147">Any value</span></span>|<span data-ttu-id="7a0b8-148">Qualquer valor</span><span class="sxs-lookup"><span data-stu-id="7a0b8-148">Any value</span></span>|<span data-ttu-id="7a0b8-149">Uma transação não está fluindo.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-149">A transaction is not flowed.</span></span>|  
  
 <span data-ttu-id="7a0b8-150">A tabela a seguir resume o resultado do processamento da mensagem.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-150">The following table summarizes the message processing result.</span></span>  
  
|<span data-ttu-id="7a0b8-151">Mensagem de entrada</span><span class="sxs-lookup"><span data-stu-id="7a0b8-151">Incoming message</span></span>|<span data-ttu-id="7a0b8-152">Configuração de TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="7a0b8-152">TransactionFlow setting</span></span>|<span data-ttu-id="7a0b8-153">Cabeçalho da transação</span><span class="sxs-lookup"><span data-stu-id="7a0b8-153">Transaction header</span></span>|<span data-ttu-id="7a0b8-154">Resultado do processamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="7a0b8-154">Message processing result</span></span>|  
|----------------------|-----------------------------|------------------------|-------------------------------|  
|<span data-ttu-id="7a0b8-155">A transação corresponde ao formato de protocolo esperado</span><span class="sxs-lookup"><span data-stu-id="7a0b8-155">Transaction matches expected protocol format</span></span>|<span data-ttu-id="7a0b8-156">Permitido ou obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-156">Allowed or Mandatory</span></span>|<span data-ttu-id="7a0b8-157">`MustUnderstand` é igual a `true`.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-157">`MustUnderstand` equals `true`.</span></span>|<span data-ttu-id="7a0b8-158">Processar</span><span class="sxs-lookup"><span data-stu-id="7a0b8-158">Process</span></span>|  
|<span data-ttu-id="7a0b8-159">A transação não corresponde ao formato de protocolo esperado</span><span class="sxs-lookup"><span data-stu-id="7a0b8-159">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="7a0b8-160">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-160">Mandatory</span></span>|<span data-ttu-id="7a0b8-161">`MustUnderstand` é igual a `false`.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-161">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="7a0b8-162">Rejeitado porque uma transação é necessária</span><span class="sxs-lookup"><span data-stu-id="7a0b8-162">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="7a0b8-163">A transação não corresponde ao formato de protocolo esperado</span><span class="sxs-lookup"><span data-stu-id="7a0b8-163">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="7a0b8-164">Permitidos</span><span class="sxs-lookup"><span data-stu-id="7a0b8-164">Allowed</span></span>|<span data-ttu-id="7a0b8-165">`MustUnderstand` é igual a `false`.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-165">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="7a0b8-166">Rejeitado porque o cabeçalho não é compreendido</span><span class="sxs-lookup"><span data-stu-id="7a0b8-166">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="7a0b8-167">Transação usando qualquer formato de protocolo</span><span class="sxs-lookup"><span data-stu-id="7a0b8-167">Transaction using any protocol format</span></span>|<span data-ttu-id="7a0b8-168">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="7a0b8-168">NotAllowed</span></span>|<span data-ttu-id="7a0b8-169">`MustUnderstand` é igual a `false`.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-169">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="7a0b8-170">Rejeitado porque o cabeçalho não é compreendido</span><span class="sxs-lookup"><span data-stu-id="7a0b8-170">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="7a0b8-171">Nenhuma transação</span><span class="sxs-lookup"><span data-stu-id="7a0b8-171">No transaction</span></span>|<span data-ttu-id="7a0b8-172">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="7a0b8-172">Mandatory</span></span>|<span data-ttu-id="7a0b8-173">N/A</span><span class="sxs-lookup"><span data-stu-id="7a0b8-173">N/A</span></span>|<span data-ttu-id="7a0b8-174">Rejeitado porque uma transação é necessária</span><span class="sxs-lookup"><span data-stu-id="7a0b8-174">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="7a0b8-175">Nenhuma transação</span><span class="sxs-lookup"><span data-stu-id="7a0b8-175">No transaction</span></span>|<span data-ttu-id="7a0b8-176">Permitidos</span><span class="sxs-lookup"><span data-stu-id="7a0b8-176">Allowed</span></span>|<span data-ttu-id="7a0b8-177">N/A</span><span class="sxs-lookup"><span data-stu-id="7a0b8-177">N/A</span></span>|<span data-ttu-id="7a0b8-178">Processar</span><span class="sxs-lookup"><span data-stu-id="7a0b8-178">Process</span></span>|  
|<span data-ttu-id="7a0b8-179">Nenhuma transação</span><span class="sxs-lookup"><span data-stu-id="7a0b8-179">No transaction</span></span>|<span data-ttu-id="7a0b8-180">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="7a0b8-180">NotAllowed</span></span>|<span data-ttu-id="7a0b8-181">N/A</span><span class="sxs-lookup"><span data-stu-id="7a0b8-181">N/A</span></span>|<span data-ttu-id="7a0b8-182">Processar</span><span class="sxs-lookup"><span data-stu-id="7a0b8-182">Process</span></span>|  
  
 <span data-ttu-id="7a0b8-183">Embora cada método em um contrato possa ter diferentes requisitos de fluxo de transações, a configuração do protocolo de fluxo de transações é delimitada no nível da associação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-183">While each method on a contract can have different transaction flow requirements, the transaction flow protocol setting is scoped at the level of the binding.</span></span> <span data-ttu-id="7a0b8-184">Isso significa que todos os métodos que compartilham o mesmo ponto de extremidade (e, portanto, a mesma associação) também compartilham a mesma política, permitindo ou exigindo o fluxo de transações, bem como o mesmo protocolo de transação, se aplicável.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-184">This means that all methods that share the same endpoint (and therefore the same binding) also share the same policy allowing or requiring transaction flow, as well as the same transaction protocol if applicable.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-method-level"></a><span data-ttu-id="7a0b8-185">Habilitando o fluxo de transações no nível do método</span><span class="sxs-lookup"><span data-stu-id="7a0b8-185">Enabling Transaction Flow at the Method Level</span></span>  
 <span data-ttu-id="7a0b8-186">Os requisitos de fluxo de transações nem sempre são os mesmos para todos os métodos em um contrato de serviço.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-186">Transaction flow requirements are not always the same for all methods in a service contract.</span></span> <span data-ttu-id="7a0b8-187">Portanto, o WCF também fornece um mecanismo baseado em atributo para permitir que as preferências de fluxo de transações de cada método sejam expressas.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-187">Therefore, WCF also provides an attribute-based mechanism to allow each method's transaction flow preferences to be expressed.</span></span> <span data-ttu-id="7a0b8-188">Isso é conseguido pelo <xref:System.ServiceModel.TransactionFlowAttribute> que especifica o nível no qual uma operação de serviço aceita um cabeçalho de transação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-188">This is achieved by the <xref:System.ServiceModel.TransactionFlowAttribute> that specifies the level in which a service operation accepts a transaction header.</span></span> <span data-ttu-id="7a0b8-189">Você deve marcar seus métodos de contrato de serviço com esse atributo se quiser habilitar o fluxo de transações.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-189">You should mark your service contract methods with this attribute if you want to enable transaction flow.</span></span> <span data-ttu-id="7a0b8-190">Esse atributo usa um dos valores da enumeração <xref:System.ServiceModel.TransactionFlowOption>, no qual o valor padrão é <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-190">This attribute takes one of the values of the <xref:System.ServiceModel.TransactionFlowOption> enumeration, in which the default value is <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span> <span data-ttu-id="7a0b8-191">Se qualquer valor, exceto <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> for especificado, o método não será necessário para ser unidirecional.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-191">If any value except <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> is specified, the method is required to not be one-way.</span></span> <span data-ttu-id="7a0b8-192">Um desenvolvedor pode usar esse atributo para especificar requisitos de fluxo de transações em nível de método ou restrições em tempo de design.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-192">A developer can use this attribute to specify method-level transaction flow requirements or constraints at design time.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-endpoint-level"></a><span data-ttu-id="7a0b8-193">Habilitando o fluxo de transações no nível do ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="7a0b8-193">Enabling Transaction Flow at the Endpoint Level</span></span>  
 <span data-ttu-id="7a0b8-194">Além da configuração de fluxo de transações em nível de método que o atributo <xref:System.ServiceModel.TransactionFlowAttribute> fornece, o WCF fornece uma configuração de todo o ponto de extremidade para o fluxo de transações para permitir que os administradores controlem o fluxo de transações em um nível mais alto.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-194">In addition to the method-level transaction flow setting  the <xref:System.ServiceModel.TransactionFlowAttribute> attribute provides, WCF provides an endpoint-wide setting for transaction flow to allow administrators to control transaction flow at a higher level.</span></span>  
  
 <span data-ttu-id="7a0b8-195">Isso é conseguido pelo <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>, que permite habilitar ou desabilitar o fluxo de transações de entrada nas configurações de associação de um ponto de extremidade, bem como especificar o formato de protocolo de transação desejado para transações de entrada.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-195">This is achieved by the <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>, which enables you to enable or disable incoming transaction flow in an endpoint’s binding settings, as well as to specify the desired transaction protocol format for incoming transactions.</span></span>  
  
 <span data-ttu-id="7a0b8-196">Se a associação tiver desabilitado o fluxo de transações, mas uma das operações em um contrato de serviço exigir uma transação de entrada, uma exceção de validação será lançada na inicialização do serviço.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-196">If the binding has disabled transaction flow, but one of the operations on a service contract requires an incoming transaction, then a validation exception is thrown at service startup.</span></span>  
  
 <span data-ttu-id="7a0b8-197">A maioria das ligações que o WCF fornece contém os atributos `transactionFlow` e `transactionProtocol` para permitir que você configure a associação específica para aceitar as transações de entrada.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-197">Most of the standing bindings WCF provides contain the `transactionFlow` and `transactionProtocol` attributes to enable you to configure the specific binding to accept incoming transactions.</span></span> <span data-ttu-id="7a0b8-198">Para obter mais informações sobre como definir os elementos de configuração, consulte [\<binding >](../../configure-apps/file-schema/wcf/bindings.md).</span><span class="sxs-lookup"><span data-stu-id="7a0b8-198">For more information about setting the configuration elements, see [\<binding>](../../configure-apps/file-schema/wcf/bindings.md).</span></span>  
  
 <span data-ttu-id="7a0b8-199">Um administrador ou um implantador pode usar o fluxo de transações no nível do ponto de extremidade para configurar restrições ou requisitos de fluxo de transação no momento da implantação usando o arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-199">An administrator or deployer can use endpoint-level transaction flow to configure transaction flow requirements or constraints at deployment time using the configuration file.</span></span>  
  
## <a name="security"></a><span data-ttu-id="7a0b8-200">Segurança</span><span class="sxs-lookup"><span data-stu-id="7a0b8-200">Security</span></span>  
 <span data-ttu-id="7a0b8-201">Para garantir a segurança e a integridade do sistema, você deve proteger as trocas de mensagens ao fluir transações entre aplicativos.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-201">To ensure system security and integrity, you must secure message exchanges when flowing transactions between applications.</span></span> <span data-ttu-id="7a0b8-202">Você não deve fluir ou divulgar detalhes da transação para qualquer aplicativo que não tenha direito a participar da mesma transação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-202">You should not flow or disclose transaction details to any application that is not entitled to participate in the same transaction.</span></span>  
  
 <span data-ttu-id="7a0b8-203">Ao gerar clientes WCF para serviços Web desconhecidos ou não confiáveis por meio do uso de troca de metadados, as chamadas para operações nesses serviços Web devem suprimir a transação atual, se possível.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-203">When generating WCF clients to unknown or untrusted Web services through the use of metadata exchange, calls to operations on these Web services should suppress the current transaction if possible.</span></span> <span data-ttu-id="7a0b8-204">O exemplo a seguir demonstra como fazer isso.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-204">The following example demonstrates how to do this.</span></span>  
  
```csharp
//client code which has an ambient transaction  
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Suppress))  
{  
    // No transaction will flow to this operation  
    untrustedProxy.Operation1(...);  
    scope.Complete();  
}  
//remainder of client code  
```  
  
 <span data-ttu-id="7a0b8-205">Além disso, os serviços devem ser configurados para aceitar transações de entrada somente de clientes que tenham sido autenticados e autorizados.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-205">In addition, services should be configured to accept incoming transactions only from clients that they have authenticated and authorized.</span></span> <span data-ttu-id="7a0b8-206">As transações de entrada só devem ser aceitas se forem provenientes de clientes altamente confiáveis.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-206">Incoming transactions should only be accepted if they come from highly trusted clients.</span></span>  
  
## <a name="policy-assertions"></a><span data-ttu-id="7a0b8-207">Declarações de política</span><span class="sxs-lookup"><span data-stu-id="7a0b8-207">Policy Assertions</span></span>  
 <span data-ttu-id="7a0b8-208">O WCF usa declarações de política para controlar o fluxo de transações.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-208">WCF uses policy assertions to control transaction flow.</span></span> <span data-ttu-id="7a0b8-209">As declarações de política podem ser encontradas no documento de política de um serviço, que é gerado pela agregação de contratos, configuração e atributos.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-209">Policy assertions can be found in a service’s policy document, which is generated by aggregating contracts, configuration, and attributes.</span></span> <span data-ttu-id="7a0b8-210">O cliente pode obter o documento de política do serviço usando uma resposta de solicitação HTTP GET ou WS-MetadataExchange.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-210">The client can obtain the service’s policy document using an HTTP GET or a WS-MetadataExchange request-reply.</span></span> <span data-ttu-id="7a0b8-211">Os clientes podem processar o documento de política para determinar quais operações em um contrato de serviço podem dar suporte ou exigir o fluxo de transações.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-211">Clients can then process the policy document to determine which operations on a service contract may support or require transaction flow.</span></span>  
  
 <span data-ttu-id="7a0b8-212">As declarações de política de fluxo de transações afetam o fluxo de transações, especificando os cabeçalhos SOAP que um cliente deve enviar a um serviço para representar uma transação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-212">Transaction flow policy assertions affect transaction flow by specifying the SOAP headers that a client should send to a service to represent a transaction.</span></span> <span data-ttu-id="7a0b8-213">Todos os cabeçalhos de transação devem ser marcados com `MustUnderstand` igual a `true`.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-213">All transaction headers must be marked with `MustUnderstand` equal to `true`.</span></span> <span data-ttu-id="7a0b8-214">Qualquer mensagem com um cabeçalho marcado de outra forma é rejeitada com uma falha de SOAP.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-214">Any message with a header marked otherwise is rejected with a SOAP fault.</span></span>  
  
 <span data-ttu-id="7a0b8-215">Somente uma declaração de política relacionada à transação pode estar presente em uma única operação.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-215">Only one transaction-related policy assertion can be present on a single operation.</span></span> <span data-ttu-id="7a0b8-216">Os documentos de política com mais de uma declaração de transação em uma operação são considerados inválidos e são rejeitados pelo WCF.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-216">Policy documents with more than one transaction assertion on an operation are considered invalid and are rejected by WCF.</span></span> <span data-ttu-id="7a0b8-217">Além disso, apenas um único protocolo de transação pode estar presente dentro de cada tipo de porta.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-217">In addition, only a single transaction protocol can be present inside each port type.</span></span> <span data-ttu-id="7a0b8-218">Documentos de política com operações que fazem referência a mais de um protocolo de transação dentro de um único tipo de porta são considerados inválidos e são rejeitados pela [ferramenta de utilitário de metadados ServiceModel (svcutil. exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="7a0b8-218">Policy documents with operations referencing more than one transaction protocol inside a single port type are considered invalid, and are rejected by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="7a0b8-219">Os documentos de política com declarações de transação presentes em mensagens de saída ou em mensagens de entrada unidirecionais também são considerados inválidos.</span><span class="sxs-lookup"><span data-stu-id="7a0b8-219">Policy documents with transaction assertions present on output messages or one-way input messages are also considered invalid.</span></span>
