---
title: Hospedando na Web um aplicativo em fila
ms.date: 03/30/2017
ms.assetid: c7a539fa-e442-4c08-a7f1-17b7f5a03e88
ms.openlocfilehash: c44a6b5059f5294646d95b4281dcf7845b369929
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59126016"
---
# <a name="web-hosting-a-queued-application"></a><span data-ttu-id="75b6f-102">Hospedando na Web um aplicativo em fila</span><span class="sxs-lookup"><span data-stu-id="75b6f-102">Web Hosting a Queued Application</span></span>
<span data-ttu-id="75b6f-103">O serviço de ativação de processos do Windows (WAS) gerencia a ativação e o tempo de vida dos processos de trabalho que contêm aplicativos que hospedar serviços do Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="75b6f-103">The Windows Process Activation Service (WAS) manages the activation and lifetime of the worker processes that contain applications that host Windows Communication Foundation (WCF) services.</span></span> <span data-ttu-id="75b6f-104">O modelo de processo WAS generaliza o [!INCLUDE[iis601](../../../../includes/iis601-md.md)] modelo de processo para o servidor HTTP, removendo a dependência no HTTP.</span><span class="sxs-lookup"><span data-stu-id="75b6f-104">The WAS process model generalizes the [!INCLUDE[iis601](../../../../includes/iis601-md.md)] process model for the HTTP server by removing the dependency on HTTP.</span></span> <span data-ttu-id="75b6f-105">Isso permite que os serviços do WCF para usar HTTP e protocolos não HTTP, como NET. MSMQ e FormatName, em um ambiente de hospedagem que oferece suporte à ativação baseada em mensagem e oferece a capacidade de hospedar um grande número de aplicativos em um determinado computador.</span><span class="sxs-lookup"><span data-stu-id="75b6f-105">This allows WCF services to use both HTTP and non-HTTP protocols, such as net.msmq and msmq.formatname, in a hosting environment that supports message-based activation and offers the ability to host a large number of applications on a given computer.</span></span>  
  
 <span data-ttu-id="75b6f-106">FOI inclui um serviço de ativação de enfileiramento de mensagens (MSMQ) que ativa um aplicativo na fila quando uma ou mais mensagens são colocadas em uma das filas usadas pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="75b6f-106">WAS includes a Message Queuing (MSMQ) activation service that activates a queued application when one or more messages are placed in one of the queues used by the application.</span></span> <span data-ttu-id="75b6f-107">O serviço de ativação MSMQ é um serviço NT que é iniciado automaticamente por padrão.</span><span class="sxs-lookup"><span data-stu-id="75b6f-107">The MSMQ activation service is an NT service that is automatically started by default.</span></span>  
  
 <span data-ttu-id="75b6f-108">Para obter mais informações sobre o WAS e seus benefícios, consulte [hospedagem no serviço de ativação de processos do Windows](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).</span><span class="sxs-lookup"><span data-stu-id="75b6f-108">For more information about WAS and its benefits, see [Hosting in Windows Process Activation Service](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).</span></span> <span data-ttu-id="75b6f-109">Para obter mais informações sobre o MSMQ, consulte [visão geral de filas](../../../../docs/framework/wcf/feature-details/queues-overview.md).</span><span class="sxs-lookup"><span data-stu-id="75b6f-109">For more information about MSMQ, see [Queues Overview](../../../../docs/framework/wcf/feature-details/queues-overview.md).</span></span>
  
## <a name="queue-addressing-in-was"></a><span data-ttu-id="75b6f-110">Fila de endereçamento no WAS</span><span class="sxs-lookup"><span data-stu-id="75b6f-110">Queue Addressing in WAS</span></span>  
 <span data-ttu-id="75b6f-111">ERA aplicativos têm endereços de identificador de recurso uniforme (URI).</span><span class="sxs-lookup"><span data-stu-id="75b6f-111">WAS applications have Uniform Resource Identifier (URI) addresses.</span></span> <span data-ttu-id="75b6f-112">Endereços de aplicativo têm duas partes: um prefixo URI base e um endereço específico do aplicativo, relativo (caminho).</span><span class="sxs-lookup"><span data-stu-id="75b6f-112">Application addresses have two parts: a base URI prefix and an application-specific, relative address (path).</span></span> <span data-ttu-id="75b6f-113">Essas duas partes fornecem o endereço externo para um aplicativo quando unidas.</span><span class="sxs-lookup"><span data-stu-id="75b6f-113">These two parts provide the external address for an application when joined together.</span></span> <span data-ttu-id="75b6f-114">O prefixo URI base é construído com a associação do site e é usado para todos os aplicativos no site, por exemplo, "net.msmq://localhost", "msmq.formatname://localhost" ou "baseaddress="NET.TCP://localhost:6080/vmmhelperservice/".</span><span class="sxs-lookup"><span data-stu-id="75b6f-114">The base URI prefix is constructed from the site binding and is used for all the applications under the site, for example, "net.msmq://localhost", "msmq.formatname://localhost", or "net.tcp://localhost".</span></span> <span data-ttu-id="75b6f-115">Endereços de aplicativo, em seguida, são construídos por meio de fragmentos de caminho específico do aplicativo (como "/ applicationOne") e acrescentando-os ao URI de base do prefixo para chegar o aplicativo completo URI, por exemplo, "net.msmq://localhost/applicationOne".</span><span class="sxs-lookup"><span data-stu-id="75b6f-115">Application addresses are then constructed by taking application-specific path fragments (such as "/applicationOne") and appending them to the base URI prefix to arrive at the full application URI, for example, "net.msmq://localhost/applicationOne".</span></span>  
  
 <span data-ttu-id="75b6f-116">O serviço de ativação MSMQ usa o URI do aplicativo para corresponder a fila que o serviço de ativação MSMQ deve monitorar para mensagens.</span><span class="sxs-lookup"><span data-stu-id="75b6f-116">The MSMQ activation service uses the application URI to match the queue that the MSMQ activation service must monitor for messages.</span></span> <span data-ttu-id="75b6f-117">Quando o serviço de ativação MSMQ é iniciado, ele enumerará todas as filas públicas e privadas no computador em que ele está configurado para receber e monitorá-los para mensagens.</span><span class="sxs-lookup"><span data-stu-id="75b6f-117">When the MSMQ activation service starts, it enumerates all public and private queues on the computer it is configured to receive from and monitors them for messages.</span></span> <span data-ttu-id="75b6f-118">A cada 10 minutos, o serviço de ativação MSMQ atualiza a lista de filas para monitorar.</span><span class="sxs-lookup"><span data-stu-id="75b6f-118">Every 10 minutes, the MSMQ activation service refreshes the list of queues to monitor.</span></span> <span data-ttu-id="75b6f-119">Quando uma mensagem é encontrada em uma fila, o serviço de ativação coincide com o nome da fila para o URI do aplicativo correspondente mais longo para a associação de NET. MSMQ e ativa o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="75b6f-119">When a message is found in a queue, the activation service matches the queue name to the longest matching application URI for the net.msmq binding and activates the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="75b6f-120">O aplicativo que está sendo ativado deve corresponder (correspondência mais longa), o prefixo do nome da fila.</span><span class="sxs-lookup"><span data-stu-id="75b6f-120">The application being activated must match (longest match) the prefix of the queue name.</span></span>  
  
 <span data-ttu-id="75b6f-121">Por exemplo, um nome de fila é: msmqWebHost/orderProcessing/service.svc.</span><span class="sxs-lookup"><span data-stu-id="75b6f-121">For example, a queue name is: msmqWebHost/orderProcessing/service.svc.</span></span> <span data-ttu-id="75b6f-122">Se o aplicativo 1 tem /msmqWebHost/orderProcessing um diretório virtual com um SVC nele e aplicativo 2 tem /msmqWebHost um diretório virtual com um orderProcessing.svc sob ele, aplicativo 1 está ativado.</span><span class="sxs-lookup"><span data-stu-id="75b6f-122">If Application 1 has a virtual directory /msmqWebHost/orderProcessing with a service.svc under it, and Application 2 has a virtual directory /msmqWebHost with an orderProcessing.svc under it, Application 1 is activated.</span></span> <span data-ttu-id="75b6f-123">Se o aplicativo 1 é excluído, 2 de aplicativo está ativado.</span><span class="sxs-lookup"><span data-stu-id="75b6f-123">If Application 1 is deleted, Application 2 is activated.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="75b6f-124">Quando uma fila é criada, todas as mensagens enviadas a ele não ativar um aplicativo até que o serviço de ativação MSMQ atualiza a lista de fila, que é, no máximo, 10 minutos da hora em que a fila foi criada.</span><span class="sxs-lookup"><span data-stu-id="75b6f-124">When a queue is created, any messages sent to it do not activate an application until the MSMQ activation service refreshes the queue list, which is, at most, 10 minutes from the time the queue was created.</span></span> <span data-ttu-id="75b6f-125">Reiniciar o serviço de ativação atualiza a lista de filas.</span><span class="sxs-lookup"><span data-stu-id="75b6f-125">Restarting the activation service refreshes the queue list as well.</span></span>  
  
### <a name="the-effect-of-private-and-public-queues-on-addressing"></a><span data-ttu-id="75b6f-126">O efeito de filas públicas e privadas no endereçamento</span><span class="sxs-lookup"><span data-stu-id="75b6f-126">The Effect of Private and Public Queues on Addressing</span></span>  
 <span data-ttu-id="75b6f-127">O serviço de ativação MSMQ não faz distinção entre o monitoramento de fila pública e privada.</span><span class="sxs-lookup"><span data-stu-id="75b6f-127">The MSMQ activation service does not distinguish between private and public queue monitoring.</span></span> <span data-ttu-id="75b6f-128">Como tal, você não pode ter filas públicas e privadas com o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="75b6f-128">As such, you cannot have public and private queues with the same name.</span></span> <span data-ttu-id="75b6f-129">Se você fizer isso, um aplicativo hospedado na Web pode obter ativado lendo a qualquer uma das filas.</span><span class="sxs-lookup"><span data-stu-id="75b6f-129">If you do, a Web-hosted application may get activated reading from either of the queues.</span></span>  
  
### <a name="queue-configuration-for-activation"></a><span data-ttu-id="75b6f-130">Configuração de fila para ativação</span><span class="sxs-lookup"><span data-stu-id="75b6f-130">Queue Configuration for Activation</span></span>  
 <span data-ttu-id="75b6f-131">O serviço de ativação MSMQ é executado como serviço de rede.</span><span class="sxs-lookup"><span data-stu-id="75b6f-131">The MSMQ activation service runs as NETWORK SERVICE.</span></span> <span data-ttu-id="75b6f-132">É o serviço que monitora as filas para ativar aplicativos.</span><span class="sxs-lookup"><span data-stu-id="75b6f-132">It is the service that monitors queues to activate applications.</span></span> <span data-ttu-id="75b6f-133">Para que ele ativar aplicativos da fila, a fila deve fornecer para acesso ao serviço de rede inspecionar mensagens em sua lista de controle de acesso (ACL).</span><span class="sxs-lookup"><span data-stu-id="75b6f-133">For it to activate applications from the queue, the queue must provide for NETWORK SERVICE access to peek for messages in its access control list (ACL).</span></span>  
  
### <a name="poison-messaging"></a><span data-ttu-id="75b6f-134">Suspeitas de mensagens</span><span class="sxs-lookup"><span data-stu-id="75b6f-134">Poison Messaging</span></span>  
 <span data-ttu-id="75b6f-135">No WCF de tratamento de mensagens suspeitas é tratada pelo canal, que não apenas detecta que uma mensagem será suspeita, mas seleciona uma disposição com base na configuração do usuário.</span><span class="sxs-lookup"><span data-stu-id="75b6f-135">Poison message handling in WCF is handled by the channel, which not only detects that a message is poisoned but selects a disposition based on user configuration.</span></span> <span data-ttu-id="75b6f-136">Como resultado, há uma única mensagem na fila.</span><span class="sxs-lookup"><span data-stu-id="75b6f-136">As a result, there is a single message in the queue.</span></span> <span data-ttu-id="75b6f-137">O aplicativo Web hospedado anula vezes sucessivas e a mensagem é movida para uma fila de repetição.</span><span class="sxs-lookup"><span data-stu-id="75b6f-137">The Web-hosted application aborts successive times and the message is moved to a retry queue.</span></span> <span data-ttu-id="75b6f-138">Em um momento determinado pelo intervalo de ciclo de repetição, a mensagem é movida da fila de repetição para a fila principal para tentar novamente.</span><span class="sxs-lookup"><span data-stu-id="75b6f-138">At a point dictated by the retry cycle delay, the message is moved from the retry queue to the main queue to try again.</span></span> <span data-ttu-id="75b6f-139">Mas isso requer que o canal em fila esteja ativa.</span><span class="sxs-lookup"><span data-stu-id="75b6f-139">But this requires the queued channel to be active.</span></span> <span data-ttu-id="75b6f-140">Se o aplicativo é reciclado pelo WAS, em seguida, a mensagem permanecerá na fila de repetição até que outra mensagem chega na fila principal para ativar o aplicativo na fila.</span><span class="sxs-lookup"><span data-stu-id="75b6f-140">If the application is recycled by WAS, then the message remains in the retry queue until another message arrives in the main queue to activate the queued application.</span></span> <span data-ttu-id="75b6f-141">Nesse caso, a solução alternativa é mover a mensagem manualmente da fila de repetição volta para a fila principal para reativar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="75b6f-141">The workaround in this case is to move the message manually from the retry queue back to the main queue to reactivate the application.</span></span>  
  
### <a name="subqueue-and-system-queue-caveat"></a><span data-ttu-id="75b6f-142">Esta opção e a limitação de fila do sistema</span><span class="sxs-lookup"><span data-stu-id="75b6f-142">Subqueue and System Queue Caveat</span></span>  
 <span data-ttu-id="75b6f-143">Um aplicativo hospedado do WAS não pode ser ativado com base em mensagens em uma fila do sistema, como a fila de inatividade do sistema ou subfilas como suspeitas subfilas.</span><span class="sxs-lookup"><span data-stu-id="75b6f-143">A WAS-hosted application cannot be activated based on messages in a system queue, such as the system-wide dead-letter queue, or sub-queues, such as poison sub-queues.</span></span> <span data-ttu-id="75b6f-144">Essa é uma limitação para esta versão do produto.</span><span class="sxs-lookup"><span data-stu-id="75b6f-144">This is a limitation for this version of the product.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="75b6f-145">Consulte também</span><span class="sxs-lookup"><span data-stu-id="75b6f-145">See also</span></span>

- [<span data-ttu-id="75b6f-146">Manipulação de mensagens suspeitas</span><span class="sxs-lookup"><span data-stu-id="75b6f-146">Poison Message Handling</span></span>](../../../../docs/framework/wcf/feature-details/poison-message-handling.md)
- [<span data-ttu-id="75b6f-147">Pontos de extremidade de serviço e endereçamento de fila</span><span class="sxs-lookup"><span data-stu-id="75b6f-147">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)
