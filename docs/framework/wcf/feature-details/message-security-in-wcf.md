---
title: Segurança de mensagem no WCF
ms.date: 03/30/2017
ms.assetid: a80efb59-591a-4a37-bb3c-8fffa6ca0b7d
ms.openlocfilehash: 27f8354cf4d96f8da408cffa3cef42ab9609c76d
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33493885"
---
# <a name="message-security-in-wcf"></a><span data-ttu-id="4d16a-102">Segurança de mensagem no WCF</span><span class="sxs-lookup"><span data-stu-id="4d16a-102">Message Security in WCF</span></span>
<span data-ttu-id="4d16a-103">Windows Communication Foundation (WCF) tem dois modos principais para fornecer segurança (`Transport` e `Message`) e um terceiro modo (`TransportWithMessageCredential`) que combina os dois.</span><span class="sxs-lookup"><span data-stu-id="4d16a-103">Windows Communication Foundation (WCF) has two major modes for providing security (`Transport` and `Message`) and a third mode (`TransportWithMessageCredential`) that combines the two.</span></span> <span data-ttu-id="4d16a-104">Este tópico aborda a segurança de mensagem e os motivos para usá-lo.</span><span class="sxs-lookup"><span data-stu-id="4d16a-104">This topic discusses message security and the reasons to use it.</span></span>  
  
## <a name="what-is-message-security"></a><span data-ttu-id="4d16a-105">O que é a segurança de mensagem?</span><span class="sxs-lookup"><span data-stu-id="4d16a-105">What Is Message Security?</span></span>  
 <span data-ttu-id="4d16a-106">Segurança de mensagem usa a especificação WS-Security para proteger as mensagens.</span><span class="sxs-lookup"><span data-stu-id="4d16a-106">Message security uses the WS-Security specification to secure messages.</span></span> <span data-ttu-id="4d16a-107">O WS-Securityspecification descreve aprimoramentos para garantir a confidencialidade, integridade e autenticação no nível da mensagem SOAP (em vez de nível de transporte) de mensagens SOAP.</span><span class="sxs-lookup"><span data-stu-id="4d16a-107">The WS-Securityspecification describes enhancements to SOAP messaging to ensure confidentiality, integrity, and authentication at the SOAP message level (instead of the transport level).</span></span>  
  
 <span data-ttu-id="4d16a-108">Em suma, segurança de mensagem é diferente da segurança de transporte, encapsulando as credenciais de segurança e declarações com cada mensagem junto com qualquer proteção de mensagem (assinatura ou criptografia).</span><span class="sxs-lookup"><span data-stu-id="4d16a-108">In brief, message security differs from transport security by encapsulating the security credentials and claims with every message along with any message protection (signing or encryption).</span></span> <span data-ttu-id="4d16a-109">Aplicar a segurança diretamente para a mensagem modificando seu conteúdo permite que a mensagem protegida seja contendo automaticamente em relação aos aspectos de segurança.</span><span class="sxs-lookup"><span data-stu-id="4d16a-109">Applying the security directly to the message by modifying its content allows the secured message to be self-containing with respect to the security aspects.</span></span> <span data-ttu-id="4d16a-110">Isso permite que alguns cenários que não são possíveis quando a segurança de transporte é usada.</span><span class="sxs-lookup"><span data-stu-id="4d16a-110">This enables some scenarios that are not possible when transport security is used.</span></span>  
  
## <a name="reasons-to-use-message-security"></a><span data-ttu-id="4d16a-111">Razões para usar segurança de mensagem</span><span class="sxs-lookup"><span data-stu-id="4d16a-111">Reasons to Use Message Security</span></span>  
 <span data-ttu-id="4d16a-112">Na segurança em nível de mensagem, todas as informações de segurança são encapsulados na mensagem.</span><span class="sxs-lookup"><span data-stu-id="4d16a-112">In message-level security, all of the security information is encapsulated in the message.</span></span> <span data-ttu-id="4d16a-113">Segurança da mensagem com segurança em nível de mensagem em vez da segurança de nível de transporte tem as seguintes vantagens:</span><span class="sxs-lookup"><span data-stu-id="4d16a-113">Securing the message with message-level security instead of transport-level security has the following advantages:</span></span>  
  
-   <span data-ttu-id="4d16a-114">Segurança de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="4d16a-114">End-to-end security.</span></span> <span data-ttu-id="4d16a-115">Segurança de transporte, como o protocolo (SSL) protege apenas mensagens quando a comunicação ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="4d16a-115">Transport security, such as Secure Sockets Layer (SSL) only secures messages when the communication is point-to-point.</span></span> <span data-ttu-id="4d16a-116">Se a mensagem é roteada para um ou mais intermediários SOAP (por exemplo, um roteador) antes de alcançar o receptor ultimate, a mensagem em si não está protegida quando um intermediário lê-lo da transmissão.</span><span class="sxs-lookup"><span data-stu-id="4d16a-116">If the message is routed to one or more SOAP intermediaries (for example a router) before reaching the ultimate receiver, the message itself is not protected once an intermediary reads it from the wire.</span></span> <span data-ttu-id="4d16a-117">Além disso, as informações de autenticação de cliente estão disponíveis somente para o primeiro intermediário e devem ser transmitidas novamente para o destinatário final na forma de fora da banda, se necessário.</span><span class="sxs-lookup"><span data-stu-id="4d16a-117">Additionally, the client authentication information is available only to the first intermediary and must be re-transmitted to the ultimate receiver in out-of-band fashion, if necessary.</span></span> <span data-ttu-id="4d16a-118">Isso se aplica mesmo se a rota inteira usa segurança SSL entre saltos individuais.</span><span class="sxs-lookup"><span data-stu-id="4d16a-118">This applies even if the entire route uses SSL security between individual hops.</span></span> <span data-ttu-id="4d16a-119">Como a segurança de mensagem trabalha diretamente com a mensagem e protege o XML, a segurança permanece com a mensagem, independentemente de quantas intermediários são envolvidos antes de atingir o destinatário final.</span><span class="sxs-lookup"><span data-stu-id="4d16a-119">Because message security works directly with the message and secures the XML in it, the security stays with the message regardless of how many intermediaries are involved before it reaches the ultimate receiver.</span></span> <span data-ttu-id="4d16a-120">Isso permite que um cenário de segurança ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="4d16a-120">This enables a true end-to-end security scenario.</span></span>  
  
-   <span data-ttu-id="4d16a-121">Maior flexibilidade.</span><span class="sxs-lookup"><span data-stu-id="4d16a-121">Increased flexibility.</span></span> <span data-ttu-id="4d16a-122">Partes da mensagem, em vez da mensagem inteira, podem ser assinadas ou criptografadas.</span><span class="sxs-lookup"><span data-stu-id="4d16a-122">Parts of the message, instead of the entire message, can be signed or encrypted.</span></span> <span data-ttu-id="4d16a-123">Isso significa que intermediários podem exibir as partes da mensagem que se destinam para eles.</span><span class="sxs-lookup"><span data-stu-id="4d16a-123">This means that intermediaries can view the parts of the message that are intended for them.</span></span> <span data-ttu-id="4d16a-124">Se o remetente precisa fazer parte das informações na mensagem visível para os intermediários, mas deseja garantir que ele não foi violado, ele apenas pode assiná-lo, mas deixá-lo sem criptografia.</span><span class="sxs-lookup"><span data-stu-id="4d16a-124">If the sender needs to make part of the information in the message visible to the intermediaries but wants to ensure that it is not tampered with, it can just sign it but leave it unencrypted.</span></span> <span data-ttu-id="4d16a-125">Como a assinatura é parte da mensagem, o destinatário final pode verificar se as informações na mensagem foi recebidas intacta.</span><span class="sxs-lookup"><span data-stu-id="4d16a-125">Since the signature is part of the message, the ultimate receiver can verify that the information in the message was received intact.</span></span> <span data-ttu-id="4d16a-126">Um cenário pode ter um intermediário SOAP mensagem rotas de acordo com o valor do cabeçalho de ação de serviço.</span><span class="sxs-lookup"><span data-stu-id="4d16a-126">One scenario might have a SOAP intermediary service that routes message according the Action header value.</span></span> <span data-ttu-id="4d16a-127">Por padrão, o WCF não criptografa o valor de ação, mas conecta-se a segurança de mensagem é usada.</span><span class="sxs-lookup"><span data-stu-id="4d16a-127">By default, WCF does not encrypt the Action value but signs it if message security is used.</span></span> <span data-ttu-id="4d16a-128">Portanto, essas informações estão disponíveis para todos os intermediários, mas não pode alterá-la.</span><span class="sxs-lookup"><span data-stu-id="4d16a-128">Therefore, this information is available to all intermediaries, but no one can change it.</span></span>  
  
-   <span data-ttu-id="4d16a-129">Suporte para vários transportes.</span><span class="sxs-lookup"><span data-stu-id="4d16a-129">Support for multiple transports.</span></span> <span data-ttu-id="4d16a-130">Você pode enviar mensagens protegidas em muitos transportes diferentes, como pipes nomeados e TCP, sem a necessidade de contar com o protocolo de segurança.</span><span class="sxs-lookup"><span data-stu-id="4d16a-130">You can send secured messages over many different transports, such as named pipes and TCP, without having to rely on the protocol for security.</span></span> <span data-ttu-id="4d16a-131">Com segurança em nível de transporte, todas as informações de segurança tem escopo para uma conexão de transporte particular único e não estão disponíveis para o conteúdo da mensagem.</span><span class="sxs-lookup"><span data-stu-id="4d16a-131">With transport-level security, all the security information is scoped to a single particular transport connection and is not available from the message content itself.</span></span> <span data-ttu-id="4d16a-132">Segurança de mensagem faz com que a mensagem segura, independentemente de qual transporte você use para transmitir a mensagem e o contexto de segurança é inserido diretamente dentro a mensagem.</span><span class="sxs-lookup"><span data-stu-id="4d16a-132">Message security makes the message secure regardless of what transport you use to transmit the message, and the security context is directly embedded inside the message.</span></span>  
  
-   <span data-ttu-id="4d16a-133">Suporte para um amplo conjunto de credenciais e declarações.</span><span class="sxs-lookup"><span data-stu-id="4d16a-133">Support for a wide set of credentials and claims.</span></span> <span data-ttu-id="4d16a-134">A segurança da mensagem é baseada na especificação WS-Security, que fornece uma estrutura extensível capaz de transmitir qualquer tipo de declaração dentro da mensagem SOAP.</span><span class="sxs-lookup"><span data-stu-id="4d16a-134">The message security is based on the WS-Security specification, which provides an extensible framework capable of transmitting any type of claim inside the SOAP message.</span></span> <span data-ttu-id="4d16a-135">Ao contrário de segurança de transporte, o conjunto de mecanismos de autenticação ou declarações, que você pode usar não é limitado pelos recursos de transporte.</span><span class="sxs-lookup"><span data-stu-id="4d16a-135">Unlike transport security, the set of authentication mechanisms, or claims, that you can use is not limited by the transport capabilities.</span></span> <span data-ttu-id="4d16a-136">Segurança de mensagens do WCF inclui vários tipos de declaração e autenticação de transmissão e pode ser estendida para dar suporte a tipos adicionais conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="4d16a-136">WCF message security includes multiple types of authentication and claim transmission and can be extended to support additional types as necessary.</span></span> <span data-ttu-id="4d16a-137">Por esses motivos, já por exemplo, um cenário federado credenciais não é possível sem segurança de mensagem.</span><span class="sxs-lookup"><span data-stu-id="4d16a-137">For those reasons, for example, a federated credentials scenario is not possible without message security.</span></span> <span data-ttu-id="4d16a-138">Para obter mais informações sobre suporte WCF de cenários de federação, consulte [federação e Tokens emitidos](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="4d16a-138">For more information about federation scenarios WCF supports, see [Federation and Issued Tokens](../../../../docs/framework/wcf/feature-details/federation-and-issued-tokens.md).</span></span>  
  
## <a name="how-message-and-transport-security-compare"></a><span data-ttu-id="4d16a-139">Como comparam a mensagem e segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="4d16a-139">How Message and Transport Security Compare</span></span>  
  
### <a name="pros-and-cons-of-transport-level-security"></a><span data-ttu-id="4d16a-140">Prós e contras de segurança em nível de transporte</span><span class="sxs-lookup"><span data-stu-id="4d16a-140">Pros and Cons of Transport-Level Security</span></span>  
 <span data-ttu-id="4d16a-141">Segurança de transporte tem as seguintes vantagens:</span><span class="sxs-lookup"><span data-stu-id="4d16a-141">Transport security has the following advantages:</span></span>  
  
-   <span data-ttu-id="4d16a-142">Não exige que as partes da comunicação entendam os conceitos de segurança de nível de XML.</span><span class="sxs-lookup"><span data-stu-id="4d16a-142">Does not require that the communicating parties understand XML-level security concepts.</span></span> <span data-ttu-id="4d16a-143">Isso pode melhorar a interoperabilidade, por exemplo, quando HTTPS é usado para proteger a comunicação.</span><span class="sxs-lookup"><span data-stu-id="4d16a-143">This can improve the interoperability, for example, when HTTPS is used to secure the communication.</span></span>  
  
-   <span data-ttu-id="4d16a-144">Em geral, melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="4d16a-144">Generally improved performance.</span></span>  
  
-   <span data-ttu-id="4d16a-145">Os aceleradores de hardware estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="4d16a-145">Hardware accelerators are available.</span></span>  
  
-   <span data-ttu-id="4d16a-146">É possível streaming.</span><span class="sxs-lookup"><span data-stu-id="4d16a-146">Streaming is possible.</span></span>  
  
 <span data-ttu-id="4d16a-147">Segurança de transporte tem as seguintes desvantagens:</span><span class="sxs-lookup"><span data-stu-id="4d16a-147">Transport security has the following disadvantages:</span></span>  
  
-   <span data-ttu-id="4d16a-148">Salto-para-hop somente.</span><span class="sxs-lookup"><span data-stu-id="4d16a-148">Hop-to-hop only.</span></span>  
  
-   <span data-ttu-id="4d16a-149">Limitado e inextensible conjunto de credenciais.</span><span class="sxs-lookup"><span data-stu-id="4d16a-149">Limited and inextensible set of credentials.</span></span>  
  
-   <span data-ttu-id="4d16a-150">Dependente de transporte.</span><span class="sxs-lookup"><span data-stu-id="4d16a-150">Transport-dependent.</span></span>  
  
### <a name="disadvantages-of-message-level-security"></a><span data-ttu-id="4d16a-151">Desvantagens de segurança em nível de mensagem</span><span class="sxs-lookup"><span data-stu-id="4d16a-151">Disadvantages of Message-Level Security</span></span>  
 <span data-ttu-id="4d16a-152">Segurança de mensagem tem as seguintes desvantagens:</span><span class="sxs-lookup"><span data-stu-id="4d16a-152">Message security has the following disadvantages:</span></span>  
  
-   <span data-ttu-id="4d16a-153">Desempenho</span><span class="sxs-lookup"><span data-stu-id="4d16a-153">Performance</span></span>  
  
-   <span data-ttu-id="4d16a-154">Não é possível usar o fluxo de mensagem.</span><span class="sxs-lookup"><span data-stu-id="4d16a-154">Cannot use message streaming.</span></span>  
  
-   <span data-ttu-id="4d16a-155">Requer a implementação de mecanismos de segurança de nível de XML e suporte para especificação WS-Security.</span><span class="sxs-lookup"><span data-stu-id="4d16a-155">Requires implementation of XML-level security mechanisms and support for WS-Security specification.</span></span> <span data-ttu-id="4d16a-156">Isso pode afetar a interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="4d16a-156">This might affect the interoperability.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4d16a-157">Consulte também</span><span class="sxs-lookup"><span data-stu-id="4d16a-157">See Also</span></span>  
 [<span data-ttu-id="4d16a-158">Protegendo serviços e clientes</span><span class="sxs-lookup"><span data-stu-id="4d16a-158">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)  
 [<span data-ttu-id="4d16a-159">Segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="4d16a-159">Transport Security</span></span>](../../../../docs/framework/wcf/feature-details/transport-security.md)  
 [<span data-ttu-id="4d16a-160">Como usar a segurança do transporte e as credenciais de mensagem</span><span class="sxs-lookup"><span data-stu-id="4d16a-160">How to: Use Transport Security and Message Credentials</span></span>](../../../../docs/framework/wcf/feature-details/how-to-use-transport-security-and-message-credentials.md)  
 [<span data-ttu-id="4d16a-161">Microsoft padrões e práticas recomendadas, capítulo 3: segurança de camada de transporte de implementação e de mensagem</span><span class="sxs-lookup"><span data-stu-id="4d16a-161">Microsoft Patterns and Practices, Chapter 3: Implementing Transport and Message Layer Security</span></span>](http://go.microsoft.com/fwlink/?LinkId=88897)
