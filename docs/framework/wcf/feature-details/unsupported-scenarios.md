---
title: "Cenários sem suporte"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 72027d0f-146d-40c5-9d72-e94392c8bb40
caps.latest.revision: "43"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 3bb2646a500db299f164dce34fb062a509f90047
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/02/2017
---
# <a name="unsupported-scenarios"></a><span data-ttu-id="5824f-102">Cenários sem suporte</span><span class="sxs-lookup"><span data-stu-id="5824f-102">Unsupported Scenarios</span></span>
<span data-ttu-id="5824f-103">Por várias razões, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] não oferece suporte a alguns cenários de segurança específico.</span><span class="sxs-lookup"><span data-stu-id="5824f-103">For various reasons, [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] does not support some specific security scenarios.</span></span> <span data-ttu-id="5824f-104">Por exemplo, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition não implementa os protocolos de autenticação SSPI ou Kerberos e, portanto, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] não oferece suporte à execução de um serviço com a autenticação do Windows nessa plataforma.</span><span class="sxs-lookup"><span data-stu-id="5824f-104">For example, [!INCLUDE[wxp](../../../../includes/wxp-md.md)] Home Edition does not implement the SSPI or Kerberos authentication protocols, and therefore [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support running a service with Windows authentication on that platform.</span></span> <span data-ttu-id="5824f-105">Outros mecanismos de autenticação, como nome de usuário/senha e a autenticação integrada do HTTP/HTTPS são suportados ao executar [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] no Windows XP Home Edition.</span><span class="sxs-lookup"><span data-stu-id="5824f-105">Other authentication mechanisms, such as username/password and HTTP/HTTPS integrated authentication are supported when running [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] under Windows XP Home Edition.</span></span>  
  
## <a name="impersonation-scenarios"></a><span data-ttu-id="5824f-106">Cenários de representação</span><span class="sxs-lookup"><span data-stu-id="5824f-106">Impersonation Scenarios</span></span>  
  
### <a name="impersonated-identity-might-not-flow-when-clients-make-asynchronous-calls"></a><span data-ttu-id="5824f-107">Identidade representada não pode fluir quando os clientes fazem chamadas assíncronas</span><span class="sxs-lookup"><span data-stu-id="5824f-107">Impersonated Identity Might Not Flow When Clients Make Asynchronous Calls</span></span>  
 <span data-ttu-id="5824f-108">Quando um cliente WCF faz chamadas assíncronas para um serviço WCF usando a autenticação do Windows em representação, autenticação pode ocorrer com a identidade do processo de cliente em vez da identidade representada.</span><span class="sxs-lookup"><span data-stu-id="5824f-108">When a WCF client makes asynchronous calls to a WCF service using Windows authentication under impersonation, authentication might occur with the identity of the client process instead of the impersonated identity.</span></span>  
  
### <a name="windows-xp-and-secure-context-token-cookie-enabled"></a><span data-ttu-id="5824f-109">Windows XP e o Cookie de Token de contexto de segurança habilitado</span><span class="sxs-lookup"><span data-stu-id="5824f-109">Windows XP and Secure Context Token Cookie Enabled</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-110">não dá suporte à representação e um <xref:System.InvalidOperationException> é lançada quando existem as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="5824f-110"> does not support impersonation and an <xref:System.InvalidOperationException> is thrown when the following conditions exist:</span></span>  
  
-   <span data-ttu-id="5824f-111">O sistema operacional é [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5824f-111">The operating system is [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
-   <span data-ttu-id="5824f-112">O modo de autenticação resulta em uma identidade do Windows.</span><span class="sxs-lookup"><span data-stu-id="5824f-112">The authentication mode results in a Windows identity.</span></span>  
  
-   <span data-ttu-id="5824f-113">A propriedade <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> do <xref:System.ServiceModel.OperationBehaviorAttribute> é definida como <xref:System.ServiceModel.ImpersonationOption.Required>.</span><span class="sxs-lookup"><span data-stu-id="5824f-113">The <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property of the <xref:System.ServiceModel.OperationBehaviorAttribute> is set to <xref:System.ServiceModel.ImpersonationOption.Required>.</span></span>  
  
-   <span data-ttu-id="5824f-114">Um token de contexto de segurança com base em estado (SCT) é criado (por padrão, a criação está desabilitada).</span><span class="sxs-lookup"><span data-stu-id="5824f-114">A state-based security context token (SCT) is created (by default, creation is disabled).</span></span>  
  
 <span data-ttu-id="5824f-115">O SCT baseadas em estado só pode ser criado usando uma associação personalizada.</span><span class="sxs-lookup"><span data-stu-id="5824f-115">The state-based SCT can only be created using a custom binding.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="5824f-116">[Como: criar um contexto de segurança para uma sessão segura Token](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) No código, o token é habilitado por meio da criação de um elemento de associação de segurança (o <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> ou <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) usando o <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> ou o <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> método e configuração de `requireCancellation` parâmetro para `false`.</span><span class="sxs-lookup"><span data-stu-id="5824f-116"> [How to: Create a Security Context Token for a Secure Session](../../../../docs/framework/wcf/feature-details/how-to-create-a-security-context-token-for-a-secure-session.md).) In code, the token is enabled by creating a security binding element (either <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> or <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement>) using the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSspiNegotiationBindingElement%28System.Boolean%29?displayProperty=nameWithType> or the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateSecureConversationBindingElement%28System.ServiceModel.Channels.SecurityBindingElement%2CSystem.Boolean%29?displayProperty=nameWithType> method and setting the `requireCancellation` parameter to `false`.</span></span> <span data-ttu-id="5824f-117">O parâmetro refere-se ao cache do SCT.</span><span class="sxs-lookup"><span data-stu-id="5824f-117">The parameter refers to the caching of the SCT.</span></span> <span data-ttu-id="5824f-118">Definir o valor como `false` habilita o recurso SCT baseadas em estado.</span><span class="sxs-lookup"><span data-stu-id="5824f-118">Setting the value to `false` enables the state-based SCT feature.</span></span>  
  
 <span data-ttu-id="5824f-119">Como alternativa, na configuração, o token é habilitado por meio da criação um <`customBinding`>, adicionando um <`security`> elemento e configuração de `authenticationMode` atributo SecureConversation e o `requireSecurityContextCancellation` atributo `true`.</span><span class="sxs-lookup"><span data-stu-id="5824f-119">Alternatively, in configuration, the token is enabled by creating a <`customBinding`>, then adding a <`security`> element, and setting the `authenticationMode` attribute to SecureConversation and the `requireSecurityContextCancellation` attribute to `true`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5824f-120">Os requisitos acima são específicos.</span><span class="sxs-lookup"><span data-stu-id="5824f-120">The preceding requirements are specific.</span></span> <span data-ttu-id="5824f-121">Por exemplo, o <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> cria um elemento de associação que resulta em uma identidade do Windows, mas não estabelece um SCT.</span><span class="sxs-lookup"><span data-stu-id="5824f-121">For example, the <xref:System.ServiceModel.Channels.SecurityBindingElement.CreateKerberosBindingElement%2A> creates a binding element that results in a Windows identity, but does not establish an SCT.</span></span> <span data-ttu-id="5824f-122">Portanto, você pode usá-lo com o `Required` opção [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5824f-122">Therefore, you can use it with the `Required` option on [!INCLUDE[wxp](../../../../includes/wxp-md.md)].</span></span>  
  
### <a name="possible-aspnet-conflict"></a><span data-ttu-id="5824f-123">Possíveis conflitos de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="5824f-123">Possible ASP.NET Conflict</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-124">e [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] podem habilitar ou desabilitar a representação.</span><span class="sxs-lookup"><span data-stu-id="5824f-124"> and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] can both enable or disable impersonation.</span></span> <span data-ttu-id="5824f-125">Quando [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] hosts um [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] aplicativo, um conflito pode existir entre o [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] definições de configuração.</span><span class="sxs-lookup"><span data-stu-id="5824f-125">When [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] hosts an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] application, a conflict may exist between the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] configuration settings.</span></span> <span data-ttu-id="5824f-126">Em caso de conflito, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] configuração terá precedência, a menos que o <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> está definida como <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, caso em que o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] representação configuração terá precedência.</span><span class="sxs-lookup"><span data-stu-id="5824f-126">In case of conflict, the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] setting takes precedence, unless the <xref:System.ServiceModel.OperationBehaviorAttribute.Impersonation%2A> property is set to <xref:System.ServiceModel.ImpersonationOption.NotAllowed>, in which case the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation setting takes precedence.</span></span>  
  
### <a name="assembly-loads-may-fail-under-impersonation"></a><span data-ttu-id="5824f-127">Cargas de assembly podem falhar em representação</span><span class="sxs-lookup"><span data-stu-id="5824f-127">Assembly Loads May Fail Under Impersonation</span></span>  
 <span data-ttu-id="5824f-128">Se o contexto representado não tem direitos de acesso para carregar um assembly e se for a primeira vez que o common language runtime (CLR) está tentando carregar o assembly para AppDomain, o <xref:System.AppDomain> armazena em cache a falha.</span><span class="sxs-lookup"><span data-stu-id="5824f-128">If the impersonated context does not have access rights to load an assembly and if it is the first time the common language runtime (CLR) is attempting to load the assembly for that AppDomain, the <xref:System.AppDomain> caches the failure.</span></span> <span data-ttu-id="5824f-129">Falha nas tentativas subsequentes de carregar o assembly (ou assemblies), mesmo depois de reverter a representação e até mesmo se o contexto revertido tem direitos de acesso para carregar o assembly.</span><span class="sxs-lookup"><span data-stu-id="5824f-129">Subsequent attempts to load that assembly (or assemblies) fail, even after reverting the impersonation, and even if the reverted context has access rights to load the assembly.</span></span> <span data-ttu-id="5824f-130">Isso ocorre porque o CLR não tenta novamente a carga depois que o contexto de usuário é alterado.</span><span class="sxs-lookup"><span data-stu-id="5824f-130">This is because the CLR does not re-attempt the load after the user context is changed.</span></span> <span data-ttu-id="5824f-131">Você deve reiniciar o domínio do aplicativo para se recuperar da falha.</span><span class="sxs-lookup"><span data-stu-id="5824f-131">You must restart the application domain to recover from the failure.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5824f-132">O valor padrão para o <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> propriedade o <xref:System.ServiceModel.Security.WindowsClientCredential> classe é <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span><span class="sxs-lookup"><span data-stu-id="5824f-132">The default value for the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class is <xref:System.Security.Principal.TokenImpersonationLevel.Identification>.</span></span> <span data-ttu-id="5824f-133">Na maioria dos casos, um contexto de representação de nível de identificação não tem direitos para carregar todos os assemblies adicionais.</span><span class="sxs-lookup"><span data-stu-id="5824f-133">In most cases, an identification-level impersonation context has no rights to load any additional assemblies.</span></span> <span data-ttu-id="5824f-134">Este é o valor padrão, portanto, esta é uma condição muito comuns a serem consideradas.</span><span class="sxs-lookup"><span data-stu-id="5824f-134">This is the default value, so this is a very common condition to be aware of.</span></span> <span data-ttu-id="5824f-135">Representação de nível de identificação também ocorre quando o processo de representação não tiver o `SeImpersonate` privilégio.</span><span class="sxs-lookup"><span data-stu-id="5824f-135">Identification-level impersonation also occurs when the impersonating process does not have the `SeImpersonate` privilege.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="5824f-136">[Delegação e representação](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="5824f-136"> [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
### <a name="delegation-requires-credential-negotiation"></a><span data-ttu-id="5824f-137">A delegação exige a negociação de credencial</span><span class="sxs-lookup"><span data-stu-id="5824f-137">Delegation Requires Credential Negotiation</span></span>  
 <span data-ttu-id="5824f-138">Para usar o protocolo de autenticação Kerberos com delegação, você deve implementar o protocolo Kerberos com a negociação de credencial (às vezes chamada de Kerberos vários trecho ou várias etapas).</span><span class="sxs-lookup"><span data-stu-id="5824f-138">To use the Kerberos authentication protocol with delegation, you must implement the Kerberos protocol with credential negotiation (sometimes called multi-leg or multi-step Kerberos).</span></span> <span data-ttu-id="5824f-139">Se você implementar a autenticação Kerberos sem negociação de credencial (às vezes chamada de Kerberos única ou segmento único), uma exceção será lançada.</span><span class="sxs-lookup"><span data-stu-id="5824f-139">If you implement Kerberos authentication without credential negotiation (sometimes called one-shot or single-leg Kerberos), an exception is thrown.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="5824f-140">como implementar a negociação de credencial, consulte [depurando erros de autenticação do Windows](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span><span class="sxs-lookup"><span data-stu-id="5824f-140"> how to implement credential negotiation, see [Debugging Windows Authentication Errors](../../../../docs/framework/wcf/feature-details/debugging-windows-authentication-errors.md).</span></span>  
  
## <a name="cryptography"></a><span data-ttu-id="5824f-141">Criptografia</span><span class="sxs-lookup"><span data-stu-id="5824f-141">Cryptography</span></span>  
  
### <a name="sha-256-supported-only-for-symmetric-key-usages"></a><span data-ttu-id="5824f-142">SHA-256 tem suportada apenas para os usos de chave simétricos</span><span class="sxs-lookup"><span data-stu-id="5824f-142">SHA-256 Supported Only for Symmetric Key Usages</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-143">oferece suporte a uma variedade de criptografia e assinatura de criação de algoritmos de compilação que você pode especificar usando o conjunto de algoritmos nas associações fornecidas pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="5824f-143"> supports a variety of encryption and signature digest creation algorithms that you can specify using the algorithm suite in the system-provided bindings.</span></span> <span data-ttu-id="5824f-144">Para maior segurança, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] dá suporte a algoritmos de Secure Hash Algorithm (SHA) 2, especificamente SHA-256, para criar hashes de resumo da assinatura.</span><span class="sxs-lookup"><span data-stu-id="5824f-144">For improved security, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] supports Secure Hash Algorithm (SHA) 2 algorithms, specifically SHA-256, for creating signature digest hashes.</span></span> <span data-ttu-id="5824f-145">Esta versão dá suporte a SHA-256 somente para usos de chave simétricos, tais como chaves de Kerberos, e onde um certificado x. 509 não é usado para assinar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="5824f-145">This release supports SHA-256 only for symmetric key usages, such as Kerberos keys, and where an X.509 certificate is not used to sign the message.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-146">não oferece suporte a assinaturas RSA (usadas em certificados x. 509) usando o hash SHA-256 devido à falta de suporte atual para RSA-SHA256 no [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5824f-146"> does not support RSA signatures (used in X.509 certificates) using SHA-256 hash due to the current lack of support for RSA-SHA256 in the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span></span>  
  
### <a name="fips-compliant-sha-256-hashes-not-supported"></a><span data-ttu-id="5824f-147">Compatível com FIPS hash SHA-256 não tem suportada</span><span class="sxs-lookup"><span data-stu-id="5824f-147">FIPS-Compliant SHA-256 Hashes not Supported</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-148">não suporta compatível com FIPS SHA-256 hashes, portanto não há suporte para pacotes de algoritmo que usam o SHA-256 por [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] em sistemas em que é necessário o uso de algoritmos compatíveis com FIPS.</span><span class="sxs-lookup"><span data-stu-id="5824f-148"> does not support SHA-256 FIPS-compliant hashes, so algorithm suites that use SHA-256 are not supported by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] on systems where use of FIPS compliant algorithms is required.</span></span>  
  
### <a name="fips-compliant-algorithms-may-fail-if-registry-is-edited"></a><span data-ttu-id="5824f-149">Algoritmos compatíveis com FIPS podem falhar se o registro está sendo editado</span><span class="sxs-lookup"><span data-stu-id="5824f-149">FIPS-Compliant Algorithms May Fail if Registry Is Edited</span></span>  
 <span data-ttu-id="5824f-150">Você pode habilitar e desabilitar FIPS Federal Information Processing Standards () - algoritmos compatíveis com usando o snap Local segurança configurações Microsoft Management Console (MMC) - no.</span><span class="sxs-lookup"><span data-stu-id="5824f-150">You can enable and disable Federal Information Processing Standards (FIPS)-compliant algorithms by using the Local Security Settings Microsoft Management Console (MMC) snap-in.</span></span> <span data-ttu-id="5824f-151">Você também pode acessar a configuração no registro.</span><span class="sxs-lookup"><span data-stu-id="5824f-151">You can also access the setting in the registry.</span></span> <span data-ttu-id="5824f-152">No entanto, observe que [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] não dá suporte ao uso do registro para redefinir a configuração.</span><span class="sxs-lookup"><span data-stu-id="5824f-152">Note, however, that [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support using the registry to reset the setting.</span></span> <span data-ttu-id="5824f-153">Se o valor é definido como qualquer coisa diferente de 1 ou 0, podem ocorrer resultados inconsistentes entre o CLR e o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="5824f-153">If the value is set to anything other than 1 or 0, inconsistent results can occur between the CLR and the operating system.</span></span>  
  
### <a name="fips-compliant-aes-encryption-limitation"></a><span data-ttu-id="5824f-154">Limitação de criptografia AES compatível com FIPS</span><span class="sxs-lookup"><span data-stu-id="5824f-154">FIPS-Compliant AES Encryption Limitation</span></span>  
 <span data-ttu-id="5824f-155">Criptografia de AES compatível com FIPS não funciona em retornos de chamada duplex na representação de nível de identificação.</span><span class="sxs-lookup"><span data-stu-id="5824f-155">FIPS compliant AES encryption does not work in duplex callbacks under identification level impersonation.</span></span>  
  
### <a name="cngksp-certificates"></a><span data-ttu-id="5824f-156">Certificados CNG/KSP</span><span class="sxs-lookup"><span data-stu-id="5824f-156">CNG/KSP Certificates</span></span>  
 <span data-ttu-id="5824f-157">*: API geração CNG (Cryptography Next)* é a substituição de longo prazo para o CryptoAPI.</span><span class="sxs-lookup"><span data-stu-id="5824f-157">*Cryptography API: Next Generation (CNG)* is the long-term replacement for the CryptoAPI.</span></span> <span data-ttu-id="5824f-158">Esta API está disponível em código não gerenciado em [!INCLUDE[wv](../../../../includes/wv-md.md)], [!INCLUDE[lserver](../../../../includes/lserver-md.md)] e versões posteriores do Windows.</span><span class="sxs-lookup"><span data-stu-id="5824f-158">This API is available in unmanaged code on [!INCLUDE[wv](../../../../includes/wv-md.md)],  [!INCLUDE[lserver](../../../../includes/lserver-md.md)] and later Windows versions.</span></span>  
  
 <span data-ttu-id="5824f-159">.NET framework 4.6.1 e versões anteriores não dão suporte a esses certificados porque eles usam o CryptoAPI herdado para lidar com certificados CNG/KSP.</span><span class="sxs-lookup"><span data-stu-id="5824f-159">.NET Framework 4.6.1 and earlier versions do not support these certificates because they use the legacy CryptoAPI to handle CNG/KSP certificates.</span></span> <span data-ttu-id="5824f-160">O uso desses certificados com o .NET Framework 4.6.1 e versões anteriores fará com que uma exceção.</span><span class="sxs-lookup"><span data-stu-id="5824f-160">The use of these certificates with   .NET Framework 4.6.1 and earlier versions will cause an exception.</span></span>  
  
 <span data-ttu-id="5824f-161">Há duas maneiras de saber se um certificado usa o KSP:</span><span class="sxs-lookup"><span data-stu-id="5824f-161">There are two possible ways to tell if a certificate uses KSP:</span></span>  
  
-   <span data-ttu-id="5824f-162">Fazer um `p/invoke` de `CertGetCertificateContextProperty`e inspecionar `dwProvType` no `CertGetCertificateContextProperty`.</span><span class="sxs-lookup"><span data-stu-id="5824f-162">Do a `p/invoke` of `CertGetCertificateContextProperty`, and inspect `dwProvType` on the returned `CertGetCertificateContextProperty`.</span></span>  
  
-   <span data-ttu-id="5824f-163">Use o `certutil` comando da linha de comando de consulta de certificados.</span><span class="sxs-lookup"><span data-stu-id="5824f-163">Use the  `certutil` command from the command line for querying certificates.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="5824f-164">[Tarefas do Certutil para solucionar problemas de certificados](http://go.microsoft.com/fwlink/?LinkId=120056).</span><span class="sxs-lookup"><span data-stu-id="5824f-164"> [Certutil tasks for troubleshooting certificates](http://go.microsoft.com/fwlink/?LinkId=120056).</span></span>  
  
## <a name="message-security-fails-if-using-aspnet-impersonation-and-aspnet-compatibility-is-required"></a><span data-ttu-id="5824f-165">Falha de segurança de mensagem se é necessário usar a representação do ASP.NET e compatibilidade com ASP.NET</span><span class="sxs-lookup"><span data-stu-id="5824f-165">Message Security Fails if Using ASP.NET Impersonation and ASP.NET Compatibility Is Required</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-166">não oferece suporte a seguinte combinação de configurações, porque eles podem impedir que a autenticação do cliente ocorra:</span><span class="sxs-lookup"><span data-stu-id="5824f-166"> does not support the following combination of settings because they can prevent client authentication from occurring:</span></span>  
  
-   [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]<span data-ttu-id="5824f-167">Representação está habilitada.</span><span class="sxs-lookup"><span data-stu-id="5824f-167"> Impersonation is enabled.</span></span> <span data-ttu-id="5824f-168">Isso é feito no arquivo Web. config, definindo o `impersonate` atributo do <`identity`> elemento `true`.</span><span class="sxs-lookup"><span data-stu-id="5824f-168">This is done in the Web.config file by setting the `impersonate` attribute of the <`identity`> element to `true`.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]<span data-ttu-id="5824f-169">modo de compatibilidade é habilitado definindo o `aspNetCompatibilityEnabled` atributo do [ \<serviceHostingEnvironment >](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) para `true`.</span><span class="sxs-lookup"><span data-stu-id="5824f-169"> compatibility mode is enabled by setting the `aspNetCompatibilityEnabled` attribute of the [\<serviceHostingEnvironment>](../../../../docs/framework/configure-apps/file-schema/wcf/servicehostingenvironment.md) to `true`.</span></span>  
  
-   <span data-ttu-id="5824f-170">Segurança de modo de mensagem é usada.</span><span class="sxs-lookup"><span data-stu-id="5824f-170">Message mode security is used.</span></span>  
  
 <span data-ttu-id="5824f-171">A solução é desativar o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] modo de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="5824f-171">The work-around is to turn off the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode.</span></span> <span data-ttu-id="5824f-172">Ou, se o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] modo de compatibilidade é necessário, desative o [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] recurso de representação e use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-fornecida a representação em vez disso.</span><span class="sxs-lookup"><span data-stu-id="5824f-172">Or, if the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] compatibility mode is required, disable the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] impersonation feature and use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-provided impersonation instead.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="5824f-173">[Delegação e representação](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="5824f-173"> [Delegation and Impersonation](../../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="ipv6-literal-address-failure"></a><span data-ttu-id="5824f-174">Falha de Literal de endereço IPv6</span><span class="sxs-lookup"><span data-stu-id="5824f-174">IPv6 Literal Address Failure</span></span>  
 <span data-ttu-id="5824f-175">Solicitações de segurança falharem quando o cliente e o serviço estiverem no mesmo computador, e os endereços IPv6 literais são usados para o serviço.</span><span class="sxs-lookup"><span data-stu-id="5824f-175">Security requests fail when the client and service are on the same machine, and IPv6 literal addresses are used for the service.</span></span>  
  
 <span data-ttu-id="5824f-176">Literal IPv6 endereços trabalho se o cliente e serviço estão em computadores diferentes.</span><span class="sxs-lookup"><span data-stu-id="5824f-176">Literal IPv6 addresses work if the service and client are on different machines.</span></span>  
  
## <a name="wsdl-retrieval-failures-with-federated-trust"></a><span data-ttu-id="5824f-177">Falhas de recuperação de WSDL com confiança federada</span><span class="sxs-lookup"><span data-stu-id="5824f-177">WSDL Retrieval Failures with Federated Trust</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="5824f-178">requer exatamente um documento WSDL para cada nó da cadeia de confiança federada.</span><span class="sxs-lookup"><span data-stu-id="5824f-178"> requires exactly one WSDL document for each node in the federated trust chain.</span></span> <span data-ttu-id="5824f-179">Tenha cuidado para não configurar um loop ao especificar pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="5824f-179">Be careful not to set up a loop when specifying endpoints.</span></span> <span data-ttu-id="5824f-180">Uma maneira em que podem surgir loops está usando um download WSDL cadeias de relação de confiança federada com dois ou mais links no mesmo documento WSDL.</span><span class="sxs-lookup"><span data-stu-id="5824f-180">One way in which loops can arise is using a WSDL download of federated trust chains with two or more links in the same WSDL document.</span></span> <span data-ttu-id="5824f-181">Um cenário comum que pode produzir esse problema é um serviço federado em que o servidor de Token de segurança e o serviço estão contidos dentro do mesmo ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="5824f-181">A common scenario that can produce this problem is a federated service where the Security Token Server and the service are contained inside the same ServiceHost.</span></span>  
  
 <span data-ttu-id="5824f-182">Um exemplo dessa situação é um serviço com três endereços de ponto de extremidade a seguir:</span><span class="sxs-lookup"><span data-stu-id="5824f-182">An example of this situation is a service with the following three endpoint addresses:</span></span>  
  
-   <span data-ttu-id="5824f-183">http://localhost/CalculatorService/Service (serviço)</span><span class="sxs-lookup"><span data-stu-id="5824f-183">http://localhost/CalculatorService/service (the service)</span></span>  
  
-   <span data-ttu-id="5824f-184">http://localhost/CalculatorService/issue_ticket (STS)</span><span class="sxs-lookup"><span data-stu-id="5824f-184">http://localhost/CalculatorService/issue_ticket (the STS)</span></span>  
  
-   <span data-ttu-id="5824f-185">http://localhost/CalculatorService/mex (o ponto de extremidade de metadados)</span><span class="sxs-lookup"><span data-stu-id="5824f-185">http://localhost/CalculatorService/mex (the metadata endpoint)</span></span>  
  
 <span data-ttu-id="5824f-186">Isso gera uma exceção.</span><span class="sxs-lookup"><span data-stu-id="5824f-186">This throws an exception.</span></span>  
  
 <span data-ttu-id="5824f-187">Você pode fazer neste cenário de trabalho colocando o `issue_ticket` ponto de extremidade em outro lugar.</span><span class="sxs-lookup"><span data-stu-id="5824f-187">You can make this scenario work by putting the `issue_ticket` endpoint elsewhere.</span></span>  
  
## <a name="wsdl-import-attributes-can-be-lost"></a><span data-ttu-id="5824f-188">Atributos de importação WSDL pode ser perdido</span><span class="sxs-lookup"><span data-stu-id="5824f-188">WSDL Import Attributes can be Lost</span></span>  
 <span data-ttu-id="5824f-189">WCF perde o controle dos atributos em uma `<wst:Claims>` elemento em um `RST` modelo ao executar uma importação WSDL.</span><span class="sxs-lookup"><span data-stu-id="5824f-189">WCF loses track of the attributes on a `<wst:Claims>` element in an `RST` template when doing a WSDL import.</span></span> <span data-ttu-id="5824f-190">Isso ocorre durante uma importação WSDL, se você especificar `<Claims>` diretamente no `WSFederationHttpBinding.Security.Message.TokenRequestParameters` ou `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` em vez de usar as coleções de tipo de declaração diretamente.</span><span class="sxs-lookup"><span data-stu-id="5824f-190">This happens during a WSDL import if you specify `<Claims>` directly in `WSFederationHttpBinding.Security.Message.TokenRequestParameters` or `IssuedSecurityTokenRequestParameters.AdditionalRequestParameters` instead of using the claim type collections directly.</span></span>  <span data-ttu-id="5824f-191">Desde que a importação perde os atributos, a associação não ida e volta corretamente através de WSDL e, portanto, está incorreta no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="5824f-191">Since the import loses the attributes, the binding does not round trip properly through WSDL and hence is incorrect on the client side.</span></span>  
  
 <span data-ttu-id="5824f-192">A correção é modificar a associação diretamente no cliente depois de fazer a importação.</span><span class="sxs-lookup"><span data-stu-id="5824f-192">The fix is to modify the binding directly on the client after doing the import.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5824f-193">Consulte também</span><span class="sxs-lookup"><span data-stu-id="5824f-193">See Also</span></span>  
 [<span data-ttu-id="5824f-194">Considerações sobre segurança</span><span class="sxs-lookup"><span data-stu-id="5824f-194">Security Considerations</span></span>](../../../../docs/framework/wcf/feature-details/security-considerations-in-wcf.md)  
 [<span data-ttu-id="5824f-195">Divulgação de informações</span><span class="sxs-lookup"><span data-stu-id="5824f-195">Information Disclosure</span></span>](../../../../docs/framework/wcf/feature-details/information-disclosure.md)  
 [<span data-ttu-id="5824f-196">Elevação de privilégio</span><span class="sxs-lookup"><span data-stu-id="5824f-196">Elevation of Privilege</span></span>](../../../../docs/framework/wcf/feature-details/elevation-of-privilege.md)  
 [<span data-ttu-id="5824f-197">Negação de serviço</span><span class="sxs-lookup"><span data-stu-id="5824f-197">Denial of Service</span></span>](../../../../docs/framework/wcf/feature-details/denial-of-service.md)  
 [<span data-ttu-id="5824f-198">Violação</span><span class="sxs-lookup"><span data-stu-id="5824f-198">Tampering</span></span>](../../../../docs/framework/wcf/feature-details/tampering.md)  
 [<span data-ttu-id="5824f-199">Ataques de repetição</span><span class="sxs-lookup"><span data-stu-id="5824f-199">Replay Attacks</span></span>](../../../../docs/framework/wcf/feature-details/replay-attacks.md)
