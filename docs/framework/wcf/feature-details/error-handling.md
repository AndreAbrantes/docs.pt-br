---
title: Tratamento de erros
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c948841a-7db9-40ae-9b78-587d216cbcaf
caps.latest.revision: "3"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 215fb30772e4f1b25e20303b3f83d6fe0c00ebae
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/02/2017
---
# <a name="error-handling"></a><span data-ttu-id="a9aba-102">Tratamento de erros</span><span class="sxs-lookup"><span data-stu-id="a9aba-102">Error handling</span></span>
## <a name="error-handling-in-windows-communication-foundation"></a><span data-ttu-id="a9aba-103">Tratamento de erro no Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="a9aba-103">Error Handling in Windows Communication Foundation</span></span>  
 <span data-ttu-id="a9aba-104">Quando um serviço encontra um erro ou exceção inesperada, há várias maneiras de desenvolver uma solução de tratamento de exceção.</span><span class="sxs-lookup"><span data-stu-id="a9aba-104">When a service encounters an unexpected exception or error, there are multiple ways to design an exception-handling solution.</span></span> <span data-ttu-id="a9aba-105">Embora não haja nenhum único "correto" ou "prática recomendada" tratamento de erros solução, há diversos caminhos válidos para um considerar.</span><span class="sxs-lookup"><span data-stu-id="a9aba-105">While there is no single "correct" or "best practice" error-handling solution, there are multiple valid paths for one to consider.</span></span> <span data-ttu-id="a9aba-106">Normalmente é recomendável que um implementar uma solução híbrida que combina várias abordagens da lista abaixo, dependendo da complexidade da implementação de WCF, o tipo e a frequência das exceções, o manipulada versus natureza sem tratamento das exceções e qualquer associada rastreamento, log ou requisitos de política.</span><span class="sxs-lookup"><span data-stu-id="a9aba-106">It is normally recommended that one implement a hybrid solution that combines multiple approaches from the list below, depending on the complexity of the WCF implementation, the type and frequency of the exceptions, the handled vs. unhandled nature of the exceptions, and any associated tracing, logging, or policy requirements.</span></span>  
  
 <span data-ttu-id="a9aba-107">Essas soluções são explicadas mais profundamente no restante desta seção.</span><span class="sxs-lookup"><span data-stu-id="a9aba-107">These solutions are explained more deeply in the rest of this section.</span></span>  
  
### <a name="the-microsoft-enterprise-library"></a><span data-ttu-id="a9aba-108">O Microsoft Enterprise Library</span><span class="sxs-lookup"><span data-stu-id="a9aba-108">The Microsoft Enterprise Library</span></span>  
 <span data-ttu-id="a9aba-109">O Microsoft Enterprise Library Exception Handling Application Block ajuda a implementar os padrões comuns de design e criar uma estratégia consistente de processamento de exceções que ocorrem em todas as camadas de arquitetura de um aplicativo corporativo.</span><span class="sxs-lookup"><span data-stu-id="a9aba-109">The Microsoft Enterprise Library Exception Handling Application Block helps implement common design patterns and create a consistent strategy for processing exceptions that occur in all architectural layers of an enterprise application.</span></span> <span data-ttu-id="a9aba-110">Ele foi projetado para dar suporte o código típico contido em instruções de captura em componentes do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a9aba-110">It is designed to support the typical code contained in catch statements in application components.</span></span> <span data-ttu-id="a9aba-111">Em vez de repetir este código (por exemplo, o código que registra informações de exceção) em blocos catch idêntico em um aplicativo, o bloco de aplicativo de tratamento de exceção permite aos desenvolvedores encapsular essa lógica como manipuladores de exceção reutilizáveis.</span><span class="sxs-lookup"><span data-stu-id="a9aba-111">Instead of repeating this code (such as code that logs exception information) in identical catch blocks throughout an application, the Exception Handling Application Block allows developers to encapsulate this logic as reusable exception handlers.</span></span>  
  
 <span data-ttu-id="a9aba-112">Essa biblioteca inclui de-prontos um manipulador de exceção de contrato de falha.</span><span class="sxs-lookup"><span data-stu-id="a9aba-112">This Library includes out-of-the-box a Fault Contract Exception Handler.</span></span> <span data-ttu-id="a9aba-113">Este manipulador de exceção é projetado para uso em limites de serviço do Windows® Communication Foundation (WCF) e gera um novo contrato de falha da exceção.</span><span class="sxs-lookup"><span data-stu-id="a9aba-113">This exception handler is designed for use at Windows® Communication Foundation (WCF) service boundaries, and generates a new Fault Contract from the exception.</span></span>  
  
 <span data-ttu-id="a9aba-114">Blocos de aplicativos visam incorporam práticas recomendadas usadas e fornecer uma abordagem comum para seu aplicativo de tratamento de exceção.</span><span class="sxs-lookup"><span data-stu-id="a9aba-114">Application blocks aim to incorporate commonly used best practices and provide a common approach for exception handling throughout your application.</span></span> <span data-ttu-id="a9aba-115">Por outro lado, manipuladores de erro personalizada e contratos de falha desenvolvidos por conta própria também podem ser muito útil.</span><span class="sxs-lookup"><span data-stu-id="a9aba-115">On the other hand, custom error handlers and fault contracts developed on one’s own can also be very useful.</span></span> <span data-ttu-id="a9aba-116">Por exemplo, manipuladores de erro personalizado fornecem uma excelente oportunidade para promover automaticamente todas as exceções a FaultExceptions e também para adicionar recursos de registro ao seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a9aba-116">For instance, custom error handlers provide an excellent opportunity to automatically promote all exceptions to FaultExceptions and also to add logging capabilities to your application.</span></span>  
  
 <span data-ttu-id="a9aba-117">Para obter mais informações, consulte [Microsoft Enterprise Library](http://msdn.microsoft.com/library/ff632023.aspx).</span><span class="sxs-lookup"><span data-stu-id="a9aba-117">For more information, please see [Microsoft Enterprise Library](http://msdn.microsoft.com/library/ff632023.aspx).</span></span>  
  
### <a name="dealing-with-expected-exceptions"></a><span data-ttu-id="a9aba-118">Lidando com exceções esperadas</span><span class="sxs-lookup"><span data-stu-id="a9aba-118">Dealing with Expected Exceptions</span></span>  
 <span data-ttu-id="a9aba-119">O adequada da ação é capturar exceções esperadas em cada operação ou um ponto de extensibilidade relevantes, decida se pode ser recuperados do e retornar a falha personalizada apropriada em uma FaultException\<T ></span><span class="sxs-lookup"><span data-stu-id="a9aba-119">The proper course of action is to catch expected exceptions in every operation or relevant extensibility point, decide whether they can be recovered from, and return the proper custom fault in a FaultException\<T></span></span>  
  
### <a name="dealing-with-unexpected-exceptions-using-an-ierrorhandler"></a><span data-ttu-id="a9aba-120">Lidando com exceções inesperadas, usando um IErrorHandler</span><span class="sxs-lookup"><span data-stu-id="a9aba-120">Dealing with Unexpected Exceptions using an IErrorHandler</span></span>  
 <span data-ttu-id="a9aba-121">Para lidar com exceções inesperadas, o curso de ação recomendado é um IErrorHandler "conectar".</span><span class="sxs-lookup"><span data-stu-id="a9aba-121">To deal with unexpected exceptions, the recommended course of action is to "hook" an IErrorHandler.</span></span> <span data-ttu-id="a9aba-122">Manipuladores de erro capturam somente exceções no nível de tempo de execução do WCF (a camada de "modelo de serviço"), não na camada do canal.</span><span class="sxs-lookup"><span data-stu-id="a9aba-122">Error handlers only catch exceptions at the WCF runtime level (the "service model" layer), not at the channel layer.</span></span> <span data-ttu-id="a9aba-123">É a única maneira de conectar um IErrorHandler no nível do canal criar um canal personalizado, que não é recomendado na maioria dos cenários.</span><span class="sxs-lookup"><span data-stu-id="a9aba-123">The only way to hook an IErrorHandler at the channel level is to create a custom channel, which is not recommended in most scenarios.</span></span>  
  
 <span data-ttu-id="a9aba-124">"Exceção inesperada" geralmente não é uma exceção irrecuperável nem uma exceção de processamento; ele é, em vez disso, uma exceção inesperada do usuário.</span><span class="sxs-lookup"><span data-stu-id="a9aba-124">An "unexpected exception" is generally neither an irrecoverable exception nor a processing exception; it is, instead, an unexpected user exception.</span></span> <span data-ttu-id="a9aba-125">Uma exceção irrecuperável (por exemplo, uma exceção de falta de memória) – um geralmente tratados pelo [manipulador de exceção de modelo de serviço](http://msdn.microsoft.com/library/system.servicemodel.dispatcher.exceptionhandler.aspx) automaticamente – não é possível geralmente ser controladas muito bem e a única razão para lidar com tal uma exceção em todos os pode ser um log adicional ou para retornar uma exceção padrão para o cliente.</span><span class="sxs-lookup"><span data-stu-id="a9aba-125">An irrecoverable exception (such as an out-of-memory exception) – one generally handled by the [Service Model Exception Handler](http://msdn.microsoft.com/library/system.servicemodel.dispatcher.exceptionhandler.aspx) automatically – cannot generally be handled gracefully, and the only reason to handle such an exception at all may be do additional logging or to return a standard exception to the client.</span></span> <span data-ttu-id="a9aba-126">Uma exceção de processamento ocorre no processamento da mensagem – por exemplo, na serialização, codificador ou nível de formatador – geralmente não pode ser tratada em um IErrorHandler, porque geralmente é muito cedo ou muito tarde para o manipulador de erro intervir por a hora em que essas exceções ocorrem.</span><span class="sxs-lookup"><span data-stu-id="a9aba-126">A processing exception occurs in the processing of the message – for example, at the serialization, encoder, or formatter level – generally cannot be handled at an IErrorHandler, because it is generally either too early or too late for the error handler to intervene by the time these exceptions occur.</span></span> <span data-ttu-id="a9aba-127">Da mesma forma, as exceções de transporte não podem ser tratadas em um IErrorHandler.</span><span class="sxs-lookup"><span data-stu-id="a9aba-127">Similarly, transport exceptions cannot be handled at an IErrorHandler.</span></span>  
  
 <span data-ttu-id="a9aba-128">Com um IErrorHandler, você pode controlar explicitamente o comportamento do seu aplicativo quando uma exceção será lançada.</span><span class="sxs-lookup"><span data-stu-id="a9aba-128">With an IErrorHandler, you can explicitly control the behavior of your application when an exception is thrown.</span></span> <span data-ttu-id="a9aba-129">Você pode:</span><span class="sxs-lookup"><span data-stu-id="a9aba-129">You may:</span></span>  
  
1.  <span data-ttu-id="a9aba-130">Decida se deseja ou não enviar uma falha para o cliente</span><span class="sxs-lookup"><span data-stu-id="a9aba-130">Decide whether or not to send a fault to the client</span></span>  
  
2.  <span data-ttu-id="a9aba-131">Substituir uma exceção com uma falha</span><span class="sxs-lookup"><span data-stu-id="a9aba-131">Replace an exception with a fault</span></span>  
  
3.  <span data-ttu-id="a9aba-132">Substituir uma falha por outra falha</span><span class="sxs-lookup"><span data-stu-id="a9aba-132">Replace a fault with another fault</span></span>  
  
4.  <span data-ttu-id="a9aba-133">Executar o registro em log ou rastreamento</span><span class="sxs-lookup"><span data-stu-id="a9aba-133">Perform logging or tracing</span></span>  
  
5.  <span data-ttu-id="a9aba-134">Realizar outras atividades personalizadas</span><span class="sxs-lookup"><span data-stu-id="a9aba-134">Perform other custom activities</span></span>  
  
 <span data-ttu-id="a9aba-135">Um pode instalar um manipulador de erro personalizado adicionando-o à propriedade ErrorHandlers de distribuidores o canal para o serviço.</span><span class="sxs-lookup"><span data-stu-id="a9aba-135">One can install a custom error handler by adding it to the ErrorHandlers property of the channel dispatchers for your service.</span></span>  <span data-ttu-id="a9aba-136">É possível ter mais de um manipulador de erros e eles são chamados na ordem em que eles são adicionados a esta coleção.</span><span class="sxs-lookup"><span data-stu-id="a9aba-136">It is possible to have more than one error handler and they are called in the order they are added to this collection.</span></span>  
  
 <span data-ttu-id="a9aba-137">IErrorHandler.ProvideFault controla a mensagem de falha é enviada ao cliente.</span><span class="sxs-lookup"><span data-stu-id="a9aba-137">IErrorHandler.ProvideFault controls the fault message that is sent to the client.</span></span> <span data-ttu-id="a9aba-138">Este método é chamado, independentemente do tipo de exceção gerada por uma operação em seu serviço.</span><span class="sxs-lookup"><span data-stu-id="a9aba-138">This method is called regardless of the type of the exception thrown by an operation in your service.</span></span> <span data-ttu-id="a9aba-139">Se nenhuma operação é executada aqui, o WCF assume seu comportamento padrão e continuará como não se houvesse nenhum manipulador de erro personalizada em vigor.</span><span class="sxs-lookup"><span data-stu-id="a9aba-139">If no operation is performed here, WCF assumes its default behaviour and continues as if there were no custom error handlers in place.</span></span>  
  
 <span data-ttu-id="a9aba-140">Uma área que talvez você pode usar essa abordagem é quando você deseja criar um local central para converter exceções em falhas antes de serem enviados ao cliente (garantindo que a instância não é descartada e o canal não é movido para o estado com falha).</span><span class="sxs-lookup"><span data-stu-id="a9aba-140">One area that you could perhaps use this approach is when you want to create a central place for converting exceptions to faults before they are sent to the client (ensuring that the instance is not disposed and the channel is not moved to the Faulted state).</span></span>  
  
 <span data-ttu-id="a9aba-141">O método IErrorHandler.HandleError normalmente é usado para implementar o erro comportamentos relacionados como erro de log de notificações do sistema, desligar o aplicativo, etc. IErrorHandler.HandleError pode ser chamado em vários locais dentro do serviço e, dependendo de onde o erro é gerado, o método HandleError pode ou não pode ser chamado pelo mesmo thread que a operação. Não há garantias nesse sentido.</span><span class="sxs-lookup"><span data-stu-id="a9aba-141">The IErrorHandler.HandleError method is usually used to implement error-related behaviors such as error logging, system notifications, shutting down the application, etc. IErrorHandler.HandleError can be called at multiple places inside the service, and depending on where the error is thrown, the HandleError method may or may not be called by the same thread as the operation; no guarantees are made in this regard.</span></span>  
  
### <a name="dealing-with-exceptions-outside-wcf"></a><span data-ttu-id="a9aba-142">Tratamento de exceções fora do WCF</span><span class="sxs-lookup"><span data-stu-id="a9aba-142">Dealing with Exceptions outside WCF</span></span>  
 <span data-ttu-id="a9aba-143">Geralmente, exceções de configuração, exceções de cadeia de caracteres de conexão do banco de dados e outras exceções semelhantes podem ocorrer dentro do contexto de um aplicativo WCF, mas não são exceções causadas por modelo de serviço ou o próprio serviço web.</span><span class="sxs-lookup"><span data-stu-id="a9aba-143">Often, configuration exceptions, database connection string exceptions, and other similar exceptions may occur within the context of a WCF application, but are themselves are not exceptions caused by the service model or the web service itself.</span></span> <span data-ttu-id="a9aba-144">Essas exceções são externos ao serviço web de exceções "normais" e devem ser tratadas como outras exceções externas no ambiente devem ser manipulados.</span><span class="sxs-lookup"><span data-stu-id="a9aba-144">These exceptions are "regular" exceptions external to the web service, and should be handled just as other external exceptions in the environment are to be handled.</span></span>  
  
### <a name="tracing-exceptions"></a><span data-ttu-id="a9aba-145">Exceções de rastreamento</span><span class="sxs-lookup"><span data-stu-id="a9aba-145">Tracing exceptions</span></span>  
 <span data-ttu-id="a9aba-146">O rastreamento é o lugar de apenas "pega-tudo" onde um potencialmente pode ver todas as exceções.</span><span class="sxs-lookup"><span data-stu-id="a9aba-146">Tracing is the only "catch-all" place where one can potentially see all exceptions.</span></span> <span data-ttu-id="a9aba-147">Para obter mais informações sobre exceções de registro em log e rastreamento, consulte o rastreamento e o registro.</span><span class="sxs-lookup"><span data-stu-id="a9aba-147">For more information on tracing and logging exceptions, see Tracing and Logging.</span></span>  
  
### <a name="uri-template-errors-when-using-webgetattribute-and-webinvokeattribute"></a><span data-ttu-id="a9aba-148">Erros de modelo URI ao usar o WebGetAttribute e o WebInvokeAttribute</span><span class="sxs-lookup"><span data-stu-id="a9aba-148">URI template errors when using WebGetAttribute and WebInvokeAttribute</span></span>  
 <span data-ttu-id="a9aba-149">Os atributos WebGet e WebInvoke permitem que você especifique um modelo de URI que mapeia os componentes do endereço da solicitação para parâmetros de operação.</span><span class="sxs-lookup"><span data-stu-id="a9aba-149">The WebGet and WebInvoke attributes allow you to specify a URI template that maps components of the request address to operation parameters.</span></span> <span data-ttu-id="a9aba-150">Por exemplo, o modelo de URI "clima / {estado} / {cidade}" mapeia o endereço de solicitação em tokens literais, um parâmetro denominado estado e um parâmetro denominado Cidade.</span><span class="sxs-lookup"><span data-stu-id="a9aba-150">For example, the URI template "weather/{state}/{city}" maps the request address into literal tokens, a parameter named state, and a parameter named city.</span></span> <span data-ttu-id="a9aba-151">Esses parâmetros, em seguida, podem ser associados por nome, para alguns dos parâmetros formais da operação.</span><span class="sxs-lookup"><span data-stu-id="a9aba-151">These parameters might then be bound by name to some of the formal parameters of the operation.</span></span>  
  
 <span data-ttu-id="a9aba-152">Os parâmetros de modelo aparecem na forma de cadeias de caracteres no URI, enquanto os parâmetros formais de um contrato com tipo podem ser de tipos de cadeia de caracteres não.</span><span class="sxs-lookup"><span data-stu-id="a9aba-152">The template parameters appear in the form of strings within the URI while the formal parameters of a typed contract might be of non-string types.</span></span> <span data-ttu-id="a9aba-153">Portanto, uma conversão deve ocorrer antes da operação pode ser invocada.</span><span class="sxs-lookup"><span data-stu-id="a9aba-153">Therefore, a conversion needs to take place before the operation can be invoked.</span></span> <span data-ttu-id="a9aba-154">Um [tabela de conversão formatos](http://msdn.microsoft.com/library/bb412172.aspx) está disponível.</span><span class="sxs-lookup"><span data-stu-id="a9aba-154">A [table of conversion formats](http://msdn.microsoft.com/library/bb412172.aspx) is available.</span></span>  
  
 <span data-ttu-id="a9aba-155">No entanto, se a conversão falhar, então não é possível informar a operação que algo deu errado.</span><span class="sxs-lookup"><span data-stu-id="a9aba-155">However, if the conversion fails, then there's no way to let the operation know that something has gone wrong.</span></span> <span data-ttu-id="a9aba-156">Em vez disso, a conversão de tipo revela na forma de uma falha de expedição.</span><span class="sxs-lookup"><span data-stu-id="a9aba-156">The type conversion instead surfaces in the form of a dispatch failure.</span></span>  
  
 <span data-ttu-id="a9aba-157">Uma falha de expedição de conversão de tipo pode ser inspecionado mesmo assim como acontece com muitos outros tipos de falhas na expedição instalando um manipulador de erro.</span><span class="sxs-lookup"><span data-stu-id="a9aba-157">A type conversion dispatch failure can be inspected the same as with many other types of dispatch failures by installing an error handler.</span></span> <span data-ttu-id="a9aba-158">O ponto de extensibilidade IErrorHandler é chamado para manipular exceções de nível de serviço.</span><span class="sxs-lookup"><span data-stu-id="a9aba-158">The IErrorHandler extensibility point is called to handle service-level exceptions.</span></span> <span data-ttu-id="a9aba-159">A partir daí, a resposta a ser enviada de volta ao chamador –, bem como executar tarefas personalizadas e relatórios – pode ser escolhida.</span><span class="sxs-lookup"><span data-stu-id="a9aba-159">From there, the response to be sent back to the caller – as well as perform any custom tasks and reporting – may be chosen.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a9aba-160">Consulte também</span><span class="sxs-lookup"><span data-stu-id="a9aba-160">See Also</span></span>  
 [<span data-ttu-id="a9aba-161">Tratamento de erros do WCF básico</span><span class="sxs-lookup"><span data-stu-id="a9aba-161">Basic WCF Error Handling</span></span>](http://msdn.microsoft.com/library/gg281715.aspx)
