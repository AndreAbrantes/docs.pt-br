---
title: Segurança de transporte de HTTP
ms.date: 03/30/2017
ms.assetid: d3439262-c58e-4d30-9f2b-a160170582bb
ms.openlocfilehash: 386c24a9b51be56bf5a8195123e573cfced6392f
ms.sourcegitcommit: bab17fd81bab7886449217356084bf4881d6e7c8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/26/2019
ms.locfileid: "67402314"
---
# <a name="http-transport-security"></a><span data-ttu-id="49d16-102">Segurança de transporte de HTTP</span><span class="sxs-lookup"><span data-stu-id="49d16-102">HTTP Transport Security</span></span>
<span data-ttu-id="49d16-103">Ao usar o HTTP como o transporte, a segurança é fornecida por uma implementação de Secure Sockets Layer (SSL).</span><span class="sxs-lookup"><span data-stu-id="49d16-103">When using HTTP as the transport, security is provided by a Secure Sockets Layer (SSL) implementation.</span></span> <span data-ttu-id="49d16-104">SSL é amplamente usado na Internet para autenticar um serviço para um cliente e, em seguida, para fornecer confidencialidade (criptografia) para o canal.</span><span class="sxs-lookup"><span data-stu-id="49d16-104">SSL is widely used on the Internet to authenticate a service to a client, and then to provide confidentiality (encryption) to the channel.</span></span> <span data-ttu-id="49d16-105">Este tópico explica como o SSL funciona e como ele é implementado no Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="49d16-105">This topic explains how SSL works and how it is implemented in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="basic-ssl"></a><span data-ttu-id="49d16-106">Basic SSL</span><span class="sxs-lookup"><span data-stu-id="49d16-106">Basic SSL</span></span>  
 <span data-ttu-id="49d16-107">Como funciona o SSL é melhor explicada por meio de um cenário típico, nesse caso, site da Web de um banco.</span><span class="sxs-lookup"><span data-stu-id="49d16-107">How SSL works is best explained through a typical scenario, in this case, a bank's Web site.</span></span> <span data-ttu-id="49d16-108">O site permite que o cliente faça logon com um nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="49d16-108">The site allows a customer to log on with a user name and password.</span></span> <span data-ttu-id="49d16-109">Após ser autenticado, o usuário pode executar transações, como exibir saldos da conta, pagar contas e mover o dinheiro de uma conta para outra.</span><span class="sxs-lookup"><span data-stu-id="49d16-109">After being authenticated, the user can perform transactions, such as view account balances, pay bills, and move money from one account to another.</span></span>  
  
 <span data-ttu-id="49d16-110">Quando um usuário pela primeira vez visita o site, o mecanismo SSL inicia uma série de negociações, chamado de um *handshake*, com cliente do usuário (neste caso, o Internet Explorer).</span><span class="sxs-lookup"><span data-stu-id="49d16-110">When a user first visits the site, the SSL mechanism begins a series of negotiations, called a *handshake*, with the user's client (in this case, Internet Explorer).</span></span> <span data-ttu-id="49d16-111">Primeiro, o SSL autentica o site do banco para o cliente.</span><span class="sxs-lookup"><span data-stu-id="49d16-111">SSL first authenticates the bank site to the customer.</span></span> <span data-ttu-id="49d16-112">Isso é uma etapa essencial porque os clientes primeiro devem saber que eles estão se comunicando com o site real e não uma falsificação que tenta seduzir digitando seu nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="49d16-112">This is an essential step because customers must first know that they are communicating with the actual site, and not a spoof that tries to lure them into typing in their user name and password.</span></span> <span data-ttu-id="49d16-113">SSL faz essa autenticação usando um certificado SSL fornecido por uma autoridade confiável, como a VeriSign.</span><span class="sxs-lookup"><span data-stu-id="49d16-113">SSL does this authentication by using an SSL certificate provided by a trusted authority, such as VeriSign.</span></span> <span data-ttu-id="49d16-114">A lógica funciona assim: VeriSign garante a identidade do site do banco.</span><span class="sxs-lookup"><span data-stu-id="49d16-114">The logic goes like this: VeriSign vouches for the identity of the bank site.</span></span> <span data-ttu-id="49d16-115">Como a VeriSign confia no Internet Explorer, o site é confiável.</span><span class="sxs-lookup"><span data-stu-id="49d16-115">Because Internet Explorer trusts VeriSign, the site is trusted.</span></span> <span data-ttu-id="49d16-116">Se você quiser verificar com a VeriSign, você pode fazer então também clicando no logotipo VeriSign.</span><span class="sxs-lookup"><span data-stu-id="49d16-116">If you want to check with VeriSign, you can do so as well by clicking on the VeriSign logo.</span></span> <span data-ttu-id="49d16-117">Que apresenta uma instrução de autenticidade com a data de expiração e que ele é emitido para (o site do banco).</span><span class="sxs-lookup"><span data-stu-id="49d16-117">That presents a statement of authenticity with its expiration date and who it is issued to (the bank site).</span></span>  
  
 <span data-ttu-id="49d16-118">Para iniciar uma sessão segura, o cliente envia o equivalente a um "Olá" para o servidor, juntamente com uma lista de algoritmos criptográficos, ele pode usar para entrar, gerar hashes e criptografar e descriptografar com.</span><span class="sxs-lookup"><span data-stu-id="49d16-118">To initiate a secure session, the client sends the equivalent of a "hello" to the server along with a list of cryptographic algorithms it can use to sign, generate hashes, and encrypt and decrypt with.</span></span> <span data-ttu-id="49d16-119">Em resposta, o site envia de volta uma confirmação e sua escolha de um dos pacotes de algoritmos.</span><span class="sxs-lookup"><span data-stu-id="49d16-119">In response, the site sends back an acknowledgment and its choice of one of the algorithms suites.</span></span> <span data-ttu-id="49d16-120">Durante esse handshake inicial, ambas as partes enviarem e recebem valores de uso único.</span><span class="sxs-lookup"><span data-stu-id="49d16-120">During this initial handshake, both parties send and receive nonces.</span></span> <span data-ttu-id="49d16-121">Um *nonce* é um dado gerado aleatoriamente que é usado, em combinação com a chave do site público, para criar um hash.</span><span class="sxs-lookup"><span data-stu-id="49d16-121">A *nonce* is a randomly generated piece of data that is used, in combination with the site's public key, to create a hash.</span></span> <span data-ttu-id="49d16-122">Um *hash* é um novo número é derivado de dois números usando um algoritmo padrão, como o SHA1.</span><span class="sxs-lookup"><span data-stu-id="49d16-122">A *hash* is a new number that is derived from the two numbers using a standard algorithm, such as SHA1.</span></span> <span data-ttu-id="49d16-123">(O cliente e o site também trocam mensagens para concordar com o algoritmo de hash que será usado). O hash é exclusivo e é usado somente para a sessão entre o cliente e o site para criptografar e descriptografar mensagens.</span><span class="sxs-lookup"><span data-stu-id="49d16-123">(The client and the site also exchange messages to agree which hash algorithm to use.) The hash is unique and is used only for the session between the client and the site to encrypt and decrypt messages.</span></span> <span data-ttu-id="49d16-124">Cliente e o serviço tem o nonce original e a chave do certificado público, portanto, ambos os lados podem gerar o mesmo hash.</span><span class="sxs-lookup"><span data-stu-id="49d16-124">Both client and service have the original nonce and the certificate's public key, so both sides can generate the same hash.</span></span> <span data-ttu-id="49d16-125">Portanto, o cliente valida o hash enviado pelo serviço (a) usando o acordado ao algoritmo para calcular o hash dos dados e (b) compará-lo com o hash enviado pelo serviço; Se os dois são iguais, o cliente tem garantia de que o hash não foram violado.</span><span class="sxs-lookup"><span data-stu-id="49d16-125">Therefore, the client validates the hash sent by the service by (a) using the agreed upon algorithm to calculate the hash from the data, and (b) comparing it to the hash sent by the service; if the two match, then the client has assurance that the hash has not been tampered with.</span></span> <span data-ttu-id="49d16-126">O cliente pode, em seguida, usar o hash como uma chave para criptografar uma mensagem que contém outro novo hash.</span><span class="sxs-lookup"><span data-stu-id="49d16-126">The client can then use this hash as a key to encrypt a message that contains yet another new hash.</span></span> <span data-ttu-id="49d16-127">O serviço pode descriptografar a mensagem usando o hash e recuperar o hash do segundo ao último.</span><span class="sxs-lookup"><span data-stu-id="49d16-127">The service can decrypt the message using the hash, and recover this second-to-final hash.</span></span> <span data-ttu-id="49d16-128">As informações acumuladas (nonces, chave pública e outros dados) agora são conhecidas para ambos os lados e um hash final (ou a chave mestra) podem ser criada.</span><span class="sxs-lookup"><span data-stu-id="49d16-128">The accumulated information (nonces, public key, and other data) is now known to both sides, and a final hash (or master key) can be created.</span></span> <span data-ttu-id="49d16-129">Essa chave final é enviado criptografado usando o hash do próximo ao último.</span><span class="sxs-lookup"><span data-stu-id="49d16-129">This final key is sent encrypted using the next-to-last hash.</span></span> <span data-ttu-id="49d16-130">A chave mestra, em seguida, é usada para criptografar e descriptografar as mensagens para o restante da sessão.</span><span class="sxs-lookup"><span data-stu-id="49d16-130">The master key is then used to encrypt and decrypt messages for the rest of the session.</span></span> <span data-ttu-id="49d16-131">Como cliente e o serviço usam a mesma chave, isso também é chamado de um *chave de sessão*.</span><span class="sxs-lookup"><span data-stu-id="49d16-131">Because both client and service use the same key, this is also called a *session key*.</span></span>  
  
 <span data-ttu-id="49d16-132">A chave de sessão também é caracterizada como uma chave simétrica ou um "segredo compartilhado".</span><span class="sxs-lookup"><span data-stu-id="49d16-132">The session key is also characterized as a symmetric key, or a "shared secret."</span></span> <span data-ttu-id="49d16-133">É importante ter uma chave simétrica, pois ele reduz a computação necessária por ambos os lados da transação.</span><span class="sxs-lookup"><span data-stu-id="49d16-133">Having a symmetric key is important because it reduces the computation required by both sides of the transaction.</span></span> <span data-ttu-id="49d16-134">Se todas as mensagens exigiam um novo exchange de nonces e hashes, desempenho seria diminuir.</span><span class="sxs-lookup"><span data-stu-id="49d16-134">If every message demanded a new exchange of nonces and hashes, performance would deteriorate.</span></span> <span data-ttu-id="49d16-135">Portanto, o objetivo final de SSL é usar uma chave simétrica que permite que as mensagens fluir livremente entre os dois lados com um grau maior de segurança e eficiência.</span><span class="sxs-lookup"><span data-stu-id="49d16-135">Therefore, the ultimate goal of SSL is to use a symmetric key that allows messages to flow freely between the two sides with a greater degree of security and efficiency.</span></span>  
  
 <span data-ttu-id="49d16-136">A descrição anterior é uma versão simplificada do que acontece, porque o protocolo pode variar de um site a site.</span><span class="sxs-lookup"><span data-stu-id="49d16-136">The previous description is a simplified version of what happens, because the protocol may vary from site to site.</span></span> <span data-ttu-id="49d16-137">Também é possível que o cliente e o site ambos geram nonces algoritmicamente são combinadas durante o handshake para adicionar mais complexidade e, portanto, proteção, o processo de troca de dados.</span><span class="sxs-lookup"><span data-stu-id="49d16-137">It is also possible that both the client and the site both generate nonces that are algorithmically combined during the handshake to add more complexity, and therefore protection, to the process of exchanging data.</span></span>  
  
### <a name="certificates-and-public-key-infrastructure"></a><span data-ttu-id="49d16-138">Certificados e infraestrutura de chave pública</span><span class="sxs-lookup"><span data-stu-id="49d16-138">Certificates and Public Key Infrastructure</span></span>  
 <span data-ttu-id="49d16-139">Durante o handshake, o serviço também envia seu certificado SSL para o cliente.</span><span class="sxs-lookup"><span data-stu-id="49d16-139">During the handshake, the service also sends its SSL certificate to the client.</span></span> <span data-ttu-id="49d16-140">O certificado contém informações, como data de expiração, emitindo a autoridade e identificador de URI do site (Uniform Resource).</span><span class="sxs-lookup"><span data-stu-id="49d16-140">The certificate contains information, such as its expiration date, issuing authority, and the site's Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="49d16-141">O cliente compara o URI para o URI, ele tinha originalmente contatado para garantir a correspondência e também verifica a data e a autoridade emissora.</span><span class="sxs-lookup"><span data-stu-id="49d16-141">The client compares the URI to the URI it had originally contacted to ensure a match, and also checks the date and issuing authority.</span></span>  
  
 <span data-ttu-id="49d16-142">Cada certificado tem duas chaves, uma chave privada e uma chave pública e os dois são conhecidos como uma *par de chaves do exchange*.</span><span class="sxs-lookup"><span data-stu-id="49d16-142">Every certificate has two keys, a private key and a public key, and the two are known as an *exchange key pair*.</span></span> <span data-ttu-id="49d16-143">Em suma, a chave privada conhecida apenas o proprietário do certificado enquanto a chave pública pode ser lida do certificado.</span><span class="sxs-lookup"><span data-stu-id="49d16-143">In brief, the private key is known only to the owner of the certificate while the public key is readable from the certificate.</span></span> <span data-ttu-id="49d16-144">Qualquer chave pode ser usada para criptografar ou descriptografar um resumo, hash, ou outra chave, mas somente como contrary operações.</span><span class="sxs-lookup"><span data-stu-id="49d16-144">Either key can be used to encrypt or decrypt a digest, hash, or other key, but only as contrary operations.</span></span> <span data-ttu-id="49d16-145">Por exemplo, se o cliente criptografa com a chave pública, somente o site pode descriptografar a mensagem usando a chave privada.</span><span class="sxs-lookup"><span data-stu-id="49d16-145">For example, if the client encrypts with the public key, only the site can decrypt the message using the private key.</span></span> <span data-ttu-id="49d16-146">Da mesma forma, se o site criptografa com a chave privada, o cliente pode descriptografar com a chave pública.</span><span class="sxs-lookup"><span data-stu-id="49d16-146">Similarly, if the site encrypts with the private key, the client can decrypt with the public key.</span></span> <span data-ttu-id="49d16-147">Isso fornece garantia para o cliente que as mensagens estão sendo trocadas apenas com o detentor da chave privada porque apenas as mensagens criptografadas com a chave particular podem ser descriptografadas com a chave pública.</span><span class="sxs-lookup"><span data-stu-id="49d16-147">This provides assurance to the client that the messages are being exchanged only with the possessor of the private key because only messages encrypted with the private key can be decrypted with the public key.</span></span> <span data-ttu-id="49d16-148">O site terá certeza de que ele está trocando mensagens com um cliente que tenha criptografado usando a chave pública.</span><span class="sxs-lookup"><span data-stu-id="49d16-148">The site is assured that it is exchanging messages with a client that has encrypted using the public key.</span></span> <span data-ttu-id="49d16-149">Essa troca é segura somente para um handshake inicial, no entanto, razão pela qual muito mais é feito para criar a chave simétrica real.</span><span class="sxs-lookup"><span data-stu-id="49d16-149">This exchange is secure only for an initial handshake, however, which is why much more is done to create the actual symmetric key.</span></span> <span data-ttu-id="49d16-150">No entanto, todas as comunicações dependem do serviço tem um certificado SSL válido.</span><span class="sxs-lookup"><span data-stu-id="49d16-150">Nevertheless, all communications depend on the service having a valid SSL certificate.</span></span>  
  
## <a name="implementing-ssl-with-wcf"></a><span data-ttu-id="49d16-151">Implementando o SSL com o WCF</span><span class="sxs-lookup"><span data-stu-id="49d16-151">Implementing SSL with WCF</span></span>  
 <span data-ttu-id="49d16-152">Segurança de transporte HTTP (ou SSL) é fornecido externamente para o WCF.</span><span class="sxs-lookup"><span data-stu-id="49d16-152">HTTP transport security (or SSL) is provided externally to WCF.</span></span> <span data-ttu-id="49d16-153">Você pode implementar o SSL em uma das duas maneiras; o fator decisivo é como o seu aplicativo está hospedado:</span><span class="sxs-lookup"><span data-stu-id="49d16-153">You can implement SSL in one of two ways; the deciding factor is how your application is hosted:</span></span>  
  
- <span data-ttu-id="49d16-154">Se você estiver usando o Internet Information Services (IIS) do seu host do WCF, use a infraestrutura do IIS para configurar um serviço SSL.</span><span class="sxs-lookup"><span data-stu-id="49d16-154">If you are using Internet Information Services (IIS) as your WCF host, use the IIS infrastructure to set up an SSL service.</span></span>  
  
- <span data-ttu-id="49d16-155">Se você estiver criando um aplicativo WCF auto-hospedado, você pode associar um certificado SSL para o endereço usando a ferramenta HttpCfg.exe.</span><span class="sxs-lookup"><span data-stu-id="49d16-155">If you are creating a self-hosted WCF application, you can bind an SSL certificate to the address using the HttpCfg.exe tool.</span></span>  
  
### <a name="using-iis-for-transport-security"></a><span data-ttu-id="49d16-156">Usando o IIS para segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="49d16-156">Using IIS for Transport Security</span></span>  
  
#### <a name="iis-70"></a><span data-ttu-id="49d16-157">IIS 7.0</span><span class="sxs-lookup"><span data-stu-id="49d16-157">IIS 7.0</span></span>  
 <span data-ttu-id="49d16-158">Para configurar [!INCLUDE[iisver](../../../../includes/iisver-md.md)] como um host protegido (usando SSL), consulte [IIS 7.0 Beta: Configurando o protocolo SSL no IIS 7.0](https://go.microsoft.com/fwlink/?LinkId=88600).</span><span class="sxs-lookup"><span data-stu-id="49d16-158">To set up [!INCLUDE[iisver](../../../../includes/iisver-md.md)] as a secure host (using SSL), see [IIS 7.0 Beta: Configuring Secure Sockets Layer in IIS 7.0](https://go.microsoft.com/fwlink/?LinkId=88600).</span></span>  
  
 <span data-ttu-id="49d16-159">Configurar certificados para uso com [!INCLUDE[iisver](../../../../includes/iisver-md.md)], consulte [IIS 7.0 Beta: Configurando certificados de servidor no IIS 7.0](https://go.microsoft.com/fwlink/?LinkID=88595).</span><span class="sxs-lookup"><span data-stu-id="49d16-159">To configure certificates for use with [!INCLUDE[iisver](../../../../includes/iisver-md.md)], see [IIS 7.0 Beta: Configuring Server Certificates in IIS 7.0](https://go.microsoft.com/fwlink/?LinkID=88595).</span></span>  
  
#### <a name="iis-60"></a><span data-ttu-id="49d16-160">IIS 6,0</span><span class="sxs-lookup"><span data-stu-id="49d16-160">IIS 6.0</span></span>  
 <span data-ttu-id="49d16-161">Para configurar o IIS 6.0 como um host protegido (usando SSL), consulte [Configurando Secure Sockets Layer](https://go.microsoft.com/fwlink/?LinkId=88601).</span><span class="sxs-lookup"><span data-stu-id="49d16-161">To set up IIS 6.0 as a secure host (using SSL), see [Configuring Secure Sockets Layer](https://go.microsoft.com/fwlink/?LinkId=88601).</span></span>  
  
 <span data-ttu-id="49d16-162">Para configurar certificados para uso com o IIS 6.0, consulte [Certificates_IIS_SP1_Ops](https://go.microsoft.com/fwlink/?LinkId=88602).</span><span class="sxs-lookup"><span data-stu-id="49d16-162">To configure certificates for use with IIS 6.0, see [Certificates_IIS_SP1_Ops](https://go.microsoft.com/fwlink/?LinkId=88602).</span></span>  
  
### <a name="using-httpcfg-for-ssl"></a><span data-ttu-id="49d16-163">Usando HttpCfg para SSL</span><span class="sxs-lookup"><span data-stu-id="49d16-163">Using HttpCfg for SSL</span></span>  
 <span data-ttu-id="49d16-164">Se você estiver criando um aplicativo WCF auto-hospedado, baixe a ferramenta HttpCfg.exe, disponível na [site de ferramentas de suporte do Windows XP Service Pack 2](https://go.microsoft.com/fwlink/?LinkId=29002).</span><span class="sxs-lookup"><span data-stu-id="49d16-164">If you are creating a self-hosted WCF application, download the HttpCfg.exe tool, available at the [Windows XP Service Pack 2 Support Tools site](https://go.microsoft.com/fwlink/?LinkId=29002).</span></span>  
  
 <span data-ttu-id="49d16-165">Para obter mais informações sobre como usar a ferramenta HttpCfg.exe para configurar uma porta com um certificado X.509, consulte [como: Configurar uma porta com um certificado SSL](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md).</span><span class="sxs-lookup"><span data-stu-id="49d16-165">For more information about using the HttpCfg.exe tool to set up a port with an X.509 certificate, see [How to: Configure a Port with an SSL Certificate](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="49d16-166">Consulte também</span><span class="sxs-lookup"><span data-stu-id="49d16-166">See also</span></span>

- [<span data-ttu-id="49d16-167">Segurança de transporte</span><span class="sxs-lookup"><span data-stu-id="49d16-167">Transport Security</span></span>](../../../../docs/framework/wcf/feature-details/transport-security.md)
- [<span data-ttu-id="49d16-168">Segurança de mensagem</span><span class="sxs-lookup"><span data-stu-id="49d16-168">Message Security</span></span>](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)
