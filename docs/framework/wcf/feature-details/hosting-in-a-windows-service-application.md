---
title: Hospedando um aplicativo de serviço do Windows
ms.date: 03/30/2017
ms.assetid: f4199998-27f3-4dd9-aee4-0a4addfa9f24
ms.openlocfilehash: 2b3935babec0c7cdc3ffca5dd11d693fdfee7a89
ms.sourcegitcommit: 8c2ece71e54f46aef9a2153540d0bda7e74b19a9
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/12/2018
ms.locfileid: "44508355"
---
# <a name="hosting-in-a-windows-service-application"></a><span data-ttu-id="3923d-102">Hospedando um aplicativo de serviço do Windows</span><span class="sxs-lookup"><span data-stu-id="3923d-102">Hosting in a Windows Service Application</span></span>
<span data-ttu-id="3923d-103">Serviços do Windows (anteriormente conhecidos como serviços do Windows NT) fornecem um processo modelo particularmente adequado para aplicativos que devem residir em um executável de longa execução e não exibem nenhuma forma de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3923d-103">Windows services (formerly known as Windows NT services) provide a process model particularly suited to applications that must live in a long-running executable and do not display any form of user interface.</span></span> <span data-ttu-id="3923d-104">O tempo de vida de um aplicativo de serviço é gerenciado pelo Gerenciador de controle de serviços (SCM), que permite que você inicie, de Windows parar e pausar os aplicativos de serviço do Windows.</span><span class="sxs-lookup"><span data-stu-id="3923d-104">The process lifetime of a Windows service application is managed by the service control manager (SCM), which allows you to start, stop, and pause Windows service applications.</span></span> <span data-ttu-id="3923d-105">Você pode configurar um processo de serviço do Windows para iniciar automaticamente quando o computador é iniciado, tornando-o um ambiente de hospedagem adequado para aplicativos "always on".</span><span class="sxs-lookup"><span data-stu-id="3923d-105">You can configure a Windows service process to start automatically when the computer starts, making it a suitable hosting environment for "always on" applications.</span></span> <span data-ttu-id="3923d-106">Para obter mais informações sobre aplicativos de serviço do Windows, consulte [aplicativos de serviço do Windows](https://go.microsoft.com/fwlink/?LinkId=89450).</span><span class="sxs-lookup"><span data-stu-id="3923d-106">For more information about Windows service applications, see [Windows Service Applications](https://go.microsoft.com/fwlink/?LinkId=89450).</span></span>  
  
 <span data-ttu-id="3923d-107">Aplicativos que hospedam serviços do Windows Communication Foundation (WCF) de longa execução compartilham muitas características com os serviços do Windows.</span><span class="sxs-lookup"><span data-stu-id="3923d-107">Applications that host long-running Windows Communication Foundation (WCF) services share many characteristics with Windows services.</span></span> <span data-ttu-id="3923d-108">Em particular, os serviços WCF são executáveis de servidor de longa execução que não interagem diretamente com o usuário e, portanto, não implementa nenhuma forma de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3923d-108">In particular, WCF services are long-running server executables that do not interact directly with the user and therefore do not implement any form of user interface.</span></span> <span data-ttu-id="3923d-109">Como tal, hospedar serviços WCF dentro de um aplicativo de serviço do Windows é uma opção para a criação de aplicativos do WCF robustos e de longa execução.</span><span class="sxs-lookup"><span data-stu-id="3923d-109">As such, hosting WCF services inside of a Windows service application is one option for building robust, long-running, WCF applications.</span></span>  
  
 <span data-ttu-id="3923d-110">Muitas vezes, os desenvolvedores do WCF devem decidir se deseja hospedar seus aplicativos WCF dentro de um aplicativo de serviço do Windows ou dentro do ambiente de hospedagem de serviços de informações da Internet (IIS) ou o serviço de ativação de processos do Windows (WAS).</span><span class="sxs-lookup"><span data-stu-id="3923d-110">Often, WCF developers must decide whether to host their WCF application inside of a Windows service application or inside of the Internet Information Services (IIS) or Windows Process Activation Service (WAS) hosting environment.</span></span> <span data-ttu-id="3923d-111">Considere o uso de aplicativos de serviço do Windows sob as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="3923d-111">You should consider using Windows service applications under the following conditions:</span></span>  
  
-   <span data-ttu-id="3923d-112">Seu aplicativo requer ativação explícita.</span><span class="sxs-lookup"><span data-stu-id="3923d-112">Your application requires explicit activation.</span></span> <span data-ttu-id="3923d-113">Por exemplo, você deve usar os serviços do Windows quando seu aplicativo deve iniciar automaticamente quando o servidor for iniciado, em vez de serem iniciados dinamicamente em resposta à mensagem de entrada primeiro.</span><span class="sxs-lookup"><span data-stu-id="3923d-113">For example, you should use Windows services when your application must start automatically when the server starts instead of being dynamically started in response to the first incoming message.</span></span>  
  
-   <span data-ttu-id="3923d-114">O processo que hospeda seu aplicativo deve permanecer em execução depois de iniciadas.</span><span class="sxs-lookup"><span data-stu-id="3923d-114">The process that hosts your application must remain running once started.</span></span> <span data-ttu-id="3923d-115">Uma vez iniciada, um processo de serviço do Windows permanece em execução, a menos que explicitamente desligamento por um administrador de servidor usando o Gerenciador de controle de serviço.</span><span class="sxs-lookup"><span data-stu-id="3923d-115">Once started, a Windows service process remains running unless explicitly shut down by a server administrator using the service control manager.</span></span> <span data-ttu-id="3923d-116">Aplicativos hospedados no IIS ou WAS podem ser iniciados e interrompidos dinamicamente para fazer o melhor uso de recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="3923d-116">Applications hosted in IIS or WAS may be started and stopped dynamically to make optimal use of system resources.</span></span> <span data-ttu-id="3923d-117">Aplicativos que exigem o controle explícito sobre o tempo de vida do seu processo de hospedagem devem usar os serviços do Windows em vez de IIS ou WAS.</span><span class="sxs-lookup"><span data-stu-id="3923d-117">Applications that require explicit control over the lifetime of their hosting process should use Windows services instead of IIS or WAS.</span></span>  
  
-   <span data-ttu-id="3923d-118">Seu serviço WCF deve ser executado no Windows Server 2003 e usam transportes diferentes de HTTP.</span><span class="sxs-lookup"><span data-stu-id="3923d-118">Your WCF service must run on Windows Server 2003 and use transports other than HTTP.</span></span> <span data-ttu-id="3923d-119">No Windows Server 2003, o [!INCLUDE[iis601](../../../../includes/iis601-md.md)] ambiente de hospedagem é restrito apenas a comunicação HTTP.</span><span class="sxs-lookup"><span data-stu-id="3923d-119">On Windows Server 2003, the [!INCLUDE[iis601](../../../../includes/iis601-md.md)] hosting environment is restricted to HTTP communication only.</span></span> <span data-ttu-id="3923d-120">Aplicativos de serviço do Windows não estão sujeitos a essa restrição e podem usar qualquer transporte WCF dá suporte a, incluindo NET. TCP, NET. pipe e NET. MSMQ.</span><span class="sxs-lookup"><span data-stu-id="3923d-120">Windows service applications are not subject to this restriction and can use any transport WCF supports, including net.tcp, net.pipe, and net.msmq.</span></span>  
  
### <a name="to-host-wcf-inside-of-a-windows-service-application"></a><span data-ttu-id="3923d-121">Para hospedar o WCF dentro de um aplicativo de serviço do Windows</span><span class="sxs-lookup"><span data-stu-id="3923d-121">To host WCF inside of a Windows service application</span></span>  
  
1.  <span data-ttu-id="3923d-122">Crie um aplicativo de serviço do Windows.</span><span class="sxs-lookup"><span data-stu-id="3923d-122">Create a Windows service application.</span></span> <span data-ttu-id="3923d-123">Você pode escrever aplicativos de serviço do Windows em código gerenciado usando as classes de <xref:System.ServiceProcess> namespace.</span><span class="sxs-lookup"><span data-stu-id="3923d-123">You can write Windows service applications in managed code using the classes in the <xref:System.ServiceProcess> namespace.</span></span> <span data-ttu-id="3923d-124">Este aplicativo deve incluir uma classe que herda de <xref:System.ServiceProcess.ServiceBase>.</span><span class="sxs-lookup"><span data-stu-id="3923d-124">This application must include one class that inherits from <xref:System.ServiceProcess.ServiceBase>.</span></span>  
  
2.  <span data-ttu-id="3923d-125">Vincule o tempo de vida dos serviços do WCF para o tempo de vida do aplicativo do Windows.</span><span class="sxs-lookup"><span data-stu-id="3923d-125">Link the lifetime of the WCF services to the lifetime of the Windows service application.</span></span> <span data-ttu-id="3923d-126">Geralmente, você deseja que os serviços WCF hospedados em um aplicativo de serviço do Windows para se tornar ativo quando o serviço de hospedagem é iniciado, interromper a escuta para mensagens quando o serviço de hospedagem for interrompido e desligar o processo de hospedagem quando o serviço WCF encontra um erro.</span><span class="sxs-lookup"><span data-stu-id="3923d-126">Typically, you want WCF services hosted in a Windows service application to become active when the hosting service starts, stop listening for messages when the hosting service is stopped, and shut down the hosting process when the WCF service encounters an error.</span></span> <span data-ttu-id="3923d-127">Isso pode ser feito da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="3923d-127">This can be accomplished as follows:</span></span>  
  
    -   <span data-ttu-id="3923d-128">Substituir <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> para abrir uma ou mais instâncias de <xref:System.ServiceModel.ServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="3923d-128">Override <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> to open one or more instances of <xref:System.ServiceModel.ServiceHost>.</span></span> <span data-ttu-id="3923d-129">Um único aplicativo de serviço do Windows pode hospedar vários serviços do WCF que iniciam e param como um grupo.</span><span class="sxs-lookup"><span data-stu-id="3923d-129">A single Windows service application can host multiple WCF services that start and stop as a group.</span></span>  
  
    -   <span data-ttu-id="3923d-130">Substituir <xref:System.ServiceProcess.ServiceBase.OnStop%2A> chamar <xref:System.ServiceModel.Channels.CommunicationObject.Closed> sobre o <xref:System.ServiceModel.ServiceHost> quaisquer serviços WCF em execução que foram iniciados durante <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29>.</span><span class="sxs-lookup"><span data-stu-id="3923d-130">Override <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to call <xref:System.ServiceModel.Channels.CommunicationObject.Closed> on the <xref:System.ServiceModel.ServiceHost> any running WCF services that were started during <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29>.</span></span>  
  
    -   <span data-ttu-id="3923d-131">Assine a <xref:System.ServiceModel.Channels.CommunicationObject.Faulted> eventos de <xref:System.ServiceModel.ServiceHost> e use o <xref:System.ServiceProcess.ServiceController> classe para desligar o aplicativo de serviço do Windows em caso de erro.</span><span class="sxs-lookup"><span data-stu-id="3923d-131">Subscribe to the <xref:System.ServiceModel.Channels.CommunicationObject.Faulted> event of <xref:System.ServiceModel.ServiceHost> and use the <xref:System.ServiceProcess.ServiceController> class to shut down the Windows service application in case of error.</span></span>  
  
     <span data-ttu-id="3923d-132">Aplicativos de serviço do Windows que hospedam serviços do WCF são implantados e gerenciados da mesma forma, como aplicativos de serviço do Windows que não fazem usam do WCF.</span><span class="sxs-lookup"><span data-stu-id="3923d-132">Windows service applications that host WCF services are deployed and managed in the same way as Windows service applications that do not make use of WCF.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3923d-133">Consulte também</span><span class="sxs-lookup"><span data-stu-id="3923d-133">See Also</span></span>  
 <xref:System.ServiceProcess>  
 [<span data-ttu-id="3923d-134">Passo a passo: criando um aplicativo de Serviço Windows no Designer de componentes</span><span class="sxs-lookup"><span data-stu-id="3923d-134">Walkthrough: Creating a Windows Service Application in the Component Designer</span></span>](https://go.microsoft.com/fwlink/?LinkId=94875)  
 [<span data-ttu-id="3923d-135">Como hospedar um serviço WCF em um serviço Windows gerenciado</span><span class="sxs-lookup"><span data-stu-id="3923d-135">How to: Host a WCF Service in a Managed Windows Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-a-managed-windows-service.md)  
 [<span data-ttu-id="3923d-136">Host de serviço Windows</span><span class="sxs-lookup"><span data-stu-id="3923d-136">Windows Service Host</span></span>](../../../../docs/framework/wcf/samples/windows-service-host.md)  
 [<span data-ttu-id="3923d-137">Arquitetura de programação de aplicativo de serviço</span><span class="sxs-lookup"><span data-stu-id="3923d-137">Service Application Programming Architecture</span></span>](https://go.microsoft.com/fwlink/?LinkId=94876)  
 [<span data-ttu-id="3923d-138">Recursos de hospedagem do Windows Server App Fabric</span><span class="sxs-lookup"><span data-stu-id="3923d-138">Windows Server App Fabric Hosting Features</span></span>](https://go.microsoft.com/fwlink/?LinkId=201276)
