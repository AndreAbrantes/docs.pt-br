---
title: "Integração com visão geral de aplicativos COM+"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
caps.latest.revision: "29"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 04de29891bcf5d8cdbac32ffc85d64a4003e3184
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/02/2017
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="d0d4a-102">Integração com visão geral de aplicativos COM+</span><span class="sxs-lookup"><span data-stu-id="d0d4a-102">Integrating with COM+ Applications Overview</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="d0d4a-103">Fornece um ambiente rico para criar aplicativos distribuídos.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-103"> provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="d0d4a-104">Se você já estiver usando a lógica do aplicativo baseado em componente hospedada em COM+, você pode usar [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] para estender sua lógica existente em vez de precisar reescrevê-la.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-104">If you are already using component-based application logic hosted in COM+, you can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="d0d4a-105">Um cenário comum é quando você deseja expor existente lógica de negócios de COM+ ou serviços corporativos por meio de serviços Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="d0d4a-106">Quando uma interface em um componente COM+ é exposta como um serviço Web, a especificação e contrato desses serviços são determinados por um mapeamento automático que é executado em tempo de inicialização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="d0d4a-107">A lista a seguir mostra o modelo conceitual para que esse mapeamento:</span><span class="sxs-lookup"><span data-stu-id="d0d4a-107">The following list shows the conceptual model for this mapping:</span></span>  
  
-   <span data-ttu-id="d0d4a-108">Um serviço é definido para cada classe COM exposto.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-108">One service is defined for each exposed COM class.</span></span>  
  
-   <span data-ttu-id="d0d4a-109">O contrato para o serviço é derivado diretamente da definição de interface do componente selecionado com a possibilidade de exclusão do método definido na configuração.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
-   <span data-ttu-id="d0d4a-110">As operações no contrato são derivadas diretamente de métodos na definição de interface do componente.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
-   <span data-ttu-id="d0d4a-111">Os parâmetros para essas operações são derivados diretamente do tipo de interoperabilidade COM que corresponde aos parâmetros do método do componente.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="d0d4a-112">Padrão de endereços e associações de transporte para o serviço são fornecidas em um arquivo de configuração de serviço, mas eles podem ser reconfigurados como necessário.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d0d4a-113">Os contratos para os serviços Web expostos permanecem constantes desde que a configuração e interfaces COM+ permanecem inalteradas.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="d0d4a-114">Uma modificação em várias interfaces não atualiza automaticamente os serviços disponíveis e requer executar novamente a ferramenta de configuração de modelo de serviço COM+ (ComSvcConfig.exe).</span><span class="sxs-lookup"><span data-stu-id="d0d4a-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="d0d4a-115">Os requisitos de autenticação e autorização do aplicativo COM+ e seus componentes continuam a ser aplicada quando usado como um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="d0d4a-116">Se o chamador inicia uma transação de serviço da Web, componentes marcados como transacional se inscrever nesse escopo de transação.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="d0d4a-117">As etapas a seguir são necessários para expor a interface do componente COM+ como um serviço Web sem modificar o componente:</span><span class="sxs-lookup"><span data-stu-id="d0d4a-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1.  <span data-ttu-id="d0d4a-118">Determine se a interface do componente COM+ pode ser exposto como um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2.  <span data-ttu-id="d0d4a-119">Selecione um modo de hospedagem apropriado.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-119">Select an appropriate hosting mode.</span></span>  
  
3.  <span data-ttu-id="d0d4a-120">Use a ferramenta de configuração de modelo de serviço COM+ (ComSvcConfig.exe) para adicionar um serviço Web para a interface.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d0d4a-121">como usar ComSvcConfig.exe, consulte [como: usar a ferramenta Configuração do modelo de COM+ serviço](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span><span class="sxs-lookup"><span data-stu-id="d0d4a-121"> how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4.  <span data-ttu-id="d0d4a-122">Configure as configurações de serviço adicionais no arquivo de configuração do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-122">Configure any additional service settings in the application configuration file.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d0d4a-123">como configurar um componente, consulte [como: definir configurações de serviço COM+](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span><span class="sxs-lookup"><span data-stu-id="d0d4a-123"> how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="d0d4a-124">Interfaces com suporte</span><span class="sxs-lookup"><span data-stu-id="d0d4a-124">Supported Interfaces</span></span>  
 <span data-ttu-id="d0d4a-125">Há algumas restrições no tipo de interfaces que pode ser exposta como um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="d0d4a-126">Não há suporte para os seguintes tipos de interfaces:</span><span class="sxs-lookup"><span data-stu-id="d0d4a-126">The following types of interfaces are not supported:</span></span>  
  
-   <span data-ttu-id="d0d4a-127">Interfaces que transmitem referências de objeto como parâmetros - a abordagem de referência de objeto limitado a seguir é descrita na seção de suporte limitado de referência de objeto.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
-   <span data-ttu-id="d0d4a-128">Interfaces que passam tipos que não são compatíveis com o [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] conversões de interoperabilidade COM.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-128">Interfaces that pass types that are not compatible with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM interoperability conversions.</span></span>  
  
-   <span data-ttu-id="d0d4a-129">Interfaces para aplicativos que têm o pool de aplicativos habilitada quando hospedados pelo COM+.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
-   <span data-ttu-id="d0d4a-130">Interfaces de componentes que são marcados como privados para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-130">Interfaces of components that are marked as private to the application.</span></span>  
  
-   <span data-ttu-id="d0d4a-131">Interfaces de infraestrutura COM+.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-131">COM+ infrastructure interfaces.</span></span>  
  
-   <span data-ttu-id="d0d4a-132">Interfaces de aplicativo do sistema.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-132">Interfaces from the system application.</span></span>  
  
-   <span data-ttu-id="d0d4a-133">Interfaces de componentes de serviços corporativos que não foram adicionados ao cache de assembly global.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="d0d4a-134">Suporte de referência de objeto limitado</span><span class="sxs-lookup"><span data-stu-id="d0d4a-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="d0d4a-135">Como um número de componentes COM+ implantados usam objetos por parâmetros de referência, como retornar um objeto de conjunto de registros ADO, integração de COM+ inclui suporte limitado para parâmetros de referência de objeto.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="d0d4a-136">O suporte é limitado a objetos que implementam o `IPersistStream` interface COM.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="d0d4a-137">Isso inclui objetos de conjunto de registros ADO e pode ser implementado para objetos específicos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="d0d4a-138">Para habilitar esse suporte, a ferramenta ComSvcConfig.exe fornece o **allowreferences** comutador que desabilita o parâmetro de assinatura de método regular e verifica que a ferramenta é executada para garantir que não estão sendo usados parâmetros de referência de objeto .</span><span class="sxs-lookup"><span data-stu-id="d0d4a-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="d0d4a-139">Além disso, os tipos de objeto que você passa como parâmetros devem ser nomeados e identificados no <`persistableTypes`> elemento de configuração que é um filho de <`comContract`> elemento.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="d0d4a-140">Quando esse recurso é usado, os usos de serviço de integração COM+ a `IPersistStream` interface para serializar ou desserializar a instância do objeto.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="d0d4a-141">Se a instância do objeto não suporta `IPersistStream`, uma exceção será lançada.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="d0d4a-142">Em um aplicativo cliente, os métodos de <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> objeto pode ser usado para passar um objeto em um serviço e, da mesma forma, para recuperar um objeto.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d0d4a-143">Devido à natureza personalizada e específicos de plataforma da abordagem de serialização, isso é mais adequado para uso entre [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clientes e [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] serviços.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="d0d4a-144">Selecionar o modo de hospedagem</span><span class="sxs-lookup"><span data-stu-id="d0d4a-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="d0d4a-145">COM+ expõe serviços da Web em um dos seguintes modos de hospedagem:</span><span class="sxs-lookup"><span data-stu-id="d0d4a-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
-   <span data-ttu-id="d0d4a-146">COM+-hospedado</span><span class="sxs-lookup"><span data-stu-id="d0d4a-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="d0d4a-147">O serviço da Web é hospedado dentro COM+ servidor processo dedicado do aplicativo (Dllhost.exe).</span><span class="sxs-lookup"><span data-stu-id="d0d4a-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="d0d4a-148">Esse modo requer que o aplicativo deve ser explicitamente iniciada antes que ele possa receber solicitações de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="d0d4a-149">As COM+ opções "Executar como um serviço NT" ou "Deixar executando quando inativo" podem ser usadas para impedir que o desligamento ocioso do aplicativo e seus serviços.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="d0d4a-150">Esse modo fornece o serviço Web e acesso DCOM para o aplicativo do servidor.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
-   <span data-ttu-id="d0d4a-151">Hospedado na Web</span><span class="sxs-lookup"><span data-stu-id="d0d4a-151">Web-hosted</span></span>  
  
     <span data-ttu-id="d0d4a-152">O serviço da Web é hospedado dentro de um processo de trabalho do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="d0d4a-153">Esse modo não requer COM+ esteja ativa quando a solicitação inicial é recebida.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="d0d4a-154">Se o aplicativo não estiver ativo quando essa solicitação é recebida, ela é automaticamente ativada antes de processar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="d0d4a-155">Este modo também fornece o serviço Web e acesso DCOM para o aplicativo de servidor, mas faz com que um nó de processo para solicitações de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="d0d4a-156">Isso geralmente exige que o cliente habilitar a representação.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="d0d4a-157">Em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], isso pode ser feito com o <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> propriedade do <xref:System.ServiceModel.Security.WindowsClientCredential> classe, que pode é acessada como uma propriedade de genérica <xref:System.ServiceModel.ChannelFactory%601> classe, bem como a <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> valor de enumeração.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
-   <span data-ttu-id="d0d4a-158">Web hospedada no processo</span><span class="sxs-lookup"><span data-stu-id="d0d4a-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="d0d4a-159">O serviço Web e a lógica do aplicativo COM+ são hospedadas no processo de trabalho do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="d0d4a-160">Isso fornece a ativação automática do modo hospedado da Web sem causar um salto de processo para solicitações de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="d0d4a-161">A desvantagem é que o aplicativo de servidor não pode ser acessado por meio do DCOM.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="d0d4a-162">Considerações sobre segurança</span><span class="sxs-lookup"><span data-stu-id="d0d4a-162">Security Considerations</span></span>  
 <span data-ttu-id="d0d4a-163">Assim como outros [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] serviços, as configurações de segurança para o serviço exposto são administrados por meio de configurações para o [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] canal.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-163">Like other [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services, the security settings for the exposed service are administered through configuration settings for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] channel.</span></span> <span data-ttu-id="d0d4a-164">Configurações de segurança DCOM tradicionais, como as configurações de máquina permissões DCOM não são impostas.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="d0d4a-165">Para aplicar funções de aplicativo do COM+, autorização "verificações de acesso no nível do componente" deve ser habilitada para o componente.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="d0d4a-166">O uso de uma associação não é seguro pode deixar comunicação aberta a divulgação de informações ou violação.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="d0d4a-167">Para evitar isso, é recomendável que você use uma associação segura.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="d0d4a-168">Para o COM+-modos hospedados e hospedado na Web, aplicativos cliente devem permitir que o processo do servidor para representar o usuário do cliente.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="d0d4a-169">Isso pode ser feito [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clientes definindo a representação de nível para <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-169">This can be done in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="d0d4a-170">Com os serviços de informações da Internet (IIS) ou o processo de ativação Windows Service (WAS) usando o transporte HTTP, a ferramenta Httpcfg.exe pode ser usada para reservar um endereço de ponto de extremidade de transporte.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="d0d4a-171">Em outras configurações, é importante proteger contra serviços mal-intencionados que agem como o serviço pretendido.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="d0d4a-172">Para impedir a inicialização no ponto de extremidade desejado de um serviço autorizado, o serviço legítimo pode ser configurado para ser executado como um serviço NT.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="d0d4a-173">Isso permite que o serviço legítimo declarar o endereço do ponto de extremidade antes de qualquer serviço autorizado.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="d0d4a-174">Ao expor um aplicativo COM+ com funções COM+ configurados como um serviço hospedado na Web, a "conta de processo de IIS iniciar" deve ser adicionada a uma das funções do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="d0d4a-175">Essa conta, normalmente com o nome IWAM_machinename, deve ser adicionada para permitir desligamento normal de objetos após o uso.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="d0d4a-176">A conta não deve receber as permissões adicionais.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="d0d4a-177">O processo COM+ reciclagem de recursos não pode ser usado em aplicativos integrados.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="d0d4a-178">Se o aplicativo está configurado para usar a reciclagem de processo e os componentes estão em execução em um processo hospedados pelo COM+, o serviço não for iniciado.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="d0d4a-179">Esse requisito não inclui serviços usando o modo de-processo hospedado na Web porque não são aplicadas as configurações de reciclagem do processo.</span><span class="sxs-lookup"><span data-stu-id="d0d4a-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d0d4a-180">Consulte também</span><span class="sxs-lookup"><span data-stu-id="d0d4a-180">See Also</span></span>  
 [<span data-ttu-id="d0d4a-181">Integração com visão geral de aplicativos COM</span><span class="sxs-lookup"><span data-stu-id="d0d4a-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
