---
title: Sessões,instanciação e simultaneidade
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: a7466d819e15f3bfe8def2d9407dcf2c6e0c7346
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184439"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="51c54-102">Sessões,instanciação e simultaneidade</span><span class="sxs-lookup"><span data-stu-id="51c54-102">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="51c54-103">Uma *sessão* é uma correlação de todas as mensagens enviadas entre dois pontos finais.</span><span class="sxs-lookup"><span data-stu-id="51c54-103">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="51c54-104">*Instancing* refere-se ao controle da vida útil de <xref:System.ServiceModel.InstanceContext> objetos de serviço definidos pelo usuário e seus objetos relacionados.</span><span class="sxs-lookup"><span data-stu-id="51c54-104">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="51c54-105">*Conmoeda* é o termo dado ao controle do número <xref:System.ServiceModel.InstanceContext> de threads executados em um ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="51c54-105">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="51c54-106">Este tópico descreve essas configurações, como usá-las e as várias interações entre elas.</span><span class="sxs-lookup"><span data-stu-id="51c54-106">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="51c54-107">Sessões</span><span class="sxs-lookup"><span data-stu-id="51c54-107">Sessions</span></span>  
 <span data-ttu-id="51c54-108">Quando um contrato <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> de <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>serviço define a propriedade para , esse contrato está dizendo que todas as chamadas (ou seja, as trocas de mensagens subjacentes que suportam as chamadas) devem fazer parte da mesma conversa.</span><span class="sxs-lookup"><span data-stu-id="51c54-108">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="51c54-109">Se um contrato especificar que permite sessões, mas não requer uma, os clientes podem se conectar e estabelecer uma sessão ou não.</span><span class="sxs-lookup"><span data-stu-id="51c54-109">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="51c54-110">Se a sessão terminar e uma mensagem for enviada pelo mesmo canal baseado em sessão, uma exceção será lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-110">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="51c54-111">As sessões de WCF têm as seguintes características conceituais principais:</span><span class="sxs-lookup"><span data-stu-id="51c54-111">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="51c54-112">Eles são explicitamente iniciados e encerrados pelo aplicativo de chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-112">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="51c54-113">As mensagens entregues durante uma sessão são processadas na ordem em que são recebidas.</span><span class="sxs-lookup"><span data-stu-id="51c54-113">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="51c54-114">As sessões correlacionam um grupo de mensagens em uma conversa.</span><span class="sxs-lookup"><span data-stu-id="51c54-114">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="51c54-115">O significado dessa correlação é uma abstração.</span><span class="sxs-lookup"><span data-stu-id="51c54-115">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="51c54-116">Por exemplo, um canal baseado em sessão pode correlacionar mensagens com base em uma conexão de rede compartilhada, enquanto outro canal baseado em sessão pode correlacionar mensagens com base em uma tag compartilhada no corpo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="51c54-116">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="51c54-117">As características que podem ser derivadas da sessão dependem da natureza da correlação.</span><span class="sxs-lookup"><span data-stu-id="51c54-117">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="51c54-118">Não há um armazenamento geral de dados associado a uma sessão wcf.</span><span class="sxs-lookup"><span data-stu-id="51c54-118">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="51c54-119">Se você estiver <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> familiarizado com a classe em ASP.NET aplicativos e a funcionalidade que ele fornece, você pode notar as seguintes diferenças entre esse tipo de sessão e sessões de WCF:</span><span class="sxs-lookup"><span data-stu-id="51c54-119">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="51c54-120">ASP.NET sessões são sempre iniciadas pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="51c54-120">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="51c54-121">ASP.NET sessões são implicitamente desordenadas.</span><span class="sxs-lookup"><span data-stu-id="51c54-121">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="51c54-122">ASP.NET sessões fornecem um mecanismo geral de armazenamento de dados entre as solicitações.</span><span class="sxs-lookup"><span data-stu-id="51c54-122">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="51c54-123">Aplicativos clientes e aplicativos de serviço interagem com as sessões de diferentes maneiras.</span><span class="sxs-lookup"><span data-stu-id="51c54-123">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="51c54-124">Os aplicativos clientes iniciam sessões e, em seguida, recebem e processam as mensagens enviadas dentro da sessão.</span><span class="sxs-lookup"><span data-stu-id="51c54-124">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="51c54-125">Os aplicativos de serviço podem usar as sessões como um ponto de extensibilidade para adicionar comportamento adicional.</span><span class="sxs-lookup"><span data-stu-id="51c54-125">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="51c54-126">Isso é feito trabalhando <xref:System.ServiceModel.InstanceContext> diretamente com o ou implementando um provedor de contexto de instância personalizada.</span><span class="sxs-lookup"><span data-stu-id="51c54-126">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="51c54-127">Instanciação</span><span class="sxs-lookup"><span data-stu-id="51c54-127">Instancing</span></span>  
 <span data-ttu-id="51c54-128">O comportamento de instancing <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> (definido pelo uso <xref:System.ServiceModel.InstanceContext> da propriedade) controla como o é criado em resposta às mensagens recebidas.</span><span class="sxs-lookup"><span data-stu-id="51c54-128">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="51c54-129">Por padrão, <xref:System.ServiceModel.InstanceContext> cada um está associado a um objeto de serviço definido <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> pelo usuário, então (no caso padrão) a configuração da propriedade também controla a entrada de objetos de serviço definidos pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="51c54-129">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="51c54-130">A <xref:System.ServiceModel.InstanceContextMode> enumeração define os modos de instancing.</span><span class="sxs-lookup"><span data-stu-id="51c54-130">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="51c54-131">Os seguintes modos de instancing estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="51c54-131">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="51c54-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: Um <xref:System.ServiceModel.InstanceContext> novo objeto de serviço (e, portanto, de serviço) é criado para cada solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="51c54-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="51c54-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: Um <xref:System.ServiceModel.InstanceContext> novo objeto de serviço (e, portanto, de serviço) é criado para cada nova sessão de cliente e mantido durante toda a vida dessa sessão (isso requer uma vinculação que suporte as sessões).</span><span class="sxs-lookup"><span data-stu-id="51c54-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="51c54-134"><xref:System.ServiceModel.InstanceContextMode.Single>: Um <xref:System.ServiceModel.InstanceContext> único (e, portanto, objeto de serviço) lida com todas as solicitações do cliente durante a vida útil do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="51c54-134"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="51c54-135">O exemplo de código <xref:System.ServiceModel.InstanceContextMode> a <xref:System.ServiceModel.InstanceContextMode.PerSession> seguir mostra o valor padrão, sendo explicitamente definido em uma classe de serviço.</span><span class="sxs-lookup"><span data-stu-id="51c54-135">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```csharp  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]
public class CalculatorService : ICalculatorInstance
{
    ...  
}  
```  
  
 <span data-ttu-id="51c54-136"><xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> E enquanto a propriedade <xref:System.ServiceModel.InstanceContext> controla a <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> frequência com que o é liberado, o controle e <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> propriedades quando o objeto de serviço é liberado.</span><span class="sxs-lookup"><span data-stu-id="51c54-136">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="51c54-137">Serviços bem conhecidos de Singleton</span><span class="sxs-lookup"><span data-stu-id="51c54-137">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="51c54-138">Uma variação em objetos de serviço de instância única às vezes é útil: você pode criar um objeto de serviço sozinho e criar o host de serviço usando esse objeto.</span><span class="sxs-lookup"><span data-stu-id="51c54-138">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="51c54-139">Para isso, você também deve <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> definir <xref:System.ServiceModel.InstanceContextMode.Single> a propriedade para ou uma exceção é lançada quando o host de serviço é aberto.</span><span class="sxs-lookup"><span data-stu-id="51c54-139">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="51c54-140">Use <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> o construtor para criar tal serviço.</span><span class="sxs-lookup"><span data-stu-id="51c54-140">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> constructor to create such a service.</span></span> <span data-ttu-id="51c54-141">Ele fornece uma alternativa para <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> implementar um personalizado quando você deseja fornecer uma instância específica de objeto para uso por um serviço singleton.</span><span class="sxs-lookup"><span data-stu-id="51c54-141">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="51c54-142">Você pode usar essa sobrecarga quando seu tipo de implementação de serviço é difícil de construir (por exemplo, se ele não implementar um construtor público sem parâmetros).</span><span class="sxs-lookup"><span data-stu-id="51c54-142">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a parameterless public constructor).</span></span>  
  
 <span data-ttu-id="51c54-143">Observe que quando um objeto é fornecido a este construtor, alguns recursos relacionados ao Comportamento de Instancing da Windows Communication Foundation (WCF) funcionam de forma diferente.</span><span class="sxs-lookup"><span data-stu-id="51c54-143">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="51c54-144">Por exemplo, <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> a chamada não tem efeito quando uma instância de objeto singleton é fornecida.</span><span class="sxs-lookup"><span data-stu-id="51c54-144">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="51c54-145">Da mesma forma, qualquer outro mecanismo de liberação de instâncias é ignorado.</span><span class="sxs-lookup"><span data-stu-id="51c54-145">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="51c54-146">O <xref:System.ServiceModel.ServiceHost> sempre se comporta <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> como se <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> a propriedade estivesse definida para todas as operações.</span><span class="sxs-lookup"><span data-stu-id="51c54-146">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="51c54-147">Compartilhando objetos de contexto de instância</span><span class="sxs-lookup"><span data-stu-id="51c54-147">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="51c54-148">Você também pode controlar qual canal ou <xref:System.ServiceModel.InstanceContext> chamada está associado a qual objeto realizando essa associação você mesmo.</span><span class="sxs-lookup"><span data-stu-id="51c54-148">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="51c54-149">Simultaneidade</span><span class="sxs-lookup"><span data-stu-id="51c54-149">Concurrency</span></span>  
 <span data-ttu-id="51c54-150">Conmoeda é o controle do número de <xref:System.ServiceModel.InstanceContext> threads ativos em um a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="51c54-150">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="51c54-151">Isso é controlado <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> usando <xref:System.ServiceModel.ConcurrencyMode> o com a enumeração.</span><span class="sxs-lookup"><span data-stu-id="51c54-151">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="51c54-152">Os três modos de concorrência a seguir estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="51c54-152">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="51c54-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Cada contexto de instância é permitido ter um máximo de um segmento processando mensagens no contexto de instância de cada vez.</span><span class="sxs-lookup"><span data-stu-id="51c54-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="51c54-154">Outros segmentos que desejam usar o mesmo contexto de instância devem ser bloqueados até que o segmento original saia do contexto de instância.</span><span class="sxs-lookup"><span data-stu-id="51c54-154">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="51c54-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Cada instância de serviço pode ter vários threads processando mensagens simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="51c54-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="51c54-156">A implementação do serviço deve ser segura para threads para usar este modo de concorrência.</span><span class="sxs-lookup"><span data-stu-id="51c54-156">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="51c54-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Cada instância de serviço processa uma mensagem por vez, mas aceita chamadas de operação de reentrada.</span><span class="sxs-lookup"><span data-stu-id="51c54-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="51c54-158">O serviço só aceita essas chamadas quando está chamando através de um objeto cliente WCF.</span><span class="sxs-lookup"><span data-stu-id="51c54-158">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="51c54-159">Entender e desenvolver códigos que usem com segurança mais de um segmento pode ser difícil de escrever com sucesso.</span><span class="sxs-lookup"><span data-stu-id="51c54-159">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="51c54-160">Antes <xref:System.ServiceModel.ConcurrencyMode.Multiple> de <xref:System.ServiceModel.ConcurrencyMode.Reentrant> usar ou valorizar, certifique-se de que seu serviço foi projetado adequadamente para esses modos.</span><span class="sxs-lookup"><span data-stu-id="51c54-160">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="51c54-161">Para obter mais informações, consulte <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="51c54-161">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="51c54-162">O uso de simultuou-se em relação ao modo de instancing.</span><span class="sxs-lookup"><span data-stu-id="51c54-162">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="51c54-163">Em <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, a concorrência não é relevante, pois <xref:System.ServiceModel.InstanceContext> cada mensagem é processada por um novo <xref:System.ServiceModel.InstanceContext>e, portanto, nunca mais de um segmento está ativo no .</span><span class="sxs-lookup"><span data-stu-id="51c54-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="51c54-164">O exemplo de código <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> a <xref:System.ServiceModel.ConcurrencyMode.Multiple>seguir demonstra a configuração da propriedade para .</span><span class="sxs-lookup"><span data-stu-id="51c54-164">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```csharp
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
public class CalculatorService : ICalculatorConcurrency
{
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="51c54-165">As sessões interagem com as configurações do contexto de instância</span><span class="sxs-lookup"><span data-stu-id="51c54-165">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="51c54-166">Sessões <xref:System.ServiceModel.InstanceContext> e interagir dependendo da combinação <xref:System.ServiceModel.SessionMode> do valor da enumeração em um contrato e da <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade na implementação do serviço, que controla a associação entre canais e objetos de serviço específicos.</span><span class="sxs-lookup"><span data-stu-id="51c54-166">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="51c54-167">A tabela a seguir mostra o resultado de um canal de entrada, apoiando sessões ou não suportando sessões, dada a combinação de um serviço dos valores da <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> propriedade e da <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade.</span><span class="sxs-lookup"><span data-stu-id="51c54-167">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="51c54-168">ExemploContextoModo valor</span><span class="sxs-lookup"><span data-stu-id="51c54-168">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="51c54-169">Percall</span><span class="sxs-lookup"><span data-stu-id="51c54-169">PerCall</span></span>|<span data-ttu-id="51c54-170">- Comportamento com canal de <xref:System.ServiceModel.InstanceContext> sessão: Uma sessão e para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-170">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="51c54-171">- Comportamento com canal sem sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-171">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="51c54-172">- Comportamento com canal de <xref:System.ServiceModel.InstanceContext> sessão: Uma sessão e para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-172">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="51c54-173">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-173">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="51c54-174">- Comportamento com canal de sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-174">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="51c54-175">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-175">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="51c54-176">Persession</span><span class="sxs-lookup"><span data-stu-id="51c54-176">PerSession</span></span>|<span data-ttu-id="51c54-177">- Comportamento com canal de <xref:System.ServiceModel.InstanceContext> sessão: Uma sessão e para cada canal.</span><span class="sxs-lookup"><span data-stu-id="51c54-177">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="51c54-178">- Comportamento com canal sem sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-178">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="51c54-179">- Comportamento com canal de <xref:System.ServiceModel.InstanceContext> sessão: Uma sessão e para cada canal.</span><span class="sxs-lookup"><span data-stu-id="51c54-179">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="51c54-180">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-180">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="51c54-181">- Comportamento com canal de sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-181">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="51c54-182">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="51c54-182">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="51c54-183">Single</span><span class="sxs-lookup"><span data-stu-id="51c54-183">Single</span></span>|<span data-ttu-id="51c54-184">- Comportamento com canal de sessão: Uma sessão e uma <xref:System.ServiceModel.InstanceContext> para todas as chamadas.</span><span class="sxs-lookup"><span data-stu-id="51c54-184">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="51c54-185">- Comportamento com canal sem sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-185">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="51c54-186">- Comportamento com canal de <xref:System.ServiceModel.InstanceContext> sessão: Uma sessão e para o singleton criado ou especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="51c54-186">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="51c54-187">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um singleton criado ou especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="51c54-187">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="51c54-188">- Comportamento com canal de sessão: Uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="51c54-188">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="51c54-189">- Comportamento com canal <xref:System.ServiceModel.InstanceContext> sem sessão: Um para cada singleton criado ou para o singleton especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="51c54-189">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="51c54-190">Confira também</span><span class="sxs-lookup"><span data-stu-id="51c54-190">See also</span></span>

- [<span data-ttu-id="51c54-191">Usando sessões</span><span class="sxs-lookup"><span data-stu-id="51c54-191">Using Sessions</span></span>](../../../../docs/framework/wcf/using-sessions.md)
- [<span data-ttu-id="51c54-192">Como criar um serviço que requer sessões</span><span class="sxs-lookup"><span data-stu-id="51c54-192">How to: Create a Service That Requires Sessions</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="51c54-193">Como controlar instanciação de serviço</span><span class="sxs-lookup"><span data-stu-id="51c54-193">How to: Control Service Instancing</span></span>](../../../../docs/framework/wcf/feature-details/how-to-control-service-instancing.md)
- [<span data-ttu-id="51c54-194">Simultaneidade</span><span class="sxs-lookup"><span data-stu-id="51c54-194">Concurrency</span></span>](../../../../docs/framework/wcf/samples/concurrency.md)
- [<span data-ttu-id="51c54-195">Instanciação</span><span class="sxs-lookup"><span data-stu-id="51c54-195">Instancing</span></span>](../../../../docs/framework/wcf/samples/instancing.md)
- [<span data-ttu-id="51c54-196">Sessão</span><span class="sxs-lookup"><span data-stu-id="51c54-196">Session</span></span>](../../../../docs/framework/wcf/samples/session.md)
