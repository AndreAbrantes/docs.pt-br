---
title: Sessões,instanciação e simultaneidade
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: 74b9971fa9267ef6156b27261c61d3e998d01883
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877325"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="edd9d-102">Sessões,instanciação e simultaneidade</span><span class="sxs-lookup"><span data-stu-id="edd9d-102">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="edd9d-103">Um *sessão* é uma correlação de todas as mensagens enviadas entre dois pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="edd9d-103">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="edd9d-104">*Instanciação* refere-se para controlar o tempo de vida de objetos de serviço definido pelo usuário e seus relacionados <xref:System.ServiceModel.InstanceContext> objetos.</span><span class="sxs-lookup"><span data-stu-id="edd9d-104">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="edd9d-105">*Simultaneidade* é o termo dado ao controle do número de threads em execução em um <xref:System.ServiceModel.InstanceContext> ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="edd9d-105">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="edd9d-106">Este tópico descreve essas configurações, como usá-los e as várias interações entre eles.</span><span class="sxs-lookup"><span data-stu-id="edd9d-106">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="edd9d-107">Sessões</span><span class="sxs-lookup"><span data-stu-id="edd9d-107">Sessions</span></span>  
 <span data-ttu-id="edd9d-108">Quando um contrato de serviço define a <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> propriedade para <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, esse contrato está dizendo que todas as chamadas (ou seja, as subjacente trocas de mensagens que oferecem suporte as chamadas) devem ser parte da mesma conversa.</span><span class="sxs-lookup"><span data-stu-id="edd9d-108">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="edd9d-109">Se um contrato especifica que ele permite que as sessões, mas não exige um, os clientes podem se conectar e a estabelecer uma sessão ou não.</span><span class="sxs-lookup"><span data-stu-id="edd9d-109">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="edd9d-110">Se a sessão termina e uma mensagem é enviada sobre o mesmo com base em sessão canal uma exceção é lançada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-110">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="edd9d-111">As sessões WCF têm os seguintes recursos de conceituais principais:</span><span class="sxs-lookup"><span data-stu-id="edd9d-111">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="edd9d-112">Eles são explicitamente iniciados e encerrados pelo aplicativo de chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-112">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="edd9d-113">Mensagens entregues durante uma sessão são processadas na ordem em que elas são recebidas.</span><span class="sxs-lookup"><span data-stu-id="edd9d-113">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="edd9d-114">Sessões de correlação um grupo de mensagens em uma conversa.</span><span class="sxs-lookup"><span data-stu-id="edd9d-114">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="edd9d-115">O significado dessa correlação é uma abstração.</span><span class="sxs-lookup"><span data-stu-id="edd9d-115">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="edd9d-116">Por exemplo, um canal com base em sessão pode correlacionar mensagens com base em uma conexão de rede compartilhado, enquanto outro canal com base em sessão pode correlacionar mensagens com base em uma marca compartilhada no corpo da mensagem.</span><span class="sxs-lookup"><span data-stu-id="edd9d-116">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="edd9d-117">Os recursos que podem ser derivados da sessão dependem da natureza da correlação.</span><span class="sxs-lookup"><span data-stu-id="edd9d-117">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="edd9d-118">Não há nenhum armazenamento de dados gerais associado com uma sessão do WCF.</span><span class="sxs-lookup"><span data-stu-id="edd9d-118">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="edd9d-119">Se você estiver familiarizado com o <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> classe em aplicativos ASP.NET e a funcionalidade que ele fornece, você pode observar as seguintes diferenças entre esse tipo de sessão e as sessões WCF:</span><span class="sxs-lookup"><span data-stu-id="edd9d-119">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="edd9d-120">Sessões do ASP.NET são sempre iniciadas pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="edd9d-120">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="edd9d-121">Sessões do ASP.NET são implicitamente ordenadas.</span><span class="sxs-lookup"><span data-stu-id="edd9d-121">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="edd9d-122">Sessões do ASP.NET fornecem um mecanismo de armazenamento de dados geral em todas as solicitações.</span><span class="sxs-lookup"><span data-stu-id="edd9d-122">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="edd9d-123">Aplicativos cliente e aplicativos de serviço interagem com sessões de maneiras diferentes.</span><span class="sxs-lookup"><span data-stu-id="edd9d-123">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="edd9d-124">Aplicativos cliente iniciam as sessões e, em seguida, recebem e processam as mensagens enviadas dentro da sessão.</span><span class="sxs-lookup"><span data-stu-id="edd9d-124">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="edd9d-125">Aplicativos de serviço podem usar sessões como um ponto de extensibilidade para adicionar um comportamento adicional.</span><span class="sxs-lookup"><span data-stu-id="edd9d-125">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="edd9d-126">Isso é feito ao trabalhar diretamente com o <xref:System.ServiceModel.InstanceContext> ou implementando um provedor de contexto personalizado de instância.</span><span class="sxs-lookup"><span data-stu-id="edd9d-126">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="edd9d-127">Instanciação</span><span class="sxs-lookup"><span data-stu-id="edd9d-127">Instancing</span></span>  
 <span data-ttu-id="edd9d-128">O comportamento de instanciação (definido usando o <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade) controles como o <xref:System.ServiceModel.InstanceContext> é criada em resposta às mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-128">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="edd9d-129">Por padrão, cada <xref:System.ServiceModel.InstanceContext> está associado um objeto de serviço definido pelo usuário, então (no caso padrão) configuração de <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> propriedade também controla a instanciação de objetos de serviço definido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="edd9d-129">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="edd9d-130">O <xref:System.ServiceModel.InstanceContextMode> enumeração define os modos de instanciação.</span><span class="sxs-lookup"><span data-stu-id="edd9d-130">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="edd9d-131">Modos de instanciação a seguir estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="edd9d-131">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="edd9d-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: Um novo <xref:System.ServiceModel.InstanceContext> (e, portanto, o objeto de serviço) é criado para cada solicitação de cliente.</span><span class="sxs-lookup"><span data-stu-id="edd9d-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="edd9d-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: Um novo <xref:System.ServiceModel.InstanceContext> (e, portanto, o objeto de serviço) é criado para cada nova sessão de cliente e mantido pelo tempo de vida da sessão em questão (Isso requer uma associação que dá suporte a sessões).</span><span class="sxs-lookup"><span data-stu-id="edd9d-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="edd9d-134"><xref:System.ServiceModel.InstanceContextMode.Single>: Um único <xref:System.ServiceModel.InstanceContext> (e, portanto, o objeto de serviço) lida com todas as solicitações de cliente para o tempo de vida do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="edd9d-134"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="edd9d-135">O exemplo de código a seguir mostra o padrão <xref:System.ServiceModel.InstanceContextMode> valor, <xref:System.ServiceModel.InstanceContextMode.PerSession> explicitamente que está sendo definida em uma classe de serviço.</span><span class="sxs-lookup"><span data-stu-id="edd9d-135">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]   
public class CalculatorService : ICalculatorInstance   
{   
    ...  
}  
```  
  
 <span data-ttu-id="edd9d-136">E enquanto o <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade controla a frequência com que o <xref:System.ServiceModel.InstanceContext> é liberado, o <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> e <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> propriedades controlam quando o objeto de serviço é liberado.</span><span class="sxs-lookup"><span data-stu-id="edd9d-136">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="edd9d-137">Serviços Singleton conhecido</span><span class="sxs-lookup"><span data-stu-id="edd9d-137">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="edd9d-138">Uma variação em objetos de única instância de serviço às vezes é útil: você pode criar um objeto de serviço por conta própria e criar o host de serviço usando esse objeto.</span><span class="sxs-lookup"><span data-stu-id="edd9d-138">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="edd9d-139">Para fazer isso, você também deve definir a <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade para <xref:System.ServiceModel.InstanceContextMode.Single> ou uma exceção é lançada quando o host de serviço é aberto.</span><span class="sxs-lookup"><span data-stu-id="edd9d-139">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="edd9d-140">Use o <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> construtor para criar esse tipo de serviço.</span><span class="sxs-lookup"><span data-stu-id="edd9d-140">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> constructor to create such a service.</span></span> <span data-ttu-id="edd9d-141">Ele fornece uma alternativa à implementação de uma <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> quando você deseja fornecer uma instância de objeto específico para uso por um serviço singleton.</span><span class="sxs-lookup"><span data-stu-id="edd9d-141">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="edd9d-142">Você pode usar essa sobrecarga ao seu tipo de implementação de serviço é difícil construir (por exemplo, se ele não implementa um construtor público padrão sem parâmetros).</span><span class="sxs-lookup"><span data-stu-id="edd9d-142">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a default parameterless public constructor).</span></span>  
  
 <span data-ttu-id="edd9d-143">Observe que quando um objeto é fornecido para esse construtor, alguns recursos relacionados para o Windows Communication Foundation (WCF) comportamento de instanciação funcionam de forma diferente.</span><span class="sxs-lookup"><span data-stu-id="edd9d-143">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="edd9d-144">Por exemplo, chamar <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> não tem nenhum efeito quando uma instância do objeto de singleton é fornecida.</span><span class="sxs-lookup"><span data-stu-id="edd9d-144">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="edd9d-145">Da mesma forma, qualquer outro mecanismo de versão da instância é ignorado.</span><span class="sxs-lookup"><span data-stu-id="edd9d-145">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="edd9d-146">O <xref:System.ServiceModel.ServiceHost> sempre se comporta como se o <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> estiver definida como <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> para todas as operações.</span><span class="sxs-lookup"><span data-stu-id="edd9d-146">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="edd9d-147">Compartilhando objetos InstanceContext</span><span class="sxs-lookup"><span data-stu-id="edd9d-147">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="edd9d-148">Você também pode controlar qual canal de sessão ou chamada está associada com a qual <xref:System.ServiceModel.InstanceContext> objeto executando essa associação por conta própria.</span><span class="sxs-lookup"><span data-stu-id="edd9d-148">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="edd9d-149">Concorrência</span><span class="sxs-lookup"><span data-stu-id="edd9d-149">Concurrency</span></span>  
 <span data-ttu-id="edd9d-150">Simultaneidade é o controle do número de threads ativos em um <xref:System.ServiceModel.InstanceContext> a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="edd9d-150">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="edd9d-151">Isso é controlado usando o <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> com o <xref:System.ServiceModel.ConcurrencyMode> enumeração.</span><span class="sxs-lookup"><span data-stu-id="edd9d-151">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="edd9d-152">Os três modos de simultaneidade a seguir estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="edd9d-152">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="edd9d-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Cada contexto de instância tem permissão para ter um máximo de um thread de processamento de mensagens no contexto de instância por vez.</span><span class="sxs-lookup"><span data-stu-id="edd9d-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="edd9d-154">Outros threads que queiram usar o mesmo contexto de instância devem bloquear até que o thread original será encerrado o contexto da instância.</span><span class="sxs-lookup"><span data-stu-id="edd9d-154">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="edd9d-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Cada instância de serviço pode ter vários threads de processamento de mensagens simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="edd9d-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="edd9d-156">A implementação do serviço deve ser thread-safe para usar esse modo de simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="edd9d-156">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="edd9d-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Cada instância de serviço processa uma mensagem por vez, mas aceita chamadas reentrantes de operação.</span><span class="sxs-lookup"><span data-stu-id="edd9d-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="edd9d-158">O serviço aceita somente essas chamadas quando ela é chamada por meio de um objeto de cliente do WCF.</span><span class="sxs-lookup"><span data-stu-id="edd9d-158">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="edd9d-159">Entender e desenvolver o código que usa com segurança a mais de um thread podem ser difícil de escrever com êxito.</span><span class="sxs-lookup"><span data-stu-id="edd9d-159">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="edd9d-160">Antes de usar <xref:System.ServiceModel.ConcurrencyMode.Multiple> ou <xref:System.ServiceModel.ConcurrencyMode.Reentrant> valores, certifique-se de que seu serviço está corretamente projetado para esses modos.</span><span class="sxs-lookup"><span data-stu-id="edd9d-160">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="edd9d-161">Para obter mais informações, consulte <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="edd9d-161">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="edd9d-162">O uso de simultaneidade está relacionado ao modo de instanciação.</span><span class="sxs-lookup"><span data-stu-id="edd9d-162">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="edd9d-163">Na <xref:System.ServiceModel.InstanceContextMode.PerCall> instanciamento, simultaneidade não for relevante, porque cada mensagem é processada por um novo <xref:System.ServiceModel.InstanceContext> e, portanto, nunca mais de um thread está ativo no <xref:System.ServiceModel.InstanceContext>.</span><span class="sxs-lookup"><span data-stu-id="edd9d-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="edd9d-164">O exemplo de código a seguir demonstra a configuração de <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> propriedade para <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span><span class="sxs-lookup"><span data-stu-id="edd9d-164">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```  
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]   
public class CalculatorService : ICalculatorConcurrency   
{   
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="edd9d-165">Sessões de interagem com as configurações de InstanceContext</span><span class="sxs-lookup"><span data-stu-id="edd9d-165">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="edd9d-166">Sessões e <xref:System.ServiceModel.InstanceContext> interagir de acordo com a combinação do valor da <xref:System.ServiceModel.SessionMode> enumeração em um contrato e o <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade sobre a implementação de serviço, que controla a associação entre canais e específicas objetos de serviço.</span><span class="sxs-lookup"><span data-stu-id="edd9d-166">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="edd9d-167">A tabela a seguir mostra o resultado de um canal de entrada que dão suporte a sessões ou não dar suporte a sessões a combinação dos valores de um serviço dada a <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> propriedade e o <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> propriedade.</span><span class="sxs-lookup"><span data-stu-id="edd9d-167">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="edd9d-168">Valor InstanceContextMode</span><span class="sxs-lookup"><span data-stu-id="edd9d-168">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="edd9d-169">PerCall</span><span class="sxs-lookup"><span data-stu-id="edd9d-169">PerCall</span></span>|<span data-ttu-id="edd9d-170">-Comportamento com o canal de sessão: Uma sessão e <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-170">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="edd9d-171">-Comportamento com canal sem sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-171">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="edd9d-172">-Comportamento com o canal de sessão: Uma sessão e <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-172">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="edd9d-173">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-173">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="edd9d-174">-Comportamento com o canal de sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-174">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="edd9d-175">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-175">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="edd9d-176">PerSession</span><span class="sxs-lookup"><span data-stu-id="edd9d-176">PerSession</span></span>|<span data-ttu-id="edd9d-177">-Comportamento com o canal de sessão: Uma sessão e <xref:System.ServiceModel.InstanceContext> para cada canal.</span><span class="sxs-lookup"><span data-stu-id="edd9d-177">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="edd9d-178">-Comportamento com canal sem sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-178">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="edd9d-179">-Comportamento com o canal de sessão: Uma sessão e <xref:System.ServiceModel.InstanceContext> para cada canal.</span><span class="sxs-lookup"><span data-stu-id="edd9d-179">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="edd9d-180">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-180">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="edd9d-181">-Comportamento com o canal de sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-181">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="edd9d-182">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-182">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="edd9d-183">Simples</span><span class="sxs-lookup"><span data-stu-id="edd9d-183">Single</span></span>|<span data-ttu-id="edd9d-184">-Comportamento com o canal de sessão: Uma sessão e um <xref:System.ServiceModel.InstanceContext> para todas as chamadas.</span><span class="sxs-lookup"><span data-stu-id="edd9d-184">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="edd9d-185">-Comportamento com canal sem sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-185">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="edd9d-186">-Comportamento com o canal de sessão: Uma sessão e <xref:System.ServiceModel.InstanceContext> para o singleton criado ou especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="edd9d-186">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="edd9d-187">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para o singleton criado ou especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="edd9d-187">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="edd9d-188">-Comportamento com o canal de sessão: Uma exceção é gerada.</span><span class="sxs-lookup"><span data-stu-id="edd9d-188">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="edd9d-189">-Comportamento com canal sem sessão: Um <xref:System.ServiceModel.InstanceContext> para cada singleton criado ou para o singleton especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="edd9d-189">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="edd9d-190">Consulte também</span><span class="sxs-lookup"><span data-stu-id="edd9d-190">See also</span></span>

- [<span data-ttu-id="edd9d-191">Usando sessões</span><span class="sxs-lookup"><span data-stu-id="edd9d-191">Using Sessions</span></span>](../../../../docs/framework/wcf/using-sessions.md)
- [<span data-ttu-id="edd9d-192">Como: Criar um serviço que requer sessões</span><span class="sxs-lookup"><span data-stu-id="edd9d-192">How to: Create a Service That Requires Sessions</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="edd9d-193">Como: Controlar instanciação de serviço</span><span class="sxs-lookup"><span data-stu-id="edd9d-193">How to: Control Service Instancing</span></span>](../../../../docs/framework/wcf/feature-details/how-to-control-service-instancing.md)
- [<span data-ttu-id="edd9d-194">Simultaneidade</span><span class="sxs-lookup"><span data-stu-id="edd9d-194">Concurrency</span></span>](../../../../docs/framework/wcf/samples/concurrency.md)
- [<span data-ttu-id="edd9d-195">Instanciação</span><span class="sxs-lookup"><span data-stu-id="edd9d-195">Instancing</span></span>](../../../../docs/framework/wcf/samples/instancing.md)
- [<span data-ttu-id="edd9d-196">Sessão</span><span class="sxs-lookup"><span data-stu-id="edd9d-196">Session</span></span>](../../../../docs/framework/wcf/samples/session.md)
