---
title: Escolhendo um codificador de mensagem
ms.date: 03/30/2017
ms.assetid: 2204d82d-d962-4922-a79e-c9a231604f19
ms.openlocfilehash: fd5bc2270f2e4095ef6ad2b1d89af3560fb8d312
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90559364"
---
# <a name="choose-a-message-encoder"></a><span data-ttu-id="d8c22-102">Escolher um codificador de mensagem</span><span class="sxs-lookup"><span data-stu-id="d8c22-102">Choose a Message Encoder</span></span>

<span data-ttu-id="d8c22-103">Este artigo discute os critérios para escolher entre os codificadores de mensagem que estão incluídos no Windows Communication Foundation (WCF): binário, texto e MTOM (mecanismo de otimização de transmissão de mensagens).</span><span class="sxs-lookup"><span data-stu-id="d8c22-103">This article discusses criteria for choosing among the message encoders that are included in Windows Communication Foundation (WCF): binary, text, and Message Transmission Optimization Mechanism (MTOM).</span></span>  
  
 <span data-ttu-id="d8c22-104">No WCF, você especifica como transferir dados em uma rede entre pontos de extremidade por meio de uma *Associação*, que é composta de uma sequência de elementos de *Associação*.</span><span class="sxs-lookup"><span data-stu-id="d8c22-104">In WCF, you specify how to transfer data across a network between endpoints by means of a *binding*, which is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="d8c22-105">Um codificador de mensagem é representado por um elemento de ligação de codificação de mensagem na pilha de associação.</span><span class="sxs-lookup"><span data-stu-id="d8c22-105">A message encoder is represented by a message encoding binding element in the binding stack.</span></span> <span data-ttu-id="d8c22-106">Uma associação inclui elementos de associação de protocolo opcionais, como um elemento de associação de segurança ou um elemento de associação de mensagens confiáveis, um elemento de associação de codificação de mensagem necessário e um elemento de associação de transporte necessário.</span><span class="sxs-lookup"><span data-stu-id="d8c22-106">A binding includes optional protocol binding elements, such as a security binding element or reliable messaging binding element, a required message encoding binding element, and a required transport binding element.</span></span>  
  
 <span data-ttu-id="d8c22-107">O elemento de associação de codificação de mensagens está abaixo dos elementos opcionais de associação de protocolo e acima do elemento de associação de transporte necessário.</span><span class="sxs-lookup"><span data-stu-id="d8c22-107">The message encoding binding element sits below the optional protocol binding elements and above the required transport binding element.</span></span> <span data-ttu-id="d8c22-108">No lado de saída, um codificador de mensagem serializa o saída <xref:System.ServiceModel.Channels.Message> e o passa para o transporte.</span><span class="sxs-lookup"><span data-stu-id="d8c22-108">On the outgoing side, a message encoder serializes the outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport.</span></span> <span data-ttu-id="d8c22-109">No lado de entrada, um codificador de mensagem recebe a forma serializada de um <xref:System.ServiceModel.Channels.Message> do transporte e a passa para a camada de protocolo mais alta, se presente, ou para o aplicativo, se não.</span><span class="sxs-lookup"><span data-stu-id="d8c22-109">On the incoming side, a message encoder receives the serialized form of a <xref:System.ServiceModel.Channels.Message> from the transport and passes it to the higher protocol layer, if present, or to the application, if not.</span></span>  
  
 <span data-ttu-id="d8c22-110">Ao se conectar a um cliente ou servidor pré-existente, talvez você não tenha a opção de usar uma codificação de mensagem específica, já que precisa codificar suas mensagens de uma forma que o outro lado esteja esperando.</span><span class="sxs-lookup"><span data-stu-id="d8c22-110">When connecting to a pre-existing client or server, you may not have a choice about using a particular message encoding since you need to encode your messages in a way that the other side is expecting.</span></span> <span data-ttu-id="d8c22-111">No entanto, se você estiver escrevendo um serviço WCF, poderá expor seu serviço por meio de vários pontos de extremidade, cada um usando uma codificação de mensagem diferente.</span><span class="sxs-lookup"><span data-stu-id="d8c22-111">However, if you are writing a WCF service, you can expose your service through multiple endpoints, each using a different message encoding.</span></span> <span data-ttu-id="d8c22-112">Isso permite que os clientes escolham a melhor codificação para conversar com seu serviço sobre o ponto de extremidade que é melhor para eles, além de dar aos seus clientes a flexibilidade de escolher a codificação mais adequada para eles.</span><span class="sxs-lookup"><span data-stu-id="d8c22-112">This allows clients to choose the best encoding for talking to your service over the endpoint that is best for them, as well as giving your clients the flexibility to choose the encoding that is best for them.</span></span> <span data-ttu-id="d8c22-113">O uso de vários pontos de extremidade também permite combinar as vantagens de diferentes codificações de mensagens com outros elementos de ligação.</span><span class="sxs-lookup"><span data-stu-id="d8c22-113">Using multiple endpoints also allows you to combine the advantages of different message encodings with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="d8c22-114">Codificadores fornecidos pelo sistema</span><span class="sxs-lookup"><span data-stu-id="d8c22-114">System-Provided Encoders</span></span>  
 <span data-ttu-id="d8c22-115">O WCF inclui três codificadores de mensagens, que são representados pelas três classes a seguir:</span><span class="sxs-lookup"><span data-stu-id="d8c22-115">WCF includes three message encoders, which are represented by the following three classes:</span></span>  
  
- <span data-ttu-id="d8c22-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>, o codificador de mensagem de texto oferece suporte tanto à codificação XML simples quanto à codificação SOAP.</span><span class="sxs-lookup"><span data-stu-id="d8c22-116"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>, the text message encoder, supports both plain XML encoding and SOAP encoding.</span></span> <span data-ttu-id="d8c22-117">O modo de codificação XML sem formatação do codificador de mensagem de texto é chamado de "XML antigo" (POX) para distingui-lo da codificação SOAP baseada em texto.</span><span class="sxs-lookup"><span data-stu-id="d8c22-117">The plain XML encoding mode of the text message encoder is called "plain old XML" (POX) to distinguish it from text-based SOAP encoding.</span></span> <span data-ttu-id="d8c22-118">Para habilitar POX, defina a <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> propriedade como <xref:System.ServiceModel.Channels.MessageVersion.None%2A> .</span><span class="sxs-lookup"><span data-stu-id="d8c22-118">To enable POX, set the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement.MessageVersion%2A> property to <xref:System.ServiceModel.Channels.MessageVersion.None%2A>.</span></span> <span data-ttu-id="d8c22-119">Use o codificador de mensagem de texto para interoperar com pontos de extremidade não WCF.</span><span class="sxs-lookup"><span data-stu-id="d8c22-119">Use the text message encoder to interoperate with non-WCF endpoints.</span></span>  
  
- <span data-ttu-id="d8c22-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, o codificador de mensagem binária usa um formato binário compacto e é otimizado para comunicação WCF para WCF e, portanto, não é interoperável.</span><span class="sxs-lookup"><span data-stu-id="d8c22-120"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, the binary message encoder, uses a compact binary format and is optimized for WCF to WCF communication, and hence is not interoperable.</span></span> <span data-ttu-id="d8c22-121">Esse também é o codificador de melhor desempenho de todos os concodificadores que o WCF fornece.</span><span class="sxs-lookup"><span data-stu-id="d8c22-121">This is also the most performant encoder of all the encoders WCF provides.</span></span>  
  
- <span data-ttu-id="d8c22-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, o elemento Binding, especifica a codificação de caracteres e o controle de versão de mensagem para mensagens usando a codificação MTOM.</span><span class="sxs-lookup"><span data-stu-id="d8c22-122"><xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the binding element, specifies the character encoding and message versioning for messages using MTOM encoding.</span></span> <span data-ttu-id="d8c22-123">O MTOM é uma tecnologia eficiente para transmitir dados binários em mensagens do WCF.</span><span class="sxs-lookup"><span data-stu-id="d8c22-123">MTOM is an efficient technology for transmitting binary data in WCF messages.</span></span> <span data-ttu-id="d8c22-124">O codificador MTOM tenta criar um equilíbrio entre eficiência e interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="d8c22-124">The MTOM encoder attempts to create a balance between efficiency and interoperability.</span></span> <span data-ttu-id="d8c22-125">A codificação MTOM transmite a maioria dos XML na forma textual, mas otimiza grandes blocos de dados binários transmitindo-os como estão, sem conversão em texto.</span><span class="sxs-lookup"><span data-stu-id="d8c22-125">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span> <span data-ttu-id="d8c22-126">Em termos de eficiência, entre os codificadores que o WCF fornece, o MTOM está entre o texto (o mais lento) e o binário (o mais rápido).</span><span class="sxs-lookup"><span data-stu-id="d8c22-126">In terms of efficiency, among the encoders WCF provides, MTOM is in-between text (the slowest) and binary (the fastest).</span></span>  
  
## <a name="how-to-choose-a-message-encoder"></a><span data-ttu-id="d8c22-127">Como escolher um codificador de mensagem</span><span class="sxs-lookup"><span data-stu-id="d8c22-127">How to Choose a Message Encoder</span></span>  
 <span data-ttu-id="d8c22-128">A tabela a seguir descreve os fatores comuns usados para escolher um codificador de mensagem.</span><span class="sxs-lookup"><span data-stu-id="d8c22-128">The following table describes common factors used to choose a message encoder.</span></span> <span data-ttu-id="d8c22-129">Priorize os fatores que são importantes para seu aplicativo e, em seguida, escolha os codificadores de mensagem que funcionam melhor com esses fatores.</span><span class="sxs-lookup"><span data-stu-id="d8c22-129">Prioritize the factors that are important for your application, and then choose the message encoders that work best with these factors.</span></span> <span data-ttu-id="d8c22-130">Certifique-se de considerar quaisquer fatores adicionais não listados nesta tabela e quaisquer codificadores de mensagem personalizados que possam ser necessários em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8c22-130">Be sure to consider any additional factors not listed in this table and any custom message encoders that may be required in your application.</span></span>  
  
|<span data-ttu-id="d8c22-131">Fator</span><span class="sxs-lookup"><span data-stu-id="d8c22-131">Factor</span></span>|<span data-ttu-id="d8c22-132">Description</span><span class="sxs-lookup"><span data-stu-id="d8c22-132">Description</span></span>|<span data-ttu-id="d8c22-133">Codificadores que dão suporte a esse fator</span><span class="sxs-lookup"><span data-stu-id="d8c22-133">Encoders that support this factor</span></span>|  
|------------|-----------------|---------------------------------------|  
|<span data-ttu-id="d8c22-134">Conjuntos de caracteres com suporte</span><span class="sxs-lookup"><span data-stu-id="d8c22-134">Supported Character Sets</span></span>|<span data-ttu-id="d8c22-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> e <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> dão suporte apenas às codificações UTF8 e UTF16 Unicode (*big-endian* e *little-endian*).</span><span class="sxs-lookup"><span data-stu-id="d8c22-135"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> and <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement> support only the UTF8 and UTF16 Unicode (*big-endian* and *little-endian*) encodings.</span></span> <span data-ttu-id="d8c22-136">Se outras codificações forem necessárias, como UTF7 ou ASCII, um codificador personalizado deverá ser usado.</span><span class="sxs-lookup"><span data-stu-id="d8c22-136">If other encodings are required, such as UTF7 or ASCII, a custom encoder must be used.</span></span> <span data-ttu-id="d8c22-137">Para obter um codificador personalizado de exemplo, consulte [codificador de mensagem personalizada](../samples/custom-message-encoder-custom-text-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="d8c22-137">For a sample custom encoder, see [Custom Message Encoder](../samples/custom-message-encoder-custom-text-encoder.md).</span></span>|<span data-ttu-id="d8c22-138">Texto</span><span class="sxs-lookup"><span data-stu-id="d8c22-138">Text</span></span>|  
|<span data-ttu-id="d8c22-139">Inspeção</span><span class="sxs-lookup"><span data-stu-id="d8c22-139">Inspection</span></span>|<span data-ttu-id="d8c22-140">A inspeção é a capacidade de examinar as mensagens durante a transmissão.</span><span class="sxs-lookup"><span data-stu-id="d8c22-140">Inspection is the ability to examine messages during transmission.</span></span> <span data-ttu-id="d8c22-141">Codificações de texto, com ou sem o uso de SOAP, permitem que as mensagens sejam inspecionadas e analisadas por muitos aplicativos sem o uso de ferramentas especializadas.</span><span class="sxs-lookup"><span data-stu-id="d8c22-141">Text encodings, either with or without the use of SOAP, allow messages to be inspected and analyzed by many applications without the use of specialized tools.</span></span> <span data-ttu-id="d8c22-142">O uso da segurança de transferência, no nível de mensagem ou de transporte, afeta sua capacidade de inspecionar mensagens.</span><span class="sxs-lookup"><span data-stu-id="d8c22-142">The use of transfer security, at either the message or transport level, affects your ability to inspect messages.</span></span> <span data-ttu-id="d8c22-143">A confidencialidade protege uma mensagem de ser examinada e a integridade protege a modificação de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="d8c22-143">Confidentiality protects a message from being examined and integrity protects a message from being modified.</span></span>|<span data-ttu-id="d8c22-144">Texto</span><span class="sxs-lookup"><span data-stu-id="d8c22-144">Text</span></span>|  
|<span data-ttu-id="d8c22-145">Confiabilidade</span><span class="sxs-lookup"><span data-stu-id="d8c22-145">Reliability</span></span>|<span data-ttu-id="d8c22-146">Confiabilidade é a resiliência de um codificador para erros de transmissão.</span><span class="sxs-lookup"><span data-stu-id="d8c22-146">Reliability is the resiliency of an encoder to transmission errors.</span></span> <span data-ttu-id="d8c22-147">A confiabilidade também pode ser fornecida na mensagem, no transporte ou na camada de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8c22-147">Reliability can also be provided at the message, transport, or application layer.</span></span> <span data-ttu-id="d8c22-148">Todos os codificadores do WCF padrão pressupõem que outra camada esteja fornecendo confiabilidade.</span><span class="sxs-lookup"><span data-stu-id="d8c22-148">All of the standard WCF encoders assume that another layer is providing reliability.</span></span> <span data-ttu-id="d8c22-149">O codificador tem pouca capacidade de se recuperar de um erro de transmissão.</span><span class="sxs-lookup"><span data-stu-id="d8c22-149">The encoder has little ability to recover from a transmission error.</span></span>|<span data-ttu-id="d8c22-150">Nenhum</span><span class="sxs-lookup"><span data-stu-id="d8c22-150">None</span></span>|  
|<span data-ttu-id="d8c22-151">Simplicidade</span><span class="sxs-lookup"><span data-stu-id="d8c22-151">Simplicity</span></span>|<span data-ttu-id="d8c22-152">A simplicidade representa a facilidade com a qual você pode criar codificadores e decodificadores para uma especificação de codificação.</span><span class="sxs-lookup"><span data-stu-id="d8c22-152">Simplicity represents the ease with which you can create encoders and decoders for an encoding specification.</span></span> <span data-ttu-id="d8c22-153">As codificações de texto são particularmente vantajosas para simplificar, e a codificação de texto POX tem a vantagem adicional de não exigir suporte para o processamento de SOAP.</span><span class="sxs-lookup"><span data-stu-id="d8c22-153">Text encodings are particularly advantageous for simplicity, and the POX text encoding has the additional advantage of not requiring support for processing SOAP.</span></span>|<span data-ttu-id="d8c22-154">Texto (POX)</span><span class="sxs-lookup"><span data-stu-id="d8c22-154">Text (POX)</span></span>|  
|<span data-ttu-id="d8c22-155">Tamanho</span><span class="sxs-lookup"><span data-stu-id="d8c22-155">Size</span></span>|<span data-ttu-id="d8c22-156">A codificação determina a quantidade de sobrecarga imposta no conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d8c22-156">The encoding determines the amount of overhead imposed on content.</span></span> <span data-ttu-id="d8c22-157">O tamanho das mensagens codificadas está diretamente relacionado à taxa de transferência máxima de operações de serviço.</span><span class="sxs-lookup"><span data-stu-id="d8c22-157">The size of encoded messages is directly related to the maximum throughput of service operations.</span></span> <span data-ttu-id="d8c22-158">Em geral, as codificações binárias são mais compactas do que codificações de texto.</span><span class="sxs-lookup"><span data-stu-id="d8c22-158">Binary encodings are generally more compact than text encodings.</span></span> <span data-ttu-id="d8c22-159">Quando o tamanho da mensagem estiver em um nível Premium, considere também compactar o conteúdo da mensagem durante a codificação.</span><span class="sxs-lookup"><span data-stu-id="d8c22-159">When message size is at a premium, consider also compressing the message contents during encoding.</span></span> <span data-ttu-id="d8c22-160">No entanto, a compactação adiciona custos de processamento para o remetente e o destinatário da mensagem.</span><span class="sxs-lookup"><span data-stu-id="d8c22-160">However, compression adds processing costs for both the message sender and receiver.</span></span>|<span data-ttu-id="d8c22-161">Binário</span><span class="sxs-lookup"><span data-stu-id="d8c22-161">Binary</span></span>|  
|<span data-ttu-id="d8c22-162">Streaming</span><span class="sxs-lookup"><span data-stu-id="d8c22-162">Streaming</span></span>|<span data-ttu-id="d8c22-163">O streaming permite que os aplicativos comecem a processar uma mensagem antes que toda a mensagem tenha chegado.</span><span class="sxs-lookup"><span data-stu-id="d8c22-163">Streaming allows applications to begin processing a message before the entire message has arrived.</span></span> <span data-ttu-id="d8c22-164">Usar o streaming com eficiência requer que os dados importantes de uma mensagem estejam disponíveis no início da mensagem para que o aplicativo de recebimento não precise esperar que ele chegue.</span><span class="sxs-lookup"><span data-stu-id="d8c22-164">Effectively using streaming requires that the important data for a message be available at the beginning of the message so that the receiving application is not required to wait for it to arrive.</span></span> <span data-ttu-id="d8c22-165">Além disso, os aplicativos que usam transferência em fluxo devem organizar os dados na mensagem de forma incremental para que o conteúdo não tenha dependências de encaminhamento.</span><span class="sxs-lookup"><span data-stu-id="d8c22-165">Moreover, applications that use streamed transfer must organize data in the message incrementally so that the content does not have forward dependencies.</span></span> <span data-ttu-id="d8c22-166">Em muitos casos, você deve comprometer entre o conteúdo de streaming e ter o menor tamanho de transferência possível para esse conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d8c22-166">In many cases, you must compromise between streaming content and having the smallest possible transfer size for that content.</span></span>|<span data-ttu-id="d8c22-167">Nenhum</span><span class="sxs-lookup"><span data-stu-id="d8c22-167">None</span></span>|  
|<span data-ttu-id="d8c22-168">Suporte a ferramentas de terceiros</span><span class="sxs-lookup"><span data-stu-id="d8c22-168">Third-Party Tool Support</span></span>|<span data-ttu-id="d8c22-169">As áreas de suporte para uma codificação incluem desenvolvimento e diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="d8c22-169">Support areas for an encoding include development and diagnosis.</span></span> <span data-ttu-id="d8c22-170">Os desenvolvedores de terceiros fizeram um grande investimento em bibliotecas e kits de programas para lidar com mensagens codificadas no formato POX.</span><span class="sxs-lookup"><span data-stu-id="d8c22-170">Third-party developers have made a large investment in libraries and toolkits for handling messages encoded in the POX format.</span></span>|<span data-ttu-id="d8c22-171">Texto (POX)</span><span class="sxs-lookup"><span data-stu-id="d8c22-171">Text (POX)</span></span>|  
|<span data-ttu-id="d8c22-172">Interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="d8c22-172">Interoperability</span></span>|<span data-ttu-id="d8c22-173">Esse fator refere-se à capacidade de um codificador do WCF interoperar com serviços não WCF.</span><span class="sxs-lookup"><span data-stu-id="d8c22-173">This factor refers to the ability of a WCF encoder to interoperate with non-WCF services.</span></span>|<span data-ttu-id="d8c22-174">Texto</span><span class="sxs-lookup"><span data-stu-id="d8c22-174">Text</span></span><br /><br /> <span data-ttu-id="d8c22-175">MTOM (parcial)</span><span class="sxs-lookup"><span data-stu-id="d8c22-175">MTOM (partial)</span></span>|  
  
<span data-ttu-id="d8c22-176">Observação: ao usar o codificador binário, o uso da configuração IgnoreWhitespace ao criar um XMLReader não terá nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="d8c22-176">Note: When using the Binary Encoder, using the IgnoreWhitespace setting when creating a XMLReader will have no effect.</span></span>  <span data-ttu-id="d8c22-177">Por exemplo, se você fizer o seguinte dentro de uma operação de serviço:</span><span class="sxs-lookup"><span data-stu-id="d8c22-177">For example, if you do the following inside a service operation:</span></span>  

```csharp
public void OperationContract(XElement input)
{
    Console.WriteLine("{0}", input.Value);
    int counter = 0;
    var xreader = input.CreateReader();
    var reader = XmlReader.Create(xreader, new XmlReaderSettings() { IgnoreWhitespace = true });
    while (reader.Read())
    {
        counter++;
    }

    Console.WriteLine("Read {0} lines with reader", counter);
}
```  
  
<span data-ttu-id="d8c22-178">A configuração IgnoreWhitespace é ignorada.</span><span class="sxs-lookup"><span data-stu-id="d8c22-178">The IgnoreWhitespace setting is ignored.</span></span>  
  
## <a name="compression-and-the-binary-encoder"></a><span data-ttu-id="d8c22-179">Compactação e o codificador binário</span><span class="sxs-lookup"><span data-stu-id="d8c22-179">Compression and the Binary Encoder</span></span>

<span data-ttu-id="d8c22-180">A partir do WCF 4.5, o codificador binário do WCF adiciona suporte para compactação.</span><span class="sxs-lookup"><span data-stu-id="d8c22-180">Beginning with WCF 4.5 the WCF binary encoder adds support for compression.</span></span> <span data-ttu-id="d8c22-181">Isso permite que você use o algoritmo gzip/deflat para enviar mensagens compactadas de um cliente WCF e também responder com mensagens compactadas de um serviço WCF hospedado internamente.</span><span class="sxs-lookup"><span data-stu-id="d8c22-181">This enables you to use the gzip/deflate algorithm for sending compressed messages from a WCF client and also respond with compressed messages from a self-hosted WCF service.</span></span> <span data-ttu-id="d8c22-182">Esse recurso habilita a compactação nos transportes HTTP e TCP.</span><span class="sxs-lookup"><span data-stu-id="d8c22-182">This feature enables compression on both the HTTP and TCP transports.</span></span> <span data-ttu-id="d8c22-183">Um serviço WCF hospedado do IIS sempre pode ser habilitado para enviar respostas compactadas Configurando o servidor host IIS.</span><span class="sxs-lookup"><span data-stu-id="d8c22-183">An IIS hosted WCF service can always be enabled for sending compressed responses by configuring the IIS host server.</span></span> <span data-ttu-id="d8c22-184">O tipo de compactação é configurado com a propriedade <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="d8c22-184">The type of compression is configured with the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement.CompressionFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="d8c22-185">Essa propriedade é definida como um dos <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType> valores de enumeração:</span><span class="sxs-lookup"><span data-stu-id="d8c22-185">This property is set to one of the <xref:System.ServiceModel.Channels.CompressionFormat?displayProperty=nameWithType> enum values:</span></span>

- <xref:System.ServiceModel.Channels.CompressionFormat.Deflate>
- <xref:System.ServiceModel.Channels.CompressionFormat.GZip>
- <xref:System.ServiceModel.Channels.CompressionFormat.None>
  
<span data-ttu-id="d8c22-186">Como essa propriedade só é exposta no binaryMessageEncodingBindingElement, você precisará criar uma associação personalizada como a seguinte para usar esse recurso:</span><span class="sxs-lookup"><span data-stu-id="d8c22-186">Since this property is only exposed on the binaryMessageEncodingBindingElement, you will need to create a custom binding like the following to use this feature:</span></span>

 ```xml
 <customBinding>
   <binding name="BinaryCompressionBinding">
     <binaryMessageEncoding compressionFormat ="GZip" />
     <httpTransport />
  </binding>
</customBinding>
 ```

<span data-ttu-id="d8c22-187">O cliente e o serviço precisam concordar em enviar e receber mensagens compactadas e, portanto, a propriedade compressionFormat deve ser configurada no elemento binaryMessageEncoding no cliente e no serviço.</span><span class="sxs-lookup"><span data-stu-id="d8c22-187">Both the client and the service need to agree to send and receive compressed messages and therefore the compressionFormat property must be configured on the binaryMessageEncoding element on both client and service.</span></span> <span data-ttu-id="d8c22-188">Uma ProtocolException será gerada se o serviço ou o cliente não estiver configurado para compactação, mas o outro lado for.</span><span class="sxs-lookup"><span data-stu-id="d8c22-188">A ProtocolException is thrown if either the service or client is not configured for compression, but the other side is.</span></span> <span data-ttu-id="d8c22-189">A habilitação da compactação deve ser cuidadosamente considerada.</span><span class="sxs-lookup"><span data-stu-id="d8c22-189">Enabling compression should be carefully considered.</span></span> <span data-ttu-id="d8c22-190">A compactação será útil principalmente se a largura de banda da rede for um afunilamento.</span><span class="sxs-lookup"><span data-stu-id="d8c22-190">Compression is mostly useful if network bandwidth is a bottleneck.</span></span> <span data-ttu-id="d8c22-191">No caso em que a CPU é o afunilamento, a compactação diminuirá a taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="d8c22-191">In the case where the CPU is the bottleneck, compression will decrease throughput.</span></span> <span data-ttu-id="d8c22-192">Os testes apropriados devem ser feitos em um ambiente simulado para descobrir se isso beneficia o aplicativo</span><span class="sxs-lookup"><span data-stu-id="d8c22-192">Appropriate testing must be done in a simulated environment to find out if this benefits the application</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d8c22-193">Confira também</span><span class="sxs-lookup"><span data-stu-id="d8c22-193">See also</span></span>

- [<span data-ttu-id="d8c22-194">Associações</span><span class="sxs-lookup"><span data-stu-id="d8c22-194">Bindings</span></span>](bindings.md)
