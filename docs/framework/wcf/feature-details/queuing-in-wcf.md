---
title: Enfileiramento no WCF
ms.date: 03/30/2017
ms.assetid: e98d76ba-1acf-42cd-b137-0f8214661112
ms.openlocfilehash: 6656ab0b2db88297e6ac9a28bb2ea18c0056d18c
ms.sourcegitcommit: a4f9b754059f0210e29ae0578363a27b9ba84b64
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/05/2019
ms.locfileid: "74837318"
---
# <a name="queuing-in-wcf"></a><span data-ttu-id="ffa6f-102">Enfileiramento no WCF</span><span class="sxs-lookup"><span data-stu-id="ffa6f-102">Queuing in WCF</span></span>
<span data-ttu-id="ffa6f-103">Esta seção descreve como usar a comunicação em fila no Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-103">This section describes how to use queued communication in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="queues-as-a-wcf-transport-binding"></a><span data-ttu-id="ffa6f-104">Filas como uma associação de transporte do WCF</span><span class="sxs-lookup"><span data-stu-id="ffa6f-104">Queues as a WCF transport binding</span></span>  
 <span data-ttu-id="ffa6f-105">No WCF, os contratos especificam o que está sendo trocado.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-105">In WCF, the contracts specify what is being exchanged.</span></span> <span data-ttu-id="ffa6f-106">Os contratos são trocas de mensagens específicas do aplicativo ou dependentes da empresa.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-106">Contracts are business-dependent or application-specific message exchanges.</span></span> <span data-ttu-id="ffa6f-107">O mecanismo usado para trocar mensagens (ou "como") é especificado nas associações.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-107">The mechanism used to exchange messages (or the "how") is specified in the bindings.</span></span> <span data-ttu-id="ffa6f-108">Associações no WCF encapsulam detalhes da troca de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-108">Bindings in WCF encapsulate details of the message exchange.</span></span> <span data-ttu-id="ffa6f-109">Eles expõem os botões de configuração para que o usuário controle vários aspectos do transporte ou o protocolo que as associações representam.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-109">They expose configuration knobs for the user to control various aspects of the transport or the protocol that the bindings represent.</span></span> <span data-ttu-id="ffa6f-110">O enfileiramento no WCF é tratado como qualquer outra associação de transporte, que é uma grande vantagem para muitos aplicativos de enfileiramento.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-110">Queuing in WCF is treated like any other transport binding, which is a big advantage for many queuing applications.</span></span> <span data-ttu-id="ffa6f-111">Hoje em dia, muitos aplicativos de enfileiramento são escritos de forma diferente de outros aplicativos distribuídos no estilo RPC (chamada de procedimento remoto), o que dificulta a manutenção e o acompanhamento.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-111">Today, many queuing applications are written differently from other remote procedure call (RPC)-style distributed applications, making it harder to follow and maintain.</span></span> <span data-ttu-id="ffa6f-112">Com o WCF, o estilo de escrever um aplicativo distribuído é muito semelhante, tornando-o mais fácil de seguir e manter.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-112">With WCF, the style of writing a distributed application is much the same, making it easier to follow and maintain.</span></span> <span data-ttu-id="ffa6f-113">Além disso, ao fatorar o mecanismo do Exchange separadamente da lógica de negócios, é mais fácil configurar o transporte ou fazer alterações nele sem afetar o código específico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-113">Moreover, by factoring out the mechanism of exchange separately from the business logic, it is easier to configure the transport or make changes to it without affecting application specific code.</span></span> <span data-ttu-id="ffa6f-114">A figura a seguir ilustra a estrutura de um serviço WCF e cliente usando o MSMQ como um transporte.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-114">The following figure illustrates the structure of a WCF service and client using MSMQ as a transport.</span></span>  
  
 <span data-ttu-id="ffa6f-115">![Diagrama de aplicativo na fila](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-figura")</span><span class="sxs-lookup"><span data-stu-id="ffa6f-115">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="ffa6f-116">Como você pode ver na figura anterior, o cliente e o serviço devem definir apenas a semântica do aplicativo, ou seja, o contrato e a implementação.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-116">As you can see from the preceding figure, the client and service must define only the application semantics, that is, the contract and implementation.</span></span> <span data-ttu-id="ffa6f-117">O serviço configura uma associação em fila com configurações preferenciais.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-117">The service configures a queued binding with preferred settings.</span></span> <span data-ttu-id="ffa6f-118">O cliente usa a [ferramenta de utilitário de metadados ServiceModel (svcutil. exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) para gerar um cliente WCF para o serviço e gerar um arquivo de configuração que descreve as associações a serem usadas para enviar mensagens para o serviço.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-118">The client uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate a WCF client to the service and to generate a configuration file that describes the bindings to use to send messages to the service.</span></span> <span data-ttu-id="ffa6f-119">Portanto, para enviar uma mensagem em fila, o cliente cria uma instância de um cliente WCF e invoca uma operação nela.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-119">Thus, to send a queued message, the client instantiates a WCF client and invokes an operation on it.</span></span> <span data-ttu-id="ffa6f-120">Isso faz com que a mensagem seja enviada para a fila de transmissão e transferida para a fila de destino.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-120">This causes the message to be sent to the transmission queue and transferred to the target queue.</span></span> <span data-ttu-id="ffa6f-121">Todas as complexidades da comunicação em fila ficam ocultas do aplicativo que está enviando e recebendo mensagens.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-121">All the complexities of queued communication are hidden from the application that is sending and receiving messages.</span></span>  
  
 <span data-ttu-id="ffa6f-122">As advertências sobre a associação em fila no WCF incluem:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-122">Caveats about queued binding in WCF include:</span></span>  
  
- <span data-ttu-id="ffa6f-123">Todas as operações de serviço devem ser unidirecionais porque a associação em fila padrão no WCF não oferece suporte à comunicação duplex usando filas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-123">All service operations must be one-way because the default queued binding in WCF does not support duplex communication using queues.</span></span> <span data-ttu-id="ffa6f-124">Um exemplo de comunicação bidirecional ([comunicação bidirecional](../../../../docs/framework/wcf/samples/two-way-communication.md)) ilustra como usar contratos de 2 1 vias para implementar a comunicação duplex usando filas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-124">A two-way communication sample ([Two-Way Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustrates how to use two one-way contracts to implement duplex communication using queues.</span></span>  
  
- <span data-ttu-id="ffa6f-125">Para gerar um cliente WCF usando a troca de metadados, é necessário um ponto de extremidade HTTP adicional no serviço para que ele possa ser consultado diretamente para gerar o cliente WCF e obter informações de associação para configurar adequadamente a comunicação em fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-125">To generate a WCF client using metadata exchange requires an additional HTTP endpoint on the service so that it can be queried directly to generate the WCF client and obtain binding information to appropriately configure queued communication.</span></span>  
  
- <span data-ttu-id="ffa6f-126">Com base na associação em fila, é necessária uma configuração extra fora do WCF.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-126">Based on the queued binding, extra configuration outside of WCF is required.</span></span> <span data-ttu-id="ffa6f-127">Por exemplo, a classe <xref:System.ServiceModel.NetMsmqBinding> fornecida com o WCF exige que você configure as associações, bem como configurar o MSMQ (enfileiramento de mensagens) minimamente.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-127">For example, the <xref:System.ServiceModel.NetMsmqBinding> class that is shipped with WCF requires you to configure the bindings as well as minimally configure Message Queuing (MSMQ).</span></span>  
  
 <span data-ttu-id="ffa6f-128">As seções a seguir descrevem as associações enfileiradas específicas fornecidas com o WCF, que se baseiam no MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-128">The following sections describe the specific queued bindings shipped with WCF, which are based on MSMQ.</span></span>  
  
### <a name="msmq"></a><span data-ttu-id="ffa6f-129">MSMQ</span><span class="sxs-lookup"><span data-stu-id="ffa6f-129">MSMQ</span></span>  
 <span data-ttu-id="ffa6f-130">O transporte em fila no WCF usa o MSMQ para sua comunicação em fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-130">The queued transport in WCF uses MSMQ for its queued communication.</span></span>  
  
 <span data-ttu-id="ffa6f-131">O MSMQ é fornecido como um componente opcional com o Windows e é executado como um serviço NT.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-131">MSMQ ships as an optional component with Windows and runs as an NT service.</span></span> <span data-ttu-id="ffa6f-132">Ele captura mensagens para transmissão em uma fila de transmissão e para entrega em uma fila de destino.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-132">It captures messages for transmission in a transmission queue and for delivery in a target queue.</span></span> <span data-ttu-id="ffa6f-133">Os gerenciadores de filas do MSMQ implementam um protocolo de transferência de mensagens confiável para que as mensagens não sejam perdidas na transmissão.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-133">The MSMQ queue managers implement a reliable message-transfer protocol so that messages are not lost in transmission.</span></span> <span data-ttu-id="ffa6f-134">O protocolo pode ser baseado em SOAP ou nativo, como o SRMP (protocolo SOAP de mensagem confiável).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-134">The protocol can be either native or SOAP-based, such as the SOAP Reliable Message Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="ffa6f-135">No MSMQ, as filas podem ser transacionais ou não transacionais.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-135">In MSMQ, queues can be transactional or non-transactional.</span></span> <span data-ttu-id="ffa6f-136">Uma fila transacional permite que as mensagens sejam capturadas e entregues em uma transação e, em seguida, armazenadas permanentemente na fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-136">A transactional queue allows messages to be captured and delivered in a transaction and then stored durably in the queue.</span></span> <span data-ttu-id="ffa6f-137">As mensagens enviadas para uma fila transacional são transferidas exatamente uma vez na ordem.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-137">Messages sent to a transactional queue are transferred exactly once in order.</span></span> <span data-ttu-id="ffa6f-138">Você pode usar uma fila não transacional para enviar mensagens voláteis e duráveis.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-138">You can use a non-transactional queue to send both volatile and durable messages.</span></span> <span data-ttu-id="ffa6f-139">Uma mensagem enviada para uma fila não transacional não carrega nenhuma garantia de transferência confiável; Portanto, as mensagens podem ser perdidas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-139">A message sent to a non-transactional queue does not carry any reliable transfer assurances; thus, messages can be lost.</span></span>  
  
 <span data-ttu-id="ffa6f-140">As filas do MSMQ também podem ser protegidas usando uma identidade do Windows registrada com o serviço de diretório Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-140">MSMQ queues can also be secured using a Windows identity registered with the Active Directory directory service.</span></span> <span data-ttu-id="ffa6f-141">Ao instalar o MSMQ, você pode instalar Active Directory integração, o que exige que o computador faça parte de uma rede de domínio do Windows.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-141">When installing MSMQ, you can install Active Directory integration, which requires the computer to be part of a Windows domain network.</span></span>  
  
 <span data-ttu-id="ffa6f-142">Para obter mais informações sobre o MSMQ, consulte [instalando o MSMQ (enfileiramento de mensagens)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-142">For more information about MSMQ, see [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span></span>  
  
### <a name="netmsmqbinding"></a><span data-ttu-id="ffa6f-143">NetMsmqBinding</span><span class="sxs-lookup"><span data-stu-id="ffa6f-143">NetMsmqBinding</span></span>  
 <span data-ttu-id="ffa6f-144">O [\<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) é a associação enfileirada que o WCF fornece para que dois pontos de extremidade do WCF se comuniquem usando o MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-144">The [\<netMsmqBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) is the queued binding WCF provides for two WCF endpoints to communicate using MSMQ.</span></span> <span data-ttu-id="ffa6f-145">A associação, portanto, expõe propriedades que são específicas do MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-145">The binding, therefore, exposes properties that are specific to MSMQ.</span></span> <span data-ttu-id="ffa6f-146">No entanto, nem todos os recursos e propriedades do MSMQ são expostos no `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-146">However, not all MSMQ features and properties are exposed in the `NetMsmqBinding`.</span></span> <span data-ttu-id="ffa6f-147">O `NetMsmqBinding` compacto foi projetado com um conjunto ideal de recursos que a maioria dos clientes deve encontrar suficiente.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-147">The compact `NetMsmqBinding` is designed with an optimal set of features that most customers should find sufficient.</span></span>  
  
 <span data-ttu-id="ffa6f-148">O `NetMsmqBinding` manifesta os conceitos de enfileiramento principais discutidos até o momento na forma de propriedades nas associações.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-148">The `NetMsmqBinding` manifests the core queuing concepts discussed thus far in the form of properties on the bindings.</span></span> <span data-ttu-id="ffa6f-149">Essas propriedades, por sua vez, se comunicam com o MSMQ como transferir e entregar as mensagens.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-149">These properties, in turn, communicate to MSMQ how to transfer and deliver the messages.</span></span> <span data-ttu-id="ffa6f-150">Uma discussão sobre as categorias de propriedade está nas seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-150">A discussion of the property categories is in the following sections.</span></span> <span data-ttu-id="ffa6f-151">Para obter mais informações, consulte os tópicos conceituais que descrevem as propriedades específicas mais completamente.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-151">For more information, see the conceptual topics that describe specific properties more completely.</span></span>  
  
#### <a name="exactlyonce-and-durable-properties"></a><span data-ttu-id="ffa6f-152">Propriedades de ExactlyOnce e duráveis</span><span class="sxs-lookup"><span data-stu-id="ffa6f-152">ExactlyOnce and Durable Properties</span></span>  
 <span data-ttu-id="ffa6f-153">As propriedades `ExactlyOnce` e `Durable` afetam o modo como as mensagens são transferidas entre filas:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-153">The `ExactlyOnce` and `Durable` properties affect how messages are transferred between queues:</span></span>  
  
- <span data-ttu-id="ffa6f-154">`ExactlyOnce`: quando definido como `true` (o padrão), o canal em fila garante que a mensagem, se entregue, não seja duplicada.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-154">`ExactlyOnce`: When set to `true` (the default), the queued channel ensures that the message, if delivered, is not duplicated.</span></span> <span data-ttu-id="ffa6f-155">Ele também garante que a mensagem não seja perdida.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-155">It also ensures that the message is not lost.</span></span> <span data-ttu-id="ffa6f-156">Se a mensagem não puder ser entregue ou o tempo de vida da mensagem expirar antes que a mensagem possa ser entregue, a mensagem com falha junto com o motivo da falha de entrega será registrada em uma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-156">If the message cannot be delivered, or the message Time-To Live expires before the message can be delivered, the failed message along with the delivery failure reason is recorded in a dead-letter queue.</span></span> <span data-ttu-id="ffa6f-157">Quando definido como `false`, o canal em fila faz um esforço para transferir a mensagem.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-157">When set to `false`, the queued channel makes an effort to transfer the message.</span></span> <span data-ttu-id="ffa6f-158">Nesse caso, opcionalmente, você pode escolher uma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-158">In this case, you can optionally choose a dead-letter queue.</span></span>  
  
- <span data-ttu-id="ffa6f-159">`Durable:` quando definido como `true` (o padrão), o canal em fila garante que o MSMQ armazene a mensagem permanentemente no disco.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-159">`Durable:` When set to `true` (the default), the queued channel ensures that MSMQ stores the message durably on disk.</span></span> <span data-ttu-id="ffa6f-160">Portanto, se o serviço MSMQ parar e reiniciar, as mensagens no disco serão transferidas para a fila de destino ou entregues ao serviço.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-160">Thus, if the MSMQ service were to stop and restart, the messages on disk is transferred to the target queue or delivered to the service.</span></span> <span data-ttu-id="ffa6f-161">Quando definido como `false`, as mensagens são armazenadas no repositório volátil e são perdidas na interrupção e na reinicialização do serviço MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-161">When set to `false`, the messages are stored in volatile store and are lost on stopping and restarting the MSMQ service.</span></span>  
  
 <span data-ttu-id="ffa6f-162">Para `ExactlyOnce` transferência confiável, o MSMQ exige que a fila seja transacional.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-162">For `ExactlyOnce` reliable transfer, MSMQ requires the queue to be transactional.</span></span> <span data-ttu-id="ffa6f-163">Além disso, o MSMQ requer uma transação para ler de uma fila transacional.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-163">Also, MSMQ requires a transaction to read from a transactional queue.</span></span> <span data-ttu-id="ffa6f-164">Dessa forma, ao usar o `NetMsmqBinding`, lembre-se de que uma transação é necessária para enviar ou receber mensagens quando `ExactlyOnce` está definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-164">As such, when you use the `NetMsmqBinding`, remember that a transaction is required to send or receive messages when `ExactlyOnce` is set to `true`.</span></span> <span data-ttu-id="ffa6f-165">Da mesma forma, o MSMQ exige que a fila seja não transacional para garantias de melhor esforço, como quando `ExactlyOnce` é `false` e para mensagens voláteis.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-165">Similarly, MSMQ requires the queue to be non-transactional for best-effort assurances, such as when `ExactlyOnce` is `false` and for volatile messaging.</span></span> <span data-ttu-id="ffa6f-166">Assim, ao definir `ExactlyOnce` como `false` ou durável para `false`, você não pode enviar ou receber usando uma transação.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-166">Thus, when setting `ExactlyOnce` to `false` or durable to `false`, you cannot send or receive using a transaction.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ffa6f-167">Certifique-se de que a fila correta (transacional ou não transacional) seja criada com base nas configurações nas associações.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-167">Ensure that the correct queue (transactional or non-transactional) is created based on settings in the bindings.</span></span> <span data-ttu-id="ffa6f-168">Se `ExactlyOnce` for `true`, use uma fila transacional; caso contrário, use uma fila não transacional.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-168">If `ExactlyOnce` is `true`, use a transactional queue; otherwise, use a non-transactional queue.</span></span>  
  
#### <a name="dead-letter-queue-properties"></a><span data-ttu-id="ffa6f-169">Propriedades da fila de mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="ffa6f-169">Dead-Letter Queue Properties</span></span>  
 <span data-ttu-id="ffa6f-170">Essa fila é usada para armazenar mensagens que falham na entrega.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-170">The dead-letter queue is used to store messages that fail delivery.</span></span> <span data-ttu-id="ffa6f-171">O usuário pode gravar a lógica de compensação que lê mensagens fora da fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-171">The user can write compensating logic that reads messages out of the dead-letter queue.</span></span>  
  
 <span data-ttu-id="ffa6f-172">Muitos sistemas de enfileiramento fornecem uma fila de mensagens mortas em todo o sistema.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-172">Many queuing systems provide for a system-wide dead-letter queue.</span></span> <span data-ttu-id="ffa6f-173">O MSMQ fornece uma fila de mensagens mortas não transacionais em todo o sistema para as mensagem que falha na entrega a filas não transacionais e uma fila de mensagens mortas transacionais em todo o sistema para o envio de falhas para filas transacionais.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-173">MSMQ provides a system-wide non-transactional dead-letter queue for messages that fail delivery to non-transactional queues and a system-wide transactional dead-letter queue for messages that fail delivery to transactional queues.</span></span>  
  
 <span data-ttu-id="ffa6f-174">Se vários clientes que enviam mensagens para filas de destino diferentes compartilharem o serviço MSMQ, todas as mensagens enviadas pelos clientes vão para a mesma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-174">If multiple clients sending messages to different target queues share the MSMQ service, all messages sent by the clients go to the same dead-letter queue.</span></span> <span data-ttu-id="ffa6f-175">Isso nem sempre é preferível.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-175">This is not always preferable.</span></span> <span data-ttu-id="ffa6f-176">Para um melhor isolamento, o WCF e o MSMQ no Windows Vista fornecem uma fila de mensagens mortas personalizada (ou uma fila de mensagens mortas específica do aplicativo) que o usuário pode especificar para armazenar mensagens que falham na entrega.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-176">For better isolation, WCF and MSMQ in Windows Vista provide a custom dead-letter queue (or application-specific dead-letter queue) that the user can specify to store messages that fail delivery.</span></span> <span data-ttu-id="ffa6f-177">Portanto, clientes diferentes não compartilham a mesma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-177">Therefore, different clients do not share the same dead-letter queue.</span></span>  
  
 <span data-ttu-id="ffa6f-178">A associação tem duas propriedades de interesse:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-178">The binding has two properties of interest:</span></span>  
  
- <span data-ttu-id="ffa6f-179">`DeadLetterQueue`: essa propriedade é uma enumeração que indica se uma fila de mensagens mortas é solicitada.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-179">`DeadLetterQueue`: This property is an enumeration that indicates whether a dead-letter queue is requested.</span></span> <span data-ttu-id="ffa6f-180">A enumeração também contém o tipo de fila de mensagens mortas, se uma for solicitada.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-180">The enumeration also contains the kind of dead-letter queue, if one is requested.</span></span> <span data-ttu-id="ffa6f-181">Os valores são `None`, `System` e `Custom`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-181">The values are `None`, `System`, and `Custom`.</span></span> <span data-ttu-id="ffa6f-182">Para obter mais informações sobre a interpretação dessas propriedades, consulte [usando filas de mensagens mortas para lidar com falhas de transferência de mensagens](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span><span class="sxs-lookup"><span data-stu-id="ffa6f-182">For more information about the interpretation of these properties, see [Using Dead-Letter Queues to Handle Message Transfer Failures](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span></span>  
  
- <span data-ttu-id="ffa6f-183">`CustomDeadLetterQueue`: essa propriedade é o endereço de Uniform Resource Identifier (URI) da fila de mensagens mortas específica do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-183">`CustomDeadLetterQueue`: This property is the Uniform Resource Identifier (URI) address of the application-specific dead-letter queue.</span></span> <span data-ttu-id="ffa6f-184">Isso será necessário se `DeadLetterQueue`.`Custom`</span><span class="sxs-lookup"><span data-stu-id="ffa6f-184">This is required if `DeadLetterQueue`.`Custom`</span></span> <span data-ttu-id="ffa6f-185">é escolhido.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-185">is chosen.</span></span>  
  
#### <a name="poison-message-handling-properties"></a><span data-ttu-id="ffa6f-186">Propriedades de tratamento de mensagens suspeitas</span><span class="sxs-lookup"><span data-stu-id="ffa6f-186">Poison Message Handling properties</span></span>  
 <span data-ttu-id="ffa6f-187">Quando o serviço lê mensagens da fila de destino em uma transação, o serviço pode falhar ao processar a mensagem por vários motivos.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-187">When the service reads messages from the target queue under a transaction, the service may fail to process the message for various reasons.</span></span> <span data-ttu-id="ffa6f-188">Em seguida, a mensagem é colocada de volta na fila para ser lida novamente.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-188">The message is then put back into the queue to be read again.</span></span> <span data-ttu-id="ffa6f-189">Para lidar com mensagens que falham repetidamente, um conjunto de propriedades de manipulação de mensagens suspeitas pode ser configurado na associação.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-189">To deal with messages that fail repeatedly, a set of poison-message handling properties can be configured in the binding.</span></span> <span data-ttu-id="ffa6f-190">Há quatro propriedades: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`e `ReceiveErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-190">There are four properties: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, and `ReceiveErrorHandling`.</span></span> <span data-ttu-id="ffa6f-191">Para obter mais informações sobre essas propriedades, consulte [manipulação de mensagens suspeitas](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-191">For more information about these properties, see [Poison Message Handling](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span></span>  
  
#### <a name="security-properties"></a><span data-ttu-id="ffa6f-192">Propriedades de segurança</span><span class="sxs-lookup"><span data-stu-id="ffa6f-192">Security Properties</span></span>  
 <span data-ttu-id="ffa6f-193">O MSMQ expõe seu próprio modelo de segurança, como ACLs (listas de controle de acesso) em uma fila ou enviando mensagens autenticadas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-193">MSMQ exposes its own security model, such as access control lists (ACLs) on a queue or sending authenticated messages.</span></span> <span data-ttu-id="ffa6f-194">O `NetMsmqBinding` expõe essas propriedades de segurança como parte de suas configurações de segurança de transporte.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-194">The `NetMsmqBinding` exposes these security properties as part of its transport security settings.</span></span> <span data-ttu-id="ffa6f-195">Há duas propriedades na associação para segurança de transporte: `MsmqAuthenticationMode` e `MsmqProtectionLevel`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-195">There are two properties in the binding for transport security: `MsmqAuthenticationMode` and `MsmqProtectionLevel`.</span></span> <span data-ttu-id="ffa6f-196">As configurações nessas propriedades dependem de como o MSMQ é configurado.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-196">Settings in these properties depend on how MSMQ is configured.</span></span> <span data-ttu-id="ffa6f-197">Para obter mais informações, consulte [protegendo mensagens usando a segurança de transporte](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-197">For more information, see [Securing Messages Using Transport Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span></span>  
  
 <span data-ttu-id="ffa6f-198">Além da segurança do transporte, a mensagem SOAP propriamente dita pode ser protegida usando a segurança da mensagem.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-198">In addition to transport security, the actual SOAP message itself can be secured using message security.</span></span> <span data-ttu-id="ffa6f-199">Para obter mais informações, consulte [protegendo mensagens usando a segurança da mensagem](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-199">For more information, see [Securing Messages Using Message Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span></span>  
  
 <span data-ttu-id="ffa6f-200">o `MsmqTransportSecurity` também expõe duas propriedades, `MsmqEncryptionAlgorithm` e `MsmqHashAlgorithm`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-200">`MsmqTransportSecurity` also exposes two properties, `MsmqEncryptionAlgorithm` and `MsmqHashAlgorithm`.</span></span> <span data-ttu-id="ffa6f-201">Essas são enumerações de algoritmos diferentes para escolher a criptografia de transferência de fila para fila de mensagens e o hash das assinaturas.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-201">These are enumerations of different algorithms to choose for queue-to-queue transfer encryption of messages and hashing of the signatures.</span></span>  
  
#### <a name="other-properties"></a><span data-ttu-id="ffa6f-202">Outras propriedades</span><span class="sxs-lookup"><span data-stu-id="ffa6f-202">Other Properties</span></span>  
 <span data-ttu-id="ffa6f-203">Além das propriedades anteriores, outras propriedades específicas do MSMQ expostas na associação incluem:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-203">In addition to the preceding properties, other MSMQ-specific properties exposed in the binding include:</span></span>  
  
- <span data-ttu-id="ffa6f-204">`UseSourceJournal`: uma propriedade para indicar que o diário de origem está ativado.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-204">`UseSourceJournal`: A property to indicate that source journaling is turned on.</span></span> <span data-ttu-id="ffa6f-205">O diário de origem é um recurso MSMQ que controla as mensagens que foram transmitidas com êxito da fila de transmissão.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-205">Source journaling is an MSMQ feature that keeps track of messages that have been successfully transmitted from the transmission queue.</span></span>  
  
- <span data-ttu-id="ffa6f-206">`UseMsmqTracing`: uma propriedade para indicar que o rastreamento MSMQ está ativado.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-206">`UseMsmqTracing`: A property to indicate that MSMQ tracing is turned on.</span></span> <span data-ttu-id="ffa6f-207">O rastreamento MSMQ envia mensagens de relatório para uma fila de relatório sempre que uma mensagem sai ou chega em um computador que hospeda um Gerenciador de filas MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-207">MSMQ tracing sends report messages to a report queue each time a message leaves or arrives at a machine hosting an MSMQ queue manager.</span></span>  
  
- <span data-ttu-id="ffa6f-208">`QueueTransferProtocol`: uma enumeração do protocolo a ser usado para transferências de mensagens da fila para a fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-208">`QueueTransferProtocol`: An enumeration of the protocol to use for queue-to-queue message transfers.</span></span> <span data-ttu-id="ffa6f-209">O MSMQ implementa um protocolo de transferência de fila para fila nativo e um protocolo baseado em SOAP chamado SRMP (SOAP Reliable Messaging Protocol).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-209">MSMQ implements a native queue-to-queue transfer protocol and a SOAP-based protocol called SOAP Reliable Messaging Protocol (SRMP).</span></span> <span data-ttu-id="ffa6f-210">SRMP é usado ao usar o transporte HTTP para transferências de fila para fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-210">SRMP is used when using HTTP transport for queue-to-queue transfers.</span></span> <span data-ttu-id="ffa6f-211">SRMP Secure é usado ao usar HTTPS para transferências de fila para fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-211">SRMP secure is used when using HTTPS for queue-to-queue transfers.</span></span>  
  
- <span data-ttu-id="ffa6f-212">`UseActiveDirectory`: um valor booliano para indicar se o Active Directory deve ser usado para resolução de endereço de fila.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-212">`UseActiveDirectory`: A Boolean value to indicate whether the Active Directory must be used for queue address resolution.</span></span> <span data-ttu-id="ffa6f-213">Por padrão, isso é desativado.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-213">By default, this is off.</span></span> <span data-ttu-id="ffa6f-214">Para obter mais informações, consulte [pontos de extremidade de serviço e endereçamento de fila](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="ffa6f-214">For more information, see [Service Endpoints and Queue Addressing](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span></span>  
  
### <a name="msmqintegrationbinding"></a><span data-ttu-id="ffa6f-215">MsmqIntegrationBinding</span><span class="sxs-lookup"><span data-stu-id="ffa6f-215">MsmqIntegrationBinding</span></span>  
 <span data-ttu-id="ffa6f-216">O `MsmqIntegrationBinding` é usado quando você deseja que um ponto de extremidade WCF se comunique com um aplicativo MSMQ existente escrito C++em APIs C,, com ou System. Messaging.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-216">The `MsmqIntegrationBinding` is used when you want a WCF endpoint to communicate with an existing MSMQ application written in C, C++, COM, or System.Messaging APIs.</span></span>  
  
 <span data-ttu-id="ffa6f-217">As propriedades de associação são as mesmas para `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-217">The binding properties are the same as for `NetMsmqBinding`.</span></span> <span data-ttu-id="ffa6f-218">No entanto, as seguintes diferenças se aplicam:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-218">However, the following differences apply:</span></span>  
  
- <span data-ttu-id="ffa6f-219">O contrato de operação para `MsmqIntegrationBinding` é restrito a usar um único parâmetro do tipo <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> em que o parâmetro de tipo é o tipo de corpo.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-219">The operation contract for `MsmqIntegrationBinding` is restricted to taking a single parameter of type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> where the type parameter is the body type.</span></span>  
  
- <span data-ttu-id="ffa6f-220">Muitas das propriedades de mensagens nativas do MSMQ são expostas no <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> para uso.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-220">Much of MSMQ native message properties are exposed in the <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> for use.</span></span>  
  
- <span data-ttu-id="ffa6f-221">Para ajudar com a serialização e desserialização do corpo da mensagem, serializadores, como XML e ActiveX, são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="ffa6f-221">To help with serialization and deserialization of the message body, serializers such as XML and ActiveX are provided.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="ffa6f-222">Código de exemplo</span><span class="sxs-lookup"><span data-stu-id="ffa6f-222">Sample Code</span></span>  
 <span data-ttu-id="ffa6f-223">Para obter instruções passo a passo sobre como escrever serviços WCF que usam o MSMQ, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-223">For step by step instructions on how to write WCF services that use MSMQ see the following topics:</span></span>  
  
- [<span data-ttu-id="ffa6f-224">Como trocar mensagens com pontos de extremidade do WCF e aplicativos de enfileiramento de mensagens</span><span class="sxs-lookup"><span data-stu-id="ffa6f-224">How to: Exchange Messages with WCF Endpoints and Message Queuing Applications</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md)  
  
- [<span data-ttu-id="ffa6f-225">Como trocar mensagens na fila com pontos de extremidade do WCF</span><span class="sxs-lookup"><span data-stu-id="ffa6f-225">How to: Exchange Queued Messages with WCF Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-queued-messages-with-wcf-endpoints.md)  
  
 <span data-ttu-id="ffa6f-226">Para obter um exemplo de código concluído ilustrando o uso do MSMQ no WCF, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="ffa6f-226">For a completed code sample illustrating the use of MSMQ in WCF see the following topics:</span></span>  
  
- [<span data-ttu-id="ffa6f-227">Associação transacionada do MSMQ</span><span class="sxs-lookup"><span data-stu-id="ffa6f-227">Transacted MSMQ Binding</span></span>](../../../../docs/framework/wcf/samples/transacted-msmq-binding.md)  
  
- [<span data-ttu-id="ffa6f-228">Comunicação em fila volátil</span><span class="sxs-lookup"><span data-stu-id="ffa6f-228">Volatile Queued Communication</span></span>](../../../../docs/framework/wcf/samples/volatile-queued-communication.md)  
  
- [<span data-ttu-id="ffa6f-229">Filas de mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="ffa6f-229">Dead Letter Queues</span></span>](../../../../docs/framework/wcf/samples/dead-letter-queues.md)  
  
- [<span data-ttu-id="ffa6f-230">Sessões e filas</span><span class="sxs-lookup"><span data-stu-id="ffa6f-230">Sessions and Queues</span></span>](../../../../docs/framework/wcf/samples/sessions-and-queues.md)  
  
- [<span data-ttu-id="ffa6f-231">Comunicação bidirecional</span><span class="sxs-lookup"><span data-stu-id="ffa6f-231">Two-Way Communication</span></span>](../../../../docs/framework/wcf/samples/two-way-communication.md) 
  
- [<span data-ttu-id="ffa6f-232">SRMP</span><span class="sxs-lookup"><span data-stu-id="ffa6f-232">SRMP</span></span>](../../../../docs/framework/wcf/samples/srmp.md)  
  
- [<span data-ttu-id="ffa6f-233">Segurança de mensagem através do enfileiramento de mensagem</span><span class="sxs-lookup"><span data-stu-id="ffa6f-233">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)  
  
## <a name="see-also"></a><span data-ttu-id="ffa6f-234">Consulte também</span><span class="sxs-lookup"><span data-stu-id="ffa6f-234">See also</span></span>

- [<span data-ttu-id="ffa6f-235">Pontos de extremidade de serviço e endereçamento de fila</span><span class="sxs-lookup"><span data-stu-id="ffa6f-235">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)
- [<span data-ttu-id="ffa6f-236">Hospedagem na Web de um aplicativo na fila</span><span class="sxs-lookup"><span data-stu-id="ffa6f-236">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
