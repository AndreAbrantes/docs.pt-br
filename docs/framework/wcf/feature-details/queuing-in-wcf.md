---
title: Enfileiramento no WCF
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e98d76ba-1acf-42cd-b137-0f8214661112
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 01dc36c73d9e668dd98cb5ba8b275d3d5177ba61
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2018
---
# <a name="queuing-in-wcf"></a><span data-ttu-id="ebbeb-102">Enfileiramento no WCF</span><span class="sxs-lookup"><span data-stu-id="ebbeb-102">Queuing in WCF</span></span>
<span data-ttu-id="ebbeb-103">Esta seção descreve como usar a comunicação em fila em [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ebbeb-103">This section describes how to use queued communication in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span></span>  
  
## <a name="queues-as-a-wcf-transport-binding"></a><span data-ttu-id="ebbeb-104">Associação de transporte de filas como um WCF</span><span class="sxs-lookup"><span data-stu-id="ebbeb-104">Queues as a WCF transport binding</span></span>  
 <span data-ttu-id="ebbeb-105">Em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], os contratos de especificar o que está sendo trocado.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-105">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the contracts specify what is being exchanged.</span></span> <span data-ttu-id="ebbeb-106">Contratos são trocas de mensagens de aplicativo específico ou dependentes de negócios.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-106">Contracts are business-dependent or application-specific message exchanges.</span></span> <span data-ttu-id="ebbeb-107">O mecanismo usado para troca de mensagens (ou "como") é especificado nas associações.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-107">The mechanism used to exchange messages (or the "how") is specified in the bindings.</span></span> <span data-ttu-id="ebbeb-108">Associações em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] encapsulam os detalhes de troca de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-108">Bindings in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] encapsulate details of the message exchange.</span></span> <span data-ttu-id="ebbeb-109">Eles expõem os botões de configuração para o usuário controlar vários aspectos do transporte ou o protocolo que representam as associações.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-109">They expose configuration knobs for the user to control various aspects of the transport or the protocol that the bindings represent.</span></span> <span data-ttu-id="ebbeb-110">Enfileiramento de mensagens em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] é tratado como qualquer outra transporte ligação, que é uma grande vantagem para muitos aplicativos de enfileiramento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-110">Queuing in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is treated like any other transport binding, which is a big advantage for many queuing applications.</span></span> <span data-ttu-id="ebbeb-111">Atualmente, muitos aplicativos de enfileiramento de mensagens são gravados Diferentemente de outras chamadas de procedimento remoto (RPC)-estilo de aplicativos distribuídos, tornando mais difícil de seguir e manter.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-111">Today, many queuing applications are written differently from other remote procedure call (RPC)-style distributed applications, making it harder to follow and maintain.</span></span> <span data-ttu-id="ebbeb-112">Com [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], o estilo de escrever um aplicativo distribuído é semelhante a, tornando mais fácil de seguir e manter.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-112">With [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the style of writing a distributed application is much the same, making it easier to follow and maintain.</span></span> <span data-ttu-id="ebbeb-113">Além disso, Fatorando o mecanismo do exchange separadamente da lógica de negócios, é mais fácil de configurar o transporte ou fazer alterações sem afetar o código específico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-113">Moreover, by factoring out the mechanism of exchange separately from the business logic, it is easier to configure the transport or make changes to it without affecting application specific code.</span></span> <span data-ttu-id="ebbeb-114">A figura a seguir ilustra a estrutura de um serviço WCF e usar o MSMQ como um transporte de cliente.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-114">The following figure illustrates the structure of a WCF service and client using MSMQ as a transport.</span></span>  
  
 <span data-ttu-id="ebbeb-115">![Na fila de diagrama do aplicativo](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Figura distribuídas de fila")</span><span class="sxs-lookup"><span data-stu-id="ebbeb-115">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="ebbeb-116">Como você pode ver na figura anterior, o cliente e o serviço devem definir apenas a semântica do aplicativo, ou seja, o contrato e a implementação.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-116">As you can see from the preceding figure, the client and service must define only the application semantics, that is, the contract and implementation.</span></span> <span data-ttu-id="ebbeb-117">O serviço define uma associação enfileirada com configurações preferenciais.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-117">The service configures a queued binding with preferred settings.</span></span> <span data-ttu-id="ebbeb-118">O cliente usa o [Ferramenta Utilitária de metadados ServiceModel (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) para gerar um [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cliente para o serviço e gerar um arquivo de configuração que descreve as associações a ser usado para enviar mensagens para o serviço.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-118">The client uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client to the service and to generate a configuration file that describes the bindings to use to send messages to the service.</span></span> <span data-ttu-id="ebbeb-119">Assim, para enviar uma mensagem na fila, o cliente cria um [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cliente e chama uma operação sobre ele.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-119">Thus, to send a queued message, the client instantiates a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and invokes an operation on it.</span></span> <span data-ttu-id="ebbeb-120">Isso faz com que a mensagem ser enviada para a fila de transmissão e transferida para a fila de destino.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-120">This causes the message to be sent to the transmission queue and transferred to the target queue.</span></span> <span data-ttu-id="ebbeb-121">Todas as complexidades de comunicação em fila estão ocultos do aplicativo que está enviando e recebendo mensagens.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-121">All the complexities of queued communication are hidden from the application that is sending and receiving messages.</span></span>  
  
 <span data-ttu-id="ebbeb-122">Advertências sobre enfileiradas associação em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] incluem:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-122">Caveats about queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] include:</span></span>  
  
-   <span data-ttu-id="ebbeb-123">Todas as operações de serviço devem ser unidirecionais porque o padrão na fila de vinculação em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] não suporta o uso de filas de comunicação duplex.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-123">All service operations must be one-way because the default queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support duplex communication using queues.</span></span> <span data-ttu-id="ebbeb-124">Um exemplo de comunicação bidirecional ([comunicação bidirecional](../../../../docs/framework/wcf/samples/two-way-communication.md)) ilustra como usar dois contratos unidirecionais para implementar o uso de filas de comunicação duplex.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-124">A two-way communication sample ([Two-Way Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustrates how to use two one-way contracts to implement duplex communication using queues.</span></span>  
  
-   <span data-ttu-id="ebbeb-125">Para gerar um [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cliente usando uma troca de metadados requer um ponto de extremidade HTTP adicional no serviço de forma que ela possa ser consultada diretamente para gerar o [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] cliente e obter informações de associação para configurar adequadamente em fila comunicação.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-125">To generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client using metadata exchange requires an additional HTTP endpoint on the service so that it can be queried directly to generate the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and obtain binding information to appropriately configure queued communication.</span></span>  
  
-   <span data-ttu-id="ebbeb-126">Com base no na fila de associação, configuração adicional fora de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] é necessária.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-126">Based on the queued binding, extra configuration outside of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is required.</span></span> <span data-ttu-id="ebbeb-127">Por exemplo, o <xref:System.ServiceModel.NetMsmqBinding> classe que é fornecido com o [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] exige que você configure as ligações, bem como a configuração mínima de enfileiramento de mensagens (MSMQ).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-127">For example, the <xref:System.ServiceModel.NetMsmqBinding> class that is shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] requires you to configure the bindings as well as minimally configure Message Queuing (MSMQ).</span></span>  
  
 <span data-ttu-id="ebbeb-128">As seções a seguir descrevem as associações na fila específicas acompanha [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], que se baseiam em MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-128">The following sections describe the specific queued bindings shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], which are based on MSMQ.</span></span>  
  
### <a name="msmq"></a><span data-ttu-id="ebbeb-129">MSMQ</span><span class="sxs-lookup"><span data-stu-id="ebbeb-129">MSMQ</span></span>  
 <span data-ttu-id="ebbeb-130">O transporte em fila em [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] usa MSMQ para sua comunicação em fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-130">The queued transport in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses MSMQ for its queued communication.</span></span>  
  
 <span data-ttu-id="ebbeb-131">MSMQ é fornecido como um componente opcional do Windows e é executado como um serviço NT.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-131">MSMQ ships as an optional component with Windows and runs as an NT service.</span></span> <span data-ttu-id="ebbeb-132">Captura as mensagens de transmissão em uma fila de transmissão e de entrega em uma fila de destino.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-132">It captures messages for transmission in a transmission queue and for delivery in a target queue.</span></span> <span data-ttu-id="ebbeb-133">Os gerenciadores de fila MSMQ implementam um protocolo de transferência de mensagens confiáveis para que as mensagens não serão perdidas durante a transmissão.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-133">The MSMQ queue managers implement a reliable message-transfer protocol so that messages are not lost in transmission.</span></span> <span data-ttu-id="ebbeb-134">O protocolo pode ser baseado em SOAP, como o SOAP mensagem protocolo SRMP (confiável) ou nativo.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-134">The protocol can be either native or SOAP-based, such as the SOAP Reliable Message Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="ebbeb-135">No MSMQ, as filas podem ser transacional ou não transacional.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-135">In MSMQ, queues can be transactional or non-transactional.</span></span> <span data-ttu-id="ebbeb-136">Uma fila transacional permite que as mensagens ser capturada e entregues em uma transação e, em seguida, armazenadas de forma duradoura na fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-136">A transactional queue allows messages to be captured and delivered in a transaction and then stored durably in the queue.</span></span> <span data-ttu-id="ebbeb-137">As mensagens enviadas para uma fila transacional são transferidas exatamente uma vez na ordem.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-137">Messages sent to a transactional queue are transferred exactly once in order.</span></span> <span data-ttu-id="ebbeb-138">Você pode usar uma fila não transacional para enviar mensagens duráveis e volátil.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-138">You can use a non-transactional queue to send both volatile and durable messages.</span></span> <span data-ttu-id="ebbeb-139">Uma mensagem enviada para uma fila não transacional não contém nenhuma garantia de transferência confiável; Portanto, as mensagens podem ser perdidas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-139">A message sent to a non-transactional queue does not carry any reliable transfer assurances; thus, messages can be lost.</span></span>  
  
 <span data-ttu-id="ebbeb-140">As filas do MSMQ também podem ser protegidas usando uma identidade de Windows registrada com o serviço de diretório do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-140">MSMQ queues can also be secured using a Windows identity registered with the Active Directory directory service.</span></span> <span data-ttu-id="ebbeb-141">Ao instalar o MSMQ, você pode instalar a integração do Active Directory, o que exige que o computador é parte de uma rede de domínio do Windows.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-141">When installing MSMQ, you can install Active Directory integration, which requires the computer to be part of a Windows domain network.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="ebbeb-142"> MSMQ, consulte [instalar o enfileiramento de mensagens (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-142"> MSMQ, see [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span></span>  
  
### <a name="netmsmqbinding"></a><span data-ttu-id="ebbeb-143">NetMsmqBinding</span><span class="sxs-lookup"><span data-stu-id="ebbeb-143">NetMsmqBinding</span></span>  
 <span data-ttu-id="ebbeb-144">O [ \<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) é a associação em fila [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fornece para duas [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] pontos de extremidade para se comunicar usando o MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-144">The [\<netMsmqBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) is the queued binding [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides for two [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoints to communicate using MSMQ.</span></span> <span data-ttu-id="ebbeb-145">A associação, portanto, expõe as propriedades que são específicas para o MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-145">The binding, therefore, exposes properties that are specific to MSMQ.</span></span> <span data-ttu-id="ebbeb-146">No entanto, nem todos os recursos do MSMQ e propriedades são expostas no `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-146">However, not all MSMQ features and properties are exposed in the `NetMsmqBinding`.</span></span> <span data-ttu-id="ebbeb-147">O compact `NetMsmqBinding` foi projetado com um conjunto ideal de recursos de que a maioria dos clientes deve ser suficiente.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-147">The compact `NetMsmqBinding` is designed with an optimal set of features that most customers should find sufficient.</span></span>  
  
 <span data-ttu-id="ebbeb-148">O `NetMsmqBinding` manifestos os principais conceitos de enfileiramento de mensagens discutidos até agora na forma de propriedades em associações.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-148">The `NetMsmqBinding` manifests the core queuing concepts discussed thus far in the form of properties on the bindings.</span></span> <span data-ttu-id="ebbeb-149">Essas propriedades, por sua vez, se comunicam com MSMQ como transferir e entregar as mensagens.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-149">These properties, in turn, communicate to MSMQ how to transfer and deliver the messages.</span></span> <span data-ttu-id="ebbeb-150">Uma descrição das categorias de propriedade está nas seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-150">A discussion of the property categories is in the following sections.</span></span> <span data-ttu-id="ebbeb-151">Para obter mais informações, consulte os tópicos conceituais que descrevem as propriedades específicas mais completamente.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-151">For more information, see the conceptual topics that describe specific properties more completely.</span></span>  
  
#### <a name="exactlyonce-and-durable-properties"></a><span data-ttu-id="ebbeb-152">Propriedades duráveis e ExactlyOnce</span><span class="sxs-lookup"><span data-stu-id="ebbeb-152">ExactlyOnce and Durable Properties</span></span>  
 <span data-ttu-id="ebbeb-153">O `ExactlyOnce` e `Durable` propriedades afetam como as mensagens são transferidas entre filas:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-153">The `ExactlyOnce` and `Durable` properties affect how messages are transferred between queues:</span></span>  
  
-   <span data-ttu-id="ebbeb-154">`ExactlyOnce`: Quando definido como `true` (o padrão), o canal em fila garante que a mensagem, se fornecido, não sejam duplicada.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-154">`ExactlyOnce`: When set to `true` (the default), the queued channel ensures that the message, if delivered, is not duplicated.</span></span> <span data-ttu-id="ebbeb-155">Ele também garante que a mensagem não será perdida.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-155">It also ensures that the message is not lost.</span></span> <span data-ttu-id="ebbeb-156">Se a mensagem não pode ser entregue, ou a mensagem de tempo de vida expira antes que a mensagem pode ser entregue, junto com o motivo da falha de entrega a mensagem de falha é registrada em uma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-156">If the message cannot be delivered, or the message Time-To Live expires before the message can be delivered, the failed message along with the delivery failure reason is recorded in a dead-letter queue.</span></span> <span data-ttu-id="ebbeb-157">Quando definido como `false`, o canal em fila torna um esforço para transferir a mensagem.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-157">When set to `false`, the queued channel makes an effort to transfer the message.</span></span> <span data-ttu-id="ebbeb-158">Nesse caso, opcionalmente, você pode escolher uma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-158">In this case, you can optionally choose a dead-letter queue.</span></span>  
  
-   <span data-ttu-id="ebbeb-159">`Durable:` Quando definido como `true` (o padrão), o canal em fila garante que MSMQ armazena a mensagem de forma durável no disco.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-159">`Durable:` When set to `true` (the default), the queued channel ensures that MSMQ stores the message durably on disk.</span></span> <span data-ttu-id="ebbeb-160">Assim, se o serviço MSMQ parar e reiniciar, as mensagens em disco é transferida para a fila de destino ou entregues ao serviço.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-160">Thus, if the MSMQ service were to stop and restart, the messages on disk is transferred to the target queue or delivered to the service.</span></span> <span data-ttu-id="ebbeb-161">Quando definido como `false`, as mensagens são armazenadas no repositório volátil e serão perdidas em interromper e reiniciar o serviço MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-161">When set to `false`, the messages are stored in volatile store and are lost on stopping and restarting the MSMQ service.</span></span>  
  
 <span data-ttu-id="ebbeb-162">Para `ExactlyOnce` transferência confiável, MSMQ requer a fila transacional.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-162">For `ExactlyOnce` reliable transfer, MSMQ requires the queue to be transactional.</span></span> <span data-ttu-id="ebbeb-163">Além disso, o MSMQ exige uma transação ler de uma fila transacional.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-163">Also, MSMQ requires a transaction to read from a transactional queue.</span></span> <span data-ttu-id="ebbeb-164">Dessa forma, quando você usa o `NetMsmqBinding`, lembre-se de que uma transação é necessária para enviar ou receber mensagens quando `ExactlyOnce` é definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-164">As such, when you use the `NetMsmqBinding`, remember that a transaction is required to send or receive messages when `ExactlyOnce` is set to `true`.</span></span> <span data-ttu-id="ebbeb-165">Da mesma forma, o MSMQ requer a fila não transacional por garantias de melhor esforço, como quando `ExactlyOnce` é `false` e para mensagens voláteis.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-165">Similarly, MSMQ requires the queue to be non-transactional for best-effort assurances, such as when `ExactlyOnce` is `false` and for volatile messaging.</span></span> <span data-ttu-id="ebbeb-166">Portanto, ao definir `ExactlyOnce` para `false` ou durável para `false`, não é possível enviar ou receber o uso de uma transação.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-166">Thus, when setting `ExactlyOnce` to `false` or durable to `false`, you cannot send or receive using a transaction.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ebbeb-167">Certifique-se de que a fila correta (transacional ou não transacional) é criada com base nas configurações nas associações.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-167">Ensure that the correct queue (transactional or non-transactional) is created based on settings in the bindings.</span></span> <span data-ttu-id="ebbeb-168">Se `ExactlyOnce` é `true`, use uma fila transacional; caso contrário, use uma fila não transacional.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-168">If `ExactlyOnce` is `true`, use a transactional queue; otherwise, use a non-transactional queue.</span></span>  
  
#### <a name="dead-letter-queue-properties"></a><span data-ttu-id="ebbeb-169">Propriedades da fila de mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="ebbeb-169">Dead-Letter Queue Properties</span></span>  
 <span data-ttu-id="ebbeb-170">A fila de mensagens mortas é usada para armazenar as mensagens com falha de entrega.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-170">The dead-letter queue is used to store messages that fail delivery.</span></span> <span data-ttu-id="ebbeb-171">O usuário pode gravar a lógica de compensação que lê mensagens fora da fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-171">The user can write compensating logic that reads messages out of the dead-letter queue.</span></span>  
  
 <span data-ttu-id="ebbeb-172">Fornecem muitos sistemas de enfileiramento de mensagens para uma fila de mensagens mortas de todo o sistema.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-172">Many queuing systems provide for a system-wide dead-letter queue.</span></span> <span data-ttu-id="ebbeb-173">MSMQ fornece uma fila de mensagens mortas não transacional todo o sistema para as mensagens com falha de entrega para filas não transacional e uma fila de mensagens mortas transacional todo o sistema de mensagens de falha de entrega para filas transacionais.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-173">MSMQ provides a system-wide non-transactional dead-letter queue for messages that fail delivery to non-transactional queues and a system-wide transactional dead-letter queue for messages that fail delivery to transactional queues.</span></span>  
  
 <span data-ttu-id="ebbeb-174">Se vários clientes enviando mensagens para filas de destino diferentes compartilharem o serviço do MSMQ, todas as mensagens enviadas pelos clientes vá para a mesma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-174">If multiple clients sending messages to different target queues share the MSMQ service, all messages sent by the clients go to the same dead-letter queue.</span></span> <span data-ttu-id="ebbeb-175">Isso nem sempre é preferível.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-175">This is not always preferable.</span></span> <span data-ttu-id="ebbeb-176">Para melhor isolamento, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] e MSMQ em [!INCLUDE[wv](../../../../includes/wv-md.md)] fornecem uma fila de mensagens mortas personalizada (ou a fila de mensagens mortas específicas do aplicativo) que o usuário pode especificar para armazenar as mensagens com falha de entrega.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-176">For better isolation, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] provide a custom dead-letter queue (or application-specific dead-letter queue) that the user can specify to store messages that fail delivery.</span></span> <span data-ttu-id="ebbeb-177">Portanto, clientes diferentes não compartilham a mesma fila de mensagens mortas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-177">Therefore, different clients do not share the same dead-letter queue.</span></span>  
  
 <span data-ttu-id="ebbeb-178">A associação tem duas propriedades de interesse:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-178">The binding has two properties of interest:</span></span>  
  
-   <span data-ttu-id="ebbeb-179">`DeadLetterQueue`: Esta propriedade é uma enumeração que indica se uma fila de mensagens mortas é solicitada.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-179">`DeadLetterQueue`: This property is an enumeration that indicates whether a dead-letter queue is requested.</span></span> <span data-ttu-id="ebbeb-180">A enumeração também contém o tipo de fila de mensagens mortas, se for solicitado.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-180">The enumeration also contains the kind of dead-letter queue, if one is requested.</span></span> <span data-ttu-id="ebbeb-181">Os valores são `None`, `System`, e `Custom`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-181">The values are `None`, `System`, and `Custom`.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="ebbeb-182"> a interpretação dessas propriedades, consulte [usando filas de mensagens mortas para lidar com falhas de transferência de mensagem](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span><span class="sxs-lookup"><span data-stu-id="ebbeb-182"> the interpretation of these properties, see [Using Dead-Letter Queues to Handle Message Transfer Failures](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span></span>  
  
-   <span data-ttu-id="ebbeb-183">`CustomDeadLetterQueue`: Essa propriedade é o endereço de identificador de recurso uniforme (URI) da fila de mensagens mortas específicas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-183">`CustomDeadLetterQueue`: This property is the Uniform Resource Identifier (URI) address of the application-specific dead-letter queue.</span></span> <span data-ttu-id="ebbeb-184">Isso é necessário se `DeadLetterQueue`.`Custom`</span><span class="sxs-lookup"><span data-stu-id="ebbeb-184">This is required if `DeadLetterQueue`.`Custom`</span></span> <span data-ttu-id="ebbeb-185">é escolhido.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-185">is chosen.</span></span>  
  
#### <a name="poison-message-handling-properties"></a><span data-ttu-id="ebbeb-186">Propriedades de manipulação de mensagens suspeitas</span><span class="sxs-lookup"><span data-stu-id="ebbeb-186">Poison Message Handling properties</span></span>  
 <span data-ttu-id="ebbeb-187">Quando o serviço lê mensagens da fila de destino em uma transação, o serviço pode falhar ao processar a mensagem por vários motivos.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-187">When the service reads messages from the target queue under a transaction, the service may fail to process the message for various reasons.</span></span> <span data-ttu-id="ebbeb-188">A mensagem, em seguida, é colocada de volta para a fila a ser lido novamente.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-188">The message is then put back into the queue to be read again.</span></span> <span data-ttu-id="ebbeb-189">Para lidar com mensagens que falham repetidamente, um conjunto de tratamento de mensagens suspeitas de propriedades podem ser configuradas na associação.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-189">To deal with messages that fail repeatedly, a set of poison-message handling properties can be configured in the binding.</span></span> <span data-ttu-id="ebbeb-190">Há quatro propriedades: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, e `ReceiveErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-190">There are four properties: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, and `ReceiveErrorHandling`.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="ebbeb-191"> Essas propriedades, consulte [manipulação de mensagens suspeitas](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-191"> these properties, see [Poison Message Handling](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span></span>  
  
#### <a name="security-properties"></a><span data-ttu-id="ebbeb-192">Propriedades de segurança</span><span class="sxs-lookup"><span data-stu-id="ebbeb-192">Security Properties</span></span>  
 <span data-ttu-id="ebbeb-193">MSMQ expõe seu próprio modelo de segurança, como listas de controle de acesso (ACLs) em uma fila ou enviar mensagens autenticadas.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-193">MSMQ exposes its own security model, such as access control lists (ACLs) on a queue or sending authenticated messages.</span></span> <span data-ttu-id="ebbeb-194">O `NetMsmqBinding` expõe essas propriedades de segurança como parte de suas configurações de segurança de transporte.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-194">The `NetMsmqBinding` exposes these security properties as part of its transport security settings.</span></span> <span data-ttu-id="ebbeb-195">Há duas propriedades na associação de segurança de transporte: `MsmqAuthenticationMode` e `MsmqProtectionLevel`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-195">There are two properties in the binding for transport security: `MsmqAuthenticationMode` and `MsmqProtectionLevel`.</span></span> <span data-ttu-id="ebbeb-196">Configurações nessas propriedades dependem de como o MSMQ está configurado.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-196">Settings in these properties depend on how MSMQ is configured.</span></span> <span data-ttu-id="ebbeb-197">Para obter mais informações, consulte [proteger mensagens usando a segurança de transporte](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-197">For more information, see [Securing Messages Using Transport Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span></span>  
  
 <span data-ttu-id="ebbeb-198">Além da segurança de transporte, a própria mensagem SOAP real pode ser protegida usando a segurança de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-198">In addition to transport security, the actual SOAP message itself can be secured using message security.</span></span> <span data-ttu-id="ebbeb-199">Para obter mais informações, consulte [proteger mensagens usando segurança de mensagem](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-199">For more information, see [Securing Messages Using Message Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span></span>  
  
 <span data-ttu-id="ebbeb-200">`MsmqTransportSecurity` também expõe duas propriedades, `MsmqEncryptionAlgorithm` e `MsmqHashAlgorithm`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-200">`MsmqTransportSecurity` also exposes two properties, `MsmqEncryptionAlgorithm` and `MsmqHashAlgorithm`.</span></span> <span data-ttu-id="ebbeb-201">Essas são as enumerações de algoritmos diferentes para escolher para criptografia de transferência de fila para a fila de mensagens e as assinaturas de hash.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-201">These are enumerations of different algorithms to choose for queue-to-queue transfer encryption of messages and hashing of the signatures.</span></span>  
  
#### <a name="other-properties"></a><span data-ttu-id="ebbeb-202">Outras propriedades</span><span class="sxs-lookup"><span data-stu-id="ebbeb-202">Other Properties</span></span>  
 <span data-ttu-id="ebbeb-203">Além das propriedades acima, outras propriedades específicas do MSMQ expostas no incluem associação:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-203">In addition to the preceding properties, other MSMQ-specific properties exposed in the binding include:</span></span>  
  
-   <span data-ttu-id="ebbeb-204">`UseSourceJournal`: Uma propriedade para indicar que o diário de origem está ativada.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-204">`UseSourceJournal`: A property to indicate that source journaling is turned on.</span></span> <span data-ttu-id="ebbeb-205">Diário de origem é um recurso do MSMQ que mantém o controle de mensagens que foram transmitidas com êxito da fila de transmissão.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-205">Source journaling is an MSMQ feature that keeps track of messages that have been successfully transmitted from the transmission queue.</span></span>  
  
-   <span data-ttu-id="ebbeb-206">`UseMsmqTracing`: Uma propriedade para indicar que o rastreamento do MSMQ está ativado.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-206">`UseMsmqTracing`: A property to indicate that MSMQ tracing is turned on.</span></span> <span data-ttu-id="ebbeb-207">Rastreamento de MSMQ envia mensagens de relatório para uma fila de relatórios sempre que uma mensagem sai ou chega em um computador que hospeda um Gerenciador de fila MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-207">MSMQ tracing sends report messages to a report queue each time a message leaves or arrives at a machine hosting an MSMQ queue manager.</span></span>  
  
-   <span data-ttu-id="ebbeb-208">`QueueTransferProtocol`: Uma enumeração do protocolo a ser usado para transferências de mensagem da fila para a fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-208">`QueueTransferProtocol`: An enumeration of the protocol to use for queue-to-queue message transfers.</span></span> <span data-ttu-id="ebbeb-209">MSMQ implementa um protocolo de transferência de fila para a fila nativa e um protocolo baseado em SOAP, chamado de protocolo de mensagens confiável SOAP (SRMP).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-209">MSMQ implements a native queue-to-queue transfer protocol and a SOAP-based protocol called SOAP Reliable Messaging Protocol (SRMP).</span></span> <span data-ttu-id="ebbeb-210">SRMP é usada ao usar o transporte HTTP para transferências de fila para a fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-210">SRMP is used when using HTTP transport for queue-to-queue transfers.</span></span> <span data-ttu-id="ebbeb-211">SRMP segura é usada quando HTTPS é usado para transferências de fila para a fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-211">SRMP secure is used when using HTTPS for queue-to-queue transfers.</span></span>  
  
-   <span data-ttu-id="ebbeb-212">`UseActiveDirectory`: Um valor booleano para indicar se o Active Directory deve ser usado para resolução de endereço da fila.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-212">`UseActiveDirectory`: A Boolean value to indicate whether the Active Directory must be used for queue address resolution.</span></span> <span data-ttu-id="ebbeb-213">Por padrão, isso está desativado.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-213">By default, this is off.</span></span> <span data-ttu-id="ebbeb-214">Para obter mais informações, consulte [pontos de extremidade de serviço e endereçamento de fila](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="ebbeb-214">For more information, see [Service Endpoints and Queue Addressing](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span></span>  
  
### <a name="msmqintegrationbinding"></a><span data-ttu-id="ebbeb-215">MsmqIntegrationBinding</span><span class="sxs-lookup"><span data-stu-id="ebbeb-215">MsmqIntegrationBinding</span></span>  
 <span data-ttu-id="ebbeb-216">O `MsmqIntegrationBinding` é usado quando você deseja uma [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] ponto de extremidade para se comunicar com um aplicativo existente do MSMQ escrito em C, C++, COM ou System.Messaging APIs.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-216">The `MsmqIntegrationBinding` is used when you want a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint to communicate with an existing MSMQ application written in C, C++, COM, or System.Messaging APIs.</span></span>  
  
 <span data-ttu-id="ebbeb-217">As propriedades de associação são os mesmos para `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-217">The binding properties are the same as for `NetMsmqBinding`.</span></span> <span data-ttu-id="ebbeb-218">No entanto, as seguintes diferenças se aplicam:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-218">However, the following differences apply:</span></span>  
  
-   <span data-ttu-id="ebbeb-219">O contrato de operação para `MsmqIntegrationBinding` é restrito a fazer um único parâmetro do tipo <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> onde o parâmetro de tipo é o tipo de corpo.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-219">The operation contract for `MsmqIntegrationBinding` is restricted to taking a single parameter of type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> where the type parameter is the body type.</span></span>  
  
-   <span data-ttu-id="ebbeb-220">Muitas das propriedades de mensagem nativa do MSMQ são expostos no <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> para uso.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-220">Much of MSMQ native message properties are exposed in the <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> for use.</span></span>  
  
-   <span data-ttu-id="ebbeb-221">Para ajudar com a serialização e desserialização do corpo da mensagem, serializadores como XML e ActiveX são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="ebbeb-221">To help with serialization and deserialization of the message body, serializers such as XML and ActiveX are provided.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="ebbeb-222">Código de exemplo</span><span class="sxs-lookup"><span data-stu-id="ebbeb-222">Sample Code</span></span>  
 <span data-ttu-id="ebbeb-223">Para obter instruções passo a passo sobre como escrever WCF serviços que usam o MSMQ Consulte os tópicos a seguir:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-223">For step by step instructions on how to write WCF services that use MSMQ see the following topics:</span></span>  
  
-   [<span data-ttu-id="ebbeb-224">Como trocar mensagens com pontos de extremidade do WCF e aplicativos de enfileiramento de mensagens</span><span class="sxs-lookup"><span data-stu-id="ebbeb-224">How to: Exchange Messages with WCF Endpoints and Message Queuing Applications</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md)  
  
-   [<span data-ttu-id="ebbeb-225">Como trocar mensagens na fila com pontos de extremidade do WCF</span><span class="sxs-lookup"><span data-stu-id="ebbeb-225">How to: Exchange Queued Messages with WCF Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-queued-messages-with-wcf-endpoints.md)  
  
 <span data-ttu-id="ebbeb-226">Para obter um exemplo de código completo que ilustra o uso do MSMQ no WCF, consulte os tópicos a seguir:</span><span class="sxs-lookup"><span data-stu-id="ebbeb-226">For a completed code sample illustrating the use of MSMQ in WCF see the following topics:</span></span>  
  
-   [<span data-ttu-id="ebbeb-227">Associação transacionada do MSMQ</span><span class="sxs-lookup"><span data-stu-id="ebbeb-227">Transacted MSMQ Binding</span></span>](../../../../docs/framework/wcf/samples/transacted-msmq-binding.md)  
  
-   [<span data-ttu-id="ebbeb-228">Comunicação em fila volátil</span><span class="sxs-lookup"><span data-stu-id="ebbeb-228">Volatile Queued Communication</span></span>](../../../../docs/framework/wcf/samples/volatile-queued-communication.md)  
  
-   [<span data-ttu-id="ebbeb-229">Filas de mensagens mortas</span><span class="sxs-lookup"><span data-stu-id="ebbeb-229">Dead Letter Queues</span></span>](../../../../docs/framework/wcf/samples/dead-letter-queues.md)  
  
-   [<span data-ttu-id="ebbeb-230">Sessões e filas</span><span class="sxs-lookup"><span data-stu-id="ebbeb-230">Sessions and Queues</span></span>](../../../../docs/framework/wcf/samples/sessions-and-queues.md)  
  
-   [<span data-ttu-id="ebbeb-231">Comunicação bidirecional</span><span class="sxs-lookup"><span data-stu-id="ebbeb-231">Two-Way Communication</span></span>](../../../../docs/framework/wcf/samples/two-way-communication.md)  
  
-   [<span data-ttu-id="ebbeb-232">Envio em lote transacionado</span><span class="sxs-lookup"><span data-stu-id="ebbeb-232">Transacted Batching</span></span>](../../../../docs/framework/wcf/samples/transacted-batching.md)  
  
-   [<span data-ttu-id="ebbeb-233">SRMP</span><span class="sxs-lookup"><span data-stu-id="ebbeb-233">SRMP</span></span>](../../../../docs/framework/wcf/samples/srmp.md)  
  
-   [<span data-ttu-id="ebbeb-234">Segurança de mensagem através do enfileiramento de mensagem</span><span class="sxs-lookup"><span data-stu-id="ebbeb-234">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)  
  
## <a name="see-also"></a><span data-ttu-id="ebbeb-235">Consulte também</span><span class="sxs-lookup"><span data-stu-id="ebbeb-235">See Also</span></span>  
 [<span data-ttu-id="ebbeb-236">Pontos de extremidade de serviço e endereçamento de fila</span><span class="sxs-lookup"><span data-stu-id="ebbeb-236">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)  
 [<span data-ttu-id="ebbeb-237">Hospedagem na Web de um aplicativo na fila</span><span class="sxs-lookup"><span data-stu-id="ebbeb-237">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
