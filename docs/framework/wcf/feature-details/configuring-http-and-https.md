---
title: Configurando HTTP e HTTPS - WCF
ms.date: 04/08/2019
helpviewer_keywords:
- configuring HTTP [WCF]
ms.assetid: b0c29a86-bc0c-41b3-bc1e-4eb5bb5714d4
ms.openlocfilehash: 86705a4f8daa327c442ac6c53c9b44c5b5c5c2ad
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59427169"
---
# <a name="configuring-http-and-https"></a><span data-ttu-id="fc4c3-102">Configurando HTTP e HTTPS</span><span class="sxs-lookup"><span data-stu-id="fc4c3-102">Configuring HTTP and HTTPS</span></span>

<span data-ttu-id="fc4c3-103">Os serviços e os clientes WCF podem se comunicar por HTTP e HTTPS.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-103">WCF services and clients can communicate over HTTP and HTTPS.</span></span> <span data-ttu-id="fc4c3-104">As configurações de HTTP/HTTPS são definidas usando o IIS (Serviços de Informações da Internet) ou uma ferramenta de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-104">The HTTP/HTTPS settings are configured by using Internet Information Services (IIS) or through the use of a command-line tool.</span></span> <span data-ttu-id="fc4c3-105">Quando um serviço WCF é hospedado no IIS HTTP ou HTTPS, as configurações podem ser definidas no IIS (usando a ferramenta inetmgr.exe).</span><span class="sxs-lookup"><span data-stu-id="fc4c3-105">When a WCF service is hosted under IIS HTTP or HTTPS settings can be configured within IIS (using the inetmgr.exe tool).</span></span> <span data-ttu-id="fc4c3-106">Se um serviço WCF for auto-hospedado, as configurações de HTTP ou HTTPS serão definidas usando uma ferramenta de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-106">If a WCF service is self-hosted, HTTP or HTTPS settings are configured by using a command-line tool.</span></span>

<span data-ttu-id="fc4c3-107">No mínimo, você deseja configurar um registro de URL e adicionar uma exceção de Firewall para a URL usando o seu serviço.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-107">At a minimum, you want to configure a URL registration and add a Firewall exception for the URL your service will be using.</span></span> <span data-ttu-id="fc4c3-108">Você pode definir essas configurações com a ferramenta Netsh.exe.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-108">You can configure these settings with the Netsh.exe tool.</span></span>

## <a name="configuring-namespace-reservations"></a><span data-ttu-id="fc4c3-109">Configurando reservas de namespace</span><span class="sxs-lookup"><span data-stu-id="fc4c3-109">Configuring namespace reservations</span></span>

<span data-ttu-id="fc4c3-110">A reserva de namespace atribui os direitos para uma parte do namespace da URL HTTP para um determinado grupo de usuários.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-110">Namespace reservation assigns the rights for a portion of the HTTP URL namespace to a particular group of users.</span></span> <span data-ttu-id="fc4c3-111">Uma reserva dá a esses usuários o direito de criar serviços que escutam naquela parte do namespace.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-111">A reservation gives those users the right to create services that listen on that portion of the namespace.</span></span> <span data-ttu-id="fc4c3-112">As reservas são prefixos de URL, que significa que a reserva cobre todos os subcaminhos do caminho de reserva.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-112">Reservations are URL prefixes, meaning that the reservation covers all subpaths of the reservation path.</span></span> <span data-ttu-id="fc4c3-113">As reservas de namespace permitem usar caracteres curinga de duas maneiras.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-113">Namespace reservations permit two ways to use wildcards.</span></span> <span data-ttu-id="fc4c3-114">A documentação da API de servidor HTTP descreve a [ordem de resolução de nomes entre as declarações de namespace que envolvem caracteres curinga](/windows/desktop/Http/routing-incoming-requests).</span><span class="sxs-lookup"><span data-stu-id="fc4c3-114">The HTTP Server API documentation describes the [order of resolution between namespace claims that involve wildcards](/windows/desktop/Http/routing-incoming-requests).</span></span>

<span data-ttu-id="fc4c3-115">Um aplicativo em execução pode criar uma solicitação semelhante para adicionar registros de namespace.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-115">A running application can create a similar request to add namespace registrations.</span></span> <span data-ttu-id="fc4c3-116">Os registros e as reservas competem por partes do namespace.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-116">Registrations and reservations compete for portions of the namespace.</span></span> <span data-ttu-id="fc4c3-117">Uma reserva pode ter precedência sobre um registro de acordo com a ordem de resolução determinada na [ordem de resolução de nomes entre as declarações de namespace que envolvem caracteres curinga](/windows/desktop/Http/routing-incoming-requests).</span><span class="sxs-lookup"><span data-stu-id="fc4c3-117">A reservation may have precedence over a registration according to the order of resolution given in the [order of resolution between namespace claims that involve wildcards](/windows/desktop/Http/routing-incoming-requests).</span></span> <span data-ttu-id="fc4c3-118">Nesse caso, a reserva impede que o aplicativo em execução receba pedidos.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-118">In this case, the reservation blocks the running application from receiving requests.</span></span>

<span data-ttu-id="fc4c3-119">O exemplo a seguir usa a ferramenta Netsh.exe:</span><span class="sxs-lookup"><span data-stu-id="fc4c3-119">The following example uses the Netsh.exe tool:</span></span>

```console
netsh http add urlacl url=http://+:80/MyUri user=DOMAIN\user
```

<span data-ttu-id="fc4c3-120">Este comando adiciona uma reserva de URL para o namespace de URL especificado para a conta de domínio \ usuário.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-120">This command adds a URL reservation for the specified URL namespace for the DOMAIN\user account.</span></span> <span data-ttu-id="fc4c3-121">Para obter mais informações sobre como usar o comando netsh, digite `netsh http add urlacl /?` em um prompt de comando e pressione Enter.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-121">For more information on using the netsh command, type `netsh http add urlacl /?` in a command-prompt and press Enter.</span></span>

## <a name="configuring-a-firewall-exception"></a><span data-ttu-id="fc4c3-122">Configurando uma exceção de firewall</span><span class="sxs-lookup"><span data-stu-id="fc4c3-122">Configuring a firewall exception</span></span>

<span data-ttu-id="fc4c3-123">Ao auto-hospedar um serviço WCF que se comunica por HTTP, uma exceção deverá ser adicionada à configuração do firewall para permitir conexões de entrada usando uma URL específica.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-123">When self-hosting a WCF service that communicates over HTTP, an exception must be added to the firewall configuration to allow inbound connections using a particular URL.</span></span>

## <a name="configuring-ssl-certificates"></a><span data-ttu-id="fc4c3-124">Configurar certificados SSL</span><span class="sxs-lookup"><span data-stu-id="fc4c3-124">Configuring SSL certificates</span></span>

<span data-ttu-id="fc4c3-125">O protocolo SSL usa certificados no cliente e no servidor para armazenar as chaves de criptografia.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-125">The Secure Sockets Layer (SSL) protocol uses certificates on the client and server to store encryption keys.</span></span> <span data-ttu-id="fc4c3-126">O servidor fornece seu certificado SSL quando uma conexão é feita para que o cliente possa verificar a identidade do servidor.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-126">The server provides its SSL certificate when a connection is made so that the client can verify the server identity.</span></span> <span data-ttu-id="fc4c3-127">O servidor também pode solicitar um certificado do cliente para fornecer autenticação mútua dos dois lados da conexão.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-127">The server can also request a certificate from the client to provide mutual authentication of both sides of the connection.</span></span>

<span data-ttu-id="fc4c3-128">Os certificados são armazenados em um repositório centralizado de acordo com o endereço IP e o número da porta de conexão.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-128">Certificates are stored in a centralized store according to the IP address and port number of the connection.</span></span> <span data-ttu-id="fc4c3-129">O endereço IP especial 0.0.0.0 corresponde a qualquer endereço IP do computador local.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-129">The special IP address 0.0.0.0 matches any IP address for the local machine.</span></span> <span data-ttu-id="fc4c3-130">Observe que o repositório de certificados não distingue URLs com base no caminho.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-130">Note that the certificate store doesn't distinguish URLs based on the path.</span></span> <span data-ttu-id="fc4c3-131">Os serviços com a mesma combinação de endereço IP e porta devem compartilhar certificados mesmo que o caminho da URL dos serviços seja diferente.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-131">Services with the same IP address and port combination must share certificates even if the path in the URL for the services is different.</span></span>

<span data-ttu-id="fc4c3-132">Para obter instruções passo a passo, consulte [como: Configurar uma porta com um certificado SSL](how-to-configure-a-port-with-an-ssl-certificate.md).</span><span class="sxs-lookup"><span data-stu-id="fc4c3-132">For step-by-step instructions, see [How to: Configure a Port with an SSL Certificate](how-to-configure-a-port-with-an-ssl-certificate.md).</span></span>

## <a name="configuring-the-ip-listen-list"></a><span data-ttu-id="fc4c3-133">Configurando a lista de escuta de IP</span><span class="sxs-lookup"><span data-stu-id="fc4c3-133">Configuring the IP Listen List</span></span>

<span data-ttu-id="fc4c3-134">A API de servidor HTTP é associada apenas a um endereço IP e porta quando um usuário registra uma URL.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-134">The HTTP Server API only binds to an IP address and port once a user registers a URL.</span></span> <span data-ttu-id="fc4c3-135">Por padrão, a API de servidor HTTP é associada à porta na URL para todos os endereços IP do computador.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-135">By default, the HTTP Server API binds to the port in the URL for all of the IP addresses of the machine.</span></span> <span data-ttu-id="fc4c3-136">Um conflito será gerado se um aplicativo que não usa o HTTP Server API tiver sido associado anteriormente a essa combinação de endereço IP e porta.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-136">A conflict arises if an application that doesn't use the HTTP Server API has previously bound to that combination of IP address and port.</span></span> <span data-ttu-id="fc4c3-137">A lista de escuta de IP permite que os serviços do WCF coexistir com aplicativos que usam uma porta para alguns dos endereços IP da máquina.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-137">The IP Listen List allows WCF services to coexist with applications that use a port for some of the IP addresses of the machine.</span></span> <span data-ttu-id="fc4c3-138">Se a lista de escuta IP contiver qualquer entrada, a API de servidor HTTP será associada apenas aos endereços IP especificados na lista.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-138">If the IP Listen List contains any entries, the HTTP Server API only binds to those IP addresses that the list specifies.</span></span> <span data-ttu-id="fc4c3-139">A modificação da lista de escuta IP exige privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-139">Modifying the IP Listen List requires administrative privileges.</span></span>

<span data-ttu-id="fc4c3-140">Use a ferramenta netsh para modificar a lista de escuta de IP, conforme mostrado no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="fc4c3-140">Use the netsh tool to modify the IP Listen List, as shown in the following example:</span></span>

```console
netsh http add iplisten ipaddress=0.0.0.0:8000
```

## <a name="other-configuration-settings"></a><span data-ttu-id="fc4c3-141">Outras definições de configuração</span><span class="sxs-lookup"><span data-stu-id="fc4c3-141">Other configuration settings</span></span>

<span data-ttu-id="fc4c3-142">Ao usar <xref:System.ServiceModel.WSDualHttpBinding>, a conexão de cliente usa os padrões que são compatíveis com as reservas de namespace e o firewall do Windows.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-142">When using <xref:System.ServiceModel.WSDualHttpBinding>, the client connection uses defaults that are compatible with namespace reservations and the Windows firewall.</span></span> <span data-ttu-id="fc4c3-143">Se você escolher personalizar o endereço base do cliente de uma conexão dupla, também deverá definir essas configurações HTTP no cliente para que correspondam ao novo endereço.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-143">If you choose to customize the client base address of a dual connection, then you also must configure these HTTP settings on the client to match the new address.</span></span>

<span data-ttu-id="fc4c3-144">A API do servidor HTTP tem algumas configurações avançadas que não estão disponíveis por meio de HttpCfg.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-144">The HTTP Server API has some advanced configuration settings that aren't available through HttpCfg.</span></span> <span data-ttu-id="fc4c3-145">Essas configurações são mantidas no Registro e aplicam-se a todos os aplicativos executados nos sistemas que usam as APIs do servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-145">These settings are maintained in the registry and apply to all applications running on the systems that use the HTTP Server APIs.</span></span> <span data-ttu-id="fc4c3-146">Para obter informações sobre essas configurações, consulte [configurações de registro HTTP. sys para IIS](https://support.microsoft.com/en-us/help/820129/http-sys-registry-settings-for-windows).</span><span class="sxs-lookup"><span data-stu-id="fc4c3-146">For information about these settings, see [Http.sys registry settings for IIS](https://support.microsoft.com/en-us/help/820129/http-sys-registry-settings-for-windows).</span></span> <span data-ttu-id="fc4c3-147">A maioria dos usuários não precisa alterar essas configurações.</span><span class="sxs-lookup"><span data-stu-id="fc4c3-147">Most users don't need to change these settings.</span></span>

## <a name="see-also"></a><span data-ttu-id="fc4c3-148">Consulte também</span><span class="sxs-lookup"><span data-stu-id="fc4c3-148">See also</span></span>

- <xref:System.ServiceModel.WSDualHttpBinding>
- [<span data-ttu-id="fc4c3-149">Como: Configurar uma porta com um certificado SSL</span><span class="sxs-lookup"><span data-stu-id="fc4c3-149">How to: Configure a Port with an SSL Certificate</span></span>](how-to-configure-a-port-with-an-ssl-certificate.md)
