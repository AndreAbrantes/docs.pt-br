---
title: "Serialização e desserialização"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 3d71814c-bda7-424b-85b7-15084ff9377a
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 2cf83f7c9af667a9efed59ff7a1f86ace6d8821d
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/02/2017
---
# <a name="serialization-and-deserialization"></a><span data-ttu-id="48735-102">Serialização e desserialização</span><span class="sxs-lookup"><span data-stu-id="48735-102">Serialization and Deserialization</span></span>
<span data-ttu-id="48735-103">O [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] inclui um novo mecanismo de serialização, o <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-103">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] includes a new serialization engine, the <xref:System.Runtime.Serialization.DataContractSerializer>.</span></span> <span data-ttu-id="48735-104">O <xref:System.Runtime.Serialization.DataContractSerializer> converte entre objetos do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] e XML, em ambas as direções.</span><span class="sxs-lookup"><span data-stu-id="48735-104">The <xref:System.Runtime.Serialization.DataContractSerializer> translates between [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects and XML, in both directions.</span></span> <span data-ttu-id="48735-105">Este tópico explica como o serializador funciona.</span><span class="sxs-lookup"><span data-stu-id="48735-105">This topic explains how the serializer works.</span></span>  
  
 <span data-ttu-id="48735-106">Ao serializar [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objetos, o serializador compreende uma variedade de modelos, incluindo os novos de programação de serialização *contrato de dados* modelo.</span><span class="sxs-lookup"><span data-stu-id="48735-106">When serializing [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, the serializer understands a variety of serialization programming models, including the new *data contract* model.</span></span> <span data-ttu-id="48735-107">Para obter uma lista completa de tipos com suporte, consulte [tipos suportados pelo serializador de contrato de dados](../../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md).</span><span class="sxs-lookup"><span data-stu-id="48735-107">For a full list of supported types, see [Types Supported by the Data Contract Serializer](../../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md).</span></span> <span data-ttu-id="48735-108">Para obter uma introdução aos contratos de dados, consulte [usando contratos de dados](../../../../docs/framework/wcf/feature-details/using-data-contracts.md).</span><span class="sxs-lookup"><span data-stu-id="48735-108">For an introduction to data contracts, see [Using Data Contracts](../../../../docs/framework/wcf/feature-details/using-data-contracts.md).</span></span>  
  
 <span data-ttu-id="48735-109">Ao desserializar XML, o serializador usa as classes <xref:System.Xml.XmlReader> e <xref:System.Xml.XmlWriter>.</span><span class="sxs-lookup"><span data-stu-id="48735-109">When deserializing XML, the serializer uses the <xref:System.Xml.XmlReader> and <xref:System.Xml.XmlWriter> classes.</span></span> <span data-ttu-id="48735-110">Ele também dá suporte às classes <xref:System.Xml.XmlDictionaryReader> e <xref:System.Xml.XmlDictionaryWriter> para permitir que ele produza XML otimizado em alguns casos, como, por exemplo, ao usar o formato de XML binário do [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="48735-110">It also supports the <xref:System.Xml.XmlDictionaryReader> and <xref:System.Xml.XmlDictionaryWriter> classes to enable it to produce optimized XML in some cases, such as when using the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] binary XML format.</span></span>  
  
 <span data-ttu-id="48735-111">O [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] também inclui um serializador complementar, o <xref:System.Runtime.Serialization.NetDataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-111">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] also includes a companion serializer, the <xref:System.Runtime.Serialization.NetDataContractSerializer>.</span></span> <span data-ttu-id="48735-112">O <xref:System.Runtime.Serialization.NetDataContractSerializer> é semelhante a serializadores <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> e <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter> porque também emite nomes de tipo do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] como parte dos dados serializados.</span><span class="sxs-lookup"><span data-stu-id="48735-112">The <xref:System.Runtime.Serialization.NetDataContractSerializer> is similar to the <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> and <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter> serializers because it also emits [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type names as part of the serialized data.</span></span> <span data-ttu-id="48735-113">Ele é usado quando os mesmos tipos são compartilhados nas terminações de serialização e desserialização.</span><span class="sxs-lookup"><span data-stu-id="48735-113">It is used when the same types are shared on the serializing and the deserializing ends.</span></span> <span data-ttu-id="48735-114">O <xref:System.Runtime.Serialization.DataContractSerializer> e o <xref:System.Runtime.Serialization.NetDataContractSerializer> derivam de uma classe base comum, a <xref:System.Runtime.Serialization.XmlObjectSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-114">Both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Runtime.Serialization.NetDataContractSerializer> derive from a common base class, the <xref:System.Runtime.Serialization.XmlObjectSerializer>.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="48735-115">O <xref:System.Runtime.Serialization.DataContractSerializer> serializa cadeias de caracteres que contêm caracteres de controle com um valor hexadecimal abaixo de 20 como as entidades XML.</span><span class="sxs-lookup"><span data-stu-id="48735-115">The <xref:System.Runtime.Serialization.DataContractSerializer> serializes strings containing control characters with a hexadecimal value below 20 as XML entities.</span></span> <span data-ttu-id="48735-116">Isso pode causar um problema com um cliente WCF não ao enviar esses dados para um serviço WCF.</span><span class="sxs-lookup"><span data-stu-id="48735-116">This may cause a problem with a non-WCF client when sending such data to a WCF service.</span></span>  
  
## <a name="creating-a-datacontractserializer-instance"></a><span data-ttu-id="48735-117">Criando uma instância DataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="48735-117">Creating a DataContractSerializer Instance</span></span>  
 <span data-ttu-id="48735-118">Construir uma instância do <xref:System.Runtime.Serialization.DataContractSerializer> é uma etapa importante.</span><span class="sxs-lookup"><span data-stu-id="48735-118">Constructing an instance of the <xref:System.Runtime.Serialization.DataContractSerializer> is an important step.</span></span> <span data-ttu-id="48735-119">Após a compilação, você não poderá alterar as configurações.</span><span class="sxs-lookup"><span data-stu-id="48735-119">After construction, you cannot change any of the settings.</span></span>  
  
### <a name="specifying-the-root-type"></a><span data-ttu-id="48735-120">Especificando o tipo da raiz</span><span class="sxs-lookup"><span data-stu-id="48735-120">Specifying the Root Type</span></span>  
 <span data-ttu-id="48735-121">O *tipo raiz* é o tipo do qual as instâncias são serializadas ou desserializadas.</span><span class="sxs-lookup"><span data-stu-id="48735-121">The *root type* is the type of which instances are serialized or deserialized.</span></span> <span data-ttu-id="48735-122">O <xref:System.Runtime.Serialization.DataContractSerializer> tem várias sobrecargas de construtor, mas, no mínimo, um tipo de raiz deve ser fornecido usando o `type` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="48735-122">The <xref:System.Runtime.Serialization.DataContractSerializer> has many constructor overloads, but, at a minimum, a root type must be supplied using the `type` parameter.</span></span>  
  
 <span data-ttu-id="48735-123">Um serializador criado para um determinado tipo de raiz não pode ser usado para serializar (ou desserializar) outro tipo, a menos que o tipo seja derivado do tipo raiz.</span><span class="sxs-lookup"><span data-stu-id="48735-123">A serializer created for a certain root type cannot be used to serialize (or deserialize) another type, unless the type is derived from the root type.</span></span> <span data-ttu-id="48735-124">O exemplo a seguir mostra duas classes.</span><span class="sxs-lookup"><span data-stu-id="48735-124">The following example shows two classes.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#1)]
 [!code-vb[c_StandaloneDataContractSerializer#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#1)]  
  
 <span data-ttu-id="48735-125">Esse código cria uma instância `DataContractSerializer` que pode ser usada somente para serializar ou desserializar as instâncias da classe `Person`.</span><span class="sxs-lookup"><span data-stu-id="48735-125">This code constructs an instance of the `DataContractSerializer` that can be used only to serialize or deserialize instances of the `Person` class.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#2)]
 [!code-vb[c_StandaloneDataContractSerializer#2](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#2)]  
  
### <a name="specifying-known-types"></a><span data-ttu-id="48735-126">Especificando tipos conhecidos</span><span class="sxs-lookup"><span data-stu-id="48735-126">Specifying Known Types</span></span>  
 <span data-ttu-id="48735-127">Se o polimorfismo estiver envolvido nos tipos que estão sendo serializados que já não estejam sendo tratados usando o atributo <xref:System.Runtime.Serialization.KnownTypeAttribute> ou algum outro mecanismo, uma lista de tipos conhecidos possíveis deve ser passada para o construtor do serializador usando o parâmetro `knownTypes`.</span><span class="sxs-lookup"><span data-stu-id="48735-127">If polymorphism is involved in the types being serialized that is not already handled using the <xref:System.Runtime.Serialization.KnownTypeAttribute> attribute or some other mechanism, a list of possible known types must be passed to the serializer’s constructor using the `knownTypes` parameter.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="48735-128">tipos conhecidos, consulte [tipos conhecidos de contrato de dados](../../../../docs/framework/wcf/feature-details/data-contract-known-types.md).</span><span class="sxs-lookup"><span data-stu-id="48735-128"> known types, see [Data Contract Known Types](../../../../docs/framework/wcf/feature-details/data-contract-known-types.md).</span></span>  
  
 <span data-ttu-id="48735-129">O exemplo a seguir mostra uma classe, `LibraryPatron`, que inclui uma coleção de um tipo específico, o `LibraryItem`.</span><span class="sxs-lookup"><span data-stu-id="48735-129">The following example shows a class, `LibraryPatron`, that includes a collection of a specific type, the `LibraryItem`.</span></span> <span data-ttu-id="48735-130">A segunda classe define o tipo `LibraryItem`.</span><span class="sxs-lookup"><span data-stu-id="48735-130">The second class defines the `LibraryItem` type.</span></span> <span data-ttu-id="48735-131">A terceira e a quarta classe (`Book` e `Newspaper`) herdam da classe `LibraryItem`.</span><span class="sxs-lookup"><span data-stu-id="48735-131">The third and four classes (`Book` and `Newspaper`) inherit from the `LibraryItem` class.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#3)]  
 [!code-vb[c_StandaloneDataContractSerializer#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#3)]  
  
 <span data-ttu-id="48735-132">O código a seguir constrói uma instância do serializador usando o parâmetro `knownTypes`.</span><span class="sxs-lookup"><span data-stu-id="48735-132">The following code constructs an instance of the serializer using the `knownTypes` parameter.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#4)]
 [!code-vb[c_StandaloneDataContractSerializer#4](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#4)]  
  
### <a name="specifying-the-default-root-name-and-namespace"></a><span data-ttu-id="48735-133">Especificando o nome e o namespace de raiz padrão</span><span class="sxs-lookup"><span data-stu-id="48735-133">Specifying the Default Root Name and Namespace</span></span>  
 <span data-ttu-id="48735-134">Normalmente, quando um objeto é serializado, o nome padrão e o namespace do elemento XML mais externo são determinados de acordo com o nome e o namespace do contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="48735-134">Normally, when an object is serialized, the default name and namespace of the outermost XML element are determined according to the data contract name and namespace.</span></span> <span data-ttu-id="48735-135">Os nomes de todos os elementos internos são determinados dos nomes de membro de dados, e seu namespace é o namespace do contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="48735-135">The names of all inner elements are determined from data member names, and their namespace is the data contract’s namespace.</span></span> <span data-ttu-id="48735-136">O exemplo a seguir define os valores `Name` e `Namespace` nos construtores das classes <xref:System.Runtime.Serialization.DataContractAttribute> e <xref:System.Runtime.Serialization.DataMemberAttribute>.</span><span class="sxs-lookup"><span data-stu-id="48735-136">The following example sets `Name` and `Namespace` values in the constructors of the <xref:System.Runtime.Serialization.DataContractAttribute> and <xref:System.Runtime.Serialization.DataMemberAttribute> classes.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#5)]
 [!code-vb[c_StandaloneDataContractSerializer#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#5)]  
  
 <span data-ttu-id="48735-137">Serializar uma instância da classe `Person` gera XML semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="48735-137">Serializing an instance of the `Person` class produces XML similar to the following.</span></span>  
  
```xml  
<PersonContract xmlns="http://schemas.contoso.com">  
  <AddressMember>  
    <StreetMember>123 Main Street</StreetMember>  
   </AddressMember>  
</PersonContract>  
```  
  
 <span data-ttu-id="48735-138">Entretanto, você pode personalizar o nome e o namespace padrão do elemento raiz passando os valores dos parâmetros `rootName` e `rootNamespace` para o construtor <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-138">However, you can customize the default name and namespace of the root element by passing the values of the `rootName` and `rootNamespace` parameters to the <xref:System.Runtime.Serialization.DataContractSerializer> constructor.</span></span> <span data-ttu-id="48735-139">Observe que o `rootNamespace` não afeta o namespace dos elementos contidos que correspondem aos membros de dados.</span><span class="sxs-lookup"><span data-stu-id="48735-139">Note that the `rootNamespace` does not affect the namespace of the contained elements that correspond to data members.</span></span> <span data-ttu-id="48735-140">Ele afeta somente o namespace do elemento mais externo.</span><span class="sxs-lookup"><span data-stu-id="48735-140">It affects only the namespace of the outermost element.</span></span>  
  
 <span data-ttu-id="48735-141">Esses valores podem ser passados como cadeias de caracteres ou instâncias da classe <xref:System.Xml.XmlDictionaryString> para permitir a otimização usando o formato XML binário.</span><span class="sxs-lookup"><span data-stu-id="48735-141">These values can be passed as strings or instances of the <xref:System.Xml.XmlDictionaryString> class to allow for their optimization using the binary XML format.</span></span>  
  
### <a name="setting-the-maximum-objects-quota"></a><span data-ttu-id="48735-142">Definindo a cota máxima de objetos</span><span class="sxs-lookup"><span data-stu-id="48735-142">Setting the Maximum Objects Quota</span></span>  
 <span data-ttu-id="48735-143">Algumas sobrecargas do construtor `DataContractSerializer` têm um parâmetro `maxItemsInObjectGraph`.</span><span class="sxs-lookup"><span data-stu-id="48735-143">Some `DataContractSerializer` constructor overloads have a `maxItemsInObjectGraph` parameter.</span></span> <span data-ttu-id="48735-144">Este parâmetro determina o número máximo de objetos que o serializador serializa ou desserializa em uma única chamada de método <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-144">This parameter determines the maximum number of objects the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="48735-145">(O método sempre lê um objeto raiz, mas esse objeto pode ter outros objetos em seus membros de dados.</span><span class="sxs-lookup"><span data-stu-id="48735-145">(The method always reads one root object, but this object may have other objects in its data members.</span></span> <span data-ttu-id="48735-146">Esses objetos podem ter outros objetos e assim por diante). O padrão é 65536.</span><span class="sxs-lookup"><span data-stu-id="48735-146">Those objects may have other objects, and so on.) The default is 65536.</span></span> <span data-ttu-id="48735-147">Observe que, ao serializar ou desserializar matrizes, cada entrada de matriz conta como um objeto separado.</span><span class="sxs-lookup"><span data-stu-id="48735-147">Note that when serializing or deserializing arrays, every array entry counts as a separate object.</span></span> <span data-ttu-id="48735-148">Além disso, observe que alguns objetos podem ter uma grande representação de memória e, portanto, essa cota apenas pode não ser suficiente para evitar um ataque de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="48735-148">Also, note that some objects may have a large memory representation, and so this quota alone may not be sufficient to prevent a denial of service attack.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="48735-149">[Considerações de segurança para dados](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="48735-149"> [Security Considerations for Data](../../../../docs/framework/wcf/feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="48735-150">Se você precisa aumentar esta cota além do valor padrão, é importante fazer isso no lado do envio (serialização) e do recebimento (desserialização) porque isso se aplica tanto para ler e gravar dados.</span><span class="sxs-lookup"><span data-stu-id="48735-150">If you need to increase this quota beyond the default value, it is important to do so both on the sending (serializing) and receiving (deserializing) sides because it applies to both when reading and writing data.</span></span>  
  
### <a name="round-trips"></a><span data-ttu-id="48735-151">Viagens de ida e volta</span><span class="sxs-lookup"><span data-stu-id="48735-151">Round Trips</span></span>  
 <span data-ttu-id="48735-152">Um *ida e volta* ocorre quando um objeto é desserializado e serializado novamente em uma única operação.</span><span class="sxs-lookup"><span data-stu-id="48735-152">A *round trip* occurs when an object is deserialized and re-serialized in one operation.</span></span> <span data-ttu-id="48735-153">Portanto, ele vai de XML para uma instância de objeto e volta novamente para um fluxo XML.</span><span class="sxs-lookup"><span data-stu-id="48735-153">Thus, it goes from XML to an object instance, and back again into an XML stream.</span></span>  
  
 <span data-ttu-id="48735-154">Alguns `DataContractSerializer` sobrecargas do construtor tem um `ignoreExtensionDataObject` parâmetro, que é definido como `false` por padrão.</span><span class="sxs-lookup"><span data-stu-id="48735-154">Some `DataContractSerializer` constructor overloads have an `ignoreExtensionDataObject` parameter, which is set to `false` by default.</span></span> <span data-ttu-id="48735-155">Nesse modo padrão, os dados podem ser enviados em uma viagem de ida e volta de uma versão mais recente de um contrato de dados através de uma versão anterior, e de volta para a versão mais recente sem perda, contanto que o contrato de dados implemente a interface <xref:System.Runtime.Serialization.IExtensibleDataObject>.</span><span class="sxs-lookup"><span data-stu-id="48735-155">In this default mode, data can be sent on a round trip from a newer version of a data contract through an older version and back to the newer version without loss, as long as the data contract implements the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span> <span data-ttu-id="48735-156">Por exemplo, suponha que a versão 1 do contrato de dados de `Person` contenha os membros de dados `Name` e `PhoneNumber`, e a versão 2 adicione um membro `Nickname`.</span><span class="sxs-lookup"><span data-stu-id="48735-156">For example, suppose version 1 of the `Person` data contract contains the `Name` and `PhoneNumber` data members, and version 2 adds a `Nickname` member.</span></span> <span data-ttu-id="48735-157">Se `IExtensibleDataObject` estiver implementado, ao enviar informações da versão 2 para a versão 1, os dados de `Nickname` estarão armazenados e, em seguida, emitidos novamente quando os dados forem serializados novamente; portanto, nenhum dado é perdido na viagem.</span><span class="sxs-lookup"><span data-stu-id="48735-157">If `IExtensibleDataObject` is implemented, when sending information from version 2 to version 1, the `Nickname` data is stored, and then re-emitted when the data is serialized again; therefore, no data is lost in the round trip.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="48735-158">[Contratos de dados compatíveis por encaminhamento](../../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md) e [controle de versão de contrato de dados](../../../../docs/framework/wcf/feature-details/data-contract-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="48735-158"> [Forward-Compatible Data Contracts](../../../../docs/framework/wcf/feature-details/forward-compatible-data-contracts.md) and [Data Contract Versioning](../../../../docs/framework/wcf/feature-details/data-contract-versioning.md).</span></span>  
  
#### <a name="security-and-schema-validity-concerns-with-round-trips"></a><span data-ttu-id="48735-159">Preocupações de segurança e validade do esquema com viagens de ida e volta</span><span class="sxs-lookup"><span data-stu-id="48735-159">Security and Schema Validity Concerns with Round Trips</span></span>  
 <span data-ttu-id="48735-160">As viagens de ida e volta podem ter implicações de segurança.</span><span class="sxs-lookup"><span data-stu-id="48735-160">Round trips may have security implications.</span></span> <span data-ttu-id="48735-161">Por exemplo, desserializar e armazenar grandes quantidades de dados desconhecidos podem ser um risco de segurança.</span><span class="sxs-lookup"><span data-stu-id="48735-161">For example, deserializing and storing large amounts of extraneous data may be a security risk.</span></span> <span data-ttu-id="48735-162">Pode haver problemas de segurança sobre emitir novamente esses dados que não haja nenhuma maneira para verificar, especialmente se assinaturas digitais estiverem envolvidas.</span><span class="sxs-lookup"><span data-stu-id="48735-162">There may be security concerns about re-emitting this data that there is no way to verify, especially if digital signatures are involved.</span></span> <span data-ttu-id="48735-163">Por exemplo, no cenário anterior, o ponto de extremidade da versão 1 pode ser assinar um valor de `Nickname` que contém dados mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="48735-163">For example, in the previous scenario, the version 1 endpoint could be signing a `Nickname` value that contains malicious data.</span></span> <span data-ttu-id="48735-164">Finalmente, pode haver preocupações de validade de esquema: um ponto de extremidade pode querer sempre emitir os dados que sigam restritamente o contrato indicado e não nenhum valor extra.</span><span class="sxs-lookup"><span data-stu-id="48735-164">Finally, there may be schema validity concerns: an endpoint may want to always emit data that strictly adheres to its stated contract and not any extra values.</span></span> <span data-ttu-id="48735-165">No exemplo anterior, o contrato do ponto de extremidade da versão 1 diz que emite somente `Name` e `PhoneNumber`, e se a validação do esquema estiver sendo usada, emitir o valor extra de `Nickname` causa falha na validação.</span><span class="sxs-lookup"><span data-stu-id="48735-165">In the previous example, the version 1 endpoint’s contract says that it emits only `Name` and `PhoneNumber`, and if schema validation is being used, emitting the extra `Nickname` value causes validation to fail.</span></span>  
  
#### <a name="enabling-and-disabling-round-trips"></a><span data-ttu-id="48735-166">Ativar e desativar viagens de ida e volta</span><span class="sxs-lookup"><span data-stu-id="48735-166">Enabling and Disabling Round Trips</span></span>  
 <span data-ttu-id="48735-167">Para desativar viagens de ida e volta, não implemente a interface <xref:System.Runtime.Serialization.IExtensibleDataObject>.</span><span class="sxs-lookup"><span data-stu-id="48735-167">To turn off round trips, do not implement the <xref:System.Runtime.Serialization.IExtensibleDataObject> interface.</span></span> <span data-ttu-id="48735-168">Se você não tiver controle sobre os tipos, defina o parâmetro `ignoreExtensionDataObject` como `true` para alcançar o mesmo efeito.</span><span class="sxs-lookup"><span data-stu-id="48735-168">If you have no control over the types, set the `ignoreExtensionDataObject` parameter to `true` to achieve the same effect.</span></span>  
  
### <a name="object-graph-preservation"></a><span data-ttu-id="48735-169">Preservação do gráfico do objeto</span><span class="sxs-lookup"><span data-stu-id="48735-169">Object Graph Preservation</span></span>  
 <span data-ttu-id="48735-170">Normalmente, o serializador não se importa com a identidade do objeto, como no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="48735-170">Normally, the serializer does not care about object identity, as in the following code.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#6)]
 [!code-vb[c_StandaloneDataContractSerializer#6](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#6)]  
  
 <span data-ttu-id="48735-171">O código a seguir cria uma ordem de compra.</span><span class="sxs-lookup"><span data-stu-id="48735-171">The following code creates a purchase order.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#7)]
 [!code-vb[c_StandaloneDataContractSerializer#7](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#7)]  
  
 <span data-ttu-id="48735-172">Observe que os campos `billTo` e `shipTo` são definidos para a mesma instância de objeto.</span><span class="sxs-lookup"><span data-stu-id="48735-172">Notice that `billTo` and `shipTo` fields are set to the same object instance.</span></span> <span data-ttu-id="48735-173">No entanto, o XML gerado duplica as informações duplicadas e é semelhante ao XML a seguir.</span><span class="sxs-lookup"><span data-stu-id="48735-173">However, the generated XML duplicates the information duplicated, and looks similar to the following XML.</span></span>  
  
```xml  
<PurchaseOrder>  
  <billTo><street>123 Main St.</street></billTo>  
  <shipTo><street>123 Main St.</street></shipTo>  
</PurchaseOrder>  
```  
  
 <span data-ttu-id="48735-174">No entanto, essa abordagem tem as seguintes características, que podem ser indesejáveis:</span><span class="sxs-lookup"><span data-stu-id="48735-174">However, this approach has the following characteristics, which may be undesirable:</span></span>  
  
-   <span data-ttu-id="48735-175">Desempenho.</span><span class="sxs-lookup"><span data-stu-id="48735-175">Performance.</span></span> <span data-ttu-id="48735-176">Replicar dados é ineficiente.</span><span class="sxs-lookup"><span data-stu-id="48735-176">Replicating data is inefficient.</span></span>  
  
-   <span data-ttu-id="48735-177">Referências circulares.</span><span class="sxs-lookup"><span data-stu-id="48735-177">Circular references.</span></span> <span data-ttu-id="48735-178">Se os objetos se referirem a si mesmos, mesmo por meio de outros objetos, serializar por replicação resultará em um loop infinito.</span><span class="sxs-lookup"><span data-stu-id="48735-178">If objects refer to themselves, even through other objects, serializing by replication results in an infinite loop.</span></span> <span data-ttu-id="48735-179">(O serializador gera um <xref:System.Runtime.Serialization.SerializationException> se isso acontece.)</span><span class="sxs-lookup"><span data-stu-id="48735-179">(The serializer throws a <xref:System.Runtime.Serialization.SerializationException> if this happens.)</span></span>  
  
-   <span data-ttu-id="48735-180">Semântica.</span><span class="sxs-lookup"><span data-stu-id="48735-180">Semantics.</span></span> <span data-ttu-id="48735-181">Muitas vezes, é importante preservar o fato de que duas referências são para o mesmo objeto, e não para dois objetos idênticos.</span><span class="sxs-lookup"><span data-stu-id="48735-181">Sometimes it is important to preserve the fact that two references are to the same object, and not to two identical objects.</span></span>  
  
 <span data-ttu-id="48735-182">Por esses motivos, algumas sobrecargas de construtor do `DataContractSerializer` têm um parâmetro `preserveObjectReferences` (o padrão é `false`).</span><span class="sxs-lookup"><span data-stu-id="48735-182">For these reasons, some `DataContractSerializer` constructor overloads have a `preserveObjectReferences` parameter (the default is `false`).</span></span> <span data-ttu-id="48735-183">Quando esse parâmetro estiver definido como `true`, um método especial de referências de objeto de codificação, que somente o [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] entende, é usado.</span><span class="sxs-lookup"><span data-stu-id="48735-183">When this parameter is set to `true`, a special method of encoding object references, which only [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] understands, is used.</span></span> <span data-ttu-id="48735-184">Quando estiver definido como `true`, o exemplo de código XML agora se parecerá com o seguinte.</span><span class="sxs-lookup"><span data-stu-id="48735-184">When set to `true`, the XML code example now resembles the following.</span></span>  
  
```xml  
<PurchaseOrder ser:id="1">  
  <billTo ser:id="2"><street ser:id="3">123 Main St.</street></billTo>  
  <shipTo ser:ref="2"/>  
</PurchaseOrder>  
```  
  
 <span data-ttu-id="48735-185">O namespace "ser" refere-se ao namespace padrão de serialização, http://schemas.microsoft.com/2003/10/Serialization/.</span><span class="sxs-lookup"><span data-stu-id="48735-185">The "ser" namespace refers to the standard serialization namespace, http://schemas.microsoft.com/2003/10/Serialization/.</span></span> <span data-ttu-id="48735-186">Cada dado é serializada apenas uma vez e recebe um número de identificação, e os usos subsequentes resultam em uma referência a dados já serializados.</span><span class="sxs-lookup"><span data-stu-id="48735-186">Each piece of data is serialized only once and given an ID number, and subsequent uses result in a reference to the already serialized data.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="48735-187">Se os atributos “id” e “ref” estiverem presentes no `XMLElement` do contrato de dados, o atributo “ref” será aceito e o atributo “ID”, ignorado.</span><span class="sxs-lookup"><span data-stu-id="48735-187">If both "id" and "ref" attributes are present in the data contract `XMLElement`, then the "ref" attribute is honored and the "id" attribute is ignored.</span></span>  
  
 <span data-ttu-id="48735-188">É importante entender as limitações desse modo:</span><span class="sxs-lookup"><span data-stu-id="48735-188">It is important to understand the limitations of this mode:</span></span>  
  
-   <span data-ttu-id="48735-189">O XML de `DataContractSerializer` produz com `preserveObjectReferences` definida como `true` não é interoperável com quaisquer outras tecnologias e podem ser acessados somente por outro `DataContractSerializer` instância, também com `preserveObjectReferences` definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="48735-189">The XML the `DataContractSerializer` produces with `preserveObjectReferences` set to `true` is not interoperable with any other technologies, and can be accessed only by another `DataContractSerializer` instance, also with `preserveObjectReferences` set to `true`.</span></span>  
  
-   <span data-ttu-id="48735-190">Não há suporte de metadados (esquema) para esse recurso.</span><span class="sxs-lookup"><span data-stu-id="48735-190">There is no metadata (schema) support for this feature.</span></span> <span data-ttu-id="48735-191">O esquema que é gerado é válido somente para o caso em que `preserveObjectReferences` está definido como `false`.</span><span class="sxs-lookup"><span data-stu-id="48735-191">The schema that is produced is valid only for the case when `preserveObjectReferences` is set to `false`.</span></span>  
  
-   <span data-ttu-id="48735-192">Esse recurso pode fazer o processo de serialização e desserialização ser executado mais lentamente.</span><span class="sxs-lookup"><span data-stu-id="48735-192">This feature may cause the serialization and deserialization process to run slower.</span></span> <span data-ttu-id="48735-193">Embora os dados não precisem ser replicados, as comparações adicionais de objeto devem ser executadas nesse modo.</span><span class="sxs-lookup"><span data-stu-id="48735-193">Although data does not have to be replicated, extra object comparisons must be performed in this mode.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="48735-194">Quando o modo `preserveObjectReferences` está ativado, ele é especialmente importante para definir o valor de `maxItemsInObjectGraph` para a cota correta.</span><span class="sxs-lookup"><span data-stu-id="48735-194">When the `preserveObjectReferences` mode is enabled, it is especially important to set the `maxItemsInObjectGraph` value to the correct quota.</span></span> <span data-ttu-id="48735-195">Devido à maneira como as matrizes são tratadas nesse modo, é fácil para que um invasor construir uma pequena mensagem mal-intencionada que resulta em um grande consumo de memória limitada somente pela cota de `maxItemsInObjectGraph`.</span><span class="sxs-lookup"><span data-stu-id="48735-195">Due to the way arrays are handled in this mode, it is easy for an attacker to construct a small malicious message that results in large memory consumption limited only by the `maxItemsInObjectGraph` quota.</span></span>  
  
### <a name="specifying-a-data-contract-surrogate"></a><span data-ttu-id="48735-196">Especificando um substituto para os contratos de dados</span><span class="sxs-lookup"><span data-stu-id="48735-196">Specifying a Data Contract Surrogate</span></span>  
 <span data-ttu-id="48735-197">Algumas sobrecargas de construtor do `DataContractSerializer` têm um parâmetro `dataContractSurrogate`, que pode ser definido como `null` por padrão.</span><span class="sxs-lookup"><span data-stu-id="48735-197">Some `DataContractSerializer` constructor overloads have a `dataContractSurrogate` parameter, which may be set to `null`.</span></span> <span data-ttu-id="48735-198">Caso contrário, você pode usar para especificar um *substitutos de contrato de dados*, que é um tipo que implementa o <xref:System.Runtime.Serialization.IDataContractSurrogate> interface.</span><span class="sxs-lookup"><span data-stu-id="48735-198">Otherwise, you can use it to specify a *data contract surrogate*, which is a type that implements the <xref:System.Runtime.Serialization.IDataContractSurrogate> interface.</span></span> <span data-ttu-id="48735-199">Você pode, em seguida, usar a interface para personalizar o processo de serialização e desserialização.</span><span class="sxs-lookup"><span data-stu-id="48735-199">You can then use the interface to customize the serialization and deserialization process.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="48735-200">[Substitutos de contrato de dados](../../../../docs/framework/wcf/extending/data-contract-surrogates.md).</span><span class="sxs-lookup"><span data-stu-id="48735-200"> [Data Contract Surrogates](../../../../docs/framework/wcf/extending/data-contract-surrogates.md).</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="48735-201">Serialização</span><span class="sxs-lookup"><span data-stu-id="48735-201">Serialization</span></span>  
 <span data-ttu-id="48735-202">As informações a seguir aplicam-se a qualquer classe que herda de <xref:System.Runtime.Serialization.XmlObjectSerializer>, incluindo as classes <xref:System.Runtime.Serialization.DataContractSerializer> e <xref:System.Runtime.Serialization.NetDataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-202">The following information applies to any class that inherits from the <xref:System.Runtime.Serialization.XmlObjectSerializer>, including the <xref:System.Runtime.Serialization.DataContractSerializer> and <xref:System.Runtime.Serialization.NetDataContractSerializer> classes.</span></span>  
  
### <a name="simple-serialization"></a><span data-ttu-id="48735-203">Serialização simples</span><span class="sxs-lookup"><span data-stu-id="48735-203">Simple Serialization</span></span>  
 <span data-ttu-id="48735-204">A maneira mais básica para serializar um objeto é passá-lo para o método <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-204">The most basic way to serialize an object is to pass it to the <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A> method.</span></span> <span data-ttu-id="48735-205">Há três sobrecargas, cada uma para escrever em um <xref:System.IO.Stream>, <xref:System.Xml.XmlWriter> ou <xref:System.Xml.XmlDictionaryWriter>.</span><span class="sxs-lookup"><span data-stu-id="48735-205">There are three overloads, one each for writing to a <xref:System.IO.Stream>, an <xref:System.Xml.XmlWriter>, or an <xref:System.Xml.XmlDictionaryWriter>.</span></span> <span data-ttu-id="48735-206">Com a sobrecarga <xref:System.IO.Stream>, a saída é XML na codificação UTF-8.</span><span class="sxs-lookup"><span data-stu-id="48735-206">With the <xref:System.IO.Stream> overload, the output is XML in the UTF-8 encoding.</span></span> <span data-ttu-id="48735-207">Com a sobrecarga <xref:System.Xml.XmlDictionaryWriter>, o serializador otimiza a saída para XML binário.</span><span class="sxs-lookup"><span data-stu-id="48735-207">With the <xref:System.Xml.XmlDictionaryWriter> overload, the serializer optimizes its output for binary XML.</span></span>  
  
 <span data-ttu-id="48735-208">Ao usar o <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A> método, o serializador usa o nome padrão e o namespace do elemento wrapper e gravará junto com o conteúdo (consulte a seção "Especificando o padrão raiz nome e Namespace" anterior).</span><span class="sxs-lookup"><span data-stu-id="48735-208">When using the <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A> method, the serializer uses the default name and namespace for the wrapper element and writes it out along with the contents (see the previous "Specifying the Default Root Name and Namespace" section).</span></span>  
  
 <span data-ttu-id="48735-209">O exemplo a seguir demonstra a escrita com um <xref:System.Xml.XmlDictionaryWriter>.</span><span class="sxs-lookup"><span data-stu-id="48735-209">The following example demonstrates writing with an <xref:System.Xml.XmlDictionaryWriter>.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#8)]
 [!code-vb[c_StandaloneDataContractSerializer#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#8)]  
  
 <span data-ttu-id="48735-210">Isso gera um XML semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="48735-210">This produces XML similar to the following.</span></span>  
  
```xml  
<Person>  
  <Name>Jay Hamlin</Name>  
  <Address>123 Main St.</Address>  
</Person>  
```  
  
### <a name="step-by-step-serialization"></a><span data-ttu-id="48735-211">Serialização passo a passo</span><span class="sxs-lookup"><span data-stu-id="48735-211">Step-By-Step Serialization</span></span>  
 <span data-ttu-id="48735-212">Use os métodos <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteStartObject%2A>, <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObjectContent%2A> e <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteEndObject%2A> para gravar o elemento final, escrever o conteúdo do objeto e fechar o elemento wrapper, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="48735-212">Use the <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteStartObject%2A>, <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObjectContent%2A>, and <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteEndObject%2A> methods to write the end element, write the object contents, and close the wrapper element, respectively.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="48735-213">Não há nenhuma sobrecarga de <xref:System.IO.Stream> desses métodos.</span><span class="sxs-lookup"><span data-stu-id="48735-213">There are no <xref:System.IO.Stream> overloads of these methods.</span></span>  
  
 <span data-ttu-id="48735-214">Essa serialização passo a passo tem dois usos comuns.</span><span class="sxs-lookup"><span data-stu-id="48735-214">This step-by-step serialization has two common uses.</span></span> <span data-ttu-id="48735-215">Um é inserir conteúdo como atributos ou comentários entre `WriteStartObject` e `WriteObjectContent`, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="48735-215">One is to insert contents such as attributes or comments between `WriteStartObject` and `WriteObjectContent`,  as shown in the following example.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#9)]
 [!code-vb[c_StandaloneDataContractSerializer#9](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#9)]  
  
 <span data-ttu-id="48735-216">Isso gera um XML semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="48735-216">This produces XML similar to the following.</span></span>  
  
```xml  
<Person serializedBy="myCode">  
  <Name>Jay Hamlin</Name>  
  <Address>123 Main St.</Address>  
</Person>  
```  
  
 <span data-ttu-id="48735-217">Outro uso comum é evitar usar <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteStartObject%2A> e <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteEndObject%2A> totalmente, e escrever seu próprio elemento wrapper personalizado (ou até mesmo não escrever um wrapper), conforme mostrado no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="48735-217">Another common use is to avoid using <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteStartObject%2A> and <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteEndObject%2A> entirely, and to write your own custom wrapper element (or even skip writing a wrapper altogether), as shown in the following code.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#10)]
 [!code-vb[c_StandaloneDataContractSerializer#10](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#10)]  
  
 <span data-ttu-id="48735-218">Isso gera um XML semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="48735-218">This produces XML similar to the following.</span></span>  
  
```xml  
<MyCustomWrapper>  
  <Name>Jay Hamlin</Name>  
  <Address>123 Main St.</Address>  
</MyCustomWrapper>  
```  
  
> [!NOTE]
>  <span data-ttu-id="48735-219">Usar a serialização passo a passo pode resultar em XML de esquema inválido.</span><span class="sxs-lookup"><span data-stu-id="48735-219">Using step-by-step serialization may result in schema-invalid XML.</span></span>  
  
## <a name="deserialization"></a><span data-ttu-id="48735-220">Desserialização</span><span class="sxs-lookup"><span data-stu-id="48735-220">Deserialization</span></span>  
 <span data-ttu-id="48735-221">As informações a seguir aplicam-se a qualquer classe que herda de <xref:System.Runtime.Serialization.XmlObjectSerializer>, incluindo as classes <xref:System.Runtime.Serialization.DataContractSerializer> e <xref:System.Runtime.Serialization.NetDataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="48735-221">The following information applies to any class that inherits from the <xref:System.Runtime.Serialization.XmlObjectSerializer>, including the <xref:System.Runtime.Serialization.DataContractSerializer> and <xref:System.Runtime.Serialization.NetDataContractSerializer> classes.</span></span>  
  
 <span data-ttu-id="48735-222">A maneira mais básica de desserializar um objeto é chamar uma das sobrecargas de método <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-222">The most basic way to deserialize an object is to call one of the <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A> method overloads.</span></span> <span data-ttu-id="48735-223">Há três sobrecargas, cada uma para ler comum <xref:System.Xml.XmlDictionaryReader>, `XmlReader` ou `Stream`.</span><span class="sxs-lookup"><span data-stu-id="48735-223">There are three overloads, one each for reading with a <xref:System.Xml.XmlDictionaryReader>, an `XmlReader`, or a `Stream`.</span></span> <span data-ttu-id="48735-224">Observe que a sobrecarga de `Stream` cria um <xref:System.Xml.XmlDictionaryReader> textual que não é protegido por nenhuma cota, e deve ser usada somente para ler dados confiáveis.</span><span class="sxs-lookup"><span data-stu-id="48735-224">Note that the `Stream` overload creates a textual <xref:System.Xml.XmlDictionaryReader> that is not protected by any quotas, and should be used only to read trusted data.</span></span>  
  
 <span data-ttu-id="48735-225">Observe também que o objeto que o método `ReadObject` retorna deve ser convertido para o tipo apropriado.</span><span class="sxs-lookup"><span data-stu-id="48735-225">Also note that the object the `ReadObject` method returns must be cast to the appropriate type.</span></span>  
  
 <span data-ttu-id="48735-226">O código a seguir constrói uma instância <xref:System.Runtime.Serialization.DataContractSerializer> e um <xref:System.Xml.XmlDictionaryReader> e, em seguida, desserializa uma instância `Person`.</span><span class="sxs-lookup"><span data-stu-id="48735-226">The following code constructs an instance of the <xref:System.Runtime.Serialization.DataContractSerializer> and an <xref:System.Xml.XmlDictionaryReader>, then deserializes a `Person` instance.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#11](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#11)]
 [!code-vb[c_StandaloneDataContractSerializer#11](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#11)]  
  
 <span data-ttu-id="48735-227">Antes de chamar o método <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A>, posicione a leitora XML no elemento wrapper ou em um nó de não conteúdo que precede o elemento wrapper.</span><span class="sxs-lookup"><span data-stu-id="48735-227">Before calling the <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A> method, position the XML reader on the wrapper element or on a non-content node that precedes the wrapper element.</span></span> <span data-ttu-id="48735-228">Você pode fazer isso chamando o método <xref:System.Xml.XmlReader.Read%2A> de <xref:System.Xml.XmlReader> ou sua derivação e testando o <xref:System.Xml.XmlReader.NodeType%2A>, conforme mostrado no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="48735-228">You can do this by calling the <xref:System.Xml.XmlReader.Read%2A> method of the <xref:System.Xml.XmlReader> or its derivation, and testing the <xref:System.Xml.XmlReader.NodeType%2A>, as shown in the following code.</span></span>  
  
 [!code-csharp[c_StandaloneDataContractSerializer#12](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_standalonedatacontractserializer/cs/source.cs#12)]
 [!code-vb[c_StandaloneDataContractSerializer#12](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_standalonedatacontractserializer/vb/source.vb#12)]  
  
 <span data-ttu-id="48735-229">Observe que você pode ler atributos neste elemento wrapper antes de enviar o leitor para `ReadObject`.</span><span class="sxs-lookup"><span data-stu-id="48735-229">Note that you can read attributes on this wrapper element before handing the reader to `ReadObject`.</span></span>  
  
 <span data-ttu-id="48735-230">Ao usar uma simples `ReadObject` sobrecargas, o desserializador procura o nome padrão e o namespace no elemento wrapper (consulte a seção anterior, "Especificar o padrão raiz nome e Namespace") e gera uma exceção se ele encontrar desconhecido elemento.</span><span class="sxs-lookup"><span data-stu-id="48735-230">When using one of the simple `ReadObject` overloads, the deserializer looks for the default name and namespace on the wrapper element (see the preceding section, "Specifying the Default Root Name and Namespace") and throws an exception if it finds an unknown element.</span></span> <span data-ttu-id="48735-231">No exemplo anterior, o elemento wrapper `<Person>` é esperado.</span><span class="sxs-lookup"><span data-stu-id="48735-231">In the preceding example, the `<Person>` wrapper element is expected.</span></span> <span data-ttu-id="48735-232">O método <xref:System.Runtime.Serialization.XmlObjectSerializer.IsStartObject%2A> é chamado para verificar se o leitor está localizado em um elemento que seja nomeado como esperado.</span><span class="sxs-lookup"><span data-stu-id="48735-232">The <xref:System.Runtime.Serialization.XmlObjectSerializer.IsStartObject%2A> method is called to verify that the reader is positioned on an element that is named as expected.</span></span>  
  
 <span data-ttu-id="48735-233">Há uma maneira de desabilitar a verificação de nome desse elemento wrapper; algumas sobrecargas do método `ReadObject` têm o parâmetro booliano `verifyObjectName`, que é definido como `true` por padrão.</span><span class="sxs-lookup"><span data-stu-id="48735-233">There is a way to disable this wrapper element name check; some overloads of the `ReadObject` method take the Boolean parameter `verifyObjectName`, which is set to `true` by default.</span></span> <span data-ttu-id="48735-234">Quando definidas como `false`, o nome e o namespace do elemento wrapper são ignorados.</span><span class="sxs-lookup"><span data-stu-id="48735-234">When set to `false`, the name and namespace of the wrapper element is ignored.</span></span> <span data-ttu-id="48735-235">Isso é útil para ler o XML que foi escrito usando o mecanismo passo a passo de serialização descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="48735-235">This is useful for reading XML that was written using the step-by-step serialization mechanism described previously.</span></span>  
  
## <a name="using-the-netdatacontractserializer"></a><span data-ttu-id="48735-236">Usando o NetDataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="48735-236">Using the NetDataContractSerializer</span></span>  
 <span data-ttu-id="48735-237">A principal diferença entre o `DataContractSerializer` e o <xref:System.Runtime.Serialization.NetDataContractSerializer> é que o `DataContractSerializer` usa nomes de contrato de dados, enquanto que o `NetDataContractSerializer` gera nomes de assembly e de tipo completos do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] no XML serializável.</span><span class="sxs-lookup"><span data-stu-id="48735-237">The primary difference between the `DataContractSerializer` and the <xref:System.Runtime.Serialization.NetDataContractSerializer> is that the `DataContractSerializer` uses data contract names, whereas the `NetDataContractSerializer` outputs full [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assembly and type names in the serialized XML.</span></span> <span data-ttu-id="48735-238">Isso significa que exatamente os mesmos tipos devem ser compartilhados entre os pontos de extremidade de serialização e desserialização.</span><span class="sxs-lookup"><span data-stu-id="48735-238">This means that the exact same types must be shared between the serialization and deserialization endpoints.</span></span> <span data-ttu-id="48735-239">Isso significa que o mecanismo de tipos conhecidos não é necessário com o `NetDataContractSerializer` porque os tipos exatos a serem desserializados são sempre conhecidos.</span><span class="sxs-lookup"><span data-stu-id="48735-239">This means that the known types mechanism is not required with the `NetDataContractSerializer` because the exact types to be deserialized are always known.</span></span>  
  
 <span data-ttu-id="48735-240">No entanto, alguns problemas podem ocorrer:</span><span class="sxs-lookup"><span data-stu-id="48735-240">However, several problems can occur:</span></span>  
  
-   <span data-ttu-id="48735-241">Segurança.</span><span class="sxs-lookup"><span data-stu-id="48735-241">Security.</span></span> <span data-ttu-id="48735-242">Qualquer tipo encontrado no XML que está sendo desserializado é carregado.</span><span class="sxs-lookup"><span data-stu-id="48735-242">Any type found in the XML being deserialized is loaded.</span></span> <span data-ttu-id="48735-243">Isso pode ser explorado para forçar o carregamento de tipos mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="48735-243">This can be exploited to force the loading of malicious types.</span></span> <span data-ttu-id="48735-244">Usando o `NetDataContractSerializer` confiáveis com dados devem ser feitos apenas se um *associador de serialização* é usado (usando o <xref:System.Runtime.Serialization.NetDataContractSerializer.Binder%2A> parâmetro de propriedade ou construtor).</span><span class="sxs-lookup"><span data-stu-id="48735-244">Using the `NetDataContractSerializer` with untrusted data should be done only if a *Serialization Binder* is used (using the <xref:System.Runtime.Serialization.NetDataContractSerializer.Binder%2A> property or constructor parameter).</span></span> <span data-ttu-id="48735-245">O associador permite que apenas tipos seguros sejam carregados.</span><span class="sxs-lookup"><span data-stu-id="48735-245">The binder permits only safe types to be loaded.</span></span> <span data-ttu-id="48735-246">O mecanismo Associador é idêntico ao usado pelos tipos no <xref:System.Runtime.Serialization>.</span><span class="sxs-lookup"><span data-stu-id="48735-246">The Binder mechanism is identical to the one that types in the <xref:System.Runtime.Serialization> namespace use.</span></span>  
  
-   <span data-ttu-id="48735-247">Controle de versão.</span><span class="sxs-lookup"><span data-stu-id="48735-247">Versioning.</span></span> <span data-ttu-id="48735-248">Usar nomes completos de tipo e assembly no XML restringe significativamente o controle de versão de tipos.</span><span class="sxs-lookup"><span data-stu-id="48735-248">Using full type and assembly names in the XML severely restricts how types can be versioned.</span></span> <span data-ttu-id="48735-249">O exemplo a seguir não pode ser modificado: nomes de tipo, namespaces, nomes de assembly e versões de assembly.</span><span class="sxs-lookup"><span data-stu-id="48735-249">The following cannot be changed: type names, namespaces, assembly names, and assembly versions.</span></span> <span data-ttu-id="48735-250">Definir a propriedade <xref:System.Runtime.Serialization.NetDataContractSerializer.AssemblyFormat%2A> ou o parâmetro do construtor como <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle.Simple> em vez do valor padrão de <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle.Full> permite alterações de versão do assembly, mas não para tipos de parâmetros genéricos.</span><span class="sxs-lookup"><span data-stu-id="48735-250">Setting the <xref:System.Runtime.Serialization.NetDataContractSerializer.AssemblyFormat%2A> property or constructor parameter to <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle.Simple> instead of the default value of <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle.Full> allows for assembly version changes, but not for generic parameter types.</span></span>  
  
-   <span data-ttu-id="48735-251">Interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="48735-251">Interoperability.</span></span> <span data-ttu-id="48735-252">Como os nomes de tipo e assembly do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] estão incluídos no XML, as plataformas diferentes de [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] não podem acessar os dados resultantes.</span><span class="sxs-lookup"><span data-stu-id="48735-252">Because [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type and assembly names are included in the XML, platforms other than the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] cannot access the resulting data.</span></span>  
  
-   <span data-ttu-id="48735-253">Desempenho.</span><span class="sxs-lookup"><span data-stu-id="48735-253">Performance.</span></span> <span data-ttu-id="48735-254">Gravar os nomes de tipo e assembly aumenta significativamente o tamanho do XML resultante.</span><span class="sxs-lookup"><span data-stu-id="48735-254">Writing out the type and assembly names significantly increases the size of the resulting XML.</span></span>  
  
 <span data-ttu-id="48735-255">Esse mecanismo é semelhante à serialização binária ou SOAP usada por [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] remoto (especificamente, <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> e <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter>).</span><span class="sxs-lookup"><span data-stu-id="48735-255">This mechanism is similar to binary or SOAP serialization used by [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] remoting (specifically, the <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter> and the <xref:System.Runtime.Serialization.Formatters.Soap.SoapFormatter>).</span></span>  
  
 <span data-ttu-id="48735-256">Usar `NetDataContractSerializer` é semelhante a usar `DataContractSerializer`, com as seguintes diferenças:</span><span class="sxs-lookup"><span data-stu-id="48735-256">Using the `NetDataContractSerializer` is similar to using the `DataContractSerializer`, with the following differences:</span></span>  
  
-   <span data-ttu-id="48735-257">Os construtores não exigem que você especifique um tipo de raiz.</span><span class="sxs-lookup"><span data-stu-id="48735-257">The constructors do not require you to specify a root type.</span></span> <span data-ttu-id="48735-258">Você pode serializar qualquer tipo com a mesma instância do `NetDataContractSerializer`.</span><span class="sxs-lookup"><span data-stu-id="48735-258">You can serialize any type with the same instance of the `NetDataContractSerializer`.</span></span>  
  
-   <span data-ttu-id="48735-259">Os construtores não aceitam uma lista de tipos conhecidos.</span><span class="sxs-lookup"><span data-stu-id="48735-259">The constructors do not accept a list of known types.</span></span> <span data-ttu-id="48735-260">O mecanismo de tipos conhecidos será desnecessário se os nomes de tipo forem serializados no XML.</span><span class="sxs-lookup"><span data-stu-id="48735-260">The known types mechanism is unnecessary if type names are serialized into the XML.</span></span>  
  
-   <span data-ttu-id="48735-261">Os construtores não aceitam um substituto do contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="48735-261">The constructors do not accept a data contract surrogate.</span></span> <span data-ttu-id="48735-262">Em vez disso, aceitam um parâmetro <xref:System.Runtime.Serialization.ISurrogateSelector> chamado `surrogateSelector` (que mapeia para a propriedade <xref:System.Runtime.Serialization.NetDataContractSerializer.SurrogateSelector%2A>).</span><span class="sxs-lookup"><span data-stu-id="48735-262">Instead, they accept an <xref:System.Runtime.Serialization.ISurrogateSelector> parameter called `surrogateSelector` (which maps to the <xref:System.Runtime.Serialization.NetDataContractSerializer.SurrogateSelector%2A> property).</span></span> <span data-ttu-id="48735-263">Este é um mecanismo substituto herdado.</span><span class="sxs-lookup"><span data-stu-id="48735-263">This is a legacy surrogate mechanism.</span></span>  
  
-   <span data-ttu-id="48735-264">Os construtores aceitam um parâmetro chamado `assemblyFormat` do <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle> que mapeia para a propriedade <xref:System.Runtime.Serialization.NetDataContractSerializer.AssemblyFormat%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-264">The constructors accept a parameter called `assemblyFormat` of the <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle> that maps to the <xref:System.Runtime.Serialization.NetDataContractSerializer.AssemblyFormat%2A> property.</span></span> <span data-ttu-id="48735-265">Conforme discutido anteriormente, isso pode ser usado para melhorar os recursos de controle de versão do serializador.</span><span class="sxs-lookup"><span data-stu-id="48735-265">As discussed previously, this can be used to enhance the versioning capabilities of the serializer.</span></span> <span data-ttu-id="48735-266">Isso é idêntico ao mecanismo <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle> na serialização binária ou SOAP.</span><span class="sxs-lookup"><span data-stu-id="48735-266">This is identical to the <xref:System.Runtime.Serialization.Formatters.FormatterAssemblyStyle> mechanism in binary or SOAP serialization.</span></span>  
  
-   <span data-ttu-id="48735-267">Os construtores aceitam um parâmetro <xref:System.Runtime.Serialization.StreamingContext> chamado `context` que mapeia para a propriedade <xref:System.Runtime.Serialization.NetDataContractSerializer.Context%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-267">The constructors accept a <xref:System.Runtime.Serialization.StreamingContext> parameter called `context` that maps to the <xref:System.Runtime.Serialization.NetDataContractSerializer.Context%2A> property.</span></span> <span data-ttu-id="48735-268">Você pode usar isso para passar informações para os tipos que estão sendo serializados.</span><span class="sxs-lookup"><span data-stu-id="48735-268">You can use this to pass information into types being serialized.</span></span> <span data-ttu-id="48735-269">Esse uso é idêntico ao do mecanismo <xref:System.Runtime.Serialization.StreamingContext> usado em outras classes <xref:System.Runtime.Serialization>.</span><span class="sxs-lookup"><span data-stu-id="48735-269">This usage is identical to that of the <xref:System.Runtime.Serialization.StreamingContext> mechanism used in other <xref:System.Runtime.Serialization> classes.</span></span>  
  
-   <span data-ttu-id="48735-270">Os métodos <xref:System.Runtime.Serialization.NetDataContractSerializer.Serialize%2A> e <xref:System.Runtime.Serialization.NetDataContractSerializer.Deserialize%2A> são aliases para os métodos <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A> e <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="48735-270">The <xref:System.Runtime.Serialization.NetDataContractSerializer.Serialize%2A> and <xref:System.Runtime.Serialization.NetDataContractSerializer.Deserialize%2A> methods are aliases for the <xref:System.Runtime.Serialization.XmlObjectSerializer.WriteObject%2A> and <xref:System.Runtime.Serialization.XmlObjectSerializer.ReadObject%2A> methods.</span></span> <span data-ttu-id="48735-271">Eles existem para fornecer um modelo de programação mais consistente com serialização binária ou SOAP.</span><span class="sxs-lookup"><span data-stu-id="48735-271">These exist to provide a more consistent programming model with binary or SOAP serialization.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="48735-272">Esses recursos, consulte [serialização binária](../../../../docs/standard/serialization/binary-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="48735-272"> these features, see [Binary Serialization](../../../../docs/standard/serialization/binary-serialization.md).</span></span>  
  
 <span data-ttu-id="48735-273">Os formatos XML que o `NetDataContractSerializer` e o `DataContractSerializer` usam não são normalmente compatíveis.</span><span class="sxs-lookup"><span data-stu-id="48735-273">The XML formats that the `NetDataContractSerializer` and the `DataContractSerializer` use are normally not compatible.</span></span> <span data-ttu-id="48735-274">Ou seja, tentar serializar com um desses serializadores e desserializar com o outro não é um cenário com suporte.</span><span class="sxs-lookup"><span data-stu-id="48735-274">That is, attempting to serialize with one of these serializers and deserialize with the other is not a supported scenario.</span></span>  
  
 <span data-ttu-id="48735-275">Além disso, observe que o `NetDataContractSerializer` não gera o nome completo do tipo e assembly do [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] para cada nó no grafo de objeto.</span><span class="sxs-lookup"><span data-stu-id="48735-275">Also, note that the `NetDataContractSerializer` does not output the full [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type and assembly name for each node in the object graph.</span></span> <span data-ttu-id="48735-276">Ele gera essas informações apenas quando são ambíguas.</span><span class="sxs-lookup"><span data-stu-id="48735-276">It outputs that information only where it is ambiguous.</span></span> <span data-ttu-id="48735-277">Isto é, ele gera no nível do objeto raiz e para qualquer caso polimórfico.</span><span class="sxs-lookup"><span data-stu-id="48735-277">That is, it outputs at the root object level and for any polymorphic cases.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="48735-278">Consulte também</span><span class="sxs-lookup"><span data-stu-id="48735-278">See Also</span></span>  
 <xref:System.Runtime.Serialization.DataContractSerializer>  
 <xref:System.Runtime.Serialization.NetDataContractSerializer>  
 <xref:System.Runtime.Serialization.XmlObjectSerializer>  
 [<span data-ttu-id="48735-279">Serialização binária</span><span class="sxs-lookup"><span data-stu-id="48735-279">Binary Serialization</span></span>](../../../../docs/standard/serialization/binary-serialization.md)  
 [<span data-ttu-id="48735-280">Tipos com suporte pelo serializador de contrato de dados</span><span class="sxs-lookup"><span data-stu-id="48735-280">Types Supported by the Data Contract Serializer</span></span>](../../../../docs/framework/wcf/feature-details/types-supported-by-the-data-contract-serializer.md)
