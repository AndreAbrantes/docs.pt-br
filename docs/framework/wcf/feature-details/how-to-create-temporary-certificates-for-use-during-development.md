---
title: Como criar certificados temporários para uso durante o desenvolvimento
ms.date: 03/30/2017
helpviewer_keywords:
- certificates [WCF], creating temporary certificates
- temporary certificates [WCF]
ms.assetid: bc5f6637-5513-4d27-99bb-51aad7741e4a
ms.openlocfilehash: d3b051c7ea152606721388ea35b6f508eada1c5d
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43524359"
---
# <a name="how-to-create-temporary-certificates-for-use-during-development"></a><span data-ttu-id="18b82-102">Como criar certificados temporários para uso durante o desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="18b82-102">How to: Create Temporary Certificates for Use During Development</span></span>
<span data-ttu-id="18b82-103">Ao desenvolver um serviço seguro ou o cliente usando o Windows Communication Foundation (WCF), muitas vezes é necessário fornecer um certificado X.509 a ser usado como uma credencial.</span><span class="sxs-lookup"><span data-stu-id="18b82-103">When developing a secure service or client using Windows Communication Foundation (WCF), it is often necessary to supply an X.509 certificate to be used as a credential.</span></span> <span data-ttu-id="18b82-104">O certificado normalmente faz parte de uma cadeia de certificados com uma autoridade raiz encontrado no repositório de autoridades de certificação raiz confiáveis do computador.</span><span class="sxs-lookup"><span data-stu-id="18b82-104">The certificate typically is part of a chain of certificates with a root authority found in the Trusted Root Certification Authorities store of the computer.</span></span> <span data-ttu-id="18b82-105">Ter uma cadeia de certificados permite que você definir o escopo de um conjunto de certificados onde normalmente na autoridade raiz é de sua organização ou a unidade de negócios.</span><span class="sxs-lookup"><span data-stu-id="18b82-105">Having a certificate chain enables you to scope a set of certificates where typically the root authority is from your organization or business unit.</span></span> <span data-ttu-id="18b82-106">Para emular isso em tempo de desenvolvimento, você pode criar dois certificados para satisfazer os requisitos de segurança.</span><span class="sxs-lookup"><span data-stu-id="18b82-106">To emulate this at development time, you can create two certificates to satisfy the security requirements.</span></span> <span data-ttu-id="18b82-107">A primeira é um certificado autoassinado que é colocado no repositório de autoridades de certificação raiz confiáveis, e o segundo certificado é criado a partir do primeiro e é colocado no repositório pessoal do Local do computador local ou o repositório pessoal das Local do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="18b82-107">The first is a self-signed certificate that is placed in the Trusted Root Certification Authorities store, and the second certificate is created from the first and is placed in either the Personal store of the Local Machine location, or the Personal store of the Current User location.</span></span> <span data-ttu-id="18b82-108">Este tópico explica as etapas para criar esses dois certificados usando o [ferramenta de criação de certificado (MakeCert.exe)](https://go.microsoft.com/fwlink/?LinkId=248185), que é fornecido pelo [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] SDK.</span><span class="sxs-lookup"><span data-stu-id="18b82-108">This topic walks through the steps to create these two certificates using the [Certificate Creation Tool (MakeCert.exe)](https://go.microsoft.com/fwlink/?LinkId=248185), which is provided by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] SDK.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="18b82-109">Os certificados que gera a ferramenta de criação de certificação são fornecidos somente para testes.</span><span class="sxs-lookup"><span data-stu-id="18b82-109">The certificates the Certification Creation tool generates are provided for testing purposes only.</span></span> <span data-ttu-id="18b82-110">Ao implantar um serviço ou cliente, certifique-se de usar um certificado apropriado fornecido por uma autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="18b82-110">When deploying a service or client, be sure to use an appropriate certificate provided by a certification authority.</span></span> <span data-ttu-id="18b82-111">Isso pode ser de um [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] certificado de servidor em sua organização ou por terceiros.</span><span class="sxs-lookup"><span data-stu-id="18b82-111">This could either be from a [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] certificate server in your organization or a third party.</span></span>  
>   
>  <span data-ttu-id="18b82-112">Por padrão, o [Makecert.exe (Certificate Creation Tool)](https://msdn.microsoft.com/library/b0343f8e-9c41-4852-a85c-f8a0c408cf0d) cria certificados de autoridade cuja raiz é chamada "agência raiz **."**</span><span class="sxs-lookup"><span data-stu-id="18b82-112">By default, the [Makecert.exe (Certificate Creation Tool)](https://msdn.microsoft.com/library/b0343f8e-9c41-4852-a85c-f8a0c408cf0d) creates certificates whose root authority is called "Root Agency **."**</span></span> <span data-ttu-id="18b82-113">Como a agência"raiz" não está no repositório de autoridades de certificação raiz confiáveis, assim, esses certificados inseguro.</span><span class="sxs-lookup"><span data-stu-id="18b82-113">Because the "Root Agency" is not in the Trusted Root Certification Authorities store, this makes these certificates insecure.</span></span> <span data-ttu-id="18b82-114">Criando um certificado autoassinado que é colocado em autoridades de certificação raiz confiáveis store permite que você crie um ambiente de desenvolvimento que mais de perto simula o ambiente de implantação.</span><span class="sxs-lookup"><span data-stu-id="18b82-114">Creating a self-signed certificate that is placed in the Trusted Root Certification Authorities store enables you to create a development environment that more closely simulates your deployment environment.</span></span>  
  
 <span data-ttu-id="18b82-115">Para obter mais informações sobre como criar e usar certificados, consulte [trabalhando com certificados](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span><span class="sxs-lookup"><span data-stu-id="18b82-115">For more information about creating and using certificates, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span></span> <span data-ttu-id="18b82-116">Para obter mais informações sobre como usar um certificado como uma credencial, consulte [protegendo serviços e clientes](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md).</span><span class="sxs-lookup"><span data-stu-id="18b82-116">For more information about using a certificate as a credential, see [Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md).</span></span> <span data-ttu-id="18b82-117">Para obter um tutorial sobre como usar a tecnologia Microsoft Authenticode, consulte [visões gerais de Authenticode e tutoriais](https://go.microsoft.com/fwlink/?LinkId=88919).</span><span class="sxs-lookup"><span data-stu-id="18b82-117">For a tutorial about using Microsoft Authenticode technology, see [Authenticode Overviews and Tutorials](https://go.microsoft.com/fwlink/?LinkId=88919).</span></span>  
  
### <a name="to-create-a-self-signed-root-authority-certificate-and-export-the-private-key"></a><span data-ttu-id="18b82-118">Para criar um certificado de autoridade raiz autoassinado e exportar a chave privada</span><span class="sxs-lookup"><span data-stu-id="18b82-118">To create a self-signed root authority certificate and export the private key</span></span>  
  
1.  <span data-ttu-id="18b82-119">Use a ferramenta de MakeCert.exe com as seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="18b82-119">Use the MakeCert.exe tool with the following switches:</span></span>  
  
    1.  <span data-ttu-id="18b82-120">`-n` `subjectName`.</span><span class="sxs-lookup"><span data-stu-id="18b82-120">`-n` `subjectName`.</span></span> <span data-ttu-id="18b82-121">Especifica o nome da entidade.</span><span class="sxs-lookup"><span data-stu-id="18b82-121">Specifies the subject name.</span></span> <span data-ttu-id="18b82-122">A convenção é prefixar o nome da entidade com "CN =" de "Common Name".</span><span class="sxs-lookup"><span data-stu-id="18b82-122">The convention is to prefix the subject name with "CN = " for "Common Name".</span></span>  
  
    2.  <span data-ttu-id="18b82-123">`-r`.</span><span class="sxs-lookup"><span data-stu-id="18b82-123">`-r`.</span></span> <span data-ttu-id="18b82-124">Especifica que o certificado autoassinado.</span><span class="sxs-lookup"><span data-stu-id="18b82-124">Specifies that the certificate will be self-signed.</span></span>  
  
    3.  <span data-ttu-id="18b82-125">`-sv` `privateKeyFile`.</span><span class="sxs-lookup"><span data-stu-id="18b82-125">`-sv` `privateKeyFile`.</span></span> <span data-ttu-id="18b82-126">Especifica o arquivo que contém o contêiner de chave privada.</span><span class="sxs-lookup"><span data-stu-id="18b82-126">Specifies the file that contains the private key container.</span></span>  
  
     <span data-ttu-id="18b82-127">Por exemplo, o comando a seguir cria um certificado autoassinado com o nome da entidade "CN = TempCA."</span><span class="sxs-lookup"><span data-stu-id="18b82-127">For example, the following command creates a self-signed certificate with a subject name of "CN=TempCA."</span></span>  
  
    ```  
    makecert -n "CN=TempCA" -r -sv TempCA.pvk TempCA.cer  
    ```  
  
     <span data-ttu-id="18b82-128">Você será solicitado a fornecer uma senha para proteger a chave privada.</span><span class="sxs-lookup"><span data-stu-id="18b82-128">You will be prompted to provide a password to protect the private key.</span></span> <span data-ttu-id="18b82-129">Esta senha é necessária quando a criação de um certificado assinado por esse certificado raiz.</span><span class="sxs-lookup"><span data-stu-id="18b82-129">This password is required when creating a certificate signed by this root certificate.</span></span>  
  
### <a name="to-create-a-new-certificate-signed-by-a-root-authority-certificate"></a><span data-ttu-id="18b82-130">Para criar um novo certificado assinado por um certificado de autoridade raiz</span><span class="sxs-lookup"><span data-stu-id="18b82-130">To create a new certificate signed by a root authority certificate</span></span>  
  
1.  <span data-ttu-id="18b82-131">Use a ferramenta de MakeCert.exe com as seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="18b82-131">Use the MakeCert.exe tool with the following switches:</span></span>  
  
    1.  <span data-ttu-id="18b82-132">`-sk` `subjectKey`.</span><span class="sxs-lookup"><span data-stu-id="18b82-132">`-sk` `subjectKey`.</span></span> <span data-ttu-id="18b82-133">O local do contêiner de chave da entidade que contém a chave privada.</span><span class="sxs-lookup"><span data-stu-id="18b82-133">The location of the subject's key container that holds the private key.</span></span> <span data-ttu-id="18b82-134">Se um contêiner de chave não existir, ele é criado.</span><span class="sxs-lookup"><span data-stu-id="18b82-134">If a key container does not exist, one is created.</span></span> <span data-ttu-id="18b82-135">Se nenhuma das opções de sk - ou - VA for usada, um contêiner de chave chamado JoeSoft é criado por padrão.</span><span class="sxs-lookup"><span data-stu-id="18b82-135">If neither of the -sk or -sv options is used, a key container called JoeSoft is created by default.</span></span>  
  
    2.  <span data-ttu-id="18b82-136">`-n` `subjectName`.</span><span class="sxs-lookup"><span data-stu-id="18b82-136">`-n` `subjectName`.</span></span> <span data-ttu-id="18b82-137">Especifica o nome da entidade.</span><span class="sxs-lookup"><span data-stu-id="18b82-137">Specifies the subject name.</span></span> <span data-ttu-id="18b82-138">A convenção é prefixar o nome da entidade com "CN =" de "Common Name".</span><span class="sxs-lookup"><span data-stu-id="18b82-138">The convention is to prefix the subject name with "CN = " for "Common Name".</span></span>  
  
    3.  <span data-ttu-id="18b82-139">`-iv` `issuerKeyFile`.</span><span class="sxs-lookup"><span data-stu-id="18b82-139">`-iv` `issuerKeyFile`.</span></span> <span data-ttu-id="18b82-140">Especifica o arquivo de chave privada do emissor.</span><span class="sxs-lookup"><span data-stu-id="18b82-140">Specifies the issuer's private key file.</span></span>  
  
    4.  <span data-ttu-id="18b82-141">`-ic` `issuerCertFile`.</span><span class="sxs-lookup"><span data-stu-id="18b82-141">`-ic` `issuerCertFile`.</span></span> <span data-ttu-id="18b82-142">Especifica o local do certificado do emissor.</span><span class="sxs-lookup"><span data-stu-id="18b82-142">Specifies the location of the issuer's certificate.</span></span>  
  
     <span data-ttu-id="18b82-143">Por exemplo, o comando a seguir cria um certificado assinado pela `TempCA` certificado de autoridade raiz com um nome de entidade `"CN=SignedByCA"` usando a chave privada do emissor.</span><span class="sxs-lookup"><span data-stu-id="18b82-143">For example, the following command creates a certificate signed by the `TempCA` root authority certificate with a subject name of `"CN=SignedByCA"` using the private key of the issuer.</span></span>  
  
    ```  
    makecert -sk SignedByCA -iv TempCA.pvk -n "CN=SignedByCA" -ic TempCA.cer SignedByCA.cer -sr currentuser -ss My  
    ```  
  
## <a name="installing-a-certificate-in-the-trusted-root-certification-authorities-store"></a><span data-ttu-id="18b82-144">Instalação de um certificado de Store de autoridades de certificação raiz confiável</span><span class="sxs-lookup"><span data-stu-id="18b82-144">Installing a Certificate in the Trusted Root Certification Authorities Store</span></span>  
 <span data-ttu-id="18b82-145">Depois de criar um certificado autoassinado, você pode instalá-lo no repositório de autoridades de certificação raiz confiáveis.</span><span class="sxs-lookup"><span data-stu-id="18b82-145">Once a self-signed certificate is created, you can install it in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="18b82-146">Todos os certificados são assinados com o certificado no momento são confiáveis para o computador.</span><span class="sxs-lookup"><span data-stu-id="18b82-146">Any certificates that are signed with the certificate at this point are trusted by the computer.</span></span> <span data-ttu-id="18b82-147">Por esse motivo, exclua o certificado do armazenamento assim que você não precisa mais dela.</span><span class="sxs-lookup"><span data-stu-id="18b82-147">For this reason, delete the certificate from the store as soon as you no longer need it.</span></span> <span data-ttu-id="18b82-148">Quando você excluir este certificado de autoridade raiz, todos os outros certificados assinados com ela se tornou não autorizados.</span><span class="sxs-lookup"><span data-stu-id="18b82-148">When you delete this root authority certificate, all other certificates that signed with it become unauthorized.</span></span> <span data-ttu-id="18b82-149">Certificados de autoridade raiz são simplesmente um mecanismo pelo qual um grupo de certificados pode ser definido conforme o necessário.</span><span class="sxs-lookup"><span data-stu-id="18b82-149">Root authority certificates are simply a mechanism whereby a group of certificates can be scoped as necessary.</span></span> <span data-ttu-id="18b82-150">Por exemplo, em aplicativos ponto a ponto, há geralmente sem a necessidade de uma autoridade raiz porque você simplesmente confia na identidade de um indivíduo por seu certificado fornecido.</span><span class="sxs-lookup"><span data-stu-id="18b82-150">For example, in peer-to-peer applications, there is typically no need for a root authority because you simply trust the identity of an individual by its supplied certificate.</span></span>  
  
#### <a name="to-install-a-self-signed-certificate-in-the-trusted-root-certification-authorities"></a><span data-ttu-id="18b82-151">Para instalar um certificado autoassinado em autoridades de certificação raiz confiáveis</span><span class="sxs-lookup"><span data-stu-id="18b82-151">To install a self-signed certificate in the Trusted Root Certification Authorities</span></span>  
  
1.  <span data-ttu-id="18b82-152">Abra o snap-in de certificado.</span><span class="sxs-lookup"><span data-stu-id="18b82-152">Open the certificate snap-in.</span></span> <span data-ttu-id="18b82-153">Para obter mais informações, confira [Como exibir certificados com o snap-in do MMC](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="18b82-153">For more information, see [How to: View Certificates with the MMC Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span></span>  
  
2.  <span data-ttu-id="18b82-154">Abra a pasta para armazenar o certificado, ou o **computador Local** ou o **usuário atual**.</span><span class="sxs-lookup"><span data-stu-id="18b82-154">Open the folder to store the certificate, either the **Local Computer** or the **Current User**.</span></span>  
  
3.  <span data-ttu-id="18b82-155">Abra o **autoridades de certificação raiz confiáveis** pasta.</span><span class="sxs-lookup"><span data-stu-id="18b82-155">Open the **Trusted Root Certification Authorities** folder.</span></span>  
  
4.  <span data-ttu-id="18b82-156">Com o botão direito do **certificados** pasta e clique em **todas as tarefas**, em seguida, clique em **importação**.</span><span class="sxs-lookup"><span data-stu-id="18b82-156">Right-click the **Certificates** folder and click **All Tasks**, then click **Import**.</span></span>  
  
5.  <span data-ttu-id="18b82-157">Siga o assistente na tela instruções para importar o TempCa.cer no repositório.</span><span class="sxs-lookup"><span data-stu-id="18b82-157">Follow the on-screen wizard instructions to import the TempCa.cer into the store.</span></span>  
  
## <a name="using-certificates-with-wcf"></a><span data-ttu-id="18b82-158">Usar certificados com o WCF</span><span class="sxs-lookup"><span data-stu-id="18b82-158">Using Certificates With WCF</span></span>  
 <span data-ttu-id="18b82-159">Depois que você configurar os certificados temporários, você pode usá-los para desenvolver soluções do WCF que especificam certificados como um tipo de credencial de cliente.</span><span class="sxs-lookup"><span data-stu-id="18b82-159">Once you have set up the temporary certificates, you can use them to develop WCF solutions that specify certificates as a client credential type.</span></span> <span data-ttu-id="18b82-160">Por exemplo, a configuração de XML a seguir especifica segurança de mensagem e um certificado como o tipo de credencial de cliente.</span><span class="sxs-lookup"><span data-stu-id="18b82-160">For example, the following XML configuration specifies message security and a certificate as the client credential type.</span></span>  
  
#### <a name="to-specify-a-certificate-as-the-client-credential-type"></a><span data-ttu-id="18b82-161">Para especificar um certificado como o tipo de credencial de cliente</span><span class="sxs-lookup"><span data-stu-id="18b82-161">To specify a certificate as the client credential type</span></span>  
  
-   <span data-ttu-id="18b82-162">No arquivo de configuração para um serviço, use o seguinte XML para definir o modo de segurança para a mensagem e o tipo de credencial de cliente para o certificado.</span><span class="sxs-lookup"><span data-stu-id="18b82-162">In the configuration file for a service, use the following XML to set the security mode to message, and the client credential type to certificate.</span></span>  
  
    ```xml  
    <bindings>       
      <wsHttpBinding>  
        <binding name="CertificateForClient">  
          <security>  
            <message clientCredentialType="Certificate" />  
          </security>  
        </binding>  
      </wsHttpBinding>  
    </bindings>  
    ```  
  
 <span data-ttu-id="18b82-163">No arquivo de configuração para um cliente, use o seguinte XML para especificar que o certificado for encontrado no repositório do usuário e pode ser encontrado pesquisando o campo SubjectName para o valor de "CohoWinery."</span><span class="sxs-lookup"><span data-stu-id="18b82-163">In the configuration file for a client, use the following XML to specify that the certificate is found in the user’s store, and can be found by searching the SubjectName field for the value "CohoWinery."</span></span>  
  
```xml  
<behaviors>  
  <endpointBehaviors>  
    <behavior name="CertForClient">  
      <clientCredentials>  
        <clientCertificate findValue="CohoWinery" x509FindType="FindBySubjectName" />  
       </clientCredentials>  
     </behavior>  
   </endpointBehaviors>  
</behaviors>  
```  
  
 <span data-ttu-id="18b82-164">Para obter mais informações sobre como usar certificados no WCF, consulte [trabalhando com certificados](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span><span class="sxs-lookup"><span data-stu-id="18b82-164">For more information about using certificates in WCF, see [Working with Certificates](../../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span></span>  
  
## <a name="net-framework-security"></a><span data-ttu-id="18b82-165">Segurança do .NET Framework</span><span class="sxs-lookup"><span data-stu-id="18b82-165">.NET Framework Security</span></span>  
 <span data-ttu-id="18b82-166">Certifique-se de excluir quaisquer certificados de autoridade raiz temporária dos **autoridades de certificação raiz confiáveis** e **pessoais** pastas clicando duas vezes no certificado e, em seguida, clicando em  **Excluir**.</span><span class="sxs-lookup"><span data-stu-id="18b82-166">Be sure to delete any temporary root authority certificates from the **Trusted Root Certification Authorities** and **Personal** folders by right-clicking the certificate, then clicking **Delete**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="18b82-167">Consulte também</span><span class="sxs-lookup"><span data-stu-id="18b82-167">See Also</span></span>  
 [<span data-ttu-id="18b82-168">Trabalhando com certificados</span><span class="sxs-lookup"><span data-stu-id="18b82-168">Working with Certificates</span></span>](../../../../docs/framework/wcf/feature-details/working-with-certificates.md)  
 [<span data-ttu-id="18b82-169">Como exibir certificados com o Snap-in do MMC</span><span class="sxs-lookup"><span data-stu-id="18b82-169">How to: View Certificates with the MMC Snap-in</span></span>](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md)  
 [<span data-ttu-id="18b82-170">Protegendo serviços e clientes</span><span class="sxs-lookup"><span data-stu-id="18b82-170">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
