---
title: Filtros avançados
ms.date: 03/30/2017
ms.assetid: 8d81590f-e036-4f96-824a-4a187f462764
ms.openlocfilehash: 7022384e8abe93f4276eec48785b3243ed926438
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43564194"
---
# <a name="advanced-filters"></a><span data-ttu-id="b8c60-102">Filtros avançados</span><span class="sxs-lookup"><span data-stu-id="b8c60-102">Advanced Filters</span></span>
<span data-ttu-id="b8c60-103">Este exemplo demonstra um serviço de roteamento do Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="b8c60-103">This sample demonstrates a Windows Communication Foundation (WCF) routing service.</span></span> <span data-ttu-id="b8c60-104">O serviço de roteamento é um componente do WCF que torna mais fácil incluir um roteador baseado em conteúdo em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-104">The routing service is a WCF component that makes it easy to include a content-based router in your application.</span></span> <span data-ttu-id="b8c60-105">Este exemplo se adapta a amostragem padrão de Calculadora do WCF para se comunicar usando o serviço de roteamento.</span><span class="sxs-lookup"><span data-stu-id="b8c60-105">This sample adapts the standard WCF Calculator sample to communicate using the routing service.</span></span> <span data-ttu-id="b8c60-106">Este exemplo mostra como definir a lógica de roteamento baseado em conteúdo com o uso de filtros de mensagem e tabelas de filtro de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b8c60-106">This sample shows how to define content-based routing logic through the use of message filters and message filter tables.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="b8c60-107">Os exemplos podem mais ser instalados no seu computador.</span><span class="sxs-lookup"><span data-stu-id="b8c60-107">The samples may already be installed on your computer.</span></span> <span data-ttu-id="b8c60-108">Verifique o seguinte diretório (padrão) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="b8c60-108">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="b8c60-109">Se este diretório não existir, vá para [Windows Communication Foundation (WCF) e o Windows Workflow Foundation (WF) exemplos do .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para baixar todos os Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemplos.</span><span class="sxs-lookup"><span data-stu-id="b8c60-109">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="b8c60-110">Este exemplo está localizado no seguinte diretório.</span><span class="sxs-lookup"><span data-stu-id="b8c60-110">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\RoutingServices\AdvancedFilters`  
  
## <a name="sample-details"></a><span data-ttu-id="b8c60-111">Detalhes de exemplo</span><span class="sxs-lookup"><span data-stu-id="b8c60-111">Sample Details</span></span>  
 <span data-ttu-id="b8c60-112">A tabela a seguir mostra os filtros de mensagem que são adicionados à tabela de filtro de mensagem do serviço de roteamento.</span><span class="sxs-lookup"><span data-stu-id="b8c60-112">The following table shows the message filters that are added to the message filter table of the routing service.</span></span>  
  
|<span data-ttu-id="b8c60-113">Filtro</span><span class="sxs-lookup"><span data-stu-id="b8c60-113">Filter</span></span>|<span data-ttu-id="b8c60-114">Regra</span><span class="sxs-lookup"><span data-stu-id="b8c60-114">Rule</span></span>|<span data-ttu-id="b8c60-115">Prioridade</span><span class="sxs-lookup"><span data-stu-id="b8c60-115">Priority</span></span>|  
|------------|----------|--------------|  
|<span data-ttu-id="b8c60-116">Se (tem o cabeçalho)</span><span class="sxs-lookup"><span data-stu-id="b8c60-116">If (has header)</span></span>|<span data-ttu-id="b8c60-117">Arredondamento</span><span class="sxs-lookup"><span data-stu-id="b8c60-117">Rounding</span></span>|<span data-ttu-id="b8c60-118">2</span><span class="sxs-lookup"><span data-stu-id="b8c60-118">2</span></span>|  
|<span data-ttu-id="b8c60-119">Se (aparecia no Ep2)</span><span class="sxs-lookup"><span data-stu-id="b8c60-119">If (showed up on Ep2)</span></span>|<span data-ttu-id="b8c60-120">Normal</span><span class="sxs-lookup"><span data-stu-id="b8c60-120">Regular</span></span>|<span data-ttu-id="b8c60-121">1</span><span class="sxs-lookup"><span data-stu-id="b8c60-121">1</span></span>|  
|<span data-ttu-id="b8c60-122">Se (aparecia com endereço2)</span><span class="sxs-lookup"><span data-stu-id="b8c60-122">If (showed up with Address2)</span></span>|<span data-ttu-id="b8c60-123">Arredondamento</span><span class="sxs-lookup"><span data-stu-id="b8c60-123">Rounding</span></span>|<span data-ttu-id="b8c60-124">1</span><span class="sxs-lookup"><span data-stu-id="b8c60-124">1</span></span>|  
|<span data-ttu-id="b8c60-125">Se (RoundRobin1)</span><span class="sxs-lookup"><span data-stu-id="b8c60-125">If (RoundRobin1)</span></span>|<span data-ttu-id="b8c60-126">Normal</span><span class="sxs-lookup"><span data-stu-id="b8c60-126">Regular</span></span>|<span data-ttu-id="b8c60-127">0</span><span class="sxs-lookup"><span data-stu-id="b8c60-127">0</span></span>|  
|<span data-ttu-id="b8c60-128">Se (RoundRobin2)</span><span class="sxs-lookup"><span data-stu-id="b8c60-128">If (RoundRobin2)</span></span>|<span data-ttu-id="b8c60-129">Arredondamento</span><span class="sxs-lookup"><span data-stu-id="b8c60-129">Rounding</span></span>|<span data-ttu-id="b8c60-130">0</span><span class="sxs-lookup"><span data-stu-id="b8c60-130">0</span></span>|  
  
 <span data-ttu-id="b8c60-131">As tabelas de filtro de mensagem e filtros de mensagem podem ser criadas e configuradas por meio de código ou no arquivo de configuração do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-131">The message filters and message filter tables can be created and configured either through code or in the application configuration file.</span></span> <span data-ttu-id="b8c60-132">Para este exemplo, você pode encontrar as tabelas de filtro de mensagem definido por meio de código no arquivo RoutingService\routing.cs ou definidas no arquivo de configuração do aplicativo no arquivo RoutingService\App.config e filtros de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b8c60-132">For this sample, you can find the message filters and message filter tables defined through code in the RoutingService\routing.cs file, or defined in the application configuration file in the RoutingService\App.config file.</span></span> <span data-ttu-id="b8c60-133">Os parágrafos a seguir descrevem como os filtros de mensagem e tabelas de filtro de mensagem são criadas para este exemplo por meio de código.</span><span class="sxs-lookup"><span data-stu-id="b8c60-133">The following paragraphs describe how the message filters and message filter tables are created for this sample through code.</span></span>  
  
 <span data-ttu-id="b8c60-134">Primeiro, um <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> procura por cabeçalho personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-134">First, an <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> looks for the custom header.</span></span> <span data-ttu-id="b8c60-135">Observe que <xref:System.ServiceModel.WSHttpBinding> resulta em uma versão de envelope usando SOAP 1.2, portanto, a instrução XPath é definida para usar o namespace SOAP 1.2.</span><span class="sxs-lookup"><span data-stu-id="b8c60-135">Note that <xref:System.ServiceModel.WSHttpBinding> results in an envelope version using SOAP 1.2, so the XPath statement is defined to use the SOAP 1.2 namespace.</span></span> <span data-ttu-id="b8c60-136">O Gerenciador de namespace padrão para <xref:System.ServiceModel.Dispatcher.XPathMessageFilter>s já define um prefixo para o namespace SOAP 1.2, /s12, que pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-136">The default namespace manager for <xref:System.ServiceModel.Dispatcher.XPathMessageFilter>s already defines a prefix for the SOAP 1.2 namespace, /s12, which can be used.</span></span> <span data-ttu-id="b8c60-137">No entanto, o Gerenciador de namespace padrão não tem o namespace personalizado que o cliente usa para definir o valor real do cabeçalho, portanto, esse prefixo deve ser definido.</span><span class="sxs-lookup"><span data-stu-id="b8c60-137">However, the default namespace manager does not have the custom namespace that the client uses to define the actual header value, so that prefix must be defined.</span></span> <span data-ttu-id="b8c60-138">Esse filtro corresponde a qualquer mensagem que aparece com esse cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="b8c60-138">Any message that shows up with this header matches this filter.</span></span>  
  
```  
XPathMessageContext namespaceManager = new XPathMessageContext();  
namespaceManager.AddNamespace("custom", "http://my.custom.namespace/");  
  
XPathMessageFilter xpathFilter = new XPathMessageFilter("/s12:Envelope/s12:Header/custom:RoundingCalculator = 1", namespaceManager);  
```  
  
 <span data-ttu-id="b8c60-139">O segundo filtro é um <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter>, que corresponde a qualquer mensagem que foi recebida o `calculatorEndpoint`.</span><span class="sxs-lookup"><span data-stu-id="b8c60-139">The second filter is an <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter>, which matches any message that was received on the `calculatorEndpoint`.</span></span> <span data-ttu-id="b8c60-140">O nome do ponto de extremidade é definido quando um objeto de ponto de extremidade de serviço é criado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-140">The endpoint name is defined when a service endpoint object is created.</span></span>  
  
```  
EndpointNameMessageFilter endpointNameFilter = new EndpointNameMessageFilter("calculatorEndpoint");  
```  
  
 <span data-ttu-id="b8c60-141">O terceiro filtro é um <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter>.</span><span class="sxs-lookup"><span data-stu-id="b8c60-141">The third filter is a <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter>.</span></span> <span data-ttu-id="b8c60-142">Isso corresponde a qualquer mensagem que aparecem em um ponto de extremidade com um endereço que corresponde ao prefixo de endereço (ou a parte frontal), fornecida.</span><span class="sxs-lookup"><span data-stu-id="b8c60-142">This matches any message that showed up on an endpoint with an address that matches the address prefix (or the front portion) provided.</span></span> <span data-ttu-id="b8c60-143">Neste exemplo, o prefixo de endereço é definido como "http://localhost/routingservice/router/rounding/".</span><span class="sxs-lookup"><span data-stu-id="b8c60-143">In this example the address prefix is defined as "http://localhost/routingservice/router/rounding/".</span></span> <span data-ttu-id="b8c60-144">Isso significa que qualquer mensagem de entrada endereçados para "http://localhost/routingservice/router/rounding/\*" correspondem a este filtro.</span><span class="sxs-lookup"><span data-stu-id="b8c60-144">This means that any incoming messages that are addressed to "http://localhost/routingservice/router/rounding/\*" are matched by this filter.</span></span> <span data-ttu-id="b8c60-145">Nesse caso, ele é mensagens que aparecem no ponto de extremidade de arredondamento Calculadora, que tem o endereço do "http://localhost/routingservice/router/rounding/calculator".</span><span class="sxs-lookup"><span data-stu-id="b8c60-145">In this case, it is messages that show up on the Rounding Calculator endpoint, which has the address of "http://localhost/routingservice/router/rounding/calculator".</span></span>  
  
```  
PrefixEndpointAddressMessageFilter prefixAddressFilter = new PrefixEndpointAddressMessageFilter(new EndpointAddress("http://localhost/routingservice/router/rounding/"));  
```  
  
 <span data-ttu-id="b8c60-146">Os dois últimos filtros de mensagem são personalizados <xref:System.ServiceModel.Dispatcher.MessageFilter>s.</span><span class="sxs-lookup"><span data-stu-id="b8c60-146">The last two message filters are custom <xref:System.ServiceModel.Dispatcher.MessageFilter>s.</span></span> <span data-ttu-id="b8c60-147">Neste exemplo, um filtro de mensagem "RoundRobin" é usado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-147">In this example, a "RoundRobin" message filter is used.</span></span> <span data-ttu-id="b8c60-148">Esse filtro de mensagem é criado no arquivo RoutingService\RoundRobinMessageFilter.cs fornecido.</span><span class="sxs-lookup"><span data-stu-id="b8c60-148">This message filter is created in the provided RoutingService\RoundRobinMessageFilter.cs file.</span></span> <span data-ttu-id="b8c60-149">Esses filtros, quando definidos como o mesmo grupo, alternam entre a emissão de relatórios se eles correspondem à mensagem e que não estiverem, de modo que apenas um deles responde `true` por vez.</span><span class="sxs-lookup"><span data-stu-id="b8c60-149">These filters, when set to the same group, alternate between reporting that they match the message and that they do not, such that only one of them responds `true` at a time.</span></span>  
  
```  
RoundRobinMessageFilter roundRobinFilter1 = new RoundRobinMessageFilter("group1");  
  
RoundRobinMessageFilter roundRobinFilter2 = new RoundRobinMessageFilter("group1");  
```  
  
 <span data-ttu-id="b8c60-150">Em seguida, todas essas mensagens são adicionadas a um <xref:System.ServiceModel.Dispatcher.MessageFilterTable%601>.</span><span class="sxs-lookup"><span data-stu-id="b8c60-150">Next, all of those messages are added to a <xref:System.ServiceModel.Dispatcher.MessageFilterTable%601>.</span></span> <span data-ttu-id="b8c60-151">Dessa forma, as prioridades são especificadas para influenciar a ordem na qual a tabela de filtro de mensagem executa os filtros.</span><span class="sxs-lookup"><span data-stu-id="b8c60-151">In doing so, priorities are specified to influence the order in which the message filter table executes the filters.</span></span> <span data-ttu-id="b8c60-152">Quanto maior a prioridade, mais cedo que o filtro é executado; Quanto menor a prioridade, quanto mais tarde um filtro é executado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-152">The higher the priority, the sooner the filter is executed; the lower the priority, the later a filter is executed.</span></span> <span data-ttu-id="b8c60-153">Assim, um filtro com prioridade 2 é executado antes de um filtro com prioridade 1.</span><span class="sxs-lookup"><span data-stu-id="b8c60-153">Thus a filter at priority 2 runs before a filter at priority 1.</span></span> <span data-ttu-id="b8c60-154">O nível de prioridade padrão se nenhum for especificado é 0.</span><span class="sxs-lookup"><span data-stu-id="b8c60-154">The default priority level if none is specified is 0.</span></span> <span data-ttu-id="b8c60-155">Uma tabela de filtro de mensagem executa todos os filtros em um nível de prioridade determinada antes de passar para o próximo nível de prioridade mais baixo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-155">A message filter table executes all of the filters at a given priority level before moving to the next lowest priority level.</span></span> <span data-ttu-id="b8c60-156">Se uma correspondência for encontrada em uma prioridade específica, em seguida, a tabela de filtro de mensagem não continuará tentando localizar correspondências com a próxima prioridade mais baixa.</span><span class="sxs-lookup"><span data-stu-id="b8c60-156">If a match is found at a particular priority, then the message filter table does not continue trying to find matches at the next lower priority.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b8c60-157">Embora este exemplo mostra como usar as prioridades de filtro de mensagem, em geral é mais eficaz e melhor design para design e configurar seus filtros de modo que eles não requerem a priorização funcione corretamente.</span><span class="sxs-lookup"><span data-stu-id="b8c60-157">While this example shows how to use message filter priorities, in general it is more performant and better design to design and configure your filters such that they do not require prioritization to function correctly.</span></span>  
  
 <span data-ttu-id="b8c60-158">O primeiro filtro a ser adicionado é o filtro XPath e sua prioridade é definida como 2.</span><span class="sxs-lookup"><span data-stu-id="b8c60-158">The first filter to be added is the XPath filter and its priority is set to 2.</span></span> <span data-ttu-id="b8c60-159">Isso é o primeiro filtro de mensagem que é executado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-159">This is the first message filter that executes.</span></span> <span data-ttu-id="b8c60-160">Se ele encontrar o cabeçalho personalizado, independentemente do que os resultados dos outros filtros seriam, a mensagem é roteada para o ponto de extremidade de Calculadora de arredondamento.</span><span class="sxs-lookup"><span data-stu-id="b8c60-160">If it finds the custom header, regardless of what the results of the other filters would be, the message is routed to the Rounding Calculator endpoint.</span></span>  
  
 <span data-ttu-id="b8c60-161">Com prioridade 1, os dois filtros são adicionados.</span><span class="sxs-lookup"><span data-stu-id="b8c60-161">At priority 1, two filters are added.</span></span> <span data-ttu-id="b8c60-162">Novamente, esses executado apenas se o filtro XPath com prioridade 2 não coincide com a mensagem.</span><span class="sxs-lookup"><span data-stu-id="b8c60-162">Again, these only run if the XPath filter at priority 2 does not match the message.</span></span> <span data-ttu-id="b8c60-163">Esses dois filtros mostram duas maneiras diferentes para determinar onde a mensagem foi tratada quando ele apareceu.</span><span class="sxs-lookup"><span data-stu-id="b8c60-163">These two filters show two different ways to determine where the message was addressed when it showed up.</span></span> <span data-ttu-id="b8c60-164">Como os dois filtros efetivamente verificam para ver se a mensagem chegou em um dos dois pontos de extremidade, eles podem ser executados no mesmo nível de prioridade porque eles fazem não ambos retornam `true` ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-164">Because the two filters effectively check to see whether the message arrived at one of the two endpoints, they can be run at the same priority level because they do not both return `true` at the same time.</span></span>  
  
 <span data-ttu-id="b8c60-165">Por fim, com prioridade 0 (prioridade mais baixa), execute o RoundRobin de mensagem filtros.</span><span class="sxs-lookup"><span data-stu-id="b8c60-165">Finally, at Priority 0 (the lowest priority) run the RoundRobin message filters.</span></span> <span data-ttu-id="b8c60-166">Como os filtros são configurados com o mesmo nome de grupo, apenas um deles corresponde a cada vez.</span><span class="sxs-lookup"><span data-stu-id="b8c60-166">Because the filters are configured with the same group name, only one of them matches at a time.</span></span> <span data-ttu-id="b8c60-167">Como todas as mensagens com cabeçalho personalizado tiveram sido roteadas e todos aqueles resolvidos para os pontos de extremidade específicos virtualizados, mensagens tratadas pelos filtros de mensagem RoundRobin são apenas as mensagens que tenham sido tratadas ao ponto de extremidade de roteador padrão sem personalizado cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="b8c60-167">Because all messages with the custom header have been routed and all those addressed to the specific virtualized endpoints, messages handled by the RoundRobin message filters are only messages that were addressed to the default router endpoint without the custom header.</span></span> <span data-ttu-id="b8c60-168">Como alternar essas mensagens em uma mensagem para cada chamada, metade das operações de ir para o ponto de extremidade de calculadora Regular e a outra metade, vá para o ponto de extremidade de Calculadora de arredondamento.</span><span class="sxs-lookup"><span data-stu-id="b8c60-168">Because these messages switch on a message for each call, half of the operations go to the Regular Calculator endpoint and the other half go to the Rounding Calculator endpoint.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="b8c60-169">Para usar este exemplo</span><span class="sxs-lookup"><span data-stu-id="b8c60-169">To use this sample</span></span>  
  
1.  <span data-ttu-id="b8c60-170">Usando [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], abra AdvancedFilters.sln.</span><span class="sxs-lookup"><span data-stu-id="b8c60-170">Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open AdvancedFilters.sln.</span></span>  
  
2.  <span data-ttu-id="b8c60-171">Para abrir **Gerenciador de soluções**, selecione **Gerenciador de soluções** do **exibição** menu.</span><span class="sxs-lookup"><span data-stu-id="b8c60-171">To open **Solution Explorer**, select **Solution Explorer** from the **View** menu.</span></span>  
  
3.  <span data-ttu-id="b8c60-172">Pressione F5 ou CTRL + SHIFT + B no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b8c60-172">Press F5 or CTRL+SHIFT+B in Visual Studio.</span></span>  
  
    1.  <span data-ttu-id="b8c60-173">Se você quiser iniciar automaticamente os projetos necessários quando você pressiona F5, a solução com o botão direito e selecione **propriedades**.</span><span class="sxs-lookup"><span data-stu-id="b8c60-173">If you would like to auto-launch the necessary projects when you press F5, right-click the solution and select **Properties**.</span></span> <span data-ttu-id="b8c60-174">Selecione o **projeto de inicialização** nó sob **propriedades comuns** no painel esquerdo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-174">Select the **Startup Project** node under **Common Properties** in the left pane.</span></span> <span data-ttu-id="b8c60-175">Selecione o **vários projetos de inicialização** botão de opção e defina todos os projetos para que o **iniciar** ação.</span><span class="sxs-lookup"><span data-stu-id="b8c60-175">Select the **Multiple Startup Projects**  radio button and set all of the projects to have the **Start** action.</span></span>  
  
    2.  <span data-ttu-id="b8c60-176">Se você compilar o projeto com CTRL + SHIFT + B, você deve iniciar os seguintes aplicativos:</span><span class="sxs-lookup"><span data-stu-id="b8c60-176">If you build the project with CTRL+SHIFT+B, you must start the following applications:</span></span>  
  
        1.  <span data-ttu-id="b8c60-177">Calculadora de cliente (. / CalculatorClient/bin/client.exe)</span><span class="sxs-lookup"><span data-stu-id="b8c60-177">Calculator Client (./CalculatorClient/bin/client.exe)</span></span>  
  
        2.  <span data-ttu-id="b8c60-178">Serviço da Calculadora (. / CalculatorService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="b8c60-178">Calculator Service (./CalculatorService/bin/service.exe)</span></span>  
  
        3.  <span data-ttu-id="b8c60-179">Serviço de roteamento de Calculadora (. / RoundingCalcService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="b8c60-179">Routing Calculator Service (./RoundingCalcService/bin/service.exe)</span></span>  
  
        4.  <span data-ttu-id="b8c60-180">RoutingService (. / RoutingService/bin/RoutingService.exe)</span><span class="sxs-lookup"><span data-stu-id="b8c60-180">RoutingService (./RoutingService/bin/RoutingService.exe)</span></span>  
  
4.  <span data-ttu-id="b8c60-181">Na janela do console do cliente da Calculadora, pressione ENTER para iniciar o cliente.</span><span class="sxs-lookup"><span data-stu-id="b8c60-181">In the console window of the Calculator client, press ENTER to start the client.</span></span> <span data-ttu-id="b8c60-182">O cliente retorna uma lista de pontos de extremidade de destino à sua escolha.</span><span class="sxs-lookup"><span data-stu-id="b8c60-182">The client returns a list of destination endpoints to choose from.</span></span>  
  
5.  <span data-ttu-id="b8c60-183">Escolha um ponto de extremidade de destino, digitando seu letra correspondente e pressione ENTER.</span><span class="sxs-lookup"><span data-stu-id="b8c60-183">Choose a destination endpoint by typing its corresponding letter and press ENTER.</span></span>  
  
6.  <span data-ttu-id="b8c60-184">Em seguida, o cliente solicita se você deseja adicionar um cabeçalho personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-184">Next, the client asks you if you want to add a custom header.</span></span> <span data-ttu-id="b8c60-185">Pressione s para Sim ou N para não e, em seguida, pressione ENTER.</span><span class="sxs-lookup"><span data-stu-id="b8c60-185">Press Y for Yes or N for No, then press ENTER.</span></span>  
  
7.  <span data-ttu-id="b8c60-186">Dependendo das seleções feitas, você deve ver saídas diferentes.</span><span class="sxs-lookup"><span data-stu-id="b8c60-186">Depending on the selections you made, you should see different outputs.</span></span>  
  
    1.  <span data-ttu-id="b8c60-187">A seguir está que a saída retornada, se você adicionou um cabeçalho personalizado para as mensagens.</span><span class="sxs-lookup"><span data-stu-id="b8c60-187">The following is the output returned if you added a custom header to the messages.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.5  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.1  
        ```  
  
    2.  <span data-ttu-id="b8c60-188">A seguir está que a saída retornada, se você escolheu o ponto de extremidade de arredondamento Calculadora sem um cabeçalho personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-188">The following is the output returned if you chose the Rounding Calculator endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.5  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.1  
        ```  
  
    3.  <span data-ttu-id="b8c60-189">A seguir está que a saída retornada, se você escolheu o ponto de extremidade de calculadora regulares sem um cabeçalho personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-189">The following is the output returned if you chose the Regular Calculator endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 115.99  
        Subtract(145,76.54) = 68. 46  
        Multiply(9,81.25) = 731.25  
        Divide(22,7) = 3.14285714285714  
        ```  
  
    4.  <span data-ttu-id="b8c60-190">A seguir está que a saída retornada, se você escolheu o ponto de extremidade de roteador padrão sem um cabeçalho personalizado.</span><span class="sxs-lookup"><span data-stu-id="b8c60-190">The following is the output returned if you chose the Default Router endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.46  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.14285714285714  
        ```  
  
8.  <span data-ttu-id="b8c60-191">O serviço da Calculadora e o serviço da Calculadora arredondamento também imprime um log das operações invocado para as janelas de console respectivo.</span><span class="sxs-lookup"><span data-stu-id="b8c60-191">The Calculator Service and the Rounding Calculator Service also prints out a log of the operations invoked to their respective console windows.</span></span>  
  
9. <span data-ttu-id="b8c60-192">Na janela do console de cliente, digite `quit` e pressione ENTER para sair.</span><span class="sxs-lookup"><span data-stu-id="b8c60-192">In the client console window, type `quit` and press ENTER to exit.</span></span>  
  
10. <span data-ttu-id="b8c60-193">Pressione ENTER nas janelas do console de serviços para encerrar os serviços.</span><span class="sxs-lookup"><span data-stu-id="b8c60-193">Press ENTER in the services console windows to terminate the services.</span></span>  
  
## <a name="configurable-via-code-or-appconfig"></a><span data-ttu-id="b8c60-194">Configurável por meio de código ou App. config</span><span class="sxs-lookup"><span data-stu-id="b8c60-194">Configurable Via Code or App.config</span></span>  
 <span data-ttu-id="b8c60-195">O vem de exemplo configurado para usar um arquivo App. config para definir o comportamento do roteador.</span><span class="sxs-lookup"><span data-stu-id="b8c60-195">The sample ships configured to use an App.config file to define the router’s behavior.</span></span> <span data-ttu-id="b8c60-196">Você também pode alterar o nome do arquivo RoutingService\App.config para algo diferente para que ele não é reconhecido e remova a chamada de método para `ConfigureRouterViaCode()` em RoutingService\routing.cs.</span><span class="sxs-lookup"><span data-stu-id="b8c60-196">You can also change the name of the RoutingService\App.config file to something else so that it is not recognized and uncomment the method call to `ConfigureRouterViaCode()` in RoutingService\routing.cs.</span></span> <span data-ttu-id="b8c60-197">Qualquer um dos métodos resulta no mesmo comportamento do roteador.</span><span class="sxs-lookup"><span data-stu-id="b8c60-197">Either method results in the same behavior from the router.</span></span>  
  
### <a name="scenario"></a><span data-ttu-id="b8c60-198">Cenário</span><span class="sxs-lookup"><span data-stu-id="b8c60-198">Scenario</span></span>  
 <span data-ttu-id="b8c60-199">Este exemplo demonstra o roteador que atua como um roteador baseado em conteúdo, permitindo que vários tipos ou implementação de serviços a serem expostos por meio de um ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="b8c60-199">This sample demonstrates the router acting as a content-based router allowing multiple types or implementation of services to be exposed through one endpoint.</span></span>  
  
### <a name="real-world-scenario"></a><span data-ttu-id="b8c60-200">Cenário do mundo real</span><span class="sxs-lookup"><span data-stu-id="b8c60-200">Real World Scenario</span></span>  
 <span data-ttu-id="b8c60-201">A Contoso deseja virtualizar todos os seus serviços para expor somente um ponto de extremidade publicamente por meio dos quais eles oferecem acesso a vários tipos diferentes de serviços.</span><span class="sxs-lookup"><span data-stu-id="b8c60-201">Contoso wants to virtualize all of their services to expose only one endpoint publicly through which they offer access to multiple different types of services.</span></span> <span data-ttu-id="b8c60-202">Nesse caso, eles utilizam baseado em conteúdo recursos de roteamento do serviço de roteamento para determinar onde as solicitações de entrada devem ser enviadas.</span><span class="sxs-lookup"><span data-stu-id="b8c60-202">In this case they utilize the routing service’s content-based routing capabilities to determine where the incoming requests should be sent.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b8c60-203">Consulte também</span><span class="sxs-lookup"><span data-stu-id="b8c60-203">See Also</span></span>  
 [<span data-ttu-id="b8c60-204">Hospedagem de AppFabric e persistência exemplos</span><span class="sxs-lookup"><span data-stu-id="b8c60-204">AppFabric Hosting and Persistence Samples</span></span>](https://go.microsoft.com/fwlink/?LinkId=193961)
