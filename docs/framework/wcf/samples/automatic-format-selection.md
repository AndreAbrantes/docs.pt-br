---
title: Seleção automática de formato
ms.date: 03/30/2017
ms.assetid: dab51e56-8517-4a6a-bb54-b55b15ab37bb
ms.openlocfilehash: 4fd695195f5c7c13bc088248a6b3c12388328d37
ms.sourcegitcommit: 64f4baed249341e5bf64d1385bf48e3f2e1a0211
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/07/2018
ms.locfileid: "44084021"
---
# <a name="automatic-format-selection"></a><span data-ttu-id="429ef-102">Seleção automática de formato</span><span class="sxs-lookup"><span data-stu-id="429ef-102">Automatic Format Selection</span></span>
<span data-ttu-id="429ef-103">Este exemplo demonstra como habilitar a seleção automática de formato (JSON ou XML) com o modelo, bem como definir explicitamente o formato no código da operação de programação REST do Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="429ef-103">This sample demonstrates how to enable automatic format selection (XML or JSON) with the Windows Communication Foundation (WCF) REST programming model, as well as how to explicitly set the format in the operation code.</span></span>  
  
## <a name="sample-details"></a><span data-ttu-id="429ef-104">Detalhes de exemplo</span><span class="sxs-lookup"><span data-stu-id="429ef-104">Sample Details</span></span>  
 <span data-ttu-id="429ef-105">O exemplo consiste em um serviço juntamente com o código do cliente que faz solicitações para o serviço.</span><span class="sxs-lookup"><span data-stu-id="429ef-105">The sample consists of a service along with client code that makes requests to the service.</span></span> <span data-ttu-id="429ef-106">O serviço oferece suporte a um único HTTP `GET` operação (`EchoWithGet`) e um único HTTP `POST` operação (`EchoWithPost`).</span><span class="sxs-lookup"><span data-stu-id="429ef-106">The service supports a single HTTP `GET` operation (`EchoWithGet`) and a single HTTP `POST` operation (`EchoWithPost`).</span></span> <span data-ttu-id="429ef-107">Ambas as operações esperam uma cadeia de caracteres e, em seguida, retornam a cadeia de caracteres na resposta.</span><span class="sxs-lookup"><span data-stu-id="429ef-107">Both operations expect a string and then return the string in the response.</span></span> <span data-ttu-id="429ef-108">Com o `GET` operação, a cadeia de caracteres é fornecida em um parâmetro de cadeia de caracteres de consulta do URI.</span><span class="sxs-lookup"><span data-stu-id="429ef-108">With the `GET` operation, the string is provided in a URI query-string parameter.</span></span> <span data-ttu-id="429ef-109">Com o `POST` operação, a cadeia de caracteres é fornecida no corpo da solicitação, serializado em XML.</span><span class="sxs-lookup"><span data-stu-id="429ef-109">With the `POST` operation, the string is provided in the body of the request, serialized in XML.</span></span> <span data-ttu-id="429ef-110">O serviço é capaz de retornar respostas em XML ou JSON, utilizando a nova seleção automática de formato e os recursos de seleção de formato imperativa no [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="429ef-110">The service is able to return responses in either XML or JSON, utilizing the new automatic format selection and imperative format selection features in [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span></span>  
  
 <span data-ttu-id="429ef-111">No exemplo, a seleção automática de formato é habilitada usando o arquivo App. config.</span><span class="sxs-lookup"><span data-stu-id="429ef-111">In the sample, automatic format selection is enabled using the App.config file.</span></span> <span data-ttu-id="429ef-112">No ponto de extremidade de HTTP da Web padrão, o `automaticFormatSelectionEnabled` atributo tem um valor de `true`.</span><span class="sxs-lookup"><span data-stu-id="429ef-112">On the default Web HTTP endpoint, the `automaticFormatSelectionEnabled` attribute has been given a value of `true`.</span></span> <span data-ttu-id="429ef-113">Com a seleção automática de formato habilitada, a infraestrutura do WCF seleciona o formato mais apropriado resposta (XML ou JSON) considerando os cabeçalhos de aceitação HTTP ou o tipo de conteúdo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="429ef-113">With automatic format selection enabled, the WCF infrastructure selects the most appropriate response format (XML or JSON) given the HTTP Accept or Content-Type headers of the request.</span></span> <span data-ttu-id="429ef-114">O desenvolvedor não é necessário para fornecer qualquer configuração diferente de configuração ou código adicional a `automaticFormatSelectionEnabled` atributo `true` para usar esse novo recurso.</span><span class="sxs-lookup"><span data-stu-id="429ef-114">The developer is not required to provide any additional code or configuration other than setting the `automaticFormatSelectionEnabled` attribute to `true` to use this new feature.</span></span> <span data-ttu-id="429ef-115">No código do cliente em Program.cs, as solicitações são enviadas para ambos os `GET` e `POST` operações do serviço com o cabeçalho HTTP aceitar especificado como "application/xml" ou "application/json" e o serviço retorna uma resposta em que formato respectivo.</span><span class="sxs-lookup"><span data-stu-id="429ef-115">In the client code in Program.cs, requests are sent to both the `GET` and `POST` operations of the service with the HTTP Accept header specified as either "application/xml" or "application/json" and the service returns a response in that respective format.</span></span>  
  
 <span data-ttu-id="429ef-116">Além disso, no `GET` operação, a seleção de formato obrigatório é usada.</span><span class="sxs-lookup"><span data-stu-id="429ef-116">Also in the `GET` operation, imperative format selection is used.</span></span> <span data-ttu-id="429ef-117">O `GET` operação verifica se há um recurso opcional `format` parâmetro de cadeia de caracteres de consulta e se estiver presente, define o formato da resposta no <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="429ef-117">The `GET` operation checks for an optional `format` query-string parameter and if present, sets the response format on the <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A> property.</span></span> <span data-ttu-id="429ef-118">Imperativamente definir o formato da resposta dessa maneira substitui a seleção automática de formato feita pela infraestrutura do WCF.</span><span class="sxs-lookup"><span data-stu-id="429ef-118">Imperatively setting the response format in this way overrides the automatic format selection done by the WCF infrastructure.</span></span>  
  
 <span data-ttu-id="429ef-119">O exemplo consiste em um serviço auto-hospedado e um cliente que é executado dentro de um aplicativo de console.</span><span class="sxs-lookup"><span data-stu-id="429ef-119">The sample consists of a self-hosted service and a client that runs within a console application.</span></span> <span data-ttu-id="429ef-120">Como o aplicativo de console é executado, o cliente faz solicitações para o serviço e grava as informações pertinentes das respostas à janela do console.</span><span class="sxs-lookup"><span data-stu-id="429ef-120">As the console application runs, the client makes requests to the service and writes the pertinent information from the responses to the console window.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="429ef-121">Para usar este exemplo</span><span class="sxs-lookup"><span data-stu-id="429ef-121">To use this sample</span></span>  
  
1.  <span data-ttu-id="429ef-122">Abra a solução do exemplo de seleção de formato automática.</span><span class="sxs-lookup"><span data-stu-id="429ef-122">Open the solution for the Automatic Format Selection Sample.</span></span> <span data-ttu-id="429ef-123">Ao iniciar [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], você deve executar como administrador para o exemplo para executar com êxito.</span><span class="sxs-lookup"><span data-stu-id="429ef-123">When launching [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], you must run as an administrator for the sample to execute successfully.</span></span> <span data-ttu-id="429ef-124">Fazer isso clicando com o [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] ícone e selecione **executar como administrador** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="429ef-124">Do this by right-clicking the [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icon and select **Run as Administrator** from the context menu.</span></span>  
  
2.  <span data-ttu-id="429ef-125">Pressione CTRL + SHIFT + B para compilar a solução e, em seguida, pressione Ctrl + F5 para executar o projeto de AutomaticFormatSelection do aplicativo de console.</span><span class="sxs-lookup"><span data-stu-id="429ef-125">Press CTRL+SHIFT+B to build the solution and then press Ctrl+F5 to run the console application AutomaticFormatSelection project.</span></span> <span data-ttu-id="429ef-126">A janela do console é exibida e fornece o URI do serviço em execução e o URI do HTML na página para a execução do serviço de Ajuda.</span><span class="sxs-lookup"><span data-stu-id="429ef-126">The console window appears and provides the URI of the running service and the URI of the HTML help page for the running service.</span></span>  
  
3.  <span data-ttu-id="429ef-127">Como o exemplo é executado, o cliente envia solicitações ao serviço e grava as respostas para a janela do console.</span><span class="sxs-lookup"><span data-stu-id="429ef-127">As the sample runs, the client sends requests to the service and writes the responses to the console window.</span></span> <span data-ttu-id="429ef-128">Observe os diferentes formatos das respostas em XML e JSON.</span><span class="sxs-lookup"><span data-stu-id="429ef-128">Notice the different formats of the responses in XML and JSON.</span></span>  
  
4.  <span data-ttu-id="429ef-129">Pressione qualquer tecla para encerrar a amostra.</span><span class="sxs-lookup"><span data-stu-id="429ef-129">Press any key to terminate the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="429ef-130">Os exemplos podem já estar instalados no seu computador.</span><span class="sxs-lookup"><span data-stu-id="429ef-130">The samples may already be installed on your machine.</span></span> <span data-ttu-id="429ef-131">Verifique o seguinte diretório (padrão) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="429ef-131">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="429ef-132">Se este diretório não existir, vá para [Windows Communication Foundation (WCF) e o Windows Workflow Foundation (WF) exemplos do .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para baixar todos os Windows Communication Foundation (WCF) e [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemplos.</span><span class="sxs-lookup"><span data-stu-id="429ef-132">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="429ef-133">Este exemplo está localizado no seguinte diretório.</span><span class="sxs-lookup"><span data-stu-id="429ef-133">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Web\AutomaticFormatSelection`  
  
## <a name="see-also"></a><span data-ttu-id="429ef-134">Consulte também</span><span class="sxs-lookup"><span data-stu-id="429ef-134">See Also</span></span>
