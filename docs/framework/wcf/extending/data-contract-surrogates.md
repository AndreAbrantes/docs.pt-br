---
title: Substitutos de contrato de dados
ms.date: 03/30/2017
helpviewer_keywords:
- data contracts [WCF], surrogates
ms.assetid: 8c31134c-46c5-4ed7-94af-bab0ac0dfce5
ms.openlocfilehash: e33a487c03bbf87666d517040e00131f5482be6f
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96251510"
---
# <a name="data-contract-surrogates"></a><span data-ttu-id="2f1b2-102">Substitutos de contrato de dados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-102">Data Contract Surrogates</span></span>

<span data-ttu-id="2f1b2-103">O *substituto* do contrato de dados é um recurso avançado criado com base no modelo de contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-103">The data contract *surrogate* is an advanced feature built upon the Data Contract model.</span></span> <span data-ttu-id="2f1b2-104">Esse recurso foi projetado para ser usado para personalização de tipo e substituição em situações em que os usuários desejam alterar a forma como um tipo é serializado, desserializado ou projetado em metadados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-104">This feature is designed to be used for type customization and substitution in situations where users want to change how a type is serialized, deserialized or projected into metadata.</span></span> <span data-ttu-id="2f1b2-105">Alguns cenários em que um substituto pode ser usado é quando um contrato de dados não foi especificado para o tipo, os campos e as propriedades não são marcados com o <xref:System.Runtime.Serialization.DataMemberAttribute> atributo ou os usuários desejam criar dinamicamente variações de esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-105">Some scenarios where a surrogate may be used is when a data contract has not been specified for the type, fields and properties are not marked with the <xref:System.Runtime.Serialization.DataMemberAttribute> attribute or users wish to dynamically create schema variations.</span></span>  
  
 <span data-ttu-id="2f1b2-106">A serialização e a desserialização são realizadas com o substituto de contrato de dados ao usar <xref:System.Runtime.Serialization.DataContractSerializer> para converter de .NET Framework em um formato adequado, como XML.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-106">Serialization and deserialization are accomplished with the data contract surrogate when using <xref:System.Runtime.Serialization.DataContractSerializer> to convert from .NET Framework to a suitable format, such as XML.</span></span> <span data-ttu-id="2f1b2-107">O substituto de contrato de dados também pode ser usado para modificar os metadados exportados para tipos, ao produzir representações de metadados, como XSD (documentos de esquema XML).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-107">Data contract surrogate can also be used to modify the metadata exported for types, when producing metadata representations such as XML Schema Documents (XSD).</span></span> <span data-ttu-id="2f1b2-108">Após a importação, o código é criado a partir de metadados e o substituto pode ser usado nesse caso para personalizar o código gerado também.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-108">Upon import, code is created from metadata and the surrogate can be used in this case to customize the generated code as well.</span></span>  
  
## <a name="how-the-surrogate-works"></a><span data-ttu-id="2f1b2-109">Como funciona o substituto</span><span class="sxs-lookup"><span data-stu-id="2f1b2-109">How the Surrogate Works</span></span>  

 <span data-ttu-id="2f1b2-110">Um substituto funciona mapeando um tipo (o tipo "original") para outro tipo (o tipo "substituto").</span><span class="sxs-lookup"><span data-stu-id="2f1b2-110">A surrogate works by mapping one type (the "original" type) to another type (the "surrogated" type).</span></span> <span data-ttu-id="2f1b2-111">O exemplo a seguir mostra o tipo original `Inventory` e um novo `InventorySurrogated` tipo de substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-111">The following example shows the original type `Inventory` and a new surrogate `InventorySurrogated` type.</span></span> <span data-ttu-id="2f1b2-112">O `Inventory` tipo não é serializável, mas o `InventorySurrogated` tipo é:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-112">The `Inventory` type is not serializable but the `InventorySurrogated` type is:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#1)]  
  
 <span data-ttu-id="2f1b2-113">Como um contrato de dados não foi definido para essa classe, converta a classe em uma classe substituta com um contrato de dados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-113">Because a data contract has not been defined for this class, convert the class to a surrogate class with a data contract.</span></span> <span data-ttu-id="2f1b2-114">A classe substituta é mostrada no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-114">The surrogated class is shown in the following example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#2)]  
  
## <a name="implementing-the-idatacontractsurrogate"></a><span data-ttu-id="2f1b2-115">Implementando o IDataContractSurrogate</span><span class="sxs-lookup"><span data-stu-id="2f1b2-115">Implementing the IDataContractSurrogate</span></span>  

 <span data-ttu-id="2f1b2-116">Para usar o substituto de contrato de dados, implemente a <xref:System.Runtime.Serialization.IDataContractSurrogate> interface.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-116">To use the data contract surrogate, implement the <xref:System.Runtime.Serialization.IDataContractSurrogate> interface.</span></span>  
  
 <span data-ttu-id="2f1b2-117">Veja a seguir uma visão geral de cada método do <xref:System.Runtime.Serialization.IDataContractSurrogate> com uma possível implementação.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-117">The following is an overview of each method of <xref:System.Runtime.Serialization.IDataContractSurrogate> with a possible implementation.</span></span>  
  
### <a name="getdatacontracttype"></a><span data-ttu-id="2f1b2-118">GetDataContractType</span><span class="sxs-lookup"><span data-stu-id="2f1b2-118">GetDataContractType</span></span>  

 <span data-ttu-id="2f1b2-119">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> método mapeia um tipo para outro.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-119">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method maps one type to another.</span></span> <span data-ttu-id="2f1b2-120">Esse método é necessário para serialização, desserialização, importação e exportação.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-120">This method is required for serialization, deserialization, import, and export.</span></span>  
  
 <span data-ttu-id="2f1b2-121">A primeira tarefa é definir quais tipos serão mapeados para outros tipos.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-121">The first task is defining what types will be mapped to other types.</span></span> <span data-ttu-id="2f1b2-122">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-122">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#3)]  
  
- <span data-ttu-id="2f1b2-123">Na serialização, o mapeamento retornado por esse método é usado posteriormente para transformar a instância original em uma instância substituta chamando o <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-123">On serialization, the mapping returned by this method is subsequently used to transform the original instance to a surrogated instance by calling the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method.</span></span>  
  
- <span data-ttu-id="2f1b2-124">Na desserialização, o mapeamento retornado por esse método é usado pelo serializador para desserializar em uma instância do tipo substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-124">On deserialization, the mapping returned by this method is used by the serializer to deserialize into an instance of the surrogate type.</span></span> <span data-ttu-id="2f1b2-125">Em seguida, ele chama a <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> transformação da instância substituta em uma instância do tipo original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-125">It subsequently calls <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> to transform the surrogated instance into an instance of the original type.</span></span>  
  
- <span data-ttu-id="2f1b2-126">Na exportação, o tipo substituto retornado por esse método é refletido para obter o contrato de dados a ser usado para gerar metadados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-126">On export, the surrogate type returned by this method is reflected to get the data contract to use for generating metadata.</span></span>  
  
- <span data-ttu-id="2f1b2-127">Na importação, o tipo inicial é alterado para um tipo substituto que é refletido para obter o contrato de dados a ser usado para fins como referência de suporte.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-127">On import, the initial type is changed to a surrogate type that is reflected to get the data contract to use for purposes like referencing support.</span></span>  
  
 <span data-ttu-id="2f1b2-128">O <xref:System.Type> parâmetro é o tipo do objeto que está sendo serializado, desserializado, importado ou exportado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-128">The <xref:System.Type> parameter is the type of the object that is being serialized, deserialized, imported, or exported.</span></span> <span data-ttu-id="2f1b2-129">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> método deve retornar o tipo de entrada se o substituto não tratar o tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-129">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method must return the input type if the surrogate does not handle the type.</span></span> <span data-ttu-id="2f1b2-130">Caso contrário, retorne o tipo alternativo apropriado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-130">Otherwise, return the appropriate surrogated type.</span></span> <span data-ttu-id="2f1b2-131">Se vários tipos substitutos existirem, vários mapeamentos poderão ser definidos nesse método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-131">If several surrogate types exist, numerous mappings can be defined in this method.</span></span>  
  
 <span data-ttu-id="2f1b2-132">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> método não é chamado para primitivos de contrato de dados internos, como <xref:System.Int32> ou <xref:System.String> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-132">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method is not called for built-in data contract primitives, such as <xref:System.Int32> or <xref:System.String>.</span></span> <span data-ttu-id="2f1b2-133">Para outros tipos, como matrizes, tipos definidos pelo usuário e outras estruturas de dados, esse método será chamado para cada tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-133">For other types, such as arrays, user-defined types, and other data structures, this method will be called for each type.</span></span>  
  
 <span data-ttu-id="2f1b2-134">No exemplo anterior, o método verifica se o `type` parâmetro e `Inventory` é comparável.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-134">In the previous example, the method checks if the `type` parameter and `Inventory` are comparable.</span></span> <span data-ttu-id="2f1b2-135">Se for o caso, o método o mapeará para `InventorySurrogated` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-135">If so, the method maps it to `InventorySurrogated`.</span></span> <span data-ttu-id="2f1b2-136">Sempre que uma serialização, desserialização, importar esquema ou exportar esquema é chamada, essa função é chamada primeiro para determinar o mapeamento entre os tipos.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-136">Whenever a serialization, deserialization, import schema, or export schema is called, this function is called first to determine the mapping between types.</span></span>  
  
### <a name="getobjecttoserialize-method"></a><span data-ttu-id="2f1b2-137">Método GetObjectToSerialize</span><span class="sxs-lookup"><span data-stu-id="2f1b2-137">GetObjectToSerialize Method</span></span>  

 <span data-ttu-id="2f1b2-138">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> método converte a instância do tipo original na instância do tipo de substituição.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-138">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method converts the original type instance to the surrogated type instance.</span></span> <span data-ttu-id="2f1b2-139">O método é necessário para a serialização.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-139">The method is required for serialization.</span></span>  
  
 <span data-ttu-id="2f1b2-140">A próxima etapa é definir a maneira como os dados físicos serão mapeados da instância original para o substituto, implementando o <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-140">The next step is to define the way the physical data will be mapped from the original instance to the surrogate by implementing the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method.</span></span> <span data-ttu-id="2f1b2-141">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-141">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#4)]  
  
 <span data-ttu-id="2f1b2-142">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> método é chamado quando um objeto é serializado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-142">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method is called when an object is serialized.</span></span> <span data-ttu-id="2f1b2-143">Esse método transfere dados do tipo original para os campos do tipo substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-143">This method transfers data from the original type to the fields of the surrogated type.</span></span> <span data-ttu-id="2f1b2-144">Os campos podem ser mapeados diretamente para campos substitutos ou as manipulações dos dados originais podem ser armazenadas no substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-144">Fields can be directly mapped to surrogate fields, or manipulations of the original data may be stored in the surrogate.</span></span> <span data-ttu-id="2f1b2-145">Alguns usos possíveis incluem: mapear diretamente os campos, executar operações nos dados a serem armazenados nos campos substituídos ou armazenar o XML do tipo original no campo substituído.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-145">Some possible uses include: directly mapping the fields, performing operations on the data to be stored in the surrogated fields, or storing the XML of the original type in the surrogated field.</span></span>  
  
 <span data-ttu-id="2f1b2-146">O `targetType` parâmetro refere-se ao tipo declarado do membro.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-146">The `targetType` parameter refers to the declared type of the member.</span></span> <span data-ttu-id="2f1b2-147">Esse parâmetro é o tipo substituto retornado pelo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-147">This parameter is the surrogated type returned by the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method.</span></span> <span data-ttu-id="2f1b2-148">O serializador não impõe que o objeto retornado seja atribuível a esse tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-148">The serializer does not enforce that the object returned is assignable to this type.</span></span> <span data-ttu-id="2f1b2-149">O `obj` parâmetro é o objeto a ser serializado e será convertido em seu substituto, se necessário.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-149">The `obj` parameter is the object to serialize, and will be converted to its surrogate if necessary.</span></span> <span data-ttu-id="2f1b2-150">Esse método deve retornar o objeto de entrada se o substituto não tratar o objeto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-150">This method must return the input object if the surrogated does not handle the object.</span></span> <span data-ttu-id="2f1b2-151">Caso contrário, o novo objeto substituto será retornado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-151">Otherwise, the new surrogate object will be returned.</span></span> <span data-ttu-id="2f1b2-152">O substituto não será chamado se o objeto for nulo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-152">The surrogate is not called if the object is null.</span></span> <span data-ttu-id="2f1b2-153">Vários mapeamentos substitutos para diferentes instâncias podem ser definidos dentro desse método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-153">Numerous surrogate mappings for different instances may be defined within this method.</span></span>  
  
 <span data-ttu-id="2f1b2-154">Ao criar um <xref:System.Runtime.Serialization.DataContractSerializer> , você pode instruí-lo para preservar as referências de objeto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-154">When creating a <xref:System.Runtime.Serialization.DataContractSerializer>, you can instruct it to preserve object references.</span></span> <span data-ttu-id="2f1b2-155">(Para obter mais informações, consulte [serialização e desserialização](../feature-details/serialization-and-deserialization.md).) Isso é feito definindo o `preserveObjectReferences` parâmetro em seu construtor como `true` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-155">(For more information, see [Serialization and Deserialization](../feature-details/serialization-and-deserialization.md).) This is done by setting the `preserveObjectReferences` parameter in its constructor to `true`.</span></span> <span data-ttu-id="2f1b2-156">Nesse caso, o substituto é chamado apenas uma vez para um objeto, já que todas as serializações subsequentes apenas gravam a referência no fluxo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-156">In that case, the surrogate is called only once for an object since all subsequent serializations just write the reference into the stream.</span></span> <span data-ttu-id="2f1b2-157">Se `preserveObjectReferences` é definido como `false` , o substituto é chamado toda vez que uma instância é encontrada.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-157">If `preserveObjectReferences` is set to `false`, then the surrogate is called every time an instance is encountered.</span></span>  
  
 <span data-ttu-id="2f1b2-158">Se o tipo da instância serializada diferir do tipo declarado, as informações de tipo serão gravadas no fluxo, por exemplo, `xsi:type` para permitir que a instância seja desserializada na outra extremidade.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-158">If the type of the instance serialized differs from the declared type, type information is written into the stream, for example, `xsi:type` to allow the instance to be deserialized at the other end.</span></span> <span data-ttu-id="2f1b2-159">Esse processo ocorre se o objeto é substituído ou não.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-159">This process occurs whether the object is surrogated or not.</span></span>  
  
 <span data-ttu-id="2f1b2-160">O exemplo acima converte os dados da `Inventory` instância para o de `InventorySurrogated` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-160">The example above converts the data of the `Inventory` instance to that of `InventorySurrogated`.</span></span> <span data-ttu-id="2f1b2-161">Ele verifica o tipo do objeto e executa as manipulações necessárias para converter para o tipo substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-161">It checks the type of the object and performs the necessary manipulations to convert to the surrogated type.</span></span> <span data-ttu-id="2f1b2-162">Nesse caso, os campos da `Inventory` classe são copiados diretamente para os campos de `InventorySurrogated` classe.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-162">In this case, the fields of the `Inventory` class are directly copied over to the `InventorySurrogated` class fields.</span></span>  
  
### <a name="getdeserializedobject-method"></a><span data-ttu-id="2f1b2-163">Método GetDeserializedObject</span><span class="sxs-lookup"><span data-stu-id="2f1b2-163">GetDeserializedObject Method</span></span>  

 <span data-ttu-id="2f1b2-164">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> método converte a instância do tipo substituto para a instância do tipo original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-164">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> method converts the surrogated type instance to the original type instance.</span></span> <span data-ttu-id="2f1b2-165">Ele é necessário para desserialização.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-165">It is required for deserialization.</span></span>  
  
 <span data-ttu-id="2f1b2-166">A próxima tarefa é definir a maneira como os dados físicos serão mapeados da instância substituta para o original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-166">The next task is to define the way the physical data will be mapped from the surrogate instance to the original.</span></span> <span data-ttu-id="2f1b2-167">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-167">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#5)]  
  
 <span data-ttu-id="2f1b2-168">Esse método é chamado somente durante a desserialização de um objeto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-168">This method is called only during the deserialization of an object.</span></span> <span data-ttu-id="2f1b2-169">Ele fornece mapeamento de dados inverso para a desserialização do tipo substituto de volta para seu tipo original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-169">It provides reverse data mapping for the deserialization from the surrogate type back to its original type.</span></span> <span data-ttu-id="2f1b2-170">Semelhante ao `GetObjectToSerialize` método, alguns usos possíveis podem ser trocar diretamente os dados de campo, executar operações nos dados e armazenar dados XML.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-170">Similar to the `GetObjectToSerialize` method, some possible uses may be to directly exchange field data, perform operations on the data, and store XML data.</span></span> <span data-ttu-id="2f1b2-171">Ao desserializar, nem sempre é possível obter os valores de dados exatos do original devido a manipulações na conversão de dados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-171">When  deserializing, you may not always obtain the exact data values from original due to manipulations in the data conversion.</span></span>  
  
 <span data-ttu-id="2f1b2-172">O `targetType` parâmetro refere-se ao tipo declarado do membro.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-172">The `targetType` parameter refers to the declared type of the member.</span></span> <span data-ttu-id="2f1b2-173">Esse parâmetro é o tipo substituto retornado pelo `GetDataContractType` método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-173">This parameter is the surrogated type returned by the `GetDataContractType` method.</span></span> <span data-ttu-id="2f1b2-174">O `obj` parâmetro refere-se ao objeto que foi desserializado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-174">The `obj` parameter refers to the object that has been deserialized.</span></span> <span data-ttu-id="2f1b2-175">O objeto pode ser convertido de volta para seu tipo original se ele for substituído.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-175">The object can be converted back to its original type if it is surrogated.</span></span> <span data-ttu-id="2f1b2-176">Esse método retornará o objeto de entrada se o substituto não tratar o objeto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-176">This method returns the input object if the surrogate does not handle the object.</span></span> <span data-ttu-id="2f1b2-177">Caso contrário, o objeto desserializado será retornado quando sua conversão for concluída.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-177">Otherwise, the deserialized object will be returned once its conversion has been completed.</span></span> <span data-ttu-id="2f1b2-178">Se houver vários tipos substitutos, você poderá fornecer conversão de dados de substituto para o tipo principal para cada um indicando cada tipo e sua conversão.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-178">If several surrogate types exist, you may provide data conversion from surrogate to primary type for each by indicating each type and its conversion.</span></span>  
  
 <span data-ttu-id="2f1b2-179">Ao retornar um objeto, as tabelas de objeto interno são atualizadas com o objeto retornado por esse substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-179">When returning an object, the internal object tables are updated with the object returned by this surrogate.</span></span> <span data-ttu-id="2f1b2-180">Todas as referências subsequentes a uma instância obterão a instância substituta das tabelas de objeto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-180">Any subsequent references to an instance will obtain the surrogated instance from the object tables.</span></span>  
  
 <span data-ttu-id="2f1b2-181">O exemplo anterior converte objetos do tipo de `InventorySurrogated` volta para o tipo inicial `Inventory` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-181">The previous example converts objects of type `InventorySurrogated` back to the initial type `Inventory`.</span></span> <span data-ttu-id="2f1b2-182">Nesse caso, os dados são transferidos diretamente de volta do `InventorySurrogated` para seus campos correspondentes no `Inventory` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-182">In this case, data is directly transferred back from `InventorySurrogated` to its corresponding fields in `Inventory`.</span></span> <span data-ttu-id="2f1b2-183">Como não há manipulações de dados, cada um dos campos de membro conterá os mesmos valores de antes da serialização.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-183">Because there are no data manipulations, the each of the member fields will contain the same values as before the serialization.</span></span>  
  
### <a name="getcustomdatatoexport-method"></a><span data-ttu-id="2f1b2-184">Método GetCustomDataToExport</span><span class="sxs-lookup"><span data-stu-id="2f1b2-184">GetCustomDataToExport Method</span></span>  

 <span data-ttu-id="2f1b2-185">Ao exportar um esquema, o <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A> método é opcional.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-185">When exporting a schema, the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A> method is optional.</span></span> <span data-ttu-id="2f1b2-186">Ele é usado para inserir dados ou dicas adicionais no esquema exportado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-186">It is used to insert additional data or hints into the exported schema.</span></span> <span data-ttu-id="2f1b2-187">Dados adicionais podem ser inseridos no nível de membro ou nível de tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-187">Additional data can be inserted at the member level or type level.</span></span> <span data-ttu-id="2f1b2-188">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-188">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#6)]  
  
 <span data-ttu-id="2f1b2-189">Esse método (com duas sobrecargas) permite a inclusão de informações extras nos metadados no nível de membro ou de tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-189">This method (with two overloads) enables the inclusion of extra information into the metadata either at the member or type level.</span></span> <span data-ttu-id="2f1b2-190">É possível incluir dicas sobre se um membro é público ou privado e comentários que seriam preservados durante a exportação e a importação do esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-190">It is possible to include hints about whether a member is public or private, and comments which would be preserved throughout the export and import of the schema.</span></span> <span data-ttu-id="2f1b2-191">Essas informações seriam perdidas sem esse método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-191">Such information would be lost without this method.</span></span> <span data-ttu-id="2f1b2-192">Esse método não causa a inserção ou exclusão de membros ou tipos, mas, em vez disso, adiciona dados adicionais aos esquemas em qualquer um desses níveis.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-192">This method does not cause the insertion or deletion of members or types, but rather adds additional data to the schemas at either of these levels.</span></span>  
  
 <span data-ttu-id="2f1b2-193">O método está sobrecarregado e pode ter um `Type` ( `clrtype` parâmetro) ou <xref:System.Reflection.MemberInfo> ( `memberInfo` parâmetro).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-193">The method is overloaded and can take either a `Type` (`clrtype` parameter) or <xref:System.Reflection.MemberInfo> (`memberInfo` parameter).</span></span> <span data-ttu-id="2f1b2-194">O segundo parâmetro é sempre um `Type` ( `dataContractType` parâmetro).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-194">The second parameter is always a `Type` (`dataContractType` parameter).</span></span> <span data-ttu-id="2f1b2-195">Esse método é chamado para cada membro e tipo do `dataContractType` tipo substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-195">This method is called for every member and type of the surrogated `dataContractType` type.</span></span>  
  
 <span data-ttu-id="2f1b2-196">Qualquer uma dessas sobrecargas deve retornar um `null` ou um objeto serializável.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-196">Either of these overloads must return either `null` or a serializable object.</span></span> <span data-ttu-id="2f1b2-197">Um objeto não nulo será serializado como anotação no esquema exportado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-197">A non-null object will be serialized as annotation into the exported schema.</span></span> <span data-ttu-id="2f1b2-198">Para a `Type` sobrecarga, cada tipo exportado para o esquema é enviado para esse método no primeiro parâmetro, juntamente com o tipo substituto como o `dataContractType` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-198">For the `Type` overload, each type that is exported to schema is sent to this method in the first parameter along with the surrogated type as the `dataContractType` parameter.</span></span> <span data-ttu-id="2f1b2-199">Para a `MemberInfo` sobrecarga, cada membro exportado para o esquema envia suas informações como o `memberInfo` parâmetro com o tipo substituto no segundo parâmetro.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-199">For the `MemberInfo` overload, each member that is exported to schema sends its information as the `memberInfo` parameter with the surrogated type in the second parameter.</span></span>  
  
#### <a name="getcustomdatatoexport-method-type-type"></a><span data-ttu-id="2f1b2-200">Método GetCustomDataToExport (tipo, tipo)</span><span class="sxs-lookup"><span data-stu-id="2f1b2-200">GetCustomDataToExport Method (Type, Type)</span></span>  

 <span data-ttu-id="2f1b2-201">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Type%2CSystem.Type%29?displayProperty=nameWithType> método é chamado durante a exportação de esquema para cada definição de tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-201">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Type%2CSystem.Type%29?displayProperty=nameWithType> method is called during schema export for every type definition.</span></span> <span data-ttu-id="2f1b2-202">O método adiciona informações aos tipos no esquema durante a exportação.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-202">The method adds information to the types within the schema when exporting.</span></span> <span data-ttu-id="2f1b2-203">Cada tipo definido é enviado para esse método para determinar se há dados adicionais que precisam ser incluídos no esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-203">Each type defined is sent to this method to determine whether there is any additional data that needs to be included in the schema.</span></span>  
  
#### <a name="getcustomdatatoexport-method-memberinfo-type"></a><span data-ttu-id="2f1b2-204">Método GetCustomDataToExport (MemberInfo, Type)</span><span class="sxs-lookup"><span data-stu-id="2f1b2-204">GetCustomDataToExport Method (MemberInfo, Type)</span></span>  

 <span data-ttu-id="2f1b2-205">O <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Reflection.MemberInfo%2CSystem.Type%29?displayProperty=nameWithType> é chamado durante a exportação para cada membro nos tipos exportados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-205">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Reflection.MemberInfo%2CSystem.Type%29?displayProperty=nameWithType> is called during export for every member in the types that are exported.</span></span> <span data-ttu-id="2f1b2-206">Essa função permite que você personalize todos os comentários para os membros que serão incluídos no esquema após a exportação.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-206">This function enables you to customize any comments for the members that will be included in the schema upon export.</span></span> <span data-ttu-id="2f1b2-207">As informações para cada membro dentro da classe são enviadas para esse método para verificar se os dados adicionais precisam ser adicionados ao esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-207">The information for every member within the class is sent to this method to check whether any additional data need to be added in the schema.</span></span>  
  
 <span data-ttu-id="2f1b2-208">O exemplo acima pesquisa o `dataContractType` para cada membro do substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-208">The example above searches through the `dataContractType` for each member of the surrogate.</span></span> <span data-ttu-id="2f1b2-209">Em seguida, ele retorna o modificador de acesso apropriado para cada campo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-209">It then returns the appropriate access modifier for each field.</span></span> <span data-ttu-id="2f1b2-210">Sem essa personalização, o valor padrão para modificadores de acesso é público.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-210">Without this customization, the default value for access modifiers is public.</span></span> <span data-ttu-id="2f1b2-211">Portanto, todos os membros seriam definidos como públicos no código gerado usando o esquema exportado, independentemente de quais são suas restrições de acesso reais.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-211">Therefore, all members would be defined as public in the code generated using the exported schema no matter what their actual access restrictions are.</span></span> <span data-ttu-id="2f1b2-212">Quando não estiver usando essa implementação, o membro `numpens` seria público no esquema exportado, embora ele tenha sido definido no substituto como particular.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-212">When not using this implementation, the member `numpens` would be public in the exported schema even though it was defined in the surrogate as private.</span></span> <span data-ttu-id="2f1b2-213">Com o uso desse método, no esquema exportado, o modificador de acesso pode ser gerado como particular.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-213">Through the use of this method, in the exported schema, the access modifier can be generated as private.</span></span>  
  
### <a name="getreferencedtypeonimport-method"></a><span data-ttu-id="2f1b2-214">Método GetReferencedTypeOnImport</span><span class="sxs-lookup"><span data-stu-id="2f1b2-214">GetReferencedTypeOnImport Method</span></span>  

 <span data-ttu-id="2f1b2-215">Esse método mapeia o <xref:System.Type> do substituto para o tipo original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-215">This method maps the <xref:System.Type> of the surrogate to the original type.</span></span> <span data-ttu-id="2f1b2-216">Esse método é opcional para a importação de esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-216">This method is optional for schema importation.</span></span>  
  
 <span data-ttu-id="2f1b2-217">Ao criar um substituto que importa um esquema e gera código para ele, a próxima tarefa é definir o tipo de uma instância substituta para seu tipo original.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-217">When creating a surrogate that imports a schema and generates code for it, the next task is to define the type of a surrogate instance to its original type.</span></span>  
  
 <span data-ttu-id="2f1b2-218">Se o código gerado precisar fazer referência a um tipo de usuário existente, isso é feito com a implementação do <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-218">If the generated code needs to reference an existing user type, this is done by implementing the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> method.</span></span>  
  
 <span data-ttu-id="2f1b2-219">Ao importar um esquema, esse método é chamado para cada declaração de tipo para mapear o contrato de dados substitutos para um tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-219">When importing a schema, this method is called for every type declaration to map the surrogated data contract to a type.</span></span> <span data-ttu-id="2f1b2-220">Os parâmetros de cadeia de caracteres `typeName` e `typeNamespace` definem o nome e o namespace do tipo substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-220">The string parameters `typeName` and `typeNamespace` define the name and namespace of the surrogated type.</span></span> <span data-ttu-id="2f1b2-221">O valor de retorno para <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> é usado para determinar se um novo tipo precisa ser gerado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-221">The return value for <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> is used to determine whether a new type needs to be generated.</span></span> <span data-ttu-id="2f1b2-222">Este método deve retornar um tipo válido ou nulo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-222">This method must return either a valid type or null.</span></span> <span data-ttu-id="2f1b2-223">Para tipos válidos, o tipo retornado será usado como um tipo referenciado no código gerado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-223">For valid types, the type returned will be used as a referenced type in the generated code.</span></span> <span data-ttu-id="2f1b2-224">Se NULL for retornado, nenhum tipo será referenciado e um novo tipo deverá ser criado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-224">If null is returned, no type will be referenced and a new type must be created.</span></span> <span data-ttu-id="2f1b2-225">Se houver vários substitutos, será possível executar o mapeamento para cada tipo substituto de volta para seu tipo inicial.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-225">If several surrogates exist, it is possible to perform the mapping for each surrogate type back to its initial type.</span></span>  
  
 <span data-ttu-id="2f1b2-226">O `customData` parâmetro é o objeto retornado originalmente de <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-226">The `customData` parameter is the object originally returned from <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A>.</span></span> <span data-ttu-id="2f1b2-227">Isso `customData` é usado quando os autores substitutos desejam inserir dados/dicas extras nos metadados a serem usados durante a importação para gerar código.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-227">This `customData` is used when surrogate authors want to insert extra data/hints into the metadata to use during import to generate code.</span></span>  
  
### <a name="processimportedtype-method"></a><span data-ttu-id="2f1b2-228">Método ProcessImportedType</span><span class="sxs-lookup"><span data-stu-id="2f1b2-228">ProcessImportedType Method</span></span>  

 <span data-ttu-id="2f1b2-229">O <xref:System.Runtime.Serialization.IDataContractSurrogate.ProcessImportedType%2A> método personaliza qualquer tipo criado a partir da importação de esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-229">The <xref:System.Runtime.Serialization.IDataContractSurrogate.ProcessImportedType%2A> method customizes any type created from schema importation.</span></span> <span data-ttu-id="2f1b2-230">Esse método é opcional.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-230">This method is optional.</span></span>  
  
 <span data-ttu-id="2f1b2-231">Ao importar um esquema, esse método permite que qualquer tipo importado e informações de compilação sejam personalizadas.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-231">When importing a schema, this method allows for any imported type and compilation information to be customized.</span></span> <span data-ttu-id="2f1b2-232">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-232">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#7)]  
  
 <span data-ttu-id="2f1b2-233">Durante a importação, esse método é chamado para cada tipo gerado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-233">During import, this method is called for every type generated.</span></span> <span data-ttu-id="2f1b2-234">Altere o especificado <xref:System.CodeDom.CodeTypeDeclaration> ou modifique o <xref:System.CodeDom.CodeCompileUnit> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-234">Change the specified <xref:System.CodeDom.CodeTypeDeclaration> or modify the <xref:System.CodeDom.CodeCompileUnit>.</span></span> <span data-ttu-id="2f1b2-235">Isso inclui alterar o nome, os membros, os atributos e muitas outras propriedades do `CodeTypeDeclaration` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-235">This includes changing the name, members, attributes, and many other properties of the `CodeTypeDeclaration`.</span></span> <span data-ttu-id="2f1b2-236">Ao processar o `CodeCompileUnit` , é possível modificar as diretivas, os namespaces, os assemblies referenciados e vários outros aspectos.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-236">By processing the `CodeCompileUnit`, it is possible to modify the directives, namespaces, referenced assemblies, and several other aspects.</span></span>  
  
 <span data-ttu-id="2f1b2-237">O `CodeTypeDeclaration` parâmetro contém a declaração de tipo dom de código.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-237">The `CodeTypeDeclaration` parameter contains the code DOM type declaration.</span></span> <span data-ttu-id="2f1b2-238">O `CodeCompileUnit` parâmetro permite a modificação para o processamento do código.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-238">The `CodeCompileUnit` parameter allows for modification for processing the code.</span></span>  <span data-ttu-id="2f1b2-239">Retornando `null` resultados na declaração de tipo que está sendo descartada.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-239">Returning `null` results in the type declaration being discarded.</span></span> <span data-ttu-id="2f1b2-240">Por outro lado, ao retornar um `CodeTypeDeclaration` , as modificações são preservadas.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-240">Conversely, when returning a `CodeTypeDeclaration`, the modifications are preserved.</span></span>  
  
 <span data-ttu-id="2f1b2-241">Se os dados personalizados forem inseridos durante a exportação de metadados, ele precisará ser fornecido ao usuário durante a importação para que possa ser usado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-241">If custom data is inserted during metadata export, it needs to be provided to the user during import so that it can be used.</span></span> <span data-ttu-id="2f1b2-242">Esses dados personalizados podem ser usados para dicas de modelo de programação ou outros comentários.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-242">This custom data can be used for programming model hints, or other comments.</span></span> <span data-ttu-id="2f1b2-243">Cada `CodeTypeDeclaration` <xref:System.CodeDom.CodeTypeMember> instância do e inclui dados personalizados como a <xref:System.CodeDom.CodeObject.UserData%2A> propriedade, convertida para o `IDataContractSurrogate` tipo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-243">Each `CodeTypeDeclaration` and <xref:System.CodeDom.CodeTypeMember> instance includes custom data as the <xref:System.CodeDom.CodeObject.UserData%2A> property, cast to the `IDataContractSurrogate` type.</span></span>  
  
 <span data-ttu-id="2f1b2-244">O exemplo acima executa algumas alterações no esquema importado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-244">The example above performs some changes on the schema imported.</span></span> <span data-ttu-id="2f1b2-245">O código preserva os membros privados do tipo original usando um substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-245">The code preserves private members of the original type by using a surrogate.</span></span> <span data-ttu-id="2f1b2-246">O modificador de acesso padrão ao importar um esquema é `public` .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-246">The default access modifier when importing a schema is `public`.</span></span> <span data-ttu-id="2f1b2-247">Portanto, todos os membros do esquema substituto serão públicos, a menos que sejam modificados, como neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-247">Therefore, all members of the surrogate schema will be public unless modified, as in this example.</span></span> <span data-ttu-id="2f1b2-248">Durante a exportação, os dados personalizados são inseridos nos metadados sobre os quais os membros são privados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-248">During export, custom data is inserted into the metadata about which members are private.</span></span> <span data-ttu-id="2f1b2-249">O exemplo pesquisa os dados personalizados, verifica se o modificador de acesso é privado e, em seguida, modifica o membro apropriado para ser privado definindo seus atributos.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-249">The example looks up the custom data, checks whether the access modifier is private, and then modifies the appropriate member to be private by setting its attributes.</span></span> <span data-ttu-id="2f1b2-250">Sem essa personalização, o `numpens` membro seria definido como público em vez de privado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-250">Without this customization, the `numpens` member would be defined as public instead of private.</span></span>  
  
### <a name="getknowncustomdatatypes-method"></a><span data-ttu-id="2f1b2-251">Método GetKnownCustomDataTypes</span><span class="sxs-lookup"><span data-stu-id="2f1b2-251">GetKnownCustomDataTypes Method</span></span>  

 <span data-ttu-id="2f1b2-252">Esse método obtém tipos de dados personalizados definidos a partir do esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-252">This method obtains custom data types defined from the schema.</span></span> <span data-ttu-id="2f1b2-253">O método é opcional para a importação de esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-253">The method is optional for schema importation.</span></span>  
  
 <span data-ttu-id="2f1b2-254">O método é chamado no início da exportação e importação de esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-254">The method is called at the beginning of schema export and import.</span></span> <span data-ttu-id="2f1b2-255">O método retorna os tipos de dados personalizados usados no esquema exportado ou importado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-255">The method returns the custom data types used in the schema exported or imported.</span></span> <span data-ttu-id="2f1b2-256">O método é passado a <xref:System.Collections.ObjectModel.Collection%601> (o `customDataTypes` parâmetro), que é uma coleção de tipos.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-256">The method is passed a <xref:System.Collections.ObjectModel.Collection%601> (the `customDataTypes` parameter), which is a collection of types.</span></span> <span data-ttu-id="2f1b2-257">O método deve adicionar tipos conhecidos adicionais a esta coleção.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-257">The method should add additional known types to this collection.</span></span> <span data-ttu-id="2f1b2-258">Os tipos de dados personalizados conhecidos são necessários para habilitar a serialização e a desserialização de dados personalizados usando o <xref:System.Runtime.Serialization.DataContractSerializer> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-258">The known custom data types are needed to enable serialization and deserialization of custom data using the <xref:System.Runtime.Serialization.DataContractSerializer>.</span></span> <span data-ttu-id="2f1b2-259">Para obter mais informações, consulte [tipos conhecidos de contrato de dados](../feature-details/data-contract-known-types.md).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-259">For more information, see [Data Contract Known Types](../feature-details/data-contract-known-types.md).</span></span>  
  
## <a name="implementing-a-surrogate"></a><span data-ttu-id="2f1b2-260">Implementando um substituto</span><span class="sxs-lookup"><span data-stu-id="2f1b2-260">Implementing a Surrogate</span></span>  

 <span data-ttu-id="2f1b2-261">Para usar o substituto de contrato de dados no WCF, você deve seguir alguns procedimentos especiais.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-261">To use the data contract surrogate within WCF, you must follow a few special procedures.</span></span>  
  
### <a name="to-use-a-surrogate-for-serialization-and-deserialization"></a><span data-ttu-id="2f1b2-262">Para usar um substituto para serialização e desserialização</span><span class="sxs-lookup"><span data-stu-id="2f1b2-262">To Use a Surrogate for Serialization and Deserialization</span></span>  

 <span data-ttu-id="2f1b2-263">Use o <xref:System.Runtime.Serialization.DataContractSerializer> para executar a serialização e a desserialização de dados com o substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-263">Use the <xref:System.Runtime.Serialization.DataContractSerializer> to perform serialization and deserialization of data with the surrogate.</span></span> <span data-ttu-id="2f1b2-264">O <xref:System.Runtime.Serialization.DataContractSerializer> é criado pelo <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-264">The <xref:System.Runtime.Serialization.DataContractSerializer> is created by the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>.</span></span> <span data-ttu-id="2f1b2-265">O substituto também deve ser especificado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-265">The surrogate must also be specified.</span></span>  
  
##### <a name="to-implement-serialization-and-deserialization"></a><span data-ttu-id="2f1b2-266">Para implementar a serialização e desserialização</span><span class="sxs-lookup"><span data-stu-id="2f1b2-266">To implement serialization and deserialization</span></span>  
  
1. <span data-ttu-id="2f1b2-267">Crie uma instância do <xref:System.ServiceModel.ServiceHost> para o seu serviço.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-267">Create an instance of the <xref:System.ServiceModel.ServiceHost> for your service.</span></span> <span data-ttu-id="2f1b2-268">Para obter instruções completas, consulte [programação básica do WCF](../basic-wcf-programming.md).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-268">For complete instructions, see [Basic WCF Programming](../basic-wcf-programming.md).</span></span>  
  
2. <span data-ttu-id="2f1b2-269">Para cada <xref:System.ServiceModel.Description.ServiceEndpoint> host de serviço especificado, localize seu <xref:System.ServiceModel.Description.OperationDescription> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-269">For every <xref:System.ServiceModel.Description.ServiceEndpoint> of the specified service host, find its <xref:System.ServiceModel.Description.OperationDescription>.</span></span>  
  
3. <span data-ttu-id="2f1b2-270">Pesquise os comportamentos de operação para determinar se uma instância do <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> foi encontrada.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-270">Search through the operation behaviors to determine if an instance of the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found.</span></span>  
  
4. <span data-ttu-id="2f1b2-271">Se <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> for encontrado, defina sua <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> propriedade como uma nova instância do substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-271">If a <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found, set its <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> property to a new instance of the surrogate.</span></span> <span data-ttu-id="2f1b2-272">Se não <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> for encontrado, crie uma nova instância e defina o <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> membro do novo comportamento como uma nova instância do substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-272">If no <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found, then create a new instance and set the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> member of the new behavior to a new instance of the surrogate.</span></span>  
  
5. <span data-ttu-id="2f1b2-273">Por fim, adicione esse novo comportamento aos comportamentos de operação atuais, conforme mostrado no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="2f1b2-273">Finally, add this new behavior to the current operation behaviors, as shown in the following example:</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#8)]  
  
### <a name="to-use-a-surrogate-for-metadata-import"></a><span data-ttu-id="2f1b2-274">Para usar um substituto para importação de metadados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-274">To Use a Surrogate for Metadata Import</span></span>  

 <span data-ttu-id="2f1b2-275">Ao importar metadados como WSDL e XSD para gerar o código do lado do cliente, o substituto precisa ser adicionado ao componente responsável pela geração de código do esquema XSD, <xref:System.Runtime.Serialization.XsdDataContractImporter> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-275">When importing metadata like WSDL and XSD to generate client-side code, the surrogate needs to be added to the component responsible for generating code from XSD schema, <xref:System.Runtime.Serialization.XsdDataContractImporter>.</span></span> <span data-ttu-id="2f1b2-276">Para fazer isso, modifique diretamente o <xref:System.ServiceModel.Description.WsdlImporter> usado para importar os metadados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-276">To do this, directly modify the <xref:System.ServiceModel.Description.WsdlImporter> used to import metadata.</span></span>  
  
##### <a name="to-implement-a-surrogate-for-metadata-importation"></a><span data-ttu-id="2f1b2-277">Para implementar um substituto para a importação de metadados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-277">To implement a surrogate for metadata importation</span></span>  
  
1. <span data-ttu-id="2f1b2-278">Importe os metadados usando a <xref:System.ServiceModel.Description.WsdlImporter> classe.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-278">Import the metadata using the <xref:System.ServiceModel.Description.WsdlImporter> class.</span></span>  
  
2. <span data-ttu-id="2f1b2-279">Use o <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> método para verificar se um <xref:System.Runtime.Serialization.XsdDataContractImporter> foi definido.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-279">Use the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method to check whether an <xref:System.Runtime.Serialization.XsdDataContractImporter> has been defined.</span></span>  
  
3. <span data-ttu-id="2f1b2-280">Se o <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> método retornar `false` , crie um novo <xref:System.Runtime.Serialization.XsdDataContractImporter> e defina sua <xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> propriedade como uma nova instância da <xref:System.Runtime.Serialization.ImportOptions> classe.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-280">If the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method returns `false`, create a new <xref:System.Runtime.Serialization.XsdDataContractImporter> and set its <xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> property to a new instance of the <xref:System.Runtime.Serialization.ImportOptions> class.</span></span> <span data-ttu-id="2f1b2-281">Caso contrário, use o importador retornado pelo `out` parâmetro do <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-281">Otherwise, use the importer returned by the `out` parameter of the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method.</span></span>  
  
4. <span data-ttu-id="2f1b2-282">Se o <xref:System.Runtime.Serialization.XsdDataContractImporter> não tiver <xref:System.Runtime.Serialization.ImportOptions> definido, defina a propriedade como uma nova instância da <xref:System.Runtime.Serialization.ImportOptions> classe.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-282">If the <xref:System.Runtime.Serialization.XsdDataContractImporter> has no <xref:System.Runtime.Serialization.ImportOptions> defined, then set the property to be a new instance of the <xref:System.Runtime.Serialization.ImportOptions> class.</span></span>  
  
5. <span data-ttu-id="2f1b2-283">Defina a <xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> Propriedade do <xref:System.Runtime.Serialization.ImportOptions> de <xref:System.Runtime.Serialization.XsdDataContractImporter> para uma nova instância do substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-283">Set the <xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> property of the <xref:System.Runtime.Serialization.ImportOptions> of the <xref:System.Runtime.Serialization.XsdDataContractImporter> to a new instance of the surrogate.</span></span>  
  
6. <span data-ttu-id="2f1b2-284">Adicione o <xref:System.Runtime.Serialization.XsdDataContractImporter> à coleção retornada pela <xref:System.ServiceModel.Description.MetadataExporter.State%2A> Propriedade do <xref:System.ServiceModel.Description.WsdlImporter> (herdado da <xref:System.ServiceModel.Description.MetadataExporter> classe).</span><span class="sxs-lookup"><span data-stu-id="2f1b2-284">Add the <xref:System.Runtime.Serialization.XsdDataContractImporter> to the collection returned by the <xref:System.ServiceModel.Description.MetadataExporter.State%2A> property of the <xref:System.ServiceModel.Description.WsdlImporter> (inherited from the <xref:System.ServiceModel.Description.MetadataExporter> class.)</span></span>  
  
7. <span data-ttu-id="2f1b2-285">Use o <xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A> método do <xref:System.ServiceModel.Description.WsdlImporter> para importar todos os contratos de dados dentro do esquema.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-285">Use the <xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A> method of the <xref:System.ServiceModel.Description.WsdlImporter> to import all of the data contracts within the schema.</span></span> <span data-ttu-id="2f1b2-286">Durante a última etapa, o código é gerado a partir dos esquemas carregados chamando o substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-286">During the last step, code is generated from the schemas loaded by calling into the surrogate.</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#9)]  
  
### <a name="to-use-a-surrogate-for-metadata-export"></a><span data-ttu-id="2f1b2-287">Para usar um substituto para exportação de metadados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-287">To Use a surrogate for Metadata Export</span></span>  

 <span data-ttu-id="2f1b2-288">Por padrão, ao exportar metadados do WCF para um serviço, o esquema WSDL e XSD precisa ser gerado.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-288">By default, when exporting metadata from WCF for a service, both WSDL and XSD schema needs to be generated.</span></span> <span data-ttu-id="2f1b2-289">O substituto precisa ser adicionado ao componente responsável pela geração do esquema XSD para tipos de contrato de dados, <xref:System.Runtime.Serialization.XsdDataContractExporter> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-289">The surrogate needs to be added to the component responsible for generating XSD schema for data contract types, <xref:System.Runtime.Serialization.XsdDataContractExporter>.</span></span> <span data-ttu-id="2f1b2-290">Para fazer isso, use um comportamento que implementa <xref:System.ServiceModel.Description.IWsdlExportExtension> para modificar o <xref:System.ServiceModel.Description.WsdlExporter> , ou modifique diretamente o <xref:System.ServiceModel.Description.WsdlExporter> usado para exportar metadados.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-290">To do this, either use a behavior that implements <xref:System.ServiceModel.Description.IWsdlExportExtension> to modify the <xref:System.ServiceModel.Description.WsdlExporter>, or directly modify the <xref:System.ServiceModel.Description.WsdlExporter> used to export metadata.</span></span>  
  
##### <a name="to-use-a-surrogate-for-metadata-export"></a><span data-ttu-id="2f1b2-291">Para usar um substituto para exportação de metadados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-291">To use a surrogate for metadata export</span></span>  
  
1. <span data-ttu-id="2f1b2-292">Crie um novo <xref:System.ServiceModel.Description.WsdlExporter> ou use o `wsdlExporter` parâmetro passado para o <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-292">Create a new <xref:System.ServiceModel.Description.WsdlExporter> or use the `wsdlExporter` parameter passed to the <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> method.</span></span>  
  
2. <span data-ttu-id="2f1b2-293">Use a <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> função para verificar se um <xref:System.Runtime.Serialization.XsdDataContractExporter> foi definido.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-293">Use the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> function to check whether an <xref:System.Runtime.Serialization.XsdDataContractExporter> has been defined.</span></span>  
  
3. <span data-ttu-id="2f1b2-294">Se <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> retornar `false` , crie um novo <xref:System.Runtime.Serialization.XsdDataContractExporter> com os esquemas XML gerados do <xref:System.ServiceModel.Description.WsdlExporter> e adicione-o à coleção retornada pela <xref:System.ServiceModel.Description.MetadataExporter.State%2A> Propriedade do <xref:System.ServiceModel.Description.WsdlExporter> .</span><span class="sxs-lookup"><span data-stu-id="2f1b2-294">If <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> returns `false`, create a new <xref:System.Runtime.Serialization.XsdDataContractExporter> with the generated XML schemas from the <xref:System.ServiceModel.Description.WsdlExporter>, and add it to the collection returned by the <xref:System.ServiceModel.Description.MetadataExporter.State%2A> property of the <xref:System.ServiceModel.Description.WsdlExporter>.</span></span> <span data-ttu-id="2f1b2-295">Caso contrário, use o exportador retornado pelo `out` parâmetro do <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> método.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-295">Otherwise, use the exporter returned by the `out` parameter of the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method.</span></span>  
  
4. <span data-ttu-id="2f1b2-296">Se o <xref:System.Runtime.Serialization.XsdDataContractExporter> não tiver <xref:System.Runtime.Serialization.ExportOptions> definido, defina a <xref:System.Runtime.Serialization.XsdDataContractExporter.Options%2A> propriedade como uma nova instância da <xref:System.Runtime.Serialization.ExportOptions> classe.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-296">If the <xref:System.Runtime.Serialization.XsdDataContractExporter> has no <xref:System.Runtime.Serialization.ExportOptions> defined, then set the <xref:System.Runtime.Serialization.XsdDataContractExporter.Options%2A> property to a new instance of the <xref:System.Runtime.Serialization.ExportOptions> class.</span></span>  
  
5. <span data-ttu-id="2f1b2-297">Defina a <xref:System.Runtime.Serialization.ExportOptions.DataContractSurrogate%2A> Propriedade do <xref:System.Runtime.Serialization.ExportOptions> de <xref:System.Runtime.Serialization.XsdDataContractExporter> para uma nova instância do substituto.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-297">Set the <xref:System.Runtime.Serialization.ExportOptions.DataContractSurrogate%2A> property of the <xref:System.Runtime.Serialization.ExportOptions> of the <xref:System.Runtime.Serialization.XsdDataContractExporter> to a new instance of the surrogate.</span></span> <span data-ttu-id="2f1b2-298">As etapas subsequentes para exportar metadados não exigem nenhuma alteração.</span><span class="sxs-lookup"><span data-stu-id="2f1b2-298">Subsequent steps for exporting metadata do not require any changes.</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#10)]  
  
## <a name="see-also"></a><span data-ttu-id="2f1b2-299">Veja também</span><span class="sxs-lookup"><span data-stu-id="2f1b2-299">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Runtime.Serialization.IDataContractSurrogate>
- <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>
- <xref:System.Runtime.Serialization.ImportOptions>
- <xref:System.Runtime.Serialization.ExportOptions>
- [<span data-ttu-id="2f1b2-300">Usando contratos de dados</span><span class="sxs-lookup"><span data-stu-id="2f1b2-300">Using Data Contracts</span></span>](../feature-details/using-data-contracts.md)
