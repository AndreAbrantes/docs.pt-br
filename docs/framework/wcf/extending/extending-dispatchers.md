---
title: Estendendo distribuidores
ms.date: 03/30/2017
helpviewer_keywords:
- dispatcher extensions [WCF]
ms.assetid: d0ad15ac-fa12-4f27-80e8-7ac2271e5985
ms.openlocfilehash: fa9d5c40c2ae813493b3643048fa7eaba00c431d
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96273224"
---
# <a name="extending-dispatchers"></a><span data-ttu-id="b60f4-102">Estendendo distribuidores</span><span class="sxs-lookup"><span data-stu-id="b60f4-102">Extending Dispatchers</span></span>

<span data-ttu-id="b60f4-103">Os despachantes são responsáveis por extrair mensagens de entrada dos canais subjacentes, traduzi-las em invocações de método no código do aplicativo e enviar os resultados de volta para o chamador.</span><span class="sxs-lookup"><span data-stu-id="b60f4-103">Dispatchers are responsible for pulling incoming messages out of the underlying channels, translating them into method invocations in application code, and sending the results back to the caller.</span></span> <span data-ttu-id="b60f4-104">As extensões do Dispatcher permitem que você modifique esse processamento.</span><span class="sxs-lookup"><span data-stu-id="b60f4-104">Dispatcher extensions allow you to modify this processing.</span></span>  <span data-ttu-id="b60f4-105">Você pode implementar os inspetores de mensagem ou de parâmetro que inspecionam ou modificam o conteúdo de mensagens ou parâmetros.</span><span class="sxs-lookup"><span data-stu-id="b60f4-105">You can implement message or parameter inspectors that inspect or modify the contents of messages or parameters.</span></span>  <span data-ttu-id="b60f4-106">Você pode alterar a maneira como as mensagens são roteadas para operações ou fornecer outras funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="b60f4-106">You can change the way messages are routed to operations or provide some other functionality.</span></span>

<span data-ttu-id="b60f4-107">Este tópico descreve como usar as <xref:System.ServiceModel.Dispatcher.DispatchRuntime> classes e <xref:System.ServiceModel.Dispatcher.DispatchOperation> em um aplicativo de serviço Windows Communication Foundation (WCF) para modificar o comportamento de execução padrão de um Dispatcher ou para interceptar ou modificar mensagens, parâmetros ou valores de retorno antes ou depois de enviá-los ou recuperá-los da camada de canal.</span><span class="sxs-lookup"><span data-stu-id="b60f4-107">This topic describes how to use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes in a Windows Communication Foundation (WCF) service application to modify the default execution behavior of a dispatcher or to intercept or modify messages, parameters, or return values prior to or subsequent to sending or retrieving them from the channel layer.</span></span> <span data-ttu-id="b60f4-108">Para obter mais informações sobre o processamento de mensagens de tempo de execução de cliente equivalente, consulte [estendendo clientes](extending-clients.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-108">For more information about the equivalent client runtime message processing, see [Extending Clients](extending-clients.md).</span></span> <span data-ttu-id="b60f4-109">Para entender a função que os <xref:System.ServiceModel.IExtensibleObject%601> tipos desempenham no acesso ao estado compartilhado entre vários objetos de personalização de tempo de execução, consulte [objetos extensíveis](extensible-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-109">To understand the role that <xref:System.ServiceModel.IExtensibleObject%601> types play in accessing shared state between various runtime customization objects, see [Extensible Objects](extensible-objects.md).</span></span>

## <a name="dispatchers"></a><span data-ttu-id="b60f4-110">Dispatchers</span><span class="sxs-lookup"><span data-stu-id="b60f4-110">Dispatchers</span></span>

<span data-ttu-id="b60f4-111">A camada modelo de serviço executa a conversão entre o modelo de programação do desenvolvedor e a troca de mensagens subjacente, normalmente chamada de camada de canal.</span><span class="sxs-lookup"><span data-stu-id="b60f4-111">The service model layer performs the conversion between the developer’s programming model and the underlying message exchange, commonly called the channel layer.</span></span> <span data-ttu-id="b60f4-112">No WCF, os despachantes de canal e ponto de extremidade ( <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> e <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> , respectivamente) são os componentes de serviço responsáveis por aceitar novos canais, receber mensagens, despacho de operação e invocação e processamento de resposta.</span><span class="sxs-lookup"><span data-stu-id="b60f4-112">In WCF the channel and endpoint dispatchers (<xref:System.ServiceModel.Dispatcher.ChannelDispatcher> and <xref:System.ServiceModel.Dispatcher.EndpointDispatcher>, respectively) are the service components responsible for accepting new channels, receiving messages, operation dispatch and invocation, and response processing.</span></span> <span data-ttu-id="b60f4-113">Os objetos Dispatcher são objetos receptores, mas as implementações de contrato de retorno de chamada em serviços duplex também expõem seus objetos Dispatcher para inspeção, modificação ou extensão.</span><span class="sxs-lookup"><span data-stu-id="b60f4-113">Dispatcher objects are receiver objects, but callback contract implementations in duplex services also expose their dispatcher objects for inspection, modification, or extension.</span></span>

<span data-ttu-id="b60f4-114">O Dispatcher do canal (e Companion <xref:System.ServiceModel.Channels.IChannelListener> ) efetua pull de mensagens do canal em questão e passa as mensagens para seus respectivos distribuidores de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-114">The channel dispatcher (and companion <xref:System.ServiceModel.Channels.IChannelListener>) pulls messages out of the underling channel and passes the messages to their respective endpoint dispatchers.</span></span> <span data-ttu-id="b60f4-115">Cada Dispatcher de ponto de extremidade tem um <xref:System.ServiceModel.Dispatcher.DispatchRuntime> que roteia mensagens para o apropriado <xref:System.ServiceModel.Dispatcher.DispatchOperation> , que é responsável por chamar o método que implementa a operação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-115">Each endpoint dispatcher has a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> that routes messages to the appropriate <xref:System.ServiceModel.Dispatcher.DispatchOperation>, which is responsible for calling the method that implements the operation.</span></span> <span data-ttu-id="b60f4-116">Várias classes de extensão opcionais e obrigatórias são invocadas ao longo do caminho.</span><span class="sxs-lookup"><span data-stu-id="b60f4-116">Various optional and required extension classes are invoked along the way.</span></span> <span data-ttu-id="b60f4-117">Este tópico explica como essas partes se encaixam e como você pode modificar as propriedades e conectar seu próprio código para estender a funcionalidade base.</span><span class="sxs-lookup"><span data-stu-id="b60f4-117">This topic explains how these pieces fit together, and how you might modify properties and plug your own code in to extend the base functionality.</span></span>

<span data-ttu-id="b60f4-118">As propriedades do Dispatcher e os objetos de personalização modificados são inseridos usando objetos de comportamento de serviço, ponto de extremidade, contrato ou operação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-118">Dispatcher properties and modified customization objects are inserted by using service, endpoint, contract, or operation behavior objects.</span></span> <span data-ttu-id="b60f4-119">Este tópico não descreve como usar comportamentos.</span><span class="sxs-lookup"><span data-stu-id="b60f4-119">This topic does not describe how to use behaviors.</span></span> <span data-ttu-id="b60f4-120">Para obter mais informações sobre os tipos usados para inserir modificações do Dispatcher, consulte [Configurando e estendendo o tempo de execução com comportamentos](configuring-and-extending-the-runtime-with-behaviors.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-120">For more information about the types used to insert dispatcher modifications, see [Configuring and Extending the Runtime with Behaviors](configuring-and-extending-the-runtime-with-behaviors.md).</span></span>

<span data-ttu-id="b60f4-121">O gráfico a seguir fornece uma exibição de alto nível dos itens arquitetônicos em um serviço.</span><span class="sxs-lookup"><span data-stu-id="b60f4-121">The following graphic provides a high-level view of the architectural items in a service.</span></span>

<span data-ttu-id="b60f4-122">![A arquitetura de tempo de execução de despacho](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span><span class="sxs-lookup"><span data-stu-id="b60f4-122">![The dispatch runtime architecture](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span></span>

### <a name="channel-dispatchers"></a><span data-ttu-id="b60f4-123">Distribuidores de canal</span><span class="sxs-lookup"><span data-stu-id="b60f4-123">Channel Dispatchers</span></span>

<span data-ttu-id="b60f4-124">Um <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objeto é criado para associar um <xref:System.ServiceModel.Channels.IChannelListener> em um URI específico (chamado de URI de escuta) com uma instância de um serviço.</span><span class="sxs-lookup"><span data-stu-id="b60f4-124">A <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object is created to associate an <xref:System.ServiceModel.Channels.IChannelListener> at a particular URI (called a listen URI) with an instance of a service.</span></span> <span data-ttu-id="b60f4-125">Cada <xref:System.ServiceModel.ServiceHost> objeto pode ter muitos <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objetos, cada um associado a apenas um ouvinte e um URI de escuta.</span><span class="sxs-lookup"><span data-stu-id="b60f4-125">Each <xref:System.ServiceModel.ServiceHost> object can have many <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objects, each associated with only one listener and listen URI.</span></span> <span data-ttu-id="b60f4-126">Quando uma mensagem chega, o <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> consulta cada um dos <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objetos associados se o ponto de extremidade pode aceitar a mensagem e passa a mensagem para aquela que pode.</span><span class="sxs-lookup"><span data-stu-id="b60f4-126">When a message arrives, the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> queries each of the associated <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects whether the endpoint can accept the message, and passes the message to the one that can.</span></span>

<span data-ttu-id="b60f4-127">Todas as propriedades que controlam o tempo de vida e o comportamento de uma sessão de canal estão disponíveis para inspeção ou modificação no <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objeto.</span><span class="sxs-lookup"><span data-stu-id="b60f4-127">All properties that control the lifetime and behavior of a channel session are available for inspection or modification on the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object.</span></span> <span data-ttu-id="b60f4-128">Isso inclui inicializadores de canal personalizados, o ouvinte de canal, o host, o associado <xref:System.ServiceModel.InstanceContext> e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="b60f4-128">These include custom channel initializers, the channel listener, the host, the associated <xref:System.ServiceModel.InstanceContext>, and so on.</span></span>

### <a name="endpoint-dispatchers"></a><span data-ttu-id="b60f4-129">Despachantes de ponto de extremidade</span><span class="sxs-lookup"><span data-stu-id="b60f4-129">Endpoint Dispatchers</span></span>

<span data-ttu-id="b60f4-130">O <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objeto é responsável por processar mensagens de um <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> quando o endereço de destino de uma mensagem corresponde a <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> e a ação da mensagem corresponde à <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-130">The <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> object is responsible for processing messages from a <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> when the destination address of a message matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> and the message action matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A> property.</span></span> <span data-ttu-id="b60f4-131">Se dois <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objetos puderem aceitar uma mensagem, o <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> valor da propriedade determinará o ponto de extremidade de prioridade mais alta.</span><span class="sxs-lookup"><span data-stu-id="b60f4-131">If two <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects can accept a message, the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> property value determines the higher priority endpoint.</span></span>

<span data-ttu-id="b60f4-132">Use o <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> para adquirir os dois pontos principais de extensão do modelo de serviço – as <xref:System.ServiceModel.Dispatcher.DispatchRuntime> <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes e – que você pode usar para personalizar o processamento do Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="b60f4-132">Use the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> to acquire the two main service model extension points – the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes – that you can use to customize the processing of the dispatcher.</span></span> <span data-ttu-id="b60f4-133">A <xref:System.ServiceModel.Dispatcher.DispatchRuntime> classe permite que os usuários interceptem e estendam o Dispatcher no escopo do contrato (ou seja, para todas as mensagens em um contrato).</span><span class="sxs-lookup"><span data-stu-id="b60f4-133">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class allows users to intercept and extend the dispatcher at the contract scope (that is, for all messages in a contract).</span></span> <span data-ttu-id="b60f4-134">A <xref:System.ServiceModel.Dispatcher.DispatchOperation> classe permite que os usuários interceptem e estendam o Dispatcher em um escopo de operação (ou seja, para todas as mensagens em uma operação).</span><span class="sxs-lookup"><span data-stu-id="b60f4-134">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class allows users to intercept and extend the dispatcher at an operation scope (that is, for all messages in an operation).</span></span>

## <a name="scenarios"></a><span data-ttu-id="b60f4-135">Cenários</span><span class="sxs-lookup"><span data-stu-id="b60f4-135">Scenarios</span></span>

<span data-ttu-id="b60f4-136">Há vários motivos para estender o Dispatcher:</span><span class="sxs-lookup"><span data-stu-id="b60f4-136">There a number of reasons to extend the dispatcher:</span></span>

- <span data-ttu-id="b60f4-137">Validação de mensagem personalizada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-137">Custom Message Validation.</span></span> <span data-ttu-id="b60f4-138">Os usuários podem impor que uma mensagem seja válida para um determinado esquema.</span><span class="sxs-lookup"><span data-stu-id="b60f4-138">Users can enforce that a message is valid for a certain schema.</span></span> <span data-ttu-id="b60f4-139">Isso pode ser feito com a implementação das interfaces do interceptador de mensagens.</span><span class="sxs-lookup"><span data-stu-id="b60f4-139">This can be done by implementing the message interceptor interfaces.</span></span> <span data-ttu-id="b60f4-140">Para obter um exemplo, consulte [inspetores de mensagem](../samples/message-inspectors.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-140">For an example, see [Message Inspectors](../samples/message-inspectors.md).</span></span>

- <span data-ttu-id="b60f4-141">Log de mensagens personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-141">Custom Message Logging.</span></span> <span data-ttu-id="b60f4-142">Os usuários podem inspecionar e registrar um conjunto de mensagens de aplicativo que fluem por meio de um ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-142">Users can inspect and log some set of application messages that flow through an endpoint.</span></span> <span data-ttu-id="b60f4-143">Isso também pode ser feito com as interfaces do interceptador de mensagens.</span><span class="sxs-lookup"><span data-stu-id="b60f4-143">This can also be accomplished with the message interceptor interfaces.</span></span>

- <span data-ttu-id="b60f4-144">Transformações de mensagens personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b60f4-144">Custom Message Transformations.</span></span> <span data-ttu-id="b60f4-145">Os usuários podem aplicar determinadas transformações à mensagem no tempo de execução (por exemplo, para controle de versão).</span><span class="sxs-lookup"><span data-stu-id="b60f4-145">Users can apply certain transformations to the message in the runtime (for example, for versioning).</span></span> <span data-ttu-id="b60f4-146">Isso pode ser feito, novamente, com as interfaces do interceptador de mensagens.</span><span class="sxs-lookup"><span data-stu-id="b60f4-146">This can be accomplished, again, with the message interceptor interfaces.</span></span>

- <span data-ttu-id="b60f4-147">Modelo de dados personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-147">Custom Data Model.</span></span> <span data-ttu-id="b60f4-148">Os usuários podem ter um modelo de serialização de dados diferente daqueles com suporte por padrão no WCF (a saber,,, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType> e mensagens brutas).</span><span class="sxs-lookup"><span data-stu-id="b60f4-148">Users can have a data serialization model other than those supported by default in WCF (namely, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>, <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>, and raw messages).</span></span> <span data-ttu-id="b60f4-149">Isso pode ser feito implementando as interfaces de formatador de mensagem.</span><span class="sxs-lookup"><span data-stu-id="b60f4-149">This can be done by implement the message formatter interfaces.</span></span> <span data-ttu-id="b60f4-150">Para obter um exemplo, consulte [formatador de operação e seletor de operação](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-150">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="b60f4-151">Validação de parâmetro personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-151">Custom Parameter Validation.</span></span> <span data-ttu-id="b60f4-152">Os usuários podem impor que os parâmetros digitados sejam válidos (em oposição a XML).</span><span class="sxs-lookup"><span data-stu-id="b60f4-152">Users can enforce that typed parameters are valid (as opposed to XML).</span></span> <span data-ttu-id="b60f4-153">Isso pode ser feito usando as interfaces do Inspetor de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="b60f4-153">This can be done using the parameter inspector interfaces.</span></span>

- <span data-ttu-id="b60f4-154">Expedição da operação personalizada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-154">Custom Operation Dispatching.</span></span> <span data-ttu-id="b60f4-155">Os usuários podem implementar a expedição em algo diferente de Action – por exemplo, no elemento body ou em uma propriedade de mensagem personalizada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-155">Users can implement dispatching on something other than action – for example, on the body element, or on a custom message property.</span></span> <span data-ttu-id="b60f4-156">Isso pode ser feito usando a <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector> interface.</span><span class="sxs-lookup"><span data-stu-id="b60f4-156">This can be done using the <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector> interface.</span></span> <span data-ttu-id="b60f4-157">Para obter um exemplo, consulte [formatador de operação e seletor de operação](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-157">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="b60f4-158">Pool de objetos.</span><span class="sxs-lookup"><span data-stu-id="b60f4-158">Object Pooling.</span></span> <span data-ttu-id="b60f4-159">Os usuários podem agrupar instâncias em vez de alocar uma nova para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-159">Users can pool instances rather than allocating a new one for every call.</span></span> <span data-ttu-id="b60f4-160">Isso pode ser implementado usando as interfaces do provedor de instância.</span><span class="sxs-lookup"><span data-stu-id="b60f4-160">This can be implemented using the instance provider interfaces.</span></span> <span data-ttu-id="b60f4-161">Para obter um exemplo, consulte [pooling](../samples/pooling.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-161">For an example, see [Pooling](../samples/pooling.md).</span></span>

- <span data-ttu-id="b60f4-162">Concessão de instância.</span><span class="sxs-lookup"><span data-stu-id="b60f4-162">Instance Leasing.</span></span> <span data-ttu-id="b60f4-163">Os usuários podem implementar um padrão de concessão para o tempo de vida da instância, semelhante ao do .NET Framework comunicação remota.</span><span class="sxs-lookup"><span data-stu-id="b60f4-163">Users can implement a leasing pattern for instance lifetime, similar to that of .NET Framework Remoting.</span></span> <span data-ttu-id="b60f4-164">Isso pode ser feito usando as interfaces de tempo de vida do contexto de instância.</span><span class="sxs-lookup"><span data-stu-id="b60f4-164">This can be done using the instance context lifetime interfaces.</span></span>

- <span data-ttu-id="b60f4-165">Tratamento de erro personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-165">Custom Error Handling.</span></span> <span data-ttu-id="b60f4-166">Os usuários podem controlar como os erros locais são processados e como as falhas são comunicadas de volta para os clientes.</span><span class="sxs-lookup"><span data-stu-id="b60f4-166">Users can control how both local errors are processed and how faults are communicated back to clients.</span></span> <span data-ttu-id="b60f4-167">Isso pode ser implementado usando as <xref:System.ServiceModel.Dispatcher.IErrorHandler> interfaces do.</span><span class="sxs-lookup"><span data-stu-id="b60f4-167">This can be implemented using the <xref:System.ServiceModel.Dispatcher.IErrorHandler> interfaces.</span></span>

- <span data-ttu-id="b60f4-168">Comportamentos de autorização personalizados.</span><span class="sxs-lookup"><span data-stu-id="b60f4-168">Custom Authorization Behaviors.</span></span> <span data-ttu-id="b60f4-169">Os usuários podem implementar o controle de acesso personalizado estendendo as partes de tempo de execução do contrato ou da operação e adicionando verificações de segurança com base nos tokens presentes na mensagem.</span><span class="sxs-lookup"><span data-stu-id="b60f4-169">Users can implement custom access control by extending the Contract or Operation run-time pieces and adding security checks based upon the tokens present in the message.</span></span> <span data-ttu-id="b60f4-170">Isso pode ser feito usando as interfaces interceptador de mensagem ou interceptador de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="b60f4-170">This can be accomplished using either the message interceptor or parameter interceptor interfaces.</span></span> <span data-ttu-id="b60f4-171">Para obter exemplos, consulte [extensibilidade de segurança](../samples/security-extensibility.md).</span><span class="sxs-lookup"><span data-stu-id="b60f4-171">For examples, see [Security Extensibility](../samples/security-extensibility.md).</span></span>

  > [!CAUTION]
  > <span data-ttu-id="b60f4-172">Como alterar as propriedades de segurança tem o potencial de comprometer a segurança dos aplicativos WCF, é altamente recomendável que você realize modificações relacionadas à segurança com cuidado e teste exaustivamente antes da implantação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-172">Because altering security properties has the potential to compromise the security of WCF applications, it is strongly recommended that you undertake security-related modifications with care and test thoroughly prior to deployment.</span></span>

- <span data-ttu-id="b60f4-173">Validadores de tempo de execução WCF personalizados.</span><span class="sxs-lookup"><span data-stu-id="b60f4-173">Custom WCF Runtime Validators.</span></span> <span data-ttu-id="b60f4-174">Você pode instalar validadores personalizados que examinam serviços, contratos e associações para impor políticas de nível empresarial em relação a aplicativos WCF.</span><span class="sxs-lookup"><span data-stu-id="b60f4-174">You can install custom validators that examine services, contracts, and bindings to enforce enterprise-level policies with respect to WCF applications.</span></span> <span data-ttu-id="b60f4-175">(Por exemplo, consulte [como bloquear pontos de extremidade na empresa](how-to-lock-down-endpoints-in-the-enterprise.md).)</span><span class="sxs-lookup"><span data-stu-id="b60f4-175">(For example, see [How to: Lock Down Endpoints in the Enterprise](how-to-lock-down-endpoints-in-the-enterprise.md).)</span></span>

### <a name="using-the-dispatchruntime-class"></a><span data-ttu-id="b60f4-176">Usando a classe DispatchRuntime</span><span class="sxs-lookup"><span data-stu-id="b60f4-176">Using the DispatchRuntime Class</span></span>

<span data-ttu-id="b60f4-177">Use a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> classe para modificar o comportamento padrão de um serviço ou ponto de extremidade individual, ou para inserir objetos que implementam modificações personalizadas em um ou ambos os processos de serviço (ou processos de cliente no caso de um cliente duplex):</span><span class="sxs-lookup"><span data-stu-id="b60f4-177">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class either to modify the default behavior of a service or individual endpoint, or to insert objects that implement custom modifications to one or both of the following service processes (or client processes in the case of a duplex client):</span></span>

- <span data-ttu-id="b60f4-178">A transformação de mensagens de entrada em objetos e a liberação desses objetos como invocações de método em um objeto de serviço.</span><span class="sxs-lookup"><span data-stu-id="b60f4-178">The transformation of incoming messages into objects and releasing those objects as method invocations on a service object.</span></span>

- <span data-ttu-id="b60f4-179">A transformação de objetos recebidos da resposta a uma invocação de operação de serviço em mensagens de saída.</span><span class="sxs-lookup"><span data-stu-id="b60f4-179">The transformation of objects received from the response to a service operation invocation into outbound messages.</span></span>

<span data-ttu-id="b60f4-180">O <xref:System.ServiceModel.Dispatcher.DispatchRuntime> permite interceptar e estender o canal ou Dispatcher de ponto de extremidade para todas as mensagens em um determinado contrato, mesmo quando uma mensagem não é reconhecida.</span><span class="sxs-lookup"><span data-stu-id="b60f4-180">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> enables you to intercept and extend the channel or endpoint dispatcher for all messages across a particular contract, even when a message is not recognized.</span></span> <span data-ttu-id="b60f4-181">Quando uma mensagem chega que não corresponde a nenhum declarado no contrato, ela é expedida para a operação retornada pela <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-181">When a message arrives that does not match any declared in the contract it is dispatched to the operation returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A> property.</span></span> <span data-ttu-id="b60f4-182">Para interceptar ou estender todas as mensagens para uma operação específica, consulte a <xref:System.ServiceModel.Dispatcher.DispatchOperation> classe.</span><span class="sxs-lookup"><span data-stu-id="b60f4-182">To intercept or extend across all messages for a particular operation, see the <xref:System.ServiceModel.Dispatcher.DispatchOperation> class.</span></span>

<span data-ttu-id="b60f4-183">Há quatro áreas principais da extensibilidade do Dispatcher expostas pela <xref:System.ServiceModel.Dispatcher.DispatchRuntime> classe:</span><span class="sxs-lookup"><span data-stu-id="b60f4-183">There are four main areas of dispatcher extensibility exposed by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class:</span></span>

1. <span data-ttu-id="b60f4-184">Os componentes do canal usam as propriedades do <xref:System.ServiceModel.Dispatcher.DispatchRuntime> e do dispatcher do canal associado retornado pela <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A> propriedade para personalizar como o Dispatcher do canal aceita e fecha os canais.</span><span class="sxs-lookup"><span data-stu-id="b60f4-184">Channel components use the properties of the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and those of the associated channel dispatcher returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A> property to customize how the channel dispatcher accepts and closes channels.</span></span> <span data-ttu-id="b60f4-185">Essa categoria inclui as <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A> Propriedades e.</span><span class="sxs-lookup"><span data-stu-id="b60f4-185">This category includes the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> and <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A> properties.</span></span>

2. <span data-ttu-id="b60f4-186">Os componentes de mensagem são personalizados para cada mensagem processada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-186">Message components are customized for each message processed.</span></span> <span data-ttu-id="b60f4-187">Essa categoria inclui as <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A> <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A> Propriedades,, e <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A> .</span><span class="sxs-lookup"><span data-stu-id="b60f4-187">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A>, and the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A> properties.</span></span>

3. <span data-ttu-id="b60f4-188">Os componentes de instância personalizam a criação, o tempo de vida e a alienação de instâncias do tipo de serviço.</span><span class="sxs-lookup"><span data-stu-id="b60f4-188">Instance components customize the creation, lifetime, and disposal of instances of the service type.</span></span> <span data-ttu-id="b60f4-189">Para obter mais informações sobre tempos de vida de objeto de serviço, consulte a <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-189">For more information about service object lifetimes, see the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property.</span></span> <span data-ttu-id="b60f4-190">Essa categoria inclui as <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> Propriedades e <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A> .</span><span class="sxs-lookup"><span data-stu-id="b60f4-190">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> and the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A> properties.</span></span>

4. <span data-ttu-id="b60f4-191">Os componentes relacionados à segurança podem usar as seguintes propriedades:</span><span class="sxs-lookup"><span data-stu-id="b60f4-191">Security-related components can use the following properties:</span></span>

    - <span data-ttu-id="b60f4-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indica onde os eventos de auditoria são gravados.</span><span class="sxs-lookup"><span data-stu-id="b60f4-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indicates where audit events are written.</span></span>

    - <span data-ttu-id="b60f4-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controla se o serviço tenta representar usando as credenciais fornecidas pela mensagem de entrada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controls whether the service attempts to impersonate using the credentials provided by the incoming message.</span></span>

    - <span data-ttu-id="b60f4-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controla se os eventos de autenticação de mensagem bem-sucedidos são gravados no log de eventos especificado por <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> .</span><span class="sxs-lookup"><span data-stu-id="b60f4-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controls whether successful message authentication events are written to the event log specified by <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A>.</span></span>

    - <span data-ttu-id="b60f4-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controla como a <xref:System.Threading.Thread.CurrentPrincipal%2A> propriedade é definida.</span><span class="sxs-lookup"><span data-stu-id="b60f4-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controls how the <xref:System.Threading.Thread.CurrentPrincipal%2A> property is set.</span></span>

    - <span data-ttu-id="b60f4-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A> Especifica como a auditoria de eventos de autorização é executada.</span><span class="sxs-lookup"><span data-stu-id="b60f4-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A> specifies how the auditing of authorization events is performed.</span></span>

    - <span data-ttu-id="b60f4-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> Especifica se é para suprimir exceções não críticas que ocorrem durante o processo de log.</span><span class="sxs-lookup"><span data-stu-id="b60f4-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> specifies whether to suppress non-critical exceptions that occur during the logging process.</span></span>

<span data-ttu-id="b60f4-198">Normalmente, os objetos de extensão personalizados são atribuídos a uma <xref:System.ServiceModel.Dispatcher.DispatchRuntime> propriedade ou inseridos em uma coleção por um comportamento de serviço (um objeto que implementa <xref:System.ServiceModel.Description.IServiceBehavior> ), um comportamento de contrato (um objeto que implementa <xref:System.ServiceModel.Description.IContractBehavior> ) ou um comportamento de ponto de extremidade (um objeto que implementa <xref:System.ServiceModel.Description.IEndpointBehavior> ).</span><span class="sxs-lookup"><span data-stu-id="b60f4-198">Typically, custom extension objects are assigned to a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> property or inserted into a collection by a service behavior (an object that implements <xref:System.ServiceModel.Description.IServiceBehavior>), a contract behavior (an object that implements <xref:System.ServiceModel.Description.IContractBehavior>), or an endpoint behavior (an object that implements <xref:System.ServiceModel.Description.IEndpointBehavior>).</span></span> <span data-ttu-id="b60f4-199">Em seguida, o objeto de comportamento de instalação é adicionado à coleção apropriada de comportamentos de forma programática ou implementando um <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> objeto personalizado para permitir que o comportamento seja inserido usando um arquivo de configuração de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b60f4-199">Then the installing behavior object is added to the appropriate collection of behaviors either programmatically or by implementing a custom <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> object to enable the behavior to be inserted using an application configuration file.</span></span>

<span data-ttu-id="b60f4-200">Clientes duplex (clientes que implementam um contrato de retorno de chamada especificado por um serviço duplex) também têm um <xref:System.ServiceModel.Dispatcher.DispatchRuntime> objeto que pode ser acessado usando a <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="b60f4-200">Duplex clients (clients that implement a callback contract specified by a duplex service) also have a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> object that can be accessed using the <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> property.</span></span>

### <a name="using-the-dispatchoperation-class"></a><span data-ttu-id="b60f4-201">Usando a classe DispatchOperation</span><span class="sxs-lookup"><span data-stu-id="b60f4-201">Using the DispatchOperation Class</span></span>

<span data-ttu-id="b60f4-202">A <xref:System.ServiceModel.Dispatcher.DispatchOperation> classe é o local para modificações de tempo de execução e o ponto de inserção para extensões personalizadas que têm o escopo para apenas uma operação de serviço.</span><span class="sxs-lookup"><span data-stu-id="b60f4-202">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class is the location for run-time modifications and the insertion point for custom extensions that are scoped to only one service operation.</span></span> <span data-ttu-id="b60f4-203">(Para modificar o comportamento de tempo de execução de serviço para todas as mensagens em um contrato, use a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> classe.)</span><span class="sxs-lookup"><span data-stu-id="b60f4-203">(To modify service run-time behavior for all messages in a contract, use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class.)</span></span>

<span data-ttu-id="b60f4-204">Instalar <xref:System.ServiceModel.Dispatcher.DispatchOperation> modificações usando um objeto de comportamento de serviço personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-204">Install <xref:System.ServiceModel.Dispatcher.DispatchOperation> modifications using a custom service behavior object.</span></span>

<span data-ttu-id="b60f4-205">Use a <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> propriedade para localizar o <xref:System.ServiceModel.Dispatcher.DispatchOperation> objeto que representa uma operação de serviço específica.</span><span class="sxs-lookup"><span data-stu-id="b60f4-205">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> property to locate the <xref:System.ServiceModel.Dispatcher.DispatchOperation> object that represents a particular service operation.</span></span>

<span data-ttu-id="b60f4-206">As propriedades a seguir controlam a execução do tempo de execução no nível da operação:</span><span class="sxs-lookup"><span data-stu-id="b60f4-206">The following properties control runtime execution at the operation level:</span></span>

- <span data-ttu-id="b60f4-207">As <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A> <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A> Propriedades,, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A> ,, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A> <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> obtêm os respectivos valores para a operação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-207">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A>, and <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> properties obtain the respective values for the operation.</span></span>

- <span data-ttu-id="b60f4-208">O <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> especificam o comportamento da transação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-208">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> specify transaction behavior.</span></span>

- <span data-ttu-id="b60f4-209">As <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> Propriedades e controlam o tempo de vida do objeto de serviço definido pelo usuário em relação ao <xref:System.ServiceModel.InstanceContext> .</span><span class="sxs-lookup"><span data-stu-id="b60f4-209">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> properties control the lifetime of the user-defined service object relative to the <xref:System.ServiceModel.InstanceContext>.</span></span>

- <span data-ttu-id="b60f4-210">As <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A> <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A> Propriedades,, e <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> permitem o controle explícito sobre a conversão de mensagens para objetos e objetos em mensagens.</span><span class="sxs-lookup"><span data-stu-id="b60f4-210">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A>, and the <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> properties enable explicit control over the conversion from messages to objects and objects to messages.</span></span>

- <span data-ttu-id="b60f4-211">A <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> propriedade especifica o nível de representação da operação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-211">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> property specifies the operation impersonation level.</span></span>

- <span data-ttu-id="b60f4-212">A <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> Propriedade insere extensões de contexto de chamada personalizadas para a operação.</span><span class="sxs-lookup"><span data-stu-id="b60f4-212">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> property inserts custom call context extensions for the operation.</span></span>

- <span data-ttu-id="b60f4-213">A <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> propriedade controla quando objetos de parâmetro são destruídos.</span><span class="sxs-lookup"><span data-stu-id="b60f4-213">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> property controls when parameter objects are destroyed.</span></span>

- <span data-ttu-id="b60f4-214">A <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> propriedade para inserir um objeto chamador personalizado.</span><span class="sxs-lookup"><span data-stu-id="b60f4-214">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> property to insert a custom invoker object.</span></span>

- <span data-ttu-id="b60f4-215">A <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> propriedade permite que você insira um inspetor de parâmetro personalizado que você pode usar para inspecionar ou modificar parâmetros e retornar valores.</span><span class="sxs-lookup"><span data-stu-id="b60f4-215">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> property enables you to insert a custom parameter inspector that you can use to inspect or modify parameters and return values.</span></span>

## <a name="see-also"></a><span data-ttu-id="b60f4-216">Veja também</span><span class="sxs-lookup"><span data-stu-id="b60f4-216">See also</span></span>

- <xref:System.ServiceModel.Dispatcher.DispatchRuntime>
- <xref:System.ServiceModel.Dispatcher.DispatchOperation>
- [<span data-ttu-id="b60f4-217">Como: inspecionar e modificar mensagens do serviço</span><span class="sxs-lookup"><span data-stu-id="b60f4-217">How to: Inspect and Modify Messages on the Service</span></span>](how-to-inspect-and-modify-messages-on-the-service.md)
- [<span data-ttu-id="b60f4-218">Como: inspecionar ou modificar parâmetros</span><span class="sxs-lookup"><span data-stu-id="b60f4-218">How to: Inspect or Modify Parameters</span></span>](how-to-inspect-or-modify-parameters.md)
- [<span data-ttu-id="b60f4-219">Como: bloquear pontos de extremidade na empresa</span><span class="sxs-lookup"><span data-stu-id="b60f4-219">How to: Lock Down Endpoints in the Enterprise</span></span>](how-to-lock-down-endpoints-in-the-enterprise.md)
