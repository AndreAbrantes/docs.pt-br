---
title: Mpgo.exe (Ferramenta de Otimização Guiada por Perfil Gerenciado)
description: Use Mpgo.exe, a ferramenta de otimização guiada pelo perfil gerenciado. Com essa ferramenta, otimize os assemblies de imagem nativa criados pelo gerador de imagem nativa (Ngen.exe).
ms.date: 03/30/2017
helpviewer_keywords:
- Mpgo.exe
- training scenarios, generating profiles with
- Managed Profile Guided Optimization Tool
- Ngen.exe
- Ngen.exe, profilers and native images
ms.assetid: f6976502-a000-4fbe-aaf5-a7aab9ce4ec2
ms.openlocfilehash: 328c085035927b3f271a39a0ea3992dde29f5119
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96279097"
---
# <a name="mpgoexe-managed-profile-guided-optimization-tool"></a><span data-ttu-id="1cea6-104">Mpgo.exe (Ferramenta de Otimização Guiada por Perfil Gerenciado)</span><span class="sxs-lookup"><span data-stu-id="1cea6-104">Mpgo.exe (Managed Profile Guided Optimization Tool)</span></span>

<span data-ttu-id="1cea6-105">A Ferramenta de Otimização Guiada por Perfil Gerenciado (Mpgo.exe) é uma ferramenta de linha de comando que usa cenários de usuário final comuns para otimizar os assemblies de imagem nativa criados pelo [Gerador de Imagem Nativa (Ngen.exe)](ngen-exe-native-image-generator.md).</span><span class="sxs-lookup"><span data-stu-id="1cea6-105">The Managed Profile Guided Optimization Tool (Mpgo.exe) is a command-line tool that uses common end-user scenarios to optimize the native image assemblies that are created by the [Native Image Generator (Ngen.exe)](ngen-exe-native-image-generator.md).</span></span> <span data-ttu-id="1cea6-106">Essa ferramenta permite executar cenários de treinamento que geram dados de perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-106">This tool enables you to run training scenarios that generate profile data.</span></span> <span data-ttu-id="1cea6-107">O [Gerador de Imagem Nativa (Ngen.exe)](ngen-exe-native-image-generator.md) usa esses dados para otimizar seus assemblies de aplicativo de imagem nativa gerados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-107">The [Native Image Generator (Ngen.exe)](ngen-exe-native-image-generator.md) uses this data to optimize its generated native image application assemblies.</span></span> <span data-ttu-id="1cea6-108">Um cenário de treinamento é uma execução de avaliação de um uso esperado do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1cea6-108">A training scenario is a trial run of an expected use of your application.</span></span> <span data-ttu-id="1cea6-109">Mpgo.exe está disponível no Visual Studio Ultimate 2012 e em versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="1cea6-109">Mpgo.exe is available in Visual Studio Ultimate 2012 and later versions.</span></span> <span data-ttu-id="1cea6-110">A partir do Visual Studio 2013, você também pode usar Mpgo.exe para otimizar aplicativos da loja do Windows 8. x.</span><span class="sxs-lookup"><span data-stu-id="1cea6-110">Starting with Visual Studio 2013, you can also use Mpgo.exe to optimize Windows 8.x Store apps.</span></span>

<span data-ttu-id="1cea6-111">A otimização guiada por perfil melhora o tempo de inicialização do aplicativo, a utilização da memória (tamanho do conjunto de trabalho) e a taxa de transferência coletando-se dados de cenários de treinamento e usando-os para otimizar o layout de imagens nativas.</span><span class="sxs-lookup"><span data-stu-id="1cea6-111">Profile-guided optimization improves application startup time, memory utilization (working set size), and throughput by gathering data from training scenarios and using it to optimize the layout of native images.</span></span>

<span data-ttu-id="1cea6-112">Quando você encontrar problemas de desempenho em relação ao tempo de inicialização e ao tamanho do conjunto de trabalho para assemblies IL (Intermediate Language), será recomendável usar primeiro Ngen.exe para eliminar os custos de compilação JIT (just-in-time) e facilitar o compartilhamento de código.</span><span class="sxs-lookup"><span data-stu-id="1cea6-112">When you encounter performance issues with startup time and working set size for Intermediate Language (IL) assemblies, we recommend that you first use Ngen.exe to eliminate just-in-time (JIT) compilation costs and to facilitate code sharing.</span></span> <span data-ttu-id="1cea6-113">Se precisar de melhorias adicionais, você poderá usar Mpgo.exe para otimizar ainda mais o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1cea6-113">If you need additional improvements, you can then use Mpgo.exe to further optimize your application.</span></span> <span data-ttu-id="1cea6-114">É possível usar os dados de desempenho com base nos assemblies de imagem nativa não otimizados como uma linha de base para avaliar os ganhos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="1cea6-114">You can use the performance data from the un-optimized native image assemblies as a baseline to evaluate the performance gains.</span></span> <span data-ttu-id="1cea6-115">O uso de Mpgo.exe pode resultar em tempos de inicialização a frio mais rápidos e um tamanho do conjunto de trabalho menor.</span><span class="sxs-lookup"><span data-stu-id="1cea6-115">Using Mpgo.exe may result in faster cold startup times and a smaller working set size.</span></span> <span data-ttu-id="1cea6-116">Mpgo.exe adiciona informações a assemblies IL usados por Ngen.exe para criar assemblies de imagem nativa otimizados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-116">Mpgo.exe adds information to IL assemblies that Ngen.exe uses to create optimized native image assemblies.</span></span> <span data-ttu-id="1cea6-117">Para obter mais informações, consulte a entrada [Improving Launch Performance for your Desktop Applications](https://devblogs.microsoft.com/dotnet/improving-launch-performance-for-your-desktop-applications/) (Melhorando o Desempenho de Inicialização dos Aplicativos de Área de Trabalho) no blog do .NET.</span><span class="sxs-lookup"><span data-stu-id="1cea6-117">For more information, see the entry [Improving Launch Performance for your Desktop Applications](https://devblogs.microsoft.com/dotnet/improving-launch-performance-for-your-desktop-applications/) in the .NET blog.</span></span>

<span data-ttu-id="1cea6-118">Essa ferramenta é instalada automaticamente com o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1cea6-118">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="1cea6-119">Para executar a ferramenta, use o Prompt de Comando do Desenvolvedor (ou o Prompt de Comando do Visual Studio no Windows 7) com credenciais de administrador e digite o seguinte no prompt de comando.</span><span class="sxs-lookup"><span data-stu-id="1cea6-119">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7) with administrator credentials, and type the following at the command prompt.</span></span> <span data-ttu-id="1cea6-120">Para obter mais informações, consulte [Prompts de Comando](developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="1cea6-120">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="1cea6-121">Para aplicativos de área de trabalho:</span><span class="sxs-lookup"><span data-stu-id="1cea6-121">For desktop apps:</span></span>

```console
mpgo –Scenario <command> [-Import <directory>] –AssemblyList <assembly1>  <assembly2> ... -OutDir <directory> [options]
```

<span data-ttu-id="1cea6-122">Para aplicativos da loja do Windows 8. x:</span><span class="sxs-lookup"><span data-stu-id="1cea6-122">For Windows 8.x Store apps:</span></span>

## <a name="syntax"></a><span data-ttu-id="1cea6-123">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="1cea6-123">Syntax</span></span>

```console
mpgo –Scenario <packageName> -AppID <appId> -Timeout <seconds>
```

## <a name="parameters"></a><span data-ttu-id="1cea6-124">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="1cea6-124">Parameters</span></span>

 <span data-ttu-id="1cea6-125">Todos os argumentos para Mpgo.exe não diferenciam maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="1cea6-125">All arguments to Mpgo.exe are case-insensitive.</span></span> <span data-ttu-id="1cea6-126">Os comandos são prefixados com um traço.</span><span class="sxs-lookup"><span data-stu-id="1cea6-126">Commands are prefixed with a dash.</span></span>

> [!NOTE]
> <span data-ttu-id="1cea6-127">É possível usar `–Scenario` ou `–Import` como um comando exigido, mas não ambos.</span><span class="sxs-lookup"><span data-stu-id="1cea6-127">You can use either `–Scenario` or `–Import` as a required command, but not both.</span></span> <span data-ttu-id="1cea6-128">Nenhum dos parâmetros obrigatórios será usado se você especificar a opção `–Reset`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-128">None of the required parameters are used if you specify the `–Reset` option.</span></span>

|<span data-ttu-id="1cea6-129">Parâmetro obrigatório</span><span class="sxs-lookup"><span data-stu-id="1cea6-129">Required parameter</span></span>|<span data-ttu-id="1cea6-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="1cea6-130">Description</span></span>|
|------------------------|-----------------|
|<span data-ttu-id="1cea6-131">`-Scenario` \<*command*></span><span class="sxs-lookup"><span data-stu-id="1cea6-131">`-Scenario` \<*command*></span></span><br /><br /> <span data-ttu-id="1cea6-132">— ou —</span><span class="sxs-lookup"><span data-stu-id="1cea6-132">—or—</span></span><br /><br /> <span data-ttu-id="1cea6-133">`-Scenario` \<*packageName*></span><span class="sxs-lookup"><span data-stu-id="1cea6-133">`-Scenario` \<*packageName*></span></span><br /><br /> <span data-ttu-id="1cea6-134">-ou-</span><span class="sxs-lookup"><span data-stu-id="1cea6-134">-or-</span></span><br /><br /> <span data-ttu-id="1cea6-135">`-Import` \<*directory*></span><span class="sxs-lookup"><span data-stu-id="1cea6-135">`-Import` \<*directory*></span></span>|<span data-ttu-id="1cea6-136">Para aplicativos de área de trabalho, use `–Scenario` para especificar o comando para executar o aplicativo que você deseja otimizar, inclusive todos os argumentos de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="1cea6-136">For desktop apps, use `–Scenario` to specify the command to run the application you want to optimize, including any command-line arguments.</span></span> <span data-ttu-id="1cea6-137">Use três conjuntos de aspas duplas em torno do *comando* caso ele especifique um caminho que inclua espaços, por exemplo: `mpgo.exe -scenario """C:\My App\myapp.exe""" -assemblylist """C:\My App\myapp.exe""" -outdir "C:\optimized files"`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-137">Use three sets of double quotation marks around *command* if it specifies a path that includes spaces; for example: `mpgo.exe -scenario """C:\My App\myapp.exe""" -assemblylist """C:\My App\myapp.exe""" -outdir "C:\optimized files"`.</span></span> <span data-ttu-id="1cea6-138">Não use aspas duplas; elas não funcionarão corretamente se o *comando* incluir espaços.</span><span class="sxs-lookup"><span data-stu-id="1cea6-138">Do not use double quotation marks; they will not work correctly if *command* includes spaces.</span></span><br /><br /> <span data-ttu-id="1cea6-139">-ou-</span><span class="sxs-lookup"><span data-stu-id="1cea6-139">-or-</span></span><br /><br /> <span data-ttu-id="1cea6-140">Para aplicativos da loja do Windows 8. x, use `–Scenario` para especificar o pacote para o qual você deseja gerar informações de perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-140">For Windows 8.x Store apps, use `–Scenario` to specify the package that you want to generate profile information for.</span></span> <span data-ttu-id="1cea6-141">Se você especificar o nome para exibição do pacote ou o nome da família de pacotes, e não o nome do pacote completo, Mpgo.exe selecionará o pacote correspondente ao nome fornecido se houver apenas uma correspondência.</span><span class="sxs-lookup"><span data-stu-id="1cea6-141">If you specify the package display name or the package family name instead of the full package name, Mpgo.exe will select the package that matches the name you provided if there is only one match.</span></span> <span data-ttu-id="1cea6-142">Se vários pacotes corresponderem ao nome especificado, Mpgo.exe solicitará que você escolha um pacote.</span><span class="sxs-lookup"><span data-stu-id="1cea6-142">If multiple packages match the specified name, Mpgo.exe will prompt you to choose a package.</span></span><br /><br /> <span data-ttu-id="1cea6-143">— ou —</span><span class="sxs-lookup"><span data-stu-id="1cea6-143">—or—</span></span><br /><br /> <span data-ttu-id="1cea6-144">Use `-Import` para especificar que os dados de otimização dos assemblies otimizados anteriormente devem ser usados para otimizar os assemblies em `-AssemblyList`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-144">Use `-Import` to specify that optimization data from previously optimized assemblies should be used to optimize the assemblies in `-AssemblyList`.</span></span> <span data-ttu-id="1cea6-145">*diretório* especifica o diretório que contém os arquivos otimizados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="1cea6-145">*directory* specifies the directory that contains the previously optimized files.</span></span> <span data-ttu-id="1cea6-146">Os assemblies especificados em `–AssemblyList` ou `–AssemblyListFile` são as novas versões dos assemblies que serão otimizados usando os dados dos arquivos importados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-146">The assemblies specified in `–AssemblyList` or `–AssemblyListFile` are the new versions of the assemblies to be optimized using the data from the imported files.</span></span> <span data-ttu-id="1cea6-147">O uso dos dados de otimização da versão anterior dos assemblies permite otimizar versões mais recentes de assemblies sem executar novamente o cenário.</span><span class="sxs-lookup"><span data-stu-id="1cea6-147">Using optimization data from older version of assemblies enables you to optimize newer versions of assemblies without re-running the scenario.</span></span>  <span data-ttu-id="1cea6-148">No entanto, se os assemblies importados e de destino incluírem um código bem diferente, os dados de otimização serão ineficazes.</span><span class="sxs-lookup"><span data-stu-id="1cea6-148">However, if the imported and target assemblies include significantly different code, the optimization data will be ineffective.</span></span> <span data-ttu-id="1cea6-149">Os nomes de assembly especificados em `–AssemblyList` ou `–AssemblyListFile` devem estar presentes no diretório especificado por `–Import`*directory*.</span><span class="sxs-lookup"><span data-stu-id="1cea6-149">The assembly names specified in `–AssemblyList` or `–AssemblyListFile` must be present in the directory specified by `–Import`*directory*.</span></span> <span data-ttu-id="1cea6-150">Use três conjuntos de aspas duplas em torno de *diretório* caso ele especifique um caminho que inclua espaços.</span><span class="sxs-lookup"><span data-stu-id="1cea6-150">Use three sets of double quotation marks around *directory* if it specifies a path that includes spaces.</span></span><br /><br /> <span data-ttu-id="1cea6-151">Você deve especificar `–Scenario` ou `–Import`, mas não ambos os parâmetros.</span><span class="sxs-lookup"><span data-stu-id="1cea6-151">You must specify either `–Scenario` or `–Import`, but not both parameters.</span></span>|
|<span data-ttu-id="1cea6-152">`-OutDir` \<*directory*></span><span class="sxs-lookup"><span data-stu-id="1cea6-152">`-OutDir` \<*directory*></span></span>|<span data-ttu-id="1cea6-153">O diretório no qual os assemblies otimizados devem ser colocados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-153">The directory in which to place the optimized assemblies.</span></span> <span data-ttu-id="1cea6-154">Se um assembly já existir na pasta do diretório de saída, uma nova cópia será criada e um número de índice será acrescentado ao nome, por exemplo: *assemblyname*-1.exe.</span><span class="sxs-lookup"><span data-stu-id="1cea6-154">If an assembly already exists in the output directory folder, a new copy is created and an index number is appended to its name; for example: *assemblyname*-1.exe.</span></span> <span data-ttu-id="1cea6-155">Use aspas duplas em torno de *directory* caso ele especifique um caminho que contenha espaços.</span><span class="sxs-lookup"><span data-stu-id="1cea6-155">Use double quotation marks around *directory* if it specifies a path that contains spaces.</span></span>|
|<span data-ttu-id="1cea6-156">`-AssemblyList` \<*assembly1 assembly2 ...*></span><span class="sxs-lookup"><span data-stu-id="1cea6-156">`-AssemblyList` \<*assembly1 assembly2 ...*></span></span><br /><br /> <span data-ttu-id="1cea6-157">— ou —</span><span class="sxs-lookup"><span data-stu-id="1cea6-157">—or—</span></span><br /><br /> <span data-ttu-id="1cea6-158">`-AssemblyListFile` \<*file*></span><span class="sxs-lookup"><span data-stu-id="1cea6-158">`-AssemblyListFile` \<*file*></span></span>|<span data-ttu-id="1cea6-159">Uma lista de assemblies (incluindo arquivos .exe e .dll), separados por espaços, cujas informações de perfil você deseja coletar.</span><span class="sxs-lookup"><span data-stu-id="1cea6-159">A list of assemblies (including .exe and .dll files), separated by spaces, that you want collect profile information about.</span></span> <span data-ttu-id="1cea6-160">É possível especificar `C:\Dir\*.dll` ou `*.dll` para selecionar todos os assemblies no diretório de trabalho designado ou atual.</span><span class="sxs-lookup"><span data-stu-id="1cea6-160">You can specify `C:\Dir\*.dll` or `*.dll` to select all the assemblies in the designated or current working directory.</span></span> <span data-ttu-id="1cea6-161">Consulte a seção Comentários para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="1cea6-161">See the Remarks section for more information.</span></span><br /><br /> <span data-ttu-id="1cea6-162">— ou —</span><span class="sxs-lookup"><span data-stu-id="1cea6-162">—or—</span></span><br /><br /> <span data-ttu-id="1cea6-163">Um arquivo de texto que contém a lista de assemblies cujas informações de perfil você deseja coletar, um assembly listado por linha.</span><span class="sxs-lookup"><span data-stu-id="1cea6-163">A text file that contains the list of assemblies you want to collect profile information about, listed one assembly per line.</span></span> <span data-ttu-id="1cea6-164">Se um nome de assembly começar com um hífen (-), use uma lista de arquivos de assembly ou renomeie o assembly.</span><span class="sxs-lookup"><span data-stu-id="1cea6-164">If an assembly name begins with a hyphen (-), use an assembly file list or rename the assembly.</span></span>|
|<span data-ttu-id="1cea6-165">`-AppID` \<*appId*></span><span class="sxs-lookup"><span data-stu-id="1cea6-165">`-AppID` \<*appId*></span></span>|<span data-ttu-id="1cea6-166">A ID do aplicativo no pacote especificado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-166">The ID of the application in the specified package.</span></span> <span data-ttu-id="1cea6-167">Se você usar o curinga ( \* ), Mpgo.exe tentará enumerar as APPIDs no pacote e voltará para o \<*package_family_name*> ! Aplicativo se falhar.</span><span class="sxs-lookup"><span data-stu-id="1cea6-167">If you use the wildcard (\*), Mpgo.exe will try to enumerate the AppIDs in the package and will fall back to \<*package_family_name*>!App if it fails.</span></span> <span data-ttu-id="1cea6-168">Se você especificar uma cadeia de caracteres prefixada por um ponto de exclamação (!), Mpgo.exe concatenará o nome da família de pacotes com o argumento fornecido.</span><span class="sxs-lookup"><span data-stu-id="1cea6-168">If you specify a string that is prefixed by an exclamation point (!), Mpgo.exe will concatenate the package family name with the argument provided.</span></span>|
|<span data-ttu-id="1cea6-169">`-Timeout` \<*seconds*></span><span class="sxs-lookup"><span data-stu-id="1cea6-169">`-Timeout` \<*seconds*></span></span>|<span data-ttu-id="1cea6-170">A quantidade de tempo para permitir que o aplicativo da loja do Windows 8. x seja executado antes de o aplicativo ser encerrado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-170">The amount of time to allow the Windows 8.x Store app to run before the app exits.</span></span>|

|<span data-ttu-id="1cea6-171">Parâmetro opcional</span><span class="sxs-lookup"><span data-stu-id="1cea6-171">Optional parameter</span></span>|<span data-ttu-id="1cea6-172">Descrição</span><span class="sxs-lookup"><span data-stu-id="1cea6-172">Description</span></span>|
|------------------------|-----------------|
|`-64bit`|<span data-ttu-id="1cea6-173">Implementa os assemblies para sistemas 64 bits.</span><span class="sxs-lookup"><span data-stu-id="1cea6-173">Instruments the assemblies for 64-bit systems.</span></span>  <span data-ttu-id="1cea6-174">Você deve especificar esse parâmetro para assemblies 64 bits, mesmo que o assembly se declare como sendo 64 bits.</span><span class="sxs-lookup"><span data-stu-id="1cea6-174">You must specify this parameter for 64-bit assemblies, even if your assembly declares itself as 64 bit.</span></span>|
|<span data-ttu-id="1cea6-175">`-ExeConfig` \<*filename*></span><span class="sxs-lookup"><span data-stu-id="1cea6-175">`-ExeConfig` \<*filename*></span></span>|<span data-ttu-id="1cea6-176">Especifica o arquivo de configuração usado pelo cenário para fornecer as informações de versão e carregador.</span><span class="sxs-lookup"><span data-stu-id="1cea6-176">Specifies the configuration file that your scenario uses to provide version and loader information.</span></span>|
|`-f`|<span data-ttu-id="1cea6-177">Força a inclusão dos dados de perfil em um assembly binário, mesmo que esteja assinado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-177">Forces the inclusion of the profile data in a binary assembly, even if it's signed.</span></span>  <span data-ttu-id="1cea6-178">Se o assembly estiver assinado, ele deverá ser assinado novamente; do contrário, o assembly não será carregado e executado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-178">If the assembly is signed, it must be re-signed; otherwise, the assembly will fail to load and run.</span></span>|
|`-Reset`|<span data-ttu-id="1cea6-179">Redefine o ambiente para garantir que uma sessão de criação de perfil anulada não afete os assemblies e, em seguida, sai.</span><span class="sxs-lookup"><span data-stu-id="1cea6-179">Resets the environment to make certain that an aborted profiling session doesn't affect your assemblies, and then quits.</span></span> <span data-ttu-id="1cea6-180">O ambiente é redefinido por padrão antes e depois de uma sessão de criação de perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-180">The environment is reset by default before and after a profiling session.</span></span>|
|<span data-ttu-id="1cea6-181">`-Timeout` \<*time in seconds*></span><span class="sxs-lookup"><span data-stu-id="1cea6-181">`-Timeout` \<*time in seconds*></span></span>|<span data-ttu-id="1cea6-182">Especifica a duração da criação de perfil em segundos.</span><span class="sxs-lookup"><span data-stu-id="1cea6-182">Specifies the profiling duration in seconds.</span></span> <span data-ttu-id="1cea6-183">Use um valor que seja um pouco maior do que os tempos de inicialização observados para aplicativos GUI.</span><span class="sxs-lookup"><span data-stu-id="1cea6-183">Use a value that is slightly more than your observed startup times for GUI applications.</span></span> <span data-ttu-id="1cea6-184">Ao final do período de tempo limite, os dados de perfil são registrados, ainda que o aplicativo continue sendo executado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-184">At the end of the time-out period, the profile data is recorded although the application continues to run.</span></span> <span data-ttu-id="1cea6-185">Se você não definir essa opção, a criação de perfil continuará até o desligamento do aplicativo, quando os dados serão gravados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-185">If you don't set this option, profiling will continue until application shutdown, at which time the data will be recorded.</span></span>|
|`-LeaveNativeImages`|<span data-ttu-id="1cea6-186">Especifica que as imagens nativas instrumentadas não devem ser removidas após a execução do cenário.</span><span class="sxs-lookup"><span data-stu-id="1cea6-186">Specifies that the instrumented native images shouldn't be removed after running the scenario.</span></span> <span data-ttu-id="1cea6-187">Essa opção é usada principalmente quando você está obtendo o aplicativo especificado para a execução do cenário.</span><span class="sxs-lookup"><span data-stu-id="1cea6-187">This option is primarily used when you're getting the application that you specified for the scenario running.</span></span> <span data-ttu-id="1cea6-188">Isso evitará a recriação de imagens nativas para execuções subsequentes de Mpgo.exe.</span><span class="sxs-lookup"><span data-stu-id="1cea6-188">It will prevent the recreation of native images for subsequent runs of Mpgo.exe.</span></span> <span data-ttu-id="1cea6-189">Quando você terminar de executar o aplicativo, talvez haja imagens nativas órfãs no cache caso você especifique essa opção.</span><span class="sxs-lookup"><span data-stu-id="1cea6-189">When you have finished running your application, there may be orphaned native images in the cache if you specify this option.</span></span> <span data-ttu-id="1cea6-190">Nesse caso, execute Mpgo.exe com o mesmo cenário e a mesma lista de assemblies e use o parâmetro `–RemoveNativeImages` para remover essas imagens nativas.</span><span class="sxs-lookup"><span data-stu-id="1cea6-190">In this case, run Mpgo.exe with the same scenario and assembly list and use the `–RemoveNativeImages` parameter to remove these native images.</span></span>|
|`-RemoveNativeImages`|<span data-ttu-id="1cea6-191">Limpa uma execução em que `–LeaveNativeImages` foi especificado.</span><span class="sxs-lookup"><span data-stu-id="1cea6-191">Cleans up from a run where `–LeaveNativeImages` was specified.</span></span> <span data-ttu-id="1cea6-192">Se você especificar `-RemoveNativeImages`, Mpgo.exe ignorará todos os argumentos, exceto `-64bit` e `–AssemblyList` e sairá depois da remoção de todas as imagens nativas instrumentadas.</span><span class="sxs-lookup"><span data-stu-id="1cea6-192">If you specify `-RemoveNativeImages`, Mpgo.exe ignores any arguments except `-64bit` and `–AssemblyList`, and exits after removing all instrumented native images.</span></span>|

## <a name="remarks"></a><span data-ttu-id="1cea6-193">Comentários</span><span class="sxs-lookup"><span data-stu-id="1cea6-193">Remarks</span></span>

 <span data-ttu-id="1cea6-194">É possível usar `–AssemblyList` e `- AssemblyListFile` várias vezes na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="1cea6-194">You can use both `–AssemblyList` and `- AssemblyListFile` multiple times on the command line.</span></span>

 <span data-ttu-id="1cea6-195">Se você não especificar nomes de caminho completos ao especificar assemblies, Mpgo.exe examinará o diretório atual.</span><span class="sxs-lookup"><span data-stu-id="1cea6-195">If you do not specify full path names when specifying assemblies, Mpgo.exe looks in the current directory.</span></span> <span data-ttu-id="1cea6-196">Se você especificar um caminho incorreto, Mpgo.exe exibirá uma mensagem de erro, mas continuará gerando dados para outros assemblies.</span><span class="sxs-lookup"><span data-stu-id="1cea6-196">If you specify an incorrect path, Mpgo.exe displays an error message but continues to generate data for other assemblies.</span></span> <span data-ttu-id="1cea6-197">Se você especificar um assembly não carregado durante o cenário de treinamento, nenhum dado de treinamento será gerado para esse assembly.</span><span class="sxs-lookup"><span data-stu-id="1cea6-197">If you specify an assembly that is not loaded during the training scenario, no training data is generated for that assembly.</span></span>

 <span data-ttu-id="1cea6-198">Se um assembly na lista estiver no cache de assembly global, ele não será atualizado para conter informações de perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-198">If an assembly in the list is in the global assembly cache, it will not be updated to contain the profile information.</span></span>  <span data-ttu-id="1cea6-199">Remova-o do cache de assembly global para coletar informações de perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-199">Remove it from the global assembly cache to collect profile information.</span></span>

 <span data-ttu-id="1cea6-200">O uso de Ngen.exe e Mpgo.exe só é recomendado para grandes aplicativos gerenciados, porque o benefício de imagens nativas pré-compiladas só costuma ser visto quando elimina uma compilação JIT significativa no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="1cea6-200">The use of Ngen.exe and Mpgo.exe is recommended only for large managed applications, because the benefit of precompiled native images is typically seen only when it eliminates significant JIT compilation at run time.</span></span> <span data-ttu-id="1cea6-201">A execução de Mpgo.exe em aplicativos ao estilo “Olá, Mundo” que não usam muito conjunto de trabalho não oferecerá nenhum benefício e Mpgo.exe pode até mesmo falhar na coleta de dados do perfil.</span><span class="sxs-lookup"><span data-stu-id="1cea6-201">Running Mpgo.exe on "Hello World" style applications that aren’t working-set intensive will not provide any benefits, and Mpgo.exe may even fail to gather profile data.</span></span>

> [!NOTE]
> <span data-ttu-id="1cea6-202">Ngen.exe e Mpgo.exe não são recomendados para aplicativos do ASP.NET e serviços do WCF (Windows Communication Foundation).</span><span class="sxs-lookup"><span data-stu-id="1cea6-202">Ngen.exe and Mpgo.exe are not recommended for ASP.NET applications and Windows Communication Foundation (WCF) services.</span></span>

## <a name="to-use-mpgoexe"></a><span data-ttu-id="1cea6-203">Para Usar Mpgo.exe</span><span class="sxs-lookup"><span data-stu-id="1cea6-203">To Use Mpgo.exe</span></span>

1. <span data-ttu-id="1cea6-204">Use um computador que tenha o Visual Studio Ultimate 2012 e o aplicativo instalados.</span><span class="sxs-lookup"><span data-stu-id="1cea6-204">Use a computer that has the Visual Studio Ultimate 2012 and your application installed.</span></span>

2. <span data-ttu-id="1cea6-205">Execute Mpgo.exe como um administrador com os parâmetros necessários.</span><span class="sxs-lookup"><span data-stu-id="1cea6-205">Run Mpgo.exe as an administrator with the necessary parameters.</span></span>  <span data-ttu-id="1cea6-206">Consulte a próxima seção para ver comandos de exemplo.</span><span class="sxs-lookup"><span data-stu-id="1cea6-206">See the next section for sample commands.</span></span>

     <span data-ttu-id="1cea6-207">Os assemblies IL (linguagem intermediária) otimizados são criados na pasta especificada pelo parâmetro `–OutDir` (nos exemplos, essa é a pasta `C:\Optimized`).</span><span class="sxs-lookup"><span data-stu-id="1cea6-207">The optimized intermediate language (IL) assemblies are created in the folder specified by the `–OutDir` parameter (in the examples, this is the `C:\Optimized` folder).</span></span>

3. <span data-ttu-id="1cea6-208">Substitua os assemblies IL usados em Ngen.exe pelos novos assemblies IL que contêm as informações de perfil do diretório especificado por `–OutDir`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-208">Replace the IL assemblies you used for Ngen.exe  with the new IL assemblies that contain the profile information from the directory specified by `–OutDir`.</span></span>

4. <span data-ttu-id="1cea6-209">A configuração do aplicativo (usando as imagens fornecidas por Mpgo.exe) instalará imagens nativas otimizadas.</span><span class="sxs-lookup"><span data-stu-id="1cea6-209">The application setup (using the images provided by Mpgo.exe) will install optimized native images.</span></span>

## <a name="suggested-workflow"></a><span data-ttu-id="1cea6-210">Fluxo de Trabalho Sugerido</span><span class="sxs-lookup"><span data-stu-id="1cea6-210">Suggested Workflow</span></span>

1. <span data-ttu-id="1cea6-211">Crie um conjunto de assemblies IL otimizados usando Mpgo.exe com o parâmetro `–Scenario`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-211">Create a set of optimized IL assemblies by using Mpgo.exe with the `–Scenario` parameter.</span></span>

2. <span data-ttu-id="1cea6-212">Verifique os assemblies IL otimizados no controle do código-fonte.</span><span class="sxs-lookup"><span data-stu-id="1cea6-212">Check the optimized IL assemblies into source control.</span></span>

3. <span data-ttu-id="1cea6-213">No processo de build, chame Mpgo.exe com o parâmetro `–Import` como uma etapa pós-build para gerar imagens IL otimizadas para passar para o Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="1cea6-213">In the build process, call Mpgo.exe with the `–Import` parameter as a post-build step to generate optimized IL images to pass to Ngen.exe.</span></span>

 <span data-ttu-id="1cea6-214">Esse processo garante que todos os assemblies tenham dados de otimização.</span><span class="sxs-lookup"><span data-stu-id="1cea6-214">This process ensures that all assemblies have optimization data.</span></span> <span data-ttu-id="1cea6-215">Se você fizer check-in de assemblies otimizados atualizados (etapas 1 e 2) mais frequentemente, os números de desempenho serão mais consistentes durante todo o desenvolvimento do produto.</span><span class="sxs-lookup"><span data-stu-id="1cea6-215">If you check in updated optimized assemblies (steps 1 and 2) more frequently, the performance numbers will be more consistent throughout product development.</span></span>

## <a name="using-mpgoexe-from-visual-studio"></a><span data-ttu-id="1cea6-216">Usando Mpgo.exe com base no Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1cea6-216">Using Mpgo.exe from Visual Studio</span></span>

 <span data-ttu-id="1cea6-217">É possível executar Mpgo.exe do Visual Studio (consulte o artigo [Como especificar eventos de build (C#)](/visualstudio/ide/how-to-specify-build-events-csharp)) com as seguintes restrições:</span><span class="sxs-lookup"><span data-stu-id="1cea6-217">You can run Mpgo.exe from Visual Studio (see the article [How to: Specify Build Events (C#)](/visualstudio/ide/how-to-specify-build-events-csharp)) with the following restrictions:</span></span>

- <span data-ttu-id="1cea6-218">Não é possível usar caminhos entre aspas com marcas de barra à direita porque as macros do Visual Studio também usam marcas de barra à direita por padrão.</span><span class="sxs-lookup"><span data-stu-id="1cea6-218">You cannot use quoted paths with trailing slash marks, because Visual Studio macros also use trailing slash marks by default.</span></span> <span data-ttu-id="1cea6-219">(Por exemplo, `–OutDir "C:\Output Folder\"` é inválido.) Para contornar essa restrição, você pode escapar da barra à direita.</span><span class="sxs-lookup"><span data-stu-id="1cea6-219">(For example, `–OutDir "C:\Output Folder\"` is invalid.) To work around this restriction, you can escape the trailing slash.</span></span> <span data-ttu-id="1cea6-220">(Por exemplo, use `-OutDir "$(OutDir)\"` em vez disso.)</span><span class="sxs-lookup"><span data-stu-id="1cea6-220">(For example, use `-OutDir "$(OutDir)\"` instead.)</span></span>

- <span data-ttu-id="1cea6-221">Por padrão, Mpgo.exe não está no caminho de compilação do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1cea6-221">By default, Mpgo.exe is not on the Visual Studio build path.</span></span> <span data-ttu-id="1cea6-222">Você deve adicionar o caminho para o Visual Studio ou especificar o caminho completo na linha de comando de Mpgo.</span><span class="sxs-lookup"><span data-stu-id="1cea6-222">You must either add the path to Visual Studio or specify the full path on the Mpgo command line.</span></span> <span data-ttu-id="1cea6-223">É possível usar o parâmetro `–Scenario` ou `–Import` no evento de pós-build no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1cea6-223">You can use either the `–Scenario` or the `–Import` parameter in the post-build event in Visual Studio.</span></span> <span data-ttu-id="1cea6-224">No entanto, o processo típico é usar `–Scenario` uma vez de um Prompt de Comando do Desenvolvedor para Visual Studio e, então, usar `–Import` para atualizar os assemblies otimizados após cada build, por exemplo: `"C:\Program Files\Microsoft Visual Studio 11.0\Team Tools\Performance Tools\mpgo.exe" -import "$(OutDir)tmp" -assemblylist "$(TargetPath)" -outdir "$(OutDir)\"`.</span><span class="sxs-lookup"><span data-stu-id="1cea6-224">However, the typical process is to use `–Scenario` one time from a Developer Command Prompt for Visual Studio, and then use `–Import` to update the optimized assemblies after each build; for example:  `"C:\Program Files\Microsoft Visual Studio 11.0\Team Tools\Performance Tools\mpgo.exe" -import "$(OutDir)tmp" -assemblylist "$(TargetPath)" -outdir "$(OutDir)\"`.</span></span>

<a name="samples"></a>

## <a name="examples"></a><span data-ttu-id="1cea6-225">Exemplos</span><span class="sxs-lookup"><span data-stu-id="1cea6-225">Examples</span></span>

 <span data-ttu-id="1cea6-226">O seguinte comando Mpgo.exe de um Prompt de Comando do Desenvolvedor para Visual Studio otimiza um aplicativo de imposto:</span><span class="sxs-lookup"><span data-stu-id="1cea6-226">The following Mpgo.exe command from a Developer Command Prompt for Visual Studio optimizes a tax application:</span></span>

```console
mpgo –scenario "C:\MyApp\MyTax.exe /params par" –AssemblyList Mytax.dll MyTaxUtil2011.dll –OutDir C:\Optimized –TimeOut 15
```

 <span data-ttu-id="1cea6-227">O seguinte comando de Mpgo.exe otimiza um aplicativo de som:</span><span class="sxs-lookup"><span data-stu-id="1cea6-227">The following Mpgo.exe command optimizes a sound application:</span></span>

```console
mpgo –scenario "C:\MyApp\wav2wma.exe –input song1.wav –output song1.wma" –AssemblyList transcode.dll –OutDir C:\Optimized –TimeOut 15
```

 <span data-ttu-id="1cea6-228">O seguinte comando de Mpgo.exe usa dados de assemblies otimizados anteriormente para otimizar versões mais novas dos assemblies:</span><span class="sxs-lookup"><span data-stu-id="1cea6-228">The following Mpgo.exe command uses data from previously optimized assemblies to optimize newer versions of the assemblies:</span></span>

```console
mpgo.exe -import "C:\Optimized" -assemblylist "C:\MyApp\MyTax.dll" "C:\MyApp\MyTaxUtil2011.dll" -outdir C:\ReOptimized
```

## <a name="see-also"></a><span data-ttu-id="1cea6-229">Veja também</span><span class="sxs-lookup"><span data-stu-id="1cea6-229">See also</span></span>

- [<span data-ttu-id="1cea6-230">Ngen.exe (gerador de imagem nativa)</span><span class="sxs-lookup"><span data-stu-id="1cea6-230">Ngen.exe (Native Image Generator)</span></span>](ngen-exe-native-image-generator.md)
- [<span data-ttu-id="1cea6-231">Prompts de comando</span><span class="sxs-lookup"><span data-stu-id="1cea6-231">Command Prompts</span></span>](developer-command-prompt-for-vs.md)
- [<span data-ttu-id="1cea6-232">Melhorando o desempenho de inicialização dos aplicativos da área de trabalho</span><span class="sxs-lookup"><span data-stu-id="1cea6-232">Improving Launch Performance for your Desktop Applications</span></span>](https://devblogs.microsoft.com/dotnet/improving-launch-performance-for-your-desktop-applications/)
- [<span data-ttu-id="1cea6-233">Uma visão geral das melhorias de desempenho no .NET Framework 4,5</span><span class="sxs-lookup"><span data-stu-id="1cea6-233">An Overview of Performance Improvements in .NET Framework 4.5</span></span>](/archive/msdn-magazine/2012/april/clr-an-overview-of-performance-improvements-in-net-4-5)
