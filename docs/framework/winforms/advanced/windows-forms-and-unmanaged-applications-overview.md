---
title: Visão geral sobre aplicativos do Windows Forms e aplicativos não gerenciados
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 02f3224a8069fd091833bb09744389592c769818
ms.sourcegitcommit: c7a7e1468bf0fa7f7065de951d60dfc8d5ba89f5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/14/2019
ms.locfileid: "65592506"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="3a1da-102">Visão geral sobre aplicativos do Windows Forms e aplicativos não gerenciados</span><span class="sxs-lookup"><span data-stu-id="3a1da-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="3a1da-103">Aplicativos do Windows Forms e controles podem interoperar com aplicativos não gerenciados, com algumas restrições.</span><span class="sxs-lookup"><span data-stu-id="3a1da-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="3a1da-104">As seções a seguir descrevem os cenários e as configurações com suporte em controles e aplicativos do Windows Forms e aqueles que não têm suporte.</span><span class="sxs-lookup"><span data-stu-id="3a1da-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="3a1da-105">Aplicativos ActiveX e controles do Windows Forms</span><span class="sxs-lookup"><span data-stu-id="3a1da-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="3a1da-106">Com exceção do Microsoft Internet Explorer e MFC (Microsoft Foundation Classes), não há suporte aos controles do Windows Forms em aplicativos projetados para hospedar controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="3a1da-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="3a1da-107">Outros aplicativos e ferramentas de desenvolvimento que são capazes de hospedar controles ActiveX, inclusive os contêineres de teste ActiveX de versões do Visual Studio anteriores ao Visual Studio .NET 2003, não são hosts com suporte para controles do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="3a1da-108">Essas restrições também se aplicam ao uso de controles do Windows Forms por meio da interoperabilidade COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="3a1da-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="3a1da-109">Há suporte para o uso de um controle do Windows Forms por meio de um CCW de COM (COM callable wrapper) somente no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="3a1da-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="3a1da-110">Para obter mais informações sobre a interoperabilidade COM, consulte</span><span class="sxs-lookup"><span data-stu-id="3a1da-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="3a1da-111">[Interoperabilidade COM](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="3a1da-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="3a1da-112">A tabela a seguir mostra o suporte para hospedagem do ActiveX para controles do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="3a1da-113">Versão do Windows Forms</span><span class="sxs-lookup"><span data-stu-id="3a1da-113">Windows Forms version</span></span>|<span data-ttu-id="3a1da-114">Suporte</span><span class="sxs-lookup"><span data-stu-id="3a1da-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="3a1da-115">.NET Framework versão 1.0</span><span class="sxs-lookup"><span data-stu-id="3a1da-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="3a1da-116">Internet Explorer 5.01 e versões posteriores</span><span class="sxs-lookup"><span data-stu-id="3a1da-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="3a1da-117">.NET framework versão 1.1 e posterior</span><span class="sxs-lookup"><span data-stu-id="3a1da-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="3a1da-118">Internet Explorer 5.01 e versões posteriores</span><span class="sxs-lookup"><span data-stu-id="3a1da-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="3a1da-119">MFC (Microsoft Foundation Classes) 7.0 e posterior</span><span class="sxs-lookup"><span data-stu-id="3a1da-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="3a1da-120">Hospedando componentes do Windows Forms como controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="3a1da-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="3a1da-121">No .NET Framework 1.1, o suporte foi estendido para incluir MFC 7.0 e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="3a1da-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="3a1da-122">Esse suporte inclui qualquer contêiner totalmente compatível com contêiner de controle ActiveX do MFC 7.0 e posterior.</span><span class="sxs-lookup"><span data-stu-id="3a1da-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="3a1da-123">No entanto, não há suporte para registro dos controles do Windows Forms como controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="3a1da-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="3a1da-124">Além disso, não há suporte chamar o método `com.ms.win32.Ole32.CoCreateInstance` para controles do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="3a1da-125">Há suporte somente para a ativação gerenciada de controles do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="3a1da-126">Depois de criar um controle do Windows Forms, você pode hospedá-lo em um aplicativo MFC assim como faz para um controle ActiveX.</span><span class="sxs-lookup"><span data-stu-id="3a1da-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="3a1da-127">Para usar controles do Windows Forms em seu aplicativo não gerenciado, hospede o CLR usando as APIs de hospedagem de CLR não gerenciadas ou use os recursos de interoperabilidade C++.</span><span class="sxs-lookup"><span data-stu-id="3a1da-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="3a1da-128">A solução recomendada é usar os recursos de interoperabilidade C++.</span><span class="sxs-lookup"><span data-stu-id="3a1da-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="3a1da-129">Windows Forms em aplicativos cliente COM</span><span class="sxs-lookup"><span data-stu-id="3a1da-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="3a1da-130">Quando você abre um Formulário do Windows de um aplicativo cliente COM, como um aplicativo Visual Basic 6.0 ou um aplicativo MFC, o formulário pode se comportar de modo inesperado.</span><span class="sxs-lookup"><span data-stu-id="3a1da-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="3a1da-131">Por exemplo, quando você pressiona a tecla TAB, o foco não muda de um controle para outro.</span><span class="sxs-lookup"><span data-stu-id="3a1da-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="3a1da-132">Quando você pressiona a tecla ENTER enquanto um botão de comando tem o foco, o botão <xref:System.Windows.Forms.Control.Click> não é gerado.</span><span class="sxs-lookup"><span data-stu-id="3a1da-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="3a1da-133">Você também pode enfrentar um comportamento inesperado de pressionamentos de teclas ou atividade do mouse.</span><span class="sxs-lookup"><span data-stu-id="3a1da-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="3a1da-134">Esse comportamento ocorre porque o aplicativo não gerenciado não implementa o suporte de loop de mensagem que o Windows Forms requer para funcionar corretamente.</span><span class="sxs-lookup"><span data-stu-id="3a1da-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="3a1da-135">O loop de mensagem fornecido pelo aplicativo cliente COM é fundamentalmente diferente do loop de mensagem do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="3a1da-136">Um loop de mensagem do aplicativo é um loop interno do programa que recupera mensagens da fila de mensagens do thread, converte-as e envia-as para o aplicativo para serem processadas.</span><span class="sxs-lookup"><span data-stu-id="3a1da-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="3a1da-137">O loop de mensagem para um Windows Form não tem a mesma arquitetura que loops de mensagem que aplicativos anteriores, como aplicativos do Visual Basic 6.0 e do MFC, forneciam.</span><span class="sxs-lookup"><span data-stu-id="3a1da-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="3a1da-138">As mensagens de janela que são lançadas para o loop de mensagem podem ser processadas de maneira diferente daquela que o Formulário do Windows espera.</span><span class="sxs-lookup"><span data-stu-id="3a1da-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="3a1da-139">Portanto, pode ocorrer um comportamento inesperado.</span><span class="sxs-lookup"><span data-stu-id="3a1da-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="3a1da-140">Algumas combinações de teclas e atividades do mouse podem não funcionar ou alguns eventos podem não ser gerados como o esperado.</span><span class="sxs-lookup"><span data-stu-id="3a1da-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="3a1da-141">Resolvendo problemas de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="3a1da-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="3a1da-142">Você pode resolver esses problemas exibindo o formulário em um loop de mensagem do .NET Framework, que é criado usando o <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="3a1da-142">You can resolve these problems by displaying the form on a .NET Framework message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="3a1da-143">Para fazer um Formulário do Windows funcionar corretamente em um aplicativo cliente COM, execute-o em um loop de mensagem do Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="3a1da-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="3a1da-144">Para fazer isso, use uma das abordagens a seguir:</span><span class="sxs-lookup"><span data-stu-id="3a1da-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="3a1da-145">Use o <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> método para exibir o formulário do Windows.</span><span class="sxs-lookup"><span data-stu-id="3a1da-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="3a1da-146">Para obter mais informações, confira [Como: Dar suporte à interoperabilidade com exibindo um formulário do Windows com o método ShowDialog](com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="3a1da-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="3a1da-147">Exiba cada Formulário do Windows em um novo thread.</span><span class="sxs-lookup"><span data-stu-id="3a1da-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="3a1da-148">Para obter mais informações, confira [Como: Dar suporte à interoperabilidade com exibindo cada formulário do Windows em seu próprio Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="3a1da-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a1da-149">Consulte também</span><span class="sxs-lookup"><span data-stu-id="3a1da-149">See also</span></span>

- [<span data-ttu-id="3a1da-150">Windows Forms e Aplicativos Não Gerenciados</span><span class="sxs-lookup"><span data-stu-id="3a1da-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="3a1da-151">Interoperabilidade COM</span><span class="sxs-lookup"><span data-stu-id="3a1da-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="3a1da-152">Interoperabilidade COM em Aplicativos .NET Framework</span><span class="sxs-lookup"><span data-stu-id="3a1da-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="3a1da-153">[Exemplos de interoperabilidade COM](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="3a1da-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="3a1da-154">Aximp.exe (Importador de Controle ActiveX do Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="3a1da-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="3a1da-155">Expondo componentes do .NET Framework ao COM</span><span class="sxs-lookup"><span data-stu-id="3a1da-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="3a1da-156">Empacotando um assembly para COM</span><span class="sxs-lookup"><span data-stu-id="3a1da-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="3a1da-157">Registrando assemblies usando COM</span><span class="sxs-lookup"><span data-stu-id="3a1da-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="3a1da-158">Como: Dar suporte à interoperabilidade com exibindo um formulário do Windows com o método ShowDialog</span><span class="sxs-lookup"><span data-stu-id="3a1da-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="3a1da-159">Como: Dar suporte à interoperabilidade com exibindo cada formulário do Windows em seu próprio Thread</span><span class="sxs-lookup"><span data-stu-id="3a1da-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
