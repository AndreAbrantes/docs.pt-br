---
title: Modo virtual no controle DataGridView dos Windows Forms
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], virtual mode
ms.assetid: feae5d43-2848-4b1a-8ea7-77085dc415b5
ms.openlocfilehash: 92b45f026470f312fe788ed30e4ff8d172735a98
ms.sourcegitcommit: 160a88c8087b0e63606e6e35f9bd57fa5f69c168
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/09/2019
ms.locfileid: "57709478"
---
# <a name="virtual-mode-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="8f881-102">Modo virtual no controle DataGridView dos Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8f881-102">Virtual Mode in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="8f881-103">Com o modo virtual, você pode gerenciar a interação entre o <xref:System.Windows.Forms.DataGridView> controle e um cache de dados personalizados.</span><span class="sxs-lookup"><span data-stu-id="8f881-103">With virtual mode, you can manage the interaction between the <xref:System.Windows.Forms.DataGridView> control and a custom data cache.</span></span> <span data-ttu-id="8f881-104">Para implementar o modo virtual, defina as <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> propriedade para `true` e manipular um ou mais eventos descritos neste tópico.</span><span class="sxs-lookup"><span data-stu-id="8f881-104">To implement virtual mode, set the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property to `true` and handle one or more of the events described in this topic.</span></span> <span data-ttu-id="8f881-105">Você normalmente manipulará pelo menos o evento `CellValueNeeded`, que permite os valores de consulta do controle no cache de dados.</span><span class="sxs-lookup"><span data-stu-id="8f881-105">You will typically handle at least the `CellValueNeeded` event, which enables the control look up values in the data cache.</span></span>  
  
## <a name="bound-mode-and-virtual-mode"></a><span data-ttu-id="8f881-106">Modo associado e modo virtual</span><span class="sxs-lookup"><span data-stu-id="8f881-106">Bound Mode and Virtual Mode</span></span>  
 <span data-ttu-id="8f881-107">O modo virtual é necessário somente quando você precisar suplementar ou substituir o modo associado.</span><span class="sxs-lookup"><span data-stu-id="8f881-107">Virtual mode is necessary only when you need to supplement or replace bound mode.</span></span> <span data-ttu-id="8f881-108">No modo associado, você deve definir o <xref:System.Windows.Forms.DataGridView.DataSource%2A> propriedade e o controle automaticamente carrega os dados da origem especificada e envia o usuário altera volta para ele.</span><span class="sxs-lookup"><span data-stu-id="8f881-108">In bound mode, you set the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property and the control automatically loads the data from the specified source and submits user changes back to it.</span></span> <span data-ttu-id="8f881-109">Você pode controlar quais colunas associadas são exibidas e a fonte de dados que geralmente lida com operações como classificação.</span><span class="sxs-lookup"><span data-stu-id="8f881-109">You can control which of the bound columns are displayed, and the data source itself typically handles operations such as sorting.</span></span>  
  
## <a name="supplementing-bound-mode"></a><span data-ttu-id="8f881-110">Complementando o modo associado</span><span class="sxs-lookup"><span data-stu-id="8f881-110">Supplementing Bound Mode</span></span>  
 <span data-ttu-id="8f881-111">Você pode complementar o modo associado exibindo colunas não associadas junto com as colunas associadas.</span><span class="sxs-lookup"><span data-stu-id="8f881-111">You can supplement bound mode by displaying unbound columns along with the bound columns.</span></span> <span data-ttu-id="8f881-112">Isso, às vezes, é chamado de "modo misto" e é útil para exibir coisas como controles de interface do usuário ou valores calculados.</span><span class="sxs-lookup"><span data-stu-id="8f881-112">This is sometimes called "mixed mode" and is useful for displaying things like calculated values or user-interface (UI) controls.</span></span>  
  
 <span data-ttu-id="8f881-113">Como as colunas não associadas estão fora da fonte de dados, elas são ignoradas por operações de classificação da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="8f881-113">Because unbound columns are outside the data source, they are ignored by the data source's sorting operations.</span></span> <span data-ttu-id="8f881-114">Portanto, quando você habilita a classificação no modo misto, você deve gerenciar os dados não associados em um cache local e implementar o modo virtual para permitir que o <xref:System.Windows.Forms.DataGridView> controle interagir com ele.</span><span class="sxs-lookup"><span data-stu-id="8f881-114">Therefore, when you enable sorting in mixed mode, you must manage the unbound data in a local cache and implement virtual mode to let the <xref:System.Windows.Forms.DataGridView> control interact with it.</span></span>  
  
 <span data-ttu-id="8f881-115">Para obter mais informações sobre como usar o modo virtual para manter os valores em colunas não associadas, consulte os exemplos de <xref:System.Windows.Forms.DataGridViewCheckBoxColumn.ThreeState%2A?displayProperty=nameWithType> propriedade e <xref:System.Windows.Forms.DataGridViewComboBoxColumn?displayProperty=nameWithType> tópicos de referência de classe.</span><span class="sxs-lookup"><span data-stu-id="8f881-115">For more information about using virtual mode to maintain the values in unbound columns, see the examples in the <xref:System.Windows.Forms.DataGridViewCheckBoxColumn.ThreeState%2A?displayProperty=nameWithType> property and <xref:System.Windows.Forms.DataGridViewComboBoxColumn?displayProperty=nameWithType> class reference topics.</span></span>  
  
## <a name="replacing-bound-mode"></a><span data-ttu-id="8f881-116">Substituindo o modo associado</span><span class="sxs-lookup"><span data-stu-id="8f881-116">Replacing Bound Mode</span></span>  
 <span data-ttu-id="8f881-117">Se o modo associado não atender às suas necessidades de desempenho, você poderá gerenciar todos os seus dados em um cache personalizado por meio de manipuladores de eventos de modo virtual.</span><span class="sxs-lookup"><span data-stu-id="8f881-117">If bound mode does not meet your performance needs, you can manage all your data in a custom cache through virtual-mode event handlers.</span></span> <span data-ttu-id="8f881-118">Por exemplo, você pode usar o modo virtual para implementar um mecanismo de carregamento de dados Just-In-Time que recupera apenas os dados necessários de um banco de dados para desempenho ideal.</span><span class="sxs-lookup"><span data-stu-id="8f881-118">For example, you can use virtual mode to implement a just-in-time data loading mechanism that retrieves only as much data from a networked database as is necessary for optimal performance.</span></span> <span data-ttu-id="8f881-119">Esse cenário é particularmente útil ao trabalhar com grandes quantidades de dados em uma conexão de rede lenta ou com computadores cliente que têm uma quantidade limitada de RAM ou espaço de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8f881-119">This scenario is particularly useful when working with large amounts of data over a slow network connection or with client machines that have a limited amount of RAM or storage space.</span></span>  
  
 <span data-ttu-id="8f881-120">Para obter mais informações sobre como usar o modo virtual em um cenário Just-In-Time, consulte [Implementando o modo virtual com o carregamento de dados Just-In-Time no controle DataGridView dos Windows Forms](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="8f881-120">For more information about using virtual mode in a just-in-time scenario, see [Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md).</span></span>  
  
## <a name="virtual-mode-events"></a><span data-ttu-id="8f881-121">Eventos de modo virtual</span><span class="sxs-lookup"><span data-stu-id="8f881-121">Virtual-Mode Events</span></span>  
 <span data-ttu-id="8f881-122">Se seus dados são somente leitura, o evento `CellValueNeeded` pode ser o único com o qual você precisará lidar.</span><span class="sxs-lookup"><span data-stu-id="8f881-122">If your data is read-only, the `CellValueNeeded` event may be the only event you will need to handle.</span></span> <span data-ttu-id="8f881-123">Eventos adicionais de modo virtual permitem que você habilite uma funcionalidade específica como edições do usuário, adição de linha e exclusão e transações de nível de linha.</span><span class="sxs-lookup"><span data-stu-id="8f881-123">Additional virtual-mode events let you enable specific functionality like user edits, row addition and deletion, and row-level transactions.</span></span>  
  
 <span data-ttu-id="8f881-124">Alguns standard <xref:System.Windows.Forms.DataGridView> eventos (como eventos que ocorrem quando os usuários, adicionar ou excluem linhas ou quando valores de célula são editados, analisados, validados ou formatados) são úteis no modo virtual.</span><span class="sxs-lookup"><span data-stu-id="8f881-124">Some standard <xref:System.Windows.Forms.DataGridView> events (such as events that occur when users add or delete rows, or when cell values are edited, parsed, validated, or formatted) are useful in virtual mode, as well.</span></span> <span data-ttu-id="8f881-125">Você também pode manipular eventos que lhe permitam manter valores que geralmente não são armazenados em uma fonte de dados associada, como o texto de dica de ferramenta da célula, texto de erro de linha e célula, célula e dados de menu de atalho da linha e dados de altura de linha.</span><span class="sxs-lookup"><span data-stu-id="8f881-125">You can also handle events that let you maintain values not typically stored in a bound data source, such as cell ToolTip text, cell and row error text, cell and row shortcut menu data, and row height data.</span></span>  
  
 <span data-ttu-id="8f881-126">Para obter mais informações sobre como implementar o modo virtual para gerenciar dados de leitura/gravação com um escopo de confirmação de nível de linha, consulte [passo a passo: Implementando o modo Virtual no Windows Forms DataGridView Control](implementing-virtual-mode-wf-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="8f881-126">For more information about implementing virtual mode to manage read/write data with a row-level commit scope, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](implementing-virtual-mode-wf-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="8f881-127">Para obter um exemplo que implementa o modo virtual com um escopo de confirmação de nível de célula, consulte o <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> tópico de referência de propriedade.</span><span class="sxs-lookup"><span data-stu-id="8f881-127">For an example that implements virtual mode with a cell-level commit scope, see the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property reference topic.</span></span>  
  
 <span data-ttu-id="8f881-128">Os seguintes eventos ocorrem apenas quando o <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-128">The following events occur only when the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is set to `true`.</span></span>  
  
|<span data-ttu-id="8f881-129">evento</span><span class="sxs-lookup"><span data-stu-id="8f881-129">Event</span></span>|<span data-ttu-id="8f881-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="8f881-130">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Windows.Forms.DataGridView.CellValueNeeded>|<span data-ttu-id="8f881-131">Usado pelo controle para recuperar um valor de célula do cache de dados para exibição.</span><span class="sxs-lookup"><span data-stu-id="8f881-131">Used by the control to retrieve a cell value from the data cache for display.</span></span> <span data-ttu-id="8f881-132">Esse evento ocorre somente para células em colunas não associadas.</span><span class="sxs-lookup"><span data-stu-id="8f881-132">This event occurs only for cells in unbound columns.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellValuePushed>|<span data-ttu-id="8f881-133">Usado pelo controle para confirmar a entrada do usuário de uma célula para o cache de dados.</span><span class="sxs-lookup"><span data-stu-id="8f881-133">Used by the control to commit user input for a cell to the data cache.</span></span> <span data-ttu-id="8f881-134">Esse evento ocorre somente para células em colunas não associadas.</span><span class="sxs-lookup"><span data-stu-id="8f881-134">This event occurs only for cells in unbound columns.</span></span><br /><br /> <span data-ttu-id="8f881-135">Chame o <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> método ao alterar um valor em cache fora de um <xref:System.Windows.Forms.DataGridView.CellValuePushed> manipulador de eventos para garantir que o valor atual é exibido no controle e aplicar quaisquer modos de dimensionamento automático atualmente em vigor.</span><span class="sxs-lookup"><span data-stu-id="8f881-135">Call the <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> method when changing a cached value outside of a <xref:System.Windows.Forms.DataGridView.CellValuePushed> event handler to ensure that the current value is displayed in the control and to apply any automatic sizing modes currently in effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.NewRowNeeded>|<span data-ttu-id="8f881-136">Usado pelo controle para indicar a necessidade de uma nova linha no cache de dados.</span><span class="sxs-lookup"><span data-stu-id="8f881-136">Used by the control to indicate the need for a new row in the data cache.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowDirtyStateNeeded>|<span data-ttu-id="8f881-137">Usado pelo controle para determinar se uma linha tem alterações não confirmadas.</span><span class="sxs-lookup"><span data-stu-id="8f881-137">Used by the control to determine whether a row has any uncommitted changes.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CancelRowEdit>|<span data-ttu-id="8f881-138">Usado pelo controle para indicar que uma linha deve ser revertida para seus valores armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="8f881-138">Used by the control to indicate that a row should revert to its cached values.</span></span>|  
  
 <span data-ttu-id="8f881-139">Os seguintes eventos são úteis no modo virtual, mas pode ser usados independentemente do <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> configuração da propriedade.</span><span class="sxs-lookup"><span data-stu-id="8f881-139">The following events are useful in virtual mode, but can be used regardless of the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property setting.</span></span>  
  
|<span data-ttu-id="8f881-140">Eventos</span><span class="sxs-lookup"><span data-stu-id="8f881-140">Events</span></span>|<span data-ttu-id="8f881-141">Descrição</span><span class="sxs-lookup"><span data-stu-id="8f881-141">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Windows.Forms.DataGridView.UserDeletingRow><br /><br /> <xref:System.Windows.Forms.DataGridView.UserDeletedRow><br /><br /> <xref:System.Windows.Forms.DataGridView.RowsRemoved><br /><br /> <xref:System.Windows.Forms.DataGridView.RowsAdded>|<span data-ttu-id="8f881-142">Usado pelo controle para indicar quando as linhas são excluídas ou adicionadas, permitindo a atualização do cache de dados adequadamente.</span><span class="sxs-lookup"><span data-stu-id="8f881-142">Used by the control to indicate when rows are deleted or added, letting you update the data cache accordingly.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellFormatting><br /><br /> <xref:System.Windows.Forms.DataGridView.CellParsing><br /><br /> <xref:System.Windows.Forms.DataGridView.CellValidating><br /><br /> <xref:System.Windows.Forms.DataGridView.CellValidated><br /><br /> <xref:System.Windows.Forms.DataGridView.RowValidating><br /><br /> <xref:System.Windows.Forms.DataGridView.RowValidated>|<span data-ttu-id="8f881-143">Usado pelo controle para formatar valores de célula para exibição e para analisar e validar a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="8f881-143">Used by the control to format cell values for display and to parse and validate user input.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded>|<span data-ttu-id="8f881-144">Usado pelo controle para recuperar o texto de dica de ferramenta da célula quando o <xref:System.Windows.Forms.DataGridView.DataSource%2A> estiver definida ou o <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> é de propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-144">Used by the control to retrieve cell ToolTip text when the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span><br /><br /> <span data-ttu-id="8f881-145">Dicas de ferramenta da célula são exibidas somente quando o <xref:System.Windows.Forms.DataGridView.ShowCellToolTips%2A> é o valor da propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-145">Cell ToolTips are displayed only when the <xref:System.Windows.Forms.DataGridView.ShowCellToolTips%2A> property value is `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellErrorTextNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowErrorTextNeeded>|<span data-ttu-id="8f881-146">Usado pelo controle para recuperar o texto da célula ou linha de erro quando o <xref:System.Windows.Forms.DataGridView.DataSource%2A> estiver definida ou o <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> é de propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-146">Used by the control to retrieve cell or row error text when the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span><br /><br /> <span data-ttu-id="8f881-147">Chame o <xref:System.Windows.Forms.DataGridView.UpdateCellErrorText%2A> método ou o <xref:System.Windows.Forms.DataGridView.UpdateRowErrorText%2A> método quando você altera o texto de erro de linha ou célula para garantir que o valor atual é exibido no controle.</span><span class="sxs-lookup"><span data-stu-id="8f881-147">Call the <xref:System.Windows.Forms.DataGridView.UpdateCellErrorText%2A> method or the <xref:System.Windows.Forms.DataGridView.UpdateRowErrorText%2A> method when you change the cell or row error text to ensure that the current value is displayed in the control.</span></span><br /><br /> <span data-ttu-id="8f881-148">Glifos de erro de linha e célula são exibidos quando o <xref:System.Windows.Forms.DataGridView.ShowCellErrors%2A> e <xref:System.Windows.Forms.DataGridView.ShowRowErrors%2A> valores de propriedade são `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-148">Cell and row error glyphs are displayed when the <xref:System.Windows.Forms.DataGridView.ShowCellErrors%2A> and <xref:System.Windows.Forms.DataGridView.ShowRowErrors%2A> property values are `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>|<span data-ttu-id="8f881-149">Usado pelo controle para recuperar uma célula ou linha <xref:System.Windows.Forms.ContextMenuStrip> quando o controle <xref:System.Windows.Forms.DataGridView.DataSource%2A> estiver definida ou o <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> é de propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="8f881-149">Used by the control to retrieve a cell or row <xref:System.Windows.Forms.ContextMenuStrip> when the control <xref:System.Windows.Forms.DataGridView.DataSource%2A> property is set or the <xref:System.Windows.Forms.DataGridView.VirtualMode%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeightInfoNeeded><br /><br /> <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed>|<span data-ttu-id="8f881-150">Usado pelo controle para recuperar ou armazenar informações de altura de linha no cache de dados.</span><span class="sxs-lookup"><span data-stu-id="8f881-150">Used by the control to retrieve or store row height information in the data cache.</span></span> <span data-ttu-id="8f881-151">Chame o <xref:System.Windows.Forms.DataGridView.UpdateRowHeightInfo%2A> método ao alterar as informações de altura de linha em cache fora de um <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed> manipulador de eventos para garantir que o valor atual é usado na exibição do controle.</span><span class="sxs-lookup"><span data-stu-id="8f881-151">Call the <xref:System.Windows.Forms.DataGridView.UpdateRowHeightInfo%2A> method when changing the cached row height information outside of a <xref:System.Windows.Forms.DataGridView.RowHeightInfoPushed> event handler to ensure that the current value is used in the display of the control.</span></span>|  
  
## <a name="best-practices-in-virtual-mode"></a><span data-ttu-id="8f881-152">Melhores práticas para o modo virtual</span><span class="sxs-lookup"><span data-stu-id="8f881-152">Best Practices in Virtual Mode</span></span>  
 <span data-ttu-id="8f881-153">Se você estiver implementando o modo virtual para trabalhar eficientemente com grandes quantidades de dados, você também deseja garantir que você está trabalhando com eficiência com o <xref:System.Windows.Forms.DataGridView> próprio controle.</span><span class="sxs-lookup"><span data-stu-id="8f881-153">If you are implementing virtual mode in order to work efficiently with large amounts of data, you will also want to ensure that you are working efficiently with the <xref:System.Windows.Forms.DataGridView> control itself.</span></span> <span data-ttu-id="8f881-154">Para mais informações sobre o uso eficiente dos estilos de célula, dimensionamento automático, seleções e compartilhamento de linhas, consulte [Melhores práticas para dimensionamento do controle DataGridView dos Windows Forms](best-practices-for-scaling-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="8f881-154">For more information about the efficient use of cell styles, automatic sizing, selections, and row sharing, see [Best Practices for Scaling the Windows Forms DataGridView Control](best-practices-for-scaling-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8f881-155">Consulte também</span><span class="sxs-lookup"><span data-stu-id="8f881-155">See also</span></span>
- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.VirtualMode%2A>
- [<span data-ttu-id="8f881-156">Ajuste de desempenho no controle DataGridView do Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8f881-156">Performance Tuning in the Windows Forms DataGridView Control</span></span>](performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="8f881-157">Práticas recomendadas para colocação em escala do controle DataGridView dos Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8f881-157">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>](best-practices-for-scaling-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="8f881-158">Passo a passo: Implementando o modo Virtual no controle DataGridView dos Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8f881-158">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](implementing-virtual-mode-wf-datagridview-control.md)
- [<span data-ttu-id="8f881-159">Implementando o modo virtual com carregamento de dados Just-In-Time no controle DataGridView dos Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8f881-159">Implementing Virtual Mode with Just-In-Time Data Loading in the Windows Forms DataGridView Control</span></span>](implementing-virtual-mode-jit-data-loading-in-the-datagrid.md)
