---
title: Estação de trabalho vs. coleta de lixo do servidor (GC)
description: Saiba mais sobre a coleta de lixo de estação de trabalho e servidor em .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 6b8e5f6802e5d44669b95d43d4e897fa4a418512
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2020
ms.locfileid: "82103551"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="20748-103">Coleta de lixo de estação de trabalho ou de servidor</span><span class="sxs-lookup"><span data-stu-id="20748-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="20748-104">O coletor de lixo tem autoajuste e pode trabalhar em uma ampla variedade de cenários.</span><span class="sxs-lookup"><span data-stu-id="20748-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="20748-105">No entanto, você pode [definir o tipo de coleta de lixo](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) com base nas características da carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="20748-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="20748-106">O CLR fornece os seguintes tipos de coleta de lixo:</span><span class="sxs-lookup"><span data-stu-id="20748-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="20748-107">Coleta de lixo de estação de trabalho (GC), que é projetada para aplicativos de clientes.</span><span class="sxs-lookup"><span data-stu-id="20748-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="20748-108">É o sabor GC padrão para aplicativos autônomos.</span><span class="sxs-lookup"><span data-stu-id="20748-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="20748-109">Para aplicativos hospedados, por exemplo, aqueles hospedados por ASP.NET, o host determina o sabor GC padrão.</span><span class="sxs-lookup"><span data-stu-id="20748-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="20748-110">A coleta de lixo da estação de trabalho pode ser simultânea ou não simultânea.</span><span class="sxs-lookup"><span data-stu-id="20748-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="20748-111">A coleta simultânea (ou *de fundo)* permite que os fios gerenciados continuem as operações durante uma coleta de lixo.</span><span class="sxs-lookup"><span data-stu-id="20748-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="20748-112">[A coleta de lixo em segundo plano](background-gc.md) substitui a coleta de lixo [simultânea](background-gc.md#concurrent-garbage-collection) nas versões .NET Framework 4 e posteriores.</span><span class="sxs-lookup"><span data-stu-id="20748-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="20748-113">A coleta de lixo de servidor, que serve para aplicativos de servidor que precisam de escalabilidade e taxa de transferência altas.</span><span class="sxs-lookup"><span data-stu-id="20748-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="20748-114">No .NET Core, a coleta de lixo do servidor pode ser não simultânea ou em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="20748-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="20748-115">Nas versões .NET Framework 4.5 e posteriores, a coleta de lixo do servidor pode ser não simultânea ou em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="20748-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="20748-116">No Framework 4 e nas versões anteriores, a coleta de lixo do servidor não é simultânea.</span><span class="sxs-lookup"><span data-stu-id="20748-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="20748-117">A ilustração a seguir mostra os tópicos dedicados que realizam a coleta de lixo em um servidor:</span><span class="sxs-lookup"><span data-stu-id="20748-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Threads de coleta de lixo do servidor](./media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="20748-119">Considerações sobre o desempenho</span><span class="sxs-lookup"><span data-stu-id="20748-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="20748-120">GC da estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="20748-120">Workstation GC</span></span>

<span data-ttu-id="20748-121">Veja a seguir considerações de desempenho e de threading para a coleta de lixo da estação de trabalho:</span><span class="sxs-lookup"><span data-stu-id="20748-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="20748-122">A coleção ocorre no thread do usuário que disparou a coleta de lixo e permanece com a mesma prioridade.</span><span class="sxs-lookup"><span data-stu-id="20748-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="20748-123">Como os threads de usuário normalmente são executados com prioridade normal, o coletor de lixo (que é executado em um thread de prioridade normal) deve disputam competir outros threads por tempo da CPU.</span><span class="sxs-lookup"><span data-stu-id="20748-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="20748-124">(Os threads que executam código nativo não estão suspensos em nenhuma coleta de lixo do servidor ou da estação de trabalho.)</span><span class="sxs-lookup"><span data-stu-id="20748-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="20748-125">A coleta de lixo da estação de trabalho é sempre usada em um computador que tem apenas um processador, independentemente da [configuração de configuração](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span><span class="sxs-lookup"><span data-stu-id="20748-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span></span>

### <a name="server-gc"></a><span data-ttu-id="20748-126">GC do servidor</span><span class="sxs-lookup"><span data-stu-id="20748-126">Server GC</span></span>

<span data-ttu-id="20748-127">Veja a seguir considerações de desempenho e de threading para a coleta de lixo de servidor:</span><span class="sxs-lookup"><span data-stu-id="20748-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="20748-128">A coleta ocorre em vários threads dedicados que estão em execução no nível de prioridade `THREAD_PRIORITY_HIGHEST`.</span><span class="sxs-lookup"><span data-stu-id="20748-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="20748-129">Fornece-se um heap e um thread dedicado para executar a coleta de lixo para cada CPU, e os heaps são coletados ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="20748-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="20748-130">Cada heap contém um heap de objeto pequeno e um heap de objeto grande, e todos os heaps podem ser acessados pelo código do usuário.</span><span class="sxs-lookup"><span data-stu-id="20748-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="20748-131">Objetos em heaps diferentes podem fazer referência entre si.</span><span class="sxs-lookup"><span data-stu-id="20748-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="20748-132">Como vários threads de coleta de lixo funcionam em conjunto, a coleta de lixo de servidor é mais rápida do que a coleta de lixo de estação de trabalho no heap de mesmo tamanho.</span><span class="sxs-lookup"><span data-stu-id="20748-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="20748-133">Geralmente, a coleta de lixo de servidor tem segmentos maiores.</span><span class="sxs-lookup"><span data-stu-id="20748-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="20748-134">No entanto, trata-se apenas de uma generalização: o tamanho do segmento é específico da implementação e está sujeito a alterações.</span><span class="sxs-lookup"><span data-stu-id="20748-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="20748-135">Não faça suposições sobre o tamanho dos segmentos alocados pelo coletor de lixo ao sintonizar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20748-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="20748-136">A coleta de lixo de servidor pode usar bastante recursos.</span><span class="sxs-lookup"><span data-stu-id="20748-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="20748-137">Por exemplo, imagine que existem 12 processos que usam o servidor GC em execução em um computador que tem quatro processadores.</span><span class="sxs-lookup"><span data-stu-id="20748-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="20748-138">Se todos os processos acontecerem de coletar lixo ao mesmo tempo, eles interfeririam uns com os outros, pois haveria 12 threads programados no mesmo processador.</span><span class="sxs-lookup"><span data-stu-id="20748-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="20748-139">Se os processos estão ativos, não é uma boa idéia tê-los todos usando o servidor GC.</span><span class="sxs-lookup"><span data-stu-id="20748-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="20748-140">Se você está executando centenas de instâncias de um aplicativo, considere usar a coleta de lixo da estação de trabalho com coleta de lixo simultânea desativada.</span><span class="sxs-lookup"><span data-stu-id="20748-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="20748-141">Isso resultará na redução da comutação de contexto, o que pode melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="20748-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="20748-142">Confira também</span><span class="sxs-lookup"><span data-stu-id="20748-142">See also</span></span>

- [<span data-ttu-id="20748-143">Coleta de lixo de fundo</span><span class="sxs-lookup"><span data-stu-id="20748-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="20748-144">Opções de configuração em tempo de execução para coleta de lixo</span><span class="sxs-lookup"><span data-stu-id="20748-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
