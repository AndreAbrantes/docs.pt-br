---
title: Modos de latência
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- garbage collection, intrusiveness
- garbage collection, latency modes
ms.assetid: 96278bb7-6eab-4612-8594-ceebfc887d81
ms.openlocfilehash: a8eaf0c80aa32978eead80c51a905cbcd66a537b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/15/2020
ms.locfileid: "74283591"
---
# <a name="latency-modes"></a><span data-ttu-id="bff2a-102">Modos de latência</span><span class="sxs-lookup"><span data-stu-id="bff2a-102">Latency modes</span></span>

<span data-ttu-id="bff2a-103">Para recuperar objetos, o coletor de lixo (GC) deve parar todos os segmentos de execução em uma aplicação.</span><span class="sxs-lookup"><span data-stu-id="bff2a-103">To reclaim objects, the garbage collector (GC) must stop all the executing threads in an application.</span></span> <span data-ttu-id="bff2a-104">O período durante o qual o coletor de lixo está ativo é referido como sua *latência.*</span><span class="sxs-lookup"><span data-stu-id="bff2a-104">The period of time during which the garbage collector is active is referred to as its *latency*.</span></span>

<span data-ttu-id="bff2a-105">Em algumas situações, como quando um aplicativo recupera dados ou exibe conteúdo, uma coleta de lixo completa pode ocorrer em um momento crítico e impedir o desempenho.</span><span class="sxs-lookup"><span data-stu-id="bff2a-105">In some situations, such as when an application retrieves data or displays content, a full garbage collection can occur at a critical time and impede performance.</span></span> <span data-ttu-id="bff2a-106">Você pode ajustar a intrusão do coletor de lixo, definindo a propriedade <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> como um dos valores <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bff2a-106">You can adjust the intrusiveness of the garbage collector by setting the <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> property to one of the <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> values.</span></span>

## <a name="low-latency-settings"></a><span data-ttu-id="bff2a-107">Configurações de baixa latência</span><span class="sxs-lookup"><span data-stu-id="bff2a-107">Low latency settings</span></span>

<span data-ttu-id="bff2a-108">Usar uma configuração de latência "baixa" significa que o coletor de lixo se intromete menos em sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="bff2a-108">Using a "low" latency setting means the garbage collector intrudes less in your application.</span></span> <span data-ttu-id="bff2a-109">A coleta de lixo é mais conservadora sobre recuperar a memória.</span><span class="sxs-lookup"><span data-stu-id="bff2a-109">Garbage collection is more conservative about reclaiming memory.</span></span>

<span data-ttu-id="bff2a-110">A enumeração <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> fornece duas configurações de baixa latência:</span><span class="sxs-lookup"><span data-stu-id="bff2a-110">The <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> enumeration provides two low latency settings:</span></span>

- <span data-ttu-id="bff2a-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suprime coleções de geração 2 e realiza apenas coleções de geração 0 e 1.</span><span class="sxs-lookup"><span data-stu-id="bff2a-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suppresses generation 2 collections and performs only generation 0 and 1 collections.</span></span> <span data-ttu-id="bff2a-112">Ela pode ser usada somente por curtos períodos.</span><span class="sxs-lookup"><span data-stu-id="bff2a-112">It can be used only for short periods of time.</span></span> <span data-ttu-id="bff2a-113">Em períodos mais longos, se o sistema estiver sob pressão de memória, o coletor de lixo disparará uma coleção, que pode pausar o aplicativo rapidamente e interromper uma operação de tempo crítico.</span><span class="sxs-lookup"><span data-stu-id="bff2a-113">Over longer periods, if the system is under memory pressure, the garbage collector will trigger a collection, which can briefly pause the application and disrupt a time-critical operation.</span></span> <span data-ttu-id="bff2a-114">Essa configuração está disponível somente para coleta de lixo de estação de trabalho.</span><span class="sxs-lookup"><span data-stu-id="bff2a-114">This setting is available only for workstation garbage collection.</span></span>

- <span data-ttu-id="bff2a-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suprime coleções de geração em primeiro plano 2 e executa apenas coleções de geração 0, 1 e geração de fundo 2.</span><span class="sxs-lookup"><span data-stu-id="bff2a-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suppresses foreground generation 2 collections and performs only generation 0, 1, and background generation 2 collections.</span></span> <span data-ttu-id="bff2a-116">Ela pode ser usada por longos períodos e está disponível para coleta de lixo de estação de trabalho e servidor.</span><span class="sxs-lookup"><span data-stu-id="bff2a-116">It can be used for longer periods of time, and is available for both workstation and server garbage collection.</span></span> <span data-ttu-id="bff2a-117">Esta configuração não pode ser usada se a coleta de lixo de fundo estiver desativada.</span><span class="sxs-lookup"><span data-stu-id="bff2a-117">This setting cannot be used if background garbage collection is disabled.</span></span>

<span data-ttu-id="bff2a-118">Durante períodos de baixa latência, coletas da geração 2 são suprimidas, a menos que ocorra o seguinte:</span><span class="sxs-lookup"><span data-stu-id="bff2a-118">During low latency periods, generation 2 collections are suppressed unless the following occurs:</span></span>

- <span data-ttu-id="bff2a-119">O sistema recebe uma notificação de falta de memória do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="bff2a-119">The system receives a low memory notification from the operating system.</span></span>

- <span data-ttu-id="bff2a-120">O código do aplicativo induz uma coleta chamando o <xref:System.GC.Collect%2A?displayProperty=nameWithType> método e especificando 2 para o `generation` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="bff2a-120">Application code induces a collection by calling the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method and specifying 2 for the `generation` parameter.</span></span>

## <a name="scenarios"></a><span data-ttu-id="bff2a-121">Cenários</span><span class="sxs-lookup"><span data-stu-id="bff2a-121">Scenarios</span></span>

<span data-ttu-id="bff2a-122">A tabela a seguir lista <xref:System.Runtime.GCLatencyMode> os cenários do aplicativo para usar os valores:</span><span class="sxs-lookup"><span data-stu-id="bff2a-122">The following table lists the application scenarios for using the <xref:System.Runtime.GCLatencyMode> values:</span></span>

|<span data-ttu-id="bff2a-123">Modo de latência</span><span class="sxs-lookup"><span data-stu-id="bff2a-123">Latency mode</span></span>|<span data-ttu-id="bff2a-124">Cenários de aplicativos</span><span class="sxs-lookup"><span data-stu-id="bff2a-124">Application scenarios</span></span>|
|------------------|---------------------------|
|<xref:System.Runtime.GCLatencyMode.Batch>|<span data-ttu-id="bff2a-125">Para aplicativos que não possuem interface de usuário (Interface do Usuário) ou operações do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="bff2a-125">For applications that have no user interface (UI) or server-side operations.</span></span><br /><br /><span data-ttu-id="bff2a-126">Quando a coleta de lixo em segundo plano é desativada, este é o modo padrão para a coleta de lixo da estação de trabalho e do servidor.</span><span class="sxs-lookup"><span data-stu-id="bff2a-126">When background garbage collection is disabled, this is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="bff2a-127"><xref:System.Runtime.GCLatencyMode.Batch>o modo também substitui a configuração [gcConcurrent,](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) ou seja, impede coleções de fundo ou simultâneas.</span><span class="sxs-lookup"><span data-stu-id="bff2a-127"><xref:System.Runtime.GCLatencyMode.Batch> mode also overrides the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) setting, that is, it prevents background or concurrent collections.</span></span>|
|<xref:System.Runtime.GCLatencyMode.Interactive>|<span data-ttu-id="bff2a-128">Para a maioria dos aplicativos que têm uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="bff2a-128">For most applications that have a UI.</span></span><br /><br /><span data-ttu-id="bff2a-129">Este é o modo padrão para a coleta de lixo da estação de trabalho e do servidor.</span><span class="sxs-lookup"><span data-stu-id="bff2a-129">This is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="bff2a-130">No entanto, se um aplicativo estiver hospedado, as configurações de coletor de lixo do processo de hospedagem terão precedência.</span><span class="sxs-lookup"><span data-stu-id="bff2a-130">However, if an app is hosted, the garbage collector settings of the hosting process take precedence.</span></span>|
|<xref:System.Runtime.GCLatencyMode.LowLatency>|<span data-ttu-id="bff2a-131">Para aplicativos que têm operações de curto prazo, sensíveis ao tempo, durante o qual as interrupções do coletor de lixo podem ser prejudiciais.</span><span class="sxs-lookup"><span data-stu-id="bff2a-131">For applications that have short-term, time-sensitive operations during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="bff2a-132">Por exemplo, aplicativos que renderizam animações ou funções de aquisição de dados.</span><span class="sxs-lookup"><span data-stu-id="bff2a-132">For example, applications that render animations or data acquisition functions.</span></span>|
|<xref:System.Runtime.GCLatencyMode.SustainedLowLatency>|<span data-ttu-id="bff2a-133">Para aplicativos que têm operações sensíveis ao tempo, por uma duração contida, mas potencialmente maior, durante a qual as interrupções do coletor de lixo poderiam ser prejudiciais.</span><span class="sxs-lookup"><span data-stu-id="bff2a-133">For applications that have time-sensitive operations for a contained but potentially longer duration of time during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="bff2a-134">Por exemplo, aplicativos que precisam de tempos de resposta rápidos, como alterações de dados de mercado durante o horário comercial.</span><span class="sxs-lookup"><span data-stu-id="bff2a-134">For example, applications that need quick response times as market data changes during trading hours.</span></span><br /><br /><span data-ttu-id="bff2a-135">Esse modo resulta em um tamanho maior do heap gerenciado do que outros modos.</span><span class="sxs-lookup"><span data-stu-id="bff2a-135">This mode results in a larger managed heap size than other modes.</span></span> <span data-ttu-id="bff2a-136">Como ele não compacta o heap gerenciado, é possível maior fragmentação.</span><span class="sxs-lookup"><span data-stu-id="bff2a-136">Because it does not compact the managed heap, higher fragmentation is possible.</span></span> <span data-ttu-id="bff2a-137">Verifique se há memória suficiente disponível.</span><span class="sxs-lookup"><span data-stu-id="bff2a-137">Ensure that sufficient memory is available.</span></span>|

## <a name="guidelines-for-using-low-latency"></a><span data-ttu-id="bff2a-138">Diretrizes para o uso de baixa latência</span><span class="sxs-lookup"><span data-stu-id="bff2a-138">Guidelines for using low latency</span></span>

<span data-ttu-id="bff2a-139">Ao usar o modo [GCLatencyMode.LowLatency,](xref:System.Runtime.GCLatencyMode.LowLatency) considere as seguintes diretrizes:</span><span class="sxs-lookup"><span data-stu-id="bff2a-139">When you use [GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) mode, consider the following guidelines:</span></span>

- <span data-ttu-id="bff2a-140">Mantenha o período de baixa latência o mais curto possível.</span><span class="sxs-lookup"><span data-stu-id="bff2a-140">Keep the period of time in low latency as short as possible.</span></span>

- <span data-ttu-id="bff2a-141">Evite a alocação de grande quantidade de memória durante períodos de baixa latência.</span><span class="sxs-lookup"><span data-stu-id="bff2a-141">Avoid allocating high amounts of memory during low latency periods.</span></span> <span data-ttu-id="bff2a-142">Notificações de memória insuficiente podem ocorrer porque a coleta de lixo recupera menos objetos.</span><span class="sxs-lookup"><span data-stu-id="bff2a-142">Low memory notifications can occur because garbage collection reclaims fewer objects.</span></span>

- <span data-ttu-id="bff2a-143">Enquanto estiver no modo de baixa latência, minimize o número de novas alocações, em particular alocações no grande monte de objetos e objetos fixos.</span><span class="sxs-lookup"><span data-stu-id="bff2a-143">While in the low latency mode, minimize the number of new allocations, in particular allocations onto the large object heap and pinned objects.</span></span>

- <span data-ttu-id="bff2a-144">Esteja atento a ameaças que possam ser alocadas.</span><span class="sxs-lookup"><span data-stu-id="bff2a-144">Be aware of threads that could be allocating.</span></span> <span data-ttu-id="bff2a-145">Como <xref:System.Runtime.GCSettings.LatencyMode%2A> a configuração de <xref:System.OutOfMemoryException> propriedade é em todo o processo, exceções podem ser geradas em qualquer segmento que esteja alocando.</span><span class="sxs-lookup"><span data-stu-id="bff2a-145">Because the <xref:System.Runtime.GCSettings.LatencyMode%2A> property setting is process-wide, <xref:System.OutOfMemoryException> exceptions can be generated on any thread that is allocating.</span></span>

- <span data-ttu-id="bff2a-146">Enrole o código de baixa latência em regiões de execução restritas.</span><span class="sxs-lookup"><span data-stu-id="bff2a-146">Wrap the low latency code in constrained execution regions.</span></span> <span data-ttu-id="bff2a-147">Para obter mais informações, consulte [regiões de execução restritas](../../../docs/framework/performance/constrained-execution-regions.md).</span><span class="sxs-lookup"><span data-stu-id="bff2a-147">For more information, see [Constrained execution regions](../../../docs/framework/performance/constrained-execution-regions.md).</span></span>

- <span data-ttu-id="bff2a-148">Você pode forçar coletas da geração 2 durante um período de baixa latência ao chamar o método <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bff2a-148">You can force generation 2 collections during a low latency period by calling the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType> method.</span></span>

## <a name="see-also"></a><span data-ttu-id="bff2a-149">Confira também</span><span class="sxs-lookup"><span data-stu-id="bff2a-149">See also</span></span>

- <xref:System.GC?displayProperty=nameWithType>
- [<span data-ttu-id="bff2a-150">Coletas Induzidas</span><span class="sxs-lookup"><span data-stu-id="bff2a-150">Induced Collections</span></span>](../../../docs/standard/garbage-collection/induced.md)
- [<span data-ttu-id="bff2a-151">Coleta de lixo</span><span class="sxs-lookup"><span data-stu-id="bff2a-151">Garbage Collection</span></span>](../../../docs/standard/garbage-collection/index.md)
