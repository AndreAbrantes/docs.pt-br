---
title: SpinWait
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: synchronization primitives, SpinWait
ms.assetid: 36012f42-34e5-4f86-adf4-973f433ed6c6
caps.latest.revision: "9"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: cfaf85c0fe1de3be89618ae540e9c183b66a11eb
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/21/2017
---
# <a name="spinwait"></a><span data-ttu-id="6eab5-102">SpinWait</span><span class="sxs-lookup"><span data-stu-id="6eab5-102">SpinWait</span></span>
<span data-ttu-id="6eab5-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType>é um tipo de sincronização leve que você pode usar em cenários de baixo nível para evitar as alternâncias de contexto caro e transições de kernel que são necessárias para eventos de kernel.</span><span class="sxs-lookup"><span data-stu-id="6eab5-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType> is a lightweight synchronization type that you can use in low-level scenarios to avoid the expensive context switches and kernel transitions that are required for kernel events.</span></span> <span data-ttu-id="6eab5-104">Em computadores com vários núcleos, quando um recurso não deve ser mantido por longos períodos de tempo, pode ser mais eficiente para um thread de espera executar no modo de usuário para alguns ciclos de dezenas de algumas centenas e, em seguida, tente novamente para adquirir o recurso.</span><span class="sxs-lookup"><span data-stu-id="6eab5-104">On multicore computers, when a resource is not expected to be held for long periods of time, it can be more efficient for a waiting thread to spin in user mode for a few dozen or a few hundred cycles, and then retry to acquire the resource.</span></span> <span data-ttu-id="6eab5-105">Se o recurso está disponível após a rotação, terá salvo vários ciclos de milhar.</span><span class="sxs-lookup"><span data-stu-id="6eab5-105">If the resource is available after spinning, then you have saved several thousand cycles.</span></span> <span data-ttu-id="6eab5-106">Se o recurso ainda não estiver disponível, você passou apenas alguns ciclos e ainda é possível inserir uma espera de kernel.</span><span class="sxs-lookup"><span data-stu-id="6eab5-106">If the resource is still not available, then you have spent only a few cycles and can still enter a kernel-based wait.</span></span> <span data-ttu-id="6eab5-107">Essa combinação de espera de, em seguida, girando às vezes é conhecida como um *operação bifásica de espera*.</span><span class="sxs-lookup"><span data-stu-id="6eab5-107">This spinning-then-waiting combination is sometimes referred to as a *two-phase wait operation*.</span></span>  
  
 <span data-ttu-id="6eab5-108"><xref:System.Threading.SpinWait>foi projetado para ser usado em conjunto com os tipos do .NET Framework que encapsulam os eventos de kernel como <xref:System.Threading.ManualResetEvent>.</span><span class="sxs-lookup"><span data-stu-id="6eab5-108"><xref:System.Threading.SpinWait> is designed to be used in conjunction with the .NET Framework types that wrap kernel events such as <xref:System.Threading.ManualResetEvent>.</span></span> <span data-ttu-id="6eab5-109"><xref:System.Threading.SpinWait>também pode ser usado por si só para a funcionalidade básica giratório em apenas um programa.</span><span class="sxs-lookup"><span data-stu-id="6eab5-109"><xref:System.Threading.SpinWait> can also be used by itself for basic spinning functionality in just one program.</span></span>  
  
 <span data-ttu-id="6eab5-110"><xref:System.Threading.SpinWait>é mais do que apenas um loop vazio.</span><span class="sxs-lookup"><span data-stu-id="6eab5-110"><xref:System.Threading.SpinWait> is more than just an empty loop.</span></span> <span data-ttu-id="6eab5-111">É implementado com cuidado para fornecer comportamento giratório correto para o caso geral e se inicia alternâncias de contexto se ele precisar tempo suficiente (aproximadamente o período de tempo necessário para uma transição de kernel).</span><span class="sxs-lookup"><span data-stu-id="6eab5-111">It is carefully implemented to provide correct spinning behavior for the general case, and will itself initiate context switches if it spins long enough (roughly the length of time required for a kernel transition).</span></span> <span data-ttu-id="6eab5-112">Por exemplo, em computadores de núcleo único, <xref:System.Threading.SpinWait> produz a fatia de tempo do thread imediatamente porque blocos giratório encaminham progresso em todos os threads.</span><span class="sxs-lookup"><span data-stu-id="6eab5-112">For example, on single-core computers, <xref:System.Threading.SpinWait> yields the time slice of the thread immediately because spinning blocks forward progress on all threads.</span></span> <span data-ttu-id="6eab5-113"><xref:System.Threading.SpinWait>também gera mesmo em máquinas com vários núcleos para impedir que o thread de espera de bloqueio de threads de prioridade mais alta ou o coletor de lixo.</span><span class="sxs-lookup"><span data-stu-id="6eab5-113"><xref:System.Threading.SpinWait> also yields even on multi-core machines to prevent the waiting thread from blocking higher-priority threads or the garbage collector.</span></span> <span data-ttu-id="6eab5-114">Portanto, se você estiver usando um <xref:System.Threading.SpinWait> em uma operação de espera de duas fases, recomendamos que você chamar a espera de kernel antes do <xref:System.Threading.SpinWait> se inicia uma alternância de contexto.</span><span class="sxs-lookup"><span data-stu-id="6eab5-114">Therefore, if you are using a <xref:System.Threading.SpinWait> in a two-phase wait operation, we recommend that you invoke the kernel wait before the <xref:System.Threading.SpinWait> itself initiates a context switch.</span></span> <span data-ttu-id="6eab5-115"><xref:System.Threading.SpinWait>fornece o <xref:System.Threading.SpinWait.NextSpinWillYield%2A> propriedade, que você pode verificar antes de cada chamada para <xref:System.Threading.SpinWait.SpinOnce%2A>.</span><span class="sxs-lookup"><span data-stu-id="6eab5-115"><xref:System.Threading.SpinWait> provides the <xref:System.Threading.SpinWait.NextSpinWillYield%2A> property, which you can check before every call to <xref:System.Threading.SpinWait.SpinOnce%2A>.</span></span> <span data-ttu-id="6eab5-116">Quando a propriedade retornar `true`, iniciar sua operação de espera.</span><span class="sxs-lookup"><span data-stu-id="6eab5-116">When the property returns `true`, initiate your own Wait operation.</span></span> <span data-ttu-id="6eab5-117">Para obter um exemplo, consulte [como: usar SpinWait para implementar uma operação de espera de confirmação de duas fases](../../../docs/standard/threading/how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span><span class="sxs-lookup"><span data-stu-id="6eab5-117">For an example, see [How to: Use SpinWait to Implement a Two-Phase Wait Operation](../../../docs/standard/threading/how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span></span>  
  
 <span data-ttu-id="6eab5-118">Se você não estiver executando uma operação de espera de duas fases, mas é apenas girando até que alguma condição for verdadeira, você pode habilitar <xref:System.Threading.SpinWait> executar seu contexto alterna para que seja um bom cidadão no ambiente do sistema operacional Windows.</span><span class="sxs-lookup"><span data-stu-id="6eab5-118">If you are not performing a two-phase wait operation but are just spinning until some condition is true, you can enable <xref:System.Threading.SpinWait> to perform its context switches so that it is a good citizen in the Windows operating system environment.</span></span> <span data-ttu-id="6eab5-119">O exemplo básico a seguir mostra um <xref:System.Threading.SpinWait> em uma pilha sem bloqueio.</span><span class="sxs-lookup"><span data-stu-id="6eab5-119">The following basic example shows a <xref:System.Threading.SpinWait> in a lock-free stack.</span></span> <span data-ttu-id="6eab5-120">Se você precisar de uma pilha de alto desempenho, thread-safe, considere o uso de <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6eab5-120">If you require a high-performance, thread-safe stack, consider using <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[CDS_SpinWait#05](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_spinwait/cs/spinwait.cs#05)]
 [!code-vb[CDS_SpinWait#05](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_spinwait/vb/cds_spinwait1.vb#05)]  
  
## <a name="see-also"></a><span data-ttu-id="6eab5-121">Consulte também</span><span class="sxs-lookup"><span data-stu-id="6eab5-121">See Also</span></span>  
 <xref:System.Threading.Thread.SpinWait%2A>  
 [<span data-ttu-id="6eab5-122">Objetos e recursos de threading</span><span class="sxs-lookup"><span data-stu-id="6eab5-122">Threading Objects and Features</span></span>](../../../docs/standard/threading/threading-objects-and-features.md)
