---
title: "Aplicativos monolíticos containerizing"
description: "Arquitetura de Microservices .NET para aplicativos .NET em contêineres | Aplicativos monolíticos containerizing"
keywords: "Docker, Microsserviços, ASP.NET, Contêiner"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 11e2c24403b9b61584e424696c844e00e5d34b03
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/21/2017
---
# <a name="containerizing-monolithic-applications"></a><span data-ttu-id="8e537-104">Aplicativos monolíticos containerizing</span><span class="sxs-lookup"><span data-stu-id="8e537-104">Containerizing monolithic applications</span></span>

<span data-ttu-id="8e537-105">Você talvez queira criar um aplicativo web única, monolithically implantado ou serviço e implantá-lo como um contêiner.</span><span class="sxs-lookup"><span data-stu-id="8e537-105">You might want to build a single, monolithically deployed web application or service and deploy it as a container.</span></span> <span data-ttu-id="8e537-106">O aplicativo em si pode não ser monolítico internamente, mas estruturados como várias bibliotecas, componentes ou até mesmo camadas (camada de aplicativo, camada de domínio, camada de acesso a dados, etc.).</span><span class="sxs-lookup"><span data-stu-id="8e537-106">The application itself might not be internally monolithic, but structured as several libraries, components, or even layers (application layer, domain layer, data-access layer, etc.).</span></span> <span data-ttu-id="8e537-107">Externamente, no entanto, é um único contêiner — um único processo, um único aplicativo web ou um único serviço.</span><span class="sxs-lookup"><span data-stu-id="8e537-107">Externally, however, it is a single container—a single process, a single web application, or a single service.</span></span>

<span data-ttu-id="8e537-108">Para gerenciar esse modelo, você deve implantar um único contêiner para representar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e537-108">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="8e537-109">Para dimensionar o, adicione mais cópias com um balanceador de carga na frente.</span><span class="sxs-lookup"><span data-stu-id="8e537-109">To scale up, you just add more copies with a load balancer in front.</span></span> <span data-ttu-id="8e537-110">A simplicidade é proveniente do gerenciamento de uma única implantação em um único contêiner ou VM.</span><span class="sxs-lookup"><span data-stu-id="8e537-110">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![](./media/image1.png)

<span data-ttu-id="8e537-111">**Figura 4-1**.</span><span class="sxs-lookup"><span data-stu-id="8e537-111">**Figure 4-1**.</span></span> <span data-ttu-id="8e537-112">Exemplo de arquitetura de um aplicativo monolítico em contêineres</span><span class="sxs-lookup"><span data-stu-id="8e537-112">Example of the architecture of a containerized monolithic application</span></span>

<span data-ttu-id="8e537-113">Você pode incluir vários componentes, bibliotecas ou camadas internas em cada contêiner, conforme ilustrado na Figura 4-1.</span><span class="sxs-lookup"><span data-stu-id="8e537-113">You can include multiple components, libraries, or internal layers in each container, as illustrated in Figure 4-1.</span></span> <span data-ttu-id="8e537-114">No entanto, esse padrão monolítico entrarem em conflito com o princípio de contêiner "um contêiner executa uma ação e faz isso em um processo", mas podem ser okey para alguns casos.</span><span class="sxs-lookup"><span data-stu-id="8e537-114">However, this monolithic pattern might conflict with the container principle “a container does one thing, and does it in one process”, but might be ok for some cases.</span></span>

<span data-ttu-id="8e537-115">A desvantagem dessa abordagem fica evidente se o aplicativo cresce, solicitá-la para dimensionar.</span><span class="sxs-lookup"><span data-stu-id="8e537-115">The downside of this approach becomes evident if the application grows, requiring it to scale.</span></span> <span data-ttu-id="8e537-116">Se o aplicativo inteiro pode ser dimensionado, não é realmente um problema.</span><span class="sxs-lookup"><span data-stu-id="8e537-116">If the entire application can scale, it is not really a problem.</span></span> <span data-ttu-id="8e537-117">No entanto, na maioria dos casos, apenas algumas partes do aplicativo são os pontos de restrição que exigir dimensionamento, enquanto outros componentes são menos usado.</span><span class="sxs-lookup"><span data-stu-id="8e537-117">However, in most cases, just a few parts of the application are the choke points that requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="8e537-118">Por exemplo, em um aplicativo de comércio eletrônico típico, você provavelmente precisa dimensionar o subsistema de informações do produto, porque muitos clientes mais procurem produtos de comprá-las.</span><span class="sxs-lookup"><span data-stu-id="8e537-118">For example, in a typical e-commerce application, you likely need to scale the product information subsystem, because many more customers browse products than purchase them.</span></span> <span data-ttu-id="8e537-119">Mais clientes usam seu carrinho de usar o pipeline de pagamento.</span><span class="sxs-lookup"><span data-stu-id="8e537-119">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="8e537-120">Os clientes menos adicionem comentários ou exibam seu histórico de compra.</span><span class="sxs-lookup"><span data-stu-id="8e537-120">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="8e537-121">E você pode ter apenas uma série de funcionários, o que precisa para gerenciar o conteúdo e campanhas de marketing.</span><span class="sxs-lookup"><span data-stu-id="8e537-121">And you might have only a handful of employees, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="8e537-122">Se você expandir o design monolítico, todo o código para essas tarefas diferentes é implantado várias vezes e dimensionado na mesma classificação.</span><span class="sxs-lookup"><span data-stu-id="8e537-122">If you scale the monolithic design, all the code for these different tasks is deployed multiple times and scaled at the same grade.</span></span>

<span data-ttu-id="8e537-123">Há várias maneiras para dimensionar um aplicativo – eliminação de duplicação horizontal, divisão de diferentes áreas do aplicativo e particionamento conceitos semelhantes de negócios ou dados.</span><span class="sxs-lookup"><span data-stu-id="8e537-123">There are multiple ways to scale an application—horizontal duplication, splitting different areas of the application, and partitioning similar business concepts or data.</span></span> <span data-ttu-id="8e537-124">No entanto, o problema de dimensionamento de todos os componentes, além de alterações para um único componente exigem teste completa de todo o aplicativo e uma reimplantação completa de todas as instâncias.</span><span class="sxs-lookup"><span data-stu-id="8e537-124">But, in addition to the problem of scaling all components, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="8e537-125">No entanto, a abordagem monolítica é comum, pois o desenvolvimento do aplicativo é inicialmente muito mais fácil para microservices abordagens.</span><span class="sxs-lookup"><span data-stu-id="8e537-125">However, the monolithic approach is common, because the development of the application is initially easier than for microservices approaches.</span></span> <span data-ttu-id="8e537-126">Portanto, muitas organizações desenvolvem usando essa abordagem de arquitetura.</span><span class="sxs-lookup"><span data-stu-id="8e537-126">Thus, many organizations develop using this architectural approach.</span></span> <span data-ttu-id="8e537-127">Embora algumas empresas tiveram bons resultados suficientes, outros estão atingindo os limites.</span><span class="sxs-lookup"><span data-stu-id="8e537-127">While some organizations have had good enough results, others are hitting limits.</span></span> <span data-ttu-id="8e537-128">Muitas organizações projetado seus aplicativos usando esse modelo, como as ferramentas e infraestrutura feitas muito difícil criar serviço arquiteturas orientadas a (SOA) anos, e não encontrou a necessidade, até que o aplicativo aumentou.</span><span class="sxs-lookup"><span data-stu-id="8e537-128">Many organizations designed their applications using this model because tools and infrastructure made it too difficult to build service oriented architectures (SOA) years ago, and they did not see the need—until the application grew.</span></span>

<span data-ttu-id="8e537-129">De uma perspectiva de infraestrutura, cada servidor pode executar muitos aplicativos dentro do mesmo host e têm uma taxa aceitável de eficiência no uso de recursos, como mostrado na Figura 4-2.</span><span class="sxs-lookup"><span data-stu-id="8e537-129">From an infrastructure perspective, each server can run many applications within the same host and have an acceptable ratio of efficiency in resources usage, as shown in Figure 4-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="8e537-130">**Figura 4-2**.</span><span class="sxs-lookup"><span data-stu-id="8e537-130">**Figure 4-2**.</span></span> <span data-ttu-id="8e537-131">Abordagem monolítica: Host executando vários aplicativos, cada aplicativo em execução como um contêiner</span><span class="sxs-lookup"><span data-stu-id="8e537-131">Monolithic approach: Host running multiple apps, each app running as a container</span></span>

<span data-ttu-id="8e537-132">Monolíticos aplicativos no Microsoft Azure podem ser implantados usando VMs dedicadas para cada instância.</span><span class="sxs-lookup"><span data-stu-id="8e537-132">Monolithic applications in Microsoft Azure can be deployed using dedicated VMs for each instance.</span></span> <span data-ttu-id="8e537-133">Além disso, usando [conjuntos de escala de VM do Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), você pode facilmente dimensionar as VMs.</span><span class="sxs-lookup"><span data-stu-id="8e537-133">Additionally, using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="8e537-134">[Serviço de aplicativo do Azure](https://azure.microsoft.com/services/app-service/) pode também executar aplicativos monolíticos e expandir facilmente instâncias sem a necessidade de gerenciar as máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="8e537-134">[Azure App Service](https://azure.microsoft.com/services/app-service/) can also run monolithic applications and easily scale instances without requiring you to manage the VMs.</span></span> <span data-ttu-id="8e537-135">Desde 2016, serviços de aplicativo do Azure pode executar instâncias únicas de contêineres do Docker, simplificando a implantação.</span><span class="sxs-lookup"><span data-stu-id="8e537-135">Since 2016, Azure App Services can run single instances of Docker containers as well, simplifying deployment.</span></span>

<span data-ttu-id="8e537-136">Como um ambiente de controle de qualidade ou em um ambiente de produção limitado, você pode implantar o host do Docker várias VMs e equilibrá-los usando o balanceador do Azure, conforme mostrado na Figura 4-3.</span><span class="sxs-lookup"><span data-stu-id="8e537-136">As a QA environment or a limited production environment, you can deploy multiple Docker host VMs and balance them using the Azure balancer, as shown in Figure 4-3.</span></span> <span data-ttu-id="8e537-137">Isso permite que você gerencie dimensionamento com uma abordagem de alta granularidade, porque todo o aplicativo reside em um único contêiner.</span><span class="sxs-lookup"><span data-stu-id="8e537-137">This lets you manage scaling with a coarse-grain approach, because the whole application lives within a single container.</span></span>

![](./media/image3.png)

<span data-ttu-id="8e537-138">**Figura 4-3**.</span><span class="sxs-lookup"><span data-stu-id="8e537-138">**Figure 4-3**.</span></span> <span data-ttu-id="8e537-139">Exemplo de vários hosts de dimensionamento de um aplicativo de contêiner único</span><span class="sxs-lookup"><span data-stu-id="8e537-139">Example of multiple hosts scaling up a single container application</span></span>

<span data-ttu-id="8e537-140">Implantação em vários hosts pode ser gerenciada com as técnicas tradicionais de implantação.</span><span class="sxs-lookup"><span data-stu-id="8e537-140">Deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="8e537-141">Hosts de docker podem ser gerenciados com comandos como `docker run` ou `docker-compose` executada manualmente ou através da automação, como os pipelines de fornecimento contínuo (CD).</span><span class="sxs-lookup"><span data-stu-id="8e537-141">Docker hosts can be managed with commands like `docker run` or `docker-compose` performed manually, or through automation such as continuous delivery (CD) pipelines.</span></span>

## <a name="deploying-a-monolithic-application-as-a-container"></a><span data-ttu-id="8e537-142">Implantando um aplicativo monolítico como um contêiner</span><span class="sxs-lookup"><span data-stu-id="8e537-142">Deploying a monolithic application as a container</span></span>

<span data-ttu-id="8e537-143">Há benefícios de usar contêineres para gerenciar implantações de aplicativo monolítico.</span><span class="sxs-lookup"><span data-stu-id="8e537-143">There are benefits to using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="8e537-144">Dimensionamento de instâncias de contêiner é muito mais rápido e mais fácil do que a implantação de VMs adicionais.</span><span class="sxs-lookup"><span data-stu-id="8e537-144">Scaling container instances is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="8e537-145">Mesmo se você usar conjuntos de escala de VM, VMs levar tempo para iniciar.</span><span class="sxs-lookup"><span data-stu-id="8e537-145">Even if you use VM Scale Sets, VMs take time to start.</span></span> <span data-ttu-id="8e537-146">Quando implantado como instâncias de aplicativo tradicional, em vez de contêineres, a configuração do aplicativo é gerenciada como parte da VM, que não é ideal.</span><span class="sxs-lookup"><span data-stu-id="8e537-146">When deployed as traditional application instances instead of containers, the configuration of the application is managed as part of the VM, which is not ideal.</span></span>

<span data-ttu-id="8e537-147">Implantando atualizações como imagens do Docker é muito mais rápida e eficiente de rede.</span><span class="sxs-lookup"><span data-stu-id="8e537-147">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="8e537-148">Imagens do docker geralmente iniciam em segundos, que agiliza a implementação.</span><span class="sxs-lookup"><span data-stu-id="8e537-148">Docker images typically start in seconds, which speeds rollouts.</span></span> <span data-ttu-id="8e537-149">Subdividir uma instância de imagem do Docker é tão fácil quanto emitir um `docker stop` de comando e normalmente é concluído em menos de um segundo.</span><span class="sxs-lookup"><span data-stu-id="8e537-149">Tearing down a Docker image instance is as easy as issuing a `docker stop` command, and typically completes in less than a second.</span></span>

<span data-ttu-id="8e537-150">Como contêineres são imutáveis por design, você nunca precisa se preocupar sobre VMs corrompidas.</span><span class="sxs-lookup"><span data-stu-id="8e537-150">Because containers are immutable by design, you never need to worry about corrupted VMs.</span></span> <span data-ttu-id="8e537-151">Em contraste, os scripts de atualização de uma VM podem esquecer de conta para alguma configuração específica ou o arquivo deixado no disco.</span><span class="sxs-lookup"><span data-stu-id="8e537-151">In contrast, update scripts for a VM might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="8e537-152">Enquanto monolíticos aplicativos podem se beneficiar do Docker, podemos tocam somente sobre os benefícios.</span><span class="sxs-lookup"><span data-stu-id="8e537-152">While monolithic applications can benefit from Docker, we are touching only on the benefits.</span></span> <span data-ttu-id="8e537-153">Benefícios adicionais de gerenciamento de contêineres vêm da implantação de orchestrators do contêiner, que gerencia as várias instâncias e ciclo de vida de cada instância de contêiner.</span><span class="sxs-lookup"><span data-stu-id="8e537-153">Additional benefits of managing containers come from deploying with container orchestrators, which manage the various instances and lifecycle of each container instance.</span></span> <span data-ttu-id="8e537-154">Dividir o aplicativo monolítico em subsistemas que pode ser dimensionado, desenvolvidos e implantados individualmente é o ponto de entrada para o território de microservices.</span><span class="sxs-lookup"><span data-stu-id="8e537-154">Breaking up the monolithic application into subsystems that can be scaled, developed, and deployed individually is your entry point into the realm of microservices.</span></span>

## <a name="publishing-a-single-container-based-application-to-azure-app-service"></a><span data-ttu-id="8e537-155">Publicar um aplicativo com base em contêiner único para o serviço de aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="8e537-155">Publishing a single-container-based application to Azure App Service</span></span>

<span data-ttu-id="8e537-156">Se você deseja obter a validação de um contêiner implantado no Azure, ou quando um aplicativo é simplesmente um aplicativo de contêiner de único, o serviço de aplicativo do Azure fornece uma ótima maneira de fornecer serviços escalonáveis com base em contêiner único.</span><span class="sxs-lookup"><span data-stu-id="8e537-156">Whether you want to get validation of a container deployed to Azure or when an application is simply a single-container application, Azure App Service provides a great way to provide scalable single-container-based services.</span></span> <span data-ttu-id="8e537-157">Usar o serviço de aplicativo do Azure é simple.</span><span class="sxs-lookup"><span data-stu-id="8e537-157">Using Azure App Service is simple.</span></span> <span data-ttu-id="8e537-158">Ele fornece uma excelente integração com o Git para tornar mais fácil executar seu código, compile-o no Visual Studio e implantá-lo diretamente no Azure.</span><span class="sxs-lookup"><span data-stu-id="8e537-158">It provides great integration with Git to make it easy to take your code, build it in Visual Studio, and deploy it directly to Azure.</span></span>

![](./media/image4.png)

<span data-ttu-id="8e537-159">**Figura 4-4**.</span><span class="sxs-lookup"><span data-stu-id="8e537-159">**Figure 4-4**.</span></span> <span data-ttu-id="8e537-160">Publicar um aplicativo de contêiner único para o serviço de aplicativo do Azure do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="8e537-160">Publishing a single-container application to Azure App Service from Visual Studio</span></span>

<span data-ttu-id="8e537-161">Sem Docker, se precisar de outros recursos, estruturas ou dependências que não há suporte para o serviço de aplicativo do Azure, era necessário aguardar até que a equipe do Azure atualizada essas dependências no serviço de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e537-161">Without Docker, if you needed other capabilities, frameworks, or dependencies that are not supported in Azure App Service, you had to wait until the Azure team updated those dependencies in App Service.</span></span> <span data-ttu-id="8e537-162">Ou você tinha que alternar para outros serviços, como o Azure Service Fabric, serviços de nuvem do Azure ou até mesmo VMs, em que você tinha mais controle e você pode instalar um componente necessário ou a estrutura do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8e537-162">Or you had to switch to other services like Azure Service Fabric, Azure Cloud Services, or even VMs, where you had further control and you could install a required component or framework for your application.</span></span>

<span data-ttu-id="8e537-163">Suporte de contêiner no Visual Studio de 2017 fornece a capacidade de incluir tudo o que você deseja em seu ambiente de aplicativo, conforme mostrado na Figura 4-4.</span><span class="sxs-lookup"><span data-stu-id="8e537-163">Container support in Visual Studio 2017 gives you the ability to include whatever you want in your application environment, as shown in Figure 4-4.</span></span> <span data-ttu-id="8e537-164">Desde que esteja executando-o em um contêiner, se você adicionar uma dependência ao seu aplicativo, você pode incluir a dependência na imagem Dockerfile ou Docker.</span><span class="sxs-lookup"><span data-stu-id="8e537-164">Since you are running it in a container, if you add a dependency to your application, you can include the dependency in your Dockerfile or Docker image.</span></span>

<span data-ttu-id="8e537-165">Como também é mostrado na Figura 4-4, o fluxo de publicação envia uma imagem por meio de um registro de contêiner.</span><span class="sxs-lookup"><span data-stu-id="8e537-165">As also shown in Figure 4-4, the publish flow pushes an image through a container registry.</span></span> <span data-ttu-id="8e537-166">Isso pode ser o registro de contêiner do Azure (um registro Fechar para suas implantações no Azure e protegido por contas e grupos do Active Directory do Azure), ou qualquer outro registro de Docker, como o Hub do Docker ou um registro de local.</span><span class="sxs-lookup"><span data-stu-id="8e537-166">This can be the Azure Container Registry (a registry close to your deployments in Azure and secured by Azure Active Directory groups and accounts), or any other Docker registry, like Docker Hub or an on-premises registry.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="8e537-167">[Anterior] (index.md) [Avançar] (docker-aplicativo-estado-data.md)</span><span class="sxs-lookup"><span data-stu-id="8e537-167">[Previous] (index.md) [Next] (docker-application-state-data.md)</span></span>
