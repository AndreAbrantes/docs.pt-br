---
title: "Comunicação direta do cliente para microsserviços versus o padrão de Gateway de API"
description: "Arquitetura de microsserviços .NET para aplicativos .NET em contêineres | Comunicação direta de cliente com microsserviço versus o padrão de Gateway de API"
keywords: "Docker, Microsserviços, ASP.NET, Contêiner, Gateway de API"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 96a02958ef5750aec7a92ff0dd145edc15a5953a
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/23/2017
---
# <a name="direct-client-to-microservice-communication-versus-the-api-gateway-pattern"></a><span data-ttu-id="3b167-104">Comunicação direta do cliente para microsserviços versus o padrão de Gateway de API</span><span class="sxs-lookup"><span data-stu-id="3b167-104">Direct client-to-microservice communication versus the API Gateway pattern</span></span>

<span data-ttu-id="3b167-105">Em uma arquitetura de microsserviços, cada microsserviço expõe um conjunto de pontos de extremidade (tipicamente) refinados.</span><span class="sxs-lookup"><span data-stu-id="3b167-105">In a microservices architecture, each microservice exposes a set of (typically) fine‑grained endpoints.</span></span> <span data-ttu-id="3b167-106">Esse fato pode afetar a comunicação de cliente com microsserviço conforme explicado nesta seção.</span><span class="sxs-lookup"><span data-stu-id="3b167-106">This fact can impact the client‑to‑microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="3b167-107">Comunicação direta de cliente com microsserviço</span><span class="sxs-lookup"><span data-stu-id="3b167-107">Direct client-to-microservice communication</span></span>

<span data-ttu-id="3b167-108">Uma abordagem possível é usar uma arquitetura de comunicação direta de cliente com microsserviço.</span><span class="sxs-lookup"><span data-stu-id="3b167-108">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="3b167-109">Nessa abordagem, um aplicativo cliente pode fazer solicitações diretamente para alguns dos microsserviços, conforme mostra a Figura 4-12.</span><span class="sxs-lookup"><span data-stu-id="3b167-109">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![](./media/image12.png)

<span data-ttu-id="3b167-110">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="3b167-110">**Figure 4-12**.</span></span> <span data-ttu-id="3b167-111">Usando uma arquitetura de comunicação direta de cliente com microsserviço</span><span class="sxs-lookup"><span data-stu-id="3b167-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="3b167-112">Nesta abordagem,</span><span class="sxs-lookup"><span data-stu-id="3b167-112">In this approach.</span></span> <span data-ttu-id="3b167-113">cada microsserviço tem um ponto de extremidade público, às vezes, com uma porta TCP diferente para cada microsserviço.</span><span class="sxs-lookup"><span data-stu-id="3b167-113">each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="3b167-114">Um exemplo de uma URL para um serviço específico pode ser a URL a seguir no Azure:</span><span class="sxs-lookup"><span data-stu-id="3b167-114">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<span data-ttu-id="3b167-115"><http://eshoponcontainers.westus.cloudapp.azure.com:88/></span><span class="sxs-lookup"><span data-stu-id="3b167-115"><http://eshoponcontainers.westus.cloudapp.azure.com:88/></span></span>

<span data-ttu-id="3b167-116">Em um ambiente de produção com base em um cluster, essa URL mapearia para o balanceador de carga usado no cluster, que, por sua vez, distribui as solicitações entre os microsserviços.</span><span class="sxs-lookup"><span data-stu-id="3b167-116">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="3b167-117">Em ambientes de produção, você pode ter um ADC (Controlador de Entrega de Aplicativo) como o [Gateway de Aplicativo do Azure](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) entre os microsserviços e a Internet.</span><span class="sxs-lookup"><span data-stu-id="3b167-117">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="3b167-118">Isso funciona como uma camada transparente que não executa balanceamento de carga, mas protege seus serviços ao oferecer terminação SSL.</span><span class="sxs-lookup"><span data-stu-id="3b167-118">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="3b167-119">Isso aumenta a carga de seus hosts descarregando terminação SSL com uso intensivo de CPU e outras tarefas de roteamento para o Gateway de Aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b167-119">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="3b167-120">Em qualquer caso, um balanceador de carga e ADC são transparentes de um ponto de vista da arquitetura do aplicativo lógico.</span><span class="sxs-lookup"><span data-stu-id="3b167-120">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="3b167-121">Uma arquitetura de comunicação direta de cliente com microsserviço pode ser boa o bastante para um aplicativo baseado em microsserviço pequeno, especialmente se o aplicativo cliente for um aplicativo Web do lado do servidor como um aplicativo ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="3b167-121">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="3b167-122">No entanto, quando você cria aplicativos grandes e complexos baseados em microsserviço (por exemplo, ao lidar com dezenas de tipos de microsserviço), e especialmente quando os aplicativos cliente são aplicativos móveis remotos ou aplicativos Web do SPA, essa abordagem enfrenta alguns problemas.</span><span class="sxs-lookup"><span data-stu-id="3b167-122">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="3b167-123">Considere as seguintes questões ao desenvolver um aplicativo grande com base em microsserviços:</span><span class="sxs-lookup"><span data-stu-id="3b167-123">Consider the following questions when developing a large application based on microservices:</span></span>

-   <span data-ttu-id="3b167-124">*Como os aplicativos cliente podem minimizar o número de solicitações para o back-end e reduzir a comunicação verborrágica com vários microsserviços?*</span><span class="sxs-lookup"><span data-stu-id="3b167-124">*How can client apps minimize the number of requests to the backend and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="3b167-125">Interagir com vários microsserviços para criar uma única tela de interface do usuário aumenta o número de viagens de ida e volta pela Internet.</span><span class="sxs-lookup"><span data-stu-id="3b167-125">Interacting with multiple microservices to build a single UI screen increases the number of roundtrips across the Internet.</span></span> <span data-ttu-id="3b167-126">Isso aumenta a latência e a complexidade do lado da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b167-126">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="3b167-127">Idealmente, as respostas devem ser agregadas com eficiência no lado do servidor; isso reduz a latência, já que várias partes de dados voltam em paralelo e algumas interfaces do usuário podem mostrar dados assim que eles estão prontos.</span><span class="sxs-lookup"><span data-stu-id="3b167-127">Ideally, responses should be efficiently aggregated in the server side—this reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it is ready.</span></span>

-   <span data-ttu-id="3b167-128">*Como você pode lidar com preocupações abrangentes, como autorização, transformações de dados e despacho de solicitação dinâmica?*</span><span class="sxs-lookup"><span data-stu-id="3b167-128">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="3b167-129">Implementar preocupações relativas a segurança e abrangentes, como segurança e autorização em cada microsserviço, pode exigir um esforço significativo de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="3b167-129">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="3b167-130">Uma abordagem possível é ter esses serviços no host do Docker ou no cluster interno para restringir o acesso direto a eles do lado de fora e para implementar essas preocupações abrangentes em um local centralizado, como um Gateway de API.</span><span class="sxs-lookup"><span data-stu-id="3b167-130">A possible approach is to have those services within the Docker host or internal cluster, in order to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

-   <span data-ttu-id="3b167-131">*Como os aplicativos cliente podem se comunicar com serviços que usam protocolos não amigáveis à Internet?*</span><span class="sxs-lookup"><span data-stu-id="3b167-131">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="3b167-132">Protocolos usados no lado do servidor (como AMQP ou protocolos binários) geralmente não são compatíveis com aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-132">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="3b167-133">Portanto, as solicitações devem ser executadas por meio de protocolos como HTTP/HTTPS e convertidas em outros protocolos posteriormente.</span><span class="sxs-lookup"><span data-stu-id="3b167-133">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="3b167-134">Uma abordagem *man-in-the-middle* pode ajudar nessa situação.</span><span class="sxs-lookup"><span data-stu-id="3b167-134">A *man-in-the-middle* approach can help in this situation.</span></span>

-   <span data-ttu-id="3b167-135">*Como você pode formatar uma fachada feita especialmente para aplicativos móveis?*</span><span class="sxs-lookup"><span data-stu-id="3b167-135">*How can you shape a façade especially made for mobile apps?*</span></span>

<span data-ttu-id="3b167-136">A API de vários microsserviços podem não ser bem projetadas para as necessidades de diferentes aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-136">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="3b167-137">Por exemplo, as necessidades de um aplicativo móvel podem ser diferentes das necessidades de um aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="3b167-137">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="3b167-138">Para aplicativos móveis, convém otimizar ainda mais para que as respostas de dados possam ser mais eficientes.</span><span class="sxs-lookup"><span data-stu-id="3b167-138">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="3b167-139">Você pode fazer isso agregando dados de vários microsserviços e retornando um único conjunto de dados, e às vezes eliminando quaisquer dados na resposta que não sejam necessários para o aplicativo móvel.</span><span class="sxs-lookup"><span data-stu-id="3b167-139">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that is not needed by the mobile app.</span></span> <span data-ttu-id="3b167-140">E, claro, você pode compactar dados.</span><span class="sxs-lookup"><span data-stu-id="3b167-140">And, of course, you might compress that data.</span></span> <span data-ttu-id="3b167-141">Novamente, uma API ou fachada entre o aplicativo móvel e os microsserviços pode ser conveniente para esse cenário.</span><span class="sxs-lookup"><span data-stu-id="3b167-141">Again, a façade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="using-an-api-gateway"></a><span data-ttu-id="3b167-142">Usando um Gateway de API</span><span class="sxs-lookup"><span data-stu-id="3b167-142">Using an API Gateway</span></span>

<span data-ttu-id="3b167-143">Quando você projeta e cria aplicativos grandes ou complexos baseado em microsserviço com vários aplicativos cliente, uma boa abordagem a considerar pode ser um [Gateway de API](http://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="3b167-143">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](http://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="3b167-144">Esse é um serviço que fornece um único ponto de entrada para determinados grupos de microsserviços.</span><span class="sxs-lookup"><span data-stu-id="3b167-144">This is a service that provides a single entry point for certain groups of microservices.</span></span> <span data-ttu-id="3b167-145">É semelhante ao [padrão Fachada](https://en.wikipedia.org/wiki/Facade_pattern) do design orientada a objeto, mas, neste caso, faz parte de um sistema distribuído.</span><span class="sxs-lookup"><span data-stu-id="3b167-145">It is similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object‑oriented design, but in this case, it is part of a distributed system.</span></span> <span data-ttu-id="3b167-146">O padrão de Gateway de API às vezes também é conhecido como [BFF](http://samnewman.io/patterns/architectural/bff/) ("back-end para front-end"), porque ele é criado pensando nas necessidades do aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-146">The API Gateway pattern is also sometimes known as the “backend for frontend” [(BFF)](http://samnewman.io/patterns/architectural/bff/) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="3b167-147">A Figura 4-13 mostra como um Gateway de API personalizado pode se enquadrar em uma arquitetura baseada em microsserviço.</span><span class="sxs-lookup"><span data-stu-id="3b167-147">Figure 4-13 shows how a custom API Gateway can fit into a microservice-based architecture.</span></span>
<span data-ttu-id="3b167-148">É importante destacar que, neste diagrama, você usa um único serviço de Gateway de API personalizado voltada para vários aplicativos cliente diferentes.</span><span class="sxs-lookup"><span data-stu-id="3b167-148">It is important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="3b167-149">Esse fato pode ser um risco importante, pois seu serviço de Gateway de API estará crescendo e em evolução com base em vários requisitos diferentes dos aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-149">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="3b167-150">Eventualmente, ele será inflado devido a essas necessidades diferentes e efetivamente pode ser muito semelhante a um aplicativo monolítico ou serviço monolítico.</span><span class="sxs-lookup"><span data-stu-id="3b167-150">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="3b167-151">É por isso que é muito recomendável dividir o Gateway de API em vários serviços ou vários Gateways API menores, um por tipo de fator forma, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="3b167-151">That is why it is very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per form-factor type, for instance.</span></span>

![](./media/image13.png)

<span data-ttu-id="3b167-152">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="3b167-152">**Figure 4-13**.</span></span> <span data-ttu-id="3b167-153">Usando um Gateway de API implementado como um serviço de API Web personalizado</span><span class="sxs-lookup"><span data-stu-id="3b167-153">Using an API Gateway implemented as a custom Web API service</span></span>

<span data-ttu-id="3b167-154">Neste exemplo, o Gateway de API deve ser implementado como um serviço de API Web personalizado em execução como um contêiner.</span><span class="sxs-lookup"><span data-stu-id="3b167-154">In this example, the API Gateway would be implemented as a custom Web API service running as a container.</span></span>

<span data-ttu-id="3b167-155">Conforme mencionado, você deve implementar vários Gateways de API para que possa ter uma fachada diferente para as necessidades de cada aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-155">As mentioned, you should implement several API Gateways so that you can have a different façade for the needs of each client app.</span></span> <span data-ttu-id="3b167-156">Cada Gateway de API pode fornecer uma API diferente personalizada para cada aplicativo cliente, possivelmente até mesmo com base no fator forma de cliente implementando código adaptador específico que chama, em segundo plano, vários microsserviços internos.</span><span class="sxs-lookup"><span data-stu-id="3b167-156">Each API Gateway can provide a different API tailored for each client app, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices.</span></span>

<span data-ttu-id="3b167-157">Uma vez que um Gateway de API personalizado é geralmente um agregador de dados, você precisa ter cuidado com ele.</span><span class="sxs-lookup"><span data-stu-id="3b167-157">Since a custom API Gateway is usually a data aggregator, you need to be careful with it.</span></span> <span data-ttu-id="3b167-158">Geralmente, não é recomendável ter um único Gateway de API para agregar todos os microsserviços internos do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b167-158">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="3b167-159">Em caso afirmativo, ele atua como um agregador ou orquestrador monolítico e viola a autonomia de microsserviço acoplando todos os microsserviços.</span><span class="sxs-lookup"><span data-stu-id="3b167-159">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span> <span data-ttu-id="3b167-160">Portanto, os Gateways de API devem estar segregados com base nos limites de negócios e não agir como um agregador para todo o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b167-160">Therefore, the API Gateways should be segregated based on business boundaries and not act as an aggregator for the whole application.</span></span>

<span data-ttu-id="3b167-161">Às vezes, um Gateway de API granular também pode ser um microsserviço em si e ter, inclusive, um domínio ou nome da empresa e dados relacionados.</span><span class="sxs-lookup"><span data-stu-id="3b167-161">Sometimes a granular API Gateway can also be a microservice by itself, and even have a domain or business name and related data.</span></span> <span data-ttu-id="3b167-162">Ter os limites de API do Gateway determinados pela empresa ou domínio ajudará a obter um melhor design.</span><span class="sxs-lookup"><span data-stu-id="3b167-162">Having the API Gateway’s boundaries dictated by the business or domain will help you to get a better design.</span></span>

<span data-ttu-id="3b167-163">A granularidade na camada de API de Gateway pode ser especialmente útil para mais avançados aplicativos compostos de interface do usuário com base em microsserviços, pois o conceito de um Gateway de API refinado é semelhante a um serviço de composição de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="3b167-163">Granularity in the API Gateway tier can be especially useful for more advanced composite UI applications based on microservices, because the concept of a fine-grained API Gateway is similar to a UI composition service.</span></span> <span data-ttu-id="3b167-164">Discutiremos isso mais tarde em [Criando uma interface do usuário composta com base em microsserviços](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span><span class="sxs-lookup"><span data-stu-id="3b167-164">We discuss this later in the [Creating composite UI based on microservices](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span></span>

<span data-ttu-id="3b167-165">Portanto, para muitos aplicativos de médio e grande porte, usar um Gateway de API personalizado costuma ser uma boa abordagem, mas não como um único agregador monolítico ou Gateway de API personalizado central exclusivo.</span><span class="sxs-lookup"><span data-stu-id="3b167-165">Therefore, for many medium- and large-size applications, using a custom-built API Gateway is usually a good approach, but not as a single monolithic aggregator or unique central custom API Gateway.</span></span>

<span data-ttu-id="3b167-166">Outra abordagem é usar um produto como [Gerenciamento de API do Azure](https://azure.microsoft.com/services/api-management/) conforme mostra a Figura 4-14.</span><span class="sxs-lookup"><span data-stu-id="3b167-166">Another approach is to use a product like [Azure API Management](https://azure.microsoft.com/services/api-management/) as shown in Figure 4-14.</span></span> <span data-ttu-id="3b167-167">Essa abordagem não apenas resolve suas necessidades de Gateway de API, mas fornece recursos como coleta de percepções das suas APIs.</span><span class="sxs-lookup"><span data-stu-id="3b167-167">This approach not only solves your API Gateway needs, but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="3b167-168">Se você estiver usando uma solução de gerenciamento de API, um Gateway de API será apenas um componente nessa solução completa de gerenciamento de API.</span><span class="sxs-lookup"><span data-stu-id="3b167-168">If you are using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![](./media/image14.png)

<span data-ttu-id="3b167-169">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="3b167-169">**Figure 4-14**.</span></span> <span data-ttu-id="3b167-170">Usando o Gerenciamento de API do Azure para o Gateway de API</span><span class="sxs-lookup"><span data-stu-id="3b167-170">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="3b167-171">Neste caso, ao usar um produto como o Gerenciamento de API do Azure, o fato de que você pode ter um único Gateway de API não é tão arriscado, pois esses tipos de Gateways de API são "mais finos", o que significa que não implementam código C# personalizado que pode evoluir para um componente monolítico.</span><span class="sxs-lookup"><span data-stu-id="3b167-171">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span> 

<span data-ttu-id="3b167-172">Esse tipo de produto atua mais como um proxy reverso para comunicação de entrada, em que você também pode filtrar as APIs dos microsserviços internos e aplicar a autorização para as APIs publicadas nesta camada única.</span><span class="sxs-lookup"><span data-stu-id="3b167-172">This type of product acts more like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="3b167-173">As informações disponíveis do sistema Gerenciamento de API ajudam a entender como as suas APIs estão sendo usadas e como elas são executadas.</span><span class="sxs-lookup"><span data-stu-id="3b167-173">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="3b167-174">Isso ocorre porque você pode exibir relatórios de análise quase em tempo real e identificar tendências que podem afetar seus negócios.</span><span class="sxs-lookup"><span data-stu-id="3b167-174">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="3b167-175">Além disso, você pode ter logs sobre a atividade de solicitação e resposta para mais análises online e offline.</span><span class="sxs-lookup"><span data-stu-id="3b167-175">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="3b167-176">Com o Gerenciamento de API do Azure, você pode proteger suas APIs usando uma chave, um token e filtragem de IP.</span><span class="sxs-lookup"><span data-stu-id="3b167-176">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="3b167-177">Esses recursos permitem que você imponha cotas flexíveis e refinadas e limites de taxa, modifique a forma e o comportamento de suas APIs usando políticas e melhore o desempenho com o cache de resposta.</span><span class="sxs-lookup"><span data-stu-id="3b167-177">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="3b167-178">Neste guia e no aplicativo de exemplo de referência (eShopOnContainers), estamos limitando a arquitetura a uma arquitetura em contêiner mais simples e personalizada para focar em contêineres simples sem o uso de produtos PaaS como Gerenciamento de API do Azure.</span><span class="sxs-lookup"><span data-stu-id="3b167-178">In this guide and the reference sample application (eShopOnContainers), we are limiting the architecture to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="3b167-179">Mas, para grandes aplicativos baseados em microsserviço implantados no Microsoft Azure, recomendamos que você examine e adote o Gerenciamento de API do Azure como base para seus Gateways de API.</span><span class="sxs-lookup"><span data-stu-id="3b167-179">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to review and adopt Azure API Management as the base for your API Gateways.</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="3b167-180">Desvantagens do padrão de Gateway de API</span><span class="sxs-lookup"><span data-stu-id="3b167-180">Drawbacks of the API Gateway pattern</span></span>

-   <span data-ttu-id="3b167-181">A desvantagem mais importante é que, quando você implementa um Gateway de API, está acoplando essa camada aos microsserviços internos.</span><span class="sxs-lookup"><span data-stu-id="3b167-181">The most important drawback is that when you implement an API Gateway, you are coupling that tier with the internal microservices.</span></span> <span data-ttu-id="3b167-182">Um acoplamento como este pode introduzir problemas sérios no seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3b167-182">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="3b167-183">Clemens Vasters, arquiteto na equipe de Barramento de Serviço do Azure, refere-se a essa possível dificuldade como "o novo ESB" em sua sessão "[Mensagens e microsserviços](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" em GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="3b167-183">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as “the new ESB” in his "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

-   <span data-ttu-id="3b167-184">Usar um Gateway de API de microsserviços cria um possível ponto único de falha adicional.</span><span class="sxs-lookup"><span data-stu-id="3b167-184">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

-   <span data-ttu-id="3b167-185">Um Gateway de API pode apresentar um maior tempo de resposta devido à chamada de rede adicional.</span><span class="sxs-lookup"><span data-stu-id="3b167-185">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="3b167-186">No entanto, essa chamada extra normalmente tem um menor impacto do que ter uma interface do cliente verborrágica demais chamando diretamente os microsserviços internos.</span><span class="sxs-lookup"><span data-stu-id="3b167-186">However, this extra call usually has less impact than having a client interface that is too chatty directly calling the internal microservices.</span></span>

-   <span data-ttu-id="3b167-187">Se não for dimensionado corretamente, o Gateway de API poderá se tornar um gargalo.</span><span class="sxs-lookup"><span data-stu-id="3b167-187">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

-   <span data-ttu-id="3b167-188">Um Gateway de API requer custos adicionais de desenvolvimento e manutenção futura se incluir lógica personalizada e agregação de dados.</span><span class="sxs-lookup"><span data-stu-id="3b167-188">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="3b167-189">Os desenvolvedores devem atualizar o Gateway de API para expor cada ponto de extremidade do microsserviço.</span><span class="sxs-lookup"><span data-stu-id="3b167-189">Developers must update the API Gateway in order to expose each microservice’s endpoints.</span></span> <span data-ttu-id="3b167-190">Além disso, as alterações de implementação nos microsserviços internos podem causar alterações de código no nível do Gateway da API.</span><span class="sxs-lookup"><span data-stu-id="3b167-190">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="3b167-191">No entanto, se o Gateway de API estiver apenas aplicando segurança, logon e controle de versão (como ao usar o Gerenciamento de API do Azure), esse custo de desenvolvimento adicional poderá não se aplicar.</span><span class="sxs-lookup"><span data-stu-id="3b167-191">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

-   <span data-ttu-id="3b167-192">Se o Gateway de API for desenvolvido por uma única equipe, poderá haver um gargalo de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="3b167-192">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="3b167-193">Esse é outro motivo pelo qual uma abordagem melhor é ter vários Gateways de API refinados que respondam às diferentes necessidades do cliente.</span><span class="sxs-lookup"><span data-stu-id="3b167-193">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="3b167-194">Você também pode separar o Gateway de API internamente em várias áreas ou camadas de propriedade de diferentes equipes trabalhando em microsserviços internos.</span><span class="sxs-lookup"><span data-stu-id="3b167-194">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3b167-195">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="3b167-195">Additional resources</span></span>

-   <span data-ttu-id="3b167-196">**Charles Richardson. Padrão: Gateway de API/back-end para front-end**
    [*http://microservices.io/patterns/apigateway.html*](http://microservices.io/patterns/apigateway.html)</span><span class="sxs-lookup"><span data-stu-id="3b167-196">**Charles Richardson. Pattern: API Gateway / Backend for Front-End**
[*http://microservices.io/patterns/apigateway.html*](http://microservices.io/patterns/apigateway.html)</span></span>

-   <span data-ttu-id="3b167-197">**Gerenciamento de API do Azure**
    [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span><span class="sxs-lookup"><span data-stu-id="3b167-197">**Azure API Management**
[*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span></span>

-   <span data-ttu-id="3b167-198">**Udi Dahan. Composição orientada a serviços**\\</span><span class="sxs-lookup"><span data-stu-id="3b167-198">**Udi Dahan. Service Oriented Composition**\\</span></span>
    [<span data-ttu-id="3b167-199">*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*</span><span class="sxs-lookup"><span data-stu-id="3b167-199">*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*</span></span>](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

-   <span data-ttu-id="3b167-200">**Clemens Vasters. Mensagens e microsserviços em GOTO 2016** (vídeo) [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span><span class="sxs-lookup"><span data-stu-id="3b167-200">**Clemens Vasters. Messaging and Microservices at GOTO 2016** (video) [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="3b167-201">[Anterior] (identify-microservice-domain-model-boundaries.md) [Próximo] (communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="3b167-201">[Previous] (identify-microservice-domain-model-boundaries.md) [Next] (communication-in-microservice-architecture.md)</span></span>
