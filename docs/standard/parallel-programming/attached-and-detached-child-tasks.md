---
title: Tarefas filho anexadas e desanexadas
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- tasks, child tasks
ms.assetid: c95788bf-90a6-4e96-b7bc-58e36a228cc5
ms.openlocfilehash: c8a5d2c1ccb8bb2d272c2582cd416cdfd75506d8
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/02/2020
ms.locfileid: "84285684"
---
# <a name="attached-and-detached-child-tasks"></a><span data-ttu-id="0dcfe-102">Tarefas filho anexadas e desanexadas</span><span class="sxs-lookup"><span data-stu-id="0dcfe-102">Attached and Detached Child Tasks</span></span>
<span data-ttu-id="0dcfe-103">Uma *tarefa filho* (ou *tarefa aninhada*) é uma instância <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> que é criada no representante do usuário de outra tarefa, conhecida como a *tarefa pai*.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-103">A *child task* (or *nested task*) is a <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> instance that is created in the user delegate of another task, which is known as the *parent task*.</span></span> <span data-ttu-id="0dcfe-104">Uma tarefa filho pode ser desanexada ou anexada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-104">A child task can be either detached or attached.</span></span> <span data-ttu-id="0dcfe-105">Um *tarefa filho desanexada* é uma tarefa que é executada de forma independente de sua tarefa pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-105">A *detached child task* is a task that executes independently of its parent.</span></span> <span data-ttu-id="0dcfe-106">Uma *tarefa filho anexada* é uma tarefa aninhada criada com a opção <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> cuja tarefa pai não explicitamente ou por padrão proíbe-a de ser anexada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-106">An *attached child task* is a nested task that is created with the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option whose parent does not explicitly or by default prohibit it from being attached.</span></span> <span data-ttu-id="0dcfe-107">Uma tarefa pode criar qualquer número de tarefas filho anexadas e desanexadas que só são limitadas pelos recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-107">A task may create any number of attached and detached child tasks, limited only by system resources.</span></span>  
  
 <span data-ttu-id="0dcfe-108">A tabela a seguir lista as diferenças básicas entre os dois tipos de tarefas filho.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-108">The following table lists the basic differences between the two kinds of child tasks.</span></span>  
  
|<span data-ttu-id="0dcfe-109">Categoria</span><span class="sxs-lookup"><span data-stu-id="0dcfe-109">Category</span></span>|<span data-ttu-id="0dcfe-110">Tarefas filho desanexadas</span><span class="sxs-lookup"><span data-stu-id="0dcfe-110">Detached child tasks</span></span>|<span data-ttu-id="0dcfe-111">Tarefas filho anexadas</span><span class="sxs-lookup"><span data-stu-id="0dcfe-111">Attached child tasks</span></span>|  
|--------------|--------------------------|--------------------------|  
|<span data-ttu-id="0dcfe-112">A tarefa pai aguarda a conclusão de tarefas filho.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-112">Parent waits for child tasks to complete.</span></span>|<span data-ttu-id="0dcfe-113">Não</span><span class="sxs-lookup"><span data-stu-id="0dcfe-113">No</span></span>|<span data-ttu-id="0dcfe-114">Sim</span><span class="sxs-lookup"><span data-stu-id="0dcfe-114">Yes</span></span>|  
|<span data-ttu-id="0dcfe-115">A tarefa pai propaga exceções lançadas pelas tarefas filho.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-115">Parent propagates exceptions thrown by child tasks.</span></span>|<span data-ttu-id="0dcfe-116">Não</span><span class="sxs-lookup"><span data-stu-id="0dcfe-116">No</span></span>|<span data-ttu-id="0dcfe-117">Sim</span><span class="sxs-lookup"><span data-stu-id="0dcfe-117">Yes</span></span>|  
|<span data-ttu-id="0dcfe-118">O status da tarefa pai depende do status da tarefa filho.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-118">Status of parent depends on status of child.</span></span>|<span data-ttu-id="0dcfe-119">Não</span><span class="sxs-lookup"><span data-stu-id="0dcfe-119">No</span></span>|<span data-ttu-id="0dcfe-120">Sim</span><span class="sxs-lookup"><span data-stu-id="0dcfe-120">Yes</span></span>|  
  
 <span data-ttu-id="0dcfe-121">Na maioria dos cenários, é recomendável usar tarefas filho desanexadas porque suas relações com outras tarefas são menos complexas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-121">In most scenarios, we recommend that you use detached child tasks, because their relationships with other tasks are less complex.</span></span> <span data-ttu-id="0dcfe-122">É por isso que as tarefas criadas dentro de tarefas pai são desanexadas por padrão e você deve especificar explicitamente a opção <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> para criar uma tarefa filho anexada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-122">That is why tasks created inside parent tasks are detached by default, and you must explicitly specify the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option to create an attached child task.</span></span>  
  
## <a name="detached-child-tasks"></a><span data-ttu-id="0dcfe-123">Tarefas filho desanexadas</span><span class="sxs-lookup"><span data-stu-id="0dcfe-123">Detached child tasks</span></span>  
 <span data-ttu-id="0dcfe-124">Embora uma tarefa filho seja criada por uma tarefa pai, por padrão ela é independente da tarefa pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-124">Although a child task is created by a parent task, by default it is independent of the parent task.</span></span> <span data-ttu-id="0dcfe-125">No exemplo a seguir, uma tarefa pai cria uma tarefa filho simples.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-125">In the following example, a parent task creates one simple child task.</span></span> <span data-ttu-id="0dcfe-126">Se você executar o exemplo de código várias vezes, perceberá que a saída do exemplo é diferente daquilo que é exibido e, também, que a saída pode mudar sempre que o código for executado.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-126">If you run the example code multiple times, you may notice that the output from the example differs from that shown, and also that the output may change each time you run the code.</span></span> <span data-ttu-id="0dcfe-127">Isso ocorre porque as tarefas pai e filho são executadas de forma independente e a tarefa filho é uma tarefa desanexada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-127">This occurs because the parent task and child tasks execute independently of each other; the child is a detached task.</span></span> <span data-ttu-id="0dcfe-128">O exemplo espera apenas que a tarefa pai seja concluída e a tarefa filho pode não ser executada ou concluída antes do término do aplicativo de console.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-128">The example waits only for the parent task to complete, and the child task may not execute or complete before the console app terminates.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/nested1.cs#1)]
 [!code-vb[TPL_ChildTasks#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/nested1.vb#1)]  
  
 <span data-ttu-id="0dcfe-129">Se a tarefa filho é representada por um objeto <xref:System.Threading.Tasks.Task%601> em vez de um objeto <xref:System.Threading.Tasks.Task>, é possível garantir que a tarefa pai aguardará a conclusão da tarefa filho acessando a propriedade <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> da tarefa filho, mesmo que ela seja uma tarefa filho desanexada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-129">If the child task is represented by a <xref:System.Threading.Tasks.Task%601> object rather than a <xref:System.Threading.Tasks.Task> object, you can ensure that the parent task will wait for the child to complete by accessing the <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property of the child even if it is a detached child task.</span></span> <span data-ttu-id="0dcfe-130">A propriedade <xref:System.Threading.Tasks.Task%601.Result%2A> é bloqueada até a tarefa ser concluída, conforme mostra o exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-130">The <xref:System.Threading.Tasks.Task%601.Result%2A> property blocks until its task completes, as the following example shows.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/childtasks.cs#4)]
 [!code-vb[TPL_ChildTasks#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/tpl_childtasks.vb#4)]  
  
## <a name="attached-child-tasks"></a><span data-ttu-id="0dcfe-131">Tarefas filho anexadas</span><span class="sxs-lookup"><span data-stu-id="0dcfe-131">Attached child tasks</span></span>  
 <span data-ttu-id="0dcfe-132">Ao contrário das tarefas filho desanexadas, as tarefas filho anexadas são estreitamente sincronizadas com as tarefas pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-132">Unlike detached child tasks, attached child tasks are closely synchronized with the parent.</span></span> <span data-ttu-id="0dcfe-133">Altere a tarefa filho desanexada do exemplo anterior para uma tarefa filho anexada usando a opção <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> na instrução de criação da tarefa, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-133">You can change the detached child task in the previous example to an attached child task by using the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option in the task creation statement, as shown in the following example.</span></span> <span data-ttu-id="0dcfe-134">Nesse código, a tarefa filho anexada é concluída antes de sua tarefa pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-134">In this code, the attached child task completes before its parent.</span></span> <span data-ttu-id="0dcfe-135">Como resultado, a saída do exemplo é a mesma sempre que você executar o código.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-135">As a result, the output from the example is the same each time you run the code.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/child1.cs#2)]
 [!code-vb[TPL_ChildTasks#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/child1.vb#2)]  
  
 <span data-ttu-id="0dcfe-136">Você pode usar tarefas filho anexadas para criar gráficos totalmente sincronizados de operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-136">You can use attached child tasks to create tightly synchronized graphs of asynchronous operations.</span></span>  
  
 <span data-ttu-id="0dcfe-137">No entanto, uma tarefa filho pode se anexada à tarefa pai somente se a tarefa pai não proibir tarefas filho anexadas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-137">However, a child task can attach to its parent only if its parent does not prohibit attached child tasks.</span></span> <span data-ttu-id="0dcfe-138">As tarefas pai podem explicitamente impedir que tarefas filho se anexem a elas especificando a opção <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> no constructo de classe da tarefa pai ou no método <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-138">Parent tasks can explicitly prevent child tasks from attaching to them by specifying the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option in the parent task's class constructor or the <xref:System.Threading.Tasks.TaskFactory.StartNew%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0dcfe-139">As tarefas pai podem explicitamente impedir que as tarefas filho se anexem a elas se elas tiverem sido criadas chamando o método <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-139">Parent tasks implicitly prevent child tasks from attaching to them if they are created by calling the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0dcfe-140">O exemplo a seguir ilustra isto.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-140">The following example illustrates this.</span></span> <span data-ttu-id="0dcfe-141">Ele é idêntico ao exemplo anterior, exceto que a tarefa pai é criada chamando o método <xref:System.Threading.Tasks.Task.Run%28System.Action%29?displayProperty=nameWithType> em vez do método <xref:System.Threading.Tasks.TaskFactory.StartNew%28System.Action%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-141">It is identical to the previous example, except that the parent task is created by calling the <xref:System.Threading.Tasks.Task.Run%28System.Action%29?displayProperty=nameWithType> method rather than the <xref:System.Threading.Tasks.TaskFactory.StartNew%28System.Action%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0dcfe-142">Como a tarefa filho não consegue se anexar à sua tarefa pai, a saída do exemplo é imprevisível.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-142">Because the child task is not able to attach to its parent, the output from the example is unpredictable.</span></span> <span data-ttu-id="0dcfe-143">Como as opções de criação da tarefa padrão para as sobrecargas <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> incluem <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>, este exemplo é funcionalmente equivalente ao primeiro exemplo na seção "Tarefas filho desanexadas".</span><span class="sxs-lookup"><span data-stu-id="0dcfe-143">Because the default task creation options for the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> overloads include <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>, this example is functionally equivalent to the first example in the "Detached child tasks" section.</span></span>  
  
 [!code-csharp[TPL_ChildTasks#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_childtasks/cs/child1a.cs#3)]
 [!code-vb[TPL_ChildTasks#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_childtasks/vb/child1a.vb#3)]  
  
## <a name="exceptions-in-child-tasks"></a><span data-ttu-id="0dcfe-144">Exceções em tarefas filho</span><span class="sxs-lookup"><span data-stu-id="0dcfe-144">Exceptions in child tasks</span></span>  
 <span data-ttu-id="0dcfe-145">Se uma tarefa filho desanexada lançar uma exceção, essa exceção deverá ser observada ou manipulada diretamente na tarefa pai assim como ocorre com todas as tarefas não aninhadas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-145">If a detached child task throws an exception, that exception must be observed or handled directly in the parent task just as with any non-nested task.</span></span> <span data-ttu-id="0dcfe-146">Se uma tarefa filho anexada lançar uma exceção, a exceção será propagada automaticamente para a tarefa pai e de volta para o thread que espera ou tenta acessar a propriedade <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> da tarefa.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-146">If an attached child task throws an exception, the exception is automatically propagated to the parent task and back to the thread that waits or tries to access the task's <xref:System.Threading.Tasks.Task%601.Result%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="0dcfe-147">Portanto, usando tarefas filho anexadas, você pode tratar de todas as exceções em apenas um ponto na chamada para <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> no thread da chamada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-147">Therefore, by using attached child tasks, you can handle all exceptions at just one point in the call to <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> on the calling thread.</span></span> <span data-ttu-id="0dcfe-148">Para saber mais, veja [Tratamento de exceção](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="0dcfe-148">For more information, see [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  
  
## <a name="cancellation-and-child-tasks"></a><span data-ttu-id="0dcfe-149">Cancelamento e tarefas filho</span><span class="sxs-lookup"><span data-stu-id="0dcfe-149">Cancellation and child tasks</span></span>  
 <span data-ttu-id="0dcfe-150">O cancelamento de tarefas é cooperativo.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-150">Task cancellation is cooperative.</span></span> <span data-ttu-id="0dcfe-151">Ou seja, para ser anulável, todas as tarefas filho anexadas ou desanexadas devem monitorar o status do token de cancelamento.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-151">That is, to be cancelable, every attached or detached child task must monitor the status of the cancellation token.</span></span> <span data-ttu-id="0dcfe-152">Se quiser cancelar uma tarefa pai e todas as tarefas filho usando uma solicitação de cancelamento, passe o mesmo token como um argumento para todas as tarefas e forneça em cada tarefa a lógica para responder à solicitação de cada tarefa.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-152">If you want to cancel a parent and all its children by using one cancellation request, you pass the same token as an argument to all tasks and provide in each task the logic to respond to the request in each task.</span></span> <span data-ttu-id="0dcfe-153">Para obter mais informações, consulte [Cancelamento de tarefas](task-cancellation.md) e [Como cancelar uma tarefa e seus filhos](how-to-cancel-a-task-and-its-children.md).</span><span class="sxs-lookup"><span data-stu-id="0dcfe-153">For more information, see [Task Cancellation](task-cancellation.md) and [How to: Cancel a Task and Its Children](how-to-cancel-a-task-and-its-children.md).</span></span>  
  
### <a name="when-the-parent-cancels"></a><span data-ttu-id="0dcfe-154">Quando a tarefa pai é cancelada</span><span class="sxs-lookup"><span data-stu-id="0dcfe-154">When the parent cancels</span></span>  
 <span data-ttu-id="0dcfe-155">Se houver o cancelamento de uma tarefa pai antes do início de sua tarefa filho, a tarefa filho nunca será iniciada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-155">If a parent cancels itself before its child task is started, the child never starts.</span></span> <span data-ttu-id="0dcfe-156">Se houver o cancelamento de uma tarefa pai após sua tarefa filho já tiver sido iniciada, a tarefa filho será executada até ser concluída, a não ser que ela tenha sua própria lógica de cancelamento.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-156">If a parent cancels itself after its child task has already started, the child runs to completion unless it has its own cancellation logic.</span></span> <span data-ttu-id="0dcfe-157">Para obter mais informações, consulte [Cancelamento de tarefas](task-cancellation.md).</span><span class="sxs-lookup"><span data-stu-id="0dcfe-157">For more information, see [Task Cancellation](task-cancellation.md).</span></span>  
  
### <a name="when-a-detached-child-task-cancels"></a><span data-ttu-id="0dcfe-158">Quando uma tarefa filho desanexada é cancelada</span><span class="sxs-lookup"><span data-stu-id="0dcfe-158">When a detached child task cancels</span></span>  
 <span data-ttu-id="0dcfe-159">Se houver o cancelamento de uma tarefa filho desanexada usando o mesmo token que foi passado para a tarefa pai e a tarefa pai não aguardar a tarefa filho, nenhuma exceção será propagada já que a exceção é tratada como um cancelamento de cooperação benigno.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-159">If a detached child task cancels itself by using the same token that was passed to the parent, and the parent does not wait for the child task, no exception is propagated, because the exception is treated as benign cooperation cancellation.</span></span> <span data-ttu-id="0dcfe-160">Esse comportamento é igual em todas as tarefas de nível superior.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-160">This behavior is the same as that of any top-level task.</span></span>  
  
### <a name="when-an-attached-child-task-cancels"></a><span data-ttu-id="0dcfe-161">Quando uma tarefa filho anexada é cancelada</span><span class="sxs-lookup"><span data-stu-id="0dcfe-161">When an attached child task cancels</span></span>  
 <span data-ttu-id="0dcfe-162">Quando há o cancelamento de uma tarefa filho anexada usando o mesmo token que foi passado para sua tarefa pai, uma <xref:System.Threading.Tasks.TaskCanceledException> é propagada para o thread de junção dentro de um <xref:System.AggregateException>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-162">When an attached child task cancels itself by using the same token that was passed to its parent task, a <xref:System.Threading.Tasks.TaskCanceledException> is propagated to the joining thread inside an <xref:System.AggregateException>.</span></span> <span data-ttu-id="0dcfe-163">Você deve aguardar a tarefa pai para tratar de todas as exceções benignas, além de todas as exceções de falha que são propagadas em um gráfico de tarefas filho anexadas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-163">You must wait for the parent task so that you can handle all benign exceptions in addition to all faulting exceptions that are propagated up through a graph of attached child tasks.</span></span>  
  
 <span data-ttu-id="0dcfe-164">Para saber mais, veja [Tratamento de exceção](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="0dcfe-164">For more information, see [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  
  
## <a name="preventing-a-child-task-from-attaching-to-its-parent"></a><span data-ttu-id="0dcfe-165">Impedir uma tarefa filho de se anexar à sua tarefa pai</span><span class="sxs-lookup"><span data-stu-id="0dcfe-165">Preventing a child task from attaching to its parent</span></span>  
 <span data-ttu-id="0dcfe-166">Uma exceção sem tratamento que é gerada por uma tarefa filho é propagada para a tarefa pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-166">An unhandled exception that is thrown by a child task is propagated to the parent task.</span></span> <span data-ttu-id="0dcfe-167">Você pode usar esse comportamento para observar todas as exceções da tarefa filho de uma tarefa raiz em vez de percorrer uma árvore de tarefas.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-167">You can use this behavior to observe all child task exceptions from one root task instead of traversing a tree of tasks.</span></span> <span data-ttu-id="0dcfe-168">No entanto, a propagação da exceção pode ser problemática quando uma tarefa pai não espera anexos de outro código.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-168">However, exception propagation can be problematic when a parent task does not expect attachment from other code.</span></span> <span data-ttu-id="0dcfe-169">Por exemplo, considere um aplicativo que chama um componente de biblioteca de terceiros de um objeto <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-169">For example, consider an app that calls a third-party library component from a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="0dcfe-170">Se o componente da biblioteca de terceiros também criar um objeto <xref:System.Threading.Tasks.Task> e especificar <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> para anexá-lo à tarefa pai, todas as exceções sem tratamento que ocorrem na tarefa filho serão propagadas para o pai.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-170">If the third-party library component also creates a <xref:System.Threading.Tasks.Task> object and specifies <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> to attach it to the parent task, any unhandled exceptions that occur in the child task propagate to the parent.</span></span> <span data-ttu-id="0dcfe-171">Isso pode resultar em comportamento inesperado no aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-171">This could lead to unexpected behavior in the main app.</span></span>  
  
 <span data-ttu-id="0dcfe-172">Para impedir que uma tarefa filho seja anexada a uma tarefa pai, especifique a opção <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> ao criar a <xref:System.Threading.Tasks.Task> pai ou o objeto <xref:System.Threading.Tasks.Task%601>.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-172">To prevent a child task from attaching to its parent task, specify the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option when you create the parent <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> object.</span></span> <span data-ttu-id="0dcfe-173">Quando uma tarefa tenta se anexar à sua tarefa pai e a tarefa pai especifica a opção <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType>, a tarefa filho não poderá se anexar a uma tarefa pai e será executada apenas como se a opção <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> não fosse especificada.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-173">When a task tries to attach to its parent and the parent specifies the <xref:System.Threading.Tasks.TaskCreationOptions.DenyChildAttach?displayProperty=nameWithType> option, the child task will not be able to attach to a parent and will execute just as if the <xref:System.Threading.Tasks.TaskCreationOptions.AttachedToParent?displayProperty=nameWithType> option was not specified.</span></span>  
  
 <span data-ttu-id="0dcfe-174">É provável que você também queira impedir que uma tarefa filho se anexe à sua tarefa pai quando a tarefa filho não for concluída de maneira oportuna.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-174">You might also want to prevent a child task from attaching to its parent when the child task does not finish in a timely manner.</span></span> <span data-ttu-id="0dcfe-175">Como a tarefa pai não termina até que todas as tarefas filho sejam concluídas, uma tarefa filho de longa duração pode fazer com que o aplicativo geral tenha um baixo desempenho.</span><span class="sxs-lookup"><span data-stu-id="0dcfe-175">Because a parent task does not finish until all child tasks finish, a long-running child task can cause the overall app to perform poorly.</span></span> <span data-ttu-id="0dcfe-176">Para obter um exemplo que mostre como melhorar o desempenho do aplicativo impedindo que ele seja anexado à sua tarefa pai, confira [Como evitar que uma tarefa filho se anexe à sua tarefa pai](how-to-prevent-a-child-task-from-attaching-to-its-parent.md).</span><span class="sxs-lookup"><span data-stu-id="0dcfe-176">For an example that shows how to improve app performance by preventing a task from attaching to its parent task, see [How to: Prevent a Child Task from Attaching to its Parent](how-to-prevent-a-child-task-from-attaching-to-its-parent.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0dcfe-177">Veja também</span><span class="sxs-lookup"><span data-stu-id="0dcfe-177">See also</span></span>

- [<span data-ttu-id="0dcfe-178">Programação paralela</span><span class="sxs-lookup"><span data-stu-id="0dcfe-178">Parallel Programming</span></span>](index.md)
- [<span data-ttu-id="0dcfe-179">Paralelismo de dados</span><span class="sxs-lookup"><span data-stu-id="0dcfe-179">Data Parallelism</span></span>](data-parallelism-task-parallel-library.md)
