---
title: Chamando métodos síncronos de forma assíncrona
description: Saiba como chamar métodos síncronos de forma assíncrona no .NET, usando os métodos BeginInvoke e EndInvoke.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- asynchronous programming, delegates
- asynchronous delegates
- AsyncWaitHandle property
- callback methods
- calling synchronous methods in asynchronous manner
- WaitHandle class, code examples
- asynchronous programming, status polling
- polling asynchronous operation status
- delegates [.NET], asynchronous
- synchronous calling in asynchronous manner
- waiting for asynchronous calls
- status information [.NET], asynchronous operations
ms.assetid: 41972034-92ed-450a-9664-ab93fcc6f1fb
ms.openlocfilehash: 8d12ab2904b336f38e56387c8aaf2a851a46007e
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/24/2020
ms.locfileid: "95722720"
---
# <a name="calling-synchronous-methods-asynchronously"></a><span data-ttu-id="6249a-103">Chamando métodos síncronos de forma assíncrona</span><span class="sxs-lookup"><span data-stu-id="6249a-103">Calling Synchronous Methods Asynchronously</span></span>

<span data-ttu-id="6249a-104">O .NET permite que você chame qualquer método de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-104">.NET enables you to call any method asynchronously.</span></span> <span data-ttu-id="6249a-105">Para fazer isso, você define um delegado com a mesma assinatura do método que deseja chamar.</span><span class="sxs-lookup"><span data-stu-id="6249a-105">To do this, you define a delegate with the same signature as the method you want to call.</span></span> <span data-ttu-id="6249a-106">O Common Language Runtime define automaticamente `BeginInvoke` os `EndInvoke` métodos e para esse delegado, com as assinaturas apropriadas.</span><span class="sxs-lookup"><span data-stu-id="6249a-106">The common language runtime automatically defines `BeginInvoke` and `EndInvoke` methods for this delegate, with the appropriate signatures.</span></span>

> [!NOTE]
> <span data-ttu-id="6249a-107">Chamadas assíncronas de delegado, especificamente os métodos `BeginInvoke` e `EndInvoke`, não têm suporte no .NET Compact Framework.</span><span class="sxs-lookup"><span data-stu-id="6249a-107">Asynchronous delegate calls, specifically the `BeginInvoke` and `EndInvoke` methods, are not supported in the .NET Compact Framework.</span></span>

<span data-ttu-id="6249a-108">O método `BeginInvoke` inicia a chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-108">The `BeginInvoke` method initiates the asynchronous call.</span></span> <span data-ttu-id="6249a-109">Ele tem os mesmos parâmetros que o método que você deseja executar de forma assíncrona, além de outros dois parâmetros opcionais.</span><span class="sxs-lookup"><span data-stu-id="6249a-109">It has the same parameters as the method that you want to execute asynchronously, plus two additional optional parameters.</span></span> <span data-ttu-id="6249a-110">O primeiro parâmetro é um delegado <xref:System.AsyncCallback> que faz referência a um método a ser chamado quando a chamada assíncrona é concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-110">The first parameter is an <xref:System.AsyncCallback> delegate that references a method to be called when the asynchronous call completes.</span></span> <span data-ttu-id="6249a-111">O segundo parâmetro é um objeto definido pelo usuário que passa informações para o método de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="6249a-111">The second parameter is a user-defined object that passes information into the callback method.</span></span> <span data-ttu-id="6249a-112">`BeginInvoke` retorna imediatamente e não espera a conclusão da chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-112">`BeginInvoke` returns immediately and does not wait for the asynchronous call to complete.</span></span> <span data-ttu-id="6249a-113">`BeginInvoke` retorna um <xref:System.IAsyncResult>, que pode ser usado para monitorar o andamento da chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-113">`BeginInvoke` returns an <xref:System.IAsyncResult>, which can be used to monitor the progress of the asynchronous call.</span></span>

<span data-ttu-id="6249a-114">O método `EndInvoke` recupera os resultados da chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-114">The `EndInvoke` method retrieves the results of the asynchronous call.</span></span> <span data-ttu-id="6249a-115">Ele pode ser chamado a qualquer momento após `BeginInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-115">It can be called any time after `BeginInvoke`.</span></span> <span data-ttu-id="6249a-116">Se a chamada assíncrona não for concluída, `EndInvoke` bloqueará o thread de chamada até que seja concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-116">If the asynchronous call has not completed, `EndInvoke` blocks the calling thread until it completes.</span></span> <span data-ttu-id="6249a-117">Os parâmetros de `EndInvoke` incluem os `out` `ref` parâmetros e ( `<Out>` `ByRef` e `ByRef` em Visual Basic) do método que você deseja executar de forma assíncrona, além do <xref:System.IAsyncResult> retornado por `BeginInvoke` .</span><span class="sxs-lookup"><span data-stu-id="6249a-117">The parameters of `EndInvoke` include the `out` and `ref` parameters (`<Out>` `ByRef` and `ByRef` in Visual Basic) of the method that you want to execute asynchronously, plus the <xref:System.IAsyncResult> returned by `BeginInvoke`.</span></span>

> [!NOTE]
> <span data-ttu-id="6249a-118">O recurso IntelliSense no Visual Studio exibe os parâmetros de `BeginInvoke` e `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-118">The IntelliSense feature in Visual Studio displays the parameters of `BeginInvoke` and `EndInvoke`.</span></span> <span data-ttu-id="6249a-119">Se você não estiver usando o Visual Studio ou uma ferramenta semelhante ou se estiver usando C# com Visual Studio, confira [APM (Modelo de Programação Assíncrona)](asynchronous-programming-model-apm.md) para obter uma descrição dos parâmetros definidos para esses métodos.</span><span class="sxs-lookup"><span data-stu-id="6249a-119">If you're not using Visual Studio or a similar tool, or if you're using C# with Visual Studio, see [Asynchronous Programming Model (APM)](asynchronous-programming-model-apm.md) for a description of the parameters defined for these methods.</span></span>

<span data-ttu-id="6249a-120">Os exemplos de código neste tópico demonstram quatro formas comuns de usar `BeginInvoke` e `EndInvoke` para fazer chamadas assíncronas.</span><span class="sxs-lookup"><span data-stu-id="6249a-120">The code examples in this topic demonstrate four common ways to use `BeginInvoke` and `EndInvoke` to make asynchronous calls.</span></span> <span data-ttu-id="6249a-121">Após chamar `BeginInvoke`, você pode fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="6249a-121">After calling `BeginInvoke` you can do the following:</span></span>

- <span data-ttu-id="6249a-122">Trabalhe um pouco e depois chame `EndInvoke` para bloquear até que a chamada seja concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-122">Do some work and then call `EndInvoke` to block until the call completes.</span></span>

- <span data-ttu-id="6249a-123">Obtenha um <xref:System.Threading.WaitHandle> usando a propriedade <xref:System.IAsyncResult.AsyncWaitHandle%2A?displayProperty=nameWithType>, use seu método <xref:System.Threading.WaitHandle.WaitOne%2A> para impedir a execução até que o <xref:System.Threading.WaitHandle> seja sinalizado e, depois, chame `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-123">Obtain a <xref:System.Threading.WaitHandle> using the <xref:System.IAsyncResult.AsyncWaitHandle%2A?displayProperty=nameWithType> property, use its <xref:System.Threading.WaitHandle.WaitOne%2A> method to block execution until the <xref:System.Threading.WaitHandle> is signaled, and then call `EndInvoke`.</span></span>

- <span data-ttu-id="6249a-124">Sonde o <xref:System.IAsyncResult> retornado por `BeginInvoke` para determinar quando a chamada assíncrona for concluída e, em seguida, chame `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-124">Poll the <xref:System.IAsyncResult> returned by `BeginInvoke` to determine when the asynchronous call has completed, and then call `EndInvoke`.</span></span>

- <span data-ttu-id="6249a-125">Passe um delegado para um método de retorno de chamada para `BeginInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-125">Pass a delegate for a callback method to `BeginInvoke`.</span></span> <span data-ttu-id="6249a-126">O método será executado em um thread <xref:System.Threading.ThreadPool> quando a chamada assíncrona for concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-126">The method is executed on a <xref:System.Threading.ThreadPool> thread when the asynchronous call completes.</span></span> <span data-ttu-id="6249a-127">O método de retorno de chamada chama `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-127">The callback method calls `EndInvoke`.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6249a-128">Não importa qual técnica você usa, sempre chame `EndInvoke` para completar a chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-128">No matter which technique you use, always call `EndInvoke` to complete your asynchronous call.</span></span>

## <a name="defining-the-test-method-and-asynchronous-delegate"></a><span data-ttu-id="6249a-129">Definir o Método de teste e o Delegado assíncrono</span><span class="sxs-lookup"><span data-stu-id="6249a-129">Defining the Test Method and Asynchronous Delegate</span></span>

 <span data-ttu-id="6249a-130">Os exemplos de código a seguir demonstram várias maneiras de chamar o mesmo método de longa execução, `TestMethod`, de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-130">The code examples that follow demonstrate various ways of calling the same long-running method, `TestMethod`, asynchronously.</span></span> <span data-ttu-id="6249a-131">O método `TestMethod` exibe uma mensagem de console para mostrar que começou a processar, dorme por alguns segundos e, depois, termina.</span><span class="sxs-lookup"><span data-stu-id="6249a-131">The `TestMethod` method displays a console message to show that it has begun processing, sleeps for a few seconds, and then ends.</span></span> <span data-ttu-id="6249a-132">`TestMethod` tem um parâmetro `out` para demonstrar a maneira como esses parâmetros são adicionados às assinaturas de `BeginInvoke` e `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-132">`TestMethod` has an `out` parameter to demonstrate the way such parameters are added to the signatures of `BeginInvoke` and `EndInvoke`.</span></span> <span data-ttu-id="6249a-133">Você pode tratar os parâmetros `ref` da mesma forma.</span><span class="sxs-lookup"><span data-stu-id="6249a-133">You can handle `ref` parameters similarly.</span></span>

 <span data-ttu-id="6249a-134">O exemplo de código a seguir mostra a definição de `TestMethod` e o delegado chamado `AsyncMethodCaller` que pode ser usado para chamar `TestMethod` de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="6249a-134">The following code example shows the definition of `TestMethod` and the delegate named `AsyncMethodCaller` that can be used to call `TestMethod` asynchronously.</span></span> <span data-ttu-id="6249a-135">Para compilar os exemplos de código, você deve incluir as definições de `TestMethod` e o delegado `AsyncMethodCaller`.</span><span class="sxs-lookup"><span data-stu-id="6249a-135">To compile the code examples, you must include the definitions for `TestMethod` and the `AsyncMethodCaller` delegate.</span></span>

 [!code-cpp[AsyncDelegateExamples#1](../../../samples/snippets/cpp/VS_Snippets_CLR/AsyncDelegateExamples/cpp/TestMethod.cpp#1)]
 [!code-csharp[AsyncDelegateExamples#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AsyncDelegateExamples/CS/TestMethod.cs#1)]
 [!code-vb[AsyncDelegateExamples#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AsyncDelegateExamples/VB/TestMethod.vb#1)]

## <a name="waiting-for-an-asynchronous-call-with-endinvoke"></a><span data-ttu-id="6249a-136">Aguardar uma chamada assíncrona com EndInvoke</span><span class="sxs-lookup"><span data-stu-id="6249a-136">Waiting for an Asynchronous Call with EndInvoke</span></span>

 <span data-ttu-id="6249a-137">A maneira mais simples de executar um método de forma assíncrona é começar a execução do método chamando o método `BeginInvoke` do delegado, trabalhar um pouco no thread principal e, depois, chamar o método `EndInvoke` do delegado.</span><span class="sxs-lookup"><span data-stu-id="6249a-137">The simplest way to execute a method asynchronously is to start executing the method by calling the delegate's `BeginInvoke` method, do some work on the main thread, and then call the delegate's `EndInvoke` method.</span></span> <span data-ttu-id="6249a-138">`EndInvoke` pode bloquear o thread de chamada, pois não retorna até que a chamada assíncrona seja concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-138">`EndInvoke` might block the calling thread because it does not return until the asynchronous call completes.</span></span> <span data-ttu-id="6249a-139">Essa é uma técnica válida para usar com operações de arquivo ou de rede.</span><span class="sxs-lookup"><span data-stu-id="6249a-139">This is a good technique to use with file or network operations.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6249a-140">Como `EndInvoke` pode bloquear, nunca chame-o a partir de threads que atendem à interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6249a-140">Because `EndInvoke` might block, you should never call it from threads that service the user interface.</span></span>

 [!code-cpp[AsyncDelegateExamples#2](../../../samples/snippets/cpp/VS_Snippets_CLR/AsyncDelegateExamples/cpp/EndInvoke.cpp#2)]
 [!code-csharp[AsyncDelegateExamples#2](../../../samples/snippets/csharp/VS_Snippets_CLR/AsyncDelegateExamples/CS/EndInvoke.cs#2)]
 [!code-vb[AsyncDelegateExamples#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AsyncDelegateExamples/VB/EndInvoke.vb#2)]

## <a name="waiting-for-an-asynchronous-call-with-waithandle"></a><span data-ttu-id="6249a-141">Aguardar uma chamada assíncrona com WaitHandle</span><span class="sxs-lookup"><span data-stu-id="6249a-141">Waiting for an Asynchronous Call with WaitHandle</span></span>

 <span data-ttu-id="6249a-142">Você pode obter um <xref:System.Threading.WaitHandle> usando a propriedade <xref:System.IAsyncResult.AsyncWaitHandle%2A> do <xref:System.IAsyncResult> retornado por `BeginInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-142">You can obtain a <xref:System.Threading.WaitHandle> by using the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> returned by `BeginInvoke`.</span></span> <span data-ttu-id="6249a-143">O <xref:System.Threading.WaitHandle> é sinalizado quando a chamada assíncrona é concluída, e você pode esperar por ele chamando o método <xref:System.Threading.WaitHandle.WaitOne%2A>.</span><span class="sxs-lookup"><span data-stu-id="6249a-143">The <xref:System.Threading.WaitHandle> is signaled when the asynchronous call completes, and you can wait for it by calling the <xref:System.Threading.WaitHandle.WaitOne%2A> method.</span></span>

 <span data-ttu-id="6249a-144">Se você usar um <xref:System.Threading.WaitHandle>, poderá executar um processamento adicional antes ou depois da conclusão da chamada assíncrona, mas antes de chamar `EndInvoke` para recuperar os resultados.</span><span class="sxs-lookup"><span data-stu-id="6249a-144">If you use a <xref:System.Threading.WaitHandle>, you can perform additional processing before or after the asynchronous call completes, but before calling `EndInvoke` to retrieve the results.</span></span>

> [!NOTE]
> <span data-ttu-id="6249a-145">O identificador de espera não é fechado automaticamente quando você chama `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-145">The wait handle is not closed automatically when you call `EndInvoke`.</span></span> <span data-ttu-id="6249a-146">Se você liberar todas as referências para o identificador de espera, os recursos de sistema serão liberados quando a coleta de lixo recuperar o identificador de espera.</span><span class="sxs-lookup"><span data-stu-id="6249a-146">If you release all references to the wait handle, system resources are freed when garbage collection reclaims the wait handle.</span></span> <span data-ttu-id="6249a-147">Para liberar os recursos do sistema assim que você terminar de usar o identificador de espera, descarte-o chamando o método <xref:System.Threading.WaitHandle.Close%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6249a-147">To free the system resources as soon as you are finished using the wait handle, dispose of it by calling the <xref:System.Threading.WaitHandle.Close%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="6249a-148">A coleta de lixo funciona com mais eficiência quando objetos descartáveis são explicitamente descartados.</span><span class="sxs-lookup"><span data-stu-id="6249a-148">Garbage collection works more efficiently when disposable objects are explicitly disposed.</span></span>

 [!code-cpp[AsyncDelegateExamples#3](../../../samples/snippets/cpp/VS_Snippets_CLR/AsyncDelegateExamples/cpp/waithandle.cpp#3)]
 [!code-csharp[AsyncDelegateExamples#3](../../../samples/snippets/csharp/VS_Snippets_CLR/AsyncDelegateExamples/CS/waithandle.cs#3)]
 [!code-vb[AsyncDelegateExamples#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AsyncDelegateExamples/VB/WaitHandle.vb#3)]

## <a name="polling-for-asynchronous-call-completion"></a><span data-ttu-id="6249a-149">Sondar a conclusão da chamada assíncrona</span><span class="sxs-lookup"><span data-stu-id="6249a-149">Polling for Asynchronous Call Completion</span></span>

 <span data-ttu-id="6249a-150">Você pode usar a propriedade <xref:System.IAsyncResult.IsCompleted%2A> do <xref:System.IAsyncResult> retornado por `BeginInvoke` para descobrir quando a chamada assíncrona for concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-150">You can use the <xref:System.IAsyncResult.IsCompleted%2A> property of the <xref:System.IAsyncResult> returned by `BeginInvoke` to discover when the asynchronous call completes.</span></span> <span data-ttu-id="6249a-151">Você pode fazer isso ao fazer a chamada assíncrona de um thread que atenda à interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6249a-151">You might do this when making the asynchronous call from a thread that services the user interface.</span></span> <span data-ttu-id="6249a-152">A sondagem da conclusão permite que o thread de chamada continue em execução enquanto a chamada assíncrona é executada em um thread <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="6249a-152">Polling for completion allows the calling thread to continue executing while the asynchronous call executes on a <xref:System.Threading.ThreadPool> thread.</span></span>

 [!code-cpp[AsyncDelegateExamples#4](../../../samples/snippets/cpp/VS_Snippets_CLR/AsyncDelegateExamples/cpp/polling.cpp#4)]
 [!code-csharp[AsyncDelegateExamples#4](../../../samples/snippets/csharp/VS_Snippets_CLR/AsyncDelegateExamples/CS/polling.cs#4)]
 [!code-vb[AsyncDelegateExamples#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AsyncDelegateExamples/VB/polling.vb#4)]

## <a name="executing-a-callback-method-when-an-asynchronous-call-completes"></a><span data-ttu-id="6249a-153">Executar um método de retorno de chamada quando uma chamada assíncrona for concluída</span><span class="sxs-lookup"><span data-stu-id="6249a-153">Executing a Callback Method When an Asynchronous Call Completes</span></span>

 <span data-ttu-id="6249a-154">Se o thread que inicia a chamada assíncrona não precisar ser o thread que processa os resultados, você poderá executar um método de retorno de chamada quando a chamada for concluída.</span><span class="sxs-lookup"><span data-stu-id="6249a-154">If the thread that initiates the asynchronous call does not need to be the thread that processes the results, you can execute a callback method when the call completes.</span></span> <span data-ttu-id="6249a-155">O método de retorno de chamada é executado em um thread <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="6249a-155">The callback method is executed on a <xref:System.Threading.ThreadPool> thread.</span></span>

 <span data-ttu-id="6249a-156">Para usar um método de retorno de chamada, você deve passar a `BeginInvoke` um delegado <xref:System.AsyncCallback> que representa o método de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="6249a-156">To use a callback method, you must pass `BeginInvoke` an <xref:System.AsyncCallback> delegate that represents the callback method.</span></span> <span data-ttu-id="6249a-157">Você também pode passar um objeto que contém informações a serem usadas pelo método de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="6249a-157">You can also pass an object that contains information to be used by the callback method.</span></span> <span data-ttu-id="6249a-158">No método de retorno de chamada, você pode converter o <xref:System.IAsyncResult>, que é o único parâmetro do método de retorno de chamada, em um objeto <xref:System.Runtime.Remoting.Messaging.AsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="6249a-158">In the callback method, you can cast the <xref:System.IAsyncResult>, which is the only parameter of the callback method, to an <xref:System.Runtime.Remoting.Messaging.AsyncResult> object.</span></span> <span data-ttu-id="6249a-159">Depois, você pode usar a propriedade <xref:System.Runtime.Remoting.Messaging.AsyncResult.AsyncDelegate%2A?displayProperty=nameWithType> para obter o delegado que foi usado para iniciar a chamada para que você possa chamar `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-159">You can then use the <xref:System.Runtime.Remoting.Messaging.AsyncResult.AsyncDelegate%2A?displayProperty=nameWithType> property to get the delegate that was used to initiate the call so that you can call `EndInvoke`.</span></span>

 <span data-ttu-id="6249a-160">Observações sobre o exemplo:</span><span class="sxs-lookup"><span data-stu-id="6249a-160">Notes on the example:</span></span>

- <span data-ttu-id="6249a-161">O `threadId` parâmetro de `TestMethod` é um `out` parâmetro ([ `<Out>` `ByRef` em Visual Basic), portanto, seu valor de entrada nunca é usado pelo `TestMethod` .</span><span class="sxs-lookup"><span data-stu-id="6249a-161">The `threadId` parameter of `TestMethod` is an `out` parameter ([`<Out>` `ByRef` in Visual Basic), so its input value is never used by `TestMethod`.</span></span> <span data-ttu-id="6249a-162">Uma variável fictícia é passada para a chamada `BeginInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-162">A dummy variable is passed to the `BeginInvoke` call.</span></span> <span data-ttu-id="6249a-163">Se o parâmetro `threadId` fosse um parâmetro `ref` (`ByRef` no Visual Basic), a variável precisaria ser um campo de nível de classe para que pudesse ser passada para `BeginInvoke` e `EndInvoke`.</span><span class="sxs-lookup"><span data-stu-id="6249a-163">If the `threadId` parameter were a `ref` parameter (`ByRef` in Visual Basic), the variable would have to be a class-level field so that it could be passed to both `BeginInvoke` and `EndInvoke`.</span></span>

- <span data-ttu-id="6249a-164">As informações de estado que são passadas para `BeginInvoke` são uma cadeia de caracteres de formato, usada pelo método de retorno de chamada para formatar uma mensagem de saída.</span><span class="sxs-lookup"><span data-stu-id="6249a-164">The state information that is passed to `BeginInvoke` is a format string, which the callback method uses to format an output message.</span></span> <span data-ttu-id="6249a-165">Como são passadas como o tipo <xref:System.Object>, as informações de estado devem ser convertidas para o tipo correto antes de poderem ser usadas.</span><span class="sxs-lookup"><span data-stu-id="6249a-165">Because it is passed as type <xref:System.Object>, the state information must be cast to its proper type before it can be used.</span></span>

- <span data-ttu-id="6249a-166">O retorno de chamada é feito em um thread <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="6249a-166">The callback is made on a <xref:System.Threading.ThreadPool> thread.</span></span> <span data-ttu-id="6249a-167">Threads <xref:System.Threading.ThreadPool> são threads em segundo plano, os quais não mantêm o aplicativo em execução se o thread principal terminar. Portanto, o thread principal do exemplo precisa ficar suspenso durante um tempo suficiente para o retorno de chamada ser concluído.</span><span class="sxs-lookup"><span data-stu-id="6249a-167"><xref:System.Threading.ThreadPool> threads are background threads, which do not keep the application running if the main thread ends, so the main thread of the example has to sleep long enough for the callback to finish.</span></span>

 [!code-cpp[AsyncDelegateExamples#5](../../../samples/snippets/cpp/VS_Snippets_CLR/AsyncDelegateExamples/cpp/callback.cpp#5)]
 [!code-csharp[AsyncDelegateExamples#5](../../../samples/snippets/csharp/VS_Snippets_CLR/AsyncDelegateExamples/CS/callback.cs#5)]
 [!code-vb[AsyncDelegateExamples#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AsyncDelegateExamples/VB/callback.vb#5)]

## <a name="see-also"></a><span data-ttu-id="6249a-168">Confira também</span><span class="sxs-lookup"><span data-stu-id="6249a-168">See also</span></span>

- <xref:System.Delegate>
- [<span data-ttu-id="6249a-169">Padrão assíncrono baseado em evento (EAP)</span><span class="sxs-lookup"><span data-stu-id="6249a-169">Event-based Asynchronous Pattern (EAP)</span></span>](event-based-asynchronous-pattern-eap.md)
