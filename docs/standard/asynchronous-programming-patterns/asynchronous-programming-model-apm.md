---
title: "Modelo de programação assíncrona (APM)"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
caps.latest.revision: "13"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: b31383f8972ecf345366f90460d88b6be21eab99
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/21/2017
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="06167-102">Modelo de programação assíncrona (APM)</span><span class="sxs-lookup"><span data-stu-id="06167-102">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="06167-103">Uma operação assíncrona que utiliza o <xref:System.IAsyncResult> padrão de design é implementado como dois métodos chamados **começar** *OperationName* e **final**  *OperationName* que começam e terminam a operação assíncrona *OperationName* respectivamente.</span><span class="sxs-lookup"><span data-stu-id="06167-103">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named **Begin** *OperationName* and **End** *OperationName* that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="06167-104">Por exemplo, o <xref:System.IO.FileStream> classe fornece a <xref:System.IO.FileStream.BeginRead%2A> e <xref:System.IO.FileStream.EndRead%2A> métodos para ler os bytes de um arquivo de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-104">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="06167-105">Esses métodos de implementam a versão assíncrona do <xref:System.IO.FileStream.Read%2A> método.</span><span class="sxs-lookup"><span data-stu-id="06167-105">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="06167-106">Começando com o .NET Framework 4, a biblioteca paralela de tarefas fornece um novo modelo de programação assíncrona e paralela.</span><span class="sxs-lookup"><span data-stu-id="06167-106">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="06167-107">Para obter mais informações, consulte [tarefa TPL (biblioteca paralela)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) e [padrão assíncrono baseado em tarefa (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span><span class="sxs-lookup"><span data-stu-id="06167-107">For more information, see [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="06167-108">Depois de chamar **começar** *OperationName*, um aplicativo pode continuar a executar as instruções no thread de chamada, enquanto a operação assíncrona ocorre em um thread diferente.</span><span class="sxs-lookup"><span data-stu-id="06167-108">After calling **Begin** *OperationName*, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="06167-109">Cada chamada para **começar** *OperationName*, o aplicativo também deve chamar **final** *OperationName* para obter os resultados das operação.</span><span class="sxs-lookup"><span data-stu-id="06167-109">For each call to **Begin** *OperationName*, the application should also call **End** *OperationName* to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="06167-110">A partir de uma operação assíncrona</span><span class="sxs-lookup"><span data-stu-id="06167-110">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="06167-111">O **começar** *OperationName* método inicia a operação assíncrona *OperationName* e retorna um objeto que implementa o <xref:System.IAsyncResult> interface.</span><span class="sxs-lookup"><span data-stu-id="06167-111">The **Begin** *OperationName* method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="06167-112"><xref:System.IAsyncResult>objetos armazenam informações sobre uma operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-112"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="06167-113">A tabela a seguir mostra informações sobre uma operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-113">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="06167-114">Membro</span><span class="sxs-lookup"><span data-stu-id="06167-114">Member</span></span>|<span data-ttu-id="06167-115">Descrição</span><span class="sxs-lookup"><span data-stu-id="06167-115">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="06167-116">Um objeto específico do aplicativo opcional que contém informações sobre a operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-116">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="06167-117">Um <xref:System.Threading.WaitHandle> que pode ser usado para bloquear a execução do aplicativo até que a operação assíncrona é concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-117">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="06167-118">Um valor que indica se a operação assíncrona foi concluída no thread usado para chamar **começar** *OperationName* em vez de concluir em uma separada <xref:System.Threading.ThreadPool> thread.</span><span class="sxs-lookup"><span data-stu-id="06167-118">A value that indicates whether the asynchronous operation completed on the thread used to call **Begin** *OperationName* instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="06167-119">Um valor que indica se a operação assíncrona foi concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-119">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="06167-120">Um **começar** *OperationName* método usa qualquer declarados na assinatura da versão síncrona do método de parâmetros que são passados por valor ou por referência.</span><span class="sxs-lookup"><span data-stu-id="06167-120">A **Begin** *OperationName* method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="06167-121">Quaisquer parâmetros de saída não são parte do **começar** *OperationName* assinatura do método.</span><span class="sxs-lookup"><span data-stu-id="06167-121">Any out parameters are not part of the **Begin** *OperationName* method signature.</span></span> <span data-ttu-id="06167-122">O **começar** *OperationName* assinatura do método também inclui dois parâmetros adicionais.</span><span class="sxs-lookup"><span data-stu-id="06167-122">The **Begin** *OperationName* method signature also includes two additional parameters.</span></span> <span data-ttu-id="06167-123">O primeiro deles define uma <xref:System.AsyncCallback> delegado que faz referência a um método que é chamado quando a operação assíncrona for concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-123">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="06167-124">O chamador pode especificar `null` (`Nothing` no Visual Basic) se não desejar um método chamado quando a operação for concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-124">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="06167-125">O segundo parâmetro adicional é um objeto definido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="06167-125">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="06167-126">Esse objeto pode ser usado para passar informações de estado específico do aplicativo para o método invocado quando a operação assíncrona é concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-126">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="06167-127">Se um **começar** *OperationName* método usa parâmetros específicos de operação adicionais, como uma matriz de bytes para armazenar os bytes lidos de um arquivo, o <xref:System.AsyncCallback> e o objeto de estado do aplicativo são as últimas parâmetros de **começar** *OperationName* assinatura do método.</span><span class="sxs-lookup"><span data-stu-id="06167-127">If a **Begin** *OperationName* method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the **Begin** *OperationName* method signature.</span></span>  
  
 <span data-ttu-id="06167-128">**Iniciar** *OperationName* retorna o controle para o thread de chamada imediatamente.</span><span class="sxs-lookup"><span data-stu-id="06167-128">**Begin** *OperationName* returns control to the calling thread immediately.</span></span> <span data-ttu-id="06167-129">Se o **começar** *OperationName* método lança exceções, as exceções são lançadas antes da operação assíncrona é iniciada.</span><span class="sxs-lookup"><span data-stu-id="06167-129">If the **Begin** *OperationName* method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="06167-130">Se o **começar** *OperationName* método lança exceções, o método de retorno de chamada não é invocado.</span><span class="sxs-lookup"><span data-stu-id="06167-130">If the **Begin** *OperationName* method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="06167-131">Finalizando uma operação assíncrona</span><span class="sxs-lookup"><span data-stu-id="06167-131">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="06167-132">O **final** *OperationName* método termina a operação assíncrona *OperationName*.</span><span class="sxs-lookup"><span data-stu-id="06167-132">The **End** *OperationName* method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="06167-133">O valor de retorno de **final** *OperationName* método é do mesmo tipo retornado pela sua contraparte síncrona e é específico para a operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-133">The return value of the **End** *OperationName* method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="06167-134">Por exemplo, o <xref:System.IO.FileStream.EndRead%2A> método retorna o número de bytes lidos de um <xref:System.IO.FileStream> e o <xref:System.Net.Dns.EndGetHostByName%2A> método retorna um <xref:System.Net.IPHostEntry> objeto que contém informações sobre um computador host.</span><span class="sxs-lookup"><span data-stu-id="06167-134">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="06167-135">O **final** *OperationName* método usa qualquer ou parâmetros ref é declarada na assinatura da versão síncrona do método.</span><span class="sxs-lookup"><span data-stu-id="06167-135">The **End** *OperationName* method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="06167-136">Além dos parâmetros do método síncrono, o **final** *OperationName* método também inclui um <xref:System.IAsyncResult> parâmetro.</span><span class="sxs-lookup"><span data-stu-id="06167-136">In addition to the parameters from the synchronous method, the **End** *OperationName* method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="06167-137">Os chamadores devem passar a instância retornada pela chamada correspondente para **começar** *OperationName*.</span><span class="sxs-lookup"><span data-stu-id="06167-137">Callers must pass the instance returned by the corresponding call to **Begin** *OperationName*.</span></span>  
  
 <span data-ttu-id="06167-138">Se a operação assíncrona representados pelo <xref:System.IAsyncResult> objeto não foi concluída quando **final** *OperationName* é chamado, **final**  *OperationName* bloqueia o thread de chamada até que a operação assíncrona é concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-138">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when **End** *OperationName* is called, **End** *OperationName* blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="06167-139">Exceções geradas pela operação assíncrona são geradas do **final** *OperationName* método.</span><span class="sxs-lookup"><span data-stu-id="06167-139">Exceptions thrown by the asynchronous operation are thrown from the **End** *OperationName* method.</span></span> <span data-ttu-id="06167-140">O efeito da chamada a **final** *OperationName* método várias vezes com o mesmo <xref:System.IAsyncResult> não está definido.</span><span class="sxs-lookup"><span data-stu-id="06167-140">The effect of calling the **End** *OperationName* method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="06167-141">Da mesma forma, ao chamar o **final** *OperationName* método com um <xref:System.IAsyncResult> que não retornou de Begin relacionado método também não está definido.</span><span class="sxs-lookup"><span data-stu-id="06167-141">Likewise, calling the **End** *OperationName* method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="06167-142">Para qualquer um dos cenários indefinidos, implementadores considere gerar <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="06167-142">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="06167-143">Os implementadores de padrão de design devem notificar o chamador que a operação assíncrona é concluída, definindo <xref:System.IAsyncResult.IsCompleted%2A> como true, chamar o método de retorno de chamada assíncrono (se tiver sido especificado) e a sinalização de <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span><span class="sxs-lookup"><span data-stu-id="06167-143">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="06167-144">Os desenvolvedores de aplicativos tem várias opções de design para acessar os resultados da operação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="06167-144">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="06167-145">A opção correta depende se o aplicativo tem instruções que podem ser executados enquanto a operação é concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-145">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="06167-146">Se um aplicativo não pode executar qualquer trabalho adicional até que ele recebe os resultados da operação assíncrona, o aplicativo deve bloquear até que os resultados estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="06167-146">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="06167-147">Para bloquear até que uma operação assíncrona é concluída, você pode usar uma das seguintes abordagens:</span><span class="sxs-lookup"><span data-stu-id="06167-147">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="06167-148">Chamar **final** *OperationName* do thread de principal do aplicativo, bloqueando a execução do aplicativo até que a operação for concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-148">Call **End** *OperationName* from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="06167-149">Para obter um exemplo que ilustra essa técnica, consulte [bloqueando a execução de aplicativos por finalizando uma operação assíncrona](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="06167-149">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
-   <span data-ttu-id="06167-150">Use o <xref:System.IAsyncResult.AsyncWaitHandle%2A> para impedir a execução de aplicativo até que uma ou mais operações sejam concluídas.</span><span class="sxs-lookup"><span data-stu-id="06167-150">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="06167-151">Para obter um exemplo que ilustra essa técnica, consulte [bloqueando a execução de aplicativo com um AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="06167-151">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="06167-152">Aplicativos que não é necessário bloquear enquanto a operação assíncrona é concluída podem usar uma das seguintes abordagens:</span><span class="sxs-lookup"><span data-stu-id="06167-152">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="06167-153">Sondagem de status de conclusão da operação, verificando o <xref:System.IAsyncResult.IsCompleted%2A> propriedade periodicamente e chamar **final** *OperationName* quando a operação for concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-153">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling **End** *OperationName* when the operation is complete.</span></span> <span data-ttu-id="06167-154">Para obter um exemplo que ilustra essa técnica, consulte [sondagem do status de uma operação assíncrona](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="06167-154">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
-   <span data-ttu-id="06167-155">Use um <xref:System.AsyncCallback> delegado para especificar um método a ser invocado quando a operação for concluída.</span><span class="sxs-lookup"><span data-stu-id="06167-155">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="06167-156">Para obter um exemplo que ilustra essa técnica, consulte [usando um delegado AsyncCallback para finalizar uma operação assíncrona](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="06167-156">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="06167-157">Consulte também</span><span class="sxs-lookup"><span data-stu-id="06167-157">See Also</span></span>  
 [<span data-ttu-id="06167-158">EAP (Padrão Assíncrono baseado em Evento)</span><span class="sxs-lookup"><span data-stu-id="06167-158">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)  
 [<span data-ttu-id="06167-159">Chamando métodos síncronos de forma assíncrona</span><span class="sxs-lookup"><span data-stu-id="06167-159">Calling Synchronous Methods Asynchronously</span></span>](../../../docs/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously.md)  
 [<span data-ttu-id="06167-160">Usando um representante AsyncCallback e um objeto de estado</span><span class="sxs-lookup"><span data-stu-id="06167-160">Using an AsyncCallback Delegate and State Object</span></span>](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-and-state-object.md)
