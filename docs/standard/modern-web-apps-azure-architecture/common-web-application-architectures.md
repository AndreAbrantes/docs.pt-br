---
title: Arquiteturas de aplicativo da web comuns
description: Projetar aplicativos web modernos com ASP.NET Core e Microsoft Azure | arquiteturas de aplicativo da web comuns
author: ardalis
ms.author: wiwagn
ms.date: 10/06/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.openlocfilehash: b6236cfab290211f930d6a1987075abeade4fd6d
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/21/2017
---
#<a name="common-web-application-architectures"></a><span data-ttu-id="ab043-103">Arquiteturas de aplicativo da Web comuns</span><span class="sxs-lookup"><span data-stu-id="ab043-103">Common Web Application Architectures</span></span>

> <span data-ttu-id="ab043-104">"Se você acha que boa arquitetura é cara, tente arquitetura incorreta."</span><span class="sxs-lookup"><span data-stu-id="ab043-104">"If you think good architecture is expensive, try bad architecture."</span></span>  
> <span data-ttu-id="ab043-105">_-Brian Rodap e Joseph Yoder_</span><span class="sxs-lookup"><span data-stu-id="ab043-105">_- Brian Foote and Joseph Yoder_</span></span>

## <a name="summary"></a><span data-ttu-id="ab043-106">Resumo</span><span class="sxs-lookup"><span data-stu-id="ab043-106">Summary</span></span>

<span data-ttu-id="ab043-107">Os aplicativos .NET mais tradicionais são implantados como unidades correspondente para um executável ou um único aplicativo web em execução dentro de um appdomain único do IIS.</span><span class="sxs-lookup"><span data-stu-id="ab043-107">Most traditional .NET applications are deployed as single units corresponding to an executable or a single web application running within a single IIS appdomain.</span></span> <span data-ttu-id="ab043-108">Este é o modelo de implantação mais simples e serve muitos aplicativos internos e menores públicos muito bem.</span><span class="sxs-lookup"><span data-stu-id="ab043-108">This is the simplest deployment model and serves many internal and smaller public applications very well.</span></span> <span data-ttu-id="ab043-109">No entanto, mesmo devido a essa unidade única de implantação, mais aplicativos de negócios não trivial se beneficiar de uma separação lógica em várias camadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-109">However, even given this single unit of deployment, most non-trivial business applications benefit from some logical separation into several layers.</span></span>

## <a name="what-is-a-monolithic-application"></a><span data-ttu-id="ab043-110">O que é um aplicativo monolítico?</span><span class="sxs-lookup"><span data-stu-id="ab043-110">What is a monolithic application?</span></span>

<span data-ttu-id="ab043-111">Um aplicativo monolítico é aquele que é totalmente independente, em termos de seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="ab043-111">A monolithic application is one that is entirely self-contained, in terms of its behavior.</span></span> <span data-ttu-id="ab043-112">Ele pode interagir com outros serviços ou armazenamentos de dados durante a execução de suas operações, mas o núcleo de seu comportamento é executado em seu próprio processo e o aplicativo inteiro normalmente é implantado como uma única unidade.</span><span class="sxs-lookup"><span data-stu-id="ab043-112">It may interact with other services or data stores in the course of performing its operations, but the core of its behavior runs within its own process and the entire application is typically deployed as a single unit.</span></span> <span data-ttu-id="ab043-113">Se precisar de um aplicativo desse tipo seja dimensionada horizontalmente, normalmente o aplicativo inteiro é duplicado em vários servidores ou máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="ab043-113">If such an application needs to scale horizontally, typically the entire application is duplicated across multiple servers or virtual machines.</span></span>

## <a name="all-in-one-applications"></a><span data-ttu-id="ab043-114">Aplicativos de tudo em um</span><span class="sxs-lookup"><span data-stu-id="ab043-114">All-in-One applications</span></span>

<span data-ttu-id="ab043-115">O menor número possível de projetos de uma arquitetura de aplicativo é um.</span><span class="sxs-lookup"><span data-stu-id="ab043-115">The smallest possible number of projects for an application architecture is one.</span></span> <span data-ttu-id="ab043-116">Nessa arquitetura, toda a lógica do aplicativo está contida em um único projeto, compilada em um único assembly e implantada como uma única unidade.</span><span class="sxs-lookup"><span data-stu-id="ab043-116">In this architecture, the entire logic of the application is contained in a single project, compiled to a single assembly, and deployed as a single unit.</span></span>

<span data-ttu-id="ab043-117">Um novo projeto ASP.NET Core, se criados no Visual Studio ou da linha de comando, começa com um simple monolito de "tudo em um".</span><span class="sxs-lookup"><span data-stu-id="ab043-117">A new ASP.NET Core project, whether created in Visual Studio or from the command line, starts out as a simple "all-in-one" monolith.</span></span> <span data-ttu-id="ab043-118">Ele contém todos os do comportamento do aplicativo, incluindo a lógica de apresentação, negócios e dados de acesso.</span><span class="sxs-lookup"><span data-stu-id="ab043-118">It contains all of the behavior of the application, including presentation, business, and data access logic.</span></span> <span data-ttu-id="ab043-119">Figura 5-1 mostra a estrutura de arquivos de um único projeto de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-119">Figure 5-1 shows the file structure of a single-project app.</span></span>

<span data-ttu-id="ab043-120">**Figura 5-1.**</span><span class="sxs-lookup"><span data-stu-id="ab043-120">**Figure 5-1.**</span></span> <span data-ttu-id="ab043-121">Um único projeto de aplicativo do ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="ab043-121">A single project ASP.NET Core app</span></span>

![](./media/image5-1.png)

<span data-ttu-id="ab043-122">Em um cenário de único projeto, a separação de preocupações é obtida com o uso de pastas.</span><span class="sxs-lookup"><span data-stu-id="ab043-122">In a single project scenario, separation of concerns is achieved through the use of folders.</span></span> <span data-ttu-id="ab043-123">O modelo padrão inclui pastas separadas para as responsabilidades de padrão MVC de modelos, modos de exibição e os controladores, bem como pastas adicionais para dados e serviços.</span><span class="sxs-lookup"><span data-stu-id="ab043-123">The default template includes separate folders for MVC pattern responsibilities of Models, Views, and Controllers, as well as additional folders for Data and Services.</span></span> <span data-ttu-id="ab043-124">Nessa disposição, detalhes de apresentação devem ser limitados tanto quanto possível para a pasta de modos de exibição e detalhes de implementação de acesso de dados devem ser limitados a classes mantidos na pasta de dados.</span><span class="sxs-lookup"><span data-stu-id="ab043-124">In this arrangement, presentation details should be limited as much as possible to the Views folder, and data access implementation details should be limited to classes kept in the Data folder.</span></span> <span data-ttu-id="ab043-125">Lógica de negócios deve residir em serviços e classes dentro da pasta de modelos.</span><span class="sxs-lookup"><span data-stu-id="ab043-125">Business logic should reside in services and classes within the Models folder.</span></span>

<span data-ttu-id="ab043-126">Embora simples, a solução de projeto único monolítica apresenta algumas desvantagens.</span><span class="sxs-lookup"><span data-stu-id="ab043-126">Although simple, the single-project monolithic solution has some disadvantages.</span></span> <span data-ttu-id="ab043-127">À medida que aumenta de tamanho e a complexidade do projeto, o número de arquivos e pastas continuará crescendo.</span><span class="sxs-lookup"><span data-stu-id="ab043-127">As the project's size and complexity grows, the number of files and folders will continue to grow as well.</span></span> <span data-ttu-id="ab043-128">Questões de interface do usuário (modelos, modos de exibição, controladores) residem em várias pastas, que não sejam agrupadas em ordem alfabética.</span><span class="sxs-lookup"><span data-stu-id="ab043-128">UI concerns (models, views, controllers) reside in multiple folders, which are not grouped together alphabetically.</span></span> <span data-ttu-id="ab043-129">Esse problema só é pior quando outras construções de nível de interface do usuário, como filtros ou ModelBinders, são adicionadas em suas próprias pastas.</span><span class="sxs-lookup"><span data-stu-id="ab043-129">This issue only gets worse when additional UI-level constructs, such as Filters or ModelBinders, are added in their own folders.</span></span> <span data-ttu-id="ab043-130">Lógica de negócios é espalhada entre as pastas de modelos e serviços, e não há nenhuma indicação clara dos quais classes nas quais pastas depende de quais outros.</span><span class="sxs-lookup"><span data-stu-id="ab043-130">Business logic is scattered between the Models and Services folders, and there is no clear indication of which classes in which folders should depend on which others.</span></span> <span data-ttu-id="ab043-131">Esta falta de organização no nível de projeto frequentemente leva a [código espaguete](http://deviq.com/spaghetti-code/).</span><span class="sxs-lookup"><span data-stu-id="ab043-131">This lack of organization at the project level frequently leads to [spaghetti code](http://deviq.com/spaghetti-code/).</span></span>

<span data-ttu-id="ab043-132">Para resolver esses problemas, aplicativos geralmente evoluem em soluções multiprojetos, onde cada projeto é considerado a residir em um determinado *camada* do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-132">In order to address these issues, applications often evolve into multi-project solutions, where each project is considered to reside in a particular *layer* of the application.</span></span>

## <a name="what-are-layers"></a><span data-ttu-id="ab043-133">Quais são as camadas?</span><span class="sxs-lookup"><span data-stu-id="ab043-133">What are layers?</span></span>

<span data-ttu-id="ab043-134">Conforme os aplicativos crescem em complexidade, uma maneira de gerenciar essa complexidade é dividir o aplicativo de acordo com suas responsabilidades ou dúvidas.</span><span class="sxs-lookup"><span data-stu-id="ab043-134">As applications grow in complexity, one way to manage that complexity is to break the application up according to its responsibilities or concerns.</span></span> <span data-ttu-id="ab043-135">Isso segue a separação do princípio de preocupações e pode ajudar a manter uma base de código crescente organizado de forma que os desenvolvedores podem localizar facilmente onde determinadas funcionalidades é implementada.</span><span class="sxs-lookup"><span data-stu-id="ab043-135">This follows the separation of concerns principle, and can help keep a growing codebase organized so that developers can easily find where certain functionality is implemented.</span></span> <span data-ttu-id="ab043-136">Arquitetura em camadas oferece inúmeras vantagens além apenas a organização do código, embora.</span><span class="sxs-lookup"><span data-stu-id="ab043-136">Layered architecture offers a number of advantages beyond just code organization, though.</span></span>

<span data-ttu-id="ab043-137">Organizando código em camadas, a funcionalidade de baixo nível comuns pode ser reutilizada em todo o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-137">By organizing code into layers, common low-level functionality can be reused throughout the application.</span></span> <span data-ttu-id="ab043-138">Essa reutilização é útil porque significa que menos código precisa ser gravada e como ele pode permitir que o aplicativo padronizar em uma única implementação, seguir o princípio seco.</span><span class="sxs-lookup"><span data-stu-id="ab043-138">This reuse is beneficial because it means less code needs to be written and because it can allow the application to standardize on a single implementation, following the DRY principle.</span></span>

<span data-ttu-id="ab043-139">Com uma arquitetura em camadas, aplicativos podem impor restrições nos quais camadas podem se comunicar com outras camadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-139">With a layered architecture, applications can enforce restrictions on which layers can communicate with other layers.</span></span> <span data-ttu-id="ab043-140">Isso ajuda a alcançar o encapsulamento.</span><span class="sxs-lookup"><span data-stu-id="ab043-140">This helps to achieve encapsulation.</span></span> <span data-ttu-id="ab043-141">Quando uma camada é alterada ou substituída, somente as camadas que trabalham com ele devem ser afetadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-141">When a layer is changed or replaced, only those layers that work with it should be impacted.</span></span> <span data-ttu-id="ab043-142">Limitando que camadas dependem na qual as outras camadas, o impacto das alterações podem ser reduzidas para que uma única alteração não afeta o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="ab043-142">By limiting which layers depend on which other layers, the impact of changes can be mitigated so that a single change doesn't impact the entire application.</span></span>

<span data-ttu-id="ab043-143">Camadas (e ao encapsulamento) fazer muito mais fácil substituir a funcionalidade dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-143">Layers (and encapsulation) make it much easier to replace functionality within the application.</span></span> <span data-ttu-id="ab043-144">Por exemplo, um aplicativo inicialmente pode usar seu próprio banco de dados do SQL Server para a persistência, mas posteriormente, pode optar por usar uma estratégia de persistência baseado em nuvem, ou um por trás de uma API da web.</span><span class="sxs-lookup"><span data-stu-id="ab043-144">For example, an application might initially use its own SQL Server database for persistence, but later could choose to use a cloud-based persistence strategy, or one behind a web API.</span></span> <span data-ttu-id="ab043-145">Se o aplicativo foi encapsulado corretamente sua implementação de persistência em uma camada de lógica, essa camada específica do SQL Server pode ser substituída por um novo Implementando a mesma interface pública.</span><span class="sxs-lookup"><span data-stu-id="ab043-145">If the application has properly encapsulated its persistence implementation within a logical layer, that SQL Server specific layer could be replaced by a new one implementing the same public interface.</span></span>

<span data-ttu-id="ab043-146">O potencial de troca de implementações em resposta a alterações futuras em requisitos, além de camadas de aplicativos podem também tornar mais fácil alternar implementações para fins de teste.</span><span class="sxs-lookup"><span data-stu-id="ab043-146">In addition to the potential of swapping out implementations in response to future changes in requirements, application layers can also make it easier to swap out implementations for testing purposes.</span></span> <span data-ttu-id="ab043-147">Em vez de escrever testes que operam em relação a camada de dados reais ou uma camada de interface do usuário do aplicativo, essas camadas podem ser substituídas em tempo de teste com implementações de falsas que fornecem conhecidas respostas a solicitações.</span><span class="sxs-lookup"><span data-stu-id="ab043-147">Instead of having to write tests that operate against the real data layer or UI layer of the application, these layers can be replaced at test time with fake implementations that provide known responses to requests.</span></span> <span data-ttu-id="ab043-148">Isso geralmente faz testes muito mais fácil de escrever e muito mais rápido executar quando comparado ao executar testes novamente infraestrutura real do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-148">This typically makes tests much easier to write and much faster to run when compared to running tests again the application's real infrastructure.</span></span>

<span data-ttu-id="ab043-149">Disposição lógica é uma técnica comum para melhorar a organização do código em aplicativos de software corporativos, e há várias maneiras em que o código pode ser organizado em camadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-149">Logical layering is a common technique for improving the organization of code in enterprise software applications, and there are several ways in which code can be organized into layers.</span></span>

> [!NOTE]
> <span data-ttu-id="ab043-150">*Camadas* representar uma separação lógica dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-150">*Layers* represent logical separation within the application.</span></span> <span data-ttu-id="ab043-151">Se a lógica do aplicativo é fisicamente distribuída para separar processos ou servidores, esses destinos de implantação física separada são chamados de *camadas*.</span><span class="sxs-lookup"><span data-stu-id="ab043-151">In the event that application logic is physically distributed to separate servers or processes, these separate physical deployment targets are referred to as *tiers*.</span></span> <span data-ttu-id="ab043-152">É possível e bastante comum, para que um aplicativo de N camadas que é implantado em uma única camada.</span><span class="sxs-lookup"><span data-stu-id="ab043-152">It's possible, and quite common, to have an N-Layer application that is deployed to a single tier.</span></span>

## <a name="traditional-n-layer-architecture-applications"></a><span data-ttu-id="ab043-153">Aplicativos tradicionais de arquitetura de "camada N"</span><span class="sxs-lookup"><span data-stu-id="ab043-153">Traditional "N-Layer" architecture applications</span></span>

<span data-ttu-id="ab043-154">A organização mais comuns de lógica de aplicativo em camadas mostrada na Figura 5-2.</span><span class="sxs-lookup"><span data-stu-id="ab043-154">The most common organization of application logic into layers it shown in Figure 5-2.</span></span>

<span data-ttu-id="ab043-155">**Figura 5-2.**</span><span class="sxs-lookup"><span data-stu-id="ab043-155">**Figure 5-2.**</span></span> <span data-ttu-id="ab043-156">Camadas de aplicativo típico.</span><span class="sxs-lookup"><span data-stu-id="ab043-156">Typical application layers.</span></span>

![](./media/image5-2.png)

<span data-ttu-id="ab043-157">Essas camadas são frequentemente abreviadas como interface de usuário, BLL (camada de lógica de negócios) e a DAL (camada de acesso a dados).</span><span class="sxs-lookup"><span data-stu-id="ab043-157">These layers are frequently abbreviated as UI, BLL (Business Logic Layer), and DAL (Data Access Layer).</span></span> <span data-ttu-id="ab043-158">Usando essa arquitetura, os usuários fazem solicitações por meio da camada de interface do usuário, que interage com o BLL.</span><span class="sxs-lookup"><span data-stu-id="ab043-158">Using this architecture, users make requests through the UI layer, which interacts only with the BLL.</span></span> <span data-ttu-id="ab043-159">BLL, por sua vez, pode chamar a DAL para solicitações de acesso de dados.</span><span class="sxs-lookup"><span data-stu-id="ab043-159">The BLL, in turn, can call the DAL for data access requests.</span></span> <span data-ttu-id="ab043-160">A camada de interface do usuário não deve fazer todas as solicitações para a DAL diretamente, nem deve interagir com persistência diretamente por outros meios.</span><span class="sxs-lookup"><span data-stu-id="ab043-160">The UI layer should not make any requests to the DAL directly, nor should it interact with persistence directly through other means.</span></span> <span data-ttu-id="ab043-161">Da mesma forma, BLL só deve interagir com persistência por meio da DAL.</span><span class="sxs-lookup"><span data-stu-id="ab043-161">Likewise, the BLL should only interact with persistence by going through the DAL.</span></span> <span data-ttu-id="ab043-162">Dessa forma, cada camada tem sua própria responsabilidade bem conhecida.</span><span class="sxs-lookup"><span data-stu-id="ab043-162">In this way, each layer has its own well-known responsibility.</span></span>

<span data-ttu-id="ab043-163">Uma desvantagem dessa abordagem em camadas tradicional é que as dependências de tempo de compilação é executado da parte superior até a parte inferior.</span><span class="sxs-lookup"><span data-stu-id="ab043-163">One disadvantage of this traditional layering approach is that compile-time dependencies run from the top to the bottom.</span></span> <span data-ttu-id="ab043-164">Ou seja, a camada de interface do usuário depende BLL, que depende da DAL.</span><span class="sxs-lookup"><span data-stu-id="ab043-164">That is, the UI layer depends on the BLL, which depends on the DAL.</span></span> <span data-ttu-id="ab043-165">Isso significa que o BLL, que geralmente contém a lógica mais importante no aplicativo, é dependente em detalhes de implementação de acesso de dados (e geralmente a existência de um banco de dados).</span><span class="sxs-lookup"><span data-stu-id="ab043-165">This means that the BLL, which usually holds the most important logic in the application, is dependent on data access implementation details (and often on the existence of a database).</span></span> <span data-ttu-id="ab043-166">Testar a lógica de negócios em tal arquitetura pode ser difícil, que requerem um banco de dados de teste.</span><span class="sxs-lookup"><span data-stu-id="ab043-166">Testing business logic in such an architecture is often difficult, requiring a test database.</span></span> <span data-ttu-id="ab043-167">O princípio de inversão de dependência pode ser usado para resolver esse problema, como você verá na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="ab043-167">The dependency inversion principle can be used to address this issue, as you'll see in the next section.</span></span>

<span data-ttu-id="ab043-168">Figura 5-3 mostra uma solução de exemplo, dividir o aplicativo em três projetos responsabilidade (ou camada).</span><span class="sxs-lookup"><span data-stu-id="ab043-168">Figure 5-3 shows an example solution, breaking the application into three projects by responsibility (or layer).</span></span>

<span data-ttu-id="ab043-169">**Figura 5-3.**</span><span class="sxs-lookup"><span data-stu-id="ab043-169">**Figure 5-3.**</span></span> <span data-ttu-id="ab043-170">Um simples aplicativo monolítico com três projetos.</span><span class="sxs-lookup"><span data-stu-id="ab043-170">A simple monolithic application with three projects.</span></span>

![](./media/image5-3.png)

<span data-ttu-id="ab043-171">Embora este aplicativo usa vários projetos para fins de organização, ainda está sendo implantado como uma única unidade e seus clientes irão interagir com ele como um aplicativo web única.</span><span class="sxs-lookup"><span data-stu-id="ab043-171">Although this application uses several projects for organizational purposes, it is still deployed as a single unit and its clients will interact with it as a single web app.</span></span> <span data-ttu-id="ab043-172">Isso permite que o processo de implantação muito simples.</span><span class="sxs-lookup"><span data-stu-id="ab043-172">This allows for very simple deployment process.</span></span> <span data-ttu-id="ab043-173">Figura 5-4 mostra como esse é um aplicativo pode ser hospedado usando o Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="ab043-173">Figure 5-4 shows how such an app might be hosted using Windows Azure.</span></span>

![](./media/image5-4.png)

<span data-ttu-id="ab043-174">**Figura 5-4.**</span><span class="sxs-lookup"><span data-stu-id="ab043-174">**Figure 5-4.**</span></span> <span data-ttu-id="ab043-175">Implantação simples do aplicativo Web do Azure</span><span class="sxs-lookup"><span data-stu-id="ab043-175">Simple deployment of Azure Web App</span></span>

<span data-ttu-id="ab043-176">Como o aplicativo precisa crescer, soluções de implantação mais robusta e complexas podem ser necessárias.</span><span class="sxs-lookup"><span data-stu-id="ab043-176">As application needs grow, more complex and robust deployment solutions may be required.</span></span> <span data-ttu-id="ab043-177">Figura 5-5 mostra um exemplo de um plano de implantação mais complexo que oferece suporte a recursos adicionais.</span><span class="sxs-lookup"><span data-stu-id="ab043-177">Figure 5-5 shows an example of a more complex deployment plan that supports additional capabilities.</span></span>

![](./media/image5-5.png)

<span data-ttu-id="ab043-178">**Figura 5-5.**</span><span class="sxs-lookup"><span data-stu-id="ab043-178">**Figure 5-5.**</span></span> <span data-ttu-id="ab043-179">Implantando um aplicativo web para um serviço de aplicativo do Azure</span><span class="sxs-lookup"><span data-stu-id="ab043-179">Deploying a web app to an Azure App Service</span></span>

<span data-ttu-id="ab043-180">Internamente, a organização do projeto em vários projetos com base em responsabilidade melhora a facilidade de manutenção do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-180">Internally, this project's organization into multiple projects based on responsibility improves the maintainability of the application.</span></span>

<span data-ttu-id="ab043-181">Essa unidade pode ser dimensionada ou para aproveitar a escalabilidade de sob demanda com base em nuvem.</span><span class="sxs-lookup"><span data-stu-id="ab043-181">This unit can be scaled up or out to take advantage of cloud-based on-demand scalability.</span></span> <span data-ttu-id="ab043-182">Esse é o processo adicionando adicional da CPU, memória, espaço em disco ou outros recursos para os servidores de hospedagem de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-182">Scaling up means adding additional CPU, memory, disk space, or other resources to the server(s) hosting your app.</span></span> <span data-ttu-id="ab043-183">Expansão significa adicionar mais instâncias desses servidores, sejam esses servidores físicos ou máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="ab043-183">Scaling out means adding additional instances of such servers, whether these are physical servers or virtual machines.</span></span> <span data-ttu-id="ab043-184">Quando seu aplicativo é hospedado em várias instâncias, um balanceador de carga é usado para atribuir solicitações para instâncias individuais do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-184">When your app is hosted across multiple instances, a load balancer is used to assign requests to individual app instances.</span></span>

<span data-ttu-id="ab043-185">A abordagem mais simples para dimensionar um aplicativo web no Azure é configurar manualmente a escala no plano de serviço de aplicativo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-185">The simplest approach to scaling a web application in Azure is to configure scaling manually in the application's App Service Plan.</span></span> <span data-ttu-id="ab043-186">Figura 5-6 mostram a tela apropriada do painel do Azure para configurar quantas instâncias estão atendendo a um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-186">Figure 5-6 show the appropriate Azure dashboard screen to configure how many instances are serving an app.</span></span>

![](./media/image5-6.png)

<span data-ttu-id="ab043-187">**Figura 5-6.**</span><span class="sxs-lookup"><span data-stu-id="ab043-187">**Figure 5-6.**</span></span> <span data-ttu-id="ab043-188">Plano de serviço de aplicativo escala no Azure.</span><span class="sxs-lookup"><span data-stu-id="ab043-188">App Service Plan scaling in Azure.</span></span>

## <a name="clean-architecture"></a><span data-ttu-id="ab043-189">Arquitetura de limpeza</span><span class="sxs-lookup"><span data-stu-id="ab043-189">Clean architecture</span></span>

<span data-ttu-id="ab043-190">Aplicativos que siga o princípio de inversão de dependência, bem como os princípios de Design Domain-Driven (DDD) tendem a chegar a uma arquitetura semelhante.</span><span class="sxs-lookup"><span data-stu-id="ab043-190">Applications that follow the Dependency Inversion Principle as well as Domain-Driven Design (DDD) principles tend to arrive at a similar architecture.</span></span> <span data-ttu-id="ab043-191">Essa arquitetura passou por muitos nomes ao longo dos anos.</span><span class="sxs-lookup"><span data-stu-id="ab043-191">This architecture has gone by many names over the years.</span></span> <span data-ttu-id="ab043-192">Um dos nomes era Hexagonal arquitetura, seguido por adaptadores e portas.</span><span class="sxs-lookup"><span data-stu-id="ab043-192">One of the first names was Hexagonal Architecture, followed by Ports-and-Adapters.</span></span> <span data-ttu-id="ab043-193">Mais recentemente, ele é citado como o [transparência arquitetura](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/) ou [arquitetura limpa](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span><span class="sxs-lookup"><span data-stu-id="ab043-193">More recently, it's been cited as the [Onion Architecture](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/) or [Clean Architecture](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span></span> <span data-ttu-id="ab043-194">É este último nome, arquitetura normal, que é usado como base para descrever a arquitetura deste livro eletrônico.</span><span class="sxs-lookup"><span data-stu-id="ab043-194">It is this last name, Clean Architecture, that is used as the basis for describing the architecture in this e-book.</span></span>

> [!NOTE]
> <span data-ttu-id="ab043-195">O termo que limpa arquitetura pode ser aplicada a aplicativos que são criados usando os princípios de DDD, bem como os que não são criados usando DDD.</span><span class="sxs-lookup"><span data-stu-id="ab043-195">The term Clean Architecture can be applied to applications that are built using DDD Principles as well as to those that are not built using DDD.</span></span> <span data-ttu-id="ab043-196">No caso anterior, essa combinação pode ser chamada como "Arquitetura de DDD limpa".</span><span class="sxs-lookup"><span data-stu-id="ab043-196">In the case of the former, this combination may be referred to as "Clean DDD Architecture".</span></span>

<span data-ttu-id="ab043-197">Arquitetura limpa coloca o modelo de aplicativo e lógica de negócios no centro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-197">Clean architecture puts the business logic and application model at the center of the application.</span></span> <span data-ttu-id="ab043-198">Em vez de ter lógica de negócios que dependem de acesso a dados ou outros problemas de infraestrutura, essa dependência é invertida: detalhes de implementação e infraestrutura dependem do núcleo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-198">Instead of having business logic depend on data access or other infrastructure concerns, this dependency is inverted: infrastructure and implementation details depend on the Application Core.</span></span> <span data-ttu-id="ab043-199">Isso é feito definindo abstrações ou interfaces no núcleo do aplicativo, em seguida, são implementados por tipos definidos na camada de infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-199">This is achieved by defining abstractions, or interfaces, in the Application Core, which are then implemented by types defined in the Infrastructure layer.</span></span> <span data-ttu-id="ab043-200">Uma maneira comum de visualizar essa arquitetura é usar uma série de círculos concêntricas, semelhantes a uma transparência.</span><span class="sxs-lookup"><span data-stu-id="ab043-200">A common way of visualizing this architecture is to use a series of concentric circles, similar to an onion.</span></span> <span data-ttu-id="ab043-201">Figura 5-X mostra um exemplo desse estilo de arquitetura representação.</span><span class="sxs-lookup"><span data-stu-id="ab043-201">Figure 5-X shows an example of this style of architectural representation.</span></span>

![](./media/image5-7.png)

<span data-ttu-id="ab043-202">**Figura 5-7.**</span><span class="sxs-lookup"><span data-stu-id="ab043-202">**Figure 5-7.**</span></span> <span data-ttu-id="ab043-203">Arquitetura de limpeza. exibição de transparência</span><span class="sxs-lookup"><span data-stu-id="ab043-203">Clean Architecture; onion view</span></span>

<span data-ttu-id="ab043-204">Neste diagrama, as dependências de fluxo para o círculo interno.</span><span class="sxs-lookup"><span data-stu-id="ab043-204">In this diagram, dependencies flow toward the innermost circle.</span></span> <span data-ttu-id="ab043-205">Assim, você pode ver que o núcleo do aplicativo (que utiliza seu nome de sua posição no núcleo do diagrama) não tem dependências em outras camadas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-205">Thus, you can see that the Application Core (which takes its name from its position at the core of this diagram) has no dependencies on other application layers.</span></span> <span data-ttu-id="ab043-206">No centro da parte são as interfaces e as entidades do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-206">At the very center are the application's entities and interfaces.</span></span> <span data-ttu-id="ab043-207">Fora, mas ainda no núcleo do aplicativo, são serviços de domínio, que normalmente implementam interfaces definidas no círculo interno.</span><span class="sxs-lookup"><span data-stu-id="ab043-207">Just outside, but still in the Application Core, are domain services, which typically implement interfaces defined in the inner circle.</span></span> <span data-ttu-id="ab043-208">Fora do núcleo do aplicativo, a Interface do usuário e as camadas de infraestrutura dependem no núcleo do aplicativo, mas não em si (necessariamente).</span><span class="sxs-lookup"><span data-stu-id="ab043-208">Outside of the Application Core, both the User Interface and the Infrastructure layers depend on the Application Core, but not on one another (necessarily).</span></span>

<span data-ttu-id="ab043-209">Figura 5-X mostra um diagrama de camada horizontal mais tradicional que melhor reflete a dependência entre a interface do usuário e outras camadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-209">Figure 5-X shows a more traditional horizontal layer diagram that better reflects the dependency between the UI and other layers.</span></span>

![](./media/image5-8.png)

<span data-ttu-id="ab043-210">**Figura 5-8.**</span><span class="sxs-lookup"><span data-stu-id="ab043-210">**Figure 5-8.**</span></span> <span data-ttu-id="ab043-211">Arquitetura de limpeza. exibição de camada horizontal</span><span class="sxs-lookup"><span data-stu-id="ab043-211">Clean Architecture; horizontal layer view</span></span>

<span data-ttu-id="ab043-212">Observe que as setas sólidas representam as dependências de tempo de compilação, enquanto a seta tracejada representa uma dependência somente de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="ab043-212">Note that the solid arrows represent compile-time dependencies, while the dashed arrow represents a runtime-only dependency.</span></span> <span data-ttu-id="ab043-213">Usando a arquitetura de limpeza, a camada de interface do usuário funciona com interfaces definidas no núcleo do aplicativo em tempo de compilação e idealmente não deve ter conhecimento dos tipos de implementação definida na camada de infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-213">Using the clean architecture, the UI layer works with interfaces defined in the Application Core at compile time, and ideally should not have any knowledge of the implementation types defined in the Infrastructure layer.</span></span> <span data-ttu-id="ab043-214">Em tempo de execução, no entanto, esses tipos de implementação serão necessários para o aplicativo a ser executado, portanto, precisam estar presentes e com fio até as interfaces de núcleo do aplicativo por meio de injeção de dependência.</span><span class="sxs-lookup"><span data-stu-id="ab043-214">At runtime, however, these implementation types will be required for the app to execute, so they will need to be present and wired up to the Application Core interfaces via dependency injection.</span></span>

<span data-ttu-id="ab043-215">Figura 5-9 mostra uma exibição mais detalhada da arquitetura de um aplicativo ASP.NET Core quando criado seguindo essas recomendações.</span><span class="sxs-lookup"><span data-stu-id="ab043-215">Figure 5-9 shows a more detailed view of an ASP.NET Core application's architecture when built following these recommendations.</span></span>

![Arquitetura do ASPNET principal](./media/image5-9.png)

<span data-ttu-id="ab043-217">**Figura 5-9.**</span><span class="sxs-lookup"><span data-stu-id="ab043-217">**Figure 5-9.**</span></span> <span data-ttu-id="ab043-218">Diagrama de arquitetura do ASP.NET Core arquitetura limpa a seguir.</span><span class="sxs-lookup"><span data-stu-id="ab043-218">ASP.NET Core architecture diagram following Clean Architecture.</span></span>

<span data-ttu-id="ab043-219">Como o núcleo do aplicativo não depender de infraestrutura, é muito fácil de escrever testes de unidade automatizados para essa camada.</span><span class="sxs-lookup"><span data-stu-id="ab043-219">Because the Application Core doesn't depend on Infrastructure, it is very easy to write automated unit tests for this layer.</span></span> <span data-ttu-id="ab043-220">Números de 5 a 10 e 11 5 mostram como testes se encaixam nesta arquitetura.</span><span class="sxs-lookup"><span data-stu-id="ab043-220">Figures 5-10 and 5-11 show how tests fit into this architecture.</span></span>

![UnitTestCore](./media/image5-10.png)

<span data-ttu-id="ab043-222">**Figura 5-10.**</span><span class="sxs-lookup"><span data-stu-id="ab043-222">**Figure 5-10.**</span></span> <span data-ttu-id="ab043-223">Testes de unidade principal do aplicativo em isolamento.</span><span class="sxs-lookup"><span data-stu-id="ab043-223">Unit testing Application Core in isolation.</span></span>

![IntegrationTests](./media/image5-11.png)

<span data-ttu-id="ab043-225">**Figura 5-11.**</span><span class="sxs-lookup"><span data-stu-id="ab043-225">**Figure 5-11.**</span></span> <span data-ttu-id="ab043-226">Teste de integração, implementações de infraestrutura com dependências externas.</span><span class="sxs-lookup"><span data-stu-id="ab043-226">Integration testing Infrastructure implementations with external dependencies.</span></span>

<span data-ttu-id="ab043-227">Como a camada de interface do usuário não tem nenhuma dependência direta em tipos definidos no projeto de infra-estrutura, da mesma forma é muito fácil alternar implementações, para facilitar o teste ou em resposta a alterações de requisitos de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-227">Since the UI layer doesn't have any direct dependency on types defined in the Infrastructure project, it is likewise very easy to swap out implementations, either to facilitate testing or in response to changing application requirements.</span></span> <span data-ttu-id="ab043-228">Uso interno do ASP.NET Core e o suporte para injeção de dependência torna essa arquitetura a maneira mais apropriada para aplicativos monolítico incomum de estrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-228">ASP.NET Core's built-in use of and support for dependency injection makes this architecture the most appropriate way to structure non-trivial monolithic applications.</span></span>

<span data-ttu-id="ab043-229">Para aplicativos monolíticos os projetos de aplicativo principal, infraestrutura e Interface do usuário são todos executados como um único aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-229">For monolithic applications the Application Core, Infrastructure, and User Interface projects are all run as a single application.</span></span> <span data-ttu-id="ab043-230">A arquitetura de tempo de execução do aplicativo poderia ser algo como a Figura 5-12.</span><span class="sxs-lookup"><span data-stu-id="ab043-230">The runtime application architecture might look something like Figure 5-12.</span></span>

![Arquitetura de núcleo ASPNET 2](./media/image5-12.png)

<span data-ttu-id="ab043-232">**Figura 5-12.**</span><span class="sxs-lookup"><span data-stu-id="ab043-232">**Figure 5-12.**</span></span> <span data-ttu-id="ab043-233">Arquitetura de tempo de execução de um aplicativo ASP.NET Core do exemplo.</span><span class="sxs-lookup"><span data-stu-id="ab043-233">A sample ASP.NET Core app's runtime architecture.</span></span>

### <a name="organizing-code-in-clean-architecture"></a><span data-ttu-id="ab043-234">Organização de código em arquitetura de limpeza</span><span class="sxs-lookup"><span data-stu-id="ab043-234">Organizing Code in Clean Architecture</span></span>

<span data-ttu-id="ab043-235">Em uma solução de arquitetura limpa, cada projeto tem responsabilidades claras.</span><span class="sxs-lookup"><span data-stu-id="ab043-235">In a Clean Architecture solution, each project has clear responsibilities.</span></span> <span data-ttu-id="ab043-236">Como tal, determinados tipos pertencerão em cada projeto e com frequência, você encontrará pastas correspondentes a esses tipos de projeto apropriado.</span><span class="sxs-lookup"><span data-stu-id="ab043-236">As such, certain types will belong in each project and you'll frequently find folders corresponding to these types in the appropriate project.</span></span>

<span data-ttu-id="ab043-237">O núcleo do aplicativo contém o modelo de negócios, que inclui entidades, serviços e interfaces.</span><span class="sxs-lookup"><span data-stu-id="ab043-237">The Application Core holds the business model, which includes entities, services, and interfaces.</span></span> <span data-ttu-id="ab043-238">Essas interfaces incluem abstrações para operações que serão executadas usando a infraestrutura, como acesso a dados, acesso de sistema de arquivos, chamadas de rede, etc. Às vezes, serviços ou interfaces definidas nesta camada precisará trabalhar com tipos de entidade não que não têm dependências em infraestrutura ou de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="ab043-238">These interfaces include abstractions for operations that will be performed using Infrastructure, such as data access, file system access, network calls, etc. Sometimes services or interfaces defined at this layer will need to work with non-entity types that have no dependencies on UI or Infrastructure.</span></span> <span data-ttu-id="ab043-239">Eles podem ser definidos como objetos de transferência de dados simples (DTOs).</span><span class="sxs-lookup"><span data-stu-id="ab043-239">These can be defined as simple Data Transfer Objects (DTOs).</span></span>

> ### <a name="application-core-types"></a><span data-ttu-id="ab043-240">Tipos de núcleo do aplicativo</span><span class="sxs-lookup"><span data-stu-id="ab043-240">Application Core Types</span></span>
> -   <span data-ttu-id="ab043-241">Entidades (classes de modelo comercial que persistem)</span><span class="sxs-lookup"><span data-stu-id="ab043-241">Entities (business model classes that are persisted)</span></span>
> -   <span data-ttu-id="ab043-242">Interfaces</span><span class="sxs-lookup"><span data-stu-id="ab043-242">Interfaces</span></span>
> -   <span data-ttu-id="ab043-243">Serviços</span><span class="sxs-lookup"><span data-stu-id="ab043-243">Services</span></span>
> -   <span data-ttu-id="ab043-244">DTOs</span><span class="sxs-lookup"><span data-stu-id="ab043-244">DTOs</span></span>

<span data-ttu-id="ab043-245">O projeto de infra-estrutura normalmente inclui implementações de acesso de dados.</span><span class="sxs-lookup"><span data-stu-id="ab043-245">The Infrastructure project will typically include data access implementations.</span></span> <span data-ttu-id="ab043-246">Um aplicativo web ASP.NET Core típico, isso incluirá DbContext Entity Framework, quaisquer migrações de núcleo de EF que foram definidas e classes de implementação de acesso de dados.</span><span class="sxs-lookup"><span data-stu-id="ab043-246">In a typical ASP.NET Core web application, this will include the Entity Framework DbContext, any EF Core Migrations that have been defined, and data access implementation classes.</span></span> <span data-ttu-id="ab043-247">A maneira mais comum de abstrair o código de implementação de acesso de dados é através do uso do [padrão de design do repositório](http://deviq.com/repository-pattern/).</span><span class="sxs-lookup"><span data-stu-id="ab043-247">The most common way to abstract data access implementation code is through the use of the [Repository design pattern](http://deviq.com/repository-pattern/).</span></span>

<span data-ttu-id="ab043-248">Além das implementações de acesso de dados, o projeto de infra-estrutura deve conter implementações de serviços devem interagir com as questões de infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-248">In addition to data access implementations, the Infrastructure project should contain implementations of services that must interact with infrastructure concerns.</span></span> <span data-ttu-id="ab043-249">Esses serviços devem implementar interfaces definidas no núcleo do aplicativo e então infraestrutura deve ter uma referência ao projeto de aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="ab043-249">These services should implement interfaces defined in the Application Core, and so Infrastructure should have a reference to the Application Core project.</span></span>

> ### <a name="infrastructure-types"></a><span data-ttu-id="ab043-250">Tipos de infraestrutura</span><span class="sxs-lookup"><span data-stu-id="ab043-250">Infrastructure Types</span></span>
> -   <span data-ttu-id="ab043-251">Tipos de núcleo EF (DbContext, migrações)</span><span class="sxs-lookup"><span data-stu-id="ab043-251">EF Core types (DbContext, Migrations)</span></span>
> -   <span data-ttu-id="ab043-252">Tipos de implementação de acesso de dados (repositórios)</span><span class="sxs-lookup"><span data-stu-id="ab043-252">Data access implementation types (Repositories)</span></span>
> -   <span data-ttu-id="ab043-253">Serviços de infraestrutura específicos (FileLogger, SmtpNotifier, etc.)</span><span class="sxs-lookup"><span data-stu-id="ab043-253">Infrastructure-specific services (FileLogger, SmtpNotifier, etc.)</span></span>

<span data-ttu-id="ab043-254">A camada de interface do usuário em um aplicativo MVC do ASP.NET Core será o ponto de entrada para o aplicativo e será um projeto MVC do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="ab043-254">The user interface layer in an ASP.NET Core MVC application will be the entry point for the application, and will be an ASP.NET Core MVC project.</span></span> <span data-ttu-id="ab043-255">Este projeto deve fazer referência do projeto de aplicativo principal e seus tipos devem interagir com a infraestrutura estritamente por meio de interfaces definidas no núcleo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-255">This project should reference the Application Core project, and its types should interact with infrastructure strictly through interfaces defined in Application Core.</span></span> <span data-ttu-id="ab043-256">Nenhum instanciação direta de (ou estáticas chamadas para) tipos de camada de infraestrutura devem ser permitidos na camada de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="ab043-256">No direct instantiation of (or static calls to) Infrastructure layer types should be permitted in the UI layer.</span></span>

> ### <a name="ui-layer-types"></a><span data-ttu-id="ab043-257">Tipos de camada de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="ab043-257">UI Layer Types</span></span>
> -   <span data-ttu-id="ab043-258">Controladores</span><span class="sxs-lookup"><span data-stu-id="ab043-258">Controllers</span></span>
> -   <span data-ttu-id="ab043-259">Filtros</span><span class="sxs-lookup"><span data-stu-id="ab043-259">Filters</span></span>
> -   <span data-ttu-id="ab043-260">Exibições</span><span class="sxs-lookup"><span data-stu-id="ab043-260">Views</span></span>
> -   <span data-ttu-id="ab043-261">ViewModels</span><span class="sxs-lookup"><span data-stu-id="ab043-261">ViewModels</span></span>
> -   <span data-ttu-id="ab043-262">Inicialização</span><span class="sxs-lookup"><span data-stu-id="ab043-262">Startup</span></span>

<span data-ttu-id="ab043-263">A classe de inicialização é responsável por configurar o aplicativo e para a conexão dos tipos de implementação para interfaces, permitindo que a injeção de dependência funcionar corretamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="ab043-263">The Startup class is responsible for configuring the application, and for wiring up implementation types to interfaces, allowing dependency injection to work properly at run time.</span></span>

> [!NOTE]
> <span data-ttu-id="ab043-264">Para conectar a injeção de dependência no ConfigureServices no arquivo Startup.cs do projeto da interface do usuário, o projeto talvez seja necessário para a referência ao projeto de infra-estrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-264">In order to wire up dependency injection in ConfigureServices in the Startup.cs file of the UI project, the project may need to reference the Infrastructure project.</span></span> <span data-ttu-id="ab043-265">Essa dependência pode ser eliminada, mais facilmente usando um contêiner de DI personalizado.</span><span class="sxs-lookup"><span data-stu-id="ab043-265">This dependency can be eliminated, most easily by using a custom DI container.</span></span> <span data-ttu-id="ab043-266">Para os fins deste exemplo, a abordagem mais simples é permitir que o projeto de interface do usuário para a referência ao projeto de infra-estrutura.</span><span class="sxs-lookup"><span data-stu-id="ab043-266">For the purposes of this sample, the simplest approach is to allow the UI project to reference the Infrastructure project.</span></span>

## <a name="monolithic-applications-and-containers"></a><span data-ttu-id="ab043-267">Contêineres e aplicativos monolíticos</span><span class="sxs-lookup"><span data-stu-id="ab043-267">Monolithic Applications and Containers</span></span> 

<span data-ttu-id="ab043-268">Você pode criar um único e monolítico implantação baseada em aplicativo ou serviço Web e implantá-lo como um contêiner.</span><span class="sxs-lookup"><span data-stu-id="ab043-268">You can build a single and monolithic-deployment based Web Application or Service and deploy it as a container.</span></span> <span data-ttu-id="ab043-269">Dentro do aplicativo, ele pode não ser monolítico mas organizados em várias bibliotecas, componentes ou camadas.</span><span class="sxs-lookup"><span data-stu-id="ab043-269">Within the application, it might not be monolithic but organized into several libraries, components or layers.</span></span> <span data-ttu-id="ab043-270">Externamente é um único contêiner como um único processo, o único aplicativo web ou o único serviço.</span><span class="sxs-lookup"><span data-stu-id="ab043-270">Externally it is a single container like a single process, single web application or single service.</span></span>

<span data-ttu-id="ab043-271">Para gerenciar esse modelo, você deve implantar um único contêiner para representar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ab043-271">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="ab043-272">Para dimensionar, basta adicione cópias adicionais com um balanceador de carga na frente.</span><span class="sxs-lookup"><span data-stu-id="ab043-272">To scale, just add additional copies with a load balancer in front.</span></span> <span data-ttu-id="ab043-273">A simplicidade é proveniente do gerenciamento de uma única implantação em um único contêiner ou VM.</span><span class="sxs-lookup"><span data-stu-id="ab043-273">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![](./media/image5-13.png)

<span data-ttu-id="ab043-274">Você pode incluir vários componentes/bibliotecas ou camadas internas dentro de cada contêiner, conforme ilustrado na Figura 5-X.</span><span class="sxs-lookup"><span data-stu-id="ab043-274">You can include multiple components/libraries or internal layers within each container, as illustrated in Figure 5-X.</span></span> <span data-ttu-id="ab043-275">Mas, após a entidade de segurança do contêiner de *"um contêiner executa uma ação e faz isso em um processo*", o monolítico padrão pode ser um conflito.</span><span class="sxs-lookup"><span data-stu-id="ab043-275">But, following the container principal of *"a container does one thing, and does it in one process*", the monolithic pattern might be a conflict.</span></span>

<span data-ttu-id="ab043-276">A desvantagem dessa abordagem é fornecido se/quando o aplicativo cresce, solicitá-la para dimensionar.</span><span class="sxs-lookup"><span data-stu-id="ab043-276">The downside of this approach comes if/when the application grows, requiring it to scale.</span></span> <span data-ttu-id="ab043-277">Se o aplicativo inteiro em escala, não é realmente um problema.</span><span class="sxs-lookup"><span data-stu-id="ab043-277">If the entire application scaled, it's not really a problem.</span></span> <span data-ttu-id="ab043-278">No entanto, na maioria dos casos, algumas partes do aplicativo são os pontos de restrição que exigem dimensionamento, enquanto outros componentes são menos usado.</span><span class="sxs-lookup"><span data-stu-id="ab043-278">However, in most cases, a few parts of the application are the choke points requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="ab043-279">Usando o exemplo de comércio eletrônico típico; o que você provavelmente precisará escalar é o componente de informações do produto.</span><span class="sxs-lookup"><span data-stu-id="ab043-279">Using the typical eCommerce example; what you likely need to scale is the product information component.</span></span> <span data-ttu-id="ab043-280">Muitos clientes mais procurem produtos de comprá-las.</span><span class="sxs-lookup"><span data-stu-id="ab043-280">Many more customers browse products than purchase them.</span></span> <span data-ttu-id="ab043-281">Mais clientes usam seu carrinho de usar o pipeline de pagamento.</span><span class="sxs-lookup"><span data-stu-id="ab043-281">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="ab043-282">Os clientes menos adicionem comentários ou exibam seu histórico de compra.</span><span class="sxs-lookup"><span data-stu-id="ab043-282">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="ab043-283">E você provavelmente tem apenas uma série de funcionários, em uma única região, o que precisa para gerenciar o conteúdo e campanhas de marketing.</span><span class="sxs-lookup"><span data-stu-id="ab043-283">And you likely only have a handful of employees, in a single region, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="ab043-284">Dimensionando o design monolítico, todo o código é implantado várias vezes.</span><span class="sxs-lookup"><span data-stu-id="ab043-284">By scaling the monolithic design, all the code is deployed multiple times.</span></span>

<span data-ttu-id="ab043-285">Além de escala tudo problemas, alterações em um único componente requerem teste completa de todo o aplicativo e uma reimplantação completa de todas as instâncias.</span><span class="sxs-lookup"><span data-stu-id="ab043-285">In addition to the scale everything problem, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="ab043-286">A abordagem monolítica é comum, e muitas organizações estão desenvolvendo com esta abordagem de arquitetura.</span><span class="sxs-lookup"><span data-stu-id="ab043-286">The monolithic approach is common, and many organizations are developing with this architectural approach.</span></span> <span data-ttu-id="ab043-287">Muitos estão com bom resultados suficientes, enquanto outros estão atingindo os limites.</span><span class="sxs-lookup"><span data-stu-id="ab043-287">Many are having good enough results, while others are hitting limits.</span></span> <span data-ttu-id="ab043-288">Muitos criados seus aplicativos nesse modelo, porque as ferramentas e infraestrutura eram muito difíceis criar arquiteturas orientada a serviços (SOA), e eles não veem a necessidade - até que o aplicativo aumentou.</span><span class="sxs-lookup"><span data-stu-id="ab043-288">Many designed their applications in this model, because the tools and infrastructure were too difficult to build service oriented architectures (SOA), and they didn't see the need - until the app grew.</span></span> <span data-ttu-id="ab043-289">Se você achar que está atingindo os limites da abordagem monolítico, dividindo o aplicativo para habilitá-lo aproveitar melhor microservices e contêineres pode ser a próxima etapa lógica.</span><span class="sxs-lookup"><span data-stu-id="ab043-289">If you find you're hitting the limits of the monolithic approach, breaking the app up to enable it to better leverage containers and microservices may be the next logical step.</span></span>

![](./media/image5-14.png)

<span data-ttu-id="ab043-290">Implantando aplicativos monolíticos no Microsoft Azure pode ser obtida usando VMs dedicadas para cada instância.</span><span class="sxs-lookup"><span data-stu-id="ab043-290">Deploying monolithic applications in Microsoft Azure can be achieved using dedicated VMs for each instance.</span></span> <span data-ttu-id="ab043-291">Usando [conjuntos de escala de VM do Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), você pode facilmente dimensionar as VMs.</span><span class="sxs-lookup"><span data-stu-id="ab043-291">Using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="ab043-292">[Serviços de aplicativo do Azure](https://azure.microsoft.com/services/app-service/) pode executar aplicativos monolíticos e expandir facilmente instâncias sem a necessidade de gerenciar as VMs.</span><span class="sxs-lookup"><span data-stu-id="ab043-292">[Azure App Services](https://azure.microsoft.com/services/app-service/) can run monolithic applications and easily scale instances without having to manage the VMs.</span></span> <span data-ttu-id="ab043-293">Serviços de aplicativo do Azure pode executar instâncias únicas de contêineres do Docker, simplificando a implantação.</span><span class="sxs-lookup"><span data-stu-id="ab043-293">Azure App Services can run single instances of Docker containers as well, simplifying the deployment.</span></span> <span data-ttu-id="ab043-294">Usando o Docker, você pode implantar uma única VM como um host Docker e executar várias instâncias.</span><span class="sxs-lookup"><span data-stu-id="ab043-294">Using Docker, you can deploy a single VM as a Docker host, and run multiple instances.</span></span> <span data-ttu-id="ab043-295">Usando o balanceador do Azure, conforme mostrado na Figura 5-14, você pode gerenciar a escala.</span><span class="sxs-lookup"><span data-stu-id="ab043-295">Using the Azure balancer, as shown in the Figure 5-14, you can manage scaling.</span></span>

<span data-ttu-id="ab043-296">A implantação em vários hosts pode ser gerenciada com as técnicas tradicionais de implantação.</span><span class="sxs-lookup"><span data-stu-id="ab043-296">The deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="ab043-297">Os hosts de Docker podem ser gerenciados com comandos como **docker executar** executada manualmente ou através da automação, como os pipelines de entrega contínua (CD).</span><span class="sxs-lookup"><span data-stu-id="ab043-297">The Docker hosts can be managed with commands like **docker run** performed manually, or through automation such as Continuous Delivery (CD) pipelines.</span></span>

### <a name="monolithic-application-deployed-as-a-container"></a><span data-ttu-id="ab043-298">Aplicativo monolítico implantado como um contêiner</span><span class="sxs-lookup"><span data-stu-id="ab043-298">Monolithic application deployed as a container</span></span>

<span data-ttu-id="ab043-299">Há benefícios do uso de contêineres para gerenciar implantações de aplicativo monolítico.</span><span class="sxs-lookup"><span data-stu-id="ab043-299">There are benefits of using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="ab043-300">Dimensionamento de instâncias de contêineres é muito mais rápido e mais fácil do que a implantação de VMs adicionais.</span><span class="sxs-lookup"><span data-stu-id="ab043-300">Scaling the instances of containers is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="ab043-301">Mesmo ao usar conjuntos de escala de VM para dimensionar VMs, eles levar tempo para a instância.</span><span class="sxs-lookup"><span data-stu-id="ab043-301">Even when using VM Scale Sets to scale VMs, they take time to instance.</span></span> <span data-ttu-id="ab043-302">Quando implantado como instâncias de aplicativo, a configuração do aplicativo é gerenciada como parte da VM.</span><span class="sxs-lookup"><span data-stu-id="ab043-302">When deployed as app instances, the configuration of the app is managed as part of the VM.</span></span>

<span data-ttu-id="ab043-303">Implantando atualizações como imagens do Docker é muito mais rápida e eficiente de rede.</span><span class="sxs-lookup"><span data-stu-id="ab043-303">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="ab043-304">Imagens do docker geralmente iniciam em segundos, acelerando distribuições.</span><span class="sxs-lookup"><span data-stu-id="ab043-304">Docker Images typically start in seconds, speeding rollouts.</span></span> <span data-ttu-id="ab043-305">Subdividir uma instância de Docker é tão fácil quanto emitir um **stop docker** comando, normalmente Concluindo em menos de um segundo.</span><span class="sxs-lookup"><span data-stu-id="ab043-305">Tearing down a Docker instance is as easy as issuing a **docker stop** command, typically completing in less than a second.</span></span>

<span data-ttu-id="ab043-306">Como contêineres são inerentemente imutáveis por design, você nunca precisa se preocupar sobre VMs corrompidas, enquanto os scripts de atualização podem esquecer de conta para alguma configuração específica ou o restante do arquivo no disco.</span><span class="sxs-lookup"><span data-stu-id="ab043-306">As containers are inherently immutable by design, you never need to worry about corrupted VMs, whereas update scripts might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="ab043-307">Enquanto monolíticos aplicativos podem se beneficiar do Docker, interrompendo o aplicativo monolítico em sistemas sub que pode ser expandida, desenvolvidos e implantados individualmente pode ser o ponto de entrada para o território de microservices.</span><span class="sxs-lookup"><span data-stu-id="ab043-307">While monolithic apps can benefit from Docker, breaking up the monolithic application into sub systems which can be scaled, developed and deployed individually may be your entry point into the realm of microservices.</span></span>

> ### <a name="references--common-web-architectures"></a><span data-ttu-id="ab043-308">Referências – comum arquiteturas de Web</span><span class="sxs-lookup"><span data-stu-id="ab043-308">References – Common Web Architectures</span></span>
> - <span data-ttu-id="ab043-309">**A arquitetura de limpeza**</span><span class="sxs-lookup"><span data-stu-id="ab043-309">**The Clean Architecture**</span></span>  
> <span data-ttu-id="ab043-310"><https://8thlight.com/blog/Uncle-Bob/2012/08/13/the-Clean-Architecture.HTML></span><span class="sxs-lookup"><span data-stu-id="ab043-310"><https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html></span></span>
> - <span data-ttu-id="ab043-311">**A arquitetura de transparência**</span><span class="sxs-lookup"><span data-stu-id="ab043-311">**The Onion Architecture**</span></span>  
> <span data-ttu-id="ab043-312"><http://jeffreypalermo.com/blog/the-Onion-Architecture-Part-1/></span><span class="sxs-lookup"><span data-stu-id="ab043-312"><http://jeffreypalermo.com/blog/the-onion-architecture-part-1/></span></span>
> - <span data-ttu-id="ab043-313">**O padrão de repositório**</span><span class="sxs-lookup"><span data-stu-id="ab043-313">**The Repository Pattern**</span></span>  
> <span data-ttu-id="ab043-314"><http://deviq.com/Repository-Pattern/></span><span class="sxs-lookup"><span data-stu-id="ab043-314"><http://deviq.com/repository-pattern/></span></span>
> - <span data-ttu-id="ab043-315">**Exemplo de solução de limpeza de arquitetura**</span><span class="sxs-lookup"><span data-stu-id="ab043-315">**Clean Architecture Solution Sample**</span></span>  
> <span data-ttu-id="ab043-316"><https://GitHub.com/ardalis/cleanarchitecture></span><span class="sxs-lookup"><span data-stu-id="ab043-316"><https://github.com/ardalis/cleanarchitecture></span></span>
> - <span data-ttu-id="ab043-317">**A arquitetura de livro eletrônico Microservices** <http://aka.ms/MicroservicesEbook></span><span class="sxs-lookup"><span data-stu-id="ab043-317">**Architecting Microservices e-book** <http://aka.ms/MicroservicesEbook></span></span>

>[!div class="step-by-step"]
<span data-ttu-id="ab043-318">[Anterior] (arquitetura-principles.md) [Avançar] (comum-cliente-lado-web-technologies.md)</span><span class="sxs-lookup"><span data-stu-id="ab043-318">[Previous] (architectural-principles.md) [Next] (common-client-side-web-technologies.md)</span></span>
