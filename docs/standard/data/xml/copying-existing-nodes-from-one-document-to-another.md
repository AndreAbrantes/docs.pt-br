---
title: Copiando nós existentes de um documento para outro
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology: dotnet-standard
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: ''
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 958dccfc184857b0edd12cd1d9afe7b3b468b1e6
ms.sourcegitcommit: c883637b41ee028786edceece4fa872939d2e64c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/26/2018
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="be0a0-102">Copiando nós existentes de um documento para outro</span><span class="sxs-lookup"><span data-stu-id="be0a0-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="be0a0-103">O método **ImportNode** é o mecanismo pelo qual um nó ou uma subárvore inteira do nó são copiados de um **XmlDocument** para outro.</span><span class="sxs-lookup"><span data-stu-id="be0a0-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="be0a0-104">O nó retornado de chamada é uma cópia do nó do documento de origem, incluindo valores de atributo, nome de nó, tipo de nó, e todos os atributos URL relacionados como o prefixo, o nome local, e namespace Uniform Resource Identifier (URI).</span><span class="sxs-lookup"><span data-stu-id="be0a0-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="be0a0-105">O documento de origem não é alterado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-105">The source document is not changed.</span></span> <span data-ttu-id="be0a0-106">Depois que você importou o nó, você ainda precisará adicioná-lo à árvore usando um dos métodos usados para nós de inserção.</span><span class="sxs-lookup"><span data-stu-id="be0a0-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="be0a0-107">Quando o nó é anexado ao novo documento, o novo documento possui o nó.</span><span class="sxs-lookup"><span data-stu-id="be0a0-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="be0a0-108">O motivo é que cada nó, quando criado, tem um documento proprietário, mesmo se os nós são criados em partes separados do documento.</span><span class="sxs-lookup"><span data-stu-id="be0a0-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="be0a0-109">Esse é um requisito do DOM (Modelo de Objeto do Documento) e é imposto pelo design de criação de fábrica na classe **XmlDocument**.</span><span class="sxs-lookup"><span data-stu-id="be0a0-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="be0a0-110">Por exemplo, **CreateElement** é a única maneira de criar novos nós.</span><span class="sxs-lookup"><span data-stu-id="be0a0-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="be0a0-111">Dependendo do tipo do nó importado e do valor do parâmetro *deep*, informações adicionais são copiadas conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="be0a0-112">Este método tenta espelhar o comportamento esperado se um fragmento XML ou de código HTML foi copiado de um documento para outro, responsabilizando-se pelo fato que para XML, os dois documentos pode ter definições de tipos diferentes (DTDs) do documento.</span><span class="sxs-lookup"><span data-stu-id="be0a0-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="be0a0-113">A tabela a seguir descreve o comportamento específico para cada tipo de nó que pode ser importado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="be0a0-114">Tipo de nó</span><span class="sxs-lookup"><span data-stu-id="be0a0-114">Node Type</span></span>|<span data-ttu-id="be0a0-115">O parâmetro *deep* é true</span><span class="sxs-lookup"><span data-stu-id="be0a0-115">*deep* parameter is true</span></span>|<span data-ttu-id="be0a0-116">O parâmetro *deep* é false</span><span class="sxs-lookup"><span data-stu-id="be0a0-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="be0a0-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="be0a0-117">XmlAttribute</span></span>|<span data-ttu-id="be0a0-118">O <xref:System.Xml.XmlAttribute.Specified%2A> é definido como **true** no XmlAttribute.</span><span class="sxs-lookup"><span data-stu-id="be0a0-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="be0a0-119">Os descendentes da origem **XmlAttribute** são importados recursivamente, e os nós resultantes são remontados para formar a subárvore correspondente.</span><span class="sxs-lookup"><span data-stu-id="be0a0-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="be0a0-120">O parâmetro *deep* não se aplica a nós **XmlAttribute**, pois eles sempre levam seus filhos quando importados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="be0a0-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="be0a0-121">XmlCDataSection</span></span>|<span data-ttu-id="be0a0-122">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-122">Copies the node, including its data.</span></span>|<span data-ttu-id="be0a0-123">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="be0a0-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="be0a0-124">XmlComment</span></span>|<span data-ttu-id="be0a0-125">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-125">Copies the node, including its data.</span></span>|<span data-ttu-id="be0a0-126">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="be0a0-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="be0a0-127">XmlDocumentFragment</span></span>|<span data-ttu-id="be0a0-128">Os descendentes nó de origem recursivamente serão importados e os nós resultantes são remontados para formar a subárvore correspondente.</span><span class="sxs-lookup"><span data-stu-id="be0a0-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="be0a0-129">Um **XmlDocumentFragment** vazio é criado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="be0a0-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="be0a0-130">XmlDocumentType</span></span>|<span data-ttu-id="be0a0-131">Copia o nó, incluindo seu data.\*</span><span class="sxs-lookup"><span data-stu-id="be0a0-131">Copies the node, including its data.\*</span></span>|<span data-ttu-id="be0a0-132">Copia o nó, incluindo seu data.\*</span><span class="sxs-lookup"><span data-stu-id="be0a0-132">Copies the node, including its data.\*</span></span>|  
|<span data-ttu-id="be0a0-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="be0a0-133">XmlElement</span></span>|<span data-ttu-id="be0a0-134">Os descendentes do elemento de origem recursivamente serão importados e os nós resultantes são remontados para formar a subárvore correspondente.</span><span class="sxs-lookup"><span data-stu-id="be0a0-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="be0a0-135">**Observação:** os atributos padrão não são copiados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="be0a0-136">Se o documento que está sendo importado define atributos padrão para este nome de elemento, esses são atribuídos.</span><span class="sxs-lookup"><span data-stu-id="be0a0-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="be0a0-137">Os nós de atributo especificados do elemento de origem são importados, e os nós **XmlAttribute** gerados são anexados ao novo elemento.</span><span class="sxs-lookup"><span data-stu-id="be0a0-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="be0a0-138">Os nós descendentes não são copiados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="be0a0-139">**Observação:** os atributos padrão não são copiados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="be0a0-140">Se o documento que está sendo importado define atributos padrão para este nome de elemento, esses são atribuídos.</span><span class="sxs-lookup"><span data-stu-id="be0a0-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="be0a0-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="be0a0-141">XmlEntityReference</span></span>|<span data-ttu-id="be0a0-142">Como os documentos de origem e destino podem ter as entidades definidas de maneira diferente, esse método copia somente o nó **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="be0a0-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="be0a0-143">O texto de substituição não é incluído.</span><span class="sxs-lookup"><span data-stu-id="be0a0-143">The replacement text is not included.</span></span> <span data-ttu-id="be0a0-144">Se o documento de destino tem a entidade definida, o valor é atribuído.</span><span class="sxs-lookup"><span data-stu-id="be0a0-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="be0a0-145">Como os documentos de origem e destino podem ter as entidades definidas de maneira diferente, esse método copia somente o nó **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="be0a0-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="be0a0-146">O texto de substituição não é incluído.</span><span class="sxs-lookup"><span data-stu-id="be0a0-146">The replacement text is not included.</span></span> <span data-ttu-id="be0a0-147">Se o documento de destino tem a entidade definida, o valor é atribuído.</span><span class="sxs-lookup"><span data-stu-id="be0a0-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="be0a0-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="be0a0-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="be0a0-149">Copia o destino e o valor do nó importado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="be0a0-150">Copia o destino e o valor do nó importado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="be0a0-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="be0a0-151">XmlText</span></span>|<span data-ttu-id="be0a0-152">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-152">Copies the node, including its data.</span></span>|<span data-ttu-id="be0a0-153">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="be0a0-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="be0a0-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="be0a0-155">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-155">Copies the node, including its data.</span></span>|<span data-ttu-id="be0a0-156">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="be0a0-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="be0a0-157">XmlWhitespace</span></span>|<span data-ttu-id="be0a0-158">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-158">Copies the node, including its data.</span></span>|<span data-ttu-id="be0a0-159">Copia o nó, incluindo seus dados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="be0a0-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="be0a0-160">XmlDeclaration</span></span>|<span data-ttu-id="be0a0-161">Copia o destino e o valor do nó importado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="be0a0-162">Copia o destino e o valor do nó importado.</span><span class="sxs-lookup"><span data-stu-id="be0a0-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="be0a0-163">Todos os outros tipos de nó</span><span class="sxs-lookup"><span data-stu-id="be0a0-163">All other node types</span></span>|<span data-ttu-id="be0a0-164">Esses tipos de nós não podem ser importados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-164">These node types cannot be imported.</span></span>|<span data-ttu-id="be0a0-165">Esses tipos de nós não podem ser importados.</span><span class="sxs-lookup"><span data-stu-id="be0a0-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="be0a0-166">Embora os nós de DocumentType possam ser importados, um documento pode ter apenas um DocumentType.</span><span class="sxs-lookup"><span data-stu-id="be0a0-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="be0a0-167">Assim, uma vez que você importou o tipo de documento, antes de inseri-lo na árvore você precisará certificar-se que não há documento tipo no documento.</span><span class="sxs-lookup"><span data-stu-id="be0a0-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="be0a0-168">Para saber mais sobre como remover nós, confira [Removendo nós, conteúdo e valores de um documento XML](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span><span class="sxs-lookup"><span data-stu-id="be0a0-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="be0a0-169">Consulte também</span><span class="sxs-lookup"><span data-stu-id="be0a0-169">See Also</span></span>  
 [<span data-ttu-id="be0a0-170">DOM (Modelo de Objeto do Documento) de XML</span><span class="sxs-lookup"><span data-stu-id="be0a0-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
