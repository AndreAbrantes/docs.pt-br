---
title: Aplicando atributos de interoperabilidade
description: Este artigo resume os atributos de interoperabilidade COM do namespace System. Runtime. InteropServices, incluindo atributos de tempo de design e de ferramenta de conversão.
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: 831f8d79030264ef013a75cd91cb771c9d168576
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/15/2020
ms.locfileid: "83420533"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="bd6b2-103">Aplicando atributos de interoperabilidade</span><span class="sxs-lookup"><span data-stu-id="bd6b2-103">Applying Interop Attributes</span></span>
<span data-ttu-id="bd6b2-104">O namespace <xref:System.Runtime.InteropServices> fornece três categorias de atributos específicos à interoperabilidade: aquelas aplicadas por você em tempo de design, aquelas aplicadas pelas ferramentas de interoperabilidade COM e as APIs durante o processo de conversão e aquelas aplicadas por você ou pela interoperabilidade COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-104">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="bd6b2-105">Se você não estiver familiarizado com a tarefa de aplicação de atributos ao código gerenciado, consulte [Estendendo metadados usando atributos](../../../docs/standard/attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="bd6b2-105">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md).</span></span> <span data-ttu-id="bd6b2-106">Assim como outros atributos personalizados, você pode aplicar atributos específicos à interoperabilidade a tipos, métodos, propriedades, parâmetros, campos e outros membros.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-106">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="bd6b2-107">Atributos em tempo de design</span><span class="sxs-lookup"><span data-stu-id="bd6b2-107">Design-Time Attributes</span></span>  
 <span data-ttu-id="bd6b2-108">Ajuste o resultado do processo de conversão executado pelas APIs e pelas ferramentas de interoperabilidade COM usando atributos em tempo de design.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-108">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="bd6b2-109">A tabela a seguir descreve os atributos que podem ser aplicados ao código-fonte gerenciado.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-109">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="bd6b2-110">Às vezes, as ferramentas de interoperabilidade COM também podem aplicar os atributos descritos nesta tabela.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-110">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="bd6b2-111">Atributo</span><span class="sxs-lookup"><span data-stu-id="bd6b2-111">Attribute</span></span>|<span data-ttu-id="bd6b2-112">Descrição</span><span class="sxs-lookup"><span data-stu-id="bd6b2-112">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="bd6b2-113">Especifica se o tipo deve ter o marshaling realizado usando o marshaler de Automação ou um proxy e stub personalizados.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-113">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="bd6b2-114">Controla o tipo de interface gerado para uma classe.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-114">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="bd6b2-115">Identifica o CLSID da coclass original importado de uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-115">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="bd6b2-116">As ferramentas de interoperabilidade COM geralmente aplicam esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-116">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="bd6b2-117">Indica que uma definição de coclass ou interface foi importada de uma biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-117">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="bd6b2-118">O runtime usa esse sinalizador para saber como ativar e realizar marshaling do tipo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-118">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="bd6b2-119">Esse atributo proíbe o tipo que está sendo exportado novamente para uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-119">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="bd6b2-120">As ferramentas de interoperabilidade COM geralmente aplicam esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-120">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="bd6b2-121">Indica que um método deve ser chamado quando o assembly é registrado para uso por meio do COM, de modo que o código escrito pelo usuário possa ser executado durante o processo de registro.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-121">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="bd6b2-122">Identifica as interfaces que são fontes de eventos para a classe.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-122">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="bd6b2-123">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-123">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="bd6b2-124">Indica que um método deve ser chamado quando o assembly tem o registro cancelado por meio do COM, de modo que o código escrito pelo usuário possa ser executado durante o processo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-124">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="bd6b2-125">Renderiza tipos invisíveis para o COM quando o valor do atributo é igual a **false**.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-125">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="bd6b2-126">Esse atributo pode ser aplicado a um tipo individual ou a um assembly inteiro para controlar a visibilidade COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-126">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="bd6b2-127">Por padrão, todos os tipos gerenciados e públicos são visíveis; o atributo não é necessário para torná-los visíveis.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-127">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="bd6b2-128">Especifica o DISPID (identificador de expedição) COM de um método ou campo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-128">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="bd6b2-129">Este atributo contém o DISPID do método, do campo ou da propriedade que ele descreve.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-129">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="bd6b2-130">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-130">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="bd6b2-131">Indica a interface padrão para uma classe COM implementada no .NET.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-131">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="bd6b2-132">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-132">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="bd6b2-133">Indica a posição física de cada campo dentro de uma classe quando usado com o **StructLayoutAttribute** e o **LayoutKind** é definido como Explicit.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-133">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="bd6b2-134">Especifica o GUID (identificador global exclusivo) de uma classe, uma interface ou toda uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-134">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="bd6b2-135">A cadeia de caracteres passada para o atributo deve ter um formato que seja um argumento de construtor aceitável para o tipo **System.Guid**.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-135">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="bd6b2-136">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-136">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="bd6b2-137">Indica qual implementação da interface **IDispatch** o Common Language Runtime usa ao expor interfaces duplas e dispinterfaces ao COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-137">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="bd6b2-138">Indica se os dados devem ter o marshaling realizado para o chamador.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-138">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="bd6b2-139">Pode ser usado para parâmetros de atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-139">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="bd6b2-140">Controla como uma interface gerenciada é exposta aos clientes COM (Dupla, derivada de IUnknown ou somente IDispatch).</span><span class="sxs-lookup"><span data-stu-id="bd6b2-140">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="bd6b2-141">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-141">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="bd6b2-142">Indica que uma assinatura de método não gerenciado espera um parâmetro LCID.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-142">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="bd6b2-143">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="bd6b2-144">Indica como os dados em campos ou parâmetros devem ter o marshaling realizado entre o código gerenciado e não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-144">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="bd6b2-145">O atributo sempre é opcional, porque cada tipo de dados tem um comportamento de marshaling padrão.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-145">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="bd6b2-146">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-146">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="bd6b2-147">Indica que um parâmetro é opcional.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-147">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="bd6b2-148">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-148">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="bd6b2-149">Indica se os dados em um campo ou parâmetro devem ter o marshaling realizado de um objeto chamado novamente para seu chamador.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-149">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="bd6b2-150">Suprime a transformação de assinatura HRESULT ou retval que normalmente ocorre durante chamadas de interoperação.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-150">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="bd6b2-151">O atributo afeta o marshaling, bem como a exportação da biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-151">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="bd6b2-152">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-152">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="bd6b2-153">Especifica o ProgID de uma classe do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-153">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="bd6b2-154">Pode ser usado para classes de atributos.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-154">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="bd6b2-155">Controla o layout físico dos campos de uma classe.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-155">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="bd6b2-156">Ferramentas de interoperabilidade COM podem aplicar esse atributo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-156">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="bd6b2-157">Atributos da ferramenta de conversão</span><span class="sxs-lookup"><span data-stu-id="bd6b2-157">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="bd6b2-158">A tabela a seguir descreve os atributos que as ferramentas de interoperabilidade COM aplicam durante o processo de conversão.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-158">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="bd6b2-159">Esses atributos não são aplicados em tempo de design.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-159">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="bd6b2-160">Atributo</span><span class="sxs-lookup"><span data-stu-id="bd6b2-160">Attribute</span></span>|<span data-ttu-id="bd6b2-161">Descrição</span><span class="sxs-lookup"><span data-stu-id="bd6b2-161">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="bd6b2-162">Indica o alias COM de um parâmetro ou tipo de campo.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-162">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="bd6b2-163">Pode ser usado para parâmetros de atributo, campos ou valores retornados.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-163">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="bd6b2-164">Indica que as informações sobre uma classe ou interface foram perdidas quando foram importadas de uma biblioteca de tipos para um assembly.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-164">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="bd6b2-165">Identifica a interface de origem e a classe que implementa os métodos da interface do evento.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-165">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="bd6b2-166">Indica que o assembly foi originalmente importado de uma biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-166">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="bd6b2-167">Este atributo contém a definição de biblioteca de tipos da biblioteca de tipos original.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-167">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="bd6b2-168">Contém o **FUNCFLAGS** que foi originalmente importado para essa função da biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-168">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="bd6b2-169">Contém o **TYPEFLAGS** que foi originalmente importado para esse tipo da biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-169">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="bd6b2-170">Contém o **VARFLAGS** que foi originalmente importado para essa variável da biblioteca de tipos COM.</span><span class="sxs-lookup"><span data-stu-id="bd6b2-170">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="bd6b2-171">Veja também</span><span class="sxs-lookup"><span data-stu-id="bd6b2-171">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="bd6b2-172">Expondo componentes do .NET Framework para COM</span><span class="sxs-lookup"><span data-stu-id="bd6b2-172">Exposing .NET Framework Components to COM</span></span>](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="bd6b2-173">Atributos</span><span class="sxs-lookup"><span data-stu-id="bd6b2-173">Attributes</span></span>](../../../docs/standard/attributes/index.md)
- [<span data-ttu-id="bd6b2-174">Qualificando tipos do .NET para interoperação</span><span class="sxs-lookup"><span data-stu-id="bd6b2-174">Qualifying .NET Types for Interoperation</span></span>](../../../docs/standard/native-interop/qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="bd6b2-175">Como empacotar um assembly .NET Framework para o COM</span><span class="sxs-lookup"><span data-stu-id="bd6b2-175">Packaging a .NET Framework Assembly for COM</span></span>](../../../docs/framework/interop/packaging-an-assembly-for-com.md)
