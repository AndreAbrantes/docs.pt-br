---
title: Diretrizes de codificação seguras para .NET
description: Design código para trabalhar com . Permissões impostas pela NET e outras aplicações para ajudar a impedir que o código malicioso acesse dados ou realize outras ações.
ms.date: 06/28/2018
helpviewer_keywords:
- managed wrapper to native code implementation
- secure coding
- reusable components
- library code that exposes protected resources
- code, security
- code security
- secure coding, options
- components [.NET], security
- code security, options
- security-neutral code
- security [.NET], coding guidelines
ms.assetid: 4f882d94-262b-4494-b0a6-ba9ba1f5f177
ms.openlocfilehash: 05f7e039ecdc0cd33baa015872924fb9e1f078aa
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187722"
---
# <a name="secure-coding-guidelines"></a><span data-ttu-id="d24e2-103">Diretrizes seguras de codificação</span><span class="sxs-lookup"><span data-stu-id="d24e2-103">Secure coding guidelines</span></span>

<span data-ttu-id="d24e2-104">A segurança baseada em evidências e a segurança de acesso a códigos fornecem mecanismos muito poderosos e explícitos para implementar a segurança.</span><span class="sxs-lookup"><span data-stu-id="d24e2-104">Evidence-based security and code access security provide very powerful, explicit mechanisms to implement security.</span></span> <span data-ttu-id="d24e2-105">A maioria do código de aplicativo pode simplesmente usar a infra-estrutura implementada pelo .NET.</span><span class="sxs-lookup"><span data-stu-id="d24e2-105">Most application code can simply use the infrastructure implemented by .NET.</span></span> <span data-ttu-id="d24e2-106">Em alguns casos, é necessária segurança específica do aplicativo adicional, construída por meio da ampliação do sistema de segurança ou usando novos métodos ad hoc.</span><span class="sxs-lookup"><span data-stu-id="d24e2-106">In some cases, additional application-specific security is required, built either by extending the security system or by using new ad hoc methods.</span></span>

<span data-ttu-id="d24e2-107">Usando permissões impostas pelo .NET e outras aplicação em seu código, você deve erguer barreiras para impedir que o código malicioso acesse informações que você não deseja que ela tenha ou realize outras ações indesejáveis.</span><span class="sxs-lookup"><span data-stu-id="d24e2-107">Using .NET enforced permissions and other enforcement in your code, you should erect barriers to prevent malicious code from accessing information that you don't want it to have or performing other undesirable actions.</span></span> <span data-ttu-id="d24e2-108">Além disso, você deve encontrar um equilíbrio entre segurança e usabilidade em todos os cenários esperados usando código confiável.</span><span class="sxs-lookup"><span data-stu-id="d24e2-108">Additionally, you must strike a balance between security and usability in all the expected scenarios using trusted code.</span></span>

<span data-ttu-id="d24e2-109">Esta visão geral descreve as diferentes maneiras pelas quais o código pode ser projetado para trabalhar com o sistema de segurança.</span><span class="sxs-lookup"><span data-stu-id="d24e2-109">This overview describes the different ways code can be designed to work with the security system.</span></span>

## <a name="securing-resource-access"></a><span data-ttu-id="d24e2-110">Garantir o acesso a recursos</span><span class="sxs-lookup"><span data-stu-id="d24e2-110">Securing resource access</span></span>

<span data-ttu-id="d24e2-111">Ao projetar e escrever seu código, você precisa proteger e limitar o acesso que esse código tem aos recursos, especialmente ao usar ou invocar código de origem desconhecida.</span><span class="sxs-lookup"><span data-stu-id="d24e2-111">When designing and writing your code, you need to protect and limit the access that code has to resources, especially when using or invoking code of unknown origin.</span></span> <span data-ttu-id="d24e2-112">Portanto, tenha em mente as seguintes técnicas para garantir que seu código esteja seguro:</span><span class="sxs-lookup"><span data-stu-id="d24e2-112">So, keep in mind the following techniques to ensure your code is secure:</span></span>

- <span data-ttu-id="d24e2-113">Não use o Cas (Code Access Security).</span><span class="sxs-lookup"><span data-stu-id="d24e2-113">Do not use Code Access Security (CAS).</span></span>

- <span data-ttu-id="d24e2-114">Não use código parcial de confiança.</span><span class="sxs-lookup"><span data-stu-id="d24e2-114">Do not use partial trusted code.</span></span>

- <span data-ttu-id="d24e2-115">Não use o atributo [AllowPartiallyTrustedCaller](xref:System.Security.AllowPartiallyTrustedCallersAttribute) (APTCA).</span><span class="sxs-lookup"><span data-stu-id="d24e2-115">Do not use the [AllowPartiallyTrustedCaller](xref:System.Security.AllowPartiallyTrustedCallersAttribute) attribute (APTCA).</span></span>

- <span data-ttu-id="d24e2-116">Não use .NET Remoting.</span><span class="sxs-lookup"><span data-stu-id="d24e2-116">Do not use .NET Remoting.</span></span>

- <span data-ttu-id="d24e2-117">Não use DCOM (Distributed Component Object Model, modelo de objeto componente distribuído).</span><span class="sxs-lookup"><span data-stu-id="d24e2-117">Do not use Distributed Component Object Model (DCOM).</span></span>

- <span data-ttu-id="d24e2-118">Não use assuntos binários.</span><span class="sxs-lookup"><span data-stu-id="d24e2-118">Do not use binary formatters.</span></span>

<span data-ttu-id="d24e2-119">Segurança de acesso ao código e código transparente de segurança não são suportados como um limite de segurança com código parcialmente confiável.</span><span class="sxs-lookup"><span data-stu-id="d24e2-119">Code Access Security and Security-Transparent Code are not supported as a security boundary with partially trusted code.</span></span> <span data-ttu-id="d24e2-120">Não aconselhamos carregar e executar códigos de origens desconhecidas sem a adoção de medidas de segurança alternativas no local.</span><span class="sxs-lookup"><span data-stu-id="d24e2-120">We advise against loading and executing code of unknown origins without putting alternative security measures in place.</span></span> <span data-ttu-id="d24e2-121">As medidas alternativas de segurança são:</span><span class="sxs-lookup"><span data-stu-id="d24e2-121">The alternative security measures are:</span></span>

- <span data-ttu-id="d24e2-122">Virtualização</span><span class="sxs-lookup"><span data-stu-id="d24e2-122">Virtualization</span></span>

- <span data-ttu-id="d24e2-123">Contêineres de aplicativos</span><span class="sxs-lookup"><span data-stu-id="d24e2-123">AppContainers</span></span>

- <span data-ttu-id="d24e2-124">Usuários e permissões do sistema operacional (OS)</span><span class="sxs-lookup"><span data-stu-id="d24e2-124">Operating system (OS) users and permissions</span></span>

- <span data-ttu-id="d24e2-125">Contêineres do Hyper-V</span><span class="sxs-lookup"><span data-stu-id="d24e2-125">Hyper-V containers</span></span>

## <a name="security-neutral-code"></a><span data-ttu-id="d24e2-126">Código neutro de segurança</span><span class="sxs-lookup"><span data-stu-id="d24e2-126">Security-neutral code</span></span>

<span data-ttu-id="d24e2-127">Código neutro de segurança não faz nada explícito com o sistema de segurança.</span><span class="sxs-lookup"><span data-stu-id="d24e2-127">Security-neutral code does nothing explicit with the security system.</span></span> <span data-ttu-id="d24e2-128">Funciona com todas as permissões que recebe.</span><span class="sxs-lookup"><span data-stu-id="d24e2-128">It runs with whatever permissions it receives.</span></span> <span data-ttu-id="d24e2-129">Embora aplicativos que não conseguem capturar exceções de segurança associadas a operações protegidas (como o uso de arquivos, redes e assim por diante) possam resultar em uma exceção não manuseada, o código neutro de segurança ainda tira proveito das tecnologias de segurança no .NET .</span><span class="sxs-lookup"><span data-stu-id="d24e2-129">Although applications that fail to catch security exceptions associated with protected operations (such as using files, networking, and so on) can result in an unhandled exception, security-neutral code still takes advantage of the security technologies in .NET.</span></span>

<span data-ttu-id="d24e2-130">Uma biblioteca neutra em segurança tem características especiais que você deve entender.</span><span class="sxs-lookup"><span data-stu-id="d24e2-130">A security-neutral library has special characteristics that you should understand.</span></span> <span data-ttu-id="d24e2-131">Suponha que sua biblioteca forneça elementos de API que usam arquivos ou chamam código não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="d24e2-131">Suppose your library provides API elements that use files or call unmanaged code.</span></span> <span data-ttu-id="d24e2-132">Se o seu código não tiver a permissão correspondente, ele não será executado como descrito.</span><span class="sxs-lookup"><span data-stu-id="d24e2-132">If your code doesn't have the corresponding permission, it won't run as described.</span></span> <span data-ttu-id="d24e2-133">No entanto, mesmo que o código tenha a permissão, qualquer código de aplicativo que o chame deve ter a mesma permissão para funcionar.</span><span class="sxs-lookup"><span data-stu-id="d24e2-133">However, even if the code has the permission, any application code that calls it must have the same permission in order to work.</span></span> <span data-ttu-id="d24e2-134">Se o código de chamada não tiver <xref:System.Security.SecurityException> a permissão certa, um aparecerá como resultado da caminhada da pilha de segurança de acesso ao código.</span><span class="sxs-lookup"><span data-stu-id="d24e2-134">If the calling code doesn't have the right permission, a <xref:System.Security.SecurityException> appears as a result of the code access security stack walk.</span></span>

## <a name="application-code-that-isnt-a-reusable-component"></a><span data-ttu-id="d24e2-135">Código de aplicativo que não é um componente reutilizável</span><span class="sxs-lookup"><span data-stu-id="d24e2-135">Application code that isn't a reusable component</span></span>

<span data-ttu-id="d24e2-136">Se o seu código faz parte de um aplicativo que não será chamado por outro código, a segurança é simples e a codificação especial pode não ser necessária.</span><span class="sxs-lookup"><span data-stu-id="d24e2-136">If your code is part of an application that won't be called by other code, security is simple and special coding might not be required.</span></span> <span data-ttu-id="d24e2-137">No entanto, lembre-se que o código malicioso pode chamar seu código.</span><span class="sxs-lookup"><span data-stu-id="d24e2-137">However, remember that malicious code can call your code.</span></span> <span data-ttu-id="d24e2-138">Embora a segurança de acesso a código possa impedir que o código malicioso acesse recursos, esse código ainda pode ler valores de seus campos ou propriedades que possam conter informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="d24e2-138">While code access security might stop malicious code from accessing resources, such code could still read values of your fields or properties that might contain sensitive information.</span></span>

<span data-ttu-id="d24e2-139">Além disso, se o seu código aceitar a entrada do usuário da Internet ou de outras fontes não confiáveis, você deve ter cuidado com a entrada maliciosa.</span><span class="sxs-lookup"><span data-stu-id="d24e2-139">Additionally, if your code accepts user input from the Internet or other unreliable sources, you must be careful about malicious input.</span></span>

## <a name="managed-wrapper-to-native-code-implementation"></a><span data-ttu-id="d24e2-140">Invólucro gerenciado para implementação de código nativo</span><span class="sxs-lookup"><span data-stu-id="d24e2-140">Managed wrapper to native code implementation</span></span>

<span data-ttu-id="d24e2-141">Normalmente, neste cenário, algumas funcionalidades úteis são implementadas em código nativo que você deseja disponibilizar para código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="d24e2-141">Typically in this scenario, some useful functionality is implemented in native code that you want to make available to managed code.</span></span> <span data-ttu-id="d24e2-142">Os invólucros gerenciados são fáceis de gravar usando invocação de plataforma ou interop COM.</span><span class="sxs-lookup"><span data-stu-id="d24e2-142">Managed wrappers are easy to write using either platform invoke or COM interop.</span></span> <span data-ttu-id="d24e2-143">No entanto, se você fizer isso, os chamadores de seus invólucros devem ter direitos de código não gerenciados para ter sucesso.</span><span class="sxs-lookup"><span data-stu-id="d24e2-143">However, if you do this, callers of your wrappers must have unmanaged code rights in order to succeed.</span></span> <span data-ttu-id="d24e2-144">Na política padrão, isso significa que o código baixado de uma intranet ou a Internet não funcionará com os invólucros.</span><span class="sxs-lookup"><span data-stu-id="d24e2-144">Under default policy, this means that code downloaded from an intranet or the Internet won't work with the wrappers.</span></span>

<span data-ttu-id="d24e2-145">Em vez de dar direitos de código não gerenciados a todos os aplicativos que usam esses invólucros, é melhor dar esses direitos apenas ao código de invólucro.</span><span class="sxs-lookup"><span data-stu-id="d24e2-145">Instead of giving unmanaged code rights to all applications that use these wrappers, it's better to give these rights only to the wrapper code.</span></span> <span data-ttu-id="d24e2-146">Se a funcionalidade subjacente não expor recursos e a implementação for igualmente segura, o invólucro só precisa fazer valer seus direitos, o que permite que qualquer código seja chamado através dele.</span><span class="sxs-lookup"><span data-stu-id="d24e2-146">If the underlying functionality exposes no resources and the implementation is likewise safe, the wrapper only needs to assert its rights, which enables any code to call through it.</span></span> <span data-ttu-id="d24e2-147">Quando os recursos estão envolvidos, a codificação de segurança deve ser a mesma do caso de código de biblioteca descrito na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="d24e2-147">When resources are involved, security coding should be the same as the library code case described in the next section.</span></span> <span data-ttu-id="d24e2-148">Como o invólucro está potencialmente expondo os chamadores a esses recursos, a verificação cuidadosa da segurança do código nativo é necessária e é responsabilidade do invólucro.</span><span class="sxs-lookup"><span data-stu-id="d24e2-148">Because the wrapper is potentially exposing callers to these resources, careful verification of the safety of the native code is necessary and is the wrapper's responsibility.</span></span>

## <a name="library-code-that-exposes-protected-resources"></a><span data-ttu-id="d24e2-149">Código da biblioteca que expõe recursos protegidos</span><span class="sxs-lookup"><span data-stu-id="d24e2-149">Library code that exposes protected resources</span></span>

<span data-ttu-id="d24e2-150">A abordagem a seguir é a mais poderosa e, portanto, potencialmente perigosa (se feita incorretamente) para codificação de segurança: sua biblioteca serve como uma interface para outro código acessar certos recursos que não estão disponíveis de outra forma, assim como as classes .NET se aplicam permissões para os recursos que eles usam.</span><span class="sxs-lookup"><span data-stu-id="d24e2-150">The following approach is the most powerful and hence potentially dangerous (if done incorrectly) for security coding: your library serves as an interface for other code to access certain resources that aren't otherwise available, just as the .NET classes enforce permissions for the resources they use.</span></span> <span data-ttu-id="d24e2-151">Onde quer que você exponha um recurso, seu código deve primeiro exigir a permissão apropriada ao recurso (ou seja, ele deve realizar uma verificação de segurança) e, em seguida, normalmente, afirmar seus direitos para executar a operação real.</span><span class="sxs-lookup"><span data-stu-id="d24e2-151">Wherever you expose a resource, your code must first demand the permission appropriate to the resource (that is, it must perform a security check) and then typically assert its rights to perform the actual operation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d24e2-152">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d24e2-152">Related topics</span></span>

|<span data-ttu-id="d24e2-153">Title</span><span class="sxs-lookup"><span data-stu-id="d24e2-153">Title</span></span>|<span data-ttu-id="d24e2-154">Descrição</span><span class="sxs-lookup"><span data-stu-id="d24e2-154">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="d24e2-155">Protegendo dados de estado</span><span class="sxs-lookup"><span data-stu-id="d24e2-155">Securing State Data</span></span>](securing-state-data.md)|<span data-ttu-id="d24e2-156">Descreve como proteger membros privados.</span><span class="sxs-lookup"><span data-stu-id="d24e2-156">Describes how to protect private members.</span></span>|
|[<span data-ttu-id="d24e2-157">Segurança e entrada do usuário</span><span class="sxs-lookup"><span data-stu-id="d24e2-157">Security and User Input</span></span>](security-and-user-input.md)|<span data-ttu-id="d24e2-158">Descreve preocupações de segurança para aplicativos que aceitam a entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="d24e2-158">Describes security concerns for applications that accept user input.</span></span>|
|[<span data-ttu-id="d24e2-159">Segurança e condições de corrida</span><span class="sxs-lookup"><span data-stu-id="d24e2-159">Security and Race Conditions</span></span>](security-and-race-conditions.md)|<span data-ttu-id="d24e2-160">Descreve como evitar condições de raça em seu código.</span><span class="sxs-lookup"><span data-stu-id="d24e2-160">Describes how to avoid race conditions in your code.</span></span>|
|[<span data-ttu-id="d24e2-161">Segurança e geração dinâmica de código</span><span class="sxs-lookup"><span data-stu-id="d24e2-161">Security and On-the-Fly Code Generation</span></span>](security-and-on-the-fly-code-generation.md)|<span data-ttu-id="d24e2-162">Descreve preocupações de segurança para aplicativos que geram código dinâmico.</span><span class="sxs-lookup"><span data-stu-id="d24e2-162">Describes security concerns for applications that generate dynamic code.</span></span>|
|[<span data-ttu-id="d24e2-163">Segurança baseada em papéis</span><span class="sxs-lookup"><span data-stu-id="d24e2-163">Role-Based Security</span></span>](role-based-security.md)|<span data-ttu-id="d24e2-164">Descreve a segurança baseada em papéis .NET em detalhes e fornece instruções para usá-la em seu código.</span><span class="sxs-lookup"><span data-stu-id="d24e2-164">Describes .NET role-based security in detail and provides instructions for using it in your code.</span></span>|
