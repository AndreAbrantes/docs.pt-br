---
title: Segurança de LINQ to XML-LINQ to XML
description: Saiba mais sobre os problemas de segurança LINQ to XML e maneiras de mitigar a exposição à segurança.
ms.date: 07/20/2015
ms.assetid: ef2c0dc9-ecf9-4c17-b24e-144184ab725f
ms.openlocfilehash: 72dd2bfe2a3f0edb69645daf4625ba24fb56732b
ms.sourcegitcommit: 0c3ce6d2e7586d925a30f231f32046b7b3934acb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/08/2020
ms.locfileid: "89551977"
---
# <a name="linq-to-xml-security"></a><span data-ttu-id="ff58b-103">Segurança de LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ff58b-103">LINQ to XML security</span></span>

<span data-ttu-id="ff58b-104">Este artigo descreve os problemas de segurança associados ao LINQ to XML e fornece diretrizes para atenuar a exposição de segurança.</span><span class="sxs-lookup"><span data-stu-id="ff58b-104">This article describes security issues associated with LINQ to XML, and provides guidance for mitigating security exposure.</span></span>

## <a name="linq-to-xml-security-overview"></a><span data-ttu-id="ff58b-105">Visão geral da segurança do LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ff58b-105">LINQ to XML security overview</span></span>

<span data-ttu-id="ff58b-106">LINQ to XML é criado mais para sua conveniência de programação do que para aplicativos do lado com requisitos de segurança estritos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-106">LINQ to XML is designed more for programming convenience than for server-side applications with stringent security requirements.</span></span> <span data-ttu-id="ff58b-107">A maioria das situações XML consistem processar documentos XML de confiança, em vez de processar os documentos XML não confiáveis que são carregados em um servidor.</span><span class="sxs-lookup"><span data-stu-id="ff58b-107">Most XML scenarios consist of processing trusted XML documents, rather than processing untrusted XML documents that are uploaded to a server.</span></span> <span data-ttu-id="ff58b-108">LINQ to XML é otimizado para esses cenários.</span><span class="sxs-lookup"><span data-stu-id="ff58b-108">LINQ to XML is optimized for these scenarios.</span></span>

<span data-ttu-id="ff58b-109">Se você deve processar dados não confiáveis de fontes desconhecidas, Microsoft recomendável que você use uma instância da classe de <xref:System.Xml.XmlReader> que foi configurada para filtrar ataques conhecidos para fora de (DoS) de negação de serviço XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-109">If you must process untrusted data from unknown sources, Microsoft recommends that you use an instance of the <xref:System.Xml.XmlReader> class that has been configured to filter out known XML denial of service (DoS) attacks.</span></span>

<span data-ttu-id="ff58b-110">Se você tiver configurado um <xref:System.Xml.XmlReader> para atenuar ataques de negação de serviço, poderá usar esse leitor para preencher uma árvore de LINQ to XML e ainda se beneficiar dos aprimoramentos de produtividade do programador do LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-110">If you've configured an <xref:System.Xml.XmlReader> to mitigate denial of service attacks, you can use that reader to populate a LINQ to XML tree and still benefit from the programmer productivity enhancements of LINQ to XML.</span></span> <span data-ttu-id="ff58b-111">Várias técnicas mitigação envolvem criar os leitores que são configurados para reduzir a problema de segurança, e então instanciar uma árvore XML através do leitor configurado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-111">Many mitigation techniques involve creating readers that are configured to mitigate the security issue, and then instantiating an XML tree through the configured reader.</span></span>

<span data-ttu-id="ff58b-112">XML é intrinsecamente vulnerável a ataques de negação de serviço como documentos são ilimitadas em tamanho, a profundidade, o tamanho do nome do elemento, e mais.</span><span class="sxs-lookup"><span data-stu-id="ff58b-112">XML is intrinsically vulnerable to denial of service attacks because documents are unbounded in size, depth, element name size, and more.</span></span> <span data-ttu-id="ff58b-113">Independentemente do componente que você usa para processar XML, você sempre deve estar preparado para reciclar o domínio de aplicativo usa recursos excessivos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-113">Regardless of the component that you use to process XML, you should always be prepared to recycle the application domain if it uses excessive resources.</span></span>

## <a name="mitigation-of-xml-xsd-xpath-and-xslt-attacks"></a><span data-ttu-id="ff58b-114">Mitigação de ataques XML, XSD, XPath e XSLT</span><span class="sxs-lookup"><span data-stu-id="ff58b-114">Mitigation of XML, XSD, XPath, and XSLT attacks</span></span>

<span data-ttu-id="ff58b-115">LINQ to XML é compilado em cima de <xref:System.Xml.XmlReader> e de <xref:System.Xml.XmlWriter>.</span><span class="sxs-lookup"><span data-stu-id="ff58b-115">LINQ to XML is built upon <xref:System.Xml.XmlReader> and <xref:System.Xml.XmlWriter>.</span></span> <span data-ttu-id="ff58b-116">LINQ to XML suporta XSD e o XPath com métodos de extensão em <xref:System.Xml.Schema?displayProperty=nameWithType> e nos namespaces de <xref:System.Xml.XPath?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ff58b-116">LINQ to XML supports XSD and XPath through extension methods in the <xref:System.Xml.Schema?displayProperty=nameWithType> and <xref:System.Xml.XPath?displayProperty=nameWithType> namespaces.</span></span> <span data-ttu-id="ff58b-117">Usando as <xref:System.Xml.XmlReader> classes, <xref:System.Xml.XPath.XPathNavigator> e <xref:System.Xml.XmlWriter> em conjunto com LINQ to XML, você pode invocar o XSLT para transformar árvores XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-117">By using the <xref:System.Xml.XmlReader>, <xref:System.Xml.XPath.XPathNavigator>, and <xref:System.Xml.XmlWriter> classes in conjunction with LINQ to XML, you can invoke XSLT to transform XML trees.</span></span>

<span data-ttu-id="ff58b-118">Se você estiver operando em um ambiente menos seguro, haverá vários problemas de segurança associados ao XML e ao uso das classes no <xref:System.Xml?displayProperty=nameWithType> , <xref:System.Xml.Schema?displayProperty=nameWithType> , <xref:System.Xml.XPath?displayProperty=nameWithType> e <xref:System.Xml.Xsl?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ff58b-118">If you're  operating in a less secure environment, there are a number of security issues that are associated with XML and the use of the classes in <xref:System.Xml?displayProperty=nameWithType>, <xref:System.Xml.Schema?displayProperty=nameWithType>, <xref:System.Xml.XPath?displayProperty=nameWithType>, and <xref:System.Xml.Xsl?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ff58b-119">Esses problemas incluem, mas não se limitam a, o seguinte:</span><span class="sxs-lookup"><span data-stu-id="ff58b-119">These issues include, but aren't limited to, the following:</span></span>

- <span data-ttu-id="ff58b-120">XSD, XPath, e XSLT são linguagens cadeia de caracteres- baseados em que você pode especificar as operações que consomem muito tempo ou memória.</span><span class="sxs-lookup"><span data-stu-id="ff58b-120">XSD, XPath, and XSLT are string-based languages in which you can specify operations that consume a lot of time or memory.</span></span> <span data-ttu-id="ff58b-121">É responsabilidade dos programadores de aplicativos que usam cadeias de caracteres XSD, XPath ou XSLT de fontes não confiáveis para validar que as cadeias de caracteres não são mal-intencionadas ou para monitorar e atenuar a possibilidade de avaliar essas cadeias de caracteres resultarão em consumo excessivo de recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="ff58b-121">It's the responsibility of application programmers who take XSD, XPath, or XSLT strings from untrusted sources to validate that the strings aren't malicious, or to monitor and mitigate the possibility that evaluating these strings will lead to excessive system resource consumption.</span></span>
- <span data-ttu-id="ff58b-122">Os esquemas XSD (incluindo esquemas embutidos) são inerentemente vulneráveis a ataques de negação de serviço; Você não deve aceitar esquemas de fontes não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ff58b-122">XSD schemas (including inline schemas) are inherently vulnerable to denial of service attacks; you shouldn't accept schemas from untrusted sources.</span></span>
- <span data-ttu-id="ff58b-123">XSD e XSLT podem incluir referências a outros arquivos, e essas referências podem levar a ataques entre zona e entre domínios.</span><span class="sxs-lookup"><span data-stu-id="ff58b-123">XSD and XSLT can include references to other files, and such references can result in cross-zone and cross-domain attacks.</span></span>
- <span data-ttu-id="ff58b-124">As entidades externas nos DTDs pode levar a ataques entre zona e entre domínios.</span><span class="sxs-lookup"><span data-stu-id="ff58b-124">External entities in DTDs can result in cross-zone and cross-domain attacks.</span></span>
- <span data-ttu-id="ff58b-125">Os DTDs é vulnerável a ataques de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="ff58b-125">DTDs are vulnerable to denial of service attacks.</span></span>
- <span data-ttu-id="ff58b-126">Documentos XML exclusivamente profundos podem disparar problemas de negação de serviço; talvez você queira limitar o tamanho dos documentos XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-126">Exceptionally deep XML documents can pose denial of service issues; you might want to limit the depth of XML documents.</span></span>
- <span data-ttu-id="ff58b-127">Não aceite componentes de suporte, como <xref:System.Xml.NameTable> <xref:System.Xml.XmlNamespaceManager> objetos, e <xref:System.Xml.XmlResolver> de assemblies não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ff58b-127">Don't accept supporting components, such as <xref:System.Xml.NameTable>, <xref:System.Xml.XmlNamespaceManager>, and <xref:System.Xml.XmlResolver> objects, from untrusted assemblies.</span></span>
- <span data-ttu-id="ff58b-128">Ler dados em partes para atenuar grandes ataques do documento.</span><span class="sxs-lookup"><span data-stu-id="ff58b-128">Read data in chunks to mitigate large document attacks.</span></span>
- <span data-ttu-id="ff58b-129">Blocos de script em folhas de estilos XSLT podem expor um número de ataques.</span><span class="sxs-lookup"><span data-stu-id="ff58b-129">Script blocks in XSLT style sheets can expose a number of attacks.</span></span>
- <span data-ttu-id="ff58b-130">Validar cuidadosamente antes de construir expressões XPath dinâmicos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-130">Validate carefully before constructing dynamic XPath expressions.</span></span>

## <a name="linq-to-xml-security-issues"></a><span data-ttu-id="ff58b-131">Problemas de segurança do LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ff58b-131">LINQ to XML security issues</span></span>

<span data-ttu-id="ff58b-132">Os problemas de segurança neste artigo não são apresentados em nenhuma ordem específica.</span><span class="sxs-lookup"><span data-stu-id="ff58b-132">The security issues in this article aren't presented in any particular order.</span></span> <span data-ttu-id="ff58b-133">Todos os problemas são importantes e devem ser endereçados conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-133">All issues are important and should be addressed as appropriate.</span></span>

<span data-ttu-id="ff58b-134">Um ataue de elevação de privilégio fornece a um conjunto mal-intencionado mais controle sobre seu ambiente.</span><span class="sxs-lookup"><span data-stu-id="ff58b-134">A successful elevation of privilege attack gives a malicious assembly more control over its environment.</span></span> <span data-ttu-id="ff58b-135">Um ataue de elevação de privilégio pode levar a divulgação de dados, negação de serviço, e mais.</span><span class="sxs-lookup"><span data-stu-id="ff58b-135">A successful elevation of privilege attack can result in disclosure of data, denial of service, and more.</span></span>

<span data-ttu-id="ff58b-136">Os aplicativos não devem divulgar dados para usuários que não estão autorizados a ver esses dados.</span><span class="sxs-lookup"><span data-stu-id="ff58b-136">Applications shouldn't disclose data to users who aren't authorized to see that data.</span></span>

<span data-ttu-id="ff58b-137">Ataques de negação de serviço faz com que o analisador XML ou LINQ to XML consome quantidades de memória excessivas ou processador central - tempo.</span><span class="sxs-lookup"><span data-stu-id="ff58b-137">Denial of service attacks cause the XML parser or LINQ to XML to consume excessive amounts of memory or CPU time.</span></span> <span data-ttu-id="ff58b-138">Ataques de negação de serviço são considerados menos severos da ataques de elevação de privilégio ou de divulgação de ataques de dados.</span><span class="sxs-lookup"><span data-stu-id="ff58b-138">Denial of service attacks are considered to be less severe than elevation of privilege attacks or disclosure of data attacks.</span></span> <span data-ttu-id="ff58b-139">No entanto, eles são importantes em um cenário em que um servidor precisa processar documentos XML de fontes não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ff58b-139">However, they're important in a scenario where a server needs to process XML documents from untrusted sources.</span></span>

### <a name="dont-expose-error-messages-to-untrusted-callers"></a><span data-ttu-id="ff58b-140">Não expor mensagens de erro para chamadores não confiáveis</span><span class="sxs-lookup"><span data-stu-id="ff58b-140">Don't expose error messages to untrusted callers</span></span>

<span data-ttu-id="ff58b-141">A descrição de um erro pode revelar dados, como os dados que estão sendo convertidos, nomes de arquivo, ou detalhes de implementação.</span><span class="sxs-lookup"><span data-stu-id="ff58b-141">The description of an error might reveal data, such as the data being transformed, file names, or implementation details.</span></span> <span data-ttu-id="ff58b-142">As mensagens de erro não devem ser expostas a chamadores que não são confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ff58b-142">Error messages shouldn't be exposed to callers that aren't trusted.</span></span> <span data-ttu-id="ff58b-143">Devido você capturar erros e erros de relatório com suas próprias mensagens de erro personalizadas.</span><span class="sxs-lookup"><span data-stu-id="ff58b-143">You should catch all errors and report errors with your own custom error messages.</span></span>

### <a name="dont-call-codeaccesspermissionsassert-in-an-event-handler"></a><span data-ttu-id="ff58b-144">Não chame CodeAccessPermissions. Assert em um manipulador de eventos</span><span class="sxs-lookup"><span data-stu-id="ff58b-144">Don't call CodeAccessPermissions.Assert in an event handler</span></span>

<span data-ttu-id="ff58b-145">Um assembly pode ter o invés ou mais permissões.</span><span class="sxs-lookup"><span data-stu-id="ff58b-145">An assembly can have lesser or greater permissions.</span></span> <span data-ttu-id="ff58b-146">Um assembly que tem mais permissões tem maior controle sobre o computador e seus ambientes.</span><span class="sxs-lookup"><span data-stu-id="ff58b-146">An assembly that has greater permissions has greater control over the computer and its environments.</span></span>

<span data-ttu-id="ff58b-147">Se o código em um assembly com mais permissões chama <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> em um manipulador de eventos, e a árvore XML é passada a um conjunto mal-intencionado que restringir permissões, o conjunto mal-intencionado pode causar um evento a ser gerado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-147">If code in an assembly with greater permissions calls <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler, and then the XML tree is passed to a malicious assembly that has restricted permissions, the malicious assembly can cause an event to be raised.</span></span> <span data-ttu-id="ff58b-148">Como o evento executa o código que está no assembly com permissões maiores, o assembly mal-intencionado estaria operando com privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="ff58b-148">Because the event runs code that's in the assembly with greater permissions, the malicious assembly would then be operating with elevated privileges.</span></span>

<span data-ttu-id="ff58b-149">Microsoft recomendável que você nunca chama <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> em um manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-149">Microsoft recommends that you never call <xref:System.Security.CodeAccessPermission.Assert%2A?displayProperty=nameWithType> in an event handler.</span></span>

### <a name="dont-accept-dtds-from-untrusted-sources"></a><span data-ttu-id="ff58b-150">Não aceitar DTDs de fontes não confiáveis</span><span class="sxs-lookup"><span data-stu-id="ff58b-150">Don't accept DTDs from untrusted sources</span></span>

<span data-ttu-id="ff58b-151">As entidades nos DTDs não são inerentemente seguros.</span><span class="sxs-lookup"><span data-stu-id="ff58b-151">Entities in DTDs are inherently not secure.</span></span> <span data-ttu-id="ff58b-152">É possível que um documento XML mal-intencionado que contenha um DTD faça com que o analisador use toda a memória e o tempo de CPU, causando um ataque de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="ff58b-152">It's possible for a malicious XML document that contains a DTD to cause the parser to use all memory and CPU time, causing a denial of service attack.</span></span> <span data-ttu-id="ff58b-153">Portanto, em LINQ to XML, o processamento de DTD é desativada por padrão.</span><span class="sxs-lookup"><span data-stu-id="ff58b-153">Therefore, in LINQ to XML, DTD processing is turned off by default.</span></span> <span data-ttu-id="ff58b-154">Você não deve aceitar DTDs de fontes não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="ff58b-154">You shouldn't accept DTDs from untrusted sources.</span></span>

<span data-ttu-id="ff58b-155">Um exemplo de aceitar os DTDs de fontes não confiáveis é um aplicativo da Web que permite que os usuários carreguem Web de um arquivo XML que referencia um DTD e um arquivo de DTD.</span><span class="sxs-lookup"><span data-stu-id="ff58b-155">One example of accepting DTDs from untrusted sources is a Web application that allows Web users to upload an XML file that references a DTD and a DTD file.</span></span> <span data-ttu-id="ff58b-156">Em cima de validação de arquivo, um DTD mal-intencionado pode executar um ataque de negação de serviço no seu servidor.</span><span class="sxs-lookup"><span data-stu-id="ff58b-156">Upon validation of the file, a malicious DTD could execute a denial of service attack on your server.</span></span> <span data-ttu-id="ff58b-157">Um exemplo de aceitar os DTDs de fontes não confiáveis é fazer referência a um DTD em um compartilhamento de rede que também permite acesso de FTP anônimo.</span><span class="sxs-lookup"><span data-stu-id="ff58b-157">Another example of accepting DTDs from untrusted sources is to reference a DTD on a network share that also allows anonymous FTP access.</span></span>

### <a name="avoid-excessive-buffer-allocation"></a><span data-ttu-id="ff58b-158">Evitar alocação excessiva de buffer</span><span class="sxs-lookup"><span data-stu-id="ff58b-158">Avoid excessive buffer allocation</span></span>

<span data-ttu-id="ff58b-159">Desenvolvedores de aplicativos devem estar cientes que as fontes de dados muito grandes podem levar a exaustão e a ataques de negação de serviço de recurso.</span><span class="sxs-lookup"><span data-stu-id="ff58b-159">Application developers should be aware that extremely large data sources can lead to resource exhaustion and denial of service attacks.</span></span>

<span data-ttu-id="ff58b-160">Se um usuário mal-intencionado envia ou carregar um documento XML muito grande, pode fazer com que LINQ to XML consome recursos do sistema excessivos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-160">If a malicious user submits or uploads a very large XML document, it could cause LINQ to XML to consume excessive system resources.</span></span> <span data-ttu-id="ff58b-161">Isso pode constituir um ataque de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="ff58b-161">This can constitute a denial of service attack.</span></span> <span data-ttu-id="ff58b-162">Para evitar isso, você pode definir a <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> propriedade e criar um leitor que, em seguida, é limitado no tamanho do documento que ele pode carregar.</span><span class="sxs-lookup"><span data-stu-id="ff58b-162">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> property, and create a reader that's then limited in the size of document that it can load.</span></span> <span data-ttu-id="ff58b-163">Você usa o leitor para criar a árvore XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-163">You then use the reader to create the XML tree.</span></span>

<span data-ttu-id="ff58b-164">Por exemplo, se você souber que o tamanho esperado máximo dos documentos XML que vêm de uma fonte não confiável será menor que os bytes 50K, defina <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> a 100.000.</span><span class="sxs-lookup"><span data-stu-id="ff58b-164">For example, if you know that the maximum expected size of your XML documents coming from an untrusted source will be less than 50K bytes, set <xref:System.Xml.XmlReaderSettings.MaxCharactersInDocument%2A?displayProperty=nameWithType> to 100,000.</span></span> <span data-ttu-id="ff58b-165">Isso não impedirá seu processamento de documentos XML, e ao mesmo tempo abrandará as ameaças de negação de serviço onde os documentos podem ser carregados que consumiriam grandes quantidades de memória.</span><span class="sxs-lookup"><span data-stu-id="ff58b-165">This will not encumber your processing of XML documents, and at the same time it will mitigate denial of service threats where documents might be uploaded that would consume large amounts of memory.</span></span>

### <a name="avoid-excess-entity-expansion"></a><span data-ttu-id="ff58b-166">Evitar a expansão da entidade em excesso</span><span class="sxs-lookup"><span data-stu-id="ff58b-166">Avoid excess entity expansion</span></span>

<span data-ttu-id="ff58b-167">Um de ataques de negação de serviço conhecidas quando usar um DTD for um documento que causa a expansão excessiva de entidade.</span><span class="sxs-lookup"><span data-stu-id="ff58b-167">One of the known denial of service attacks when using a DTD is a document that causes excessive entity expansion.</span></span> <span data-ttu-id="ff58b-168">Para evitar isso, você pode definir a <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> propriedade e criar um leitor que, em seguida, é limitado no número de caracteres que resultam da expansão de entidade.</span><span class="sxs-lookup"><span data-stu-id="ff58b-168">To prevent this, you can set the <xref:System.Xml.XmlReaderSettings.MaxCharactersFromEntities%2A?displayProperty=nameWithType> property, and create a reader that's then limited in the number of characters that result from entity expansion.</span></span> <span data-ttu-id="ff58b-169">Você usa o leitor para criar a árvore XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-169">You then use the reader to create the XML tree.</span></span>

### <a name="limit-the-depth-of-the-xml-hierarchy"></a><span data-ttu-id="ff58b-170">Limitar a profundidade da hierarquia XML</span><span class="sxs-lookup"><span data-stu-id="ff58b-170">Limit the depth of the XML hierarchy</span></span>

<span data-ttu-id="ff58b-171">Um ataque de negação de serviço é possível quando um documento é enviado que possui a profundidade excessiva a hierarquia.</span><span class="sxs-lookup"><span data-stu-id="ff58b-171">One possible denial of service attack is when a document is submitted that has excessive depth of hierarchy.</span></span> <span data-ttu-id="ff58b-172">Para evitar isso, você pode encapsular um <xref:System.Xml.XmlReader> em sua própria classe que conta a profundidade dos elementos.</span><span class="sxs-lookup"><span data-stu-id="ff58b-172">To prevent this, you can wrap an <xref:System.Xml.XmlReader> in your own class that counts the depth of elements.</span></span> <span data-ttu-id="ff58b-173">Se o tamanho excede um nível razoável pré-determinado, você pode finalizar o processamento de documento mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-173">If the depth exceeds a predetermined reasonable level, you can terminate the processing of the malicious document.</span></span>

### <a name="protect-against-untrusted-xmlreader-or-xmlwriter-implementations"></a><span data-ttu-id="ff58b-174">Proteger contra implementações não confiáveis de XmlReader ou XmlWriter</span><span class="sxs-lookup"><span data-stu-id="ff58b-174">Protect against untrusted XmlReader or XmlWriter implementations</span></span>

<span data-ttu-id="ff58b-175">Os administradores devem verificar que alguns externamente fornecer <xref:System.Xml.XmlReader> ou implementações de <xref:System.Xml.XmlWriter> tem nomes fortes e ter sido registrados na configuração do computador.</span><span class="sxs-lookup"><span data-stu-id="ff58b-175">Administrators should verify that any externally supplied <xref:System.Xml.XmlReader> or <xref:System.Xml.XmlWriter> implementations have strong names and have been registered in the machine configuration.</span></span> <span data-ttu-id="ff58b-176">Isso evita código mal-intencionado de masquerading como um leitor ou gravador de ser carregado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-176">This prevents malicious code masquerading as a reader or writer from being loaded.</span></span>

### <a name="periodically-free-objects-that-reference-xname"></a><span data-ttu-id="ff58b-177">Periodicamente liberar objetos que referenciam o XName</span><span class="sxs-lookup"><span data-stu-id="ff58b-177">Periodically free objects that reference XName</span></span>

<span data-ttu-id="ff58b-178">Para proteger contra determinados tipos de ataques, programadores de aplicativo deve liberar todos os objetos que fazem referência a um objeto de <xref:System.Xml.Linq.XName> no domínio de aplicativo todo base regular.</span><span class="sxs-lookup"><span data-stu-id="ff58b-178">To protect against certain kinds of attacks, application programmers should free all objects that reference an <xref:System.Xml.Linq.XName> object in the application domain on a regular basis.</span></span>

### <a name="protect-against-random-xml-names"></a><span data-ttu-id="ff58b-179">Proteger contra nomes XML aleatórios</span><span class="sxs-lookup"><span data-stu-id="ff58b-179">Protect against random XML names</span></span>

<span data-ttu-id="ff58b-180">Os aplicativos que usam dados de fontes não confiáveis devem considerar o uso de um <xref:System.Xml.XmlReader> que está encapsulado em código personalizado para inspecionar a possibilidade de namespaces e nomes XML aleatórios.</span><span class="sxs-lookup"><span data-stu-id="ff58b-180">Applications that take data from untrusted sources should consider using an <xref:System.Xml.XmlReader> that's wrapped in custom code to inspect for the possibility of random XML names and namespaces.</span></span> <span data-ttu-id="ff58b-181">Se tais nomes aleatórios e namespaces XML são detectados, o aplicativo pode então terminar o processamento de documento mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="ff58b-181">If such random XML names and namespaces are detected, the application can then terminate the processing of the malicious document.</span></span>

<span data-ttu-id="ff58b-182">Talvez você queira limitar o número de nomes em qualquer namespace determinada (incluindo nomes em qualquer namespace) a um limite razoável.</span><span class="sxs-lookup"><span data-stu-id="ff58b-182">You might want to limit the number of names in any given namespace (including names in no namespace) to a reasonable limit.</span></span>

### <a name="serialize-linq-to-xml-objects-to-xml-text-before-passing-the-data-to-an-untrusted-component"></a><span data-ttu-id="ff58b-183">Serializar objetos LINQ to XML em texto XML antes de passar os dados para um componente não confiável</span><span class="sxs-lookup"><span data-stu-id="ff58b-183">Serialize LINQ to XML objects to XML text before passing the data to an untrusted component</span></span>

<span data-ttu-id="ff58b-184">LINQ to XML pode ser usado para criar pipelines de processamento nos quais componentes diferentes de aplicativos carregam, validam, consultam, transformam, atualizam e salvam dados XML que são passados entre componentes como árvores XML.</span><span class="sxs-lookup"><span data-stu-id="ff58b-184">LINQ to XML could be used to build processing pipelines in which different application components load, validate, query, transform, update, and save XML data that's passed between components as XML trees.</span></span> <span data-ttu-id="ff58b-185">Isso pode ajudar a otimizar o desempenho, porque a sobrecarga de carregamento e objetos serializar ao texto XML é feita apenas termina de pipeline.</span><span class="sxs-lookup"><span data-stu-id="ff58b-185">This can help optimize performance, because the overhead of loading and serializing objects to XML text is done only at the ends of the pipeline.</span></span> <span data-ttu-id="ff58b-186">Os desenvolvedores devem estar cientes, entretanto, que todas as anotações e manipuladores de eventos criados por um componente são acessíveis a outros componentes.</span><span class="sxs-lookup"><span data-stu-id="ff58b-186">Developers must be aware, however, that all annotations and event handlers created by one component are accessible to other components.</span></span> <span data-ttu-id="ff58b-187">Isso pode criar um número de vulnerabilidades se os componentes têm diferentes níveis de confiança.</span><span class="sxs-lookup"><span data-stu-id="ff58b-187">This can create a number of vulnerabilities if the components have different levels of trust.</span></span> <span data-ttu-id="ff58b-188">Para compilar proteger pipelines através de componentes menos confiável, você deve serializar objetos LINQ to XML ao texto XML antes de passar os dados a um componente não confiável.</span><span class="sxs-lookup"><span data-stu-id="ff58b-188">To build secure pipelines across less trusted components, you must serialize LINQ to XML objects to XML text before passing the data to an untrusted component.</span></span>

<span data-ttu-id="ff58b-189">Qualquer segurança é fornecida pelo Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="ff58b-189">Some security is provided by the common language runtime (CLR).</span></span> <span data-ttu-id="ff58b-190">Por exemplo, um componente que não inclui uma classe privada não pode acessar anotações com chave por essa classe.</span><span class="sxs-lookup"><span data-stu-id="ff58b-190">For example, a component that doesn't include a private class can't access annotations keyed by that class.</span></span> <span data-ttu-id="ff58b-191">No entanto, as anotações podem ser excluídas por componentes que não podem lê-las.</span><span class="sxs-lookup"><span data-stu-id="ff58b-191">However, annotations can be deleted by components that can't read them.</span></span> <span data-ttu-id="ff58b-192">Isso pode ser usado como um ataque violação.</span><span class="sxs-lookup"><span data-stu-id="ff58b-192">This could be used as a tampering attack.</span></span>

## <a name="see-also"></a><span data-ttu-id="ff58b-193">Confira também</span><span class="sxs-lookup"><span data-stu-id="ff58b-193">See also</span></span>

- [<span data-ttu-id="ff58b-194">Visão geral de LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="ff58b-194">LINQ to XML overview</span></span>](linq-xml-overview.md)
