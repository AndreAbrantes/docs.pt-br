---
title: Considerações de arquitetura sem servidor - aplicativos sem servidor
description: Compreenda os desafios da arquitetura de aplicativos sem servidor, do gerenciamento de estado e o armazenamento persistente para dimensionar, registro em log, rastreamento e diagnóstico.
author: JEREMYLIKNESS
ms.author: jeliknes
ms.date: 06/26/2018
ms.openlocfilehash: 5f175351cf42f3d9966add72750d64a4efe14e07
ms.sourcegitcommit: bd4fa78f5a46133efdead1bc692a9aa2811d7868
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "49369618"
---
# <a name="serverless-architecture-considerations"></a><span data-ttu-id="df2c6-103">Considerações sobre a arquitetura sem servidor</span><span class="sxs-lookup"><span data-stu-id="df2c6-103">Serverless architecture considerations</span></span>

<span data-ttu-id="df2c6-104">Adotar uma arquitetura sem servidor vêm com determinados desafios.</span><span class="sxs-lookup"><span data-stu-id="df2c6-104">Adopting a serverless architecture does come with certain challenges.</span></span> <span data-ttu-id="df2c6-105">Essa seção explora algumas das considerações mais comuns a serem consideradas.</span><span class="sxs-lookup"><span data-stu-id="df2c6-105">This section explores some of the more common considerations to be aware of.</span></span> <span data-ttu-id="df2c6-106">Todos esses desafios têm soluções.</span><span class="sxs-lookup"><span data-stu-id="df2c6-106">All of these challenges have solutions.</span></span> <span data-ttu-id="df2c6-107">Assim como acontece com todas as opções de arquitetura, a decisão para operar sem servidor deve ser feita somente após considerar cuidadosamente os prós e contras.</span><span class="sxs-lookup"><span data-stu-id="df2c6-107">As with all architecture choices, the decision to go serverless should be made only after carefully considering the pros and cons.</span></span> <span data-ttu-id="df2c6-108">Dependendo das necessidades do seu aplicativo, você pode decidir por que uma implementação sem servidor não é a solução certa para determinados componentes.</span><span class="sxs-lookup"><span data-stu-id="df2c6-108">Depending on the needs of your application, you may decide a serverless implementation isn't the right solution for certain components.</span></span>

## <a name="managing-state"></a><span data-ttu-id="df2c6-109">Gerenciamento de estado</span><span class="sxs-lookup"><span data-stu-id="df2c6-109">Managing state</span></span>

<span data-ttu-id="df2c6-110">Funções sem servidor, assim como acontece com microsserviços em geral, são sem monitoração de estado por padrão.</span><span class="sxs-lookup"><span data-stu-id="df2c6-110">Serverless functions, as with microservices in general, are stateless by default.</span></span> <span data-ttu-id="df2c6-111">Evitando estado permite que sem servidor efêmera para escalar horizontalmente e oferecer resiliência sem um ponto central de falha.</span><span class="sxs-lookup"><span data-stu-id="df2c6-111">Avoiding state enables serverless to be ephemeral, to scale out, and to provide resiliency without a central point of failure.</span></span> <span data-ttu-id="df2c6-112">Em algumas circunstâncias, os processos de negócios exigem estado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-112">In some circumstances, business processes require state.</span></span> <span data-ttu-id="df2c6-113">Se o processo requer que o estado, você terá duas opções.</span><span class="sxs-lookup"><span data-stu-id="df2c6-113">If your process requires state, you have two options.</span></span> <span data-ttu-id="df2c6-114">Você pode adotar um modelo diferente sem servidor, ou interagir com um serviço separado que fornece o estado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-114">You can adopt a model other than serverless, or interact with a separate service that provides state.</span></span> <span data-ttu-id="df2c6-115">Adicionar o estado pode complicar a solução e dificultam a escala e possivelmente criar um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="df2c6-115">Adding state can complicate the solution and make it harder to scale, and potentially create a single point of failure.</span></span> <span data-ttu-id="df2c6-116">Considere cuidadosamente se sua função requer absolutamente de estado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-116">Carefully consider whether your function absolutely requires state.</span></span> <span data-ttu-id="df2c6-117">Se a resposta for "Sim", determine se ele ainda faz sentido para implementá-lo com sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-117">If the answer is "yes," determine whether it still makes sense to implement it with serverless.</span></span>

<span data-ttu-id="df2c6-118">Há várias soluções para adotar o estado sem comprometer os benefícios do uso sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-118">There are several solutions to adopt state without compromising the benefits of serverless.</span></span> <span data-ttu-id="df2c6-119">Algumas das soluções mais populares incluem:</span><span class="sxs-lookup"><span data-stu-id="df2c6-119">Some of the more popular solutions include:</span></span>

* <span data-ttu-id="df2c6-120">Usar um repositório de dados temporários ou cache distribuído, como o Redis</span><span class="sxs-lookup"><span data-stu-id="df2c6-120">Use a temporary data store or distributed cache, like Redis</span></span>
* <span data-ttu-id="df2c6-121">Estado da Store em um banco de dados, como SQL ou cosmos DB</span><span class="sxs-lookup"><span data-stu-id="df2c6-121">Store state in a database, like SQL or CosmosDB</span></span>
* <span data-ttu-id="df2c6-122">Lidar com estado por meio de um mecanismo de fluxo de trabalho, como as funções duráveis</span><span class="sxs-lookup"><span data-stu-id="df2c6-122">Handle state through a workflow engine like durable functions</span></span>

<span data-ttu-id="df2c6-123">O resultado final é que você deve estar ciente da necessidade de qualquer gerenciamento de estado dentro de processos que você está pensando em implementar com sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-123">The bottom line is that you should be aware of the need for any state management within processes you're considering to implement with serverless.</span></span>

## <a name="long-running-processes"></a><span data-ttu-id="df2c6-124">Processos de longa execução</span><span class="sxs-lookup"><span data-stu-id="df2c6-124">Long-running processes</span></span>

<span data-ttu-id="df2c6-125">Muitos benefícios do uso sem servidor contam com os processos que estão sendo efêmero.</span><span class="sxs-lookup"><span data-stu-id="df2c6-125">Many benefits of serverless rely on the processes being ephemeral.</span></span> <span data-ttu-id="df2c6-126">Tempos de execução curtos tornam mais fácil para o provedor sem servidor liberar recursos, como as funções funções end e o compartilhamento entre hosts.</span><span class="sxs-lookup"><span data-stu-id="df2c6-126">Short run times make it easier for the serverless provider to free up resources as functions end and share functions across hosts.</span></span> <span data-ttu-id="df2c6-127">A maioria dos provedores de nuvem limitar o tempo total que sua função pode ser executado para cerca de 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="df2c6-127">Most cloud providers limit the total time your function can run to around 10 minutes.</span></span> <span data-ttu-id="df2c6-128">Se o processo pode levar mais tempo, você pode considerar uma implementação alternativa.</span><span class="sxs-lookup"><span data-stu-id="df2c6-128">If your process may take longer, you might consider an alternative implementation.</span></span>

<span data-ttu-id="df2c6-129">Há algumas exceções e soluções.</span><span class="sxs-lookup"><span data-stu-id="df2c6-129">There are a few exceptions and solutions.</span></span> <span data-ttu-id="df2c6-130">Uma solução pode ser interromper o processo em componentes menores que individualmente levam menos tempo para ser executado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-130">One solution may be to break your process into smaller components that individually take less time to run.</span></span> <span data-ttu-id="df2c6-131">Se a execução do processo longa devido a dependências, você também pode considerar um fluxo de trabalho assíncrono usando uma solução, como as funções duráveis.</span><span class="sxs-lookup"><span data-stu-id="df2c6-131">If your process runs long because of dependencies, you can also consider an asynchronous workflow using a solution like durable functions.</span></span> <span data-ttu-id="df2c6-132">As funções duráveis pausam e mantêm o estado de seu processo enquanto ele estiver aguardando em um processo externo para concluir.</span><span class="sxs-lookup"><span data-stu-id="df2c6-132">Durable functions pause and maintain the state of your process while it's waiting on an external process to finish.</span></span> <span data-ttu-id="df2c6-133">A manipulação assíncrona reduz o tempo que o processo real é executado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-133">Asynchronous handling reduces the time the actual process runs.</span></span>

## <a name="startup-time"></a><span data-ttu-id="df2c6-134">Tempo de inicialização</span><span class="sxs-lookup"><span data-stu-id="df2c6-134">Startup time</span></span>

<span data-ttu-id="df2c6-135">Um problema potencial com implementações sem servidor é o tempo de inicialização.</span><span class="sxs-lookup"><span data-stu-id="df2c6-135">One potential concern with serverless implementations is startup time.</span></span> <span data-ttu-id="df2c6-136">Para conservar os recursos, muitos provedores sem servidor criam infraestrutura "sob"demanda.</span><span class="sxs-lookup"><span data-stu-id="df2c6-136">To conserve resources, many serverless providers create infrastructure "on demand."</span></span> <span data-ttu-id="df2c6-137">Quando uma função sem servidor é disparada após um período de tempo, os recursos para hospedar a função talvez precise ser criado ou reiniciado.</span><span class="sxs-lookup"><span data-stu-id="df2c6-137">When a serverless function is triggered after a period of time, the resources to host the function may need to be created or restarted.</span></span> <span data-ttu-id="df2c6-138">Em algumas situações, inicializações a frio podem resultar em atrasos de alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="df2c6-138">In some situations, cold starts may result in delays of several seconds.</span></span> <span data-ttu-id="df2c6-139">Tempo de inicialização varia de acordo com os provedores e os níveis de serviço.</span><span class="sxs-lookup"><span data-stu-id="df2c6-139">Startup time varies across providers and service levels.</span></span> <span data-ttu-id="df2c6-140">Há algumas abordagens para o tempo de inicialização de endereço se for importante minimizar a para o sucesso do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="df2c6-140">There are a few approaches to address startup time if it's important to minimize for the success of the app.</span></span>

* <span data-ttu-id="df2c6-141">Alguns provedores de permitir que os usuários de pagamento para níveis de serviço que garantem a infraestrutura é "always on".</span><span class="sxs-lookup"><span data-stu-id="df2c6-141">Some providers allow users to pay for service levels that guarantee infrastructure is "always on".</span></span>
* <span data-ttu-id="df2c6-142">Implemente um mecanismo keep-alive (ping o ponto de extremidade para mantê-lo "ativos").</span><span class="sxs-lookup"><span data-stu-id="df2c6-142">Implement a keep-alive mechanism (ping the endpoint to keep it "awake").</span></span>
* <span data-ttu-id="df2c6-143">Use a orquestração, como Kubernetes com uma abordagem de função em contêineres (o host já está em execução para que novas instâncias de bagunçar é extremamente rápido).</span><span class="sxs-lookup"><span data-stu-id="df2c6-143">Use orchestration like Kubernetes with a containerized function approach (the host is already running so spinning up new instances is extremely fast).</span></span>

## <a name="database-updates-and-migrations"></a><span data-ttu-id="df2c6-144">Migrações e atualizações de banco de dados</span><span class="sxs-lookup"><span data-stu-id="df2c6-144">Database updates and migrations</span></span>

<span data-ttu-id="df2c6-145">Uma vantagem de código sem servidor é que você pode liberar as novas funções sem precisar reimplantar o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="df2c6-145">An advantage of serverless code is that you can release new functions without having to redeploy the entire application.</span></span> <span data-ttu-id="df2c6-146">Essa vantagem pode se tornar uma desvantagem quando um banco de dados relacional está envolvido.</span><span class="sxs-lookup"><span data-stu-id="df2c6-146">This advantage can become a disadvantage when there's a relational database involved.</span></span> <span data-ttu-id="df2c6-147">Alterações em esquemas de banco de dados são difíceis de sincronizar com atualizações sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-147">Changes to database schemas are difficult to synchronize with serverless updates.</span></span> <span data-ttu-id="df2c6-148">Desafios adicionais são impostos quando as coisas dão errado, e as alterações devem ser revertidas.</span><span class="sxs-lookup"><span data-stu-id="df2c6-148">Additional challenges are posed when things go wrong and the changes must be rolled back.</span></span> <span data-ttu-id="df2c6-149">Integridade dos dados é um dos motivos que uma prática recomendada para microsserviços e funções sem servidor é que eles possuem seus próprios dados.</span><span class="sxs-lookup"><span data-stu-id="df2c6-149">Data integrity is one reason that a best practice for microservices and serverless functions is that they own their own data.</span></span> <span data-ttu-id="df2c6-150">É possível implantar as alterações como uma única unidade de computação e de dados.</span><span class="sxs-lookup"><span data-stu-id="df2c6-150">It is possible to deploy changes as a single unit of compute and data.</span></span> <span data-ttu-id="df2c6-151">A realidade é que muitos sistemas herdados apresentam um grande banco de dados back-end que deve ser reconciliado com a arquitetura sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-151">The reality is that many legacy systems feature a large back-end database that must be reconciled with the serverless architecture.</span></span>

<span data-ttu-id="df2c6-152">Uma abordagem popular para resolver o controle de versão do esquema é nunca modifique as propriedades existentes e colunas, mas em vez disso, adicionar novas informações.</span><span class="sxs-lookup"><span data-stu-id="df2c6-152">A popular approach to solve schema versioning is to never modify existing properties and columns, but instead add new information.</span></span> <span data-ttu-id="df2c6-153">Por exemplo, considere uma alteração para mover de um valor booliano "concluído" Sinalizador para obter uma lista de tarefas pendentes para uma "data de conclusão".</span><span class="sxs-lookup"><span data-stu-id="df2c6-153">For example, consider a change to move from a Boolean "completed" flag for a todo list to a "completed date."</span></span> <span data-ttu-id="df2c6-154">Em vez de remover o campo antigo, a alteração do banco de dados será:</span><span class="sxs-lookup"><span data-stu-id="df2c6-154">Instead of removing the old field, the database change will:</span></span>

1. <span data-ttu-id="df2c6-155">Adicione um campo novo "Data da conclusão".</span><span class="sxs-lookup"><span data-stu-id="df2c6-155">Add a new "completed date" field.</span></span>
1. <span data-ttu-id="df2c6-156">Transforme o campo booliano "concluído" para uma função computada que avalia se a data de conclusão é posterior à data atual.</span><span class="sxs-lookup"><span data-stu-id="df2c6-156">Transform the "completed" Boolean field to a computed function that evaluates whether the completed date is after the current date.</span></span>
1. <span data-ttu-id="df2c6-157">Adicionar um gatilho para definir a data de conclusão para a data atual quando o booliano concluído é definido como true.</span><span class="sxs-lookup"><span data-stu-id="df2c6-157">Add a trigger to set the completed date to the current date when the completed Boolean is set to true.</span></span>

<span data-ttu-id="df2c6-158">A sequência das alterações garante que o código herdado continua em execução "como está", enquanto as funções sem servidor mais recentes podem tirar proveito do novo campo.</span><span class="sxs-lookup"><span data-stu-id="df2c6-158">The sequence of changes ensures that legacy code continues to run "as is" while newer serverless functions can take advantage of the new field.</span></span>

<span data-ttu-id="df2c6-159">Para obter mais informações sobre dados em arquiteturas sem servidor, consulte [desafios e soluções de gerenciamento de dados de distribuídos](../microservices-architecture/architect-microservice-container-applications/distributed-data-management.md).</span><span class="sxs-lookup"><span data-stu-id="df2c6-159">For more information about data in serverless architectures, see [Challenges and solutions for distributed data management](../microservices-architecture/architect-microservice-container-applications/distributed-data-management.md).</span></span>

## <a name="scaling"></a><span data-ttu-id="df2c6-160">Dimensionamento</span><span class="sxs-lookup"><span data-stu-id="df2c6-160">Scaling</span></span>

<span data-ttu-id="df2c6-161">É um equívoco comum que, sem servidor significa "sem servidor".</span><span class="sxs-lookup"><span data-stu-id="df2c6-161">It's a common misconception that serverless means "no server."</span></span> <span data-ttu-id="df2c6-162">Na verdade, é "menor servidor".</span><span class="sxs-lookup"><span data-stu-id="df2c6-162">It's in fact "less server."</span></span> <span data-ttu-id="df2c6-163">Há o fato é que uma infraestrutura de backup é importante entender quando se trata de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="df2c6-163">The fact there is a backing infrastructure is important to understand when it comes to scaling.</span></span> <span data-ttu-id="df2c6-164">Plataformas sem servidor mais fornecem um conjunto de controles para manipular como a infraestrutura deve ser dimensionado quando o evento densidade aumenta.</span><span class="sxs-lookup"><span data-stu-id="df2c6-164">Most serverless platforms provide a set of controls to handle how the infrastructure should scale when event density increases.</span></span> <span data-ttu-id="df2c6-165">Você pode escolher entre uma variedade de opções, mas sua estratégia pode variar dependendo da função.</span><span class="sxs-lookup"><span data-stu-id="df2c6-165">You can choose from a variety of options, but your strategy may vary depending on the function.</span></span> <span data-ttu-id="df2c6-166">Além disso, funções normalmente são executadas em um host relacionado, para que as funções no mesmo host têm as mesmas opções de escala.</span><span class="sxs-lookup"><span data-stu-id="df2c6-166">Furthermore, functions are typically run under a related host, so that functions on the same host have the same scale options.</span></span> <span data-ttu-id="df2c6-167">Portanto, é necessário organizar e desenvolver uma estratégia funções que são hospedadas juntos com base nos requisitos de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="df2c6-167">Therefore it is necessary to organize and strategize which functions are hosted together based on scale requirements.</span></span>

<span data-ttu-id="df2c6-168">As regras geralmente especificam como escalar verticalmente (aumentar os recursos de host) e expandir (aumentar o número de instâncias de host) com base nos parâmetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="df2c6-168">Rules often specify how to scale-up (increase the host resources) and scale-out (increase the number of host instances) based on varying parameters.</span></span> <span data-ttu-id="df2c6-169">Gatilhos para escalas podem incluir o uso de memória, taxas de solicitação, utilização da CPU e agendamento.</span><span class="sxs-lookup"><span data-stu-id="df2c6-169">Triggers for scales may include schedule, request rates, CPU utilization, and memory usage.</span></span> <span data-ttu-id="df2c6-170">Maior desempenho geralmente tem um custo maior.</span><span class="sxs-lookup"><span data-stu-id="df2c6-170">Higher performance often comes at a greater cost.</span></span> <span data-ttu-id="df2c6-171">As abordagens mais baratas, baseado em consumo não podem dimensionar à medida que quando a taxa de solicitação, de repente, aumenta rapidamente.</span><span class="sxs-lookup"><span data-stu-id="df2c6-171">The less expensive, consumption-based approaches may not scale as quickly when the request rate suddenly increases.</span></span> <span data-ttu-id="df2c6-172">Há uma compensação entre pagando com antecedência "custo seguro" em vez de pagar estritamente "que você acesse" e arriscar respostas mais lentas devido a aumentos repentinos na demanda.</span><span class="sxs-lookup"><span data-stu-id="df2c6-172">There is a trade-off between paying up front "insurance cost" versus paying strictly "as you go" and risking slower responses due to sudden increases in demand.</span></span>

## <a name="monitoring-tracing-and-logging"></a><span data-ttu-id="df2c6-173">Registro em log, rastreamento e monitoramento</span><span class="sxs-lookup"><span data-stu-id="df2c6-173">Monitoring, tracing, and logging</span></span>

<span data-ttu-id="df2c6-174">Uma vez implantados de aplicativos de monitoramento é geralmente um aspecto desconsiderado do DevOps.</span><span class="sxs-lookup"><span data-stu-id="df2c6-174">An often overlooked aspect of DevOps is monitoring applications once deployed.</span></span> <span data-ttu-id="df2c6-175">É importante ter uma estratégia para o monitoramento de funções sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-175">It's important to have a strategy for monitoring serverless functions.</span></span> <span data-ttu-id="df2c6-176">O maior desafio que muitas vezes é correlação ou reconhecer quando um usuário chama várias funções como parte da mesma interação.</span><span class="sxs-lookup"><span data-stu-id="df2c6-176">The biggest challenge is often correlation, or recognizing when a user calls multiple functions as part of the same interaction.</span></span> <span data-ttu-id="df2c6-177">Plataformas sem servidor mais permitem que o console de log que pode ser importado para ferramentas de terceiros.</span><span class="sxs-lookup"><span data-stu-id="df2c6-177">Most serverless platforms allow console logging that can be imported into third-party tools.</span></span> <span data-ttu-id="df2c6-178">Também há opções para automatizar a coleta de telemetria, gerar e acompanhar as IDs de correlação e monitorar as ações específicas para fornecer informações detalhadas.</span><span class="sxs-lookup"><span data-stu-id="df2c6-178">There are also options to automate collection of telemetry, generate and track correlation IDs, and monitor specific actions to provide detailed insights.</span></span> <span data-ttu-id="df2c6-179">O Azure fornece o avançado [plataforma do Application Insights](https://docs.microsoft.com/azure/azure-functions/functions-monitoring) para monitoramento e análise.</span><span class="sxs-lookup"><span data-stu-id="df2c6-179">Azure provides the advanced [Application Insights platform](https://docs.microsoft.com/azure/azure-functions/functions-monitoring) for monitoring and analytics.</span></span>

## <a name="inter-service-dependencies"></a><span data-ttu-id="df2c6-180">Dependências entre serviços</span><span class="sxs-lookup"><span data-stu-id="df2c6-180">Inter-service dependencies</span></span>

<span data-ttu-id="df2c6-181">Uma arquitetura sem servidor pode incluir funções que dependem de outras funções.</span><span class="sxs-lookup"><span data-stu-id="df2c6-181">A serverless architecture may include functions that rely on other functions.</span></span> <span data-ttu-id="df2c6-182">Na verdade, não é incomum em uma arquitetura sem servidor tenha vários serviços chamam uns aos outros como parte de uma interação ou a transação distribuída.</span><span class="sxs-lookup"><span data-stu-id="df2c6-182">In fact, it isn't uncommon in a serverless architecture to have multiple services call each other as part of an interaction or distributed transaction.</span></span> <span data-ttu-id="df2c6-183">Para evitar acoplamento forte, é recomendável que os serviços não referenciam entre si diretamente.</span><span class="sxs-lookup"><span data-stu-id="df2c6-183">To avoid strong coupling, it's recommended that services don't reference each other directly.</span></span> <span data-ttu-id="df2c6-184">Quando o ponto de extremidade para um serviço precisa alterar, referências diretas pode resultar na refatoração principais.</span><span class="sxs-lookup"><span data-stu-id="df2c6-184">When the endpoint for a service needs to change, direct references could result in major refactoring.</span></span> <span data-ttu-id="df2c6-185">Uma sugestão de solução é fornecer um mecanismo de descoberta de serviço, como um registro, que fornece o ponto de extremidade apropriado para um tipo de solicitação.</span><span class="sxs-lookup"><span data-stu-id="df2c6-185">A suggested solution is to provide a service discovery mechanism, such as a registry, that provides the appropriate end point for a request type.</span></span> <span data-ttu-id="df2c6-186">Outra solução é utilizar serviços de mensagens como filas ou tópicos para a comunicação entre serviços.</span><span class="sxs-lookup"><span data-stu-id="df2c6-186">Another solution is to leverage messaging services like queues or topics for communication between services.</span></span>

## <a name="managing-failure-and-providing-resiliency"></a><span data-ttu-id="df2c6-187">Gerenciamento de falhas e fornecendo resiliência</span><span class="sxs-lookup"><span data-stu-id="df2c6-187">Managing failure and providing resiliency</span></span>

<span data-ttu-id="df2c6-188">Também é importante considerar as *padrão de disjuntor*: se, por algum motivo, um serviço continua a falhar, não é aconselhável para chamar esse serviço repetidamente.</span><span class="sxs-lookup"><span data-stu-id="df2c6-188">It's also important to consider the *circuit-breaker pattern*: If, for some reason, a service continues to fail, it isn't advisable to call that service repeatedly.</span></span> <span data-ttu-id="df2c6-189">Em vez disso, um serviço alternativo é chamado ou uma mensagem retornada até que a integridade do serviço dependente seja restabelecida.</span><span class="sxs-lookup"><span data-stu-id="df2c6-189">Instead, an alternative service is called or a message returned until the health of the dependent service is re-established.</span></span> <span data-ttu-id="df2c6-190">A arquitetura sem servidor precisa levar em conta a estratégia para resolver e gerenciamento de dependências entre serviços.</span><span class="sxs-lookup"><span data-stu-id="df2c6-190">The serverless architecture needs to take into account the strategy for resolving and managing inter-service dependencies.</span></span>

<span data-ttu-id="df2c6-191">Para continuar o padrão de Disjuntor, serviços precisam ser tolerante a falhas e resiliente.</span><span class="sxs-lookup"><span data-stu-id="df2c6-191">To continue the circuit-breaker pattern, services need to be fault tolerant and resilient.</span></span> <span data-ttu-id="df2c6-192">Tolerância refere-se à capacidade de seu aplicativo para continuar executando mesmo após exceções inesperadas ou estados inválidos são encontrados.</span><span class="sxs-lookup"><span data-stu-id="df2c6-192">Fault tolerance refers to the ability of your application to continue running even after unexpected exceptions or invalid states are encountered.</span></span> <span data-ttu-id="df2c6-193">Tolerância a falhas normalmente é uma função do próprio código e como ele escreveu lidar com exceções.</span><span class="sxs-lookup"><span data-stu-id="df2c6-193">Fault tolerance is typically a function of the code itself and how it's written to handle exceptions.</span></span> <span data-ttu-id="df2c6-194">Resiliência se refere a como compatíveis com o aplicativo está em recuperação de falhas.</span><span class="sxs-lookup"><span data-stu-id="df2c6-194">Resiliency refers to how capable the app is at recovering from failures.</span></span> <span data-ttu-id="df2c6-195">Resiliência geralmente é gerenciada pela plataforma sem servidor.</span><span class="sxs-lookup"><span data-stu-id="df2c6-195">Resiliency is often managed by the serverless platform.</span></span> <span data-ttu-id="df2c6-196">A plataforma deve conseguir crie uma nova instância de função sem servidor quando existente falha.</span><span class="sxs-lookup"><span data-stu-id="df2c6-196">The platform should be able to spin up a new serverless function instance when the existing one fails.</span></span> <span data-ttu-id="df2c6-197">A plataforma também deve ser inteligente o bastante para parar de girar novas instâncias quando a falha de cada nova instância.</span><span class="sxs-lookup"><span data-stu-id="df2c6-197">The platform should also be intelligent enough to stop spinning up new instances when every new instance fails.</span></span>

<span data-ttu-id="df2c6-198">Para obter mais informações, consulte [Implementando o padrão de disjuntor](../microservices-architecture/implement-resilient-applications/implement-circuit-breaker-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="df2c6-198">For more information, see [Implementing the Circuit Breaker pattern](../microservices-architecture/implement-resilient-applications/implement-circuit-breaker-pattern.md).</span></span>

## <a name="versioning-and-greenblue-deployments"></a><span data-ttu-id="df2c6-199">Implantações de controle de versão e verde/azul</span><span class="sxs-lookup"><span data-stu-id="df2c6-199">Versioning and green/blue deployments</span></span>

<span data-ttu-id="df2c6-200">Uma grande vantagem do uso sem servidor é a capacidade de atualizar uma função específica sem precisar reimplantar o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="df2c6-200">A major benefit of serverless is the ability to upgrade a specific function without having to redeploy the entire application.</span></span> <span data-ttu-id="df2c6-201">Para atualizações para ser bem-sucedido, funções devem ser com controle de versão para que os serviços de chamá-los são roteados para a versão correta do código.</span><span class="sxs-lookup"><span data-stu-id="df2c6-201">For upgrades to be successful, functions must be versioned so that services calling them are routed to the correct version of code.</span></span> <span data-ttu-id="df2c6-202">Uma estratégia de implantação de novas versões também é importante.</span><span class="sxs-lookup"><span data-stu-id="df2c6-202">A strategy for deploying new versions is also important.</span></span> <span data-ttu-id="df2c6-203">Uma abordagem comum é usar "verde/azul implantações."</span><span class="sxs-lookup"><span data-stu-id="df2c6-203">A common approach is to use "green/blue deployments."</span></span> <span data-ttu-id="df2c6-204">A implantação verde é a função atual.</span><span class="sxs-lookup"><span data-stu-id="df2c6-204">The green deployment is the current function.</span></span> <span data-ttu-id="df2c6-205">Uma nova versão de "blue" é implantada para produção e testada.</span><span class="sxs-lookup"><span data-stu-id="df2c6-205">A new "blue" version is deployed to production and tested.</span></span> <span data-ttu-id="df2c6-206">Quando o teste é aprovado, as versões de verdes e azuis são trocadas para que a nova versão é fornecido em tempo real.</span><span class="sxs-lookup"><span data-stu-id="df2c6-206">When testing passes, the green and blue versions are swapped so the new version comes live.</span></span> <span data-ttu-id="df2c6-207">Se ocorrerem problemas, eles podem ser trocados novamente.</span><span class="sxs-lookup"><span data-stu-id="df2c6-207">If any issues are encountered, they can be swapped back.</span></span> <span data-ttu-id="df2c6-208">Suporte a controle de versão e implantações de verde/azul requer uma combinação de criação de funções para acomodar as alterações de versão e trabalhar com a plataforma sem servidor para lidar com implantações.</span><span class="sxs-lookup"><span data-stu-id="df2c6-208">Supporting versioning and green/blue deployments requires a combination of authoring the functions to accommodate version changes and working with the serverless platform to handle deployments.</span></span> <span data-ttu-id="df2c6-209">Uma abordagem possível é usar proxies, que são descritos na [plataforma sem servidor do Azure](azure-functions.md#proxies) capítulo.</span><span class="sxs-lookup"><span data-stu-id="df2c6-209">One possible approach is to use proxies, which are described in the [Azure serverless platform](azure-functions.md#proxies) chapter.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="df2c6-210">[Anterior](serverless-architecture.md)
[Próximo](serverless-design-examples.md)</span><span class="sxs-lookup"><span data-stu-id="df2c6-210">[Previous](serverless-architecture.md)
[Next](serverless-design-examples.md)</span></span>
