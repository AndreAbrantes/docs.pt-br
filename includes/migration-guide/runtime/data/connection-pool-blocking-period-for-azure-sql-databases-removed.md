---
ms.openlocfilehash: c27c63e5bbd4a144b9482a0b1cb74250ae78d91c
ms.sourcegitcommit: cbacb5d2cebbf044547f6af6e74a9de866800985
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/05/2020
ms.locfileid: "89496408"
---
### <a name="connection-pool-blocking-period-for-azure-sql-databases-is-removed"></a><span data-ttu-id="40c0f-101">Período de bloqueio do pool de conexões para bancos de dados SQL do Azure removido</span><span class="sxs-lookup"><span data-stu-id="40c0f-101">Connection pool blocking period for Azure SQL databases is removed</span></span>

#### <a name="details"></a><span data-ttu-id="40c0f-102">Detalhes</span><span class="sxs-lookup"><span data-stu-id="40c0f-102">Details</span></span>

<span data-ttu-id="40c0f-103">Começando com o .NET Framework 4.6.2, para solicitações de conexão abertas para bancos de dados SQL do Azure conhecidos ( \* . Database.Windows.net, \* . Database.chinacloudapi.cn, \* . database.usgovcloudapi.net, \* . Database.cloudapi.de), o período de bloqueio do pool de conexões é removido e os erros de conexão aberta não são armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="40c0f-103">Starting with the .NET Framework 4.6.2, for connection open requests to known Azure SQL databases (\*.database.windows.net, \*.database.chinacloudapi.cn, \*.database.usgovcloudapi.net, \*.database.cloudapi.de), the connection pool blocking period is removed, and connection open errors are not cached.</span></span> <span data-ttu-id="40c0f-104">As tentativas de repetir as solicitações de abertura de conexão ocorrerão quase que imediatamente após os erros de conexão transitórios.</span><span class="sxs-lookup"><span data-stu-id="40c0f-104">Attempts to retry connection open requests will occur almost immediately after transient connection errors.</span></span> <span data-ttu-id="40c0f-105">Essa alteração permite que a tentativa de abertura da conexão seja repetida imediatamente para bancos de dados SQL do Azure, melhorando, assim, o desempenho dos aplicativos habilitados para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="40c0f-105">This change allows the connection open attempt to be retried immediately for Azure SQL databases, thereby improving the performance of cloud- enabled apps.</span></span> <span data-ttu-id="40c0f-106">Para todas as outras tentativas de conexão, o período de bloqueio do pool de conexões continuará sendo imposto.</span><span class="sxs-lookup"><span data-stu-id="40c0f-106">For all other connection attempts, the connection pool blocking period continues to be enforced.</span></span><p/><span data-ttu-id="40c0f-107">No .NET Framework 4.6.1 e nas versões anteriores, quando um aplicativo encontra uma falha de conexão transitória ao conectar-se a um banco de dados, a tentativa de conexão não pode ser repetida rapidamente porque o pool de conexões armazena o erro em cache e gera-o novamente por um tempo que varia de 5 segundos a 1 minuto.</span><span class="sxs-lookup"><span data-stu-id="40c0f-107">In the .NET Framework 4.6.1 and earlier versions, when an app encounters a transient connection failure when connecting to a database, the connection attempt cannot be retried quickly, because the connection pool caches the error and re-throws it for 5 seconds to 1 minute.</span></span> <span data-ttu-id="40c0f-108">Para obter mais informações, consulte [Pool de Conexões do SQL Server (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span><span class="sxs-lookup"><span data-stu-id="40c0f-108">For more information, see [SQL Server Connection Pooling (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span></span> <span data-ttu-id="40c0f-109">Esse comportamento é problemático para conexões com bancos de dados SQL do Azure que, muitas vezes, falham com erros transitórios que normalmente são recuperados em alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="40c0f-109">This behavior is problematic for connections to Azure SQL databases, which often fail with transient errors that are typically recovered from within a few seconds.</span></span> <span data-ttu-id="40c0f-110">O recurso de bloqueio do pool de conexões significa que o aplicativo não pode se conectar ao banco de dados por um período extenso, mesmo que o banco de dados esteja disponível e o aplicativo precise ser renderizado em alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="40c0f-110">The connection pool blocking feature means that the app cannot connect to the database for an extensive period, even though the database is available and the app needs to render within a few seconds.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="40c0f-111">Sugestão</span><span class="sxs-lookup"><span data-stu-id="40c0f-111">Suggestion</span></span>

<span data-ttu-id="40c0f-112">Se esse comportamento for indesejável, o período de bloqueio do pool de conexões poderá ser configurado definindo a propriedade <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> introduzida no .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="40c0f-112">If this behavior is undesirable, the connection pool blocking period can be configured by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property introduced in the .NET Framework 4.6.2.</span></span> <span data-ttu-id="40c0f-113">O valor da propriedade é membro da enumeração <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> que pode assumir um dos três valores:</span><span class="sxs-lookup"><span data-stu-id="40c0f-113">The value of the property is a member of the <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> enumeration that can take either of three values:</span></span><ul><li><xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.Auto></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.NeverBlock></li></ul><span data-ttu-id="40c0f-114">É possível restaurar o comportamento anterior definindo a propriedade <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> como <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock>.</span><span class="sxs-lookup"><span data-stu-id="40c0f-114">The previous behavior can be restored by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property to <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock>.</span></span>

| <span data-ttu-id="40c0f-115">Nome</span><span class="sxs-lookup"><span data-stu-id="40c0f-115">Name</span></span>    | <span data-ttu-id="40c0f-116">Valor</span><span class="sxs-lookup"><span data-stu-id="40c0f-116">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="40c0f-117">Escopo</span><span class="sxs-lookup"><span data-stu-id="40c0f-117">Scope</span></span>   |<span data-ttu-id="40c0f-118">Secundária</span><span class="sxs-lookup"><span data-stu-id="40c0f-118">Minor</span></span>|
|<span data-ttu-id="40c0f-119">Versão</span><span class="sxs-lookup"><span data-stu-id="40c0f-119">Version</span></span>|<span data-ttu-id="40c0f-120">4.6.2</span><span class="sxs-lookup"><span data-stu-id="40c0f-120">4.6.2</span></span>|
|<span data-ttu-id="40c0f-121">Tipo</span><span class="sxs-lookup"><span data-stu-id="40c0f-121">Type</span></span>|<span data-ttu-id="40c0f-122">Runtime</span><span class="sxs-lookup"><span data-stu-id="40c0f-122">Runtime</span></span>|

#### <a name="affected-apis"></a><span data-ttu-id="40c0f-123">APIs afetadas</span><span class="sxs-lookup"><span data-stu-id="40c0f-123">Affected APIs</span></span>

- <xref:System.Data.Common.DbConnection.OpenAsync?displayProperty=nameWithType>
- <xref:System.Data.SqlClient.SqlConnection.Open?displayProperty=nameWithType>
- <xref:System.Data.SqlClient.SqlConnection.OpenAsync(System.Threading.CancellationToken)?displayProperty=nameWithType>

<!--

#### Affected APIs

- `M:System.Data.Common.DbConnection.OpenAsync`
- `M:System.Data.SqlClient.SqlConnection.Open`
- `M:System.Data.SqlClient.SqlConnection.OpenAsync(System.Threading.CancellationToken)`

-->
